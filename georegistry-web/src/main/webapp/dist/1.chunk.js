(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryService=void 0;var r=n(0),i=n(273),o=n(263),a=n(0),l=function(){function e(){this.layers=[],this.editingControl=null,this.simpleEditControl=null,this.geometryChange=new r.EventEmitter}return e.prototype.ngOnInit=function(){var e=this;window.onbeforeunload=function(){return e.destroy()}},e.prototype.initialize=function(e,t,n){var r=this;this.map=e,this.geometryType=t,this.addLayers(),this.map.on("draw.create",(function(){r.saveEdits()})),this.map.on("draw.delete",(function(){r.saveEdits()})),this.map.on("draw.update",(function(){r.saveEdits()}))},e.prototype.destroy=function(e){void 0===e&&(e=!0),null!=this.editingControl&&(this.map.removeControl(this.editingControl),this.editingControl=null),null!=this.map&&e?(this.map.remove(),this.map=null):null!=this.map&&this.removeLayers(),null!=this.layers&&this.layers.forEach((function(e){e.isEditing=!1,e.isRendering=!1})),this.editingLayer=null,this.layers=[]},e.prototype.startEditing=function(e){this.isEditing()&&this.stopEditing(),this.editingLayer=e,this.editingLayer.isEditing=!0,this.readOnly||this.enableEditing(),this.addEditingLayers()},e.prototype.stopEditing=function(e){void 0===e&&(e=!0),this.isEditing()&&(this.saveEdits(e),this.editingLayer.isEditing=!1,this.editingLayer=null,this.editingControl.deleteAll(),this.map.removeControl(this.editingControl),this.editingControl=null)},e.prototype.isEditing=function(){return null!=this.editingLayer},e.prototype.setPointCoordinates=function(e,t){null!=this.editingLayer&&(this.editingControl.set({type:"FeatureCollection",features:[{id:this.editingLayer.oid,type:"Feature",properties:{},geometry:{type:"Point",coordinates:[t,e]}}]}),this.editingControl.changeMode("simple_select",{featureIds:this.editingLayer.oid}),this.saveEdits())},e.prototype.isValid=function(){if(!this.readOnly){var e=!1;if(null!=this.editingControl)this.editingControl.getAll().features.length>0&&(e=!0);return e}return!0},e.prototype.saveEdits=function(e){if(void 0===e&&(e=!0),null!=this.editingLayer){var t=this.getDrawGeometry();this.editingLayer.editPropagator.value=t,e&&(this.removeLayers(),this.addLayers())}},e.prototype.reload=function(){null!=this.map&&(this.removeLayers(),this.addLayers(),null!=this.editingControl&&this.editingControl.deleteAll(),this.addEditingLayers())},e.prototype.setEditing=function(e,t){this.isEditing()&&this.stopEditing(),t.isEditing=e,e&&this.startEditing(t)},e.prototype.setRendering=function(e,t){t.isRendering=e,this.addLayer(t)},e.prototype.addLayer=function(e){var t=this.layers.findIndex((function(t){return t.oid===e.oid}));-1!==t?(this.layers.splice(t,1),this.layers.push(e)):this.layers.push(e),e.isEditing&&this.startEditing(e),this.layers=this.layers.sort((function(e,t){return e.zindex-t.zindex})),this.removeLayers(),this.addLayers()},e.prototype.getLayers=function(){return this.layers},e.prototype.getRenderedLayers=function(){return this.layers.filter((function(e){return e.isRendering}))},e.prototype.setLayers=function(e){this.removeLayers(),this.layers=e.sort((function(e,t){return e.zindex-t.zindex})),this.addLayers()},e.prototype.enableEditing=function(){null==this.editingControl&&("MULTIPOLYGON"===this.geometryType||"POLYGON"===this.geometryType?this.editingControl=new i.default({controls:{point:!1,line_string:!1,polygon:!0,trash:!0,combine_features:!1,uncombine_features:!1}}):"POINT"===this.geometryType||"MULTIPOINT"===this.geometryType?this.editingControl=new i.default({userProperties:!0,controls:{point:!0,line_string:!1,polygon:!1,trash:!0,combine_features:!1,uncombine_features:!1},styles:[{id:"highlight-active-points",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","true"]],paint:{"circle-radius":13,"circle-color":"#33FFF9","circle-stroke-width":4,"circle-stroke-color":"white"}},{id:"points-are-blue",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","false"]],paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"white"}}]}):"LINE"!==this.geometryType&&"MULTILINE"!==this.geometryType||(this.editingControl=new i.default({controls:{point:!1,line_string:!0,polygon:!1,trash:!0,combine_features:!1,uncombine_features:!1}})),null==this.map.getSource("mapbox-gl-draw-cold")&&this.map.addControl(this.editingControl))},e.prototype.addEditingLayers=function(){null!=this.editingLayer&&null!=this.editingControl&&(this.editingLayer.editPropagator.value&&this.editingControl.add(this.editingLayer.editPropagator.value))},e.prototype.removeSource=function(e){if(this.map){var t=e+"-geoobject";"MULTIPOLYGON"===this.geometryType||"POLYGON"===this.geometryType?null!=this.map.getLayer(t+"-polygon")&&this.map.removeLayer(t+"-polygon"):"POINT"===this.geometryType||"MULTIPOINT"===this.geometryType?null!=this.map.getLayer(t+"-point")&&this.map.removeLayer(t+"-point"):"LINE"!==this.geometryType&&"MultiLine"!==this.geometryType||null!=this.map.getLayer(t+"-line")&&this.map.removeLayer(t+"-line"),null!=this.map.getSource(t)&&this.map.removeSource(t)}},e.prototype.removeLayers=function(){if(null!=this.layers&&this.layers.length>0)for(var e=this.layers.length,t=0;t<e;++t){var n=this.layers[t];this.removeSource(n.oid)}},e.prototype.addLayers=function(){if(null!=this.layers&&this.layers.length>0)for(var e=this.layers.length,t=0;t<e;++t){var n=this.layers[t];n.isRendering&&this.renderGeometryAsLayer(null==n.editPropagator?n.geojson:n.editPropagator.value,n.oid,n.color)}},e.prototype.renderGeometryAsLayer=function(e,t,n){var r=t+"-geoobject";this.map&&e&&(this.map.addSource(r,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),"MULTIPOLYGON"===this.geometryType||"POLYGON"===this.geometryType?this.map.addLayer({id:r+"-polygon",type:"fill",source:r,paint:{"fill-color":n,"fill-outline-color":"black","fill-opacity":.7}}):"POINT"===this.geometryType||"MULTIPOINT"===this.geometryType?this.map.addLayer({id:r+"-point",type:"circle",source:r,paint:{"circle-radius":3,"circle-color":n,"circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}}):"LINE"!==this.geometryType&&"MULTILINE"!==this.geometryType||this.map.addLayer({id:r+"-line",source:r,type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":n,"line-width":2}}),this.map.getSource(r).setData(e))},e.prototype.getDrawGeometry=function(){if(null!=this.editingControl){var e=this.editingControl.getAll();if(e.features.length>0){if("MULTIPOLYGON"===this.geometryType){for(var t=[],n=0;n<e.features.length;n++){if("MultiPolygon"===(a=e.features[n]).geometry.type)for(var r=0;r<a.geometry.coordinates.length;r++)t.push(a.geometry.coordinates[r]);else t.push(a.geometry.coordinates)}return{coordinates:t,type:"MultiPolygon"}}if("MULTIPOINT"===this.geometryType){var i=[];for(n=0;n<e.features.length;n++){if("MultiPoint"===(a=e.features[n]).geometry.type)for(r=0;r<a.geometry.coordinates.length;r++)i.push(a.geometry.coordinates[r]);else i.push(a.geometry.coordinates)}return{coordinates:i,type:"MultiPoint"}}if("MULTILINE"===this.geometryType){var o=[];for(n=0;n<e.features.length;n++){var a;if("MultiLineString"===(a=e.features[n]).geometry.type)for(r=0;r<a.geometry.coordinates.length;r++)o.push(a.geometry.coordinates[r]);else o.push(a.geometry.coordinates)}return{coordinates:o,type:"MultiLineString"}}return e.features[0].geometry}}return null},e.createEmptyGeometryValue=function(e){var t={type:e,coordinates:[]};return"MULTIPOLYGON"===e?t.type="MultiPolygon":"POLYGON"===e?t.type="Polygon":"POINT"===e?t.type="Point":"MULTIPOINT"===e?t.type="MultiPoint":"LINE"===e?t.type="Line":"MULTILINE"===e&&(t.type="MultiLine"),t},e.prototype.zoomToLayersExtent=function(){var e=this;this.layers.forEach((function(t){if(null!=t.geojson)if("MULTIPOINT"===e.geometryType||"POINT"===e.geometryType){if(l=t.geojson.coordinates){var n=new o.LngLatBounds;l.forEach((function(e){n.extend(e)}));var r=n.getCenter(),i=new o.LngLat(r.lng,r.lat);e.map.flyTo({center:i,zoom:9,essential:!0})}}else if("MULTIPOLYGON"===e.geometryType||"POLYGON"===e.geometryType){if(l=t.geojson.coordinates){var a=new o.LngLatBounds;l.forEach((function(e){e.forEach((function(e){e.forEach((function(e){a.extend(e)}))}))})),e.map.fitBounds(a,{padding:20})}}else if("LINE"===e.geometryType||"MULTILINE"===e.geometryType){var l;if(l=t.geojson.coordinates){var s=new o.LngLatBounds;l.forEach((function(e){e.forEach((function(e){e.forEach((function(e){s.extend(e)}))}))})),e.map.fitBounds(s,{padding:20})}}}))},e.ɵfac=function(t){return new(t||e)},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.GeometryService=l,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(l,[{type:r.Injectable}],(function(){return[]}),{geometryChange:[{type:r.Output}]})},271:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegistryModule=void 0;var r=n(0),i=n(1),o=n(33),a=n(22),l=n(208),s=n(169),c=n(125),d=n(171),p=n(154),m=n(205),u=n(204),g=n(126),h=n(73),f=n(211),y=n(531),v=n(525),b=n(532),S=n(565),C=n(615),E=n(566),x=n(616),O=n(569),I=n(571),w=n(576),M=n(548),T=n(549),j=n(550),k=n(577),R=n(551),z=n(578),P=n(579),D=n(580),A=n(572),V=n(527),N=n(574),L=n(573),_=n(568),F=n(567),H=n(582),G=n(528),q=n(583),B=n(584),U=n(621),$=n(529),J=n(586),W=n(587),K=n(553),Q=n(589),Y=n(554),X=n(622),Z=n(623),ee=n(590),te=n(624),ne=n(625),re=n(581),ie=n(626),oe=n(591),ae=n(592),le=n(593),se=n(594),ce=n(595),de=n(596),pe=n(597),me=n(602),ue=n(599),ge=n(600),he=n(601),fe=n(555),ye=n(598),ve=n(603),be=n(604),Se=n(605),Ce=n(606),Ee=n(607),xe=n(608),Oe=n(610),Ie=n(609),we=n(556),Me=n(557),Te=n(627),je=n(570),ke=n(628),Re=n(588),ze=n(629),Pe=n(544),De=n(546),Ae=n(540),Ve=n(545),Ne=n(542),Le=n(521),_e=n(541),Fe=n(543),He=n(526),Ge=n(630),qe=n(210),Be=n(380);n(207);var Ue=n(0),$e=n(380),Je=n(22),We=n(1),Ke=n(68),Qe=n(259),Ye=n(261),Xe=n(154),Ze=n(113),et=function(){function e(){}return e.ɵfac=function(t){return new(t||e)},e.ɵmod=Ue.ɵɵdefineNgModule({type:e}),e.ɵinj=Ue.ɵɵdefineInjector({providers:[Fe.MapService,Ae.HierarchyService,Ne.LocalizationManagerService,Le.ChangeRequestService,_e.IOService,He.GeoObjectTypeManagementService,Pe.RegistryService,De.TaskService,i.DatePipe,ze.ToEpochDateTimePipe,fe.StepIndicatorComponent,Ve.SynchronizationConfigService],imports:[[i.CommonModule,o.RouterModule,a.FormsModule,a.ReactiveFormsModule,m.FileUploadModule,l.TreeModule,s.ContextMenuModule,c.BsDropdownModule,d.ButtonsModule,p.TypeaheadModule,g.ProgressbarModule,f.TabsModule,h.CollapseModule,u.NgxPaginationModule,qe.SharedModule,Ge.RegistryRoutingModule,Be.AccordionModule.forRoot()]]}),e}();t.RegistryModule=et,("undefined"==typeof ngJitMode||ngJitMode)&&Ue.ɵɵsetNgModuleScope(et,{declarations:[b.HierarchyComponent,B.RequestTableComponent,U.CreateUpdateGeoObjectDetailComponent,S.CreateHierarchyTypeModalComponent,C.AddChildToHierarchyModalComponent,E.CreateGeoObjTypeModalComponent,x.ManageAttributesModalComponent,O.DefineAttributeModalContentComponent,w.ShapefileModalComponent,M.AttributesPageComponent,T.LocationPageComponent,j.LocationProblemPageComponent,k.LocationProblemComponent,R.TermProblemPageComponent,z.TermProblemComponent,P.SpreadsheetModalComponent,ke.GeoObjectTypePipe,je.GeoObjectAttributeCodeValidator,I.EditAttributeModalContentComponent,A.TermOptionWidgetComponent,V.AttributeInputComponent,N.EditTermOptionInputComponent,F.ManageGeoObjectTypeModalComponent,_.GeoObjectTypeInputComponent,L.ManageTermOptionsComponent,y.LocalizedInputComponent,v.LocalizedTextComponent,$.GeoObjectSharedAttributeEditorComponent,J.ManageVersionsComponent,W.StandardAttributeEditorComponent,K.SubmitChangeRequestComponent,Y.GeoObjectEditorComponent,Re.GeoObjectAttributeExcludesPipe,ze.ToEpochDateTimePipe,X.GeoObjectEditorMapComponent,Z.SimpleEditControl,D.DataPageComponent,Q.ChangeRequestPageComponent,ee.CascadingGeoSelector,te.TreeGeoSelector,ne.ActionDetailModalComponent,b.HierarchyComponent,re.DataImporterComponent,ie.DataExportComponent,H.MasterListManagerComponent,oe.MasterListComponent,le.MasterListHistoryComponent,ae.PublishedMasterListHistoryComponent,G.PublishModalComponent,se.MasterListViewComponent,q.ExportFormatModalComponent,ce.ScheduledJobsComponent,de.JobComponent,pe.JobConflictModalComponent,me.ReuploadModalComponent,ue.ParentReferenceProblemWidgetComponent,ge.TermReferenceProblemWidgetComponent,he.RowValidationProblemWidgetComponent,fe.StepIndicatorComponent,ye.ImportProblemWidgetComponent,ve.TaskViewerComponent,be.SynchronizationConfigManagerComponent,Se.SynchronizationConfigModalComponent,Ce.SynchronizationConfigComponent,Ee.SyncDetailsComponent,xe.LocationManagerComponent,Oe.DatasetLocationManagerComponent,Ie.ContextLayerModalComponent,we.LayerPanelComponent,Me.FeaturePanelComponent,Te.GeometryPanelComponent],imports:[i.CommonModule,o.RouterModule,a.FormsModule,a.ReactiveFormsModule,m.FileUploadModule,l.TreeModule,s.ContextMenuModule,c.BsDropdownModule,d.ButtonsModule,p.TypeaheadModule,g.ProgressbarModule,f.TabsModule,h.CollapseModule,u.NgxPaginationModule,qe.SharedModule,Ge.RegistryRoutingModule,$e.AccordionModule]}),("undefined"==typeof ngDevMode||ngDevMode)&&Ue.ɵsetClassMetadata(et,[{type:r.NgModule,args:[{imports:[i.CommonModule,o.RouterModule,a.FormsModule,a.ReactiveFormsModule,m.FileUploadModule,l.TreeModule,s.ContextMenuModule,c.BsDropdownModule,d.ButtonsModule,p.TypeaheadModule,g.ProgressbarModule,f.TabsModule,h.CollapseModule,u.NgxPaginationModule,qe.SharedModule,Ge.RegistryRoutingModule,Be.AccordionModule.forRoot()],declarations:[b.HierarchyComponent,B.RequestTableComponent,U.CreateUpdateGeoObjectDetailComponent,S.CreateHierarchyTypeModalComponent,C.AddChildToHierarchyModalComponent,E.CreateGeoObjTypeModalComponent,x.ManageAttributesModalComponent,O.DefineAttributeModalContentComponent,w.ShapefileModalComponent,M.AttributesPageComponent,T.LocationPageComponent,j.LocationProblemPageComponent,k.LocationProblemComponent,R.TermProblemPageComponent,z.TermProblemComponent,P.SpreadsheetModalComponent,ke.GeoObjectTypePipe,je.GeoObjectAttributeCodeValidator,I.EditAttributeModalContentComponent,A.TermOptionWidgetComponent,V.AttributeInputComponent,N.EditTermOptionInputComponent,F.ManageGeoObjectTypeModalComponent,_.GeoObjectTypeInputComponent,L.ManageTermOptionsComponent,y.LocalizedInputComponent,v.LocalizedTextComponent,$.GeoObjectSharedAttributeEditorComponent,J.ManageVersionsComponent,W.StandardAttributeEditorComponent,K.SubmitChangeRequestComponent,Y.GeoObjectEditorComponent,Re.GeoObjectAttributeExcludesPipe,ze.ToEpochDateTimePipe,X.GeoObjectEditorMapComponent,Z.SimpleEditControl,D.DataPageComponent,Q.ChangeRequestPageComponent,ee.CascadingGeoSelector,te.TreeGeoSelector,ne.ActionDetailModalComponent,b.HierarchyComponent,re.DataImporterComponent,ie.DataExportComponent,H.MasterListManagerComponent,oe.MasterListComponent,le.MasterListHistoryComponent,ae.PublishedMasterListHistoryComponent,G.PublishModalComponent,se.MasterListViewComponent,q.ExportFormatModalComponent,ce.ScheduledJobsComponent,de.JobComponent,pe.JobConflictModalComponent,me.ReuploadModalComponent,ue.ParentReferenceProblemWidgetComponent,ge.TermReferenceProblemWidgetComponent,he.RowValidationProblemWidgetComponent,fe.StepIndicatorComponent,ye.ImportProblemWidgetComponent,ve.TaskViewerComponent,be.SynchronizationConfigManagerComponent,Se.SynchronizationConfigModalComponent,Ce.SynchronizationConfigComponent,Ee.SyncDetailsComponent,xe.LocationManagerComponent,Oe.DatasetLocationManagerComponent,Ie.ContextLayerModalComponent,we.LayerPanelComponent,Me.FeaturePanelComponent,Te.GeometryPanelComponent],providers:[Fe.MapService,Ae.HierarchyService,Ne.LocalizationManagerService,Le.ChangeRequestService,_e.IOService,He.GeoObjectTypeManagementService,Pe.RegistryService,De.TaskService,i.DatePipe,ze.ToEpochDateTimePipe,fe.StepIndicatorComponent,Ve.SynchronizationConfigService],entryComponents:[C.AddChildToHierarchyModalComponent,E.CreateGeoObjTypeModalComponent,x.ManageAttributesModalComponent,O.DefineAttributeModalContentComponent,I.EditAttributeModalContentComponent,S.CreateHierarchyTypeModalComponent,w.ShapefileModalComponent,P.SpreadsheetModalComponent,A.TermOptionWidgetComponent,V.AttributeInputComponent,N.EditTermOptionInputComponent,F.ManageGeoObjectTypeModalComponent,_.GeoObjectTypeInputComponent,L.ManageTermOptionsComponent,$.GeoObjectSharedAttributeEditorComponent,K.SubmitChangeRequestComponent,Y.GeoObjectEditorComponent,G.PublishModalComponent,q.ExportFormatModalComponent,D.DataPageComponent,Q.ChangeRequestPageComponent,ne.ActionDetailModalComponent,pe.JobConflictModalComponent,me.ReuploadModalComponent,fe.StepIndicatorComponent,Se.SynchronizationConfigModalComponent,Ie.ContextLayerModalComponent]}]}],null,null),Ue.ɵɵsetComponentScope(J.ManageVersionsComponent,[Je.ɵangular_packages_forms_forms_ba,Je.NgControlStatusGroup,Je.NgForm,We.NgStyle,We.NgIf,Ke.LocalizeComponent,We.NgForOf,We.NgClass,Qe.ConvertKeyLabel,Je.DefaultValueAccessor,Je.NgControlStatus,Je.NgModel,Je.RequiredValidator,Je.SelectControlValueAccessor,Je.NgSelectOption,Je.ɵangular_packages_forms_forms_z,Ye.DateFieldComponent,Je.NumberValueAccessor,Je.RadioControlValueAccessor,Xe.TypeaheadDirective,X.GeoObjectEditorMapComponent],[Ze.LocalizePipe]),Ue.ɵɵsetComponentScope(ne.ActionDetailModalComponent,[We.NgIf,U.CreateUpdateGeoObjectDetailComponent,Ke.LocalizeComponent],[])},516:function(e,t,n){var r={"./af":381,"./af.js":381,"./ar":382,"./ar-dz":383,"./ar-dz.js":383,"./ar-kw":384,"./ar-kw.js":384,"./ar-ly":385,"./ar-ly.js":385,"./ar-ma":386,"./ar-ma.js":386,"./ar-sa":387,"./ar-sa.js":387,"./ar-tn":388,"./ar-tn.js":388,"./ar.js":382,"./az":389,"./az.js":389,"./be":390,"./be.js":390,"./bg":391,"./bg.js":391,"./bm":392,"./bm.js":392,"./bn":393,"./bn-bd":394,"./bn-bd.js":394,"./bn.js":393,"./bo":395,"./bo.js":395,"./br":396,"./br.js":396,"./bs":397,"./bs.js":397,"./ca":398,"./ca.js":398,"./cs":399,"./cs.js":399,"./cv":400,"./cv.js":400,"./cy":401,"./cy.js":401,"./da":402,"./da.js":402,"./de":403,"./de-at":404,"./de-at.js":404,"./de-ch":405,"./de-ch.js":405,"./de.js":403,"./dv":406,"./dv.js":406,"./el":407,"./el.js":407,"./en-au":408,"./en-au.js":408,"./en-ca":409,"./en-ca.js":409,"./en-gb":410,"./en-gb.js":410,"./en-ie":411,"./en-ie.js":411,"./en-il":412,"./en-il.js":412,"./en-in":413,"./en-in.js":413,"./en-nz":414,"./en-nz.js":414,"./en-sg":415,"./en-sg.js":415,"./eo":416,"./eo.js":416,"./es":417,"./es-do":418,"./es-do.js":418,"./es-mx":419,"./es-mx.js":419,"./es-us":420,"./es-us.js":420,"./es.js":417,"./et":421,"./et.js":421,"./eu":422,"./eu.js":422,"./fa":423,"./fa.js":423,"./fi":424,"./fi.js":424,"./fil":425,"./fil.js":425,"./fo":426,"./fo.js":426,"./fr":427,"./fr-ca":428,"./fr-ca.js":428,"./fr-ch":429,"./fr-ch.js":429,"./fr.js":427,"./fy":430,"./fy.js":430,"./ga":431,"./ga.js":431,"./gd":432,"./gd.js":432,"./gl":433,"./gl.js":433,"./gom-deva":434,"./gom-deva.js":434,"./gom-latn":435,"./gom-latn.js":435,"./gu":436,"./gu.js":436,"./he":437,"./he.js":437,"./hi":438,"./hi.js":438,"./hr":439,"./hr.js":439,"./hu":440,"./hu.js":440,"./hy-am":441,"./hy-am.js":441,"./id":442,"./id.js":442,"./is":443,"./is.js":443,"./it":444,"./it-ch":445,"./it-ch.js":445,"./it.js":444,"./ja":446,"./ja.js":446,"./jv":447,"./jv.js":447,"./ka":448,"./ka.js":448,"./kk":449,"./kk.js":449,"./km":450,"./km.js":450,"./kn":451,"./kn.js":451,"./ko":452,"./ko.js":452,"./ku":453,"./ku.js":453,"./ky":454,"./ky.js":454,"./lb":455,"./lb.js":455,"./lo":456,"./lo.js":456,"./lt":457,"./lt.js":457,"./lv":458,"./lv.js":458,"./me":459,"./me.js":459,"./mi":460,"./mi.js":460,"./mk":461,"./mk.js":461,"./ml":462,"./ml.js":462,"./mn":463,"./mn.js":463,"./mr":464,"./mr.js":464,"./ms":465,"./ms-my":466,"./ms-my.js":466,"./ms.js":465,"./mt":467,"./mt.js":467,"./my":468,"./my.js":468,"./nb":469,"./nb.js":469,"./ne":470,"./ne.js":470,"./nl":471,"./nl-be":472,"./nl-be.js":472,"./nl.js":471,"./nn":473,"./nn.js":473,"./oc-lnc":474,"./oc-lnc.js":474,"./pa-in":475,"./pa-in.js":475,"./pl":476,"./pl.js":476,"./pt":477,"./pt-br":478,"./pt-br.js":478,"./pt.js":477,"./ro":479,"./ro.js":479,"./ru":480,"./ru.js":480,"./sd":481,"./sd.js":481,"./se":482,"./se.js":482,"./si":483,"./si.js":483,"./sk":484,"./sk.js":484,"./sl":485,"./sl.js":485,"./sq":486,"./sq.js":486,"./sr":487,"./sr-cyrl":488,"./sr-cyrl.js":488,"./sr.js":487,"./ss":489,"./ss.js":489,"./sv":490,"./sv.js":490,"./sw":491,"./sw.js":491,"./ta":492,"./ta.js":492,"./te":493,"./te.js":493,"./tet":494,"./tet.js":494,"./tg":495,"./tg.js":495,"./th":496,"./th.js":496,"./tk":497,"./tk.js":497,"./tl-ph":498,"./tl-ph.js":498,"./tlh":499,"./tlh.js":499,"./tr":500,"./tr.js":500,"./tzl":501,"./tzl.js":501,"./tzm":502,"./tzm-latn":503,"./tzm-latn.js":503,"./tzm.js":502,"./ug-cn":504,"./ug-cn.js":504,"./uk":505,"./uk.js":505,"./ur":506,"./ur.js":506,"./uz":507,"./uz-latn":508,"./uz-latn.js":508,"./uz.js":507,"./vi":509,"./vi.js":509,"./x-pseudo":510,"./x-pseudo.js":510,"./yo":511,"./yo.js":511,"./zh-cn":512,"./zh-cn.js":512,"./zh-hk":513,"./zh-hk.js":513,"./zh-mo":514,"./zh-mo.js":514,"./zh-tw":515,"./zh-tw.js":515};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=516},518:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.services=void 0;var o=n(521),a=n(526),l=n(540),s=n(541),c=n(542),d=n(543),p=n(544),m=n(545),u=n(546),g=n(264);t.services=[o.ChangeRequestService,a.GeoObjectTypeManagementService,l.HierarchyService,s.IOService,c.LocalizationManagerService,d.MapService,p.RegistryService,m.SynchronizationConfigService,u.TaskService,g.GeometryService],i(n(521),t),i(n(526),t),i(n(540),t),i(n(541),t),i(n(542),t),i(n(543),t),i(n(544),t),i(n(545),t),i(n(546),t),i(n(264),t)},520:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PageEvent=t.GovernanceStatus=t.ChangeRequest=t.UpdateChangeRequestCurrentObject=t.ChangeRequestCurrentObject=t.UpdateAttributeAction=t.UpdateAttributeOverTimeAction=t.CreateGeoObjectAction=t.AbstractAction=t.ValueOverTimeDiff=t.Geometry=t.Document=t.SummaryKey=void 0;var o=n(258);!function(e){e.NEW="NEW",e.UNMODIFIED="UNMODIFIED",e.DELETE="DELETE",e.UPDATE="UPDATE",e.TIME_CHANGE="TIME_CHANGE",e.VALUE_CHANGE="VALUE_CHANGE"}(t.SummaryKey||(t.SummaryKey={}));var a=function(){};t.Document=a;var l=function(){};t.Geometry=l;var s=function(){};t.ValueOverTimeDiff=s;var c=function(){};t.AbstractAction=c;var d=function(e){function t(){var t=e.call(this)||this;return t.actionType=o.ActionTypes.CREATEGEOOBJECTACTION,t}return i(t,e),t}(c);t.CreateGeoObjectAction=d;var p=function(e){function t(t){var n=e.call(this)||this;return n.actionType=o.ActionTypes.UPDATEATTRIBUTETACTION,n.attributeName=t,n.attributeDiff={valuesOverTime:[]},n}return i(t,e),t}(c);t.UpdateAttributeOverTimeAction=p;var m=function(e){function t(t){var n=e.call(this)||this;return n.actionType=o.ActionTypes.UPDATEATTRIBUTETACTION,n.attributeName=t,n.attributeDiff={},n}return i(t,e),t}(c);t.UpdateAttributeAction=m;var u=function(){};t.ChangeRequestCurrentObject=u;var g=function(){};t.UpdateChangeRequestCurrentObject=g;var h=function(){function e(){this.isNew=!0}return e.getActionsForAttribute=function(e,t,n){if("CreateGeoObject"===e.type)return e.actions;for(var r=[],i=0;i<e.actions.length;++i){var o=e.actions[i];if("UpdateAttributeAction"===o.actionType){var a=o;a.attributeName!==t||"_PARENT_"===t&&a.attributeDiff.hierarchyCode!==n||r.push(e.actions[i])}}return r},e}();t.ChangeRequest=h;var f=function(){};t.GovernanceStatus=f;var y=function(){};t.PageEvent=y},521:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeRequestService=void 0;var r=n(0),i=n(34),o=n(32),a=(n(16),n(0)),l=n(34),s=n(16),c=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.implementDecisions=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/changerequest/implement-decisions",JSON.stringify({request:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.update=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/changerequest/update",JSON.stringify({request:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.setActionStatus=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/changerequest/set-action-status",JSON.stringify({actionOid:e,status:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getAllRequests=function(e,t,n,r){var a=this,l=new i.HttpParams;return l=(l=(l=l.set("pageSize",e.toString())).set("pageNumber",t.toString())).set("filter",n),null!=r&&(l=l.set("oid",r)),this.eventService.start(),this.http.get(acp+"/changerequest/get-all-requests",{params:l}).pipe(o.finalize((function(){a.eventService.complete()}))).toPromise()},e.prototype.rejectChangeRequest=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/changerequest/reject",JSON.stringify({request:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.delete=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/changerequest/delete",JSON.stringify({requestId:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.deleteFile=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/changerequest/delete-file-cr",JSON.stringify({crOid:e,vfOid:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.ɵfac=function(t){return new(t||e)(a.ɵɵinject(l.HttpClient),a.ɵɵinject(s.EventService))},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.ChangeRequestService=c,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(c,[{type:r.Injectable}],(function(){return[{type:l.HttpClient},{type:s.EventService}]}),null)},522:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImportConfiguration=t.Synonym=t.Exclusion=t.LocationProblem=t.TermProblem=t.Term=t.Location=t.ImportSheet=void 0;var r=function(){};t.ImportSheet=r;var i=function(){};t.Location=i;var o=function(){};t.Term=o;var a=function(){};t.TermProblem=a;var l=function(){};t.LocationProblem=l;var s=function(){};t.Exclusion=s;var c=function(){};t.Synonym=c;var d=function(){};t.ImportConfiguration=d},525:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizedTextComponent=void 0;var r=n(0),i=(n(153),n(0)),o=n(1),a=n(68),l=n(259),s=n(22),c=function(e,t){return{row:e,"row-holder":t}},d=function(e){return{"col-md-12":e}},p=function(e){return{"label-holder":e}},m=function(e){return{holder:e}};function u(e,t){if(1&e&&(i.ɵɵelementStart(0,"div"),i.ɵɵelementStart(1,"div",1),i.ɵɵelementStart(2,"div",1),i.ɵɵelementStart(3,"div",2),i.ɵɵelementStart(4,"div",1),i.ɵɵelementStart(5,"label"),i.ɵɵelement(6,"localize",3),i.ɵɵelementStart(7,"span",4),i.ɵɵtext(8," ("),i.ɵɵelement(9,"convert-key-label",3),i.ɵɵtext(10,")"),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(11,"div",1),i.ɵɵelementStart(12,"span",5),i.ɵɵelementStart(13,"textarea",6),i.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=t.$implicit,r=i.ɵɵnextContext();i.ɵɵadvance(1),i.ɵɵproperty("ngClass",i.ɵɵpureFunction2(9,c,r.inlinelayout,!r.inlinelayout)),i.ɵɵadvance(1),i.ɵɵproperty("ngClass",i.ɵɵpureFunction1(12,d,r.inlinelayout)),i.ɵɵadvance(2),i.ɵɵproperty("ngClass",i.ɵɵpureFunction1(14,p,!r.inlinelayout)),i.ɵɵadvance(2),i.ɵɵproperty("key",r.key),i.ɵɵadvance(3),i.ɵɵproperty("key",n.locale),i.ɵɵadvance(2),i.ɵɵproperty("ngClass",i.ɵɵpureFunction1(16,m,!r.inlinelayout)),i.ɵɵadvance(2),i.ɵɵproperty("ngModel",n.value)("disabled",r.disabled)("name","description-"+n.locale)}}var g=function(){function e(){this.key="",this.disabled=!1,this.inlinelayout=!1,this.valueChange=new r.EventEmitter}return e.ɵfac=function(t){return new(t||e)},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["localized-text"]],inputs:{key:"key",value:"value",disabled:"disabled",inlinelayout:"inlinelayout"},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"form-group"],[3,"key"],[2,"color","#BABABA"],[1,"text"],[3,"ngModel","disabled","name","ngModelChange"]],template:function(e,t){1&e&&i.ɵɵtemplate(0,u,14,18,"div",0),2&e&&i.ɵɵproperty("ngForOf",t.value.localeValues)},directives:[o.NgForOf,o.NgClass,a.LocalizeComponent,l.ConvertKeyLabel,s.DefaultValueAccessor,s.NgControlStatus,s.NgModel],styles:["textarea[_ngcontent-%COMP%] {\n\twidth: 100%;\n    border-radius: 5px;\n    min-height: 70px;\n}"]}),e}();t.LocalizedTextComponent=g,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(g,[{type:r.Component,args:[{selector:"localized-text",templateUrl:"./localized-text.component.html",styleUrls:["./localized-text.css"]}]}],(function(){return[]}),{key:[{type:r.Input}],value:[{type:r.Input}],disabled:[{type:r.Input}],inlinelayout:[{type:r.Input}],valueChange:[{type:r.Output}]})},526:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectTypeManagementService=void 0;var r=n(0),i=n(31),o=n(0),a=function(){function e(){this.modalStateChangedSource=new i.Subject,this.modalStepChange=this.modalStateChangedSource.asObservable()}return e.prototype.getModalState=function(){return this.modalState},e.prototype.setModalState=function(e){this.modalState=e,this.modalStateChangedSource.next(this.modalState)},e.ɵfac=function(t){return new(t||e)},e.ɵprov=o.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.GeoObjectTypeManagementService=a,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(a,[{type:r.Injectable}],(function(){return[]}),null)},527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeInputComponent=void 0;var r=n(0),i=n(7),o=(n(203),n(518),n(0)),a=n(518),l=n(68),s=n(22),c=n(570),d=n(531),p=n(1),m=n(525),u=n(265);function g(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"localized-text",9),o.ɵɵlistener("valueChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().attribute.description=e})),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵproperty("value",r.attribute.description)}}function h(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"div",1),o.ɵɵelementStart(2,"label"),o.ɵɵelement(3,"localize",10),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div",3),o.ɵɵelementStart(5,"span",4),o.ɵɵelementStart(6,"input",11),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().attribute.precision=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵadvance(6),o.ɵɵproperty("ngModel",r.attribute.precision)}}function f(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"div",1),o.ɵɵelementStart(2,"label"),o.ɵɵelement(3,"localize",12),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div",3),o.ɵɵelementStart(5,"span",4),o.ɵɵelementStart(6,"input",13),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().attribute.scale=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵadvance(6),o.ɵɵproperty("ngModel",r.attribute.scale)}}var y=function(){function e(e,t){this.hierarchyService=e,this.cdr=t,this.disableCodeField=!1,this.excludeDescription=!1,this.isDecimal=!1,this.attributeChange=new r.EventEmitter,this.message=null,this.state="none"}return e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){this.state="show",this.cdr.detectChanges()},e.prototype.ngOnChanges=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.handleOnSubmit=function(){},e.prototype.toggleIsUnique=function(){this.attribute.unique=!this.attribute.unique},e.prototype.animate=function(){this.state="none"},e.prototype.onAnimationDone=function(e){this.state="show"},e.prototype.isValid=function(){return!!this.attribute.code&&(-1===this.attribute.code.indexOf(" ")&&(0!==this.attribute.label.localeValues[0].value.length&&((!this.isDecimal||null!=this.attribute.precision&&""!=this.attribute.precision.toString())&&(!this.isDecimal||null!=this.attribute.scale&&""!=this.attribute.scale.toString()))))},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.HierarchyService),o.ɵɵdirectiveInject(o.ChangeDetectorRef))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["attribute-input"]],inputs:{disableCodeField:"disableCodeField",excludeDescription:"excludeDescription",isDecimal:"isDecimal",geoObjectType:"geoObjectType",attribute:"attribute"},outputs:{attributeChange:"attributeChange"},features:[o.ɵɵNgOnChangesFeature],decls:12,vars:6,consts:[[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["autofocus","","type","text","name","code","required","","geoObjectAttributeCode","",3,"disabled","ngModel","ngModelChange"],["key","data.property.label.label",3,"value","valueChange"],["key","data.property.label.description",3,"value","valueChange",4,"ngIf"],["class","row-holder",4,"ngIf"],["key","data.property.label.description",3,"value","valueChange"],["key","data.property.label.length"],["type","text","name","precision","OnlyNumber","true","required","",3,"ngModel","ngModelChange"],["key","data.property.label.decimal"],["type","text","name","scale","OnlyNumber","true","required","",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"div",0),o.ɵɵelementStart(2,"div",1),o.ɵɵelementStart(3,"label"),o.ɵɵelement(4,"localize",2),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(5,"div",3),o.ɵɵelementStart(6,"span",4),o.ɵɵelementStart(7,"input",5),o.ɵɵlistener("ngModelChange",(function(e){return t.attribute.code=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(8,"localized-input",6),o.ɵɵlistener("valueChange",(function(e){return t.attribute.label=e})),o.ɵɵelementEnd(),o.ɵɵtemplate(9,g,1,1,"localized-text",7),o.ɵɵtemplate(10,h,7,1,"div",8),o.ɵɵtemplate(11,f,7,1,"div",8),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(7),o.ɵɵproperty("disabled",t.disableCodeField)("ngModel",t.attribute.code),o.ɵɵadvance(1),o.ɵɵproperty("value",t.attribute.label),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!t.excludeDescription),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.isDecimal),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.isDecimal))},directives:[l.LocalizeComponent,s.DefaultValueAccessor,s.RequiredValidator,c.GeoObjectAttributeCodeValidator,s.NgControlStatus,s.NgModel,d.LocalizedInputComponent,p.NgIf,m.LocalizedTextComponent,u.OnlyNumber],styles:['input[type="text"][_ngcontent-%COMP%] {\n    margin: 2px 0 2px 0 !important;\n    float: none !important;\n}\n\nbutton[_ngcontent-%COMP%] {\n    margin-top: 5px;\n    float: right;\n}\n\nlabel[_ngcontent-%COMP%] {\n    color: #999;\n    font-weight: bold;\n}'],data:{animation:[i.trigger("toggleInputs",[i.state("none, void",i.style({opacity:0})),i.state("show",i.style({opacity:1})),i.transition("none => show",i.animate("300ms"))])]}}),e}();t.AttributeInputComponent=y,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(y,[{type:r.Component,args:[{selector:"attribute-input",templateUrl:"./attribute-input.component.html",styleUrls:["./attribute-input.css"],animations:[i.trigger("toggleInputs",[i.state("none, void",i.style({opacity:0})),i.state("show",i.style({opacity:1})),i.transition("none => show",i.animate("300ms"))])]}]}],(function(){return[{type:a.HierarchyService},{type:o.ChangeDetectorRef}]}),{disableCodeField:[{type:r.Input}],excludeDescription:[{type:r.Input}],isDecimal:[{type:r.Input}],geoObjectType:[{type:r.Input}],attribute:[{type:r.Input}],attributeChange:[{type:r.Output}]})},528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublishModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=(n(518),n(112),n(111)),a=(n(16),n(0)),l=n(518),s=n(16),c=n(30),d=n(112),p=n(1),m=n(22),u=n(68),g=n(259),h=n(261);function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",64),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function y(e,t){1&e&&(a.ɵɵelementStart(0,"h1"),a.ɵɵelement(1,"localize",65),a.ɵɵelementEnd())}function v(e,t){if(1&e&&(a.ɵɵelementStart(0,"h1"),a.ɵɵtext(1),a.ɵɵelement(2,"localize",66),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",n.master.displayLabel.localizedValue," ")}}function b(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",8),a.ɵɵelementStart(1,"div",9),a.ɵɵelementStart(2,"label"),a.ɵɵelement(3,"localize",67),a.ɵɵelementStart(4,"span",68),a.ɵɵtext(5," ("),a.ɵɵelement(6,"convert-key-label",62),a.ɵɵtext(7,")"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"div",11),a.ɵɵelementStart(9,"input",69),a.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit,r=a.ɵɵnextContext();a.ɵɵadvance(6),a.ɵɵproperty("key",n.locale),a.ɵɵadvance(3),a.ɵɵproperty("ngModel",n.value)("name","label-"+n.locale)("disabled",r.readonly)("required","defaultLocale"===n.locale)}}function S(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",74),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label)}}function C(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",8),a.ɵɵelementStart(1,"div",9),a.ɵɵelementStart(2,"label",70),a.ɵɵelement(3,"localize",71),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"div",11),a.ɵɵelementStart(5,"select",72),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().master.typeCode=e}))("change",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onChange()})),a.ɵɵelement(6,"option"),a.ɵɵtemplate(7,S,2,2,"option",73),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(5),a.ɵɵproperty("ngModel",r.master.typeCode),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",r.types)}}function E(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",8),a.ɵɵelementStart(1,"div",9),a.ɵɵelementStart(2,"label",70),a.ɵɵelement(3,"localize",71),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"div",11),a.ɵɵelementStart(5,"input",75),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().master.typeLabel.localizedValue=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(5),a.ɵɵproperty("ngModel",r.master.typeLabel.localizedValue)}}function x(e,t){1&e&&(a.ɵɵelementStart(0,"small",76),a.ɵɵelement(1,"localize",77),a.ɵɵelementEnd())}function O(e,t){if(1&e&&(a.ɵɵelementStart(0,"span",78),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",n.formatDate(n.master.publishingStartDate)," ")}}var I=function(){return["form-control"]};function w(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"date-field",79),a.ɵɵlistener("valueChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().master.publishingStartDate=e})),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵproperty("value",r.master.publishingStartDate)("classNames",a.ɵɵpureFunction0(6,I))("inputName","publishingStartDate")("allowFutureDates",!1)("required",!1)("disable",r.readonly)}}function M(e,t){1&e&&(a.ɵɵelementStart(0,"div",8),a.ɵɵelement(1,"div",9),a.ɵɵelementStart(2,"div",11),a.ɵɵelement(3,"localize",80),a.ɵɵelementEnd(),a.ɵɵelementEnd())}var T=function(e,t){return{"chk-checked":e,disabled:t}};function j(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",35),a.ɵɵelementStart(1,"div",36),a.ɵɵelementStart(2,"div",82),a.ɵɵlistener("click",(function(e){a.ɵɵrestoreView(n);var r=t.$implicit;return a.ɵɵnextContext(2).getIsDisabled(e)?null:r.selected=!r.selected})),a.ɵɵelement(3,"span"),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"label",83),a.ɵɵtext(5),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=a.ɵɵnextContext(2);a.ɵɵadvance(2),a.ɵɵproperty("ngClass",a.ɵɵpureFunction2(2,T,r.selected,i.readonly||i.edit)),a.ɵɵadvance(3),a.ɵɵtextInterpolate(r.label)}}function k(e,t){if(1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"div",9),a.ɵɵelementStart(3,"label"),a.ɵɵtext(4),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",11),a.ɵɵtemplate(6,j,6,5,"div",81),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵadvance(4),a.ɵɵtextInterpolate1(" ",n.label," "),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",n.parents)}}function R(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",35),a.ɵɵelementStart(1,"div",36),a.ɵɵelementStart(2,"div",82),a.ɵɵlistener("click",(function(e){a.ɵɵrestoreView(n);var r=t.$implicit;return a.ɵɵnextContext(2).getIsDisabled(e)?null:r.selected=!r.selected})),a.ɵɵelement(3,"span"),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"label",83),a.ɵɵtext(5),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=a.ɵɵnextContext(2);a.ɵɵadvance(2),a.ɵɵproperty("ngClass",a.ɵɵpureFunction2(2,T,r.selected,i.readonly||i.edit)),a.ɵɵadvance(3),a.ɵɵtextInterpolate(r.label)}}function z(e,t){if(1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"div",9),a.ɵɵelementStart(3,"label"),a.ɵɵelement(4,"localize",84),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",11),a.ɵɵtemplate(6,R,6,5,"div",81),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(6),a.ɵɵproperty("ngForOf",n.master.subtypeHierarchies)}}function P(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",85),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onSubmit()})),a.ɵɵelement(1,"localize",86),a.ɵɵelementEnd()}if(2&e){a.ɵɵnextContext();var r=a.ɵɵreference(6);a.ɵɵproperty("disabled",r.invalid)}}var D=function(){function e(e,t,n,r,i,o){this.service=e,this.iService=t,this.lService=n,this.bsModalRef=r,this.authService=i,this.dateService=o,this.currentDate=new Date,this.message=null,this.readonly=!1,this.edit=!1,this.isNew=!1}return e.prototype.ngOnInit=function(){var e=this;this.onMasterListChange=new i.Subject,this.master&&this.readonly||(this.iService.listGeoObjectTypes(!0).then((function(t){for(var n=[],r=0;r<t.length;++r){var i=t[r].orgCode,o=null!=t[r].superTypeCode?t[r].superTypeCode:t[r].code;e.authService.isGeoObjectTypeRM(i,o)&&n.push(t[r])}e.types=n})).catch((function(t){e.error(t)})),this.master={oid:null,typeCode:"",displayLabel:this.lService.create(),code:"",representativityDate:null,publishingStartDate:null,publishDate:null,listAbstract:"",process:"",progress:"",accessConstraints:"",useConstraints:"",acknowledgements:"",disclaimer:"",contactName:"",organization:"",telephoneNumber:"",email:"",hierarchies:[],subtypeHierarchies:[],leaf:!1,frequency:"ANNUAL",isMaster:null,visibility:null})},e.prototype.ngAfterContentInit=function(){},e.prototype.init=function(e){this.master.organization=e.oid},e.prototype.getIsDisabled=function(e){for(var t=e.target.classList,n=0;n<t.length;n++){if("disabled"===t[n])return!0}return!1},e.prototype.onChange=function(){var e=this;null!=this.master.typeCode&&this.master.typeCode.length>0?(this.iService.getHierarchiesForType(this.master.typeCode,!0).then((function(t){e.master.hierarchies=t})).catch((function(t){e.error(t)})),this.iService.getHierarchiesForSubtypes(this.master.typeCode,!1).then((function(t){e.master.subtypeHierarchies=t})).catch((function(t){e.error(t)}))):this.master.hierarchies=[]},e.prototype.onSubmit=function(){var e=this;this.service.createMasterList(this.master).then((function(t){e.onMasterListChange.next(t),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.onCancel=function(){this.bsModalRef.hide()},e.prototype.ngOnDestroy=function(){this.onMasterListChange.unsubscribe()},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(l.IOService),a.ɵɵdirectiveInject(s.LocalizationService),a.ɵɵdirectiveInject(c.BsModalRef),a.ɵɵdirectiveInject(s.AuthService),a.ɵɵdirectiveInject(d.DateService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["publish-modal"]],decls:135,vars:44,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],[4,"ngIf"],["autocomplete","off",1,"modal-form"],["form","ngForm"],["class","row-holder",4,"ngFor","ngForOf"],["class","row-holder",4,"ngIf"],[1,"row-holder"],[1,"label-holder"],["key","masterlist.code"],[1,"holder"],["name","code","type","text","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.frequency"],["name","frequency","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],["frequency","ngModel"],["value","ANNUAL"],["key","georegistry.frequency.annual"],["value","BIANNUAL"],["key","georegistry.frequency.biannual"],["value","QUARTER"],["key","georegistry.frequency.quarter"],["value","MONTHLY"],["key","georegistry.frequency.monthly"],["class","form-text text-danger",4,"ngIf"],["key","data.property.label.publishingStartDate"],["style","line-height: 40px;","class","date-string-display",4,"ngIf"],["label","",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange",4,"ngIf"],["key","masterlist.visibility"],["name","visibility","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","PUBLIC"],["key","masterlist.public"],["value","PRIVATE"],["key","masterlist.private"],["key","masterlist.ismaster"],[1,"row"],[1,"check-block",2,"margin","10px"],["name","isMaster",1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],["key","masterlist.listAbstract"],["name","listAbstract",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.process"],["name","process",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.progress"],["name","progress","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.accessConstraints"],["name","accessConstraints","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.useConstraints"],["name","useConstraints","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.acknowledgements"],["name","acknowledgements",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.disclaimer"],["name","disclaimer",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.contact"],["key","masterlist.contactName"],["name","contactName","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.telephoneNumber"],["name","telephoneNumber","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.email"],["name","email","type","email",1,"form-control",3,"ngModel","disabled","ngModelChange"],[4,"ngFor","ngForOf"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],[3,"key"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["key","type.publish.title"],["key","type.publish.view.title"],["key","masterlist.label"],[2,"color","#BABABA"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],["for","typeCode"],["key","io.geoObjectType"],["id","typeCode","name","typeCode","required","",1,"select-area",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","typeCode","type","text","disabled","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-text","text-danger"],["key","masterlist.change.frequency"],[1,"date-string-display",2,"line-height","40px"],["label","",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange"],["key","masterlist.parents"],["class","row",4,"ngFor","ngForOf"],["name","unique",1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],[2,"margin","3px 10px"],["key","masterlist.subtypeHierarchies"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"]],template:function(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,f,2,1,"div",1),a.ɵɵelementStart(2,"div",2),a.ɵɵtemplate(3,y,2,0,"h1",3),a.ɵɵtemplate(4,v,3,1,"h1",3),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"form",4,5),a.ɵɵelementStart(7,"fieldset"),a.ɵɵtemplate(8,b,10,5,"div",6),a.ɵɵtemplate(9,C,8,2,"div",7),a.ɵɵtemplate(10,E,6,1,"div",7),a.ɵɵelementStart(11,"div",8),a.ɵɵelementStart(12,"div",9),a.ɵɵelementStart(13,"label"),a.ɵɵelement(14,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(15,"div",11),a.ɵɵelementStart(16,"input",12),a.ɵɵlistener("ngModelChange",(function(e){return t.master.code=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(17,"div",8),a.ɵɵelementStart(18,"div",9),a.ɵɵelementStart(19,"label"),a.ɵɵelement(20,"localize",13),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(21,"div",11),a.ɵɵelementStart(22,"select",14,15),a.ɵɵlistener("ngModelChange",(function(e){return t.master.frequency=e})),a.ɵɵelement(24,"option"),a.ɵɵelementStart(25,"option",16),a.ɵɵelement(26,"localize",17),a.ɵɵelementEnd(),a.ɵɵelementStart(27,"option",18),a.ɵɵelement(28,"localize",19),a.ɵɵelementEnd(),a.ɵɵelementStart(29,"option",20),a.ɵɵelement(30,"localize",21),a.ɵɵelementEnd(),a.ɵɵelementStart(31,"option",22),a.ɵɵelement(32,"localize",23),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(33,x,2,0,"small",24),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(34,"div",8),a.ɵɵelementStart(35,"div",9),a.ɵɵelementStart(36,"label"),a.ɵɵelement(37,"localize",25),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(38,"div",11),a.ɵɵtemplate(39,O,2,1,"span",26),a.ɵɵtemplate(40,w,1,7,"date-field",27),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(41,"div",8),a.ɵɵelementStart(42,"div",9),a.ɵɵelementStart(43,"label"),a.ɵɵelement(44,"localize",28),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(45,"div",11),a.ɵɵelementStart(46,"select",29),a.ɵɵlistener("ngModelChange",(function(e){return t.master.visibility=e})),a.ɵɵelement(47,"option"),a.ɵɵelementStart(48,"option",30),a.ɵɵelement(49,"localize",31),a.ɵɵelementEnd(),a.ɵɵelementStart(50,"option",32),a.ɵɵelement(51,"localize",33),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(52,"div",8),a.ɵɵelementStart(53,"div",9),a.ɵɵelementStart(54,"label"),a.ɵɵelement(55,"localize",34),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(56,"div",11),a.ɵɵelementStart(57,"div",35),a.ɵɵelementStart(58,"div",36),a.ɵɵelementStart(59,"div",37),a.ɵɵlistener("click",(function(e){return t.getIsDisabled(e)?null:t.master.isMaster=!t.master.isMaster})),a.ɵɵelement(60,"span"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(61,"div",8),a.ɵɵelementStart(62,"div",9),a.ɵɵelementStart(63,"label"),a.ɵɵelement(64,"localize",38),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(65,"div",11),a.ɵɵelementStart(66,"textarea",39),a.ɵɵlistener("ngModelChange",(function(e){return t.master.listAbstract=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(67,"div",8),a.ɵɵelementStart(68,"div",9),a.ɵɵelementStart(69,"label"),a.ɵɵelement(70,"localize",40),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(71,"div",11),a.ɵɵelementStart(72,"textarea",41),a.ɵɵlistener("ngModelChange",(function(e){return t.master.process=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(73,"div",8),a.ɵɵelementStart(74,"div",9),a.ɵɵelementStart(75,"label"),a.ɵɵelement(76,"localize",42),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(77,"div",11),a.ɵɵelementStart(78,"input",43),a.ɵɵlistener("ngModelChange",(function(e){return t.master.progress=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(79,"div",8),a.ɵɵelementStart(80,"div",9),a.ɵɵelementStart(81,"label"),a.ɵɵelement(82,"localize",44),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(83,"div",11),a.ɵɵelementStart(84,"input",45),a.ɵɵlistener("ngModelChange",(function(e){return t.master.accessConstraints=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(85,"div",8),a.ɵɵelementStart(86,"div",9),a.ɵɵelementStart(87,"label"),a.ɵɵelement(88,"localize",46),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(89,"div",11),a.ɵɵelementStart(90,"input",47),a.ɵɵlistener("ngModelChange",(function(e){return t.master.useConstraints=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(91,"div",8),a.ɵɵelementStart(92,"div",9),a.ɵɵelementStart(93,"label"),a.ɵɵelement(94,"localize",48),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(95,"div",11),a.ɵɵelementStart(96,"textarea",49),a.ɵɵlistener("ngModelChange",(function(e){return t.master.acknowledgements=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(97,"div",8),a.ɵɵelementStart(98,"div",9),a.ɵɵelementStart(99,"label"),a.ɵɵelement(100,"localize",50),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(101,"div",11),a.ɵɵelementStart(102,"textarea",51),a.ɵɵlistener("ngModelChange",(function(e){return t.master.disclaimer=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(103,"div",8),a.ɵɵelement(104,"div",9),a.ɵɵelementStart(105,"div",11),a.ɵɵelement(106,"localize",52),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(107,"div",8),a.ɵɵelementStart(108,"div",9),a.ɵɵelementStart(109,"label"),a.ɵɵelement(110,"localize",53),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(111,"div",11),a.ɵɵelementStart(112,"input",54),a.ɵɵlistener("ngModelChange",(function(e){return t.master.contactName=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(113,"div",8),a.ɵɵelementStart(114,"div",9),a.ɵɵelementStart(115,"label"),a.ɵɵelement(116,"localize",55),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(117,"div",11),a.ɵɵelementStart(118,"input",56),a.ɵɵlistener("ngModelChange",(function(e){return t.master.telephoneNumber=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(119,"div",8),a.ɵɵelementStart(120,"div",9),a.ɵɵelementStart(121,"label"),a.ɵɵelement(122,"localize",57),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(123,"div",11),a.ɵɵelementStart(124,"input",58),a.ɵɵlistener("ngModelChange",(function(e){return t.master.email=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(125,M,4,0,"div",7),a.ɵɵtemplate(126,k,7,2,"div",59),a.ɵɵtemplate(127,z,7,1,"div",3),a.ɵɵelementStart(128,"div",8),a.ɵɵelement(129,"div",9),a.ɵɵelementStart(130,"div",11),a.ɵɵelementStart(131,"div",60),a.ɵɵelementStart(132,"button",61),a.ɵɵlistener("click",(function(){return t.onCancel()})),a.ɵɵelement(133,"localize",62),a.ɵɵelementEnd(),a.ɵɵtemplate(134,P,2,1,"button",63),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵreference(23);a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",t.isNew),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.isNew),a.ɵɵadvance(4),a.ɵɵproperty("ngForOf",t.master.displayLabel.localeValues),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.types&&!(t.readonly||t.edit)),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.types&&(t.readonly||t.edit)),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.code)("disabled",t.readonly||t.edit),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.frequency)("disabled",t.readonly),a.ɵɵadvance(11),a.ɵɵproperty("ngIf",t.edit&&n.dirty),a.ɵɵadvance(6),a.ɵɵproperty("ngIf",t.readonly),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.visibility)("disabled",t.readonly),a.ɵɵadvance(13),a.ɵɵproperty("ngClass",a.ɵɵpureFunction2(41,T,t.master.isMaster,t.readonly||t.edit)),a.ɵɵadvance(7),a.ɵɵproperty("ngModel",t.master.listAbstract)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.process)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.progress)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.accessConstraints)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.useConstraints)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.acknowledgements)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.disclaimer)("disabled",t.readonly),a.ɵɵadvance(10),a.ɵɵproperty("ngModel",t.master.contactName)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.telephoneNumber)("disabled",t.readonly),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.master.email)("disabled",t.readonly),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.master.hierarchies.length>0),a.ɵɵadvance(1),a.ɵɵproperty("ngForOf",t.master.hierarchies),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.master.subtypeHierarchies.length>0),a.ɵɵadvance(6),a.ɵɵproperty("key",t.readonly?"io.back":"io.cancel"),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.readonly)}},directives:[p.NgIf,m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,p.NgForOf,u.LocalizeComponent,m.DefaultValueAccessor,m.RequiredValidator,m.NgControlStatus,m.NgModel,m.SelectControlValueAccessor,m.NgSelectOption,m.ɵangular_packages_forms_forms_z,p.NgClass,g.ConvertKeyLabel,h.DateFieldComponent],encapsulation:2}),e}();t.PublishModalComponent=D,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(D,[{type:r.Component,args:[{selector:"publish-modal",templateUrl:"./publish-modal.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:l.IOService},{type:s.LocalizationService},{type:c.BsModalRef},{type:s.AuthService},{type:d.DateService}]}),null)},529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectSharedAttributeEditorComponent=void 0;var r=n(0),i=n(1),o=n(7),a=n(153),l=(n(16),n(518),n(112),n(203)),s=n(520),c=n(258),d=n(552),p=n(0),m=n(16),u=n(518),g=n(112),h=n(1),f=n(68),y=n(22),v=n(586),b=n(587),S=n(588),C=["geometryEditor"],E=["attributeForm"];function x(e,t){1&e&&p.ɵɵelement(0,"span",17)}function O(e,t){1&e&&p.ɵɵelement(0,"span",18)}function I(e,t){1&e&&p.ɵɵelement(0,"span",17)}function w(e,t){1&e&&p.ɵɵelement(0,"span",18)}function M(e,t){1&e&&p.ɵɵelement(0,"span",17)}function T(e,t){1&e&&p.ɵɵelement(0,"span",18)}function j(e,t){1&e&&p.ɵɵelement(0,"span",17)}function k(e,t){1&e&&p.ɵɵelement(0,"span",18)}function R(e,t){1&e&&(p.ɵɵelementStart(0,"span"),p.ɵɵelement(1,"localize",28),p.ɵɵelementEnd())}function z(e,t){1&e&&(p.ɵɵelementStart(0,"span"),p.ɵɵelement(1,"localize",29),p.ɵɵelementEnd())}function P(e,t){if(1&e&&(p.ɵɵelementStart(0,"span"),p.ɵɵtext(1),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext().$implicit;p.ɵɵadvance(1),p.ɵɵtextInterpolate1(" ",n.label.localizedValue," ")}}function D(e,t){if(1&e&&(p.ɵɵelementStart(0,"div"),p.ɵɵelement(1,"manage-versions",30),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext().$implicit,r=p.ɵɵnextContext(3);p.ɵɵadvance(1),p.ɵɵproperty("geoObjectType",r.geoObjectType)("changeRequestEditor",r.changeRequestEditor)("attributeType",n)("readonly",r.readOnly)("isNew",r.isNew)}}function A(e,t){if(1&e){var n=p.ɵɵgetCurrentView();p.ɵɵelementStart(0,"input",32),p.ɵɵlistener("ngModelChange",(function(e){p.ɵɵrestoreView(n);var t=p.ɵɵnextContext(2).$implicit;return p.ɵɵnextContext(3).changeRequestEditor.getEditorForAttribute(t).value=e})),p.ɵɵelementEnd()}if(2&e){var r=p.ɵɵnextContext(2).$implicit,i=p.ɵɵnextContext(3);p.ɵɵstyleMap(i.readOnly||"code"===r.code&&!i.isNew?"":"color:#333"),p.ɵɵpropertyInterpolate1("id","mod-",r.code,""),p.ɵɵpropertyInterpolate1("name","mod-",r.code,""),p.ɵɵproperty("ngModel",i.changeRequestEditor.getEditorForAttribute(r).value)("disabled",i.readOnly||"code"===r.code&&!i.isNew)}}function V(e,t){if(1&e&&(p.ɵɵelementStart(0,"div"),p.ɵɵelement(1,"standard-attribute-editor",33),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext(2).$implicit,r=p.ɵɵnextContext(3);p.ɵɵadvance(1),p.ɵɵproperty("changeRequestEditor",r.changeRequestEditor)("geoObjectType",r.geoObjectType)("changeRequest",r.changeRequest)("attributeType",n)("geoObject",r.changeRequestEditor.geoObject)("readonly",r.readOnly)("isNew",r.isNew)}}function N(e,t){if(1&e&&(p.ɵɵelementStart(0,"div"),p.ɵɵtemplate(1,A,1,6,"input",31),p.ɵɵtemplate(2,V,2,7,"div",16),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext().$implicit,r=p.ɵɵnextContext(3);p.ɵɵadvance(1),p.ɵɵproperty("ngIf",r.changeRequestEditor.geoObject&&"code"===n.code),p.ɵɵadvance(1),p.ɵɵproperty("ngIf","code"!==n.code)}}function L(e,t){if(1&e&&(p.ɵɵelementStart(0,"li",23),p.ɵɵelementStart(1,"div",24),p.ɵɵelementStart(2,"div",25),p.ɵɵelementStart(3,"h4",26),p.ɵɵtemplate(4,R,2,0,"span",16),p.ɵɵtemplate(5,z,2,0,"span",16),p.ɵɵtemplate(6,P,2,1,"span",16),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(7,"div",27),p.ɵɵtemplate(8,D,2,5,"div",16),p.ɵɵtemplate(9,N,3,2,"div",16),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e){var n=t.$implicit;p.ɵɵadvance(4),p.ɵɵproperty("ngIf","code"===n.code),p.ɵɵadvance(1),p.ɵɵproperty("ngIf","displayLabel"===n.code),p.ɵɵadvance(1),p.ɵɵproperty("ngIf","code"!==n.code&&"displayLabel"!==n.code),p.ɵɵadvance(2),p.ɵɵproperty("ngIf","code"!==n.code&&n.isChangeOverTime),p.ɵɵadvance(1),p.ɵɵproperty("ngIf",!n.isChangeOverTime)}}function _(e,t){if(1&e&&(p.ɵɵelementStart(0,"div",0),p.ɵɵelementStart(1,"div",1),p.ɵɵelement(2,"span",20),p.ɵɵelementStart(3,"ul",21),p.ɵɵtemplate(4,L,10,5,"li",22),p.ɵɵpipe(5,"geoObjectAttributeExcludesFilter"),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext(2);p.ɵɵadvance(4),p.ɵɵproperty("ngForOf",p.ɵɵpipeBind2(5,1,n.geoObjectType.attributes,n.geoObjectAttributeExcludes))}}function F(e,t){if(1&e&&(p.ɵɵelementStart(0,"li",23),p.ɵɵelementStart(1,"div",24),p.ɵɵelementStart(2,"div",25),p.ɵɵelementStart(3,"h4",26),p.ɵɵelementStart(4,"span"),p.ɵɵtext(5),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(6,"div",27),p.ɵɵelement(7,"manage-versions",34),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e){var n=t.$implicit,r=p.ɵɵnextContext(3);p.ɵɵadvance(5),p.ɵɵtextInterpolate1(" ",n.label," "),p.ɵɵadvance(2),p.ɵɵproperty("geoObjectType",r.geoObjectType)("changeRequestEditor",r.changeRequestEditor)("attributeType",r.parentAttributeType)("readonly",r.readOnly)("isNew",r.isNew)("hierarchy",n)}}function H(e,t){if(1&e&&(p.ɵɵelementStart(0,"div",0),p.ɵɵelementStart(1,"div",1),p.ɵɵelementStart(2,"ul",21),p.ɵɵtemplate(3,F,8,7,"li",22),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext(2);p.ɵɵadvance(3),p.ɵɵproperty("ngForOf",n.hierarchies)}}function G(e,t){if(1&e&&(p.ɵɵelementStart(0,"div"),p.ɵɵelementStart(1,"div",24),p.ɵɵelementStart(2,"div",25),p.ɵɵelementStart(3,"h4",26),p.ɵɵelementStart(4,"span"),p.ɵɵelement(5,"localize",35),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(6,"div",27),p.ɵɵelement(7,"manage-versions",36),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext(2);p.ɵɵadvance(7),p.ɵɵproperty("geoObjectType",n.geoObjectType)("changeRequestEditor",n.changeRequestEditor)("attributeType",n.geometryAttributeType)("readonly",n.readOnly)("isNew",n.isNew)("isGeometryInlined",n.isGeometryInlined)}}function q(e,t){if(1&e&&(p.ɵɵelementStart(0,"div"),p.ɵɵelementStart(1,"div",24),p.ɵɵelementStart(2,"div",25),p.ɵɵelementStart(3,"h4",26),p.ɵɵelementStart(4,"span"),p.ɵɵtext(5),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(6,"div",27),p.ɵɵelement(7,"manage-versions",36),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(8,"div",24),p.ɵɵelementStart(9,"div",25),p.ɵɵelementStart(10,"h4",26),p.ɵɵelementStart(11,"span"),p.ɵɵtext(12),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(13,"div",27),p.ɵɵelement(14,"standard-attribute-editor",33),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext(2);p.ɵɵadvance(5),p.ɵɵtextInterpolate(n.getAttribute("exists").label.localizedValue),p.ɵɵadvance(2),p.ɵɵproperty("geoObjectType",n.geoObjectType)("changeRequestEditor",n.changeRequestEditor)("attributeType",n.getAttribute("exists"))("readonly",n.readOnly)("isNew",n.isNew)("isGeometryInlined",n.isGeometryInlined),p.ɵɵadvance(5),p.ɵɵtextInterpolate(n.getAttribute("invalid").label.localizedValue),p.ɵɵadvance(2),p.ɵɵproperty("changeRequestEditor",n.changeRequestEditor)("geoObjectType",n.geoObjectType)("changeRequest",n.changeRequest)("attributeType",n.getAttribute("invalid"))("geoObject",n.changeRequestEditor.geoObject)("readonly",n.readOnly)("isNew",n.isNew)}}function B(e,t){if(1&e&&(p.ɵɵelementStart(0,"div"),p.ɵɵtemplate(1,_,6,4,"div",19),p.ɵɵtemplate(2,H,4,1,"div",19),p.ɵɵtemplate(3,G,8,6,"div",16),p.ɵɵtemplate(4,q,15,15,"div",16),p.ɵɵelementEnd()),2&e){var n=p.ɵɵnextContext();p.ɵɵadvance(1),p.ɵɵproperty("ngIf",0===n.tabIndex),p.ɵɵadvance(1),p.ɵɵproperty("ngIf",1===n.tabIndex),p.ɵɵadvance(1),p.ɵɵproperty("ngIf",2===n.tabIndex),p.ɵɵadvance(1),p.ɵɵproperty("ngIf",3===n.tabIndex)}}var U=function(e,t){return{active:e,disabled:t}},$=function(e){return{active:e}},J=function(){function e(e,t,n,i){this.lService=e,this.geomService=t,this.authService=n,this.dateService=i,this.postGeoObject=null,this.showAllInstances=!1,this.tabIndex=0,this.isContributorOnly=!1,this.attributeExcludes=[],this.readOnly=!1,this.isNew=!1,this.isGeometryInlined=!1,this.onManageVersion=new r.EventEmitter,this.onChange=new r.EventEmitter,this.modifiedTermOption=null,this.currentTermOption=null,this.geoObjectAttributeExcludes=["uid","sequence","type","lastUpdateDate","createDate","invalid","exists"],this.isContributorOnly=this.authService.isContributerOnly()}return e.prototype.ngOnInit=function(){null!=this.attributeExcludes&&(this.geoObjectAttributeExcludes.push.apply(this.geoObjectAttributeExcludes,this.attributeExcludes),this.isGeometryInlined||this.geoObjectAttributeExcludes.push("geometry")),this.geometryAttributeType=this.getAttribute("geometry"),null==this.geometryAttributeType&&(this.geometryAttributeType=new l.AttributeType("geometry","geometry",new a.LocalizedValue("Geometry",null),new a.LocalizedValue("Geometry",null),!0,!1,!1,!0)),this.parentAttributeType=new l.AttributeType("_PARENT_","_PARENT_",new a.LocalizedValue("Parents",null),new a.LocalizedValue("Parents",null),!0,!1,!1,!0),null==this.changeRequest?this.changeRequest=this.createNewChangeRequest():(this.changeRequest.actions||(this.changeRequest.actions=[]),0===this.changeRequest.actions.length&&this.isNew&&(this.changeRequest.actions=this.createNewChangeRequest().actions)),this.changeRequestEditor=new d.ChangeRequestEditor(this.changeRequest,this.postGeoObject,this.geoObjectType,this.hierarchies,this.geometryAttributeType,this.parentAttributeType,this.lService,this.dateService),this.shouldForceSetExist()&&this.changePage(3)},e.prototype.getChangeRequestEditor=function(){return this.changeRequestEditor},e.prototype.createNewChangeRequest=function(){var e=new s.ChangeRequest;if(e.approvalStatus="PENDING",e.actions=[],this.isNew){e.type="CreateGeoObject";var t=new s.CreateGeoObjectAction;t.geoObjectJson=this.postGeoObject,t.parentJson=this.hierarchies,e.actions[0]=t}else e.type="UpdateGeoObject";return e},e.prototype.shouldForceSetExist=function(){if(this.isNew&&this.postGeoObject.attributes.exists){var e=this.postGeoObject.attributes.exists.values;if(e&&e.length>0){var t=e[0];return null==t.startDate||null==t.endDate||void 0===t.value||null===t.value}}return this.isNew},e.prototype.getAttribute=function(e){if("_PARENT_"===e)return this.parentAttributeType;if("geometry"===e)return this.geometryAttributeType;for(var t=0;t<this.geoObjectType.attributes.length;++t)if(this.geoObjectType.attributes[t].code===e)return this.geoObjectType.attributes[t];return null},e.prototype.changePage=function(e){this.shouldForceSetExist()&&3!==e||(this.geomService.destroy(!1),this.tabIndex=e)},e.prototype.hasChanges=function(e){var t=this.changeRequest.actions.length;if(t>0)for(var n=0;n<t;++n){var r=this.changeRequest.actions[n];if(r.actionType===c.ActionTypes.CREATEGEOOBJECTACTION)return!1;if(r.actionType===c.ActionTypes.UPDATEATTRIBUTETACTION){var i=r;if("_PARENT_"===i.attributeName&&1===e)return!0;if("geometry"===i.attributeName&&2===e)return!0;if(("invalid"===i.attributeName||"exists"===i.attributeName)&&3===e)return!0;if(0===e&&"_PARENT_"!==i.attributeName&&"geometry"!==i.attributeName&&"exists"!==i.attributeName&&"invalid"!==i.attributeName)return!0}}return!1},e.prototype.hasErrors=function(e){var t=this.changeRequestEditor.getEditors();if(0===e)for(var n=["invalid","exists","_PARENT_","geometry"],r=t.filter((function(e){return-1===n.indexOf(e.attribute.code)})),i=0;i<r.length;++i){if(!r[i].isValid())return!0}else if(1===e)for(i=0;i<this.hierarchies.length;++i){var o=this.hierarchies[i];if(!this.changeRequestEditor.getEditorForAttribute(this.parentAttributeType,o).isValid())return!0}else{if(2===e)return!this.changeRequestEditor.getEditorForAttribute(this.geometryAttributeType).isValid();if(3===e){var a=this.getAttribute("invalid"),s=l.GeoObjectType.getAttribute(this.changeRequestEditor.geoObjectType,"exists"),c=this.changeRequestEditor.getEditorForAttribute(s);return Object.prototype.hasOwnProperty.call(a,"isValid")&&!a.isValid||!c.isValid()}}return!1},e.prototype.isValid=function(){var e=!0;return this.geoObjectType.attributes.forEach((function(t){null==t.isValid||t.isValid||(e=!1)})),null==this.parentAttributeType.isValid||this.parentAttributeType.isValid||(e=!1),null==this.geometryAttributeType.isValid||this.geometryAttributeType.isValid||(e=!1),e&&this.changeRequestEditor.validate()},e.prototype.getActions=function(){return this.changeRequestEditor.changeRequest.actions},e.ɵfac=function(t){return new(t||e)(p.ɵɵdirectiveInject(m.LocalizationService),p.ɵɵdirectiveInject(u.GeometryService),p.ɵɵdirectiveInject(m.AuthService),p.ɵɵdirectiveInject(g.DateService))},e.ɵcmp=p.ɵɵdefineComponent({type:e,selectors:[["geoobject-shared-attribute-editor"]],viewQuery:function(e,t){if(1&e&&(p.ɵɵviewQuery(C,1),p.ɵɵviewQuery(E,1)),2&e){var n=void 0;p.ɵɵqueryRefresh(n=p.ɵɵloadQuery())&&(t.geometryEditor=n.first),p.ɵɵqueryRefresh(n=p.ɵɵloadQuery())&&(t.attributeForm=n.first)}},inputs:{postGeoObject:"postGeoObject",geoObjectType:"geoObjectType",attributeExcludes:"attributeExcludes",readOnly:"readOnly",isNew:"isNew",isGeometryInlined:"isGeometryInlined",changeRequest:"changeRequest",hierarchies:"hierarchies"},outputs:{onManageVersion:"onManageVersion",onChange:"onChange"},features:[p.ɵɵProvidersFeature([i.DatePipe])],decls:35,vars:24,consts:[[1,"row"],[1,"col-md-12"],[1,"btn-group","geobject-editor-tab-holder"],[1,"btn","full-width-radio-button",3,"ngClass","click"],[1,"errorSpan"],["class","tabHasErrors",4,"ngIf"],[2,"display","inline-block","width","90%"],["key","geoobject.editor.tabZero"],[1,"changeSpan"],["class","tabHasChanges",4,"ngIf"],["key","geoobject.editor.tabOne"],["key","geoobject.editor.tabTwo"],[1,"btn","full-width-radio-button","settings",3,"ngClass","click"],[1,"fa","fa-cog"],["name","geobject-shared-attribute-editor",1,"modal-form"],["attributeForm","ngForm"],[4,"ngIf"],[1,"tabHasErrors"],[1,"tabHasChanges"],["class","row",4,"ngIf"],[1,"text"],[1,"list-group"],["class","list-group-item","style","text-align:left;border:none;padding:0;",4,"ngFor","ngForOf"],[1,"list-group-item",2,"text-align","left","border","none","padding","0"],[1,"panel","panel-default"],[1,"panel-heading"],[2,"margin","0"],[1,"panel-body"],["key","geoobject.code.alternate.label"],["key","geoobject.displayLabel.alternate.label"],[3,"geoObjectType","changeRequestEditor","attributeType","readonly","isNew"],["type","text","required","",3,"ngModel","id","name","disabled","style","ngModelChange",4,"ngIf"],["type","text","required","",3,"ngModel","id","name","disabled","ngModelChange"],[3,"changeRequestEditor","geoObjectType","changeRequest","attributeType","geoObject","readonly","isNew"],[3,"geoObjectType","changeRequestEditor","attributeType","readonly","isNew","hierarchy"],["key","shared.attributes.attribute.geometry.label"],[3,"geoObjectType","changeRequestEditor","attributeType","readonly","isNew","isGeometryInlined"]],template:function(e,t){1&e&&(p.ɵɵelementStart(0,"div",0),p.ɵɵelementStart(1,"div",1),p.ɵɵelementStart(2,"div",2),p.ɵɵelementStart(3,"label",3),p.ɵɵlistener("click",(function(){return t.changePage(0)})),p.ɵɵelementStart(4,"span",4),p.ɵɵtemplate(5,x,1,0,"span",5),p.ɵɵelementEnd(),p.ɵɵelementStart(6,"span",6),p.ɵɵelement(7,"localize",7),p.ɵɵelementEnd(),p.ɵɵelementStart(8,"span",8),p.ɵɵtemplate(9,O,1,0,"span",9),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(10,"label",3),p.ɵɵlistener("click",(function(){return t.changePage(1)})),p.ɵɵelementStart(11,"span",4),p.ɵɵtemplate(12,I,1,0,"span",5),p.ɵɵelementEnd(),p.ɵɵelementStart(13,"span",6),p.ɵɵelement(14,"localize",10),p.ɵɵelementEnd(),p.ɵɵelementStart(15,"span",8),p.ɵɵtemplate(16,w,1,0,"span",9),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(17,"label",3),p.ɵɵlistener("click",(function(){return t.changePage(2)})),p.ɵɵelementStart(18,"span",4),p.ɵɵtemplate(19,M,1,0,"span",5),p.ɵɵelementEnd(),p.ɵɵelementStart(20,"span",6),p.ɵɵelement(21,"localize",11),p.ɵɵelementEnd(),p.ɵɵelementStart(22,"span",8),p.ɵɵtemplate(23,T,1,0,"span",9),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(24,"label",12),p.ɵɵlistener("click",(function(){return t.changePage(3)})),p.ɵɵelementStart(25,"span",4),p.ɵɵtemplate(26,j,1,0,"span",5),p.ɵɵelementEnd(),p.ɵɵelementStart(27,"span",6),p.ɵɵelement(28,"i",13),p.ɵɵelementEnd(),p.ɵɵelementStart(29,"span",8),p.ɵɵtemplate(30,k,1,0,"span",9),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementEnd(),p.ɵɵelementStart(31,"form",14,15),p.ɵɵelementStart(33,"fieldset"),p.ɵɵtemplate(34,B,5,4,"div",16),p.ɵɵelementEnd(),p.ɵɵelementEnd()),2&e&&(p.ɵɵadvance(3),p.ɵɵproperty("ngClass",p.ɵɵpureFunction2(13,U,0===t.tabIndex,t.shouldForceSetExist())),p.ɵɵadvance(2),p.ɵɵproperty("ngIf",t.hasErrors(0)),p.ɵɵadvance(4),p.ɵɵproperty("ngIf",t.hasChanges(0)),p.ɵɵadvance(1),p.ɵɵproperty("ngClass",p.ɵɵpureFunction2(16,U,1===t.tabIndex,t.shouldForceSetExist())),p.ɵɵadvance(2),p.ɵɵproperty("ngIf",t.hasErrors(1)),p.ɵɵadvance(4),p.ɵɵproperty("ngIf",t.hasChanges(1)),p.ɵɵadvance(1),p.ɵɵproperty("ngClass",p.ɵɵpureFunction2(19,U,2===t.tabIndex,t.shouldForceSetExist())),p.ɵɵadvance(2),p.ɵɵproperty("ngIf",t.hasErrors(2)),p.ɵɵadvance(4),p.ɵɵproperty("ngIf",t.hasChanges(2)),p.ɵɵadvance(1),p.ɵɵproperty("ngClass",p.ɵɵpureFunction1(22,$,3===t.tabIndex)),p.ɵɵadvance(2),p.ɵɵproperty("ngIf",t.hasErrors(3)),p.ɵɵadvance(4),p.ɵɵproperty("ngIf",t.hasChanges(3)),p.ɵɵadvance(4),p.ɵɵproperty("ngIf",t.changeRequestEditor&&t.changeRequestEditor.geoObject))},directives:[h.NgClass,h.NgIf,f.LocalizeComponent,y.ɵangular_packages_forms_forms_ba,y.NgControlStatusGroup,y.NgForm,h.NgForOf,v.ManageVersionsComponent,y.DefaultValueAccessor,y.RequiredValidator,y.NgControlStatus,y.NgModel,b.StandardAttributeEditorComponent],pipes:[S.GeoObjectAttributeExcludesPipe],styles:['.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type="text"][_ngcontent-%COMP%] {\n    background: #f5f5f5;\n}\n\n.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type="text"][_ngcontent-%COMP%]:disabled {\n    background: #eee;\n}\n\n.full-width-radio-button[_ngcontent-%COMP%] {\n\t  position: relative;\n}\n\n.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%] {\n\tposition: absolute;\n}\n\nlabel.settings[_ngcontent-%COMP%]    > span[_ngcontent-%COMP%]    > i.fa.fa-cog[_ngcontent-%COMP%] {\n\tfont-size: 15px;\n}\n\n.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%] {\n  left: 2.5px;\n}\n\n.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%] {\n  right: 2.5px;\n}\n\n.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before {\n  content: \' \\25CF\';\n  font-size: 20px;\n  line-height:12px;\n  text-align: left;\n  color: red;\n}\n\n.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after {\n\tcontent: \' \\25CF\';\n  font-size: 20px;\n  line-height:12px;\n  text-align: right;\n  color: orange;\n}\n\nli.list-group-item[_ngcontent-%COMP%] {\n    font-size: 18px;\n}\n\n.warning-text[_ngcontent-%COMP%]{\n    color: orange;\n}\n\n\nform.modal-form[_ngcontent-%COMP%] {\n    overflow: visible;\n}\n\nfieldset[_ngcontent-%COMP%] {\n    width: 100% !important;\n}\n\n\n.panel[_ngcontent-%COMP%] {\n\n}\n\n.panel[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%] {\n\tmargin: 0;\n}\n\n.panel[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tpadding: 5px 0;\n}\n\n.panel-heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%] {\n\tmargin:0;\n}\n\n.input-group[_ngcontent-%COMP%] {\n\twidth: 100%;\n}\n\n.radio-group[_ngcontent-%COMP%] {\n\tborder: solid 1px #ccc;\n\tborder-radius: 5px 0 0 5px;\n\tline-height: 40px;\n}\n\n\n  .input-group input[type="text"], .input-group[_ngcontent-%COMP%]   input[type="number"][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type="date"][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {\n\tborder-radius: 5px 0 0 5px;\n\twidth: 100%;\n}\n.input-group[_ngcontent-%COMP%]   input[type="text"].input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type="number"].input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type="date"].input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   select.input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   .radio-group.input-group-read-only[_ngcontent-%COMP%] {\n\tborder-radius: 5px; \n}\n\n.geoobject-panel-header[_ngcontent-%COMP%]{\n\theight: 50px;\n    width: 100%;\n    background: grey;\n}'],data:{animation:[[o.trigger("fadeInOut",[o.transition(":enter",[o.style({opacity:0}),o.animate("500ms")]),o.transition(":leave",o.animate("500ms",o.style({opacity:0})))]),o.trigger("slide",[o.state("left",o.style({left:0})),o.state("right",o.style({left:"100%"})),o.transition("* => *",o.animate(200))])]]}}),e}();t.GeoObjectSharedAttributeEditorComponent=J,("undefined"==typeof ngDevMode||ngDevMode)&&p.ɵsetClassMetadata(J,[{type:r.Component,args:[{selector:"geoobject-shared-attribute-editor",templateUrl:"./geoobject-shared-attribute-editor.component.html",styleUrls:["./geoobject-shared-attribute-editor.css"],providers:[i.DatePipe],animations:[[o.trigger("fadeInOut",[o.transition(":enter",[o.style({opacity:0}),o.animate("500ms")]),o.transition(":leave",o.animate("500ms",o.style({opacity:0})))]),o.trigger("slide",[o.state("left",o.style({left:0})),o.state("right",o.style({left:"100%"})),o.transition("* => *",o.animate(200))])]]}]}],(function(){return[{type:m.LocalizationService},{type:u.GeometryService},{type:m.AuthService},{type:g.DateService}]}),{postGeoObject:[{type:r.Input}],geoObjectType:[{type:r.Input}],attributeExcludes:[{type:r.Input}],readOnly:[{type:r.Input}],isNew:[{type:r.Input}],isGeometryInlined:[{type:r.Input}],changeRequest:[{type:r.Input}],geometryEditor:[{type:r.ViewChild,args:["geometryEditor"]}],onManageVersion:[{type:r.Output}],onChange:[{type:r.Output}],hierarchies:[{type:r.Input}],attributeForm:[{type:r.ViewChild,args:["attributeForm"]}]})},531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizedInputComponent=void 0;var r=n(0),i=(n(153),n(0)),o=n(1),a=n(68),l=n(259),s=n(22);function c(e,t){if(1&e&&(i.ɵɵelementStart(0,"div",1),i.ɵɵelementStart(1,"div",2),i.ɵɵelementStart(2,"label"),i.ɵɵelement(3,"localize",3),i.ɵɵelementStart(4,"span",4),i.ɵɵtext(5," ("),i.ɵɵelement(6,"convert-key-label",3),i.ɵɵtext(7,")"),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(8,"div",5),i.ɵɵelementStart(9,"span",6),i.ɵɵelementStart(10,"input",7),i.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=t.$implicit,r=i.ɵɵnextContext();i.ɵɵadvance(3),i.ɵɵproperty("key",r.key),i.ɵɵadvance(3),i.ɵɵproperty("key",n.locale),i.ɵɵadvance(4),i.ɵɵproperty("ngModel",n.value)("name","label-"+n.locale)("disabled",r.disabled)("required","defaultLocale"===n.locale)}}var d=function(){function e(){this.key="",this.disabled=!1,this.valueChange=new r.EventEmitter}return e.ɵfac=function(t){return new(t||e)},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["localized-input"]],inputs:{key:"key",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[["class","row-holder",4,"ngFor","ngForOf"],[1,"row-holder"],[1,"label-holder"],[3,"key"],[2,"color","#BABABA"],[1,"holder"],[1,"text"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"]],template:function(e,t){1&e&&i.ɵɵtemplate(0,c,11,6,"div",0),2&e&&i.ɵɵproperty("ngForOf",t.value.localeValues)},directives:[o.NgForOf,a.LocalizeComponent,l.ConvertKeyLabel,s.DefaultValueAccessor,s.NgControlStatus,s.NgModel,s.RequiredValidator],encapsulation:2}),e}();t.LocalizedInputComponent=d,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(d,[{type:r.Component,args:[{selector:"localized-input",templateUrl:"./localized-input.component.html",styleUrls:[]}]}],(function(){return[]}),{key:[{type:r.Input}],value:[{type:r.Input}],disabled:[{type:r.Input}],valueChange:[{type:r.Output}]})},532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HierarchyComponent=t.Instance=t.RELATED_NODE_BANNER_COLOR=t.INHERITED_NODE_BANNER_COLOR=t.INHERITED_NODE_FILL=t.DEFAULT_NODE_BANNER_COLOR=t.DEFAULT_NODE_FILL=t.TREE_SCALE_FACTOR_Y=t.TREE_SCALE_FACTOR_X=void 0;var r=n(0),i=n(32),o=n(31),a=(n(30),n(169),n(378)),l=n(565),s=n(566),c=n(567),d=n(111),p=(n(16),n(260)),m=(n(518),n(575)),u=n(547),g=n(0),h=n(518),f=n(30),y=n(169),v=n(16),b=n(122),S=n(86),C=n(22),E=n(380),x=n(68),O=n(1),I=n(113),w=["searchInput"],M=["nodeMenu"],T=["leafMenu"];function j(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"div",42),g.ɵɵelementStart(1,"button",43),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext().createGeoObjectType(null,!1,e.org)})),g.ɵɵelement(2,"localize",44),g.ɵɵelementEnd(),g.ɵɵelementStart(3,"button",45),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext().createGeoObjectType(null,!0,e.org)})),g.ɵɵelement(4,"localize",46),g.ɵɵelementEnd(),g.ɵɵelementEnd()}}function k(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"i",53),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext(2).$implicit;return g.ɵɵnextContext(2).deleteGeoObjectType(e)})),g.ɵɵpipe(1,"localize"),g.ɵɵelementEnd()}2&e&&g.ɵɵproperty("title",g.ɵɵpipeBind1(1,1,"button.delete.helptext"))}function R(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"i",54),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext(2).$implicit,t=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext().createGeoObjectType(e,!1,t.org)})),g.ɵɵelementEnd()}}function z(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"span",49),g.ɵɵtemplate(1,k,2,3,"i",50),g.ɵɵelementStart(2,"i",51),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext(2).manageGeoObjectType(e,!1)})),g.ɵɵpipe(3,"localize"),g.ɵɵelementEnd(),g.ɵɵtemplate(4,R,1,0,"i",52),g.ɵɵelementEnd()}if(2&e){var r=g.ɵɵnextContext().$implicit,i=g.ɵɵnextContext(2);g.ɵɵadvance(1),g.ɵɵproperty("ngIf",!i.excludeGeoObjectTypeDeletes(r)),g.ɵɵadvance(1),g.ɵɵproperty("title",g.ɵɵpipeBind1(3,3,"button.edit.helptext")),g.ɵɵadvance(2),g.ɵɵproperty("ngIf",r.isAbstract)}}function P(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"span",49),g.ɵɵelementStart(1,"i",55),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext(2).manageGeoObjectType(e,!0)})),g.ɵɵpipe(2,"localize"),g.ɵɵelementEnd(),g.ɵɵelementEnd()}2&e&&(g.ɵɵadvance(1),g.ɵɵproperty("title",g.ɵɵpipeBind1(2,1,"button.view.helptext")))}var D=function(e,t){return{"got-group-parent":e,"got-group-child":t}};function A(e,t){if(1&e&&(g.ɵɵelementStart(0,"li",47),g.ɵɵtext(1),g.ɵɵtemplate(2,z,5,5,"span",48),g.ɵɵtemplate(3,P,3,3,"span",48),g.ɵɵelementEnd()),2&e){var n=t.$implicit;g.ɵɵproperty("id",n.code)("ngClass",g.ɵɵpureFunction2(7,D,n.isAbstract,n.superTypeCode&&n.superTypeCode.length>0)),g.ɵɵattribute("data-superTypeCode",n.superTypeCode&&n.superTypeCode.length>0?n.superTypeCode:null)("data-canDrag",n.canDrag),g.ɵɵadvance(1),g.ɵɵtextInterpolate1(" ",n.label.localizedValue," "),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",n.permissions.includes("WRITE")),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",!n.permissions.includes("WRITE")&&n.permissions.includes("READ"))}}function V(e,t){if(1&e&&(g.ɵɵelementStart(0,"ul",38),g.ɵɵelementStart(1,"div"),g.ɵɵelementStart(2,"div",39),g.ɵɵelementStart(3,"label"),g.ɵɵtext(4),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵtemplate(5,j,5,0,"div",40),g.ɵɵtemplate(6,A,4,10,"li",41),g.ɵɵelementEnd(),g.ɵɵelementEnd()),2&e){var n=t.$implicit,r=g.ɵɵnextContext();g.ɵɵadvance(4),g.ɵɵtextInterpolate(n.org.label.localizedValue),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",r.isSRA||n.org.code===r.userOrganization),g.ɵɵadvance(1),g.ɵɵproperty("ngForOf",n.types)}}function N(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"div",42),g.ɵɵelementStart(1,"button",43),g.ɵɵlistener("click",(function(){return g.ɵɵrestoreView(n),g.ɵɵnextContext(2).createHierarchy()})),g.ɵɵelement(2,"localize",57),g.ɵɵelementEnd(),g.ɵɵelementEnd()}}function L(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"i",53),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext(2).$implicit;return g.ɵɵnextContext(2).deleteHierarchyType(e)})),g.ɵɵpipe(1,"localize"),g.ɵɵelementEnd()}2&e&&g.ɵɵproperty("title",g.ɵɵpipeBind1(1,1,"button.delete.helptext"))}function _(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"span",60),g.ɵɵtemplate(1,L,2,3,"i",50),g.ɵɵelementStart(2,"i",61),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext(2).editHierarchyType(e,!1)})),g.ɵɵpipe(3,"localize"),g.ɵɵelementEnd(),g.ɵɵelementEnd()}if(2&e){var r=g.ɵɵnextContext().$implicit,i=g.ɵɵnextContext(2);g.ɵɵadvance(1),g.ɵɵproperty("ngIf",!i.excludeHierarchyTypeDeletes(r)),g.ɵɵadvance(1),g.ɵɵproperty("title",g.ɵɵpipeBind1(3,2,"button.edit.helptext"))}}function F(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"span",60),g.ɵɵelementStart(1,"i",62),g.ɵɵlistener("click",(function(){g.ɵɵrestoreView(n);var e=g.ɵɵnextContext().$implicit;return g.ɵɵnextContext(2).editHierarchyType(e,!0)})),g.ɵɵpipe(2,"localize"),g.ɵɵelementEnd(),g.ɵɵelementEnd()}2&e&&(g.ɵɵadvance(1),g.ɵɵproperty("title",g.ɵɵpipeBind1(2,1,"button.view.helptext")))}var H=function(e,t){return{primary:e,active:t}};function G(e,t){if(1&e){var n=g.ɵɵgetCurrentView();g.ɵɵelementStart(0,"li",58),g.ɵɵlistener("click",(function(e){g.ɵɵrestoreView(n);var r=t.$implicit;return g.ɵɵnextContext(2).hierarchyOnClick(e,r)})),g.ɵɵelement(1,"i",16),g.ɵɵtext(2),g.ɵɵtemplate(3,_,4,4,"span",59),g.ɵɵtemplate(4,F,3,3,"span",59),g.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=g.ɵɵnextContext(2);g.ɵɵproperty("id",r.code)("ngClass",g.ɵɵpureFunction2(5,H,null!=i.currentHierarchy&&r.code===i.currentHierarchy.code,i.isActive(r))),g.ɵɵadvance(2),g.ɵɵtextInterpolate1(" ",r.label.localizedValue," "),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",i.isOrganizationRA(r.organizationCode)),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",!i.isOrganizationRA(r.organizationCode))}}function q(e,t){if(1&e&&(g.ɵɵelementStart(0,"ul",38),g.ɵɵelementStart(1,"div"),g.ɵɵelementStart(2,"div",39),g.ɵɵelementStart(3,"label"),g.ɵɵtext(4),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵtemplate(5,N,3,0,"div",40),g.ɵɵtemplate(6,G,5,8,"li",56),g.ɵɵelementEnd(),g.ɵɵelementEnd()),2&e){var n=t.$implicit,r=g.ɵɵnextContext();g.ɵɵadvance(4),g.ɵɵtextInterpolate(n.org.label.localizedValue),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",r.isSRA||n.org.code===r.userOrganization),g.ɵɵadvance(1),g.ɵɵproperty("ngForOf",n.hierarchies)}}function B(e,t){1&e&&(g.ɵɵelementStart(0,"div",64),g.ɵɵelementStart(1,"div",65),g.ɵɵelementStart(2,"div",66),g.ɵɵelementStart(3,"p",67),g.ɵɵelement(4,"localize",68),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd())}function U(e,t){1&e&&(g.ɵɵelementStart(0,"div"),g.ɵɵelementStart(1,"p",67),g.ɵɵelement(2,"localize",69),g.ɵɵelementEnd(),g.ɵɵelementEnd())}function $(e,t){if(1&e&&(g.ɵɵelementStart(0,"div"),g.ɵɵtemplate(1,B,5,0,"div",63),g.ɵɵtemplate(2,U,3,0,"div",20),g.ɵɵelementEnd()),2&e){var n=g.ɵɵnextContext();g.ɵɵadvance(1),g.ɵɵproperty("ngIf",n.isOrganizationRA(n.currentHierarchy.organizationCode,!0)),g.ɵɵadvance(1),g.ɵɵproperty("ngIf",!n.isOrganizationRA(n.currentHierarchy.organizationCode,!0))}}t.TREE_SCALE_FACTOR_X=1.8,t.TREE_SCALE_FACTOR_Y=1.8,t.DEFAULT_NODE_FILL="#e6e6e6",t.DEFAULT_NODE_BANNER_COLOR="#A29BAB",t.INHERITED_NODE_FILL="#d4d4d4",t.INHERITED_NODE_BANNER_COLOR="#a0a0a0",t.RELATED_NODE_BANNER_COLOR=t.INHERITED_NODE_BANNER_COLOR;var J=function(){};t.Instance=J;var W=function(){function e(e,t,n,r,i,o){var a=this;this.modalService=t,this.contextMenuService=n,this.registryService=i,this.authService=o,this.userOrganization=null,this.currentHierarchy=null,this.instance=new J,this.geoObjectTypes=[],this.hierarchiesByOrg=[],this.typesByOrg=[],this.filter="",this.filteredHierarchiesByOrg=[],this.filteredTypesByOrg=[],this.hierarchyTypeDeleteExclusions=["AllowedIn","IsARelationship"],this.geoObjectTypeDeleteExclusions=["ROOT"],this._opened=!1,this.isSRA=!1,this.options={displayField:"label",actionMapping:{mouse:{click:function(e,t,n){a.treeNodeOnClick(t,n)},contextMenu:function(e,t,n){a.handleOnMenu(t,n)}}},mouse:{}},this.isSRA=o.isSRA(),this.hierarchyService=e,this.localizeService=r}return e.prototype.ngOnInit=function(){var e=this;this.refreshAll(null),o.fromEvent(this.searchInput.nativeElement,"keyup").pipe(i.filter(Boolean),i.debounceTime(500),i.distinctUntilChanged(),i.tap((function(){e.onFilterChange()}))).subscribe()},e.prototype.localize=function(e){return this.localizeService.decode(e)},e.prototype.renderTree=function(){var e=this;if(null==this.currentHierarchy||null==this.currentHierarchy.rootGeoObjectTypes||0===this.currentHierarchy.rootGeoObjectTypes.length){a.select("#svg").remove();var t=!1;return null!=this.currentHierarchy&&(t=this.authService.isSRA()||this.authService.isOrganizationRA(this.currentHierarchy.organizationCode)),void this.geoObjectTypes.forEach((function(e){e.canDrag=t}))}a.select(".g-context-menu").remove(),a.select(".hierarchy-inherit-button").remove(),a.select(".g-hierarchy-got-connector").remove();var n=a.select("#overflow-div").node(),r=n.scrollLeft,i=n.scrollRight,o=a.select("#svg");null==o.node()&&(o=a.select("#svgHolder").append("svg")).attr("id","svg"),this.primarySvgHierarchy=new m.SvgHierarchyType(this,o,this.currentHierarchy,!0,this.localizeService,this.modalService,this.authService),this.primarySvgHierarchy.render(),this.calculateSvgViewBox();var l=a.select("#overflow-div").node();l.scrollLeft=r,l.scrollRight=i,this.geoObjectTypes.forEach((function(t){t.canDrag=e.calculateCanDrag(t)}))},e.prototype.calculateSvgViewBox=function(){var e=a.select("#svg"),n=e.node().getBBox(),r=n.x,i=n.y,o=n.width,l=n.height;e.attr("viewBox",r-30+" "+(i-40)+" "+(o+60)+" "+(l+80)),o=(o+60)*t.TREE_SCALE_FACTOR_X,l=(l+80)*t.TREE_SCALE_FACTOR_Y,a.select("#svgHolder").style("width",o+"px")},e.prototype.calculateCanDrag=function(e){var t=this;if(null==this.primarySvgHierarchy)return!1;if(!this.authService.isSRA()&&!this.authService.isOrganizationRA(this.currentHierarchy.organizationCode))return!1;if(null!=this.primarySvgHierarchy.getNodeByCode(e.code))return!1;if(e.isAbstract){var n=!1;if(this.geoObjectTypes.forEach((function(r){r.superTypeCode===e.code&&null!=t.primarySvgHierarchy.getNodeByCode(r.code)&&(n=!0)})),n)return!1}else if(null!=e.superTypeCode&&null!=t.primarySvgHierarchy.getNodeByCode(e.superTypeCode))return!1;return!0},e.prototype.calculateRelatedHierarchies=function(e){for(var t=[],n=0;n<this.hierarchies.length;++n){var r=this.hierarchies[n];if(null!=r.rootGeoObjectTypes&&r.rootGeoObjectTypes.length>0)a.hierarchy(r.rootGeoObjectTypes[0]).descendants().find((function(t){return t.data.geoObjectType===e.code&&null==t.data.inheritedHierarchyCode}))&&t.push(r.code)}return t},e.prototype.registerDragHandlers=function(){var e,t,n,r=this,i=[];i.push({dropSelector:".drop-box-container",onDrag:function(e,t){if(null!=this.dropEl&&(this.dropEl.style("border-color",null),this.dropEl=null),null!=t){var n=t.closest(".drop-box-container");null!=n&&(this.dropEl=a.select(n).style("border-color","#6BA542"))}},onDrop:function(e){null!=this.dropEl&&(this.dropEl.style("border-color",null),r.addChild(r.currentHierarchy.code,"ROOT",a.select(e).attr("id")),this.dropEl=null)}}),i.push({dropSelector:".svg-got-body-rect",onDrag:function(e,t,n){var i=this;this.clearDropZones();var o=this.dropEl;if(null!=a.select("#svg").node()){var l=u.svgPoint(n.sourceEvent.pageX,n.sourceEvent.pageY);if(r.primarySvgHierarchy.getD3Tree().descendants().forEach((function(e){"GhostNode"!==e.data.geoObjectType&&u.isPointWithin(l,e.data.dropZoneBbox)?(i.dropEl=a.select('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+e.data.geoObjectType+'"]'),e.data.activeDropZones=!0,null==e.parent&&(e.data.dropZoneBbox={x:e.x-m.SvgHierarchyType.gotRectW/2,y:e.y-2*m.SvgHierarchyType.gotRectH,width:m.SvgHierarchyType.gotRectW,height:4*m.SvgHierarchyType.gotRectH})):(e.data.activeDropZones=!1,null==e.parent&&(e.data.dropZoneBbox={x:e.x-m.SvgHierarchyType.gotRectW/2,y:e.y-m.SvgHierarchyType.gotRectH/2,width:m.SvgHierarchyType.gotRectW,height:m.SvgHierarchyType.gotRectH}))})),(null==this.dropEl||null!=o&&null!=this.dropEl&&o.attr("data-gotCode")!==this.dropEl.attr("data-gotCode"))&&this.clearGhostNodes(!0),null!=this.dropEl){var s=a.select(e).classed("got-group-parent"),c=this.dropEl.attr("data-gotCode"),d=r.primarySvgHierarchy.getD3Tree().find((function(e){return e.data.geoObjectType===c})),p=r.findGeoObjectTypeByCode(c).isAbstract;this.dropEl.attr("stroke","blue");var g=parseInt(this.dropEl.attr("x")),h=parseInt(this.dropEl.attr("y")),f=m.SvgHierarchyType.gotRectW,y=m.SvgHierarchyType.gotRectH,v=a.select("#svg").append("g").classed("svg-dropZone-g",!0),b=!(null==d.children||0===d.children.length),S=!(p||s&&b);if(S){this.childDzBacker=v.append("rect").classed("svg-got-child-dz-backer",!0).attr("x",g+m.SvgHierarchyType.gotRectW/2-f/2).attr("y",h+m.SvgHierarchyType.gotRectH+10).attr("width",f).attr("height",y).attr("fill","white"),this.childDz=v.append("rect").classed("svg-got-child-dz",!0).attr("x",g+m.SvgHierarchyType.gotRectW/2-f/2).attr("y",h+m.SvgHierarchyType.gotRectH+10).attr("width",f).attr("height",y).attr("fill","none").attr("stroke","black").attr("stroke-width","1").attr("stroke-dasharray","5,5");var C=b?r.localizeService.decode("hierarchy.content.intersectChild"):r.localizeService.decode("hierarchy.content.addChild");this.childDzText=v.append("text").classed("svg-got-child-dz-text",!0).attr("font-family","sans-serif").attr("font-size",10).attr("fill","black").attr("x",g+m.SvgHierarchyType.gotRectW/2-u.calculateTextWidth(C,10)/2).attr("y",h+m.SvgHierarchyType.gotRectH+10+y/2+2).text(C)}if(!s){this.parentDzBacker=v.append("rect").classed("svg-got-parent-dz-backer",!0).attr("x",g+m.SvgHierarchyType.gotRectW/2-f/2).attr("y",h-m.SvgHierarchyType.gotHeaderH-y).attr("width",f).attr("height",y).attr("fill","white"),this.parentDz=v.append("rect").classed("svg-got-parent-dz",!0).attr("x",g+m.SvgHierarchyType.gotRectW/2-f/2).attr("y",h-m.SvgHierarchyType.gotHeaderH-y).attr("width",f).attr("height",y).attr("fill","none").attr("stroke","black").attr("stroke-width","1").attr("stroke-dasharray","5,5"),a.select(".svg-got-parent-dz-text").remove();var E=null==d.parent?r.localizeService.decode("hierarchy.content.addParent"):r.localizeService.decode("hierarchy.content.intersectParent");this.parentDzText=v.append("text").classed("svg-got-parent-dz-text",!0).attr("font-family","sans-serif").attr("font-size",10).attr("fill","black").attr("x",g+m.SvgHierarchyType.gotRectW/2-u.calculateTextWidth(E,10)/2).attr("y",h-m.SvgHierarchyType.gotHeaderH-y/2+2).text(E)}if(this.ghostCode!==c&&(null!=this.ghostCode&&this.clearGhostNodes(null==d.parent),null!=d.parent)){for(var x=null,O=0;O<d.parent.data.children.length;++O){d.parent.data.children[O].geoObjectType===c&&(x=O+1)}var I=r.localizeService.decode("hierarchy.content.addChild");d.parent.data.children.splice(x,0,{ghostingCode:c,geoObjectType:"GhostNode",label:I,children:[]}),r.renderTree(),this.ghostCode=c}var w=a.select(".svg-sibling-ghost-body-dz");!s&&u.isPointWithin(l,u.getBboxFromSelection(this.parentDz))?(this.parentDz.attr("stroke","blue"),this.parentDzText.attr("fill","blue"),S&&this.childDz.attr("stroke","black"),S&&this.childDzText.attr("fill","black"),w.attr("stroke","black"),this.activeDz=this.parentDz):S&&u.isPointWithin(l,u.getBboxFromSelection(this.childDz))?(!s&&this.parentDz.attr("stroke","black"),!s&&this.parentDzText.attr("fill","black"),this.childDz.attr("stroke","blue"),this.childDzText.attr("fill","blue"),w.attr("stroke","black"),this.activeDz=this.childDz):null!=w.node()&&u.isPointWithin(l,u.getBboxFromSelection(w))&&(!s&&this.parentDz.attr("stroke","black"),!s&&this.parentDzText.attr("fill","black"),S&&this.childDz.attr("stroke","black"),S&&this.childDzText.attr("fill","black"),w.attr("stroke","blue"),this.activeDz="sibling")}}},onDrop:function(e){if(null!=this.dropEl&&null!=this.activeDz){var t=this.dropEl.attr("data-gotCode"),n=r.primarySvgHierarchy.getD3Tree().find((function(e){return e.data.geoObjectType===t})),i=a.select(e).attr("id");if(this.activeDz===this.childDz)if(0===n.data.children.length)r.addChild(r.currentHierarchy.code,t,i);else{for(var o="",l=0;l<n.data.children.length;++l)o+=n.data.children[l].geoObjectType,l<n.data.children.length-1&&(o+=",");r.insertBetweenTypes(r.currentHierarchy.code,t,i,o)}else this.activeDz===this.parentDz?null==n.parent?r.insertBetweenTypes(r.currentHierarchy.code,"ROOT",i,t):r.insertBetweenTypes(r.currentHierarchy.code,n.parent.data.geoObjectType,i,t):"sibling"===this.activeDz&&r.addChild(r.currentHierarchy.code,n.parent.data.geoObjectType,a.select(e).attr("id"))}this.clearDropZones(),this.clearGhostNodes(!0)},clearDropZones:function(){null!=this.dropEl&&this.dropEl.attr("stroke",null),this.dropEl=null,this.activeDz=null,this.childDz=null,this.parentDz=null,a.select(".svg-dropZone-g").remove()},clearGhostNodes:function(e){var t=this;if(null!=this.ghostCode){var n=r.primarySvgHierarchy.getD3Tree().find((function(e){return e.data.ghostingCode===t.ghostCode}));if(null!=n){for(var i=null,o=0;o<n.parent.data.children.length;++o){n.parent.data.children[o].ghostingCode===this.ghostCode&&(i=o)}null!=i&&(n.parent.data.children.splice(i,1),e&&r.renderTree())}this.ghostCode=null}}}),a.drag().on("start",(function(r){if("false"!==a.select(this).attr("data-candrag")){var i=this.getBoundingClientRect();e=i.left-r.sourceEvent.pageX,t=i.top-r.sourceEvent.pageY,n=i.width}})).on("drag",(function(r){if("false"!==a.select(this).attr("data-candrag")){a.select(".g-context-menu").remove();var o=a.select(this);o.style("display","none");var l=document.elementFromPoint(r.sourceEvent.pageX,r.sourceEvent.pageY);o.style("display",null);for(var s=0;s<i.length;++s)i[s].onDrag(this,l,r);if(o.classed("dragging",!0).style("left",r.sourceEvent.pageX+e+"px").style("top",r.sourceEvent.pageY+t+"px").style("width",n+"px"),o.classed("got-group-parent")){var c=1;a.selectAll('.got-group-child[data-superTypeCode="'+o.attr("id")+'"]').each((function(){a.select(this).classed("dragging",!0).style("left",r.sourceEvent.pageX+e+"px").style("top",r.sourceEvent.pageY+t+(this.getBoundingClientRect().height+2)*c+"px").style("width",n+"px"),c++}))}}})).on("end",(function(e){var t=a.select(this).classed("dragging",!1).style("left",null).style("top",null).style("width",null);t.classed("got-group-parent")&&a.selectAll('.got-group-child[data-superTypeCode="'+t.attr("id")+'"]').each((function(){a.select(this).classed("dragging",!1).style("left",null).style("top",null).style("width",null)}));for(var n=0;n<i.length;++n)i[n].onDrop(this,e)}))(a.selectAll(".sidebar-section-content ul.list-group li.got-li-item"))},e.prototype.registerSvgHandlers=function(){var e,t,n,r,i=this;a.drag().on("start",(function(o){var l=u.svgPoint(o.sourceEvent.pageX,o.sourceEvent.pageY);r=i.primarySvgHierarchy.getNodeByCode(a.select(this).attr("data-gotCode")),n=r.getPos(),e=n.x-l.x,t=n.y-l.y})).on("drag",(function(n){a.select(".g-context-menu").remove();var o=u.svgPoint(n.sourceEvent.pageX,n.sourceEvent.pageY);(r=i.primarySvgHierarchy.getNodeByCode(a.select(this).attr("data-gotCode"))).setPos(o.x+e,o.y+t,!0)})).on("end",(function(e){r.setPos(n.x,n.y,!1)}))(a.selectAll(".svg-got-body-rect[data-inherited=false],.svg-got-label-text[data-inherited=false],.svg-got-header-rect[data-inherited=false]"))},e.prototype.findGeoObjectTypeByCode=function(e){for(var t=0;t<this.geoObjectTypes.length;++t){var n=this.geoObjectTypes[t];if(n.code===e)return n}},e.prototype.findHierarchyByCode=function(e){for(var t=0;t<this.hierarchies.length;++t){var n=this.hierarchies[t];if(n.code===e)return n}},e.prototype.findOrganizationByCode=function(e){for(var t=0;t<this.organizations.length;++t){var n=this.organizations[t];if(n.code===e)return n}},e.prototype.addChild=function(e,t,n){var r=this;this.hierarchyService.addChildToHierarchy(e,t,n).then((function(t){for(var i=r.findGeoObjectTypeByCode(n),o=null,a=0;a<i.relatedHierarchies.length;++a)if(i.relatedHierarchies[a]===e){o=a;break}null==o&&i.relatedHierarchies.push(e),r.refreshPrimaryHierarchy(t)})).catch((function(e){r.error(e)}))},e.prototype.insertBetweenTypes=function(e,t,n,r){var i=this;this.hierarchyService.insertBetweenTypes(e,t,n,r).then((function(e){i.refreshPrimaryHierarchy(e)})).catch((function(e){i.error(e)}))},e.prototype.ngAfterViewInit=function(){},e.prototype.isRA=function(){return this.authService.isRA()},e.prototype.isOrganizationRA=function(e,t){return void 0===t&&(t=!1),this.isSRA||this.authService.isOrganizationRA(e)},e.prototype.getTypesByOrg=function(e){for(var t=[],n=0;n<this.geoObjectTypes.length;++n){var r=this.geoObjectTypes[n];r.organizationCode===e.code&&t.push(r)}return t},e.prototype.getHierarchiesByOrg=function(e){for(var t=[],n=0;n<this.hierarchies.length;++n){var r=this.hierarchies[n];r.organizationCode===e.code&&t.push(r)}return t},e.prototype.refreshAll=function(e){var t=this;this.geoObjectTypes=[],this.registryService.init().then((function(n){t.localizeService.setLocales(n.locales),t.setGeoObjectTypes(n.types),t.organizations=n.organizations,t.organizations.forEach((function(e){t.isOrganizationRA(e.code)&&(t.userOrganization=e.code)}));var r=t.getGeoObjectTypePosition("ROOT");r&&t.geoObjectTypes.splice(r,1),t.setHierarchies(n.hierarchies),t.setNodesOnInit(e),t.updateViewDatastructures()})).catch((function(e){t.error(e)}))},e.prototype.setGeoObjectTypes=function(e){var t=this;this.setAbstractTypes(e),e.forEach((function(e){e.isAbstract||e.superTypeCode||t.geoObjectTypes.push(e)})),this.geoObjectTypes.sort((function(e,t){return e.label.localizedValue.toLowerCase()<t.label.localizedValue.toLowerCase()?-1:e.label.localizedValue.toLowerCase()>t.label.localizedValue.toLowerCase()?1:0})),e.forEach((function(e){if(!e.isAbstract&&e.superTypeCode&&e.superTypeCode.length>0)for(var n=0;n<t.geoObjectTypes.length;n++){var r=t.geoObjectTypes[n];e.superTypeCode===r.code&&t.geoObjectTypes.splice(n+1,0,e)}}))},e.prototype.setAbstractTypes=function(e){var t=this;e.forEach((function(e){e.isAbstract&&t.geoObjectTypes.push(e)}))},e.prototype.updateViewDatastructures=function(){var e=this;this.hierarchiesByOrg=[],this.typesByOrg=[];for(var t=0;t<this.organizations.length;++t){var n=this.organizations[t];this.hierarchiesByOrg.push({org:n,hierarchies:this.getHierarchiesByOrg(n)}),this.typesByOrg.push({org:n,types:this.getTypesByOrg(n)})}this.geoObjectTypes.forEach((function(t){t.canDrag=e.calculateCanDrag(t),t.relatedHierarchies=e.calculateRelatedHierarchies(t)})),this.onFilterChange()},e.prototype.excludeHierarchyTypeDeletes=function(e){return-1!==this.hierarchyTypeDeleteExclusions.indexOf(e.code)},e.prototype.excludeGeoObjectTypeDeletes=function(e){return-1!==this.geoObjectTypeDeleteExclusions.indexOf(e.code)},e.prototype.setNodesOnInit=function(e){var t=-1;if(null!=e?t=this.hierarchies.findIndex((function(t){return t.code===e.code})):this.hierarchies.length>0&&(t=0),t>-1){var n=this.hierarchies[t];this.setCurrentHierarchy(n),this.renderTree()}},e.prototype.getHierarchy=function(e){var t=null;return this.hierarchies.forEach((function(n){e===n.code&&(t=n)})),t},e.prototype.setHierarchies=function(e){var t=this,n=[];e.forEach((function(e,r){e.rootGeoObjectTypes.length>0&&e.rootGeoObjectTypes.forEach((function(e){t.processHierarchyNodes(e)})),n.push(e)})),this.hierarchies=n,this.hierarchies.sort((function(e,t){return e.label.localizedValue.toLowerCase()<t.label.localizedValue.toLowerCase()?-1:e.label.localizedValue.toLowerCase()>t.label.localizedValue.toLowerCase()?1:0}))},e.prototype.processHierarchyNodes=function(e){var t=this;null!=e&&(e.label=this.getHierarchyLabel(e.geoObjectType),e.children.forEach((function(e){t.processHierarchyNodes(e)})))},e.prototype.getHierarchyLabel=function(e){var t=null;return this.geoObjectTypes.forEach((function(n){n.code===e&&(t=n.label.localizedValue)})),t},e.prototype.handleOnMenu=function(e,t){this.isOrganizationRA(this.currentHierarchy.organizationCode)?(this.contextMenuService.show.next({contextMenu:null!==e.data.childType?this.nodeMenuComponent:this.leafMenuComponent,event:t,item:e}),t.preventDefault(),t.stopPropagation()):(t.preventDefault(),t.stopPropagation())},e.prototype.treeNodeOnClick=function(e,t){e.treeModel.setFocusedNode(e),e.treeModel.isExpanded(e)?e.collapse():e.treeModel.expandAll()},e.prototype.hierarchyOnClick=function(e,t){this.setCurrentHierarchy(t),this.renderTree()},e.prototype.createHierarchy=function(){var e=this;this.bsModalRef=this.modalService.show(l.CreateHierarchyTypeModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.onHierarchytTypeCreate.subscribe((function(t){e.hierarchies.push(t),e.hierarchies.sort((function(e,t){var n=e.label.localizedValue.toUpperCase(),r=t.label.localizedValue.toUpperCase();return n<r?-1:n>r?1:0})),e.updateViewDatastructures()}))},e.prototype.deleteHierarchyType=function(e){var t=this;this.bsModalRef=this.modalService.show(d.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+e.label.localizedValue+"]",this.bsModalRef.content.data=e.code,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.onConfirm.subscribe((function(e){t.removeHierarchyType(e)}))},e.prototype.editHierarchyType=function(e,t){var n=this;this.bsModalRef=this.modalService.show(l.CreateHierarchyTypeModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.edit=!0,this.bsModalRef.content.readOnly=t,this.bsModalRef.content.hierarchyType=e,this.bsModalRef.content.onHierarchytTypeCreate.subscribe((function(e){var t=n.getHierarchyTypePosition(e.code);n.hierarchies[t].label=e.label,n.hierarchies[t].description=e.description,n.hierarchies[t].progress=e.progress,n.hierarchies[t].acknowledgement=e.acknowledgement,n.hierarchies[t].disclaimer=e.disclaimer,n.hierarchies[t].useConstraints=e.useConstraints,n.hierarchies[t].accessConstraints=e.accessConstraints,n.hierarchies[t].contact=e.contact,n.hierarchies[t].phoneNumber=e.phoneNumber,n.hierarchies[t].email=e.email,n.updateViewDatastructures(),n.currentHierarchy.code===e.code&&(n.setCurrentHierarchy(n.hierarchies[t]),n.renderTree())}))},e.prototype.setCurrentHierarchy=function(e){this.currentHierarchy=e},e.prototype.isPrimaryHierarchy=function(e){return e.code===this.currentHierarchy.code},e.prototype.removeHierarchyType=function(e){var t=this;this.hierarchyService.deleteHierarchyType(e).then((function(n){var r=t.getHierarchyTypePosition(e);t.hierarchies.splice(r,1),t.updateViewDatastructures(),t.hierarchies.length>0?t.setCurrentHierarchy(t.hierarchies[0]):t.currentHierarchy=null,t.renderTree()})).catch((function(e){t.error(e)}))},e.prototype.createGeoObjectType=function(e,t,n){var r=this;this.bsModalRef=this.modalService.show(s.CreateGeoObjTypeModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(n,this.geoObjectTypes,e,t),this.bsModalRef.content.onGeoObjTypeCreate.subscribe((function(e){e.relatedHierarchies=r.calculateRelatedHierarchies(e),r.refreshAll(r.currentHierarchy)}))},e.prototype.deleteGeoObjectType=function(e){var t=this;this.bsModalRef=this.modalService.show(d.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+e.label.localizedValue+"]",this.bsModalRef.content.data=e.code,this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type=p.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(e){t.removeGeoObjectType(e)}))},e.prototype.removeGeoObjectType=function(e,t){var n=this;void 0===t&&(t=null),this.registryService.deleteGeoObjectType(e).then((function(t){var r=n.getGeoObjectTypePosition(e);n.geoObjectTypes.splice(r,1),n.refreshAll(n.currentHierarchy)})).catch((function(e){null!=t&&t(e),n.error(e)}))},e.prototype.manageGeoObjectType=function(e,t){var n=this;this.bsModalRef=this.modalService.show(c.ManageGeoObjectTypeModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"manage-geoobjecttype-modal"}),e.attributes.sort((function(e,t){return e.label.localizedValue<t.label.localizedValue?-1:e.label.localizedValue>t.label.localizedValue?1:0})),this.bsModalRef.content.geoObjectType=e,this.bsModalRef.content.readOnly=t,this.bsModalRef.content.onGeoObjectTypeSubmitted.subscribe((function(e){if(e.isAbstract)n.refreshAll(n.currentHierarchy);else{var t=n.getGeoObjectTypePosition(e.code);-1!==t&&(n.geoObjectTypes[t]=e),n.updateViewDatastructures(),n.hierarchies.forEach((function(e){n.processHierarchyNodes(e.rootGeoObjectTypes[0])})),null!=n.currentHierarchy&&n.processHierarchyNodes(n.currentHierarchy.rootGeoObjectTypes[0]),n.renderTree()}}))},e.prototype.getHierarchyTypePosition=function(e){for(var t=0;t<this.hierarchies.length;t++){if(this.hierarchies[t].code===e)return t}},e.prototype.getGeoObjectTypePosition=function(e){for(var t=0;t<this.geoObjectTypes.length;t++){if(this.geoObjectTypes[t].code===e)return t}return null},e.prototype.refreshPrimaryHierarchy=function(e){this.processHierarchyNodes(e.rootGeoObjectTypes[0]);for(var t=0;t<this.hierarchies.length;++t){this.hierarchies[t].code===e.code&&(this.hierarchies[t]=e,this.setCurrentHierarchy(e))}this.updateViewDatastructures(),this.renderTree()},e.prototype.removeFromHierarchy=function(e,t,n){var r=this;void 0===n&&(n=null);var i=this;this.hierarchyService.removeFromHierarchy(this.currentHierarchy.code,e,t).then((function(e){for(var n=i.findGeoObjectTypeByCode(t),r=null,o=0;o<n.relatedHierarchies.length;++o)if(n.relatedHierarchies[o]===e.code){r=o;break}null!=r&&n.relatedHierarchies.splice(r,1),i.refreshPrimaryHierarchy(e)})).catch((function(e){null!=n&&n(e),r.error(e)}))},e.prototype.isActive=function(e){return this.currentHierarchy===e},e.prototype.onFilterChange=function(){var e=this,t=this.filter.toLowerCase();this.filteredHierarchiesByOrg=[],this.filteredTypesByOrg=[],this.hierarchiesByOrg.forEach((function(n){var r=n.hierarchies.filter((function(e){return-1!==e.label.localizedValue.toLowerCase().indexOf(t)}));e.filteredHierarchiesByOrg.push({org:n.org,hierarchies:r})})),this.typesByOrg.forEach((function(n){var r=n.types.filter((function(e){return-1!==e.label.localizedValue.toLowerCase().indexOf(t)}));e.filteredTypesByOrg.push({org:n.org,types:r})})),setTimeout((function(){e.registerDragHandlers()}),500)},e.prototype.handleInheritHierarchy=function(e,t,n){var r=this;this.hierarchyService.setInheritedHierarchy(e,t,n).then((function(e){r.refreshPrimaryHierarchy(e)})).catch((function(e){r.error(e)}))},e.prototype.handleUninheritHierarchy=function(e,t){var n=this;this.hierarchyService.removeInheritedHierarchy(e,t).then((function(e){n.refreshPrimaryHierarchy(e)})).catch((function(e){n.error(e)}))},e.prototype.error=function(e){this.bsModalRef=d.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(g.ɵɵdirectiveInject(h.HierarchyService),g.ɵɵdirectiveInject(f.BsModalService),g.ɵɵdirectiveInject(y.ContextMenuService),g.ɵɵdirectiveInject(v.LocalizationService),g.ɵɵdirectiveInject(h.RegistryService),g.ɵɵdirectiveInject(v.AuthService))},e.ɵcmp=g.ɵɵdefineComponent({type:e,selectors:[["hierarchies"]],viewQuery:function(e,t){if(1&e&&(g.ɵɵviewQuery(w,3),g.ɵɵviewQuery(M,1),g.ɵɵviewQuery(T,1)),2&e){var n=void 0;g.ɵɵqueryRefresh(n=g.ɵɵloadQuery())&&(t.searchInput=n.first),g.ɵɵqueryRefresh(n=g.ɵɵloadQuery())&&(t.nodeMenuComponent=n.first),g.ɵɵqueryRefresh(n=g.ɵɵloadQuery())&&(t.leafMenuComponent=n.first)}},decls:63,vars:12,consts:[[1,"new-admin-design-main",2,"overflow-y","hidden"],["id","app-container",1,"container-fluid"],[1,"row"],[1,"col-md-3","hierarchy-sidebar"],[1,"row",2,"padding","5px 5px"],[1,"col-md-12"],["type","text",1,"form-control",3,"placeholder","ngModel","ngModelChange"],["searchInput",""],[3,"isAnimated","closeOthers"],[2,"border-radius","0",3,"panelClass"],["accordion-heading","",2,"padding","10px 15px"],[1,"fa","fa-circle",2,"margin-right","10px"],["key","hierarchy.sidebar.geoObjectTypes"],[1,"sidebar-section-content"],["class","list-group",4,"ngFor","ngForOf"],[1,"sidebar-section",2,"border-radius","0",3,"isOpen","panelClass"],[1,"fa","fa-sitemap"],["key","hierarchy.sidebar.hierarchies"],[1,"col-md-9","hierarchy-content"],["id","overflow-div"],[4,"ngIf"],["id","svgHolder"],["id","NodeTooltip",1,"modal-dialog"],[1,"modal-content"],[1,"modal-form"],[1,"row-holder"],[1,"label-holder"],["key","hierarchy.nodeTooltip.geoObjectTypeCode"],[1,"holder"],["id","geoObjectTypeCodeLabel"],["key","hierarchy.nodeTooltip.geoObjectTypeOrganization"],["id","geoObjectTypeOrganizationLabel"],["key","hierarchy.nodeTooltip.hierarchy"],["id","hierarchyLabel"],["key","hierarchy.nodeTooltip.hierarchyCode"],["id","hierarchyCodeLabel"],["key","hierarchy.nodeTooltip.hierarchyOrganization"],["id","hierarchyOrganizationLabel"],[1,"list-group"],[1,"got-org-label-wrapper"],["style","text-align: center;padding: 10px 0;",4,"ngIf"],["class","list-group-item got-li-item",3,"id","ngClass",4,"ngFor","ngForOf"],[2,"text-align","center","padding","10px 0"],["type","button",1,"btn","btn-primary",2,"margin-bottom","20px","min-width","45%",3,"click"],["key","hierarchy.sidebar.newGeoObjectType"],["type","button",1,"btn","btn-primary",2,"margin-bottom","20px","margin-left","10px","min-width","45%",3,"click"],["key","hierarchies.add.group.button.label"],[1,"list-group-item","got-li-item",3,"id","ngClass"],["style","position:absolute;right:10px;background:rgba(255,255,255,.7);top:50%;transform:translateY(-50%);",4,"ngIf"],[2,"position","absolute","right","10px","background","rgba(255,255,255,.7)","top","50%","transform","translateY(-50%)"],["class","fa fa-times delete-btn clickable pull-right",3,"title","click",4,"ngIf"],[1,"fa","fa-pencil","clickable","pull-right",3,"title","click"],["class","fa fa-plus clickable pull-right","title","add",3,"click",4,"ngIf"],[1,"fa","fa-times","delete-btn","clickable","pull-right",3,"title","click"],["title","add",1,"fa","fa-plus","clickable","pull-right",3,"click"],[1,"fa","fa-eye","clickable","pull-right",3,"title","click"],["class","list-group-item hier-li-item clickable",3,"id","ngClass","click",4,"ngFor","ngForOf"],["key","hierarchy.sidebar.newHierarchy"],[1,"list-group-item","hier-li-item","clickable",3,"id","ngClass","click"],["style","position:absolute;right:10px;background:inherit;top:50%;transform:translateY(-50%);",4,"ngIf"],[2,"position","absolute","right","10px","background","inherit","top","50%","transform","translateY(-50%)"],[1,"fa","fa-pencil","pull-right","clickable",3,"title","click"],[1,"fa","fa-eye","pull-right","clickable",3,"title","click"],["id","emptyHierarchyDropzone","class","drop-box-container",4,"ngIf"],["id","emptyHierarchyDropzone",1,"drop-box-container"],[1,"hierarchy-drop-box"],[1,"inner-drop-box"],[1,"upload-text"],["key","hierarchy.content.dragGotToHierarchy"],["key","hierarchy.content.emptyHierarchy"]],template:function(e,t){1&e&&(g.ɵɵelementStart(0,"div",0),g.ɵɵelement(1,"cgr-header"),g.ɵɵelement(2,"loading-bar"),g.ɵɵelementStart(3,"div",1),g.ɵɵelementStart(4,"div",2),g.ɵɵelementStart(5,"nav",3),g.ɵɵelementStart(6,"div",4),g.ɵɵelementStart(7,"div",5),g.ɵɵelementStart(8,"input",6,7),g.ɵɵlistener("ngModelChange",(function(e){return t.filter=e})),g.ɵɵpipe(10,"localize"),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(11,"accordion",8),g.ɵɵelementStart(12,"accordion-group",9),g.ɵɵelementStart(13,"div",10),g.ɵɵelementStart(14,"span"),g.ɵɵelement(15,"i",11),g.ɵɵelementEnd(),g.ɵɵelement(16,"localize",12),g.ɵɵelementEnd(),g.ɵɵelementStart(17,"div",13),g.ɵɵtemplate(18,V,7,3,"ul",14),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(19,"accordion-group",15),g.ɵɵelementStart(20,"div",10),g.ɵɵelementStart(21,"span"),g.ɵɵelement(22,"i",16),g.ɵɵelementEnd(),g.ɵɵelement(23,"localize",17),g.ɵɵelementEnd(),g.ɵɵelementStart(24,"div",13),g.ɵɵtemplate(25,q,7,3,"ul",14),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(26,"div",18),g.ɵɵelementStart(27,"div",19),g.ɵɵtemplate(28,$,3,2,"div",20),g.ɵɵelement(29,"div",21),g.ɵɵelementStart(30,"div",22),g.ɵɵelementStart(31,"div",23),g.ɵɵelementStart(32,"div",24),g.ɵɵelementStart(33,"div",25),g.ɵɵelementStart(34,"div",26),g.ɵɵelementStart(35,"label"),g.ɵɵelement(36,"localize",27),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(37,"div",28),g.ɵɵelement(38,"label",29),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(39,"div",25),g.ɵɵelementStart(40,"div",26),g.ɵɵelementStart(41,"label"),g.ɵɵelement(42,"localize",30),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(43,"div",28),g.ɵɵelement(44,"label",31),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(45,"div",25),g.ɵɵelementStart(46,"div",26),g.ɵɵelementStart(47,"label"),g.ɵɵelement(48,"localize",32),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(49,"div",28),g.ɵɵelement(50,"label",33),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(51,"div",25),g.ɵɵelementStart(52,"div",26),g.ɵɵelementStart(53,"label"),g.ɵɵelement(54,"localize",34),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(55,"div",28),g.ɵɵelement(56,"label",35),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(57,"div",25),g.ɵɵelementStart(58,"div",26),g.ɵɵelementStart(59,"label"),g.ɵɵelement(60,"localize",36),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementStart(61,"div",28),g.ɵɵelement(62,"label",37),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd(),g.ɵɵelementEnd()),2&e&&(g.ɵɵadvance(8),g.ɵɵproperty("placeholder",g.ɵɵpipeBind1(10,10,"hierarchy.sidebar.searchAll"))("ngModel",t.filter),g.ɵɵadvance(3),g.ɵɵproperty("isAnimated",!0)("closeOthers",!1),g.ɵɵadvance(1),g.ɵɵproperty("panelClass","hierarchy-sidebar-content"),g.ɵɵadvance(6),g.ɵɵproperty("ngForOf",t.filteredTypesByOrg),g.ɵɵadvance(1),g.ɵɵproperty("isOpen",!0)("panelClass","hierarchy-sidebar-content"),g.ɵɵadvance(6),g.ɵɵproperty("ngForOf",t.filteredHierarchiesByOrg),g.ɵɵadvance(3),g.ɵɵproperty("ngIf",null!=t.currentHierarchy&&(null==t.currentHierarchy.rootGeoObjectTypes||0==t.currentHierarchy.rootGeoObjectTypes.length)))},directives:[b.CgrHeaderComponent,S.LoadingBarComponent,C.DefaultValueAccessor,C.NgControlStatus,C.NgModel,E.AccordionComponent,E.AccordionPanelComponent,x.LocalizeComponent,O.NgForOf,O.NgIf,O.NgClass],pipes:[I.LocalizePipe],styles:['li.list-group-item[_ngcontent-%COMP%] {\n\tfont-size: 14px;\n\tborder: none;\n}\n\nli.list-group-item.active[_ngcontent-%COMP%] {\n    background-color: #DBD7A5;\n}\n\nli.list-group-item.got-li-item[_ngcontent-%COMP%]\n{\n\tborder-top: 15px solid #a0a0a0;\n\tborder-radius: 5px;\n}\n\nli.list-group-item.got-li-item.got-group-parent[_ngcontent-%COMP%]{\n}\nli.list-group-item.got-li-item.got-group-child[_ngcontent-%COMP%] {\n\tmargin-left: 40px;\n}\nli.list-group-item.got-li-item.got-group-child[_ngcontent-%COMP%]:before {\n    content: "";\n    position: absolute;\n    left: -8px;\n    border-left: 3px solid white;\n    height: 44px;\n    width: 1px;\n    top: -10px;\n}\n\nli.list-group-item.hier-li-item[_ngcontent-%COMP%] {\n\tbackground: #6e6775;\n    border: 2px solid #3E2A5A;\n    color: white;\n}\nli.list-group-item.hier-li-item[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%] {\n\tcolor: white;\n}\n\nli.list-group-item.hier-li-item.primary[_ngcontent-%COMP%]\n{\n\tbackground: #3E2A5A;\n}\n\n\nul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child:before {\n   \n   top: 6px; \n}\n\nul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child:before {\n    \n   height: 6px; \n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.got-org-label-wrapper[_ngcontent-%COMP%]{\n\tpadding: 7px 0;\n}\n.got-org-label-wrapper[_ngcontent-%COMP%]    > label[_ngcontent-%COMP%] {\n\tborder-bottom: solid 1px;\n\twidth: 100%;\n}\n\n.sidebar-section-content[_ngcontent-%COMP%] {\n\toverflow-y: auto;\n}\n\n.hierarchy-sidebar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n\tmargin:0;\n}\n\n.hierarchy-sidebar[_ngcontent-%COMP%] {\n    z-index: 999;\n    background: #f1f1f1;\n\n\ttransition: all 0.3s;\n  \tpadding:0;\n    vertical-align: top;\n    height: calc(100vh - 143px);\n    overflow-x: hidden;\n    overflow-y: auto;\n}\n\n.hierarchy-content[_ngcontent-%COMP%] {\n\theight: calc(100vh - 143px);\n    overflow: auto;\n}\n\n#overflow-div[_ngcontent-%COMP%] {\n\ttop: 0;\n}\n\n.upload-text[_ngcontent-%COMP%] {\n\tposition:relative;\n\ttop:40%;\n}\n\n.sidebar-section[_ngcontent-%COMP%] {\n\n\ttext-align: left;\n\n}\n\n\n\n.hierarchy-sidebar-content[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n\n\tbackground-color: #f1f1f1;\n\tmax-height: 500px;\n    overflow: auto;\n}\n\n.sidebar-section-header[_ngcontent-%COMP%] {\n\tmargin-left:20px;\n\tcursor: pointer;\n}\n\n\naccordion-group.panel[_ngcontent-%COMP%] {\n\n}\n\nli.list-group-item[_ngcontent-%COMP%] {\n\tbackground-color: rgba(255, 255, 255, 1.0);\n\tmargin-bottom:5px;\n}\n\n.drop-box-container[_ngcontent-%COMP%] {\n    width: 80%;\n    border: 3px grey dashed;\n    border-radius: 5px;\n    margin: 0 auto;\n    margin-top: 50px;\n}\n\n.hierarchy-drop-box[_ngcontent-%COMP%] {\n  position:relative;\n  height: 100%;\n  cursor: default;\n}\n\nli.got-li-item.dragging[_ngcontent-%COMP%] {\n\tposition: fixed;\n\tcursor: grabbing !important;\n\tz-index: 99999999;\n}\n\n[data-candrag="true"][_ngcontent-%COMP%] {\n\tcursor: pointer;\n}\n[data-candrag="false"][_ngcontent-%COMP%] {\n  cursor: not-allowed;\n}\n\n#NodeTooltip[_ngcontent-%COMP%] {\n\topacity:0;\n\tleft:-10000;\n\ttop:-10000;\n\tposition:fixed;\n\twidth: 400px;\n\tmin-width: 400px;\n}\n#NodeTooltip[_ngcontent-%COMP%]   .modal-form[_ngcontent-%COMP%] {\n\tpadding-top:10px;\n}\n#NodeTooltip[_ngcontent-%COMP%]   .modal-form[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%] {\n\tpadding-bottom: 0px;\n}\n#NodeTooltip[_ngcontent-%COMP%]   .label-holder[_ngcontent-%COMP%] {\n\twidth: 40%;\n}\n#NodeTooltip[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%] {\n\twidth: 60%;\n}\n#NodeTooltip[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n  line-height:2.8;\n}\n\n[_nghost-%COMP%]     .panel .panel-heading .accordion-toggle:after {\n    \n    font-family: \'Glyphicons Halflings\';  \n    content: "\\e080";    \n    float: right;        \n\n    margin-top: -30px;\n}\n[_nghost-%COMP%]     .panel.panel-open .panel-heading .accordion-toggle:after {\n    \n    content: "\\e114";    \n}']}),e}();t.HierarchyComponent=W,("undefined"==typeof ngDevMode||ngDevMode)&&g.ɵsetClassMetadata(W,[{type:r.Component,args:[{selector:"hierarchies",templateUrl:"./hierarchy.component.html",styleUrls:["./hierarchy.css"]}]}],(function(){return[{type:h.HierarchyService},{type:f.BsModalService},{type:y.ContextMenuService},{type:v.LocalizationService},{type:h.RegistryService},{type:v.AuthService}]}),{searchInput:[{type:r.ViewChild,args:["searchInput",{static:!0}]}],nodeMenuComponent:[{type:r.ViewChild,args:["nodeMenu"]}],leafMenuComponent:[{type:r.ViewChild,args:["leafMenu"]}]})},540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HierarchyService=void 0;var r=n(0),i=n(34),o=n(32),a=(n(16),n(0)),l=n(34),s=n(16),c=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.getHierarchyTypes=function(e){var t=new i.HttpParams;return t=t.set("types",JSON.stringify(e)),this.http.get(acp+"/cgr/hierarchytype/get-all",{params:t}).toPromise()},e.prototype.getHierarchyGroupedTypes=function(){var e=new i.HttpParams;return this.http.get(acp+"/hierarchy/groupedTypes",{params:e}).toPromise()},e.prototype.addChildToHierarchy=function(e,t,n){var r=this,a=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/hierarchytype/add",JSON.stringify({hierarchyCode:e,parentGeoObjectTypeCode:t,childGeoObjectTypeCode:n}),{headers:a}).pipe(o.finalize((function(){r.eventService.complete()}))).toPromise()},e.prototype.insertBetweenTypes=function(e,t,n,r){var a=this,l=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/hierarchy/insertBetweenTypes",JSON.stringify({hierarchyCode:e,parentGeoObjectTypeCode:t,middleGeoObjectTypeCode:n,youngestGeoObjectTypeCode:r}),{headers:l}).pipe(o.finalize((function(){a.eventService.complete()}))).toPromise()},e.prototype.removeFromHierarchy=function(e,t,n){var r=this,a=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/hierarchytype/remove",JSON.stringify({hierarchyCode:e,parentGeoObjectTypeCode:t,childGeoObjectTypeCode:n}),{headers:a}).pipe(o.finalize((function(){r.eventService.complete()}))).toPromise()},e.prototype.createHierarchyType=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/hierarchytype/create",JSON.stringify({htJSON:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.updateHierarchyType=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/hierarchytype/update",JSON.stringify({htJSON:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.deleteHierarchyType=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/hierarchytype/delete",{code:e},{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.setInheritedHierarchy=function(e,t,n){var r=this,a=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/hierarchy/setInherited",JSON.stringify({hierarchyTypeCode:e,inheritedHierarchyTypeCode:t,geoObjectTypeCode:n}),{headers:a}).pipe(o.finalize((function(){r.eventService.complete()}))).toPromise()},e.prototype.removeInheritedHierarchy=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/hierarchy/removeInherited",JSON.stringify({hierarchyTypeCode:e,geoObjectTypeCode:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.ɵfac=function(t){return new(t||e)(a.ɵɵinject(l.HttpClient),a.ɵɵinject(s.EventService))},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.HierarchyService=c,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(c,[{type:r.Injectable}],(function(){return[{type:l.HttpClient},{type:s.EventService}]}),null)},541:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IOService=void 0;var r=n(0),i=n(34),o=n(32),a=(n(16),n(0)),l=n(34),s=n(16),c=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.importSpreadsheet=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/etl/import",JSON.stringify({json:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.cancelImport=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/etl/cancel-import",JSON.stringify({configuration:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.importShapefile=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/etl/import",JSON.stringify({json:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.listGeoObjectTypes=function(e){var t=new i.HttpParams;return t=t.set("includeAbstractTypes",e.toString()),this.http.get(acp+"/cgr/geoobjecttype/list-types",{params:t}).toPromise()},e.prototype.getTypeAncestors=function(e,t,n){var r=new i.HttpParams;return r=(r=(r=r.set("code",e)).set("hierarchyCode",t)).set("includeInheritedTypes",n.toString()),this.http.get(acp+"/cgr/geoobjecttype/get-ancestors",{params:r}).toPromise()},e.prototype.getHierarchiesForType=function(e,t){var n=this,r=new i.HttpParams;return r=(r=r.set("code",e)).set("includeTypes",t.toString()),this.eventService.start(),this.http.get(acp+"/cgr/geoobjecttype/get-hierarchies",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getHierarchiesForSubtypes=function(e,t){var n=this,r=new i.HttpParams;return r=(r=r.set("code",e)).set("includeTypes",t.toString()),this.eventService.start(),this.http.get(acp+"/cgr/geoobjecttype/get-subtype-hierarchies",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getGeoObjectSuggestions=function(e,t,n,r){var o=new i.HttpHeaders({"Content-Type":"application/json"}),a={text:e,type:t};return null!=n&&null!=r&&(a.parent=n,a.hierarchy=n),this.http.post(acp+"/cgr/geoobject/suggestions",JSON.stringify(a),{headers:o}).toPromise()},e.prototype.createGeoObjectSynonym=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/geo-synonym/createGeoEntitySynonym",JSON.stringify({entityId:e,label:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.deleteGeoObjectSynonym=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/geo-synonym/deleteGeoEntitySynonym",JSON.stringify({synonymId:e,vOid:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getTermSuggestions=function(e,t,n){var r=new i.HttpParams;return r=(r=(r=r.set("mdAttributeId",e)).set("text",t)).set("limit",n),this.http.get(acp+"/uploader/getClassifierSuggestions",{params:r}).toPromise()},e.prototype.createTermSynonym=function(e,t){var n=new i.HttpHeaders({"Content-Type":"application/json"}),r=JSON.stringify({classifierId:e,label:t});return this.http.post(acp+"/uploader/createClassifierSynonym",r,{headers:n}).toPromise()},e.prototype.deleteTermSynonym=function(e){var t=new i.HttpHeaders({"Content-Type":"application/json"}),n=JSON.stringify({synonymId:e});return this.http.post(acp+"/uploader/deleteClassifierSynonym",n,{headers:t}).toPromise()},e.prototype.createTerm=function(e,t,n){var r=new i.HttpHeaders({"Content-Type":"application/json"}),o={parentTermCode:n,termJSON:{label:e,code:t}};return this.http.post(acp+"/cgr/geoobjecttype/addterm",JSON.stringify(o),{headers:r}).toPromise()},e.prototype.removeTerm=function(e,t){var n=new i.HttpHeaders({"Content-Type":"application/json"});return this.http.post(acp+"/cgr/geoobjecttype/deleteterm",JSON.stringify({parentTermCode:e,termCode:t}),{headers:n}).toPromise()},e.ɵfac=function(t){return new(t||e)(a.ɵɵinject(l.HttpClient),a.ɵɵinject(s.EventService))},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.IOService=c,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(c,[{type:r.Injectable}],(function(){return[{type:l.HttpClient},{type:s.EventService}]}),null)},542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizationManagerService=void 0;var r=n(0),i=n(34),o=(n(16),n(0)),a=n(34),l=n(16),s=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.getNewLocaleInfo=function(){return this.http.get(acp+"/localization/getNewLocaleInformation").toPromise()},e.prototype.installLocale=function(e,t,n){var r=new i.HttpParams;return null!=e&&(r=r.set("language",e)),null!=t&&(r=r.set("country",t)),null!=n&&(r=r.set("variant",n)),this.http.get(acp+"/localization/installLocale",{params:r}).toPromise()},e.ɵfac=function(t){return new(t||e)(o.ɵɵinject(a.HttpClient),o.ɵɵinject(l.EventService))},e.ɵprov=o.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.LocalizationManagerService=s,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(s,[{type:r.Injectable}],(function(){return[{type:a.HttpClient},{type:l.EventService}]}),null)},543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapService=void 0;var r=n(0),i=n(34),o=n(32),a=n(263),l=(n(16),n(0)),s=n(34),c=n(16),d=function(){function e(e,t){this.http=e,this.eventService=t,a.accessToken="pk.eyJ1IjoidGVycmFmcmFtZSIsImEiOiJjanZxNWE5bWkwazYwNGFtb3loOGxsbjR1In0.ZNEwT-pBnGookEb-BF_jQQ"}return e.prototype.roots=function(e,t,n){var r=this,a=new i.HttpParams;return null!=e&&(a=a.set("typeCode",e)),null!=t&&(a=a.set("hierarchyCode",t)),null!=n&&(a=a.set("date",n)),this.eventService.start(),this.http.get(acp+"/registrylocation/roots",{params:a}).pipe(o.finalize((function(){r.eventService.complete()}))).toPromise()},e.prototype.search=function(e,t){var n=this,r=new i.HttpParams;return r=r.set("text",e),null!=t&&(r=r.set("date",t)),this.eventService.start(),this.http.get(acp+"/registrylocation/search",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.ɵfac=function(t){return new(t||e)(l.ɵɵinject(s.HttpClient),l.ɵɵinject(c.EventService))},e.ɵprov=l.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.MapService=d,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(d,[{type:r.Injectable}],(function(){return[{type:s.HttpClient},{type:c.EventService}]}),null)},544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegistryService=void 0;var r=n(0),i=n(34),o=n(32),a=(n(16),n(0)),l=n(34),s=n(16),c=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.init=function(){return this.http.get(acp+"/cgr/init").toPromise()},e.prototype.getGeoObjectTypes=function(e,t){var n=new i.HttpParams;return null!=e&&(n=n.set("types",JSON.stringify(e))),null!=t&&(n=n.set("hierarchies",JSON.stringify(t))),this.http.get(acp+"/cgr/geoobjecttype/get-all",{params:n}).toPromise()},e.prototype.getParentGeoObjects=function(e,t,n,r,o){var a=new i.HttpParams;return a=(a=(a=(a=a.set("childId",e)).set("childTypeCode",t)).set("parentTypes",JSON.stringify(n))).set("recursive",JSON.stringify(r)),null!=o&&(a=a.set("date",o)),this.http.get(acp+"/cgr/geoobject/get-parent-geoobjects",{params:a}).toPromise()},e.prototype.getChildGeoObjects=function(e,t,n,r){var o=new i.HttpParams;return o=(o=(o=(o=o.set("parentId",e)).set("parentTypeCode",t)).set("childrenTypes",JSON.stringify(n))).set("recursive",JSON.stringify(r)),this.http.get(acp+"/cgr/geoobject/getchildren",{params:o}).toPromise()},e.prototype.newGeoObjectInstance=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobject/newGeoObjectInstance",JSON.stringify({typeCode:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.createGeoObjectType=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/create",JSON.stringify({gtJSON:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.updateGeoObjectType=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/update",JSON.stringify({gtJSON:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.deleteGeoObjectType=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/delete",JSON.stringify({code:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.addAttributeType=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/addattribute",JSON.stringify({geoObjTypeId:e,attributeType:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.updateAttributeType=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/updateattribute",JSON.stringify({geoObjTypeId:e,attributeType:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.deleteAttributeType=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/deleteattribute",JSON.stringify({geoObjTypeId:e,attributeName:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.addAttributeTermTypeOption=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/addterm",JSON.stringify({parentTermCode:e,termJSON:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.updateAttributeTermTypeOption=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/updateterm",JSON.stringify({parentTermCode:e,termJSON:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.deleteAttributeTermTypeOption=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobjecttype/deleteterm",JSON.stringify({parentTermCode:e,termCode:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getGeoObject=function(e,t){var n=new i.HttpParams;return n=(n=n.set("id",e)).set("typeCode",t),this.http.get(acp+"/cgr/geoobject/get",{params:n}).toPromise()},e.prototype.getGeoObjectBounds=function(e,t){var n=new i.HttpParams;return n=(n=n.set("code",e)).set("typeCode",t),this.http.get(acp+"/cgr/geoobject/get-bounds",{params:n}).toPromise()},e.prototype.getGeoObjectBoundsAtDate=function(e,t,n){var r=new i.HttpParams;return r=(r=(r=r.set("code",e)).set("typeCode",t)).set("date",n),this.http.get(acp+"/cgr/geoobject-time/get-bounds",{params:r}).toPromise()},e.prototype.getGeoObjectByCode=function(e,t){var n=new i.HttpParams;return n=(n=n.set("code",e)).set("typeCode",t),this.http.get(acp+"/cgr/geoobject/get-code",{params:n}).toPromise()},e.prototype.getHierarchiesForGeoObject=function(e,t){var n=this,r=new i.HttpParams;return r=(r=r.set("code",e)).set("typeCode",t),this.eventService.start(),this.http.get(acp+"/cgr/geoobject/get-hierarchies-over-time",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getGeoObjectSuggestions=function(e,t,n,r,o,a){var l=new i.HttpHeaders({"Content-Type":"application/json"}),s={text:e,type:t};return null!=n&&null!=o&&(s.parent=n,s.hierarchy=o),null!=r&&(s.parentTypeCode=r),null!=a&&(s.date=a),this.http.post(acp+"/cgr/geoobject/suggestions",JSON.stringify(s),{headers:l}).toPromise()},e.prototype.getGeoObjectSuggestionsTypeAhead=function(e,t){var n=new i.HttpHeaders({"Content-Type":"application/json"}),r={text:e,type:t};return this.http.post(acp+"/cgr/geoobject/suggestions",JSON.stringify(r),{headers:n}).toPromise()},e.prototype.getScheduledJobs=function(e,t,n,r){var o=new i.HttpParams;return o=(o=(o=(o=o.set("pageSize",e.toString())).set("pageNumber",t.toString())).set("sortAttr",n)).set("isAscending",r.toString()),this.http.get(acp+"/etl/get-active",{params:o}).toPromise()},e.prototype.getCompletedScheduledJobs=function(e,t,n,r){var o=new i.HttpParams;return o=(o=(o=(o=o.set("pageSize",e.toString())).set("pageNumber",t.toString())).set("sortAttr",n)).set("isAscending",r.toString()),this.http.get(acp+"/etl/get-completed",{params:o}).toPromise()},e.prototype.getScheduledJob=function(e,t,n,r){var o=new i.HttpParams;return o=(o=(o=(o=o.set("historyId",e)).set("pageSize",t.toString())).set("pageNumber",n.toString())).set("onlyUnresolved",r.toString()),this.http.get(acp+"/etl/get-import-details",{params:o}).toPromise()},e.prototype.getExportDetails=function(e,t,n){var r=new i.HttpParams;return r=(r=(r=r.set("historyId",e)).set("pageSize",t.toString())).set("pageNumber",n.toString()),this.http.get(acp+"/etl/get-export-details",{params:r}).toPromise()},e.prototype.resolveScheduledJob=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/etl/import-resolve",JSON.stringify({historyId:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.submitValidationResolve=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/etl/validation-resolve",JSON.stringify({config:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.submitErrorResolve=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/etl/error-resolve",JSON.stringify({config:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.getMasterLists=function(){var e=new i.HttpParams;return this.http.get(acp+"/master-list/list-all",{params:e}).toPromise()},e.prototype.getMasterListHistory=function(e,t){var n=new i.HttpParams;return n=(n=n.set("oid",e)).set("versionType",t),this.http.get(acp+"/master-list/versions",{params:n}).toPromise()},e.prototype.getAllMasterListVersions=function(){var e=new i.HttpParams;return this.http.get(acp+"/master-list/list-all-versions",{params:e}).toPromise()},e.prototype.getMasterListVersion=function(e){var t=new i.HttpParams;return t=t.set("oid",e),this.http.get(acp+"/master-list/version",{params:t}).toPromise()},e.prototype.getLocales=function(){var e=new i.HttpParams;return this.http.get(acp+"/localization/get-locales",{params:e}).toPromise()},e.prototype.getGeoObjectOverTime=function(e,t){var n=new i.HttpParams;return n=(n=n.set("code",e)).set("typeCode",t),this.http.get(acp+"/cgr/geoobject-time/get-code",{params:n}).toPromise()},e.prototype.newGeoObjectOverTime=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/cgr/geoobject-time/newGeoObjectInstance",JSON.stringify({typeCode:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.setAttributeVersions=function(e,t,n,r){var a=this,l=new i.HttpHeaders({"Content-Type":"application/json"}),s={geoObjectCode:e,geoObjectTypeCode:t,attributeName:n,collection:r};return this.eventService.start(),this.http.post(acp+"/cgr/geoobject/setAttributeVersions",JSON.stringify(s),{headers:l}).pipe(o.finalize((function(){a.eventService.complete()}))).toPromise()},e.prototype.createMasterList=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/master-list/create",JSON.stringify({list:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.createMasterListVersion=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/master-list/create-version",JSON.stringify({oid:e,forDate:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.publishMasterListVersions=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/master-list/publish-versions",JSON.stringify({oid:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.deleteMasterList=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/master-list/remove",JSON.stringify({oid:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.deleteMasterListVersion=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/master-list/remove-version",JSON.stringify({oid:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.publishMasterList=function(e){var t=new i.HttpHeaders({"Content-Type":"application/json"});return this.http.post(acp+"/master-list/publish",JSON.stringify({oid:e}),{headers:t})},e.prototype.getMasterList=function(e){var t=new i.HttpParams;return t=t.set("oid",e),this.http.get(acp+"/master-list/get",{params:t}).toPromise()},e.prototype.applyGeoObjectEdit=function(e,t,n,r,a){var l=this,s=new i.HttpHeaders({"Content-Type":"application/json"}),c={geoObjectCode:e,geoObjectTypeCode:t,actions:n};return null!=r&&(c.masterListId=r),null!=a&&(c.notes=a),this.eventService.start(),this.http.post(acp+"/geoobject-editor/updateGeoObject",JSON.stringify(c),{headers:s}).pipe(o.finalize((function(){l.eventService.complete()}))).toPromise()},e.prototype.applyGeoObjectCreate=function(e,t,n,r,a){var l=this,s=new i.HttpHeaders({"Content-Type":"application/json"});for(var c in t.attributes){var d=t.attributes[c];"date"===d.type&&d.values.forEach((function(e){e.value=new Date(e.value).getTime().toString()}))}var p={geoObject:t,isNew:n,masterListId:r};return null!=e&&(p.parentTreeNode=e),null!=a&&(p.notes=a),this.eventService.start(),this.http.post(acp+"/geoobject-editor/createGeoObject",JSON.stringify(p),{headers:s}).pipe(o.finalize((function(){l.eventService.complete()}))).toPromise()},e.prototype.data=function(e,t,n,r,o){var a=new i.HttpHeaders({"Content-Type":"application/json"}),l={oid:e,sort:o};return null!=t&&(l.pageNumber=t),null!=n&&(l.pageSize=n),r.length>0&&(l.filter=r),this.http.post(acp+"/master-list/data",JSON.stringify(l),{headers:a}).toPromise()},e.prototype.values=function(e,t,n,r,o){var a=new i.HttpHeaders({"Content-Type":"application/json"}),l={oid:e,attributeName:n,valueAttribute:r};return o.length>0&&(l.filter=o),null!=t&&t.length>0&&(l.value=t),this.http.post(acp+"/master-list/values",JSON.stringify(l),{headers:a}).toPromise()},e.prototype.publishShapefile=function(e){var t=new i.HttpHeaders({"Content-Type":"application/json"}),n={oid:e};return this.http.post(acp+"/master-list/generate-shapefile",JSON.stringify(n),{headers:t}).toPromise()},e.prototype.progress=function(e){var t=new i.HttpParams;return t=t.set("oid",e),this.http.get(acp+"/master-list/progress",{params:t}).toPromise()},e.prototype.getMasterListsByOrg=function(){var e=new i.HttpParams;return this.http.get(acp+"/master-list/list-org",{params:e}).toPromise()},e.prototype.getPublishMasterListJobs=function(e,t,n,r,o){var a=new i.HttpParams;return a=(a=(a=(a=(a=a.set("oid",e)).set("pageSize",t.toString())).set("pageNumber",n.toString())).set("sortAttr",r)).set("isAscending",o.toString()),this.http.get(acp+"/master-list/get-publish-jobs",{params:a}).toPromise()},e.prototype.getDatasetBounds=function(e){var t=new i.HttpParams;return t=t.set("oid",e),this.http.get(acp+"/master-list/bounds",{params:t}).toPromise()},e.prototype.getOrganizations=function(){var e=this;return this.eventService.start(),this.http.get(acp+"/cgr/organizations/get-all").pipe(o.finalize((function(){e.eventService.complete()}))).toPromise()},e.ɵfac=function(t){return new(t||e)(a.ɵɵinject(l.HttpClient),a.ɵɵinject(s.EventService))},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.RegistryService=c,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(c,[{type:r.Injectable}],(function(){return[{type:l.HttpClient},{type:s.EventService}]}),null)},545:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SynchronizationConfigService=void 0;var r=n(0),i=n(34),o=n(32),a=(n(16),n(0)),l=n(34),s=n(16),c=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.getPage=function(e,t){var n=this,r=new i.HttpParams;return r=(r=r.set("pageNumber",e.toString())).set("pageSize",t.toString()),this.eventService.start(),this.http.get(acp+"/synchronization-config/get-all",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.get=function(e){var t=this,n=new i.HttpParams;return n=n.set("oid",e),this.eventService.start(),this.http.get(acp+"/synchronization-config/get",{params:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.getCustomAttrCfg=function(e,t){var n=this,r=new i.HttpParams;return r=(r=r.set("externalId",t)).set("geoObjectTypeCode",e),this.eventService.start(),this.http.get(acp+"/synchronization-config/get-custom-attr",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.getConfigForES=function(e,t){var n=this,r=new i.HttpParams;return r=(r=r.set("externalSystemId",e)).set("hierarchyTypeCode",t),this.eventService.start(),this.http.get(acp+"/synchronization-config/get-config-for-es",{params:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.prototype.apply=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/synchronization-config/apply",JSON.stringify({config:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.edit=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"}),r={};return null!=e&&(r={oid:e}),this.eventService.start(),this.http.post(acp+"/synchronization-config/edit",JSON.stringify(r),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.remove=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/synchronization-config/remove",JSON.stringify({oid:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.unlock=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/synchronization-config/unlock",JSON.stringify({oid:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.run=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/synchronization-config/run",JSON.stringify({oid:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.getJobs=function(e,t,n){var r=new i.HttpParams;return r=(r=(r=r.set("oid",e)).set("pageNumber",t.toString())).set("pageSize",n.toString()),this.http.get(acp+"/synchronization-config/get-jobs",{params:r}).toPromise()},e.ɵfac=function(t){return new(t||e)(a.ɵɵinject(l.HttpClient),a.ɵɵinject(s.EventService))},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.SynchronizationConfigService=c,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(c,[{type:r.Injectable}],(function(){return[{type:l.HttpClient},{type:s.EventService}]}),null)},546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaskService=void 0;var r=n(0),i=n(34),o=n(32),a=(n(16),n(0)),l=n(34),s=n(16),c=function(){function e(e,t){this.http=e,this.eventService=t}return e.prototype.getMyTasks=function(e,t,n){var r=new i.HttpParams;return r=(r=(r=(r=r.set("orderBy","createDate")).set("pageNum",e.toString())).set("pageSize",t.toString())).set("whereStatus",n),this.http.get(acp+"/tasks/get",{params:r}).toPromise()},e.prototype.completeTask=function(e){var t=this,n=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/tasks/complete",JSON.stringify({id:e}),{headers:n}).pipe(o.finalize((function(){t.eventService.complete()}))).toPromise()},e.prototype.setTaskStatus=function(e,t){var n=this,r=new i.HttpHeaders({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/tasks/setTaskStatus",JSON.stringify({id:e,status:t}),{headers:r}).pipe(o.finalize((function(){n.eventService.complete()}))).toPromise()},e.ɵfac=function(t){return new(t||e)(a.ɵɵinject(l.HttpClient),a.ɵɵinject(s.EventService))},e.ɵprov=a.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}();t.TaskService=c,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(c,[{type:r.Injectable}],(function(){return[{type:l.HttpClient},{type:s.EventService}]}),null)},547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBboxFromSelection=t.isBboxTotallyWithin=t.isBboxPartiallyWithin=t.isPointWithin=t.svgPoint=t.calculateTextWidth=void 0;var r=n(378);function i(e,t){return e.y>t.y&&e.y<t.y+t.height&&e.x>t.x&&e.x<t.x+t.width}t.calculateTextWidth=function(e,t){var n=r.select("#svg").append("g").classed("g-text-calc",!0).append("text").attr("x",-5e3).attr("y",-5e3).attr("font-size",t).text(e).node().getBBox();return r.select(".g-text-calc").remove(),n.width+2},t.svgPoint=function(e,t){var n=r.select("#svg").node(),i=n.createSVGPoint();return i.x=e,i.y=t,i.matrixTransform(n.getScreenCTM().inverse())},t.isPointWithin=i,t.isBboxPartiallyWithin=function(e,t){return i({x:e.x,y:e.y},t)||i({x:e.x+e.width,y:e.y+e.height},t)||i({x:e.x+e.width,y:e.y},t)||i({x:e.x,y:e.y+e.height},t)},t.isBboxTotallyWithin=function(e,t){return i({x:e.x,y:e.y},t)&&i({x:e.x+e.width,y:e.y+e.height},t)&&i({x:e.x+e.width,y:e.y},t)&&i({x:e.x,y:e.y+e.height},t)},t.getBboxFromSelection=function(e){return{x:parseInt(e.attr("x")),y:parseInt(e.attr("y")),width:parseInt(e.attr("width")),height:parseInt(e.attr("height"))}}},548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributesPageComponent=void 0;var r=n(0),i=(n(522),n(0)),o=n(68),a=n(22),l=n(1);function s(e,t){if(1&e&&(i.ɵɵelementStart(0,"option",21),i.ɵɵtext(1),i.ɵɵelementEnd()),2&e){var n=t.$implicit;i.ɵɵpropertyInterpolate("value",n),i.ɵɵadvance(1),i.ɵɵtextInterpolate(n)}}function c(e,t){if(1&e&&(i.ɵɵelementStart(0,"div",8),i.ɵɵelementStart(1,"div",9),i.ɵɵelementStart(2,"div",16),i.ɵɵelementStart(3,"label",17),i.ɵɵtext(4),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(5,"div",18),i.ɵɵelementStart(6,"select",19),i.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.target=e})),i.ɵɵelement(7,"option"),i.ɵɵtemplate(8,s,2,2,"option",20),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=t.$implicit,r=i.ɵɵnextContext();i.ɵɵadvance(4),i.ɵɵtextInterpolate(n.label.localizedValue),i.ɵɵadvance(2),i.ɵɵproperty("name",n.code+(null!=n.locale?n.locale:""))("ngModel",n.target)("required","invalid"!==n.code&&n.required),i.ɵɵadvance(2),i.ɵɵproperty("ngForOf",r.configuration.sheet.attributes[n.baseType])}}var d=function(e){return{"chk-checked":e}};function p(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"div",8),i.ɵɵelementStart(1,"div",9),i.ɵɵelementStart(2,"div",16),i.ɵɵelementStart(3,"label",17),i.ɵɵelement(4,"localize",22),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(5,"div",23),i.ɵɵelementStart(6,"div",24),i.ɵɵelementStart(7,"div",25),i.ɵɵlistener("click",(function(){i.ɵɵrestoreView(n);var e=i.ɵɵnextContext();return e.configuration.postalCode=!e.configuration.postalCode})),i.ɵɵelement(8,"span"),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()}if(2&e){var r=i.ɵɵnextContext();i.ɵɵadvance(7),i.ɵɵproperty("ngClass",i.ɵɵpureFunction1(1,d,r.configuration.postalCode))}}function m(e,t){if(1&e&&(i.ɵɵelementStart(0,"option",21),i.ɵɵtext(1),i.ɵɵelementEnd()),2&e){var n=t.$implicit;i.ɵɵpropertyInterpolate("value",n),i.ɵɵadvance(1),i.ɵɵtextInterpolate(n)}}function u(e,t){if(1&e&&(i.ɵɵelementStart(0,"option",21),i.ɵɵtext(1),i.ɵɵelementEnd()),2&e){var n=t.$implicit;i.ɵɵpropertyInterpolate("value",n),i.ɵɵadvance(1),i.ɵɵtextInterpolate(n)}}function g(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"div",9),i.ɵɵelementStart(1,"div",16),i.ɵɵelementStart(2,"label",17),i.ɵɵelement(3,"localize",29),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(4,"div",18),i.ɵɵelementStart(5,"select",30),i.ɵɵlistener("ngModelChange",(function(e){return i.ɵɵrestoreView(n),i.ɵɵnextContext(2).configuration.revealGeometryColumn=e})),i.ɵɵelement(6,"option"),i.ɵɵtemplate(7,u,2,2,"option",20),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()}if(2&e){var r=i.ɵɵnextContext(2);i.ɵɵadvance(5),i.ɵɵproperty("ngModel",r.configuration.revealGeometryColumn)("required",!1),i.ɵɵadvance(2),i.ɵɵproperty("ngForOf",r.configuration.sheet.attributes.text)}}function h(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"div",8),i.ɵɵelementStart(1,"div",9),i.ɵɵelementStart(2,"div",16),i.ɵɵelementStart(3,"label",17),i.ɵɵelement(4,"localize",26),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(5,"div",18),i.ɵɵelementStart(6,"select",27),i.ɵɵlistener("ngModelChange",(function(e){return i.ɵɵrestoreView(n),i.ɵɵnextContext().configuration.externalIdAttributeTarget=e})),i.ɵɵelement(7,"option"),i.ɵɵtemplate(8,m,2,2,"option",20),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵtemplate(9,g,8,3,"div",28),i.ɵɵelementEnd()}if(2&e){var r=i.ɵɵnextContext();i.ɵɵadvance(6),i.ɵɵproperty("ngModel",r.configuration.externalIdAttributeTarget)("required",!0),i.ɵɵadvance(2),i.ɵɵproperty("ngForOf",r.configuration.sheet.attributes.text),i.ɵɵadvance(1),i.ɵɵproperty("ngIf","RevealExternalSystem"===r.configuration.externalSystem.type&&"EXCEL"===r.configuration.formatType)}}function f(e,t){1&e&&i.ɵɵelement(0,"localize",31)}function y(e,t){1&e&&i.ɵɵelement(0,"localize",32)}var v=function(){function e(){this.configurationChange=new r.EventEmitter,this.stateChange=new r.EventEmitter}return e.prototype.onNext=function(){this.configurationChange.emit(this.configuration),this.stateChange.emit("NEXT")},e.prototype.onCancel=function(){this.stateChange.emit("CANCEL")},e.ɵfac=function(t){return new(t||e)},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["attributes-page"]],inputs:{configuration:"configuration"},outputs:{configurationChange:"configurationChange",stateChange:"stateChange"},decls:20,vars:6,consts:[[1,"text-center"],["key","io.attributes.title"],[1,"lead"],["key","io.attributes.description"],[1,"modal-form"],["form","ngForm"],["class","form-group",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[1,"form-group"],[1,"row-holder"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.next",4,"ngIf"],["key","io.ok",4,"ngIf"],[1,"label-holder"],[1,""],[1,"holder"],[1,"select-area",3,"name","ngModel","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["key","io.modal.postalCode"],[1,"form-check"],[1,"check-block"],["name","postalCode",1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],["key","io.modal.external"],["name","externalId",1,"select-area",3,"ngModel","required","ngModelChange"],["class","row-holder",4,"ngIf"],["key","io.import.revealGeometryAttribute"],["name","revealGeometryColumn",1,"select-area",3,"ngModel","required","ngModelChange"],["key","io.next"],["key","io.ok"]],template:function(e,t){if(1&e&&(i.ɵɵelementStart(0,"div"),i.ɵɵelementStart(1,"div",0),i.ɵɵelementStart(2,"h2"),i.ɵɵelement(3,"localize",1),i.ɵɵelementEnd(),i.ɵɵelementStart(4,"p",2),i.ɵɵelement(5,"localize",3),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(6,"form",4,5),i.ɵɵtemplate(8,c,9,5,"div",6),i.ɵɵelement(9,"hr"),i.ɵɵtemplate(10,p,9,3,"div",7),i.ɵɵtemplate(11,h,10,4,"div",7),i.ɵɵelementStart(12,"div",8),i.ɵɵelementStart(13,"div",9),i.ɵɵelementStart(14,"div",10),i.ɵɵelementStart(15,"button",11),i.ɵɵlistener("click",(function(){return t.onCancel()})),i.ɵɵelement(16,"localize",12),i.ɵɵelementEnd(),i.ɵɵelementStart(17,"button",13),i.ɵɵlistener("click",(function(){return t.onNext()})),i.ɵɵtemplate(18,f,1,0,"localize",14),i.ɵɵtemplate(19,y,1,0,"localize",15),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=i.ɵɵreference(7);i.ɵɵadvance(8),i.ɵɵproperty("ngForOf",t.configuration.type.attributes),i.ɵɵadvance(2),i.ɵɵproperty("ngIf",t.configuration.hasPostalCode),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t.configuration.isExternal),i.ɵɵadvance(6),i.ɵɵproperty("disabled",n.invalid),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",!t.configuration.postalCode),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t.configuration.postalCode)}},directives:[o.LocalizeComponent,a.ɵangular_packages_forms_forms_ba,a.NgControlStatusGroup,a.NgForm,l.NgForOf,l.NgIf,a.SelectControlValueAccessor,a.NgControlStatus,a.NgModel,a.RequiredValidator,a.NgSelectOption,a.ɵangular_packages_forms_forms_z,l.NgClass],encapsulation:2}),e}();t.AttributesPageComponent=v,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(v,[{type:r.Component,args:[{selector:"attributes-page",templateUrl:"./attributes-page.component.html",styleUrls:[]}]}],(function(){return[]}),{configuration:[{type:r.Input}],configurationChange:[{type:r.Output}],stateChange:[{type:r.Output}]})},549:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationPageComponent=void 0;var r=n(0),i=(n(522),n(518),n(0)),o=n(518),a=n(22),l=n(68),s=n(1);function c(e,t){if(1&e&&(i.ɵɵelementStart(0,"option",35),i.ɵɵtext(1),i.ɵɵelementEnd()),2&e){var n=t.$implicit;i.ɵɵproperty("value",n),i.ɵɵadvance(1),i.ɵɵtextInterpolate(n)}}function d(e,t){1&e&&(i.ɵɵelementStart(0,"option",36),i.ɵɵelement(1,"localize",37),i.ɵɵelementEnd())}function p(e,t){1&e&&(i.ɵɵelementStart(0,"option",38),i.ɵɵelement(1,"localize",39),i.ɵɵelementEnd())}function m(e,t){if(1&e&&(i.ɵɵelementStart(0,"div",17),i.ɵɵelementStart(1,"div",9),i.ɵɵelementStart(2,"div",18),i.ɵɵelementStart(3,"div",19),i.ɵɵelementStart(4,"label"),i.ɵɵtext(5),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(6,"div",20),i.ɵɵelementStart(7,"div",21),i.ɵɵelementStart(8,"label"),i.ɵɵelement(9,"localize",22),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(10,"div",23),i.ɵɵelementStart(11,"select",24),i.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.target=e})),i.ɵɵelement(12,"option",25),i.ɵɵtemplate(13,c,2,2,"option",26),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(14,"div",21),i.ɵɵelementStart(15,"label"),i.ɵɵelement(16,"localize",27),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(17,"div",23),i.ɵɵelementStart(18,"select",28),i.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.matchStrategy=e})),i.ɵɵelement(19,"option"),i.ɵɵelementStart(20,"option",29),i.ɵɵelement(21,"localize",30),i.ɵɵelementEnd(),i.ɵɵelementStart(22,"option",31),i.ɵɵelement(23,"localize",32),i.ɵɵelementEnd(),i.ɵɵtemplate(24,d,2,0,"option",33),i.ɵɵtemplate(25,p,2,0,"option",34),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=t.$implicit,r=t.index,o=i.ɵɵnextContext();i.ɵɵadvance(5),i.ɵɵtextInterpolate1(" ",n.label," "),i.ɵɵadvance(6),i.ɵɵproperty("ngModel",n.target)("name",r+"-location"),i.ɵɵadvance(2),i.ɵɵproperty("ngForOf",o.configuration.sheet.attributes.text),i.ɵɵadvance(5),i.ɵɵproperty("name",r+"-matchStrategy")("ngModel",n.matchStrategy)("required",null!=n.target&&""!==n.target),i.ɵɵadvance(6),i.ɵɵproperty("ngIf",o.configuration.isExternal),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",o.configuration.isExternal&&"DHIS2ExternalSystem"===o.configuration.externalSystem.type)}}var u=function(){function e(e){this.service=e,this.configurationChange=new r.EventEmitter,this.stateChange=new r.EventEmitter}return e.prototype.ngOnInit=function(){var e=this;this.service.getTypeAncestors(this.configuration.type.code,this.configuration.hierarchy,!0).then((function(t){e.configuration.locations=t}))},e.prototype.onNext=function(){this.configurationChange.emit(this.configuration),this.stateChange.emit("NEXT")},e.prototype.onBack=function(){this.stateChange.emit("BACK")},e.prototype.onCancel=function(){this.stateChange.emit("CANCEL")},e.ɵfac=function(t){return new(t||e)(i.ɵɵdirectiveInject(o.IOService))},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["location-page"]],inputs:{configuration:"configuration"},outputs:{configurationChange:"configurationChange",stateChange:"stateChange"},decls:19,vars:2,consts:[[1,"modal-form"],[1,"text-center"],["key","io.location.title"],[1,"lead"],["key","io.location.description"],[1,"col-md-12","order-md-1"],["form","ngForm"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group","row"],[1,"row-holder"],[1,"button-holder"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","io.back"],["type","btn","role","button",1,"btn","btn-default",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"],[1,"form-group"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"label-holder"],["key","io.import.modal.parent.source"],[1,"holder"],[1,"select-area",3,"ngModel","name","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["key","io.import.modal.parent.matchStrategy"],[1,"select-area",3,"name","ngModel","required","ngModelChange"],["value","ALL"],["key","io.modal.all"],["value","CODE"],["key","io.modal.code"],["value","EXTERNAL",4,"ngIf"],["value","DHIS2_PATH",4,"ngIf"],[3,"value"],["value","EXTERNAL"],["key","io.modal.external"],["value","DHIS2_PATH"],["key","io.modal.dhis2path"]],template:function(e,t){if(1&e&&(i.ɵɵelementStart(0,"form",0),i.ɵɵelementStart(1,"div",1),i.ɵɵelementStart(2,"h2"),i.ɵɵelement(3,"localize",2),i.ɵɵelementEnd(),i.ɵɵelementStart(4,"p",3),i.ɵɵelement(5,"localize",4),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(6,"div",5),i.ɵɵelementStart(7,"form",null,6),i.ɵɵtemplate(9,m,26,9,"div",7),i.ɵɵelementStart(10,"div",8),i.ɵɵelementStart(11,"div",9),i.ɵɵelementStart(12,"div",10),i.ɵɵelementStart(13,"button",11),i.ɵɵlistener("click",(function(){return t.onBack()})),i.ɵɵelement(14,"localize",12),i.ɵɵelementEnd(),i.ɵɵelementStart(15,"button",13),i.ɵɵlistener("click",(function(){return t.onCancel()})),i.ɵɵelement(16,"localize",14),i.ɵɵelementEnd(),i.ɵɵelementStart(17,"button",15),i.ɵɵlistener("click",(function(){return t.onNext()})),i.ɵɵelement(18,"localize",16),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=i.ɵɵreference(8);i.ɵɵadvance(9),i.ɵɵproperty("ngForOf",t.configuration.locations),i.ɵɵadvance(8),i.ɵɵproperty("disabled",n.invalid)}},directives:[a.ɵangular_packages_forms_forms_ba,a.NgControlStatusGroup,a.NgForm,l.LocalizeComponent,s.NgForOf,a.SelectControlValueAccessor,a.NgControlStatus,a.NgModel,a.NgSelectOption,a.ɵangular_packages_forms_forms_z,a.RequiredValidator,s.NgIf],encapsulation:2}),e}();t.LocationPageComponent=u,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(u,[{type:r.Component,args:[{selector:"location-page",templateUrl:"./location-page.component.html",styleUrls:[]}]}],(function(){return[{type:o.IOService}]}),{configuration:[{type:r.Input}],configurationChange:[{type:r.Output}],stateChange:[{type:r.Output}]})},550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationProblemPageComponent=void 0;var r=n(0),i=(n(522),n(111)),o=n(0),a=n(68),l=n(1),s=n(22),c=n(577);function d(e,t){1&e&&(o.ɵɵelementStart(0,"div",6),o.ɵɵelementStart(1,"div",20),o.ɵɵelement(2,"localize",21),o.ɵɵelementEnd(),o.ɵɵelementEnd())}function p(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",6),o.ɵɵelementStart(1,"div",20),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.message)}}function m(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"location-problem",22),o.ɵɵlistener("onError",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().handleError(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=t.index,a=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("problem",r)("configuration",a.configuration)("index",i)}}function u(e,t){1&e&&o.ɵɵelement(0,"localize",23)}function g(e,t){1&e&&o.ɵɵelement(0,"localize",24)}var h=function(){function e(){this.stateChange=new r.EventEmitter,this.message=null}return e.prototype.ngOnInit=function(){},e.prototype.hasProblems=function(){for(var e=0;e<this.configuration.locationProblems.length;e++)if(!this.configuration.locationProblems[e].resolved)return!0;return!1},e.prototype.handleError=function(e){this.message=i.ErrorHandler.getMessageFromError(e)},e.prototype.onNext=function(){null==this.configuration.exclusions&&(this.configuration.exclusions=[]);for(var e=0;e<this.configuration.locationProblems.length;e++){var t=this.configuration.locationProblems[e];if(t.resolved&&"IGNOREATLOCATION"==t.action.name){var n={code:"##PARENT##",value:null!=t.parent?t.parent+"-"+t.label:t.label};this.configuration.exclusions.push(n)}}this.stateChange.emit("NEXT")},e.prototype.onCancel=function(){this.stateChange.emit("CANCEL")},e.ɵfac=function(t){return new(t||e)},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["location-problem-page"]],inputs:{configuration:"configuration"},outputs:{stateChange:"stateChange"},decls:34,vars:6,consts:[[1,"text-center"],["key","io.locationProblem.title"],[1,"lead"],["key","io.locationProblem.description"],["class","row",4,"ngIf"],["form","ngForm"],[1,"row"],[1,"col-sm-4"],["key","dataUploader.locationContext"],[1,"col-sm-2"],["key","dataUploader.unknownLocation"],["key","dataUploader.synonymn"],["key","dataUploader.actions"],[4,"ngFor","ngForOf"],[1,"col-sm-12","text-right",2,"margin-top","20px"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.next",4,"ngIf"],["key","io.ok",4,"ngIf"],[1,"alert","alert-danger"],["key","dataUploader.existingProblems"],[3,"problem","configuration","index","onError"],["key","io.next"],["key","io.ok"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"div",0),o.ɵɵelementStart(2,"h2"),o.ɵɵelement(3,"localize",1),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"p",2),o.ɵɵelement(5,"localize",3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(6,"div"),o.ɵɵtemplate(7,d,3,0,"div",4),o.ɵɵtemplate(8,p,3,1,"div",4),o.ɵɵelementStart(9,"form",null,5),o.ɵɵelementStart(11,"div",6),o.ɵɵelementStart(12,"div",7),o.ɵɵelementStart(13,"label"),o.ɵɵelement(14,"localize",8),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(15,"div",9),o.ɵɵelementStart(16,"label"),o.ɵɵelement(17,"localize",10),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(18,"div",7),o.ɵɵelementStart(19,"label"),o.ɵɵelement(20,"localize",11),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(21,"div",9),o.ɵɵelementStart(22,"label"),o.ɵɵelement(23,"localize",12),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(24,m,2,3,"div",13),o.ɵɵelementStart(25,"div",6),o.ɵɵelementStart(26,"div",14),o.ɵɵelementStart(27,"button",15),o.ɵɵlistener("click",(function(){return t.onCancel()})),o.ɵɵelementStart(28,"span"),o.ɵɵelement(29,"localize",16),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(30,"button",17),o.ɵɵlistener("click",(function(){return t.onNext()})),o.ɵɵelementStart(31,"span"),o.ɵɵtemplate(32,u,1,0,"localize",18),o.ɵɵtemplate(33,g,1,0,"localize",19),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(7),o.ɵɵproperty("ngIf",t.hasProblems()),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",null!=t.message),o.ɵɵadvance(16),o.ɵɵproperty("ngForOf",t.configuration.locationProblems),o.ɵɵadvance(6),o.ɵɵproperty("disabled",t.hasProblems()),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",null!=t.configuration.termProblems),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",null==t.configuration.termProblems))},directives:[a.LocalizeComponent,l.NgIf,s.ɵangular_packages_forms_forms_ba,s.NgControlStatusGroup,s.NgForm,l.NgForOf,c.LocationProblemComponent],encapsulation:2}),e}();t.LocationProblemPageComponent=h,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(h,[{type:r.Component,args:[{selector:"location-problem-page",templateUrl:"./location-problem-page.component.html",styleUrls:[]}]}],(function(){return[]}),{configuration:[{type:r.Input}],stateChange:[{type:r.Output}]})},551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermProblemPageComponent=void 0;var r=n(0),i=(n(522),n(0)),o=n(68),a=n(1),l=n(22),s=n(578);function c(e,t){1&e&&(i.ɵɵelementStart(0,"div",7),i.ɵɵelementStart(1,"div",20),i.ɵɵelement(2,"localize",21),i.ɵɵelementEnd(),i.ɵɵelementEnd())}function d(e,t){if(1&e&&(i.ɵɵelementStart(0,"div",7),i.ɵɵelementStart(1,"div",20),i.ɵɵtext(2),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e){var n=i.ɵɵnextContext();i.ɵɵadvance(2),i.ɵɵtextInterpolate(n.message)}}function p(e,t){if(1&e&&(i.ɵɵelementStart(0,"div"),i.ɵɵelement(1,"term-problem",22),i.ɵɵelementEnd()),2&e){var n=t.$implicit,r=t.index,o=i.ɵɵnextContext();i.ɵɵadvance(1),i.ɵɵproperty("problem",n)("configuration",o.configuration)("index",r)}}var m=function(){function e(){this.stateChange=new r.EventEmitter,this.message=null}return e.prototype.ngOnInit=function(){},e.prototype.hasProblems=function(){for(var e=0;e<this.configuration.termProblems.length;e++)if(!this.configuration.termProblems[e].resolved)return!0;return!1},e.prototype.onNext=function(){null==this.configuration.exclusions&&(this.configuration.exclusions=[]);for(var e=0;e<this.configuration.termProblems.length;e++){var t=this.configuration.termProblems[e];if(t.resolved&&"IGNORE"==t.action.name){var n={code:t.attributeCode,value:t.label};this.configuration.exclusions.push(n)}}this.stateChange.emit("NEXT")},e.prototype.onCancel=function(){this.stateChange.emit("CANCEL")},e.ɵfac=function(t){return new(t||e)},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["term-problem-page"]],inputs:{configuration:"configuration"},outputs:{stateChange:"stateChange"},decls:33,vars:4,consts:[[1,"text-center"],["key","io.termProblem.title"],[1,"lead"],["key","io.termProblem.description"],[1,"col-md-12","order-md-1"],["class","row",4,"ngIf"],["form","ngForm"],[1,"row"],[1,"col-sm-4"],["key","dataUploader.categoryAttribute"],[1,"col-sm-2"],["key","dataUploader.unknownCategory"],["key","dataUploader.synonymn"],["key","dataUploader.actions"],[4,"ngFor","ngForOf"],[1,"col-sm-12","text-right"],["type","button","role","button",1,"btn",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.ok"],[1,"alert","alert-danger"],["key","dataUploader.existingProblems"],[3,"problem","configuration","index"]],template:function(e,t){1&e&&(i.ɵɵelementStart(0,"div"),i.ɵɵelementStart(1,"div",0),i.ɵɵelementStart(2,"h2"),i.ɵɵelement(3,"localize",1),i.ɵɵelementEnd(),i.ɵɵelementStart(4,"p",2),i.ɵɵelement(5,"localize",3),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(6,"div",4),i.ɵɵtemplate(7,c,3,0,"div",5),i.ɵɵtemplate(8,d,3,1,"div",5),i.ɵɵelementStart(9,"form",null,6),i.ɵɵelementStart(11,"div",7),i.ɵɵelementStart(12,"div",8),i.ɵɵelementStart(13,"label"),i.ɵɵelement(14,"localize",9),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(15,"div",10),i.ɵɵelementStart(16,"label"),i.ɵɵelement(17,"localize",11),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(18,"div",8),i.ɵɵelementStart(19,"label"),i.ɵɵelement(20,"localize",12),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(21,"div",10),i.ɵɵelementStart(22,"label"),i.ɵɵelement(23,"localize",13),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵtemplate(24,p,2,3,"div",14),i.ɵɵelementStart(25,"div",7),i.ɵɵelementStart(26,"div",15),i.ɵɵelementStart(27,"button",16),i.ɵɵlistener("click",(function(){return t.onCancel()})),i.ɵɵelementStart(28,"span"),i.ɵɵelement(29,"localize",17),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(30,"button",18),i.ɵɵlistener("click",(function(){return t.onNext()})),i.ɵɵelementStart(31,"span"),i.ɵɵelement(32,"localize",19),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e&&(i.ɵɵadvance(7),i.ɵɵproperty("ngIf",t.hasProblems()),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",null!=t.message),i.ɵɵadvance(16),i.ɵɵproperty("ngForOf",t.configuration.termProblems),i.ɵɵadvance(6),i.ɵɵproperty("disabled",t.hasProblems()))},directives:[o.LocalizeComponent,a.NgIf,l.ɵangular_packages_forms_forms_ba,l.NgControlStatusGroup,l.NgForm,a.NgForOf,s.TermProblemComponent],encapsulation:2}),e}();t.TermProblemPageComponent=m,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(m,[{type:r.Component,args:[{selector:"term-problem-page",templateUrl:"./term-problem-page.component.html",styleUrls:[]}]}],(function(){return[]}),{configuration:[{type:r.Input}],stateChange:[{type:r.Output}]})},552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeRequestEditor=void 0;var r=n(617),i=n(619),o=function(){function e(e,t,n,r,i,o,a,l){this.changeRequest=e,this.geoObject=t,this.geoObjectType=n,this.geometryAttributeType=i,this.parentAttributeType=o,this.hierarchies=r,this.localizationService=a,this.dateService=l,this.attributeEditors=this.generateAttributeEditors(),this.validate()}return e.prototype.generateAttributeEditors=function(){var e=this,t=["uid","sequence","type","lastUpdateDate","createDate"],n=[],o=this.geoObjectType.attributes.slice();return(o=o.filter((function(e){return-1===t.indexOf(e.code)}))).push(this.geometryAttributeType),o.push(this.parentAttributeType),o.forEach((function(t){if("_PARENT_"!==t.code)if(t.isChangeOverTime){var o=new r.ChangeRequestChangeOverTimeAttributeEditor(e,t,null);n.push(o)}else{o=new i.StandardAttributeCRModel(t,e.geoObject,e.changeRequest);n.push(o)}else e.hierarchies.forEach((function(i){var o=new r.ChangeRequestChangeOverTimeAttributeEditor(e,t,i);n.push(o)}))})),n},e.prototype.hasChanges=function(){var e=!1;return this.attributeEditors.forEach((function(t){t.hasChanges()&&(e=!0)})),e},e.prototype.isValid=function(){return this._isValid},e.prototype.validate=function(e){var t=this;return void 0===e&&(e=!1),this._isValid=!0,this.attributeEditors.forEach((function(n){e&&"exists"===n.attribute.code||(n.validate(!0),n.isValid()||(t._isValid=!1))})),this._isValid},e.prototype.findExistingValueOverTimeByOid=function(e,t){if(this.geoObject.attributes[t]){var n=this.geoObject.attributes[t].values.findIndex((function(t){return t.oid===e}));if(-1!==n)return this.geoObject.attributes[t].values[n]}return null},e.prototype.getEditorForAttribute=function(e,t){void 0===t&&(t=null);var n=this.attributeEditors.findIndex((function(n){return(!n.attribute.isChangeOverTime||null==t&&null==n.hierarchy||null!=n.hierarchy&&n.hierarchy.code===t.code)&&n.attribute.code===e.code}));return-1===n?null:this.attributeEditors[n]},e.prototype.getEditors=function(){return this.attributeEditors},e}();t.ChangeRequestEditor=o},553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubmitChangeRequestComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(111),a=(n(16),n(518),n(0)),l=n(30),s=n(518),c=n(16),d=n(68),p=n(22),m=n(1),u=n(261),g=n(154),h=n(33),f=n(113),y=["attributeEditor"],v=["geometryEditor"];function b(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",17),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("ngValue",n),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label.localizedValue)}}var S=function(e,t,n){return["/registry/location-manager",e,t,n,"true","CR"]};function C(e,t){if(1&e&&(a.ɵɵelementStart(0,"a",18),a.ɵɵelementStart(1,"button",19),a.ɵɵelement(2,"localize",20),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵproperty("routerLink",a.ɵɵpureFunction3(1,S,n.geoObject.attributes.uid,n.geoObject.attributes.type,n.dateStr))}}function E(e,t){1&e&&(a.ɵɵelementStart(0,"button",21),a.ɵɵelement(1,"localize",20),a.ɵɵelementEnd())}var x=function(e){return{"inline-loading":e}},O=function(){function e(e,t,n,r,o){var a=this;this.modalService=e,this.registryService=t,this.changeRequestService=n,this.localizeService=r,this.authService=o,this.geoObjectTypes=[],this.geoObjectId="",this.reason="",this.dateStr=null,this.forDate=null,this.geoObject=null,this.isValid=!1,this.loading=!1,this.geoObjectAttributeExcludes=["uid","sequence","type","lastUpdateDate","createDate","status"],this.dataSource=i.Observable.create((function(e){a.registryService.getGeoObjectSuggestionsTypeAhead(a.geoObjectId,a.geoObjectType.code).then((function(t){e.next(t)}))}))}return e.prototype.ngOnInit=function(){var e=this;this.registryService.getGeoObjectTypes([],null).then((function(t){for(var n=[],r=0;r<t.length;++r){var i=t[r],o=i.organizationCode,a=null!=i.superTypeCode&&""!=i.superTypeCode?i.superTypeCode:i.code;e.authService.isGeoObjectTypeRC(o,a)&&n.push(t[r])}e.geoObjectTypes=n,e.geoObjectTypes.sort((function(e,t){return e.label.localizedValue.toLowerCase()<t.label.localizedValue.toLowerCase()?-1:e.label.localizedValue.toLowerCase()>t.label.localizedValue.toLowerCase()?1:0}));var l=e.getGeoObjectTypePosition("ROOT");l&&e.geoObjectTypes.splice(l,1)})).catch((function(t){e.error(t)}))},e.prototype.handleDateChange=function(){null!=this.dateStr?this.forDate=new Date(Date.parse(this.dateStr)):this.forDate=null},e.prototype.onValidChange=function(e){null!=this.geoObject&&(null==this.geometryEditor||this.geometryEditor.getIsValid())&&(null==this.attributeEditor||this.attributeEditor.getIsValid())?this.isValid=!0:this.isValid=!1},e.prototype.getGeoObjectTypePosition=function(e){for(var t=0;t<this.geoObjectTypes.length;t++){if(this.geoObjectTypes[t].code===e)return t}return null},e.prototype.changeTypeaheadLoading=function(e){this.loading=e},e.prototype.typeaheadOnSelect=function(e){var t=this;this.registryService.getGeoObjectOverTime(e.item.code,this.geoObjectType.code).then((function(e){t.geoObject=e})).catch((function(e){t.error(e)}))},e.prototype.cancel=function(){this.isValid=!1,this.geoObject=null,this.geoObjectId=null,this.geoObjectType=null,this.reason=null},e.prototype.error=function(e){this.bsModalRef=o.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.BsModalService),a.ɵɵdirectiveInject(s.RegistryService),a.ɵɵdirectiveInject(s.ChangeRequestService),a.ɵɵdirectiveInject(c.LocalizationService),a.ɵɵdirectiveInject(c.AuthService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["submit-change-request"]],viewQuery:function(e,t){if(1&e&&(a.ɵɵviewQuery(y,1),a.ɵɵviewQuery(v,1)),2&e){var n=void 0;a.ɵɵqueryRefresh(n=a.ɵɵloadQuery())&&(t.attributeEditor=n.first),a.ɵɵqueryRefresh(n=a.ɵɵloadQuery())&&(t.geometryEditor=n.first)}},decls:22,vars:22,consts:[[1,"row"],[1,"col-md-12"],[2,"margin-top","50px","margin-bottom","50px","background","#f7f7f7","width","100%","padding","10px"],[2,"margin-bottom","20px"],["key","change.request.search.for.geoobject.header"],[1,"col-md-3"],["key","dropdown.select.geoobjecttype.option.label"],["id","geoObjectTypeSelect","name","geoObjectTypeSelect","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["key","changeOverTime.forDate"],["label","","customStyles","width:100%",3,"value","inputName","disable","allowInfinity","allowFutureDates","required","placement","valueChange","change"],[1,"col-md-4"],["key","change.request.search.for.geoobject.search.label"],["type","text","name","geoObjectId","typeaheadOptionField","name","autocomplete","off",1,"form-control",3,"ngClass","ngModel","disabled","typeaheadAsync","typeahead","typeaheadOptionsLimit","placeholder","ngModelChange","typeaheadOnSelect","typeaheadLoading"],[1,"col-md-2"],[3,"routerLink",4,"ngIf"],["disabled","true","class","btn btn-primary","style","width:100%;",4,"ngIf"],[3,"ngValue"],[3,"routerLink"],[1,"btn","btn-primary",2,"width","100%"],["key","change.request.open.geoobject.in.editor.link.btn"],["disabled","true",1,"btn","btn-primary",2,"width","100%"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵelementStart(1,"div",1),a.ɵɵelementStart(2,"div",2),a.ɵɵelementStart(3,"h3",3),a.ɵɵelement(4,"localize",4),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",0),a.ɵɵelementStart(6,"div",5),a.ɵɵelement(7,"localize",6),a.ɵɵelementStart(8,"select",7),a.ɵɵlistener("ngModelChange",(function(e){return t.geoObjectType=e})),a.ɵɵelement(9,"option"),a.ɵɵtemplate(10,b,2,2,"option",8),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"div",5),a.ɵɵelement(12,"localize",9),a.ɵɵelementStart(13,"date-field",10),a.ɵɵlistener("valueChange",(function(e){return t.dateStr=e}))("change",(function(){return t.handleDateChange()})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(14,"div",11),a.ɵɵelement(15,"localize",12),a.ɵɵelementStart(16,"input",13),a.ɵɵlistener("ngModelChange",(function(e){return t.geoObjectId=e}))("typeaheadOnSelect",(function(e){return t.typeaheadOnSelect(e)}))("typeaheadLoading",(function(e){return t.changeTypeaheadLoading(e)})),a.ɵɵpipe(17,"localize"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(18,"div",14),a.ɵɵelement(19,"label"),a.ɵɵtemplate(20,C,3,5,"a",15),a.ɵɵtemplate(21,E,2,0,"button",16),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(8),a.ɵɵproperty("ngModel",t.geoObjectType),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",t.geoObjectTypes),a.ɵɵadvance(3),a.ɵɵproperty("value",t.dateStr)("inputName","dateStr")("disable",!t.geoObjectType)("allowInfinity",!1)("allowFutureDates",!1)("required",!1)("placement","right"),a.ɵɵadvance(3),a.ɵɵproperty("ngClass",a.ɵɵpureFunction1(20,x,t.loading))("ngModel",t.geoObjectId)("disabled",!t.geoObjectType)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",7)("placeholder",a.ɵɵpipeBind1(17,18,"masterlist.search")+"..."),a.ɵɵadvance(4),a.ɵɵproperty("ngIf",t.geoObject&&t.forDate),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!(t.geoObject&&t.forDate)))},directives:[d.LocalizeComponent,p.SelectControlValueAccessor,p.RequiredValidator,p.NgControlStatus,p.NgModel,p.NgSelectOption,p.ɵangular_packages_forms_forms_z,m.NgForOf,u.DateFieldComponent,p.DefaultValueAccessor,m.NgClass,g.TypeaheadDirective,m.NgIf,h.RouterLinkWithHref],pipes:[f.LocalizePipe],styles:["input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%] {\n    height: 40px;\n    \n    padding: 6px 10px;\n    font-size: 14px;\n    line-height: 18px;\n    color: #333;\n    border: 1px solid;\n    border-color: #767676;\n    border-color: var(--theme-input-text-border);\n    border-radius: 5px;\n    background: white;\n    background-color: white;\n    outline: none;\n    box-shadow: none;\n}"]}),e}();t.SubmitChangeRequestComponent=O,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(O,[{type:r.Component,args:[{selector:"submit-change-request",templateUrl:"./submit-change-request.component.html",styleUrls:["./submit-change-request.css"]}]}],(function(){return[{type:l.BsModalService},{type:s.RegistryService},{type:s.ChangeRequestService},{type:c.LocalizationService},{type:c.AuthService}]}),{attributeEditor:[{type:r.ViewChild,args:["attributeEditor"]}],geometryEditor:[{type:r.ViewChild,args:["geometryEditor"]}]})},554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectEditorComponent=void 0;var r=n(0),i=(n(30),n(1)),o=n(111),a=(n(518),n(16),n(203)),l=n(31),s=n(0),c=n(30),d=n(518),p=n(16),m=n(22),u=n(1),g=n(68),h=n(529),f=n(590),y=["attributeEditor"],v=["parentSelector"];function b(e,t){1&e&&(s.ɵɵelementStart(0,"div",24),s.ɵɵelement(1,"localize",25),s.ɵɵelementEnd())}function S(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"geoobject-shared-attribute-editor",26,27),s.ɵɵlistener("valid",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext().onValidChange()})),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵproperty("geoObjectType",r.geoObjectType)("preGeoObject",r.goPropertiesPre)("postGeoObject",r.goPropertiesPost)("forDate",r.forDate)("isNew",r.isNewGeoObject)("isEditingGeometries",r.isEditingGeometries)}}function C(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div"),s.ɵɵelementStart(1,"cascading-geo-selector",28,29),s.ɵɵlistener("valid",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext().onValidChange()})),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵproperty("isValid",r.isValid)("forDate",r.forDate)("hierarchies",r.hierarchies)}}function E(e,t){1&e&&(s.ɵɵelementStart(0,"p",36),s.ɵɵtext(1,"Notes are required."),s.ɵɵelementEnd())}function x(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",30),s.ɵɵelementStart(1,"div",15),s.ɵɵelementStart(2,"label"),s.ɵɵelement(3,"localize",31),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(4,"div",32),s.ɵɵelementStart(5,"textarea",33),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext().notes=e})),s.ɵɵelementEnd(),s.ɵɵelementStart(6,"div",34),s.ɵɵtemplate(7,E,2,0,"p",35),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵadvance(5),s.ɵɵproperty("ngModel",r.notes),s.ɵɵadvance(2),s.ɵɵproperty("ngIf",!r.notes)}}var O=function(e){return{active:e}},I=function(e,t){return{active:e,error:t}},w=function(e,t){return{active:e,disabled:t}},M=function(){function e(e,t,n,r,i){this.modalService=e,this.bsModalRef=t,this.registryService=n,this.localizeService=r,this.isValid=!1,this.tabIndex=0,this.isNewGeoObject=!1,this.submitFunction=null,this.arePropertiesValid=!1,this.areParentsValid=!0,this.dateStr=null,this.forDate=null,this.isEditingGeometries=!1,this.isAdmin=i.isAdmin(),this.isMaintainer=this.isAdmin||i.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||i.isContributer(),this.forDate=new Date;var o=this.forDate.getUTCDate();this.dateStr=this.forDate.getUTCFullYear()+"-"+(this.forDate.getUTCMonth()+1)+"-"+(o<10?"0":"")+o}return e.prototype.ngOnInit=function(){},e.prototype.findVotWithStartDate=function(e,t){for(var n=0;n<e.length;++n)if(e[n].startDate===t)return e[n];return null},e.prototype.setMasterListId=function(e){this.masterListId=e},e.prototype.handleDateChange=function(){this.forDate=new Date(Date.parse(this.dateStr))},e.prototype.setOnSuccessCallback=function(e){this.onSuccessCallback=e},e.prototype.configureAsNew=function(e,t,n){var r=this;this.isNewGeoObject=!0,this.dateStr=t,this.forDate=new Date(Date.parse(this.dateStr)),this.isGeometryEditable=n,this.fetchGeoObjectType(e),this.fetchLocales(),this.registryService.newGeoObjectOverTime(e).then((function(e){r.goPropertiesPre=new a.GeoObjectOverTime(r.geoObjectType,e.geoObject.attributes),r.goPropertiesPost=new a.GeoObjectOverTime(r.geoObjectType,JSON.parse(JSON.stringify(r.goPropertiesPre)).attributes),r.hierarchies=e.hierarchies}))},e.prototype.configureFromImportError=function(e,t,n,r){var i=this,o=e.object.geoObject.attributes.type;this.isNewGeoObject=e.object.isNew,this.dateStr=n,this.forDate=new Date(Date.parse(n)),this.isGeometryEditable=r,this.fetchGeoObjectType(o),this.fetchLocales(),null!=e.object&&null!=e.object.parents&&e.object.parents.length>0?(this.hierarchies=e.object.parents,this.areParentsValid=!0):(this.registryService.newGeoObjectOverTime(o).then((function(e){i.hierarchies=e.hierarchies})),this.areParentsValid=!1),this.goPropertiesPre=new a.GeoObjectOverTime(this.geoObjectType,e.object.geoObject.attributes),this.goPropertiesPost=new a.GeoObjectOverTime(this.geoObjectType,e.object.geoObject.attributes),this.submitFunction=function(){var n={historyId:t,importErrorId:e.id,resolution:"APPLY_GEO_OBJECT",parentTreeNode:i.hierarchies,geoObject:i.goSubmit,isNew:e.object.isNew};i.registryService.submitErrorResolve(n).then((function(){null!=i.onSuccessCallback&&i.onSuccessCallback()})).catch((function(e){i.error(e)}))}},e.prototype.configureAsExisting=function(e,t,n,r){this.isNewGeoObject=!1,this.dateStr=n,this.forDate=new Date(Date.parse(this.dateStr)),this.isGeometryEditable=r,this.fetchGeoObject(e,t),this.fetchGeoObjectType(t),this.fetchHierarchies(e,t),this.fetchLocales()},e.prototype.fetchGeoObject=function(e,t){var n=this;this.registryService.getGeoObjectOverTime(e,t).then((function(e){n.goPropertiesPre=new a.GeoObjectOverTime(n.geoObjectType,JSON.parse(JSON.stringify(e)).attributes),n.goPropertiesPost=new a.GeoObjectOverTime(n.geoObjectType,JSON.parse(JSON.stringify(n.goPropertiesPre)).attributes),n.goSubmit=n.goPropertiesPost,n.arePropertiesValid=!0,n.isValid=!0})).catch((function(e){n.error(e)}))},e.prototype.fetchLocales=function(){var e=this;this.registryService.getLocales().then((function(t){e.localizeService.setLocales(t)})).catch((function(t){e.error(t)}))},e.prototype.fetchGeoObjectType=function(e){var t=this;this.registryService.getGeoObjectTypes([e],null).then((function(e){t.geoObjectType=e[0],null!=t.goPropertiesPre&&(t.goPropertiesPre.geoObjectType=t.geoObjectType),null!=t.goPropertiesPost&&(t.goPropertiesPost.geoObjectType=t.geoObjectType),t.geoObjectType.isGeometryEditable})).catch((function(e){console.log(e)}))},e.prototype.fetchHierarchies=function(e,t){var n=this;this.registryService.getHierarchiesForGeoObject(e,t).then((function(e){n.hierarchies=e,n.areParentsValid=!0})).catch((function(e){n.error(e)}))},e.prototype.getTypeAheadObservable=function(e,t){var n=this;return l.Observable.create((function(r){n.registryService.getGeoObjectSuggestionsTypeAhead(e,t).then((function(e){r.next(e)}))}))},e.prototype.typeaheadOnSelect=function(e,t){var n=this;this.registryService.getGeoObjectByCode(e.item.code,t.geoObject.properties.type).then((function(e){t.geoObject=e})).catch((function(e){n.error(e)}))},e.prototype.onValidChange=function(){null!=this.attributeEditor&&(this.arePropertiesValid=this.attributeEditor.getIsValid()),null!=this.parentSelector&&(this.areParentsValid=this.parentSelector.getIsValid()),this.isValid=this.arePropertiesValid&&this.areParentsValid},e.prototype.changePage=function(e,t){void 0===t&&(t=!1),(e!==this.tabIndex||t)&&(this.persistModelChanges(),this.tabIndex=e,this.onValidChange(),this.isEditingGeometries=2===e)},e.prototype.persistModelChanges=function(){null!=this.attributeEditor&&(this.goPropertiesPost=this.attributeEditor.getGeoObject()),null!=this.parentSelector&&(this.hierarchies=this.parentSelector.getHierarchies()),this.goSubmit=this.goPropertiesPost},e.prototype.error=function(e){this.bsModalRef=o.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.prototype.cancel=function(){this.bsModalRef.hide()},e.prototype.submit=function(){this.isValid&&(this.bsModalRef.hide(),this.persistModelChanges(),null==this.submitFunction||this.submitFunction())},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalService),s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(d.RegistryService),s.ɵɵdirectiveInject(p.LocalizationService),s.ɵɵdirectiveInject(p.AuthService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["geoobject-editor"]],viewQuery:function(e,t){if(1&e&&(s.ɵɵviewQuery(y,1),s.ɵɵviewQuery(v,1)),2&e){var n=void 0;s.ɵɵqueryRefresh(n=s.ɵɵloadQuery())&&(t.attributeEditor=n.first),s.ɵɵqueryRefresh(n=s.ɵɵloadQuery())&&(t.parentSelector=n.first)}},inputs:{geoObjectType:"geoObjectType",onSuccessCallback:"onSuccessCallback"},features:[s.ɵɵProvidersFeature([i.DatePipe])],decls:31,vars:18,consts:[[1,"modal-body"],[1,"modal-form",2,"overflow","visible"],["goForm","ngForm"],[1,"row"],[1,"col-md-12"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"btn-group","geobject-editor-tab-holder"],[1,"btn","full-width-radio-button",3,"ngClass","click"],["key","geoobject.editor.tabZero"],["key","geoobject.editor.tabOne"],["key","geoobject.editor.tabTwo"],[3,"geoObjectType","preGeoObject","postGeoObject","forDate","isNew","isEditingGeometries","valid",4,"ngIf"],[4,"ngIf"],["class","row-holder","style","padding-top: 10px;",4,"ngIf"],[1,"row-holder",2,"margin-bottom","20px"],[1,"label-holder"],["key","changeOverTime.forDate"],[1,"holder"],["type","date","name","dateStr",2,"width","100%",3,"ngModel","ngModelChange","change"],[1,"button-holder","text-left"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[3,"key"],["role","alert",1,"alert","alert-danger"],["key","geoobject.editor.modal.parents.must.be.assigned.message"],[3,"geoObjectType","preGeoObject","postGeoObject","forDate","isNew","isEditingGeometries","valid"],["attributeEditor",""],[3,"isValid","forDate","hierarchies","valid"],["parentSelector",""],[1,"row-holder",2,"padding-top","10px"],["key","change.request.action.detail.contributorNotes"],[1,"holder","text-left"],["name","notes","required","",1,"detail-value",2,"width","100%","border-radius","8px","height","70px","padding","5px",3,"ngModel","ngModelChange"],[1,"form-input-validation-error-message-wrapper"],["class","error-message",4,"ngIf"],[1,"error-message"]],template:function(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",0),s.ɵɵelementStart(1,"form",1,2),s.ɵɵelementStart(3,"div",3),s.ɵɵelementStart(4,"div",4),s.ɵɵtemplate(5,b,2,0,"div",5),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(6,"div",3),s.ɵɵelementStart(7,"div",4),s.ɵɵelementStart(8,"div",6),s.ɵɵelementStart(9,"label",7),s.ɵɵlistener("click",(function(){return t.changePage(0)})),s.ɵɵelement(10,"localize",8),s.ɵɵelementEnd(),s.ɵɵelementStart(11,"label",7),s.ɵɵlistener("click",(function(){return t.changePage(1)})),s.ɵɵelement(12,"localize",9),s.ɵɵelementEnd(),s.ɵɵelementStart(13,"label",7),s.ɵɵlistener("click",(function(){return t.isGeometryEditable&&t.changePage(2)})),s.ɵɵelement(14,"localize",10),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵtemplate(15,S,2,6,"geoobject-shared-attribute-editor",11),s.ɵɵtemplate(16,C,3,3,"div",12),s.ɵɵtemplate(17,x,8,2,"div",13),s.ɵɵelementStart(18,"div",14),s.ɵɵelementStart(19,"div",15),s.ɵɵelementStart(20,"label"),s.ɵɵelement(21,"localize",16),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(22,"div",17),s.ɵɵelementStart(23,"input",18),s.ɵɵlistener("ngModelChange",(function(e){return t.dateStr=e}))("change",(function(){return t.handleDateChange()})),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(24,"div",3),s.ɵɵelementStart(25,"div",4),s.ɵɵelementStart(26,"div",19),s.ɵɵelementStart(27,"button",20),s.ɵɵlistener("click",(function(){return t.cancel()})),s.ɵɵelement(28,"localize",21),s.ɵɵelementEnd(),s.ɵɵelementStart(29,"button",22),s.ɵɵlistener("click",(function(){return t.submit()})),s.ɵɵelement(30,"localize",23),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e){var n=s.ɵɵreference(2);s.ɵɵadvance(5),s.ɵɵproperty("ngIf",!t.areParentsValid),s.ɵɵadvance(4),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(10,O,0===t.tabIndex)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction2(12,I,1===t.tabIndex,!t.areParentsValid)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction2(15,w,2===t.tabIndex,!t.isGeometryEditable)),s.ɵɵadvance(2),s.ɵɵproperty("ngIf",(0===t.tabIndex||2===t.tabIndex)&&t.geoObjectType&&t.goPropertiesPre&&t.goPropertiesPost),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",1===t.tabIndex&&null!=t.hierarchies),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",!t.isMaintainer),s.ɵɵadvance(6),s.ɵɵproperty("ngModel",t.dateStr),s.ɵɵadvance(6),s.ɵɵproperty("disabled",n.invalid||!t.isValid),s.ɵɵadvance(1),s.ɵɵproperty("key",t.isMaintainer?"modal.button.submit":"change.request.page.title")}},directives:[m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,u.NgIf,u.NgClass,g.LocalizeComponent,m.DefaultValueAccessor,m.NgControlStatus,m.NgModel,h.GeoObjectSharedAttributeEditorComponent,f.CascadingGeoSelector,m.RequiredValidator],styles:['.modal-content[_ngcontent-%COMP%] {\n    overflow-y: visible !important;\n}\n\n.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type="text"][_ngcontent-%COMP%]:disabled {\n    background: #eee;\n}\n\nli.list-group-item[_ngcontent-%COMP%] {\n    font-size: 18px;\n}\n\n.warning-text[_ngcontent-%COMP%]{\n    color: orange;\n}']}),e}();t.GeoObjectEditorComponent=M,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(M,[{type:r.Component,args:[{selector:"geoobject-editor",templateUrl:"./geoobject-editor.component.html",styleUrls:["./geoobject-editor.component.css"],providers:[i.DatePipe]}]}],(function(){return[{type:c.BsModalService},{type:c.BsModalRef},{type:d.RegistryService},{type:p.LocalizationService},{type:p.AuthService}]}),{geoObjectType:[{type:r.Input}],onSuccessCallback:[{type:r.Input}],attributeEditor:[{type:r.ViewChild,args:["attributeEditor"]}],parentSelector:[{type:r.ViewChild,args:["parentSelector"]}]})},555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StepIndicatorComponent=void 0;var r=n(0),i=(n(16),n(203),n(0)),o=n(16),a=n(1),l=function(e,t,n){return{complete:e,stuck:t,working:n}};function s(e,t){if(1&e&&(i.ɵɵelementStart(0,"li",4),i.ɵɵtext(1),i.ɵɵelementEnd()),2&e){var n=t.$implicit;i.ɵɵproperty("ngClass",i.ɵɵpureFunction3(2,l,"COMPLETE"===n.status,"STUCK"===n.status,"WORKING"===n.status)),i.ɵɵadvance(1),i.ɵɵtextInterpolate1(" ",n.label," ")}}function c(e,t){if(1&e&&(i.ɵɵelementStart(0,"ul",2),i.ɵɵtemplate(1,s,2,6,"li",3),i.ɵɵelementEnd()),2&e){var n=i.ɵɵnextContext();i.ɵɵadvance(1),i.ɵɵproperty("ngForOf",n._stepConfig.steps)}}var d=function(){function e(e){this.localizeService=e,this._stepConfig={steps:[]}}return Object.defineProperty(e.prototype,"steps",{set:function(e){this._stepConfig=e},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){},e.ɵfac=function(t){return new(t||e)(i.ɵɵdirectiveInject(o.LocalizationService))},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["step-indicator"]],inputs:{steps:"steps"},decls:2,vars:1,consts:[[1,"step-indicator"],["class","nav nav-justified",4,"ngIf"],[1,"nav","nav-justified"],["class","nav-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"nav-item",3,"ngClass"]],template:function(e,t){1&e&&(i.ɵɵelementStart(0,"div",0),i.ɵɵtemplate(1,c,2,1,"ul",1),i.ɵɵelementEnd()),2&e&&(i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t._stepConfig&&t._stepConfig.steps&&t._stepConfig.steps.length>0))},directives:[a.NgIf,a.NgForOf,a.NgClass],styles:[".step-indicator[_ngcontent-%COMP%] {\n    margin-top: 5px;\n}\n\n.step-indicator[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%] {\n    \n    background-color: white;\n    text-align: center;\n    vertical-align: middle;\n    \n    \n    \n    border-collapse: separate; \n    border-spacing: 0;\n    color: black;\n}\n.step-indicator[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(:first-child):not(:last-child) {\n    border-left: solid 2px white;\n}\n.step-indicator[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]:first-child {\n    -moz-border-radius-topleft: 10px;\n    -moz-border-radius-bottomleft: 10px;\n\n    -webkit-border-top-left-radius: 10px;\n    -webkit-border-bottom-left-radius: 10px;\n    border-top-left-radius: 10px;\n    border-bottom-left-radius: 10px;\n}\n.step-indicator[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]:last-child {\n    -moz-border-radius-topright: 10px;\n    -moz-border-radius-bottomright: 10px;\n\n    -webkit-border-top-right-radius: 10px;\n    -webkit-border-bottom-right-radius: 10px;\n    border-top-right-radius: 10px;\n    border-bottom-right-radius: 10px;\n}\n.step-indicator[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%] {\n    font-weight: bold;\n}\n.step-indicator[_ngcontent-%COMP%]   .nav-item.complete[_ngcontent-%COMP%]{\n    background-color: #B7A2D5;\n}\n.step-indicator[_ngcontent-%COMP%]   .nav-item.stuck[_ngcontent-%COMP%]{\n    background-color: #f05d5d;\n}\n.step-indicator[_ngcontent-%COMP%]   .nav-item.working[_ngcontent-%COMP%]{\n    background-color: #ffbc58;\n}"]}),e}();t.StepIndicatorComponent=d,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(d,[{type:r.Component,args:[{selector:"step-indicator",templateUrl:"./step-indicator.component.html",styleUrls:["./step-indicator.css"]}]}],(function(){return[{type:o.LocalizationService}]}),{steps:[{type:r.Input,args:["steps"]}]})},556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerPanelComponent=void 0;var r=n(0),i=(n(30),n(609)),o=(n(518),n(0)),a=n(30),l=n(518),s=n(1),c=n(68);function d(e,t){1&e&&o.ɵɵelement(0,"i",9)}function p(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",10),o.ɵɵelementStart(1,"input",11),o.ɵɵlistener("change",(function(){o.ɵɵrestoreView(n);var e=t.$implicit;return o.ɵɵnextContext().toggleBaseLayer(e)})),o.ɵɵelementEnd(),o.ɵɵelementStart(2,"label",12),o.ɵɵelement(3,"localize",13),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("value",r.id)("checked",r.selected),o.ɵɵadvance(2),o.ɵɵproperty("key",r.label)}}function m(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",18),o.ɵɵelementStart(1,"input",19),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(4).toggleContextLayer(e)})),o.ɵɵelementEnd(),o.ɵɵtext(2),o.ɵɵelementStart(3,"i",20),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext(4).removeContextLayer(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext().$implicit;o.ɵɵadvance(1),o.ɵɵproperty("checked",r.active),o.ɵɵadvance(1),o.ɵɵtextInterpolate1(" ",r.displayLabel," ")}}function u(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵtemplate(1,m,4,2,"div",17),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("ngIf",n.enabled)}}function g(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",18),o.ɵɵelementStart(1,"label"),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"div",15),o.ɵɵtemplate(4,u,2,1,"div",16),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext().$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.displayLabel),o.ɵɵadvance(2),o.ɵɵproperty("ngForOf",n.contextLayers)}}function h(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵtemplate(1,g,5,2,"div",17),o.ɵɵelementEnd()),2&e){var n=t.$implicit,r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("ngIf",r.groupHasEnabledContextLayers(n.oid))}}function f(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"h4"),o.ɵɵelement(2,"localize",14),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"div",15),o.ɵɵtemplate(4,h,2,1,"div",16),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(4),o.ɵɵproperty("ngForOf",n.contextLayerGroups)}}var y=function(){function e(e,t){this.modalService=e,this.service=t,this.filter=[],this.layerChange=new r.EventEmitter,this.baseLayerChange=new r.EventEmitter,this.baselayerIconHover=!1,this.lists=[],this.baseLayers=[{name:"Satellite",label:"baselayer.satellite",id:"satellite-v9",sprite:"mapbox://sprites/mapbox/satellite-v9",url:"mapbox://mapbox.satellite",selected:!0}],this.contextLayerGroups=[]}return e.prototype.ngOnInit=function(){var e=this;this.service.getAllMasterListVersions().then((function(t){e.lists=t,e.updateContextGroups()}))},e.prototype.ngOnChanges=function(e){e.filter.currentValue!==e.filter.previousValue&&this.updateContextGroups()},e.prototype.updateContextGroups=function(){var e=this;this.lists.forEach((function(t){var n={oid:t.oid,displayLabel:t.displayLabel.localizedValue,contextLayers:[]};t.versions.forEach((function(t){if(-1===e.filter.indexOf(t.oid)){var r={oid:t.oid,displayLabel:t.forDate,active:!1,enabled:!1};n.contextLayers.push(r)}})),n.contextLayers.length>0&&e.contextLayerGroups.push(n)}))},e.prototype.groupHasEnabledContextLayers=function(e){var t=!1;return this.contextLayerGroups.forEach((function(n){n.oid===e&&n.contextLayers.forEach((function(e){e.enabled&&(t=!0)}))})),t},e.prototype.hasEnabledContextLayers=function(){var e=!1;return this.contextLayerGroups.forEach((function(t){t.contextLayers.forEach((function(t){t.enabled&&(e=!0)}))})),e},e.prototype.toggleContextLayer=function(e){e.active=!e.active,this.layerChange.emit(e)},e.prototype.removeContextLayer=function(e){e.active=!1,e.enabled=!1,this.layerChange.emit(e)},e.prototype.addContextLayerModal=function(){this.modalService.show(i.ContextLayerModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"context-layer-modal"}).content.contextLayerGroups=this.contextLayerGroups},e.prototype.toggleBaseLayer=function(e){this.baseLayers.forEach((function(e){e.active=!1})),e.active=!0,this.baseLayerChange.emit(e)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.BsModalService),o.ɵɵdirectiveInject(l.RegistryService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["layer-panel"]],inputs:{filter:"filter"},outputs:{layerChange:"layerChange",baseLayerChange:"baseLayerChange"},features:[o.ɵɵNgOnChangesFeature],decls:12,vars:4,consts:[[1,"layer-toggle",3,"mouseenter","mouseleave"],["class","fa fa-bars","style","vertical-align: middle; font-size: 18px; color: black;",4,"ngIf"],[3,"hidden"],[2,"margin-bottom","10px"],["key","explorer.base.layers.label"],["class","row-form",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],["key","explorer.add.context.layer.button.label"],[1,"fa","fa-bars",2,"vertical-align","middle","font-size","18px","color","black"],[1,"row-form"],["type","radio","name","baselayers",1,"layer-toggle-input",3,"value","checked","change"],[1,"layer-toggle-label"],[3,"key"],["key","explorer.context.layers.label"],[1,"list-group"],[4,"ngFor","ngForOf"],["class","list-group-item","style","border: none;",4,"ngIf"],[1,"list-group-item",2,"border","none"],["type","checkbox",3,"checked","click"],["aria-hidden","true",1,"fa","fa-times","delete-btn","clickable",3,"click"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵlistener("mouseenter",(function(){return t.baselayerIconHover=!0}))("mouseleave",(function(){return t.baselayerIconHover=!1})),o.ɵɵtemplate(1,d,1,0,"i",1),o.ɵɵelementStart(2,"div",2),o.ɵɵelementStart(3,"div",3),o.ɵɵelementStart(4,"h4"),o.ɵɵelement(5,"localize",4),o.ɵɵelementEnd(),o.ɵɵtemplate(6,p,4,3,"div",5),o.ɵɵelementEnd(),o.ɵɵelementStart(7,"div"),o.ɵɵtemplate(8,f,5,1,"div",6),o.ɵɵelementStart(9,"button",7),o.ɵɵlistener("click",(function(){return t.addContextLayerModal()})),o.ɵɵtext(10,"+ "),o.ɵɵelement(11,"localize",8),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!t.baselayerIconHover),o.ɵɵadvance(1),o.ɵɵproperty("hidden",!t.baselayerIconHover),o.ɵɵadvance(4),o.ɵɵproperty("ngForOf",t.baseLayers),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",t.hasEnabledContextLayers()))},directives:[s.NgIf,c.LocalizeComponent,s.NgForOf],styles:["#hierarchy-tree-container[_ngcontent-%COMP%] {\n\theight: 100%;\n    overflow-y: auto;\n}\n\n.location-management-widget-section[_ngcontent-%COMP%] {\n\tmargin: 5px 0;\n}\n.location-management-widget-section[_ngcontent-%COMP%]    > select[_ngcontent-%COMP%] {\n\tfloat: none !important;\n}\n\n.list-group-item[_ngcontent-%COMP%] {\n\tborder: none;\n\tborder-bottom: 1px solid #ddd;\n\tmargin-bottom: 0;\n}\n.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n\n.breadcrumb[_ngcontent-%COMP%]{\n\tpadding: 10px 0;\n\tbackground-color: white;\n\tmargin:0;\n}\n\n.layer-toggle[_ngcontent-%COMP%] {\n\tcursor: pointer; \n\tbackground: #fff; \n\tpadding: 8px; \n\tborder-radius: 4px;\n\twidth: fit-content;\n}\n\n.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n\tmargin-left: 5px;\n}\n\n.arrow[_ngcontent-%COMP%] {\n  border: solid black;\n  border-width: 0 1px 1px 0;\n  display: inline-block;\n  padding: 5px;\n}\n.arrow-right[_ngcontent-%COMP%] {\n  transform: rotate(-45deg);\n  -webkit-transform: rotate(-45deg);\n}\n.arrow-down[_ngcontent-%COMP%] {\n  transform: rotate(45deg);\n  -webkit-transform: rotate(45deg);\n}\n\n.fa.fa-arrow-left[_ngcontent-%COMP%]::before {\n\tmargin-right:5px;\n}"]}),e}();t.LayerPanelComponent=y,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(y,[{type:r.Component,args:[{selector:"layer-panel",templateUrl:"./layer-panel.component.html",styleUrls:["./location-manager.css"]}]}],(function(){return[{type:a.BsModalService},{type:l.RegistryService}]}),{filter:[{type:r.Input}],layerChange:[{type:r.Output}],baseLayerChange:[{type:r.Output}]})},557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeaturePanelComponent=void 0;var r=n(0),i=(n(30),n(203)),o=(n(518),n(16),n(111)),a=n(0),l=n(518),s=n(30),c=n(16),d=n(1),p=n(529),m=n(68),u=n(22),g=["attributeEditor"];function h(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"geoobject-shared-attribute-editor",7,8),a.ɵɵlistener("valid",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).setValid(e)})),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵproperty("geoObjectType",r.type)("postGeoObject",r.postGeoObject)("isNew",r.isNew)("isGeometryInlined",!1)("hierarchies",r.hierarchies)("readOnly",!r.isEdit)}}function f(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",9),a.ɵɵelementStart(1,"label"),a.ɵɵelement(2,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementStart(3,"textarea",11),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).reason=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵadvance(3),a.ɵɵproperty("ngModel",r.reason)}}function y(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",12),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).onEditAttributes()})),a.ɵɵelement(1,"localize",13),a.ɵɵelementEnd()}}function v(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",14),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).onCancelInternal()})),a.ɵɵelement(1,"localize",15),a.ɵɵelementEnd()}}function b(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",16),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).onSubmit()})),a.ɵɵelement(1,"localize",17),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵproperty("disabled",!r.canSubmit()),a.ɵɵadvance(1),a.ɵɵproperty("key",r.isMaintainer?"modal.button.submit":"change.request.page.title")}}function S(e,t){if(1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵtemplate(1,h,2,6,"geoobject-shared-attribute-editor",1),a.ɵɵtemplate(2,f,4,1,"div",2),a.ɵɵelementStart(3,"div",3),a.ɵɵtemplate(4,y,2,0,"button",4),a.ɵɵtemplate(5,v,2,0,"button",5),a.ɵɵtemplate(6,b,2,2,"button",6),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.hierarchies),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.isEdit&&!n.isMaintainer),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",!n.readOnly&&!n.isEdit),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.isEdit),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.isEdit)}}var C=function(){function e(e,t,n,i){this.service=e,this.modalService=t,this.authService=n,this.geometryService=i,this.MODE={VERSIONS:"VERSIONS",ATTRIBUTES:"ATTRIBUTES",HIERARCHY:"HIERARCHY",GEOMETRY:"GEOMETRY"},this.forDate=new Date,this.readOnly=!1,this._code=null,this.featureChange=new r.EventEmitter,this.modeChange=new r.EventEmitter,this.panelCancel=new r.EventEmitter,this.panelSubmit=new r.EventEmitter,this._isValid=!0,this.mode=null,this.attribute=null,this.isNew=!1,this.isEdit=!1,this.hierarchy=null,this.reason=""}return Object.defineProperty(e.prototype,"code",{set:function(e){this.updateCode(e)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.isMaintainer=this.authService.isSRA()||this.authService.isOrganizationRA(this.type.organizationCode)||this.authService.isGeoObjectTypeOrSuperRM(this.type),this.mode="ATTRIBUTES"},e.prototype.setValid=function(e){this._isValid=e},e.prototype.isValid=function(){return this._isValid&&this.attributeEditor&&this.attributeEditor.isValid()},e.prototype.updateCode=function(e){var t=this;this._code=e,this.postGeoObject=null,this.preGeoObject=null,this.hierarchies=null,null!=e&&null!=this.type&&("__NEW__"!==e?(this.isNew=!1,this.service.getGeoObjectOverTime(e,this.type.code).then((function(e){t.preGeoObject=new i.GeoObjectOverTime(t.type,JSON.parse(JSON.stringify(e)).attributes),t.postGeoObject=new i.GeoObjectOverTime(t.type,JSON.parse(JSON.stringify(t.preGeoObject)).attributes)})).catch((function(e){t.error(e)})),this.service.getHierarchiesForGeoObject(e,this.type.code).then((function(e){t.hierarchies=e})).catch((function(e){t.error(e)}))):(this.isNew=!0,this.service.newGeoObjectOverTime(this.type.code).then((function(e){t.preGeoObject=new i.GeoObjectOverTime(t.type,e.geoObject.attributes),t.postGeoObject=new i.GeoObjectOverTime(t.type,JSON.parse(JSON.stringify(t.preGeoObject)).attributes),t.hierarchies=e.hierarchies,t.setEditMode(!0)}))))},e.prototype.onCancelInternal=function(){this.panelCancel.emit()},e.prototype.canSubmit=function(){return this.isValid()&&(this.isMaintainer||this.reason&&this.reason.trim().length>0)&&(this.isNew||this.attributeEditor&&this.attributeEditor.getChangeRequestEditor().hasChanges())},e.prototype.onSubmit=function(){var e=this;this.isNew?this.service.applyGeoObjectCreate(this.hierarchies,this.postGeoObject,this.isNew,this.datasetId,this.reason).then((function(t){t.isChangeRequest||(e.featureChange.emit(e.postGeoObject),e.updateCode(e._code)),e.panelSubmit.emit(t)})).catch((function(t){e.error(t)})):this.service.applyGeoObjectEdit(this.postGeoObject.attributes.code,this.type.code,this.attributeEditor.getActions(),this.datasetId,this.reason).then((function(t){t.isChangeRequest||(e.featureChange.emit(e.postGeoObject),e.updateCode(e._code)),e.panelSubmit.emit(t)})).catch((function(t){e.error(t)})),this.geometryService.stopEditing()},e.prototype.onManageAttributeVersion=function(e){this.attribute=e,this.mode=this.MODE.VERSIONS},e.prototype.onManageHiearchyVersion=function(e){this.hierarchy=e,this.mode=this.MODE.HIERARCHY},e.prototype.onEditAttributes=function(){this.setEditMode(!this.isEdit)},e.prototype.setEditMode=function(e){this.isEdit=e,this.reason=null,this.modeChange.emit(this.isEdit)},e.prototype.error=function(e){this.bsModalRef=o.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(s.BsModalService),a.ɵɵdirectiveInject(c.AuthService),a.ɵɵdirectiveInject(l.GeometryService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["feature-panel"]],viewQuery:function(e,t){if(1&e&&a.ɵɵviewQuery(g,1),2&e){var n;a.ɵɵqueryRefresh(n=a.ɵɵloadQuery())&&(t.attributeEditor=n.first)}},inputs:{datasetId:"datasetId",type:"type",forDate:"forDate",readOnly:"readOnly",code:"code"},outputs:{featureChange:"featureChange",modeChange:"modeChange",panelCancel:"panelCancel",panelSubmit:"panelSubmit"},decls:2,vars:1,consts:[[4,"ngIf"],[3,"geoObjectType","postGeoObject","isNew","isGeometryInlined","hierarchies","readOnly","valid",4,"ngIf"],["class","form-group","style","z-index: 0;",4,"ngIf"],[1,"button-holder","text-right",2,"margin-bottom","20px"],["type","submit","class","btn btn-primary","style","width:100%;","role","button",3,"click",4,"ngIf"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],[3,"geoObjectType","postGeoObject","isNew","isGeometryInlined","hierarchies","readOnly","valid"],["attributeEditor",""],[1,"form-group",2,"z-index","0"],["key","change.request.reason.label"],["rows","4","cols","50","name","reason-input","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","role","button",1,"btn","btn-primary",2,"width","100%",3,"click"],["key","changeovertime.manageVersions.button.label"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],[3,"key"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵtemplate(1,S,7,5,"div",0),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.mode==t.MODE.ATTRIBUTES&&null!=t.postGeoObject))},directives:[d.NgIf,p.GeoObjectSharedAttributeEditorComponent,m.LocalizeComponent,u.DefaultValueAccessor,u.RequiredValidator,u.NgControlStatus,u.NgModel],styles:["#hierarchy-tree-container[_ngcontent-%COMP%] {\n\theight: calc(100vh - 429px);\n    overflow-y: auto;\n}\n\n.location-management-widget-section[_ngcontent-%COMP%] {\n\tmargin: 5px 0;\n}\n.location-management-widget-section[_ngcontent-%COMP%]    > select[_ngcontent-%COMP%] {\n\tfloat: none !important;\n}\n\n.list-group-item[_ngcontent-%COMP%] {\n\tborder: none;\n\tborder-bottom: 1px solid #ddd;\n\tmargin-bottom: 0;\n}\n.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n\n.breadcrumb[_ngcontent-%COMP%]{\n\tpadding: 10px 0;\n\tbackground-color: white;\n\tmargin:0;\n}\n\n.layer-toggle[_ngcontent-%COMP%] {\n\tcursor: pointer; \n\tbackground: #fff; \n\tpadding: 8px; \n\tborder-radius: 4px;\n\twidth: fit-content;\n}\n\n.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n\tmargin-left: 5px;\n}\n\n#attributes-header[_ngcontent-%COMP%] {\n\tbackground: #adadad;\n  padding: 2px 15px;\n  margin: 10px 0;\n  color: white;\n  border-radius: 3px;\n}"]}),e}();t.FeaturePanelComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"feature-panel",templateUrl:"./feature-panel.component.html",styleUrls:["./dataset-location-manager.css"]}]}],(function(){return[{type:l.RegistryService},{type:s.BsModalService},{type:c.AuthService},{type:l.GeometryService}]}),{datasetId:[{type:r.Input}],type:[{type:r.Input}],forDate:[{type:r.Input}],readOnly:[{type:r.Input}],code:[{type:r.Input}],attributeEditor:[{type:r.ViewChild,args:["attributeEditor"]}],featureChange:[{type:r.Output}],modeChange:[{type:r.Output}],panelCancel:[{type:r.Output}],panelSubmit:[{type:r.Output}]})},565:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateHierarchyTypeModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(111),a=(n(518),n(16),n(0)),l=n(16),s=n(518),c=n(30),d=n(22),p=n(1),m=n(68),u=n(525),g=n(259);function h(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",39),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",6),a.ɵɵelementStart(1,"label",40),a.ɵɵelement(2,"localize",41),a.ɵɵelementStart(3,"span",42),a.ɵɵtext(4," ("),a.ɵɵelement(5,"convert-key-label",43),a.ɵɵtext(6,")"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"input",44),a.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit,r=a.ɵɵnextContext();a.ɵɵadvance(5),a.ɵɵproperty("key",n.locale),a.ɵɵadvance(2),a.ɵɵproperty("disabled",r.readOnly)("ngModel",n.value)("name","label-"+n.locale)}}function y(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",47),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label.localizedValue)}}function v(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"select",45),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().hierarchyType.organizationCode=e})),a.ɵɵelement(1,"option"),a.ɵɵtemplate(2,y,2,2,"option",46),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵproperty("disabled",r.edit||r.readOnly)("ngModel",r.hierarchyType.organizationCode),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",r.organizations)}}function b(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"span",48),a.ɵɵelementStart(1,"input",49),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().organizationLabel=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngModel",r.organizationLabel)}}function S(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"span",48),a.ɵɵelementStart(1,"input",49),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().organizationLabel=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngModel",r.organizationLabel)}}function C(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",50),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().handleOnSubmit()})),a.ɵɵelement(1,"localize",51),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(),i=a.ɵɵreference(3);a.ɵɵproperty("disabled",r.hierarchyType.code.length<1||i.invalid)}}var E=function(){function e(e,t,n,r,i){this.lService=e,this.auth=t,this.registryService=n,this.hierarchyService=r,this.bsModalRef=i,this.organizations=[],this.message=null,this.edit=!1,this.readOnly=!1}return e.prototype.ngOnInit=function(){var e=this;this.onHierarchytTypeCreate=new i.Subject,this.hierarchyType={code:"",label:this.lService.create(),description:this.lService.create(),rootGeoObjectTypes:[],organizationCode:""},this.registryService.getOrganizations().then((function(t){if(e.readOnly)e.organizations=t;else{e.organizations=[];for(var n=0;n<t.length;++n)e.auth.isOrganizationRA(t[n].code)&&e.organizations.push(t[n])}e.edit||1!==e.organizations.length?(e.edit||e.readOnly)&&(e.organizationLabel=e.getOrganizationLabelFromCode(e.hierarchyType.organizationCode)):(e.hierarchyType.organizationCode=e.organizations[0].code,e.organizationLabel=e.organizations[0].label.localizedValue)})).catch((function(t){e.error(t)}))},e.prototype.getOrganizationLabelFromCode=function(e){for(var t=0;t<this.organizations.length;++t)if(this.organizations[t].code===e)return this.organizations[t].label.localizedValue;return console.log("Did not find org with code ["+e+"]"),e},e.prototype.handleOnSubmit=function(){var e=this;this.message=null,this.readOnly?this.bsModalRef.hide():this.edit?this.hierarchyService.updateHierarchyType(JSON.stringify(this.hierarchyType)).then((function(t){e.onHierarchytTypeCreate.next(t),e.bsModalRef.hide()})).catch((function(t){e.error(t)})):this.hierarchyService.createHierarchyType(JSON.stringify(this.hierarchyType)).then((function(t){e.onHierarchytTypeCreate.next(t),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.LocalizationService),a.ɵɵdirectiveInject(l.AuthService),a.ɵɵdirectiveInject(s.RegistryService),a.ɵɵdirectiveInject(s.HierarchyService),a.ɵɵdirectiveInject(c.BsModalRef))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["create-hierarchy-type-modal"]],decls:62,vars:27,consts:[[1,"modal-body"],[1,"modal-form"],["form","ngForm"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","hierarchy.management.create.hierarchy.title"],[1,"form-group"],["for","codeInput"],["key","data.property.label.code"],["name","code","type","input","id","codeInput","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["key","data.property.label.description",3,"value","inlinelayout","disabled","valueChange"],["for","organization"],["key","attribute.organization.label"],["class","select-area","name","organization","required","",3,"disabled","ngModel","ngModelChange",4,"ngIf"],["class","text",4,"ngIf"],["key","data.property.label.progress"],["name","progress",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.acknowledgement"],["name","acknowledgement",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.disclaimer"],["name","disclaimer","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.accessConstraints"],["name","accessConstraints","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.useConstraints"],["name","useConstraints","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.contact"],["key","data.property.label.contact"],["name","contact","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.phoneNumber"],["name","phoneNumber","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.email"],["name","email","type","email",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"row"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],["key","modal.button.cancel"],["type","submit","class","btn btn-primary","style","padding: 4px 18px;",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["for","labelInput"],["key","data.property.label.label"],[2,"color","#BABABA"],[3,"key"],["type","input","required","",1,"form-control",3,"disabled","ngModel","name","ngModelChange"],["name","organization","required","",1,"select-area",3,"disabled","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary",2,"padding","4px 18px",3,"disabled","click"],["key","modal.button.ok"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"form"),a.ɵɵelementStart(1,"div",0),a.ɵɵelementStart(2,"form",1,2),a.ɵɵtemplate(4,h,2,1,"div",3),a.ɵɵelementStart(5,"div",4),a.ɵɵelementStart(6,"h1"),a.ɵɵelement(7,"localize",5),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"div",6),a.ɵɵelementStart(9,"label",7),a.ɵɵelement(10,"localize",8),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"input",9),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.code=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(12,f,8,4,"div",10),a.ɵɵelementStart(13,"localized-text",11),a.ɵɵlistener("valueChange",(function(e){return t.hierarchyType.description=e})),a.ɵɵelementEnd(),a.ɵɵelementStart(14,"div",6),a.ɵɵelementStart(15,"label",12),a.ɵɵelement(16,"localize",13),a.ɵɵelementEnd(),a.ɵɵtemplate(17,v,3,3,"select",14),a.ɵɵtemplate(18,b,2,1,"span",15),a.ɵɵtemplate(19,S,2,1,"span",15),a.ɵɵelementEnd(),a.ɵɵelementStart(20,"div",6),a.ɵɵelementStart(21,"label"),a.ɵɵelement(22,"localize",16),a.ɵɵelementEnd(),a.ɵɵelementStart(23,"textarea",17),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.progress=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(24,"div",6),a.ɵɵelementStart(25,"label"),a.ɵɵelement(26,"localize",18),a.ɵɵelementEnd(),a.ɵɵelementStart(27,"textarea",19),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.acknowledgement=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(28,"div",6),a.ɵɵelementStart(29,"label"),a.ɵɵelement(30,"localize",20),a.ɵɵelementEnd(),a.ɵɵelementStart(31,"textarea",21),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.disclaimer=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(32,"div",6),a.ɵɵelementStart(33,"label"),a.ɵɵelement(34,"localize",22),a.ɵɵelementEnd(),a.ɵɵelementStart(35,"textarea",23),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.accessConstraints=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(36,"div",6),a.ɵɵelementStart(37,"label"),a.ɵɵelement(38,"localize",24),a.ɵɵelementEnd(),a.ɵɵelementStart(39,"textarea",25),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.useConstraints=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelement(40,"hr"),a.ɵɵelementStart(41,"div",6),a.ɵɵelementStart(42,"h4"),a.ɵɵelement(43,"localize",26),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(44,"div",6),a.ɵɵelementStart(45,"label"),a.ɵɵelement(46,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementStart(47,"input",28),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.contact=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(48,"div",6),a.ɵɵelementStart(49,"label"),a.ɵɵelement(50,"localize",29),a.ɵɵelementEnd(),a.ɵɵelementStart(51,"input",30),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.phoneNumber=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(52,"div",6),a.ɵɵelementStart(53,"label"),a.ɵɵelement(54,"localize",31),a.ɵɵelementEnd(),a.ɵɵelementStart(55,"input",32),a.ɵɵlistener("ngModelChange",(function(e){return t.hierarchyType.email=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(56,"div",33),a.ɵɵelementStart(57,"div",34),a.ɵɵelementStart(58,"div",35),a.ɵɵelementStart(59,"button",36),a.ɵɵlistener("click",(function(){return t.bsModalRef.hide()})),a.ɵɵelement(60,"localize",37),a.ɵɵelementEnd(),a.ɵɵtemplate(61,C,2,1,"button",38),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(4),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(7),a.ɵɵproperty("ngModel",t.hierarchyType.code)("disabled",t.edit||t.readOnly),a.ɵɵadvance(1),a.ɵɵproperty("ngForOf",t.hierarchyType.label.localeValues),a.ɵɵadvance(1),a.ɵɵproperty("value",t.hierarchyType.description)("inlinelayout",!0)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngIf",!t.edit&&t.organizations.length>1),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.edit&&1==t.organizations.length),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.edit),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.progress)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.acknowledgement)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.disclaimer)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.accessConstraints)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.useConstraints)("disabled",t.readOnly),a.ɵɵadvance(8),a.ɵɵproperty("ngModel",t.hierarchyType.contact)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.phoneNumber)("disabled",t.readOnly),a.ɵɵadvance(4),a.ɵɵproperty("ngModel",t.hierarchyType.email)("disabled",t.readOnly),a.ɵɵadvance(6),a.ɵɵproperty("ngIf",!t.readOnly))},directives:[d.ɵangular_packages_forms_forms_ba,d.NgControlStatusGroup,d.NgForm,p.NgIf,m.LocalizeComponent,d.DefaultValueAccessor,d.RequiredValidator,d.NgControlStatus,d.NgModel,p.NgForOf,u.LocalizedTextComponent,g.ConvertKeyLabel,d.SelectControlValueAccessor,d.NgSelectOption,d.ɵangular_packages_forms_forms_z],encapsulation:2}),e}();t.CreateHierarchyTypeModalComponent=E,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(E,[{type:r.Component,args:[{selector:"create-hierarchy-type-modal",templateUrl:"./create-hierarchy-type-modal.component.html",styleUrls:[]}]}],(function(){return[{type:l.LocalizationService},{type:l.AuthService},{type:s.RegistryService},{type:s.HierarchyService},{type:c.BsModalRef}]}),null)},566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateGeoObjTypeModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(111),a=(n(518),n(16),n(0)),l=n(16),s=n(518),c=n(30),d=n(22),p=n(1),m=n(68),u=n(525),g=n(262),h=n(259);function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",42),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function y(e,t){1&e&&a.ɵɵelement(0,"localize",43)}function v(e,t){1&e&&a.ɵɵelement(0,"localize",44)}function b(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",9),a.ɵɵelementStart(1,"label"),a.ɵɵelement(2,"localize",45),a.ɵɵelementStart(3,"span",46),a.ɵɵtext(4," ("),a.ɵɵelement(5,"convert-key-label",47),a.ɵɵtext(6,")"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"input",48),a.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵadvance(5),a.ɵɵproperty("key",n.locale),a.ɵɵadvance(2),a.ɵɵproperty("ngModel",n.value)("name","label-"+n.locale)("required","defaultLocale"===n.locale)}}function S(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",16),a.ɵɵelementStart(2,"div",9),a.ɵɵelementStart(3,"label",17),a.ɵɵelement(4,"localize",49),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",19),a.ɵɵelementStart(6,"boolean-field",20),a.ɵɵlistener("valueChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().geoObjectType.isAbstract=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(6),a.ɵɵproperty("disable",!0)("value",r.geoObjectType.isAbstract)("localizeLabelKey","attribute.isAbstract.label")}}var C=function(e){return{"chk-checked":e}},E=function(){function e(e,t,n,r){this.lService=e,this.auth=t,this.registryService=n,this.bsModalRef=r,this.organization=null,this.message=null}return e.prototype.ngOnInit=function(){this.onGeoObjTypeCreate=new i.Subject,this.geoObjectType={code:"",label:this.lService.create(),description:this.lService.create(),geometryType:"MULTIPOINT",isLeaf:!1,isGeometryEditable:!0,organizationCode:"",attributes:[]}},e.prototype.init=function(e,t,n,r){this.geoObjectType.isAbstract=r||!1,n&&(this.geoObjectType.superTypeCode=n.code,this.geoObjectType.geometryType=n.geometryType,this.geoObjectType.isPrivate=n.isPrivate),this.parents=t.filter((function(e){return e.isAbstract})),this.organization=e,this.geoObjectType.organizationCode=this.organization.code,this.organizationLabel=this.organization.label.localizedValue},e.prototype.handleOnSubmit=function(){var e=this;this.message=null,this.registryService.createGeoObjectType(JSON.stringify(this.geoObjectType)).then((function(t){e.onGeoObjTypeCreate.next(t),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.toggleIsLeaf=function(){this.geoObjectType.isLeaf=!this.geoObjectType.isLeaf},e.prototype.toggleIsGeometryEditable=function(){this.geoObjectType.isGeometryEditable=!this.geoObjectType.isGeometryEditable},e.prototype.toggleIsAbstract=function(){this.geoObjectType.isAbstract=!this.geoObjectType.isAbstract},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.LocalizationService),a.ɵɵdirectiveInject(l.AuthService),a.ɵɵdirectiveInject(s.RegistryService),a.ɵɵdirectiveInject(c.BsModalRef))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["create-geoobjtype-modal"]],decls:64,vars:18,consts:[[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","hierarchy.management.create.geoobjecttype.group.title",4,"ngIf"],["key","hierarchy.management.create.geoobjecttype.title",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"form-group"],["for","codeInput"],["key","data.property.label.code"],["name","code","type","text","id","codeInput","required","",1,"form-control",3,"ngModel","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["key","data.property.label.description",3,"value","inlinelayout","valueChange"],["class","row",4,"ngIf"],[1,"col-md-12",2,"margin-bottom","15px"],[2,"display","block"],["key","geoObjectType.attr.visibility.label"],[1,"check-block"],[3,"disable","value","localizeLabelKey","valueChange"],["for","geometryType"],["key","data.property.label.geometryType"],["name","geometryType","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","MULTIPOINT"],["key","georegistry.geometry.point"],["value","MULTILINE"],["key","georegistry.geometry.line"],["value","MULTIPOLYGON"],["key","georegistry.geometry.polygon"],[1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],[1,"checkbox-label"],["key","hierarchy.management.option.label.isGeometryEditable"],["for","organization"],["key","attribute.organization.label"],[1,"text"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.ok"],["role","alert",1,"alert","alert-danger"],["key","hierarchy.management.create.geoobjecttype.group.title"],["key","hierarchy.management.create.geoobjecttype.title"],["key","data.property.label.label"],[2,"color","#BABABA"],[3,"key"],["type","input",1,"form-control",3,"ngModel","name","required","ngModelChange"],["key","attribute.group.label"]],template:function(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"form",0,1),a.ɵɵlistener("ngSubmit",(function(){return a.ɵɵrestoreView(n),a.ɵɵreference(1).valid&&t.handleOnSubmit()})),a.ɵɵelementStart(2,"div",2),a.ɵɵtemplate(3,f,2,1,"div",3),a.ɵɵelementStart(4,"div",4),a.ɵɵelementStart(5,"h1"),a.ɵɵtemplate(6,y,1,0,"localize",5),a.ɵɵtemplate(7,v,1,0,"localize",6),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"div",7),a.ɵɵelementStart(9,"div",8),a.ɵɵelementStart(10,"div",9),a.ɵɵelementStart(11,"div"),a.ɵɵelementStart(12,"label",10),a.ɵɵelement(13,"localize",11),a.ɵɵelementEnd(),a.ɵɵelementStart(14,"input",12),a.ɵɵlistener("ngModelChange",(function(e){return t.geoObjectType.code=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(15,"div",7),a.ɵɵelementStart(16,"div",8),a.ɵɵtemplate(17,b,8,4,"div",13),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(18,"div",7),a.ɵɵelementStart(19,"div",8),a.ɵɵelementStart(20,"localized-text",14),a.ɵɵlistener("valueChange",(function(e){return t.geoObjectType.description=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(21,S,7,3,"div",15),a.ɵɵelementStart(22,"div",7),a.ɵɵelementStart(23,"div",16),a.ɵɵelementStart(24,"div",9),a.ɵɵelementStart(25,"label",17),a.ɵɵelement(26,"localize",18),a.ɵɵelementEnd(),a.ɵɵelementStart(27,"div",19),a.ɵɵelementStart(28,"boolean-field",20),a.ɵɵlistener("valueChange",(function(e){return t.geoObjectType.isPrivate=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(29,"div",7),a.ɵɵelementStart(30,"div",8),a.ɵɵelementStart(31,"div",9),a.ɵɵelementStart(32,"label",21),a.ɵɵelement(33,"localize",22),a.ɵɵelementEnd(),a.ɵɵelementStart(34,"select",23),a.ɵɵlistener("ngModelChange",(function(e){return t.geoObjectType.geometryType=e})),a.ɵɵelement(35,"option"),a.ɵɵelementStart(36,"option",24),a.ɵɵelement(37,"localize",25),a.ɵɵelementEnd(),a.ɵɵelementStart(38,"option",26),a.ɵɵelement(39,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementStart(40,"option",28),a.ɵɵelement(41,"localize",29),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(42,"div",7),a.ɵɵelementStart(43,"div",16),a.ɵɵelementStart(44,"div",9),a.ɵɵelementStart(45,"div",19),a.ɵɵelementStart(46,"div",30),a.ɵɵlistener("click",(function(){return t.toggleIsGeometryEditable()})),a.ɵɵelement(47,"span"),a.ɵɵelementEnd(),a.ɵɵelementStart(48,"label",31),a.ɵɵelement(49,"localize",32),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(50,"div",7),a.ɵɵelementStart(51,"div",8),a.ɵɵelementStart(52,"div",9),a.ɵɵelementStart(53,"label",33),a.ɵɵelement(54,"localize",34),a.ɵɵelementEnd(),a.ɵɵelementStart(55,"span",35),a.ɵɵelementStart(56,"input",36),a.ɵɵlistener("ngModelChange",(function(e){return t.organizationLabel=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(57,"div",7),a.ɵɵelementStart(58,"div",8),a.ɵɵelementStart(59,"div",37),a.ɵɵelementStart(60,"button",38),a.ɵɵlistener("click",(function(){return t.bsModalRef.hide()})),a.ɵɵelement(61,"localize",39),a.ɵɵelementEnd(),a.ɵɵelementStart(62,"button",40),a.ɵɵelement(63,"localize",41),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵreference(1);a.ɵɵadvance(3),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(3),a.ɵɵproperty("ngIf",t.geoObjectType.isAbstract),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.geoObjectType.isAbstract),a.ɵɵadvance(7),a.ɵɵproperty("ngModel",t.geoObjectType.code),a.ɵɵadvance(3),a.ɵɵproperty("ngForOf",t.geoObjectType.label.localeValues),a.ɵɵadvance(3),a.ɵɵproperty("value",t.geoObjectType.description)("inlinelayout",!0),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.geoObjectType.superTypeCode),a.ɵɵadvance(7),a.ɵɵproperty("disable",null!=t.geoObjectType.superTypeCode)("value",t.geoObjectType.isPrivate)("localizeLabelKey","geoObjectType.attr.isPrivate"),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",t.geoObjectType.geometryType)("disabled",null!=t.geoObjectType.superTypeCode&&""!=t.geoObjectType.superTypeCode),a.ɵɵadvance(12),a.ɵɵproperty("ngClass",a.ɵɵpureFunction1(16,C,t.geoObjectType.isGeometryEditable)),a.ɵɵadvance(10),a.ɵɵproperty("ngModel",t.organizationLabel),a.ɵɵadvance(6),a.ɵɵproperty("disabled",r.invalid)}},directives:[d.ɵangular_packages_forms_forms_ba,d.NgControlStatusGroup,d.NgForm,p.NgIf,m.LocalizeComponent,d.DefaultValueAccessor,d.RequiredValidator,d.NgControlStatus,d.NgModel,p.NgForOf,u.LocalizedTextComponent,g.BooleanFieldComponent,d.SelectControlValueAccessor,d.NgSelectOption,d.ɵangular_packages_forms_forms_z,p.NgClass,h.ConvertKeyLabel],encapsulation:2}),e}();t.CreateGeoObjTypeModalComponent=E,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(E,[{type:r.Component,args:[{selector:"create-geoobjtype-modal",templateUrl:"./create-geoobjtype-modal.component.html",styleUrls:[]}]}],(function(){return[{type:l.LocalizationService},{type:l.AuthService},{type:s.RegistryService},{type:c.BsModalRef}]}),null)},567:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManageGeoObjectTypeModalComponent=void 0;var r=n(0),i=n(7),o=(n(30),n(31)),a=n(111),l=n(258),s=(n(518),n(0)),c=n(30),d=n(518),p=n(22),m=n(155),u=n(1),g=n(568),h=n(569),f=n(571),y=n(573),v=n(574);function b(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"geoobjecttype-input",5),s.ɵɵlistener("geoObjectTypeChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext().onGeoObjectTypeChange(e)})),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵproperty("readOnly",r.readOnly)("geoObjectType",r.geoObjectType)("setGeoObjectType",r.geoObjectType)}}function S(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"define-attribute-modal-content",6),s.ɵɵlistener("geoObjectTypeChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext().onGeoObjectTypeChange(e)})),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵproperty("geoObjectType",r.geoObjectType)}}function C(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"edit-attribute-modal-content",7),s.ɵɵlistener("geoObjectTypeChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext().onGeoObjectTypeChange(e)})),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵproperty("geoObjectType",r.geoObjectType)("attribute",r.modalState.attribute)}}function E(e,t){if(1&e&&s.ɵɵelement(0,"manage-term-options",8),2&e){var n=s.ɵɵnextContext();s.ɵɵproperty("geoObjectType",n.geoObjectType)("attribute",n.modalState.attribute)}}function x(e,t){if(1&e&&s.ɵɵelement(0,"edit-term-option-input",9),2&e){var n=s.ɵɵnextContext();s.ɵɵproperty("geoObjectType",n.geoObjectType)("attribute",n.modalState.attribute)("termOption",n.modalState.termOption)}}var O=function(){function e(e,t,n){var r=this;this.bsModalRef=e,this.confirmBsModalRef=t,this.message=null,this.modalState={state:l.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""},this.readOnly=!1,this.modalStateSubscription=n.modalStepChange.subscribe((function(e){r.modalState=e}))}return e.prototype.ngOnInit=function(){this.onGeoObjectTypeSubmitted=new o.Subject},e.prototype.ngOnDestroy=function(){this.modalStateSubscription.unsubscribe()},e.prototype.onModalStateChange=function(e){this.modalState=e},e.prototype.onGeoObjectTypeChange=function(e){this.onGeoObjectTypeSubmitted.next(e)},e.prototype.update=function(){},e.prototype.close=function(){this.bsModalRef.hide()},e.prototype.error=function(e){this.message=a.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(d.GeoObjectTypeManagementService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["manage-geoobjecttype-modal"]],decls:7,vars:5,consts:[[3,"readOnly","geoObjectType","setGeoObjectType","geoObjectTypeChange",4,"ngIf"],[3,"geoObjectType","geoObjectTypeChange",4,"ngIf"],[3,"geoObjectType","attribute","geoObjectTypeChange",4,"ngIf"],[3,"geoObjectType","attribute",4,"ngIf"],[3,"geoObjectType","attribute","termOption",4,"ngIf"],[3,"readOnly","geoObjectType","setGeoObjectType","geoObjectTypeChange"],[3,"geoObjectType","geoObjectTypeChange"],[3,"geoObjectType","attribute","geoObjectTypeChange"],[3,"geoObjectType","attribute"],[3,"geoObjectType","attribute","termOption"]],template:function(e,t){1&e&&(s.ɵɵelementStart(0,"form"),s.ɵɵelement(1,"modal-step-indicator"),s.ɵɵtemplate(2,b,1,3,"geoobjecttype-input",0),s.ɵɵtemplate(3,S,1,1,"define-attribute-modal-content",1),s.ɵɵtemplate(4,C,1,2,"edit-attribute-modal-content",2),s.ɵɵtemplate(5,E,1,2,"manage-term-options",3),s.ɵɵtemplate(6,x,1,3,"edit-term-option-input",4),s.ɵɵelementEnd()),2&e&&(s.ɵɵadvance(2),s.ɵɵproperty("ngIf","MANAGE-GEO-OBJECT-TYPE"===t.modalState.state),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","DEFINE-ATTRIBUTE"===t.modalState.state),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","EDIT-ATTRIBUTE"===t.modalState.state),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","MANAGE-TERM-OPTION"===t.modalState.state),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","EDIT-TERM-OPTION"===t.modalState.state))},directives:[p.ɵangular_packages_forms_forms_ba,p.NgControlStatusGroup,p.NgForm,m.ModalStepIndicatorComponent,u.NgIf,g.GeoObjectTypeInputComponent,h.DefineAttributeModalContentComponent,f.EditAttributeModalContentComponent,y.ManageTermOptionsComponent,v.EditTermOptionInputComponent],styles:[""],data:{animation:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}}),e}();t.ManageGeoObjectTypeModalComponent=O,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(O,[{type:r.Component,args:[{selector:"manage-geoobjecttype-modal",templateUrl:"./manage-geoobjecttype-modal.component.html",styleUrls:["./manage-geoobjecttype-modal.css"],animations:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}]}],(function(){return[{type:c.BsModalRef},{type:c.BsModalRef},{type:d.GeoObjectTypeManagementService}]}),null)},568:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectTypeInputComponent=void 0;var r=n(0),i=n(7),o=(n(30),n(260)),a=n(111),l=(n(16),n(203),n(258)),s=(n(518),n(0)),c=n(30),d=n(16),p=n(518),m=n(1),u=n(22),g=n(68),h=n(531),f=n(525),y=n(262),v=n(33),b=n(113);function S(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",4),s.ɵɵtext(1),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext(2);s.ɵɵadvance(1),s.ɵɵtextInterpolate(n.message)}}function C(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",9),s.ɵɵelementStart(1,"div",10),s.ɵɵelement(2,"localize",44),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"div",12),s.ɵɵelementStart(4,"span",13),s.ɵɵtext(5),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext(3);s.ɵɵadvance(5),s.ɵɵtextInterpolate1(" ",n.geoObjectType.superTypeCode," ")}}function E(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"a",48),s.ɵɵlistener("click",(function(e){s.ɵɵrestoreView(n);var t=s.ɵɵnextContext().$implicit;return s.ɵɵnextContext(3).editAttribute(t,e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelementEnd()}2&e&&s.ɵɵproperty("title",s.ɵɵpipeBind1(1,1,"modal.button.edit"))}function x(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"a",49),s.ɵɵlistener("click",(function(e){s.ɵɵrestoreView(n);var t=s.ɵɵnextContext().$implicit;return s.ɵɵnextContext(3).removeAttributeType(t,e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelementEnd()}2&e&&s.ɵɵproperty("title",s.ɵɵpipeBind1(1,1,"modal.button.remove"))}function O(e,t){if(1&e&&(s.ɵɵelementStart(0,"tr"),s.ɵɵelementStart(1,"td"),s.ɵɵtext(2),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"td",45),s.ɵɵtemplate(4,E,2,3,"a",46),s.ɵɵtemplate(5,x,2,3,"a",47),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e){var n=t.$implicit;s.ɵɵadvance(2),s.ɵɵtextInterpolate(n.label.localizedValue),s.ɵɵadvance(2),s.ɵɵproperty("ngIf",!n.isDefault&&"keyName"!==n.code),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",!n.isDefault&&"keyName"!==n.code)}}function I(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"button",50),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext(3).update()})),s.ɵɵelement(1,"localize",51),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(3);s.ɵɵproperty("disabled",!r.isValid())}}function w(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"form",5,6),s.ɵɵlistener("ngSubmit",(function(){return s.ɵɵrestoreView(n),s.ɵɵreference(1).valid})),s.ɵɵelementStart(2,"div",7),s.ɵɵelementStart(3,"h1"),s.ɵɵelement(4,"localize",8),s.ɵɵtext(5),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(6,"fieldset"),s.ɵɵelementStart(7,"div",9),s.ɵɵelementStart(8,"div",10),s.ɵɵelementStart(9,"label"),s.ɵɵelement(10,"localize",11),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(11,"div",12),s.ɵɵelementStart(12,"span",13),s.ɵɵelementStart(13,"input",14),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).editGeoObjectType.code=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(14,"localized-input",15),s.ɵɵlistener("valueChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).editGeoObjectType.label=e})),s.ɵɵelementEnd(),s.ɵɵelementStart(15,"localized-text",16),s.ɵɵlistener("valueChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).editGeoObjectType.description=e})),s.ɵɵelementEnd(),s.ɵɵelementStart(16,"div",9),s.ɵɵelementStart(17,"div",10),s.ɵɵelementStart(18,"label"),s.ɵɵelement(19,"localize",17),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(20,"div",12),s.ɵɵelementStart(21,"boolean-field",18),s.ɵɵlistener("valueChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).geoObjectType.isAbstract=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(22,"div",9),s.ɵɵelementStart(23,"div",10),s.ɵɵelementStart(24,"label"),s.ɵɵelement(25,"localize",19),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(26,"div",12),s.ɵɵelementStart(27,"boolean-field",18),s.ɵɵlistener("valueChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).editGeoObjectType.isPrivate=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵtemplate(28,C,6,1,"div",20),s.ɵɵelementStart(29,"div",9),s.ɵɵelementStart(30,"div",10),s.ɵɵelementStart(31,"label"),s.ɵɵelement(32,"localize",21),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(33,"div",12),s.ɵɵelementStart(34,"select",22),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).editGeoObjectType.geometryType=e})),s.ɵɵelement(35,"option"),s.ɵɵelementStart(36,"option",23),s.ɵɵelement(37,"localize",24),s.ɵɵelementEnd(),s.ɵɵelementStart(38,"option",25),s.ɵɵelement(39,"localize",26),s.ɵɵelementEnd(),s.ɵɵelementStart(40,"option",27),s.ɵɵelement(41,"localize",28),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(42,"div",9),s.ɵɵelementStart(43,"div",10),s.ɵɵelementStart(44,"label"),s.ɵɵelement(45,"localize",29),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(46,"div",12),s.ɵɵelementStart(47,"boolean-field",18),s.ɵɵlistener("valueChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).editGeoObjectType.isGeometryEditable=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(48,"div",9),s.ɵɵelementStart(49,"div",10),s.ɵɵelementStart(50,"label"),s.ɵɵelement(51,"localize",30),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(52,"div",12),s.ɵɵelementStart(53,"span",13),s.ɵɵelementStart(54,"input",31),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).organizationLabel=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(55,"div",9),s.ɵɵelementStart(56,"div",10),s.ɵɵelementStart(57,"label"),s.ɵɵelement(58,"localize",32),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(59,"div",12),s.ɵɵelementStart(60,"div",33),s.ɵɵelementStart(61,"div",34),s.ɵɵelementStart(62,"div",35),s.ɵɵelementStart(63,"table",36),s.ɵɵelementStart(64,"tbody"),s.ɵɵtemplate(65,O,6,3,"tr",37),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(66,"i",38),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).defineAttributeModal()})),s.ɵɵelement(67,"localize",39),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(68,"div",9),s.ɵɵelementStart(69,"div",40),s.ɵɵelementStart(70,"button",41),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).close()})),s.ɵɵelement(71,"localize",42),s.ɵɵelementEnd(),s.ɵɵtemplate(72,I,2,1,"button",43),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(2);s.ɵɵadvance(5),s.ɵɵtextInterpolate1(" : ",r.editGeoObjectType.label.localizedValue," "),s.ɵɵadvance(8),s.ɵɵproperty("ngModel",r.editGeoObjectType.code),s.ɵɵadvance(1),s.ɵɵproperty("disabled",r.readOnly)("value",r.editGeoObjectType.label),s.ɵɵadvance(1),s.ɵɵproperty("disabled",r.readOnly)("value",r.editGeoObjectType.description),s.ɵɵadvance(6),s.ɵɵproperty("disable",!0)("value",r.geoObjectType.isAbstract)("localizeLabelKey","attribute.isAbstract.label"),s.ɵɵadvance(6),s.ɵɵproperty("disable",r.geoObjectType.superTypeCode)("value",r.editGeoObjectType.isPrivate)("localizeLabelKey","geoObjectType.attr.isPrivate"),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",!r.geoObjectType.isAbstract&&r.geoObjectType.superTypeCode),s.ɵɵadvance(6),s.ɵɵproperty("ngModel",r.editGeoObjectType.geometryType),s.ɵɵadvance(13),s.ɵɵproperty("disable",r.readOnly)("value",r.editGeoObjectType.isGeometryEditable)("localizeLabelKey","hierarchy.management.option.label.isGeometryEditable"),s.ɵɵadvance(7),s.ɵɵproperty("ngModel",r.organizationLabel),s.ɵɵadvance(11),s.ɵɵproperty("ngForOf",r.geoObjectType.attributes),s.ɵɵadvance(7),s.ɵɵproperty("ngIf",!r.readOnly)}}function M(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",1),s.ɵɵtemplate(1,S,2,1,"div",2),s.ɵɵtemplate(2,w,73,20,"form",3),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵproperty("ngIf",null!=n.message),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.editGeoObjectType)}}var T=function(){function e(e,t,n,i,o,a,s){this.bsModalRef=e,this.confirmBsModalRef=t,this.modalService=n,this.modalStepIndicatorService=i,this.geoObjectTypeManagementService=o,this.localizationService=a,this.registryService=s,this.readOnly=!1,this.geoObjectTypeChange=new r.EventEmitter,this.message=null,this.modalState={state:l.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""},this.modalStepConfig={steps:[{label:this.localizationService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!0}]}}return Object.defineProperty(e.prototype,"in",{set:function(e){e&&(this.editGeoObjectType=JSON.parse(JSON.stringify(e)))},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig),this.geoObjectTypeManagementService.setModalState(this.modalState),this.fetchOrganizationLabel()},e.prototype.defineAttributeModal=function(){this.geoObjectTypeManagementService.setModalState({state:l.GeoObjectTypeModalStates.defineAttribute,attribute:"",termOption:""})},e.prototype.fetchOrganizationLabel=function(){var e=this;this.registryService.getOrganizations().then((function(t){for(var n=0;n<t.length;++n)t[n].code===e.editGeoObjectType.organizationCode&&(e.organizationLabel=t[n].label.localizedValue)})).catch((function(t){e.error(t)}))},e.prototype.manageAttributes=function(){this.geoObjectTypeManagementService.setModalState({state:l.GeoObjectTypeModalStates.manageAttributes,attribute:"",termOption:""})},e.prototype.onModalStateChange=function(e){this.modalState=e},e.prototype.update=function(){var e=this;this.registryService.updateGeoObjectType(this.editGeoObjectType).then((function(t){e.geoObjectTypeChange.emit(t),e.close()})).catch((function(t){e.error(t)}))},e.prototype.close=function(){this.bsModalRef.hide()},e.prototype.isValid=function(){return!0},e.prototype.editAttribute=function(e,t){this.geoObjectTypeManagementService.setModalState({state:l.GeoObjectTypeModalStates.editAttribute,attribute:e,termOption:""})},e.prototype.removeAttributeType=function(e,t){var n=this;this.confirmBsModalRef=this.modalService.show(a.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.confirmBsModalRef.content.message=this.localizationService.decode("confirm.modal.verify.delete")+"["+e.label.localizedValue+"]",this.confirmBsModalRef.content.data={attributeType:e,geoObjectType:this.geoObjectType},this.confirmBsModalRef.content.submitText=this.localizationService.decode("modal.button.delete"),this.confirmBsModalRef.content.type=o.ModalTypes.danger,this.confirmBsModalRef.content.onConfirm.subscribe((function(e){n.deleteAttributeType(e.geoObjectType.code,e.attributeType)}))},e.prototype.deleteAttributeType=function(e,t){var n=this;this.registryService.deleteAttributeType(e,t.code).then((function(e){e&&n.geoObjectType.attributes.splice(n.geoObjectType.attributes.indexOf(t),1),n.geoObjectTypeChange.emit(n.geoObjectType)})).catch((function(e){n.error(e)}))},e.prototype.error=function(e){this.message=a.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(c.BsModalService),s.ɵɵdirectiveInject(d.ModalStepIndicatorService),s.ɵɵdirectiveInject(p.GeoObjectTypeManagementService),s.ɵɵdirectiveInject(d.LocalizationService),s.ɵɵdirectiveInject(p.RegistryService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["geoobjecttype-input"]],inputs:{readOnly:"readOnly",geoObjectType:"geoObjectType",in:["setGeoObjectType","in"]},outputs:{geoObjectTypeChange:"geoObjectTypeChange"},decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","modal-form",3,"ngSubmit",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"heading","text-center"],["key","hierarchy.management.edit.geoobjecttype.title"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["type","text","name","code","disabled","","required","",3,"ngModel","ngModelChange"],["key","data.property.label.label",3,"disabled","value","valueChange"],["key","data.property.label.description",3,"disabled","value","valueChange"],["key","attribute.group.label"],[3,"disable","value","localizeLabelKey","valueChange"],["key","geoObjectType.attr.visibility.label"],["class","row-holder",4,"ngIf"],["key","data.property.label.geometryType"],["name","geometryType","disabled","",3,"ngModel","ngModelChange"],["value","MULTIPOINT"],["key","georegistry.geometry.point"],["value","MULTILINE"],["key","georegistry.geometry.line"],["value","MULTIPOLYGON"],["key","georegistry.geometry.polygon"],["key","hierarchy.management.option.label.geometryEditable"],["key","attribute.organization.label"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],["key","hierarchy.management.manage.attributes.label.displayAttributes"],[1,"panel","panel-default"],[1,"panel-body"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],["aria-hidden","true",1,"fa","fa-plus","clickable",2,"font-size","20px","margin","10px 0 10px 0",3,"click"],["key","modal.button.add"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],["key","attribute.parentType.label"],[1,"button-column",2,"width","60px"],["class","fa fa-pencil ico-edit",3,"routerLink","title","click",4,"ngIf"],["class","fa fa-trash-o ico-remove",3,"routerLink","title","click",4,"ngIf"],[1,"fa","fa-pencil","ico-edit",3,"routerLink","title","click"],[1,"fa","fa-trash-o","ico-remove",3,"routerLink","title","click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"]],template:function(e,t){1&e&&s.ɵɵtemplate(0,M,3,2,"div",0),2&e&&s.ɵɵproperty("ngIf","MANAGE-GEO-OBJECT-TYPE"===t.modalState.state)},directives:[m.NgIf,u.ɵangular_packages_forms_forms_ba,u.NgControlStatusGroup,u.NgForm,g.LocalizeComponent,u.DefaultValueAccessor,u.RequiredValidator,u.NgControlStatus,u.NgModel,h.LocalizedInputComponent,f.LocalizedTextComponent,y.BooleanFieldComponent,u.SelectControlValueAccessor,u.NgSelectOption,u.ɵangular_packages_forms_forms_z,m.NgForOf,v.RouterLinkWithHref],pipes:[b.LocalizePipe],styles:[".btn.btn-primary.full-width[_ngcontent-%COMP%] {\n    margin: 0 auto;\n    display: block;\n    width: 100%;\n}\n\n\nli.list-group-item[_ngcontent-%COMP%] {\n    font-size: inherit;\n    color: grey;\n}\nli.list-group-item[_ngcontent-%COMP%]:hover {\n    cursor: default;\n    background: white;\n}"],data:{animation:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}}),e}();t.GeoObjectTypeInputComponent=T,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(T,[{type:r.Component,args:[{selector:"geoobjecttype-input",templateUrl:"./geoobjecttype-input.component.html",styleUrls:["./geoobjecttype-input.css"],animations:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}]}],(function(){return[{type:c.BsModalRef},{type:c.BsModalRef},{type:c.BsModalService},{type:d.ModalStepIndicatorService},{type:p.GeoObjectTypeManagementService},{type:d.LocalizationService},{type:p.RegistryService}]}),{readOnly:[{type:r.Input}],geoObjectType:[{type:r.Input}],geoObjectTypeChange:[{type:r.Output}],in:[{type:r.Input,args:["setGeoObjectType"]}]})},569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefineAttributeModalContentComponent=void 0;var r=n(0),i=(n(30),n(111)),o=(n(16),n(203)),a=n(258),l=(n(518),n(527)),s=n(0),c=n(30),d=n(16),p=n(518),m=n(22),u=n(1),g=n(68),h=n(527);function f(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",24),s.ɵɵtext(1),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵtextInterpolate(n.message)}}var y=function(e){return{active:e}},v=function(){function e(e,t,n,i,o){this.bsModalRef=e,this.modalStepIndicatorService=t,this.geoObjectTypeManagementService=n,this.localizeService=i,this.registryService=o,this.geoObjectTypeChange=new r.EventEmitter,this.message=null,this.newAttribute=null,this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.create.attribute"),active:!0,enabled:!0}]},this.modalState={state:a.GeoObjectTypeModalStates.defineAttribute,attribute:"",termOption:""}}return e.prototype.ngOnInit=function(){this.setAttribute("character"),this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)},e.prototype.ngAfterViewInit=function(){this.attributeInputComponent&&this.attributeInputComponent.animate()},e.prototype.handleOnSubmit=function(){var e=this;this.registryService.addAttributeType(this.geoObjectType.code,this.newAttribute).then((function(t){e.geoObjectType.attributes.push(t),e.geoObjectTypeManagementService.setModalState({state:a.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""}),e.geoObjectTypeChange.emit(e.geoObjectType)})).catch((function(t){e.error(t)}))},e.prototype.setAttribute=function(e){this.newAttribute="term"===e?new o.AttributeTermType("",e,this.localizeService.create(),this.localizeService.create(),!1,!1,!1,!0):"float"===e?new o.AttributeDecimalType("",e,this.localizeService.create(),this.localizeService.create(),!1,!1,!1,!0):new o.AttributeType("",e,this.localizeService.create(),this.localizeService.create(),!1,!1,!1,!0)},e.prototype.isFormValid=function(){var e=!1;return this.attributeInputComponent&&(e=this.attributeInputComponent.isValid()),!!e},e.prototype.cancel=function(){this.geoObjectTypeManagementService.setModalState({state:a.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""})},e.prototype.error=function(e){this.message=i.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(d.ModalStepIndicatorService),s.ɵɵdirectiveInject(p.GeoObjectTypeManagementService),s.ɵɵdirectiveInject(d.LocalizationService),s.ɵɵdirectiveInject(p.RegistryService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["define-attribute-modal-content"]],viewQuery:function(e,t){if(1&e&&s.ɵɵviewQuery(l.AttributeInputComponent,1),2&e){var n;s.ɵɵqueryRefresh(n=s.ɵɵloadQuery())&&(t.attributeInputComponent=n.first)}},inputs:{geoObjectType:"geoObjectType"},outputs:{geoObjectTypeChange:"geoObjectTypeChange"},decls:33,vars:24,consts:[[1,"modal-body"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,""],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["key","hierarchy.management.define.attribute.title"],[1,"row"],[1,"col-md-12",2,"margin-bottom","20px"],[1,"btn-group","define-attribute-btns"],[1,"btn","full-width-radio-button",3,"ngClass","click"],["key","data.type.label.text"],["key","data.type.label.integer"],["key","data.type.label.float"],["key","data.type.label.date"],["key","data.type.label.boolean"],["key","data.type.label.term"],[3,"disableCodeField","excludeDescription","isDecimal","attribute","attributeChange"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.submit"],["role","alert",1,"alert","alert-danger"]],template:function(e,t){1&e&&(s.ɵɵelementStart(0,"div",0),s.ɵɵelementStart(1,"form",1,2),s.ɵɵlistener("ngSubmit",(function(){return t.handleOnSubmit()})),s.ɵɵelementStart(3,"div",3),s.ɵɵelementStart(4,"div",3),s.ɵɵtemplate(5,f,2,1,"div",4),s.ɵɵelementStart(6,"div",5),s.ɵɵelementStart(7,"h1"),s.ɵɵelement(8,"localize",6),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(9,"div",7),s.ɵɵelementStart(10,"div",8),s.ɵɵelementStart(11,"div",9),s.ɵɵelementStart(12,"label",10),s.ɵɵlistener("click",(function(){return t.setAttribute("character")})),s.ɵɵelement(13,"localize",11),s.ɵɵelementEnd(),s.ɵɵelementStart(14,"label",10),s.ɵɵlistener("click",(function(){return t.setAttribute("integer")})),s.ɵɵelement(15,"localize",12),s.ɵɵelementEnd(),s.ɵɵelementStart(16,"label",10),s.ɵɵlistener("click",(function(){return t.setAttribute("float")})),s.ɵɵelement(17,"localize",13),s.ɵɵelementEnd(),s.ɵɵelementStart(18,"label",10),s.ɵɵlistener("click",(function(){return t.setAttribute("date")})),s.ɵɵelement(19,"localize",14),s.ɵɵelementEnd(),s.ɵɵelementStart(20,"label",10),s.ɵɵlistener("click",(function(){return t.setAttribute("boolean")})),s.ɵɵelement(21,"localize",15),s.ɵɵelementEnd(),s.ɵɵelementStart(22,"label",10),s.ɵɵlistener("click",(function(){return t.setAttribute("term")})),s.ɵɵelement(23,"localize",16),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(24,"fieldset"),s.ɵɵelementStart(25,"attribute-input",17),s.ɵɵlistener("attributeChange",(function(e){return t.newAttribute=e})),s.ɵɵelementEnd(),s.ɵɵelementStart(26,"div",7),s.ɵɵelementStart(27,"div",18),s.ɵɵelementStart(28,"div",19),s.ɵɵelementStart(29,"button",20),s.ɵɵlistener("click",(function(){return t.cancel()})),s.ɵɵelement(30,"localize",21),s.ɵɵelementEnd(),s.ɵɵelementStart(31,"button",22),s.ɵɵelement(32,"localize",23),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e&&(s.ɵɵadvance(5),s.ɵɵproperty("ngIf",null!=t.message),s.ɵɵadvance(7),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(12,y,"character"===t.newAttribute.type)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(14,y,"integer"===t.newAttribute.type)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(16,y,"float"===t.newAttribute.type)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(18,y,"date"===t.newAttribute.type)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(20,y,"boolean"===t.newAttribute.type)),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(22,y,"term"===t.newAttribute.type)),s.ɵɵadvance(3),s.ɵɵproperty("disableCodeField",!1)("excludeDescription",!1)("isDecimal","float"===t.newAttribute.type)("attribute",t.newAttribute),s.ɵɵadvance(6),s.ɵɵproperty("disabled",!t.isFormValid()))},directives:[m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,u.NgIf,g.LocalizeComponent,u.NgClass,h.AttributeInputComponent],styles:[".btn-group.define-attribute-btns[_ngcontent-%COMP%] {\n    \n    margin: 0 auto;\n    display: block;\n    \n}"]}),e}();t.DefineAttributeModalContentComponent=v,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(v,[{type:r.Component,args:[{selector:"define-attribute-modal-content",templateUrl:"./define-attribute-modal-content.component.html",styleUrls:["./define-attribute-modal-content.css"]}]}],(function(){return[{type:c.BsModalRef},{type:d.ModalStepIndicatorService},{type:p.GeoObjectTypeManagementService},{type:d.LocalizationService},{type:p.RegistryService}]}),{geoObjectType:[{type:r.Input}],geoObjectTypeChange:[{type:r.Output}],attributeInputComponent:[{type:r.ViewChild,args:[l.AttributeInputComponent]}]})},570:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectAttributeCodeValidator=void 0;var r=n(0),i=n(22),o=n(0);var a=function(){function e(){this.validator=function(e){if(e.value)return-1===e.value.indexOf(" ")?null:{geoObjectAttributeCode:{valid:!1}}}}return e.prototype.validate=function(e){return this.validator(e)},e.ɵfac=function(t){return new(t||e)},e.ɵdir=o.ɵɵdefineDirective({type:e,selectors:[["","geoObjectAttributeCode","","ngModel",""]],features:[o.ɵɵProvidersFeature([{provide:i.NG_VALIDATORS,useExisting:e,multi:!0}])]}),e}();t.GeoObjectAttributeCodeValidator=a,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(a,[{type:r.Directive,args:[{selector:"[geoObjectAttributeCode][ngModel]",providers:[{provide:i.NG_VALIDATORS,useExisting:a,multi:!0}]}]}],(function(){return[]}),null)},571:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditAttributeModalContentComponent=void 0;var r=n(0),i=n(7),o=(n(30),n(203),n(258)),a=n(111),l=(n(16),n(518),n(527)),s=n(0),c=n(30),d=n(16),p=n(518),m=n(22),u=n(1),g=n(68),h=n(527),f=n(572);function y(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",17),s.ɵɵtext(1),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵtextInterpolate(n.message)}}function v(e,t){1&e&&(s.ɵɵelementStart(0,"h4",18),s.ɵɵelement(1,"localize",19),s.ɵɵtext(2,": "),s.ɵɵelement(3,"localize",20),s.ɵɵelementEnd())}function b(e,t){1&e&&(s.ɵɵelementStart(0,"h4",18),s.ɵɵelement(1,"localize",19),s.ɵɵtext(2,": "),s.ɵɵelement(3,"localize",21),s.ɵɵelementEnd())}function S(e,t){1&e&&(s.ɵɵelementStart(0,"h4",18),s.ɵɵelement(1,"localize",19),s.ɵɵtext(2,": "),s.ɵɵelement(3,"localize",22),s.ɵɵelementEnd())}function C(e,t){1&e&&(s.ɵɵelementStart(0,"h4",18),s.ɵɵelement(1,"localize",19),s.ɵɵtext(2,": "),s.ɵɵelement(3,"localize",23),s.ɵɵelementEnd())}function E(e,t){1&e&&(s.ɵɵelementStart(0,"h4",18),s.ɵɵelement(1,"localize",19),s.ɵɵtext(2,": "),s.ɵɵelement(3,"localize",24),s.ɵɵelementEnd())}function x(e,t){1&e&&(s.ɵɵelementStart(0,"h4",18),s.ɵɵelement(1,"localize",19),s.ɵɵtext(2,": "),s.ɵɵelement(3,"localize",25),s.ɵɵelementEnd())}function O(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"term-option-widget",26),s.ɵɵlistener("attributeChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext().attribute=e})),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵproperty("attribute",r.attribute)("geoObjectType",r.geoObjectType)}}var I=function(){function e(e,t,n,i,a){this.bsModalRef=e,this.modalStepIndicatorService=t,this.geoObjectTypeManagementService=n,this.localizeService=i,this.registryService=a,this.attribute=null,this.geoObjectTypeChange=new r.EventEmitter,this.message=null,this.modalState={state:o.GeoObjectTypeModalStates.editAttribute,attribute:this.attribute,termOption:""},this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.attribute"),active:!0,enabled:!0}]}}return e.prototype.ngOnInit=function(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)},e.prototype.ngAfterViewInit=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.handleOnSubmit=function(){var e=this;this.registryService.updateAttributeType(this.geoObjectType.code,this.attribute).then((function(t){for(var n=0;n<e.geoObjectType.attributes.length;n++){var r=e.geoObjectType.attributes[n];if(r.code===t.code){Object.assign(r,t);break}}e.geoObjectTypeManagementService.setModalState({state:o.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""}),e.geoObjectTypeChange.emit(e.geoObjectType)})).catch((function(t){e.error(t)}))},e.prototype.isFormValid=function(){return!0},e.prototype.cancel=function(){this.geoObjectTypeManagementService.setModalState({state:o.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""})},e.prototype.back=function(){this.geoObjectTypeManagementService.setModalState({state:o.GeoObjectTypeModalStates.manageGeoObjectType,attribute:"",termOption:""})},e.prototype.error=function(e){this.message=a.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(d.ModalStepIndicatorService),s.ɵɵdirectiveInject(p.GeoObjectTypeManagementService),s.ɵɵdirectiveInject(d.LocalizationService),s.ɵɵdirectiveInject(p.RegistryService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["edit-attribute-modal-content"]],viewQuery:function(e,t){if(1&e&&s.ɵɵviewQuery(l.AttributeInputComponent,1),2&e){var n;s.ɵɵqueryRefresh(n=s.ɵɵloadQuery())&&(t.attributeInputComponent=n.first)}},inputs:{geoObjectType:"geoObjectType",attribute:"attribute"},outputs:{geoObjectTypeChange:"geoObjectTypeChange"},decls:26,vars:14,consts:[[1,"modal-body"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,""],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["key","hierarchy.management.edit.attribute.title"],["class","sub-title",4,"ngIf"],[3,"disableCodeField","excludeDescription","isDecimal","attribute","attributeChange"],[3,"attribute","geoObjectType","attributeChange",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.submit"],["role","alert",1,"alert","alert-danger"],[1,"sub-title"],["key","hierarchy.management.edit.attribute.subtitle"],["key","data.type.label.text"],["key","data.type.label.integer"],["key","data.type.label.float"],["key","data.type.label.boolean"],["key","data.type.label.date"],["key","data.type.label.term"],[3,"attribute","geoObjectType","attributeChange"]],template:function(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",0),s.ɵɵelementStart(1,"form",1,2),s.ɵɵlistener("ngSubmit",(function(){return s.ɵɵrestoreView(n),s.ɵɵreference(2).valid&&t.handleOnSubmit()})),s.ɵɵelementStart(3,"div",3),s.ɵɵelementStart(4,"div",3),s.ɵɵtemplate(5,y,2,1,"div",4),s.ɵɵelementStart(6,"div",5),s.ɵɵelementStart(7,"h1"),s.ɵɵelement(8,"localize",6),s.ɵɵtext(9),s.ɵɵelementEnd(),s.ɵɵtemplate(10,v,4,0,"h4",7),s.ɵɵtemplate(11,b,4,0,"h4",7),s.ɵɵtemplate(12,S,4,0,"h4",7),s.ɵɵtemplate(13,C,4,0,"h4",7),s.ɵɵtemplate(14,E,4,0,"h4",7),s.ɵɵtemplate(15,x,4,0,"h4",7),s.ɵɵelementEnd(),s.ɵɵelementStart(16,"fieldset"),s.ɵɵelementStart(17,"attribute-input",8),s.ɵɵlistener("attributeChange",(function(e){return t.attribute=e})),s.ɵɵelementEnd(),s.ɵɵtemplate(18,O,1,2,"term-option-widget",9),s.ɵɵelementStart(19,"div",10),s.ɵɵelementStart(20,"div",11),s.ɵɵelementStart(21,"div",12),s.ɵɵelementStart(22,"button",13),s.ɵɵlistener("click",(function(){return t.cancel()})),s.ɵɵelement(23,"localize",14),s.ɵɵelementEnd(),s.ɵɵelementStart(24,"button",15),s.ɵɵelement(25,"localize",16),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()}2&e&&(s.ɵɵadvance(5),s.ɵɵproperty("ngIf",null!=t.message),s.ɵɵadvance(4),s.ɵɵtextInterpolate1(": ",t.attribute.label.localizedValue," "),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","character"===t.attribute.type),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","integer"===t.attribute.type),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","float"===t.attribute.type),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","boolean"===t.attribute.type),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","date"===t.attribute.type),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","term"===t.attribute.type),s.ɵɵadvance(2),s.ɵɵproperty("disableCodeField",!0)("excludeDescription","term"===t.attribute.type)("isDecimal","float"===t.attribute.type)("attribute",t.attribute),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","term"===t.attribute.type&&t.isFormValid()),s.ɵɵadvance(6),s.ɵɵproperty("disabled",!t.isFormValid()))},directives:[m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,u.NgIf,g.LocalizeComponent,h.AttributeInputComponent,f.TermOptionWidgetComponent],styles:['input[type="text"][_ngcontent-%COMP%] {\n    margin: 2px 0 2px 0 !important;\n    float: none !important;\n}\n\nlabel[_ngcontent-%COMP%] {\n    color: #999;\n    font-weight: bold;\n}\n\n.sub-title[_ngcontent-%COMP%] {\n    color: grey;\n}\n\n.btn-group.define-attribute-btns[_ngcontent-%COMP%] {\n    \n    margin: 0 auto;\n    display: block;\n    \n}'],data:{animation:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")])])]]}}),e}();t.EditAttributeModalContentComponent=I,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(I,[{type:r.Component,args:[{selector:"edit-attribute-modal-content",templateUrl:"./edit-attribute-modal-content.component.html",styleUrls:["./edit-attribute-modal-content.css"],animations:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")])])]]}]}],(function(){return[{type:c.BsModalRef},{type:d.ModalStepIndicatorService},{type:p.GeoObjectTypeManagementService},{type:d.LocalizationService},{type:p.RegistryService}]}),{geoObjectType:[{type:r.Input}],attribute:[{type:r.Input}],geoObjectTypeChange:[{type:r.Output}],attributeInputComponent:[{type:r.ViewChild,args:[l.AttributeInputComponent]}]})},572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermOptionWidgetComponent=void 0;var r=n(0),i=n(7),o=(n(30),n(203),n(258)),a=(n(526),n(0)),l=n(30),s=n(526),c=n(68),d=n(1);function p(e,t){if(1&e&&(a.ɵɵelementStart(0,"li",10),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label.localizedValue)}}var m=function(){function e(e,t,n){this.bsModalRef=e,this.cdr=t,this.geoObjectTypeManagementService=n,this.attribute=null,this.attributeChange=new r.EventEmitter,this.message=null,this.state="none",this.modalState={state:o.GeoObjectTypeModalStates.manageTermOption,attribute:this.attribute,termOption:""}}return e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){this.state="show",this.cdr.detectChanges()},e.prototype.ngOnDestroy=function(){},e.prototype.handleOnSubmit=function(){},e.prototype.animate=function(){this.state="none"},e.prototype.onAnimationDone=function(e){this.state="show"},e.prototype.openAddTermOptionForm=function(){this.geoObjectTypeManagementService.setModalState({state:o.GeoObjectTypeModalStates.manageTermOption,attribute:this.attribute,termOption:""})},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.BsModalRef),a.ɵɵdirectiveInject(a.ChangeDetectorRef),a.ɵɵdirectiveInject(s.GeoObjectTypeManagementService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["term-option-widget"]],inputs:{geoObjectType:"geoObjectType",attribute:"attribute"},outputs:{attributeChange:"attributeChange"},decls:12,vars:2,consts:[[1,"row-holder"],[1,"label-holder"],["key","hierarchy.management.manage.attributes.label.displayTerms"],[1,"holder"],[1,"panel","panel-default"],[1,"panel-body"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","full-width",3,"click"],["key","modal.button.manageTermOptions"],[1,"list-group-item"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵlistener("@toggleInputs.done",(function(e){return t.onAnimationDone(e)})),a.ɵɵelementStart(1,"div"),a.ɵɵelementStart(2,"div",1),a.ɵɵelementStart(3,"label"),a.ɵɵelement(4,"localize",2),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",3),a.ɵɵelementStart(6,"div",4),a.ɵɵelementStart(7,"div",5),a.ɵɵelementStart(8,"ul",6),a.ɵɵtemplate(9,p,2,1,"li",7),a.ɵɵelementEnd(),a.ɵɵelementStart(10,"button",8),a.ɵɵlistener("click",(function(){return t.openAddTermOptionForm()})),a.ɵɵelement(11,"localize",9),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵproperty("@toggleInputs",t.state),a.ɵɵadvance(9),a.ɵɵproperty("ngForOf",t.attribute.rootTerm.children))},directives:[c.LocalizeComponent,d.NgForOf],styles:['input[type="text"][_ngcontent-%COMP%] {\n    margin: 2px 0 2px 0 !important;\n    float: none !important;\n}\n\nbutton[_ngcontent-%COMP%] {\n    margin-top: 5px;\n    float: right;\n}\n\n\n\n.btn.btn-primary.full-width[_ngcontent-%COMP%] {\n    margin: 0 auto;\n    display: block;\n    width: 100%;\n}\n\nlabel[_ngcontent-%COMP%] {\n    color: #999;\n    font-weight: bold;\n}\n\n\nli.list-group-item[_ngcontent-%COMP%] {\n    font-size: inherit;\n    color: grey;\n}\nli.list-group-item[_ngcontent-%COMP%]:hover {\n    cursor: default;\n    background: white;\n}'],data:{animation:[i.trigger("toggleInputs",[i.state("none, void",i.style({opacity:0})),i.state("show",i.style({opacity:1})),i.transition("none => show",i.animate("300ms")),i.transition("show => none",i.animate("100ms"))]),i.trigger("openClose",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms",i.style({opacity:1}))]),i.transition(":leave",[i.style({opacity:1}),i.animate("0ms",i.style({opacity:0}))])])]}}),e}();t.TermOptionWidgetComponent=m,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(m,[{type:r.Component,args:[{selector:"term-option-widget",templateUrl:"./term-option-widget.component.html",styleUrls:["./term-option-widget.css"],animations:[i.trigger("toggleInputs",[i.state("none, void",i.style({opacity:0})),i.state("show",i.style({opacity:1})),i.transition("none => show",i.animate("300ms")),i.transition("show => none",i.animate("100ms"))]),i.trigger("openClose",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms",i.style({opacity:1}))]),i.transition(":leave",[i.style({opacity:1}),i.animate("0ms",i.style({opacity:0}))])])]}]}],(function(){return[{type:l.BsModalRef},{type:a.ChangeDetectorRef},{type:s.GeoObjectTypeManagementService}]}),{geoObjectType:[{type:r.Input}],attribute:[{type:r.Input}],attributeChange:[{type:r.Output}]})},573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManageTermOptionsComponent=void 0;var r=n(0),i=n(7),o=(n(30),n(260)),a=n(111),l=(n(16),n(518),n(203)),s=n(258),c=n(0),d=n(30),p=n(518),m=n(16),u=n(22),g=n(1),h=n(68),f=n(259),y=n(33);function v(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",24),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.message)}}function b(e,t){if(1&e&&(c.ɵɵelementStart(0,"th"),c.ɵɵelement(1,"localize",25),c.ɵɵtext(2," ("),c.ɵɵelement(3,"convert-key-label",26),c.ɵɵtext(4,") "),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵadvance(3),c.ɵɵproperty("key",n.locale)}}function S(e,t){if(1&e&&(c.ɵɵelementStart(0,"td"),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.value)}}function C(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"tr"),c.ɵɵelementStart(1,"td"),c.ɵɵtext(2),c.ɵɵelementEnd(),c.ɵɵtemplate(3,S,2,1,"td",14),c.ɵɵelementStart(4,"td",18),c.ɵɵelementStart(5,"a",27),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=t.$implicit;return c.ɵɵnextContext().editTermOption(e)})),c.ɵɵelementEnd(),c.ɵɵelementStart(6,"a",28),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=t.$implicit;return c.ɵɵnextContext().removeTermOption(e)})),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=t.$implicit;c.ɵɵadvance(2),c.ɵɵtextInterpolate(r.code),c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",r.label.localeValues)}}function E(e,t){if(1&e&&(c.ɵɵelementStart(0,"td"),c.ɵɵelementStart(1,"input",29),c.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=t.$implicit,r=c.ɵɵnextContext();c.ɵɵadvance(1),c.ɵɵproperty("ngModel",n.value)("name","termOptionLabel-"+n.locale)("required",!!r.termOption.code||null)}}var x=function(){function e(e,t,n,i,o,a,l){this.bsModalRef=e,this.cdr=t,this.geoObjectTypeManagementService=n,this.modalService=i,this.localizeService=o,this.modalStepIndicatorService=a,this.registryService=l,this.attributeChange=new r.EventEmitter,this.message=null,this.state="none",this.enableTermOptionForm=!1,this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.attribute"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.term.options"),active:!0,enabled:!0}]}}return e.prototype.ngOnInit=function(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig),this.termOption=new l.Term("",this.localizeService.create(),this.localizeService.create())},e.prototype.ngAfterViewInit=function(){this.state="show",this.cdr.detectChanges()},e.prototype.ngOnDestroy=function(){},e.prototype.handleOnSubmit=function(){},e.prototype.animate=function(){this.state="none"},e.prototype.onAnimationDone=function(e){this.state="show"},e.prototype.isValid=function(){if(this.termOption.code&&this.termOption.code.length>0){if(-1!==this.termOption.code.indexOf(" "))return!1;for(var e=0;e<this.termOption.label.localeValues.length;e++)if(0===this.termOption.label.localeValues[e].value.replace(/\s/g,"").length)return!1;return!0}return this.termOption.code&&this.termOption.code.indexOf(" "),!1},e.prototype.addTermOption=function(){var e=this;this.registryService.addAttributeTermTypeOption(this.attribute.rootTerm.code,this.termOption).then((function(t){e.attribute.rootTerm.children.push(t),e.attributeChange.emit(e.attribute),e.clearTermOption(),e.enableTermOptionForm=!1})).catch((function(t){e.error(t)}))},e.prototype.deleteTermOption=function(e){var t=this;this.registryService.deleteAttributeTermTypeOption(this.attribute.rootTerm.code,e.code).then((function(n){-1!==t.attribute.rootTerm.children.indexOf(e)&&t.attribute.rootTerm.children.splice(t.attribute.rootTerm.children.indexOf(e),1),t.attributeChange.emit(t.attribute),t.clearTermOption()})).catch((function(e){t.error(e)}))},e.prototype.removeTermOption=function(e){var t=this;this.bsModalRef=this.modalService.show(a.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+"["+e.label+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type=o.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(n){t.deleteTermOption(e)}))},e.prototype.editTermOption=function(e){var t={state:s.GeoObjectTypeModalStates.editTermOption,attribute:this.attribute,termOption:JSON.parse(JSON.stringify(e))};this.geoObjectTypeManagementService.setModalState(t)},e.prototype.clearTermOption=function(){this.termOption.code="",this.termOption.label=this.localizeService.create(),this.termOption.description=this.localizeService.create()},e.prototype.cancelTermOption=function(){this.clearTermOption(),this.enableTermOptionForm=!1},e.prototype.openAddTermOptionForm=function(){this.enableTermOptionForm=!0},e.prototype.close=function(){this.geoObjectTypeManagementService.setModalState({state:s.GeoObjectTypeModalStates.editAttribute,attribute:this.attribute,termOption:""})},e.prototype.error=function(e){this.message=a.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(c.ɵɵdirectiveInject(d.BsModalRef),c.ɵɵdirectiveInject(c.ChangeDetectorRef),c.ɵɵdirectiveInject(p.GeoObjectTypeManagementService),c.ɵɵdirectiveInject(d.BsModalService),c.ɵɵdirectiveInject(m.LocalizationService),c.ɵɵdirectiveInject(m.ModalStepIndicatorService),c.ɵɵdirectiveInject(p.RegistryService))},e.ɵcmp=c.ɵɵdefineComponent({type:e,selectors:[["manage-term-options"]],inputs:{geoObjectType:"geoObjectType",attribute:"attribute"},outputs:{attributeChange:"attributeChange"},decls:40,vars:10,consts:[[1,"modal-body"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["key","hierarchy.management.edit.term.options.title"],[1,"row-holder"],[1,"label-holder"],["key","term.option.input.label.existingTypes"],[1,"holder"],[1,"text"],[1,"table-responsive"],[1,"table"],["key","data.property.label.code"],[4,"ngFor","ngForOf"],[1,"button-column-header"],["key","data.property.label.actions"],["type","text","name","termOptionCode",3,"ngModel","required","ngModelChange"],[1,"button-column"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.add"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.done"],["role","alert",1,"alert","alert-danger"],["key","data.property.label.label"],[3,"key"],[1,"fa","fa-pencil","ico-edit",3,"routerLink","click"],[1,"fa","fa-trash-o","ico-remove",3,"routerLink","click"],["type","text",3,"ngModel","name","required","ngModelChange"]],template:function(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",0),c.ɵɵelementStart(1,"form",1,2),c.ɵɵlistener("ngSubmit",(function(){return c.ɵɵrestoreView(n),c.ɵɵreference(2).valid})),c.ɵɵelementStart(3,"fieldset"),c.ɵɵtemplate(4,v,2,1,"div",3),c.ɵɵelementStart(5,"div",4),c.ɵɵelementStart(6,"h1"),c.ɵɵelementStart(7,"localize",5),c.ɵɵtext(8),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(9,"div",6),c.ɵɵlistener("@toggleInputs.done",(function(e){return t.onAnimationDone(e)})),c.ɵɵelementStart(10,"div"),c.ɵɵelementStart(11,"div",7),c.ɵɵelementStart(12,"label"),c.ɵɵelement(13,"localize",8),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(14,"div",9),c.ɵɵelementStart(15,"span",10),c.ɵɵelementStart(16,"div",11),c.ɵɵelementStart(17,"table",12),c.ɵɵelementStart(18,"thead"),c.ɵɵelementStart(19,"tr"),c.ɵɵelementStart(20,"th"),c.ɵɵelement(21,"localize",13),c.ɵɵelementEnd(),c.ɵɵtemplate(22,b,5,1,"th",14),c.ɵɵelementStart(23,"th",15),c.ɵɵelement(24,"localize",16),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(25,"tbody"),c.ɵɵtemplate(26,C,7,2,"tr",14),c.ɵɵelementStart(27,"tr"),c.ɵɵelementStart(28,"td"),c.ɵɵelementStart(29,"input",17),c.ɵɵlistener("ngModelChange",(function(e){return t.termOption.code=e})),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵtemplate(30,E,2,3,"td",14),c.ɵɵelementStart(31,"td",18),c.ɵɵelementStart(32,"button",19),c.ɵɵlistener("click",(function(){return t.addTermOption()})),c.ɵɵelement(33,"localize",20),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(34,"div",6),c.ɵɵelement(35,"div",7),c.ɵɵelementStart(36,"div",9),c.ɵɵelementStart(37,"div",21),c.ɵɵelementStart(38,"button",22),c.ɵɵlistener("click",(function(){return t.close()})),c.ɵɵelement(39,"localize",23),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}2&e&&(c.ɵɵadvance(4),c.ɵɵproperty("ngIf",null!=t.message),c.ɵɵadvance(4),c.ɵɵtextInterpolate1(": ",t.attribute.label.localizedValue,""),c.ɵɵadvance(1),c.ɵɵproperty("@toggleInputs",t.state),c.ɵɵadvance(1),c.ɵɵproperty("@openClose",void 0),c.ɵɵadvance(12),c.ɵɵproperty("ngForOf",t.termOption.label.localeValues),c.ɵɵadvance(4),c.ɵɵproperty("ngForOf",t.attribute.rootTerm.children),c.ɵɵadvance(3),c.ɵɵproperty("ngModel",t.termOption.code)("required",!!t.termOption.label||null),c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",t.termOption.label.localeValues),c.ɵɵadvance(2),c.ɵɵproperty("disabled",!t.isValid()))},directives:[u.ɵangular_packages_forms_forms_ba,u.NgControlStatusGroup,u.NgForm,g.NgIf,h.LocalizeComponent,g.NgForOf,u.DefaultValueAccessor,u.NgControlStatus,u.NgModel,u.RequiredValidator,f.ConvertKeyLabel,y.RouterLinkWithHref],styles:[".button-column[_ngcontent-%COMP%] {\n    text-align: right;\n}\n.button-column[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%] {\n    font-size: 25px;\n    color:#bababa;\n}\n.button-column[_ngcontent-%COMP%]   .fa.ico-remove[_ngcontent-%COMP%]:hover{\n    color: red;\n}\n.button-column[_ngcontent-%COMP%]   .fa.ico-edit[_ngcontent-%COMP%]:hover{\n    color:#00bfff\n}\n.button-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n    font-size: inherit;\n    height: 38px;\n}\n\n\nth.button-column-header[_ngcontent-%COMP%]{\n    text-align: right;\n}"],data:{animation:[i.trigger("toggleInputs",[i.state("none, void",i.style({opacity:0})),i.state("show",i.style({opacity:1})),i.transition("none => show",i.animate("300ms")),i.transition("show => none",i.animate("100ms"))]),i.trigger("openClose",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms",i.style({opacity:1}))]),i.transition(":leave",[i.style({opacity:1}),i.animate("0ms",i.style({opacity:0}))])])]}}),e}();t.ManageTermOptionsComponent=x,("undefined"==typeof ngDevMode||ngDevMode)&&c.ɵsetClassMetadata(x,[{type:r.Component,args:[{selector:"manage-term-options",templateUrl:"./manage-term-options.component.html",styleUrls:["./manage-term-options.css"],animations:[i.trigger("toggleInputs",[i.state("none, void",i.style({opacity:0})),i.state("show",i.style({opacity:1})),i.transition("none => show",i.animate("300ms")),i.transition("show => none",i.animate("100ms"))]),i.trigger("openClose",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms",i.style({opacity:1}))]),i.transition(":leave",[i.style({opacity:1}),i.animate("0ms",i.style({opacity:0}))])])]}]}],(function(){return[{type:d.BsModalRef},{type:c.ChangeDetectorRef},{type:p.GeoObjectTypeManagementService},{type:d.BsModalService},{type:m.LocalizationService},{type:m.ModalStepIndicatorService},{type:p.RegistryService}]}),{geoObjectType:[{type:r.Input}],attribute:[{type:r.Input}],attributeChange:[{type:r.Output}]})},574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditTermOptionInputComponent=void 0;var r=n(0),i=n(7),o=(n(30),n(16),n(111)),a=(n(203),n(258)),l=(n(518),n(0)),s=n(30),c=n(16),d=n(518),p=n(1),m=n(22),u=n(68),g=n(531);function h(e,t){if(1&e&&(l.ɵɵelementStart(0,"div",19),l.ɵɵtext(1),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext();l.ɵɵadvance(1),l.ɵɵtextInterpolate(n.message)}}var f=function(){function e(e,t,n,r,i){this.bsModalRef=e,this.modalStepIndicatorService=t,this.geoObjectTypeManagementService=n,this.localizeService=r,this.registryService=i,this.attribute=null,this.message=null,this.modalState={state:a.GeoObjectTypeModalStates.editAttribute,attribute:this.attribute,termOption:""},this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.attribute"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.term.options"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.term.option"),active:!0,enabled:!0}]}}return e.prototype.ngOnInit=function(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)},e.prototype.ngAfterViewInit=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.handleOnSubmit=function(){var e=this;this.registryService.updateAttributeTermTypeOption(this.attribute.rootTerm.code,this.termOption).then((function(t){var n=e.attribute.rootTerm.children.findIndex((function(e){return e.code===t.code}));-1!==n&&(e.attribute.rootTerm.children[n]=t),e.geoObjectTypeManagementService.setModalState({state:a.GeoObjectTypeModalStates.manageGeoObjectType,attribute:e.attribute,termOption:null})})).catch((function(t){e.error(t)}))},e.prototype.isFormValid=function(){return!0},e.prototype.cancel=function(){this.geoObjectTypeManagementService.setModalState({state:a.GeoObjectTypeModalStates.manageTermOption,attribute:this.attribute,termOption:null})},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(l.ɵɵdirectiveInject(s.BsModalRef),l.ɵɵdirectiveInject(c.ModalStepIndicatorService),l.ɵɵdirectiveInject(d.GeoObjectTypeManagementService),l.ɵɵdirectiveInject(c.LocalizationService),l.ɵɵdirectiveInject(d.RegistryService))},e.ɵcmp=l.ɵɵdefineComponent({type:e,selectors:[["edit-term-option-input"]],inputs:{geoObjectType:"geoObjectType",attribute:"attribute",termOption:"termOption"},decls:26,vars:5,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"modal-form",3,"ngSubmit"],["tForm","ngForm"],[1,""],[1,"heading"],["key","hierarchy.management.edit.term.option.title"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["type","text","name","code",3,"disabled","ngModel","ngModelChange"],["key","data.property.label.label",3,"value","valueChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.submit"],["role","alert",1,"alert","alert-danger"]],template:function(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",0),l.ɵɵtemplate(1,h,2,1,"div",1),l.ɵɵelementStart(2,"form",2,3),l.ɵɵlistener("ngSubmit",(function(){return l.ɵɵrestoreView(n),!l.ɵɵreference(3).invalid&&t.handleOnSubmit()})),l.ɵɵelementStart(4,"div",4),l.ɵɵelementStart(5,"div",4),l.ɵɵelementStart(6,"div",5),l.ɵɵelementStart(7,"h1"),l.ɵɵelement(8,"localize",6),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(9,"fieldset"),l.ɵɵelementStart(10,"div",7),l.ɵɵelementStart(11,"div",8),l.ɵɵelementStart(12,"label"),l.ɵɵelement(13,"localize",9),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(14,"div",10),l.ɵɵelementStart(15,"span",11),l.ɵɵelementStart(16,"input",12),l.ɵɵlistener("ngModelChange",(function(e){return t.termOption.code=e})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(17,"localized-input",13),l.ɵɵlistener("valueChange",(function(e){return t.termOption.label=e})),l.ɵɵelementEnd(),l.ɵɵelementStart(18,"div",7),l.ɵɵelement(19,"div",8),l.ɵɵelementStart(20,"div",10),l.ɵɵelementStart(21,"div",14),l.ɵɵelementStart(22,"button",15),l.ɵɵlistener("click",(function(){return t.cancel()})),l.ɵɵelement(23,"localize",16),l.ɵɵelementEnd(),l.ɵɵelementStart(24,"button",17),l.ɵɵelement(25,"localize",18),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵreference(3);l.ɵɵadvance(1),l.ɵɵproperty("ngIf",null!=t.message),l.ɵɵadvance(15),l.ɵɵproperty("disabled",!0)("ngModel",t.termOption.code),l.ɵɵadvance(1),l.ɵɵproperty("value",t.termOption.label),l.ɵɵadvance(7),l.ɵɵproperty("disabled",r.invalid)}},directives:[p.NgIf,m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,u.LocalizeComponent,m.DefaultValueAccessor,m.NgControlStatus,m.NgModel,g.LocalizedInputComponent],encapsulation:2,data:{animation:[i.trigger("openClose",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms",i.style({opacity:1}))]),i.transition(":leave",[i.style({opacity:1}),i.animate("0ms",i.style({opacity:0}))])])]}}),e}();t.EditTermOptionInputComponent=f,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(f,[{type:r.Component,args:[{selector:"edit-term-option-input",templateUrl:"./edit-term-option-input.component.html",styleUrls:[],animations:[i.trigger("openClose",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms",i.style({opacity:1}))]),i.transition(":leave",[i.style({opacity:1}),i.animate("0ms",i.style({opacity:0}))])])]}]}],(function(){return[{type:s.BsModalRef},{type:c.ModalStepIndicatorService},{type:d.GeoObjectTypeManagementService},{type:c.LocalizationService},{type:d.RegistryService}]}),{geoObjectType:[{type:r.Input}],attribute:[{type:r.Input}],termOption:[{type:r.Input}]})},575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SvgHierarchyType=void 0;var r=n(378),i=n(614),o=n(547),a=n(532),l=function(){function e(t,n,i,o,l,s,c){this.localizationService=l,this.modalService=s,this.authService=c;var d=i;this.hierarchyComponent=t,this.hierarchyType=d,this.svgEl=n,this.d3Hierarchy=r.hierarchy(d.rootGeoObjectTypes[0]),this.isPrimary=o,this.d3Tree=r.tree().nodeSize([e.gotRectW*a.TREE_SCALE_FACTOR_X,(e.gotRectH+e.gotHeaderH)*a.TREE_SCALE_FACTOR_Y]).separation((function(e,t){return.8}))(this.d3Hierarchy)}return e.prototype.getD3Tree=function(){return this.d3Tree},e.prototype.getCode=function(){return this.hierarchyType.code},e.prototype.getNodeByCode=function(e){var t=this.getD3Tree().find((function(t){return t.data.geoObjectType===e}));return null==t?null:new i.SvgHierarchyNode(this.hierarchyComponent,this,this.hierarchyComponent.findGeoObjectTypeByCode(e),t,this.localizationService,this.modalService,this.authService)},e.prototype.renderHierarchyHeader=function(t,n){var r=this,i=t.node().getBBox(),a=t.append("g").classed("g-hierarchy-header",!0),l=t.append("g").classed("g-hierarchy-header",!0),s=o.calculateTextWidth(this.hierarchyType.label.localizedValue,10),c=20,d=i.y+16;s>200&&(s=200,c=30,d=i.y+10);var p=i.width,m=s+20;m>p&&(p=m),l.append("text").classed("hierarchy-header-icon",!0).attr("x",i.x).attr("y",i.y).style("font-family","FontAwesome").attr("fill","grey").attr("font-size",12).text(""),a.append("foreignObject").classed("hierarchy-header-label",!0).attr("font-size",10).attr("stroke-linejoin","round").attr("stroke-width",3).attr("x",i.x+20).attr("y",d).attr("width",s).attr("height",c).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("text-anchor","start").attr("text-align","left").style("vertical-align","middle").style("display","table-cell").style("color","gray").style("height",e.gotRectH-4+"px").html((function(e){return r.hierarchyType.label.localizedValue})),l.append("line").classed("hierarchy-header-line",!0).attr("x1",i.x).attr("y1",i.y+10).attr("x2",i.x+p).attr("y2",i.y+10).attr("stroke","grey").attr("stroke-width",.5);var u=l.node().getBBox();return l.attr("transform","translate(0 -"+u.height+")"),a.append("text").classed("hierarchy-header-label",!0).attr("font-size",12).attr("font-weight","bold").attr("stroke-linejoin","round").attr("stroke-width",3).attr("fill","grey").attr("x",i.x).attr("y",i.y).text(n),a.attr("transform","translate(0 -"+2.5*u.height+")"),l},e.prototype.getRelatedHierarchies=function(e){var t=this.hierarchyComponent.findGeoObjectTypeByCode(e);null==t.relatedHierarchies&&(t.relatedHierarchies=this.hierarchyComponent.calculateRelatedHierarchies(t));for(var n=t.relatedHierarchies,r=null,i=0;i<n.length;++i)n[i]===this.getCode()&&(r=i);return null!=r&&n.splice(r,1),n},e.prototype.nodeMouseover=function(e,t,n){r.select("#NodeTooltip").style("opacity",1)},e.prototype.nodeMousemove=function(e,t,n){r.select("#hierarchyLabel").html(this.hierarchyType.label.localizedValue),r.select("#hierarchyCodeLabel").html(this.hierarchyType.code),r.select("#geoObjectTypeLabel").html(n.data.label),r.select("#geoObjectTypeCodeLabel").html(n.data.geoObjectType),r.select("#hierarchyOrganizationLabel").html(this.hierarchyComponent.findOrganizationByCode(this.hierarchyType.organizationCode).label.localizedValue),r.select("#geoObjectTypeOrganizationLabel").html(this.hierarchyComponent.findOrganizationByCode(this.hierarchyComponent.findGeoObjectTypeByCode(n.data.geoObjectType).organizationCode).label.localizedValue);var i=r.select("#NodeTooltip").node().getBoundingClientRect(),o={x:e.pageX,y:e.pageY};e.pageY+i.height+50>document.documentElement.scrollHeight&&(o.y=e.pageY-i.height-50),e.pageX+i.width+0>document.documentElement.scrollWidth&&(o.x=e.pageX-i.width-0),r.select("#NodeTooltip").style("left",o.x+"px").style("top",o.y+"px")},e.prototype.nodeMouseleave=function(e,t,n){r.select("#NodeTooltip").style("opacity",0).style("left","-10000px").style("top","-10000px")},e.prototype.render=function(){var t=this,n=this,i=this.d3Tree.descendants();r.select('.g-hierarchy[data-primary="false"]').remove(),this.isPrimary&&r.select('.g-hierarchy[data-primary="true"]').remove();var l=this.svgEl.insert("g",".g-hierarchy").classed("g-hierarchy",!0).attr("data-code",this.hierarchyType.code).attr("data-primary",this.isPrimary);l.attr("font-family","sans-serif");var s=l.append("g").classed("g-hierarchy-tree",!0).attr("data-code",this.hierarchyType.code);s.append("g").classed("g-got-edge",!0).attr("fill","none").attr("stroke","#555").attr("stroke-opacity",.4).attr("stroke-width",1.5).selectAll("path").data(this.d3Tree.links()).join("path").attr("d",(function(e,t){return"M"+e.source.x+","+e.source.y+"V"+(e.source.y+e.target.y)/2+"H"+e.target.x+"V"+e.target.y}));var c=s.append("g").classed("g-got-header",!0);c.selectAll("rect").data(i).join("rect").filter((function(e){return"GhostNode"!==e.data.geoObjectType})).classed("svg-got-header-rect",!0).attr("x",(function(t){return t.x-e.gotRectW/2})).attr("y",(function(t){return t.y-e.gotRectH/2-e.gotHeaderH+4})).attr("fill",(function(e){return t.isPrimary?null!=e.data.inheritedHierarchyCode?a.INHERITED_NODE_BANNER_COLOR:a.DEFAULT_NODE_BANNER_COLOR:a.RELATED_NODE_BANNER_COLOR})).attr("width",e.gotHeaderW).attr("height",e.gotHeaderH).attr("cursor",(function(e){return t.isPrimary?null!=e.data.inheritedHierarchyCode?null:"grab":null})).attr("rx",3).attr("data-gotCode",(function(e){return e.data.geoObjectType})).attr("data-inherited",(function(e){return null!=e.data.inheritedHierarchyCode})).on(e.MOUSE_HOVER_EVENT_ENTER,(function(e,t){n.nodeMouseover(e,this,t)})).on(e.MOUSE_HOVER_EVENT_MOVE,(function(e,t){n.nodeMousemove(e,this,t)})).on(e.MOUSE_HOVER_EVENT_EXIT,(function(e,t){n.nodeMouseleave(e,this,t)})),c.selectAll("foreignObject").data(i).join("foreignObject").filter((function(e){return"GhostNode"!==e.data.geoObjectType})).classed("svg-got-header-rect",!0).attr("x",(function(t){return t.x-e.gotHeaderW/2})).attr("y",(function(t){return t.y-e.gotRectH/2-e.gotHeaderH+4})).attr("font-size",e.gotHeaderFontSize+"px").attr("cursor",(function(e){return t.isPrimary?null!=e.data.inheritedHierarchyCode?null:"grab":null})).attr("data-gotCode",(function(e){return e.data.geoObjectType})).attr("data-inherited",(function(e){return null!=e.data.inheritedHierarchyCode})).attr("font-family","sans-serif").attr("font-weight","bold").attr("font-size",e.gotHeaderFontSize).attr("stroke-linejoin","round").attr("stroke-width",3).attr("width",e.gotHeaderW).attr("height",e.gotHeaderH-4).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("fill","white").attr("height",e.gotHeaderH-4).style("text-align","center").style("vertical-align","middle").style("display","table-cell").style("color","white").style("height",e.gotHeaderH-4+"px").style("width",e.gotHeaderW+"px").html((function(t){var r=null!=t.data.inheritedHierarchyCode?n.hierarchyComponent.findHierarchyByCode(t.data.inheritedHierarchyCode).label.localizedValue:n.hierarchyType.label.localizedValue;return!(o.calculateTextWidth(r,e.gotHeaderFontSize)>e.gotHeaderW-5)||(r=r.substring(0,34)+"..."),r})).on(e.MOUSE_HOVER_EVENT_ENTER,(function(e,t){n.nodeMouseover(e,this,t)})).on(e.MOUSE_HOVER_EVENT_MOVE,(function(e,t){n.nodeMousemove(e,this,t)})).on(e.MOUSE_HOVER_EVENT_EXIT,(function(e,t){n.nodeMouseleave(e,this,t)})),s.append("g").classed("g-got",!0).selectAll("rect").data(i).join("rect").filter((function(e){return"GhostNode"!==e.data.geoObjectType})).classed("svg-got-body-rect",!0).attr("x",(function(t){return t.x-e.gotRectW/2})).attr("y",(function(t){return t.y-e.gotRectH/2})).attr("fill",(function(e){return null!=e.data.inheritedHierarchyCode?a.INHERITED_NODE_FILL:a.DEFAULT_NODE_FILL})).attr("width",e.gotRectW).attr("height",e.gotRectH).attr("rx",3).attr("cursor",(function(e){return t.isPrimary?null!=e.data.inheritedHierarchyCode?null:"grab":null})).attr("data-gotCode",(function(e){return e.data.geoObjectType})).attr("data-inherited",(function(e){return null!=e.data.inheritedHierarchyCode})).each((function(t){"GhostNode"!==t.data.geoObjectType&&(t.data.activeDropZones?t.data.dropZoneBbox={x:t.x-e.gotRectW/2,y:t.y-2*e.gotRectH,width:2*e.gotRectW+100,height:4*e.gotRectH}:t.data.dropZoneBbox={x:t.x-e.gotRectW/2,y:t.y-e.gotRectH/2,width:e.gotRectW,height:e.gotRectH})})).on(e.MOUSE_HOVER_EVENT_ENTER,(function(e,t){n.nodeMouseover(e,this,t)})).on(e.MOUSE_HOVER_EVENT_MOVE,(function(e,t){n.nodeMousemove(e,this,t)})).on(e.MOUSE_HOVER_EVENT_EXIT,(function(e,t){n.nodeMouseleave(e,this,t)}));var d=7,p=10,m=s.append("g").classed("g-got-connector-arrow",!0);m.selectAll("rect").data(this.d3Tree.links()).join("rect").classed("got-connector-arrow-rect",!0).attr("x",(function(e){return e.source.x-p/2})).attr("y",(function(t){return t.source.y+e.gotRectH/2-d/2})).attr("width",p).attr("height",d).attr("fill",(function(e){return t.isPrimary?null!=e.source.data.inheritedHierarchyCode?a.INHERITED_NODE_BANNER_COLOR:a.DEFAULT_NODE_BANNER_COLOR:a.RELATED_NODE_BANNER_COLOR})),m.selectAll("path").data(this.d3Tree.links()).join("path").classed("got-connector-arrow-path",!0).attr("fill","none").attr("stroke","white").attr("stroke-width",1.5).attr("d",(function(t){return"M"+(t.source.x-p/2+2*p/3)+","+(t.source.y+e.gotRectH/2-d/2+2*d/3)+"L"+t.source.x+","+(t.source.y+e.gotRectH/2-d/2+d/3)+"L"+(t.source.x-p/2+p/3)+","+(t.source.y+e.gotRectH/2+d/2-d/3)})),s.append("g").classed("g-sibling-ghost-backer",!0).selectAll("rect").data(i).join("rect").filter((function(e){return"GhostNode"===e.data.geoObjectType})).classed("svg-sibling-ghost-backer-dz",!0).attr("x",(function(t){return t.x-e.gotRectW/2})).attr("y",(function(t){return t.y-e.gotRectH/2})).attr("width",e.gotRectW).attr("height",e.gotRectH).attr("fill","white"),s.append("g").classed("g-sibling-ghost-body",!0).selectAll("rect").data(i).join("rect").filter((function(e){return"GhostNode"===e.data.geoObjectType})).classed("svg-sibling-ghost-body-dz",!0).attr("x",(function(t){return t.x-e.gotRectW/2})).attr("y",(function(t){return t.y-e.gotRectH/2})).attr("width",e.gotRectW).attr("height",e.gotRectH).attr("fill","none").attr("stroke","#6BA542").attr("stroke-width","1").attr("stroke-dasharray","5,5").attr("data-gotCode",(function(e){return e.data.geoObjectType})),s.append("g").classed("g-got-codelabel",!0).attr("font-family","sans-serif").attr("font-size",e.gotBodyFontSize).attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("foreignObject").data(i).join("foreignObject").classed("svg-got-label-text",!0).attr("x",(function(t){return t.x-e.gotRectW/2+5})).attr("y",(function(t){return t.y-e.gotRectH/2+2})).attr("width",e.gotRectW-32+5).attr("height",e.gotRectH-4).attr("cursor",(function(e){return t.isPrimary?null!=e.data.inheritedHierarchyCode?null:"grab":null})).attr("data-gotCode",(function(e){return e.data.geoObjectType})).attr("data-inherited",(function(e){return null!=e.data.inheritedHierarchyCode})).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("text-anchor","start").attr("text-align","left").style("vertical-align","middle").style("display","table-cell").style("width",e.gotRectW-32+5+"px").style("height",e.gotRectH-4+"px").html((function(e){return e.data.label})).on(e.MOUSE_HOVER_EVENT_ENTER,(function(e,t){n.nodeMouseover(e,this,t)})).on(e.MOUSE_HOVER_EVENT_MOVE,(function(e,t){n.nodeMousemove(e,this,t)})).on(e.MOUSE_HOVER_EVENT_EXIT,(function(e,t){n.nodeMouseleave(e,this,t)})),this.isPrimary?(s.append("g").classed("g-got-relatedhiers-button",!0).selectAll("text").data(i).join("text").filter((function(e){return"GhostNode"!==e.data.geoObjectType&&null==e.data.inheritedHierarchyCode})).classed("svg-got-relatedhiers-button",!0).attr("data-gotCode",(function(e){return e.data.geoObjectType})).attr("x",(function(t){return t.x+e.gotRectW/2-e.gotOptionsButtonFontSize-3})).attr("y",(function(t){return t.y+.8*e.gotOptionsButtonFontSize-e.gotOptionsButtonFontSize/2})).style("font-family","FontAwesome").style("cursor","pointer").style("fill","#767676").style("font-size",e.gotOptionsButtonFontSize+"px").text("").on("click",(function(e,t){n.getNodeByCode(t.data.geoObjectType).renderRelatedHierarchiesMenu()})),this.renderHierarchyHeader(l,"Selected Hierarchy")):this.renderHierarchyHeader(l,"Related Hierarchy")},e.gotRectW=150,e.gotRectH=25,e.gotBodyFontSize=8,e.gotOptionsButtonFontSize=12,e.gotHeaderW=150,e.gotHeaderH=14,e.gotHeaderFontSize=8,e.MOUSE_HOVER_EVENT_ENTER="mouseenter",e.MOUSE_HOVER_EVENT_MOVE="mousemove",e.MOUSE_HOVER_EVENT_EXIT="mouseleave",e}();t.SvgHierarchyType=l},576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapefileModalComponent=void 0;var r=n(0),i=(n(30),n(30),n(33),n(16),n(111)),o=(n(518),n(0)),a=n(518),l=n(30),s=n(16),c=n(33),d=n(1),p=n(548),m=n(549),u=n(550),g=n(551);function h(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",3),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵtextInterpolate(n.message)}}function f(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"attributes-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function y(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"location-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function v(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"location-problem-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function b(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"term-problem-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function S(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵtemplate(1,f,2,1,"div",2),o.ɵɵtemplate(2,y,2,1,"div",2),o.ɵɵtemplate(3,v,2,1,"div",2),o.ɵɵtemplate(4,b,2,1,"div",2),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngIf","MAP"===n.state),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","LOCATION"===n.state),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","LOCATION-PROBLEM"===n.state),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","TERM-PROBLEM"===n.state)}}var C=function(){function e(e,t,n,r,i){this.service=e,this.bsModalRef=t,this.modalService=n,this.localizeService=r,this.router=i,this.message=null,this.state="MAP"}return e.prototype.ngOnInit=function(){},e.prototype.onStateChange=function(e){"BACK"===e?this.handleBack():"NEXT"===e?this.handleNext():"CANCEL"===e&&this.handleCancel()},e.prototype.handleBack=function(){"LOCATION"===this.state&&(this.state="MAP")},e.prototype.handleNext=function(){"MAP"===this.state?this.configuration.postalCode?this.handleSubmit():this.state="LOCATION":"LOCATION"===this.state?this.handleSubmit():"LOCATION-PROBLEM"===this.state?null!=this.configuration.termProblems?this.state="TERM-PROBLEM":this.handleSubmit():"TERM-PROBLEM"===this.state&&this.handleSubmit()},e.prototype.handleSubmit=function(){var e=this;this.message=null,this.service.importShapefile(this.configuration).then((function(t){null!=t.locationProblems?(e.state="LOCATION-PROBLEM",e.configuration=t):null!=t.termProblems?(e.state="TERM-PROBLEM",e.configuration=t):(e.bsModalRef.hide(),e.bsModalRef=e.modalService.show(i.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),e.bsModalRef.content.message=e.localizeService.decode("data.import.go.to.scheduled.jobs.confirm.message"),e.bsModalRef.content.submitText=e.localizeService.decode("data.import.go.to.scheduled.jobs.button"),e.bsModalRef.content.cancelText=e.localizeService.decode("modal.button.close"),e.bsModalRef.content.onConfirm.subscribe((function(t){e.router.navigate(["/registry/scheduled-jobs"])})))})).catch((function(t){e.error(t)}))},e.prototype.handleCancel=function(){var e=this;this.message=null,this.service.cancelImport(this.configuration).then((function(t){e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.error=function(e){this.message=i.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.IOService),o.ɵɵdirectiveInject(l.BsModalRef),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(s.LocalizationService),o.ɵɵdirectiveInject(c.Router))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["shapefile-modal"]],decls:3,vars:2,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[3,"configuration","configurationChange","stateChange"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵtemplate(1,h,2,1,"div",1),o.ɵɵtemplate(2,S,5,4,"div",2),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(1),o.ɵɵproperty("ngIf",null!=t.message),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",null!=t.configuration&&t.configuration))},directives:[d.NgIf,p.AttributesPageComponent,m.LocationPageComponent,u.LocationProblemPageComponent,g.TermProblemPageComponent],encapsulation:2}),e}();t.ShapefileModalComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"shapefile-modal",templateUrl:"./shapefile-modal.component.html",styleUrls:[]}]}],(function(){return[{type:a.IOService},{type:l.BsModalRef},{type:l.BsModalService},{type:s.LocalizationService},{type:c.Router}]}),null)},577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationProblemComponent=void 0;var r=n(0),i=n(31),o=(n(522),n(518),n(0)),a=n(518),l=n(22),s=n(1),c=n(154),d=n(68),p=n(113);function m(e,t){if(1&e&&(o.ɵɵelementStart(0,"li"),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(1),o.ɵɵtextInterpolate2("",n.label," (",n.type,")")}}function u(e,t){if(1&e&&(o.ɵɵelementStart(0,"ol"),o.ɵɵtemplate(1,m,2,2,"li",5),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",n.problem.context)}}var g=function(e){return{disabled:e}};function h(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"div",2),o.ɵɵelementStart(2,"input",6),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().entityLabel=e}))("typeaheadOnSelect",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().typeaheadOnSelect(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"div",7),o.ɵɵelementStart(4,"i",8),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().createSynonym()})),o.ɵɵpipe(5,"localize"),o.ɵɵelementEnd(),o.ɵɵelementStart(6,"i",9),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().ignoreDataAtLocation()})),o.ɵɵpipe(7,"localize"),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵadvance(2),o.ɵɵproperty("name",r.index+"-name")("ngModel",r.entityLabel)("typeaheadAsync",!0)("typeahead",r.dataSource)("typeaheadOptionsLimit",7),o.ɵɵadvance(2),o.ɵɵproperty("ngClass",o.ɵɵpureFunction1(12,g,!r.hasSynonym))("title",o.ɵɵpipeBind1(5,8,"dataUploader.createSynonymFromLocationTooltip")),o.ɵɵadvance(2),o.ɵɵproperty("title",o.ɵɵpipeBind1(7,10,"dataUploader.ignoreAtLocationTooltip"))}}function f(e,t){if(1&e&&(o.ɵɵelementStart(0,"li"),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(1),o.ɵɵtextInterpolate(n.label)}}function y(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",2),o.ɵɵelementStart(1,"a"),o.ɵɵelement(2,"i",12),o.ɵɵelement(3,"i",13),o.ɵɵelement(4,"localize",14),o.ɵɵtext(5),o.ɵɵelementEnd(),o.ɵɵelementStart(6,"span"),o.ɵɵelementStart(7,"ul"),o.ɵɵelement(8,"localize",15),o.ɵɵtemplate(9,f,2,1,"li",5),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext(2);o.ɵɵadvance(5),o.ɵɵtextInterpolate1(" [",n.problem.action.label,"] "),o.ɵɵadvance(4),o.ɵɵproperty("ngForOf",n.problem.action.ancestors)}}function v(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",2),o.ɵɵelement(1,"localize",16),o.ɵɵtext(2),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext(2);o.ɵɵadvance(2),o.ɵɵtextInterpolate1(" [",n.problem.action.label,"] ")}}function b(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵtemplate(1,y,10,2,"div",10),o.ɵɵtemplate(2,v,3,1,"div",10),o.ɵɵelementStart(3,"div",7),o.ɵɵelementStart(4,"i",11),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().undoAction()})),o.ɵɵpipe(5,"localize"),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngIf","SYNONYM"==r.problem.action.name),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","IGNOREATLOCATION"==r.problem.action.name),o.ɵɵadvance(2),o.ɵɵproperty("title",o.ɵɵpipeBind1(5,3,"dataUploader.undoFixedLocationTooltip"))}}var S=function(){function e(e){var t=this;this.service=e,this.onError=new r.EventEmitter,this.dataSource=i.Observable.create((function(e){t.service.getGeoObjectSuggestions(t.entityLabel,t.problem.type,t.problem.parent,t.configuration.hierarchy).then((function(t){e.next(t)}))}))}return e.prototype.ngOnInit=function(){this.entityLabel=null,this.entityId=null,this.hasSynonym=!1},e.prototype.typeaheadOnSelect=function(e){this.entityId=e.item.id,this.hasSynonym=null!=this.entityId},e.prototype.createSynonym=function(){var e=this;this.hasSynonym&&(this.onError.emit(null),this.service.createGeoObjectSynonym(this.entityId,this.problem.label).then((function(t){e.problem.resolved=!0,e.problem.action={name:"SYNONYM",synonymId:t.synonymId,vOid:t.vOid,label:t.label}})).catch((function(t){e.onError.emit(t.error)})))},e.prototype.ignoreDataAtLocation=function(){var e=this.problem.label;this.problem.type;this.problem.resolved=!0,this.problem.action={name:"IGNOREATLOCATION",label:e}},e.prototype.undoAction=function(){var e=this;this.problem.label,this.problem.type;if(this.problem.resolved){var t=this.problem.action;"IGNOREATLOCATION"==t.name?(this.problem.resolved=!1,this.problem.action=null):"SYNONYM"==t.name&&(this.onError.emit(null),this.service.deleteGeoObjectSynonym(t.synonymId,t.vOid).then((function(t){e.problem.resolved=!1,e.problem.action=null,e.entityLabel=null,e.hasSynonym=null!=e.entityLabel})).catch((function(t){e.onError.emit(t.error)})))}},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.IOService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["location-problem"]],inputs:{configuration:"configuration",problem:"problem",index:"index"},outputs:{onError:"onError"},decls:9,vars:5,consts:[[1,"row",2,"padding-bottom","10px"],["problemForm","ngForm"],[1,"col-sm-4"],[4,"ngIf"],[1,"col-sm-2","error-message"],[4,"ngFor","ngForOf"],["typeaheadOptionField","name",1,"form-control",3,"name","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","ngModelChange","typeaheadOnSelect"],[1,"col-sm-2"],[1,"fa","fa-2x","fa-compress","clickable",3,"ngClass","title","click"],[1,"fa","fa-2x","fa-times-circle","clickable",3,"title","click"],["class","col-sm-4",4,"ngIf"],[1,"fa","fa-2x","fa-undo","clickable",3,"title","click"],["aria-hidden","true",1,"fa","fa-caret-right","clickable"],["aria-hidden","true",1,"fa","fa-caret-down",2,"display","none"],["key","dataUploader.resolvedSynonym"],["key","dataUploader.locatedWithin"],["key","dataUploader.resolvedIgnoreAtLocation"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"form",null,1),o.ɵɵelementStart(3,"div",2),o.ɵɵtemplate(4,u,2,1,"ol",3),o.ɵɵelementEnd(),o.ɵɵelementStart(5,"div",4),o.ɵɵtext(6),o.ɵɵelementEnd(),o.ɵɵtemplate(7,h,8,14,"div",3),o.ɵɵtemplate(8,b,6,5,"div",3),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(4),o.ɵɵproperty("ngIf",t.problem.context.length>0),o.ɵɵadvance(2),o.ɵɵtextInterpolate2("",t.problem.label," (",t.problem.typeLabel,")"),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!t.problem.resolved),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.problem.resolved))},directives:[l.ɵangular_packages_forms_forms_ba,l.NgControlStatusGroup,l.NgForm,s.NgIf,s.NgForOf,l.DefaultValueAccessor,l.NgControlStatus,l.NgModel,c.TypeaheadDirective,s.NgClass,d.LocalizeComponent],pipes:[p.LocalizePipe],encapsulation:2}),e}();t.LocationProblemComponent=S,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(S,[{type:r.Component,args:[{selector:"location-problem",templateUrl:"./location-problem.component.html",styleUrls:[]}]}],(function(){return[{type:a.IOService}]}),{configuration:[{type:r.Input}],problem:[{type:r.Input}],index:[{type:r.Input}],onError:[{type:r.Output}]})},578:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermProblemComponent=void 0;var r=n(0),i=n(31),o=n(377),a=(n(522),n(518),n(0)),l=n(518),s=n(22),c=n(1),d=n(154),p=n(68),m=n(113),u=function(e){return{disabled:e}};function g(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div"),a.ɵɵelementStart(1,"div",2),a.ɵɵelementStart(2,"input",5),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().termLabel=e}))("typeaheadOnSelect",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().typeaheadOnSelect(e)})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(3,"div",6),a.ɵɵelementStart(4,"i",7),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().createSynonym()})),a.ɵɵpipe(5,"localize"),a.ɵɵelementEnd(),a.ɵɵelementStart(6,"i",8),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().createOption()})),a.ɵɵpipe(7,"localize"),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"i",9),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().ignoreValue()})),a.ɵɵpipe(9,"localize"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(2),a.ɵɵproperty("name",r.index+"-name")("ngModel",r.termLabel)("typeaheadAsync",!0)("typeahead",r.dataSource)("typeaheadOptionsLimit",7),a.ɵɵadvance(2),a.ɵɵproperty("ngClass",a.ɵɵpureFunction1(15,u,!r.hasSynonym))("title",a.ɵɵpipeBind1(5,9,"dataUploader.createSynonymCategoryTooltip")),a.ɵɵadvance(2),a.ɵɵproperty("title",a.ɵɵpipeBind1(7,11,"dataUploader.createNewOptionTooltip")),a.ɵɵadvance(2),a.ɵɵproperty("title",a.ɵɵpipeBind1(9,13,"dataUploader.ignoreCategoryTooltip"))}}function h(e,t){1&e&&(a.ɵɵelementStart(0,"div",2),a.ɵɵelement(1,"localize",12),a.ɵɵelementEnd())}function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",2),a.ɵɵelement(1,"localize",13),a.ɵɵtext(2),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext(2);a.ɵɵadvance(2),a.ɵɵtextInterpolate1(" [",n.problem.action.label,"] ")}}function y(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",2),a.ɵɵelement(1,"localize",14),a.ɵɵtext(2),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext(2);a.ɵɵadvance(2),a.ɵɵtextInterpolate1(" [",n.problem.label,"] ")}}function v(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div"),a.ɵɵtemplate(1,h,2,0,"div",10),a.ɵɵtemplate(2,f,3,1,"div",10),a.ɵɵtemplate(3,y,3,1,"div",10),a.ɵɵelementStart(4,"div",6),a.ɵɵelementStart(5,"i",11),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().undoAction()})),a.ɵɵpipe(6,"localize"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngIf","OPTION"==r.problem.action.name),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","SYNONYM"==r.problem.action.name),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","IGNORE"==r.problem.action.name),a.ɵɵadvance(2),a.ɵɵproperty("title",a.ɵɵpipeBind1(6,4,"dataUploader.undoFixedCategoryTooltip"))}}var b=function(){function e(e){var t=this;this.service=e,this.onError=new r.EventEmitter,this.dataSource=i.Observable.create((function(e){t.service.getTermSuggestions(t.problem.mdAttributeId,t.termLabel,"20").then((function(t){e.next(t)}))}))}return e.prototype.ngOnInit=function(){this.termLabel=null,this.termId=null,this.hasSynonym=!1},e.prototype.typeaheadOnSelect=function(e){this.termId=e.item.value,this.hasSynonym=null!=this.termId},e.prototype.createSynonym=function(){var e=this;this.hasSynonym&&(this.onError.emit(null),this.service.createTermSynonym(this.termId,this.problem.label).then((function(t){e.problem.resolved=!0,e.problem.action={name:"SYNONYM",synonymId:t.synonymId,label:t.label}})).catch((function(t){e.onError.emit(t.error)})))},e.prototype.createOption=function(){var e=this;this.onError.emit(null),this.service.createTerm(this.problem.label,o.v4(),this.problem.parentCode).then((function(t){e.problem.resolved=!0,e.problem.action={name:"OPTION",term:t}})).catch((function(t){e.onError.emit(t.error)}))},e.prototype.ignoreValue=function(){this.problem.resolved=!0,this.problem.action={name:"IGNORE"}},e.prototype.undoAction=function(){var e=this;if(this.problem.resolved){var t=this.problem.action;"IGNORE"==t.name?(this.problem.resolved=!1,this.problem.action=null):"SYNONYM"==t.name?(this.onError.emit(null),this.service.deleteTermSynonym(t.synonymId).then((function(t){e.problem.resolved=!1,e.problem.action=null})).catch((function(t){e.onError.emit(t.error)}))):"OPTION"==t.name&&(this.onError.emit(null),this.service.removeTerm(this.problem.parentCode,t.term.code).then((function(t){e.problem.resolved=!1,e.problem.action=null})).catch((function(t){e.onError.emit(t.error)})))}},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.IOService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["term-problem"]],inputs:{configuration:"configuration",problem:"problem",index:"index"},outputs:{onError:"onError"},decls:9,vars:4,consts:[[1,"row"],["problemForm","ngForm"],[1,"col-sm-4"],[1,"col-sm-2","error-message"],[4,"ngIf"],["typeaheadOptionField","label",1,"form-control",3,"name","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","ngModelChange","typeaheadOnSelect"],[1,"col-sm-2"],[1,"fa","fa-2x","fa-compress","clickable",3,"ngClass","title","click"],[1,"fa","fa-2x","fa-plus","clickable",3,"title","click"],[1,"fa","fa-2x","fa-times-circle","clickable",3,"title","click"],["class","col-sm-4",4,"ngIf"],[1,"fa","fa-2x","fa-undo","clickable",3,"title","click"],["key","dataUploader.resolvedCategoryOption"],["key","dataUploader.resolvedSynonym"],["key","dataUploader.resolvedIgnoreCategory"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵelementStart(1,"form",null,1),a.ɵɵelementStart(3,"div",2),a.ɵɵtext(4),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",3),a.ɵɵtext(6),a.ɵɵelementEnd(),a.ɵɵtemplate(7,g,10,17,"div",4),a.ɵɵtemplate(8,v,7,6,"div",4),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(4),a.ɵɵtextInterpolate(t.problem.attributeLabel),a.ɵɵadvance(2),a.ɵɵtextInterpolate(t.problem.label),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.problem.resolved),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.problem.resolved))},directives:[s.ɵangular_packages_forms_forms_ba,s.NgControlStatusGroup,s.NgForm,c.NgIf,s.DefaultValueAccessor,s.NgControlStatus,s.NgModel,d.TypeaheadDirective,c.NgClass,p.LocalizeComponent],pipes:[m.LocalizePipe],encapsulation:2}),e}();t.TermProblemComponent=b,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(b,[{type:r.Component,args:[{selector:"term-problem",templateUrl:"./term-problem.component.html",styleUrls:[]}]}],(function(){return[{type:l.IOService}]}),{configuration:[{type:r.Input}],problem:[{type:r.Input}],index:[{type:r.Input}],onError:[{type:r.Output}]})},579:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpreadsheetModalComponent=void 0;var r=n(0),i=(n(30),n(30),n(33),n(16),n(111)),o=(n(518),n(0)),a=n(518),l=n(30),s=n(16),c=n(33),d=n(1),p=n(548),m=n(549),u=n(550),g=n(551);function h(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",3),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵtextInterpolate(n.message)}}function f(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"attributes-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function y(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"location-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function v(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"location-problem-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function b(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"term-problem-page",4),o.ɵɵlistener("configurationChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).configuration=e}))("stateChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onStateChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(1),o.ɵɵproperty("configuration",r.configuration)}}function S(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵtemplate(1,f,2,1,"div",2),o.ɵɵtemplate(2,y,2,1,"div",2),o.ɵɵtemplate(3,v,2,1,"div",2),o.ɵɵtemplate(4,b,2,1,"div",2),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngIf","MAP"===n.state),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","LOCATION"===n.state),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","LOCATION-PROBLEM"===n.state),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","TERM-PROBLEM"===n.state)}}var C=function(){function e(e,t,n,r,i){this.service=e,this.bsModalRef=t,this.modalService=n,this.localizeService=r,this.router=i,this.message=null,this.state="MAP"}return e.prototype.ngOnInit=function(){},e.prototype.onStateChange=function(e){"BACK"===e?this.handleBack():"NEXT"===e?this.handleNext():"CANCEL"===e&&this.handleCancel()},e.prototype.handleBack=function(){"LOCATION"===this.state&&(this.state="MAP")},e.prototype.handleNext=function(){"MAP"===this.state?this.configuration.postalCode?this.handleSubmit():this.state="LOCATION":"LOCATION"===this.state?this.handleSubmit():"LOCATION-PROBLEM"===this.state?null!=this.configuration.termProblems?this.state="TERM-PROBLEM":this.handleSubmit():"TERM-PROBLEM"===this.state&&this.handleSubmit()},e.prototype.handleSubmit=function(){var e=this;this.service.importSpreadsheet(this.configuration).then((function(t){null!=t.locationProblems?(e.state="LOCATION-PROBLEM",e.configuration=t):null!=t.termProblems?(e.state="TERM-PROBLEM",e.configuration=t):(e.bsModalRef.hide(),e.bsModalRef=e.modalService.show(i.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),e.bsModalRef.content.message=e.localizeService.decode("data.import.go.to.scheduled.jobs.confirm.message"),e.bsModalRef.content.submitText=e.localizeService.decode("data.import.go.to.scheduled.jobs.button"),e.bsModalRef.content.onConfirm.subscribe((function(t){e.router.navigate(["/registry/scheduled-jobs"])})))})).catch((function(t){e.error(t)}))},e.prototype.handleCancel=function(){var e=this;this.service.cancelImport(this.configuration).then((function(t){e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.error=function(e){this.message=i.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.IOService),o.ɵɵdirectiveInject(l.BsModalRef),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(s.LocalizationService),o.ɵɵdirectiveInject(c.Router))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["spreadsheet-modal"]],decls:3,vars:2,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[3,"configuration","configurationChange","stateChange"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵtemplate(1,h,2,1,"div",1),o.ɵɵtemplate(2,S,5,4,"div",2),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(1),o.ɵɵproperty("ngIf",null!=t.message),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",null!=t.configuration&&t.configuration))},directives:[d.NgIf,p.AttributesPageComponent,m.LocationPageComponent,u.LocationProblemPageComponent,g.TermProblemPageComponent],encapsulation:2}),e}();t.SpreadsheetModalComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"spreadsheet-modal",templateUrl:"./spreadsheet-modal.component.html",styleUrls:[]}]}],(function(){return[{type:a.IOService},{type:l.BsModalRef},{type:l.BsModalService},{type:s.LocalizationService},{type:c.Router}]}),null)},580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataPageComponent=void 0;var r=n(0),i=(n(30),n(111)),o=(n(16),n(0)),a=n(16),l=n(30),s=n(122),c=n(86),d=n(1),p=n(33),m=n(68),u=n(581),g=function(e){return{active:e}};function h(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"a",9),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().renderContent("SPREADSHEET")})),o.ɵɵelement(1,"localize",10),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵproperty("ngClass",o.ɵɵpureFunction1(1,g,"SPREADSHEET"===r.content))}}function f(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"a",9),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().renderContent("SHAPEFILE")})),o.ɵɵelement(1,"localize",11),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵproperty("ngClass",o.ɵɵpureFunction1(1,g,"SHAPEFILE"===r.content))}}function y(e,t){1&e&&o.ɵɵelement(0,"dataimporter",12),2&e&&o.ɵɵproperty("format","EXCEL")}function v(e,t){1&e&&o.ɵɵelement(0,"dataimporter",12),2&e&&o.ɵɵproperty("format","SHAPEFILE")}var b=function(){function e(e,t,n){this.localizationService=e,this.modalService=t,this.service=n,this.content="SPREADSHEET",this.isAdmin=n.isAdmin(),this.isMaintainer=this.isAdmin||n.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||n.isContributer(),this.isMaintainer?this.renderContent("SPREADSHEET"):this.renderContent("EXPORT")}return e.prototype.ngOnInit=function(){},e.prototype.renderContent=function(e){this.content=e,"SPREADSHEET"===e?this.pageTitle=this.localizationService.decode("spreadsheet.title"):"SHAPEFILE"===e?this.pageTitle=this.localizationService.decode("shapefile.title"):"EXPORT"===e&&(this.pageTitle=this.localizationService.decode("io.export.title"))},e.prototype.error=function(e){this.bsModalRef=i.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.LocalizationService),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(a.AuthService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["data-page"]],decls:17,vars:5,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[1,"row"],[1,"col-md-1"],[1,"col-md-10",2,"padding-top","30px"],[1,"heading"],["style","margin-right:10px;font-size:20px;",3,"routerLink","ngClass","click",4,"ngIf"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[3,"format",4,"ngIf"],[2,"margin-right","10px","font-size","20px",3,"routerLink","ngClass","click"],["key","import-spreadsheet-localization-manager.menu"],["key","import-shapefile-localization-manager.menu"],[3,"format"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelement(1,"cgr-header"),o.ɵɵelement(2,"loading-bar"),o.ɵɵelementStart(3,"div",1),o.ɵɵelementStart(4,"div",2),o.ɵɵelement(5,"div",3),o.ɵɵelementStart(6,"div",4),o.ɵɵelementStart(7,"div",5),o.ɵɵelementStart(8,"h2"),o.ɵɵtext(9),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(10,"div"),o.ɵɵtemplate(11,h,2,3,"a",6),o.ɵɵtemplate(12,f,2,3,"a",6),o.ɵɵelementEnd(),o.ɵɵelementStart(13,"div",7),o.ɵɵtemplate(14,y,1,1,"dataimporter",8),o.ɵɵtemplate(15,v,1,1,"dataimporter",8),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelement(16,"div",3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(9),o.ɵɵtextInterpolate1(" ",t.pageTitle," "),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",t.isMaintainer),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.isMaintainer),o.ɵɵadvance(2),o.ɵɵproperty("ngIf","SPREADSHEET"===t.content),o.ɵɵadvance(1),o.ɵɵproperty("ngIf","SHAPEFILE"===t.content))},directives:[s.CgrHeaderComponent,c.LoadingBarComponent,d.NgIf,p.RouterLinkWithHref,d.NgClass,m.LocalizeComponent,u.DataImporterComponent],styles:["a.active[_ngcontent-%COMP%] {\n\tborder-bottom: solid 2px #6BA542;\n}"]}),e}();t.DataPageComponent=b,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(b,[{type:r.Component,args:[{selector:"data-page",templateUrl:"./data-page.component.html",styleUrls:["./data-page.css"]}]}],(function(){return[{type:a.LocalizationService},{type:l.BsModalService},{type:a.AuthService}]}),null)},581:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataImporterComponent=void 0;var r=n(0),i=(n(30),n(205)),o=n(111),a=(n(16),n(518),n(579)),l=n(576),s=n(258),c=n(0),d=n(518),p=n(16),m=n(30),u=n(1),g=n(68),h=n(22),f=n(261),y=n(262),v=n(205),b=["myFile"],S=["dateFieldComponents"],C=function(e){return{active:e}};function E(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"div"),c.ɵɵelementStart(2,"div",1),c.ɵɵelement(3,"div",2),c.ɵɵelementStart(4,"div",3),c.ɵɵelementStart(5,"label",4),c.ɵɵelementStart(6,"input",5),c.ɵɵlistener("change",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().setImportSource(e,"FILE")})),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"span",6),c.ɵɵelement(8,"localize",7),c.ɵɵelementEnd(),c.ɵɵelementStart(9,"p",8),c.ɵɵelement(10,"localize",9),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(11,"label",4),c.ɵɵelementStart(12,"input",5),c.ɵɵlistener("change",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().setImportSource(e,"EXTERNAL")})),c.ɵɵelementEnd(),c.ɵɵelementStart(13,"span",6),c.ɵɵelement(14,"localize",10),c.ɵɵelementEnd(),c.ɵɵelementStart(15,"p",8),c.ɵɵelement(16,"localize",11),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(17,"div",12),c.ɵɵelementStart(18,"button",13),c.ɵɵlistener("click",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().onNext()})),c.ɵɵelement(19,"localize",14),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(20,"div",15),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext();c.ɵɵadvance(6),c.ɵɵproperty("value",!0)("checked",!r.isExternal),c.ɵɵadvance(1),c.ɵɵproperty("ngClass",c.ɵɵpureFunction1(6,C,!r.isExternal)),c.ɵɵadvance(5),c.ɵɵproperty("value",!1)("checked",r.isExternal),c.ɵɵadvance(1),c.ɵɵproperty("ngClass",c.ɵɵpureFunction1(8,C,r.isExternal))}}function x(e,t){if(1&e&&(c.ɵɵelementStart(0,"option",48),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵpropertyInterpolate("value",n.oid),c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.label.localizedValue)}}function O(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",19),c.ɵɵelementStart(1,"label",45),c.ɵɵelement(2,"localize",46),c.ɵɵelementEnd(),c.ɵɵelementStart(3,"div",23),c.ɵɵelementStart(4,"select",47),c.ɵɵlistener("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).externalSystemId=e})),c.ɵɵtemplate(5,x,2,2,"option",25),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(6,"div",26),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2);c.ɵɵadvance(4),c.ɵɵproperty("ngModel",r.externalSystemId),c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",r.externalSystems)}}function I(e,t){if(1&e&&(c.ɵɵelementStart(0,"option",48),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵpropertyInterpolate("value",n.code),c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.label)}}function w(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",19),c.ɵɵelementStart(1,"label",49),c.ɵɵelement(2,"localize",50),c.ɵɵelementEnd(),c.ɵɵelementStart(3,"div",23),c.ɵɵelementStart(4,"select",51),c.ɵɵlistener("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).hierarchyCode=e}))("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onSelectHierarchy()})),c.ɵɵelement(5,"option"),c.ɵɵtemplate(6,I,2,2,"option",25),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(7,"div",26),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2);c.ɵɵadvance(4),c.ɵɵproperty("ngModel",r.hierarchyCode),c.ɵɵadvance(2),c.ɵɵproperty("ngForOf",r.filteredHierarchyViews)}}function M(e,t){if(1&e&&(c.ɵɵelementStart(0,"option",48),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵpropertyInterpolate("value",n.code),c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.super?n.super.label+" : "+n.label:n.label)}}function T(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",19),c.ɵɵelementStart(1,"label",52),c.ɵɵelement(2,"localize",53),c.ɵɵelementEnd(),c.ɵɵelementStart(3,"div",23),c.ɵɵelementStart(4,"select",54),c.ɵɵlistener("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).typeCode=e}))("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onSelectType()})),c.ɵɵelement(5,"option"),c.ɵɵtemplate(6,M,2,2,"option",25),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(7,"div",26),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2);c.ɵɵadvance(4),c.ɵɵproperty("ngModel",r.typeCode),c.ɵɵadvance(2),c.ɵɵproperty("ngForOf",r.filteredTypeViews)}}function j(e,t){1&e&&c.ɵɵelement(0,"localize",55)}function k(e,t){1&e&&c.ɵɵelement(0,"localize",56)}function R(e,t){if(1&e&&(c.ɵɵelementStart(0,"option",48),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵpropertyInterpolate("value",n.strategy),c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.label)}}function z(e,t){1&e&&c.ɵɵelement(0,"localize",57)}function P(e,t){1&e&&c.ɵɵelement(0,"localize",58)}function D(e,t){if(1&e&&c.ɵɵelement(0,"input",59,60),2&e){var n=c.ɵɵnextContext(2);c.ɵɵproperty("uploader",n.uploader)}}function A(e,t){if(1&e&&c.ɵɵelement(0,"input",61,60),2&e){var n=c.ɵɵnextContext(2);c.ɵɵproperty("uploader",n.uploader)}}function V(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"div"),c.ɵɵelementStart(2,"form",16,17),c.ɵɵtemplate(4,O,7,2,"div",18),c.ɵɵtemplate(5,w,8,2,"div",18),c.ɵɵtemplate(6,T,8,2,"div",18),c.ɵɵelementStart(7,"div",19),c.ɵɵelementStart(8,"label",20),c.ɵɵtemplate(9,j,1,0,"localize",21),c.ɵɵtemplate(10,k,1,0,"localize",22),c.ɵɵelementEnd(),c.ɵɵelementStart(11,"div",23),c.ɵɵelementStart(12,"select",24),c.ɵɵlistener("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().importStrategy=e}))("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().checkDates()})),c.ɵɵtemplate(13,R,2,2,"option",25),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(14,"div",26),c.ɵɵelementEnd(),c.ɵɵelementStart(15,"div",19),c.ɵɵelementStart(16,"label",27),c.ɵɵelement(17,"localize",28),c.ɵɵelementEnd(),c.ɵɵelementStart(18,"div",23),c.ɵɵelementStart(19,"date-field",29,30),c.ɵɵlistener("valueChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().startDate=e}))("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().checkDates()})),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(21,"div",26),c.ɵɵelementEnd(),c.ɵɵelementStart(22,"div",19),c.ɵɵelementStart(23,"label",31),c.ɵɵelement(24,"localize",32),c.ɵɵelementEnd(),c.ɵɵelementStart(25,"div",23),c.ɵɵelementStart(26,"date-field",33,30),c.ɵɵlistener("valueChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().endDate=e}))("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().checkDates()})),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(28,"div",26),c.ɵɵelementEnd(),c.ɵɵelementStart(29,"div",19),c.ɵɵelementStart(30,"label",34),c.ɵɵelement(31,"localize",35),c.ɵɵelementEnd(),c.ɵɵelementStart(32,"div",23),c.ɵɵelementStart(33,"boolean-field",36),c.ɵɵlistener("valueChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().copyBlank=e})),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(34,"div",26),c.ɵɵelementEnd(),c.ɵɵelementStart(35,"div",19),c.ɵɵelementStart(36,"label",37),c.ɵɵtemplate(37,z,1,0,"localize",38),c.ɵɵtemplate(38,P,1,0,"localize",39),c.ɵɵelementEnd(),c.ɵɵelementStart(39,"div",23),c.ɵɵtemplate(40,D,2,1,"input",40),c.ɵɵtemplate(41,A,2,1,"input",41),c.ɵɵelementEnd(),c.ɵɵelement(42,"div",26),c.ɵɵelementEnd(),c.ɵɵelementStart(43,"div",19),c.ɵɵelement(44,"div",26),c.ɵɵelementStart(45,"div",42),c.ɵɵelementStart(46,"button",43),c.ɵɵlistener("click",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().onClick()})),c.ɵɵelement(47,"localize",44),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelement(48,"div",26),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵreference(3),i=c.ɵɵnextContext();c.ɵɵadvance(4),c.ɵɵproperty("ngIf",i.isExternal),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",i.filteredHierarchyViews),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",i.filteredTypeViews),c.ɵɵadvance(3),c.ɵɵproperty("ngIf","EXCEL"===i.format),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","SHAPEFILE"===i.format),c.ɵɵadvance(2),c.ɵɵproperty("ngModel",i.importStrategy),c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",i.importStrategies),c.ɵɵadvance(6),c.ɵɵproperty("value",i.startDate)("inputName","startDate")("allowFutureDates",!1),c.ɵɵadvance(7),c.ɵɵproperty("value",i.endDate)("inputName","endDate")("allowInfinity",!0)("allowFutureDates",!0)("required",!0),c.ɵɵadvance(7),c.ɵɵproperty("value",i.copyBlank),c.ɵɵadvance(4),c.ɵɵproperty("ngIf","EXCEL"===i.format),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","SHAPEFILE"===i.format),c.ɵɵadvance(2),c.ɵɵproperty("ngIf","EXCEL"===i.format),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","SHAPEFILE"===i.format),c.ɵɵadvance(5),c.ɵɵproperty("disabled",!i.isValid||r.invalid)}}var N=function(){function e(e,t,n,r,i,o,a,l){this.service=e,this.eventService=t,this.modalService=n,this.localizationService=r,this.authService=i,this.sysService=o,this.hierarchyService=a,this.changeDetectorRef=l,this.currentDate=new Date,this.showImportConfig=!1,this.isValid=!1,this.importStrategies=[{strategy:s.ImportStrategy.NEW_AND_UPDATE,label:this.localizationService.decode("etl.import.ImportStrategy.NEW_AND_UPDATE")},{strategy:s.ImportStrategy.NEW_ONLY,label:this.localizationService.decode("etl.import.ImportStrategy.NEW_ONLY")},{strategy:s.ImportStrategy.UPDATE_ONLY,label:this.localizationService.decode("etl.import.ImportStrategy.UPDATE_ONLY")}],this.typeCode=null,this.hierarchyCode=null,this.startDate=null,this.endDate=null,this.isExternal=!1,this.isLoading=!0,this.copyBlank=!0}return e.prototype.ngOnInit=function(){var e=this;this.sysService.getExternalSystems(1,100).then((function(t){e.externalSystems=t.resultSet,0===e.externalSystems.length&&(e.isExternal=!1,e.showImportConfig=!0),e.isLoading=!1})).catch((function(t){e.error(t)})),this.hierarchyService.getHierarchyGroupedTypes().then((function(t){e.allHierarchyViews=t,e.allTypeViews=[];for(var n=e.allHierarchyViews.length,r=0;r<n;++r)for(var i=e.allHierarchyViews[r],o=i.types.length,a=function(t){for(var n=i.types[t],r=e.allHierarchyViews.length,o=0;o<r;++o){var a=e.allHierarchyViews[o],l=a.types.findIndex((function(e){return n.code===e.code}));-1!==l&&(a.types[l]=n)}},l=0;l<o;++l)a(l);var s=e.allHierarchyViews.length,c=function(t){for(var n=e.allHierarchyViews[t],r=n.types.length,i=function(t){var r=n.types[t],i=e.allTypeViews.findIndex((function(e){return e.code===r.code}));if(-1!==i){var o=e.allTypeViews[i];-1===o.hierarchies.findIndex((function(e){return e.code===n.code}))&&o.hierarchies.push(n)}else null==r.hierarchies&&(r.hierarchies=[]),r.hierarchies.push(n),e.allTypeViews.push(r)},o=0;o<r;++o)i(o)};for(r=0;r<s;++r)c(r);e.filteredHierarchyViews=e.allHierarchyViews,e.filteredTypeViews=e.allTypeViews})).catch((function(t){e.error(t)}));var t=acp+"/excel/get-configuration";"SHAPEFILE"===this.format&&(t=acp+"/shapefile/get-shapefile-configuration");var n={queueLimit:1,removeAfterUpload:!0,url:t};this.uploader=new i.FileUploader(n),this.uploader.onBuildItemForm=function(t,n){n.append("type",e.typeCode),n.append("copyBlank",e.copyBlank),null!=e.startDate&&n.append("startDate",e.startDate),null!=e.endDate&&n.append("endDate",e.endDate),e.importStrategy&&n.append("strategy",e.importStrategy)},this.uploader.onBeforeUploadItem=function(t){e.eventService.start()},this.uploader.onCompleteItem=function(t,n,r,i){e.fileRef.nativeElement.value="",e.eventService.complete()},this.uploader.onSuccessItem=function(t,n,r,i){var o=JSON.parse(n);o.isExternal=e.isExternal,o.hierarchy=e.hierarchyCode;for(var s=null,c=0;c<e.externalSystems.length;++c){var d=e.externalSystems[c];d.oid===e.externalSystemId&&(s=d)}o.externalSystemId=e.externalSystemId,o.externalSystem=s,"SHAPEFILE"===e.format?e.bsModalRef=e.modalService.show(l.ShapefileModalComponent,{backdrop:!0,ignoreBackdropClick:!0}):e.bsModalRef=e.modalService.show(a.SpreadsheetModalComponent,{backdrop:!0,ignoreBackdropClick:!0}),e.bsModalRef.content.configuration=o},this.uploader.onErrorItem=function(t,n,r,i){var o=JSON.parse(n);e.error({error:o})}},e.prototype.onSelectHierarchy=function(){for(var e=null,t=this.allHierarchyViews.length,n=0;n<t;++n)if(this.allHierarchyViews[n].code===this.hierarchyCode){e=this.allHierarchyViews[n];break}this.filteredTypeViews=null!=e?e.types:this.allTypeViews},e.prototype.onSelectType=function(){for(var e=null,t=this.allTypeViews.length,n=0;n<t;++n)if(this.allTypeViews[n].code===this.typeCode){e=this.allTypeViews[n];break}this.filteredHierarchyViews=null!=e?e.hierarchies:this.allHierarchyViews,this.checkDates()},e.prototype.onClick=function(){null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizationService.decode("io.missing.file"),error:{}})},e.prototype.setImportSource=function(e,t){this.isExternal="EXTERNAL"===t},e.prototype.onNext=function(){this.showImportConfig=!0},e.prototype.onBack=function(){this.showImportConfig=!1},e.prototype.checkDates=function(){var e=this;setTimeout((function(){e.isValid=e.checkDateFieldValidity()}),0)},e.prototype.checkDateFieldValidity=function(){for(var e,t=this.dateFieldComponentsArray.toArray(),n=0;n<t.length;n++){var r=t[n];if("startDate"===r.inputName&&(e=r),!r.valid)return!1}return this.startDate>this.endDate&&(e.setInvalid(this.localizationService.decode("date.input.startdate.after.enddate.error.message")),this.changeDetectorRef.detectChanges()),!0},e.prototype.error=function(e){this.bsModalRef=o.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(c.ɵɵdirectiveInject(d.IOService),c.ɵɵdirectiveInject(p.EventService),c.ɵɵdirectiveInject(m.BsModalService),c.ɵɵdirectiveInject(p.LocalizationService),c.ɵɵdirectiveInject(p.AuthService),c.ɵɵdirectiveInject(p.ExternalSystemService),c.ɵɵdirectiveInject(d.HierarchyService),c.ɵɵdirectiveInject(c.ChangeDetectorRef))},e.ɵcmp=c.ɵɵdefineComponent({type:e,selectors:[["dataimporter"]],viewQuery:function(e,t){if(1&e&&(c.ɵɵviewQuery(b,1),c.ɵɵviewQuery(S,1)),2&e){var n=void 0;c.ɵɵqueryRefresh(n=c.ɵɵloadQuery())&&(t.fileRef=n.first),c.ɵɵqueryRefresh(n=c.ɵɵloadQuery())&&(t.dateFieldComponentsArray=n)}},inputs:{format:"format"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],[1,"col-xs-1"],[1,"col-xs-9","radio-btn-wrapper"],[1,"radio"],["type","checkbox","name","import-source",3,"value","checked","change"],[3,"ngClass"],["key","importer.import.from-file.label"],[1,"radio-label-description"],["key","importer.import.from-file.description"],["key","importer.import.from-external.label"],["key","importer.import.from-external.description"],[1,"button-holder"],["type","submit",1,"btn","btn-primary",3,"click"],["key","io.next"],[1,"col-xs-2"],["autocomplete","off"],["form","ngForm"],["class","form-group row",4,"ngIf"],[1,"form-group","row"],["for","strategy",1,"col-md-2","text-right"],["key","spreadsheet.import.import.strategy",4,"ngIf"],["key","shapefile.import.import.strategy",4,"ngIf"],[1,"col-md-8"],["id","strategy","name","strategy","required","",1,"select-area",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["for","startDate",1,"col-md-2","text-right"],["key","io.startDate"],["label","",3,"value","inputName","allowFutureDates","valueChange","change"],["dateFieldComponents",""],["for","endDate",1,"col-md-2","text-right"],["key","io.endDate"],["label","",3,"value","inputName","allowInfinity","allowFutureDates","required","valueChange","change"],["for","copyBlank",1,"col-md-2","text-right"],["key","dataimporter.importblankcells"],["label","",3,"value","valueChange"],["for","file",1,"col-md-2","text-right"],["key","io.spreadsheet",4,"ngIf"],["key","io.shapefile",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".xls, .xlsx","required","",3,"uploader",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".zip","required","",3,"uploader",4,"ngIf"],[1,"button-holder","col-md-8","text-right"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"],["for","externalSystem",1,"col-md-2","text-right"],["key","io.import.externalSystems"],["id","externalSystem","name","externalSystem","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"value"],["for","hierarchyCode",1,"col-md-2","text-right"],["key","io.modal.hierarchy"],["id","hierarchyCode","name","hierarchyCode","required","",1,"select-area",3,"ngModel","ngModelChange","change"],["for","code",1,"col-md-2","text-right"],["key","io.geoObjectType"],["id","code","name","code","required","",1,"select-area",3,"ngModel","ngModelChange","change"],["key","spreadsheet.import.import.strategy"],["key","shapefile.import.import.strategy"],["key","io.spreadsheet"],["key","io.shapefile"],["name","file","type","file","ng2FileSelect","","accept",".xls, .xlsx","required","",1,"ghost-input",3,"uploader"],["myFile",""],["name","file","type","file","ng2FileSelect","","accept",".zip","required","",1,"ghost-input",3,"uploader"]],template:function(e,t){1&e&&(c.ɵɵtemplate(0,E,21,10,"div",0),c.ɵɵtemplate(1,V,49,21,"div",0)),2&e&&(c.ɵɵproperty("ngIf",!t.isLoading&&!t.showImportConfig&&t.externalSystems.length>0),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",!t.isLoading&&null!==t.isExternal&&t.showImportConfig))},directives:[u.NgIf,u.NgClass,g.LocalizeComponent,h.ɵangular_packages_forms_forms_ba,h.NgControlStatusGroup,h.NgForm,h.SelectControlValueAccessor,h.RequiredValidator,h.NgControlStatus,h.NgModel,u.NgForOf,f.DateFieldComponent,y.BooleanFieldComponent,h.NgSelectOption,h.ɵangular_packages_forms_forms_z,v.FileSelectDirective],styles:[".radio-btn-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n\tfont-size: 17px;\n\tfont-weight: normal;\n}\n\n.radio-btn-wrapper[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%] {\n\tcolor: #6BA542;\n\tfont-weight: bold;\n}\n\n.radio-btn-wrapper[_ngcontent-%COMP%]   p.radio-label-description[_ngcontent-%COMP%]{\n\tcolor: #a3a0a0;\n\tmargin-left: 30px;\n}"]}),e}();t.DataImporterComponent=N,("undefined"==typeof ngDevMode||ngDevMode)&&c.ɵsetClassMetadata(N,[{type:r.Component,args:[{selector:"dataimporter",templateUrl:"./dataimporter.component.html",styleUrls:["./dataimporter.css"]}]}],(function(){return[{type:d.IOService},{type:p.EventService},{type:m.BsModalService},{type:p.LocalizationService},{type:p.AuthService},{type:p.ExternalSystemService},{type:d.HierarchyService},{type:c.ChangeDetectorRef}]}),{dateFieldComponentsArray:[{type:r.ViewChildren,args:["dateFieldComponents"]}],fileRef:[{type:r.ViewChild,args:["myFile"]}],format:[{type:r.Input}]})},582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MasterListManagerComponent=void 0;var r=n(0),i=(n(33),n(30),n(518),n(528)),o=n(111),a=(n(16),n(0)),l=n(518),s=n(30),c=n(33),d=n(16),p=n(122),m=n(86),u=n(68),g=n(1);function h(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",6),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function f(e,t){1&e&&(a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",10),a.ɵɵelementStart(2,"div",11),a.ɵɵelementStart(3,"p",17),a.ɵɵelement(4,"localize",18),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd())}function y(e,t){1&e&&(a.ɵɵelementStart(0,"span"),a.ɵɵelement(1,"localize",35),a.ɵɵelementEnd())}function v(e,t){1&e&&a.ɵɵelement(0,"localize",36)}function b(e,t){1&e&&a.ɵɵelement(0,"localize",37)}function S(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",38),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext().$implicit,t=a.ɵɵnextContext(2).$implicit;return a.ɵɵnextContext().onDelete(t,e)})),a.ɵɵelement(1,"localize",39),a.ɵɵelementEnd()}}function C(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"tr",24),a.ɵɵelementStart(1,"td",25),a.ɵɵelementStart(2,"a",26),a.ɵɵtext(3),a.ɵɵtemplate(4,y,2,0,"span",16),a.ɵɵelementStart(5,"span"),a.ɵɵtext(6," ( "),a.ɵɵtemplate(7,v,1,0,"localize",27),a.ɵɵtemplate(8,b,1,0,"localize",28),a.ɵɵtext(9," ) "),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(10,"td",29),a.ɵɵelementStart(11,"button",30),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=t.$implicit;return a.ɵɵnextContext(3).onView(e.oid)})),a.ɵɵelement(12,"localize",31),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"button",32),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=t.$implicit;return a.ɵɵnextContext(3).onEdit(e)})),a.ɵɵelement(14,"localize",33),a.ɵɵelementEnd(),a.ɵɵtemplate(15,S,2,0,"button",34),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=t.$implicit;a.ɵɵadvance(2),a.ɵɵproperty("routerLink","/registry/master-list-view/"+r.oid),a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",r.label," "),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.isMaster),a.ɵɵadvance(3),a.ɵɵproperty("ngIf","PUBLIC"===r.visibility),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","PRIVATE"===r.visibility),a.ɵɵadvance(7),a.ɵɵproperty("ngIf",r.write)}}function E(e,t){if(1&e&&(a.ɵɵelementStart(0,"ul",19),a.ɵɵelementStart(1,"table",20),a.ɵɵelementStart(2,"thead"),a.ɵɵelementStart(3,"tr"),a.ɵɵelementStart(4,"th",21),a.ɵɵelement(5,"localize",22),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(6,"tbody"),a.ɵɵtemplate(7,C,16,6,"tr",23),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(7),a.ɵɵproperty("ngForOf",n.lists)}}function x(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div"),a.ɵɵelementStart(1,"button",30),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext().$implicit;return a.ɵɵnextContext().onCreate(e)})),a.ɵɵelement(2,"localize",40),a.ɵɵelementEnd(),a.ɵɵelementEnd()}}function O(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"div",9),a.ɵɵelementStart(3,"div",10),a.ɵɵelementStart(4,"div",11),a.ɵɵelementStart(5,"h3"),a.ɵɵtext(6),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(7,f,5,0,"div",12),a.ɵɵtemplate(8,E,8,1,"ul",13),a.ɵɵelementStart(9,"div",14),a.ɵɵelementStart(10,"div",15),a.ɵɵtemplate(11,x,3,0,"div",16),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵadvance(6),a.ɵɵtextInterpolate(n.label),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.lists&&0===n.lists.length),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.lists&&n.lists.length>0),a.ɵɵadvance(3),a.ɵɵproperty("ngIf",n.write)}}var I=function(){function e(e,t,n,r){this.service=e,this.modalService=t,this.router=n,this.localizeService=r,this.message=null}return e.prototype.ngOnInit=function(){var e=this;this.service.getMasterListsByOrg().then((function(t){e.orgs=t.orgs})).catch((function(t){e.error(t)}))},e.prototype.onCreate=function(e){this.bsModalRef=this.modalService.show(i.PublishModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(e),this.bsModalRef.content.isNew=!0,this.bsModalRef.content.onMasterListChange.subscribe((function(t){var n={label:t.displayLabel.localizedValue,oid:t.oid,createDate:t.createDate,lastUpdateDate:t.lastUpdateDate,isMaster:t.isMaster,write:t.write,read:t.read,visibility:t.visibility};e.lists.push(n)}))},e.prototype.onView=function(e){this.router.navigate(["/registry/master-list-view/",e])},e.prototype.onEdit=function(e){var t=this;this.service.getMasterList(e.oid).then((function(n){t.bsModalRef=t.modalService.show(i.PublishModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),t.bsModalRef.content.edit=!0,t.bsModalRef.content.readonly=!n.write,t.bsModalRef.content.master=n,t.bsModalRef.content.isNew=!1,t.bsModalRef.content.onMasterListChange.subscribe((function(t){e.label=t.displayLabel.localizedValue,e.visibility=t.visibility}))})).catch((function(e){t.error(e)}))},e.prototype.onDelete=function(e,t){var n=this;this.bsModalRef=this.modalService.show(o.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+t.label+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe((function(r){n.service.deleteMasterList(t.oid).then((function(n){e.lists=e.lists.filter((function(e,n,r){return e.oid!==t.oid}))})).catch((function(e){n.error(e)}))}))},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(s.BsModalService),a.ɵɵdirectiveInject(c.Router),a.ɵɵdirectiveInject(d.LocalizationService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["master-list-manager"]],decls:9,vars:2,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[1,"heading"],["key","masterlists.manager.organizations"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row",4,"ngFor","ngForOf"],["role","alert",1,"alert","alert-danger"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"row",2,"margin-top","30px"],[1,"col-md-12"],[1,"py-5"],["class","row",4,"ngIf"],["class","list-group","style","border-bottom: 2px solid lightgrey; margin-top: 30px;",4,"ngIf"],[1,"row",2,"margin-top","30px","margin-bottom","30px"],[1,"col-md-6"],[4,"ngIf"],[1,"inline-message"],["key","masterlists.no.lists.in.org.message"],[1,"list-group",2,"border-bottom","2px solid lightgrey","margin-top","30px"],[1,"table"],[2,"width","70%"],["key","masterlist.menu"],["class","clickable",4,"ngFor","ngForOf"],[1,"clickable"],[2,"width","70%","vertical-align","middle"],["routerLinkActive","active",3,"routerLink"],["key","masterlist.public",4,"ngIf"],["key","masterlist.private",4,"ngIf"],[2,"width","30%","text-align","right"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","modal.button.view"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","masterlist.button.metadata"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],["key","masterlist.master"],["key","masterlist.public"],["key","masterlist.private"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","modal.button.delete"],["key","hierarchy.management.button.create"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵelement(1,"cgr-header"),a.ɵɵelement(2,"loading-bar"),a.ɵɵelementStart(3,"div",1),a.ɵɵelementStart(4,"div",2),a.ɵɵelementStart(5,"h2"),a.ɵɵelement(6,"localize",3),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(7,h,2,1,"div",4),a.ɵɵtemplate(8,O,12,4,"div",5),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(7),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(1),a.ɵɵproperty("ngForOf",t.orgs))},directives:[p.CgrHeaderComponent,m.LoadingBarComponent,u.LocalizeComponent,g.NgIf,g.NgForOf,c.RouterLinkWithHref,c.RouterLinkActive],styles:[""]}),e}();t.MasterListManagerComponent=I,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(I,[{type:r.Component,args:[{selector:"master-list-manager",templateUrl:"./master-list-manager.component.html",styleUrls:["./master-list-manager.css"]}]}],(function(){return[{type:l.RegistryService},{type:s.BsModalService},{type:c.Router},{type:d.LocalizationService}]}),null)},583:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExportFormatModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(0),a=n(30),l=n(68),s=n(22),c=function(){function e(e){this.bsModalRef=e}return e.prototype.ngOnInit=function(){this.onFormat=new i.Subject},e.prototype.confirm=function(){this.bsModalRef.hide(),this.onFormat.next(this.format)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.BsModalRef))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["export-format-modal"]],decls:25,vars:2,consts:[["tabindex","-1","role","dialog",1,"modal-body"],[1,"heading","text-center"],["key","export-modal.title"],["name","export-form",1,"modal-form"],[1,"row"],[1,"col-md-12"],["key","export-modal.message"],["id","format","name","format","required","",1,"select-area",3,"ngModel","ngModelChange"],["value","EXCEL"],["key","io.spreadsheet"],["value","SHAPEFILE"],["key","io.shapefile"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"div",1),o.ɵɵelementStart(2,"h1"),o.ɵɵelement(3,"localize",2),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"form",3),o.ɵɵelementStart(5,"fieldset"),o.ɵɵelementStart(6,"div",4),o.ɵɵelementStart(7,"div",5),o.ɵɵelementStart(8,"label"),o.ɵɵelement(9,"localize",6),o.ɵɵelementEnd(),o.ɵɵelementStart(10,"select",7),o.ɵɵlistener("ngModelChange",(function(e){return t.format=e})),o.ɵɵelement(11,"option"),o.ɵɵelementStart(12,"option",8),o.ɵɵelement(13,"localize",9),o.ɵɵelementEnd(),o.ɵɵelementStart(14,"option",10),o.ɵɵelement(15,"localize",11),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(16,"div",4),o.ɵɵelementStart(17,"div",5),o.ɵɵelementStart(18,"div",12),o.ɵɵelementStart(19,"button",13),o.ɵɵlistener("click",(function(){return t.bsModalRef.hide()})),o.ɵɵelementStart(20,"span"),o.ɵɵelement(21,"localize",14),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(22,"button",15),o.ɵɵlistener("click",(function(){return t.confirm()})),o.ɵɵelementStart(23,"span"),o.ɵɵelement(24,"localize",16),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(10),o.ɵɵproperty("ngModel",t.format),o.ɵɵadvance(12),o.ɵɵproperty("disabled",null==t.format||""==t.format))},directives:[l.LocalizeComponent,s.ɵangular_packages_forms_forms_ba,s.NgControlStatusGroup,s.NgForm,s.SelectControlValueAccessor,s.RequiredValidator,s.NgControlStatus,s.NgModel,s.NgSelectOption,s.ɵangular_packages_forms_forms_z],encapsulation:2}),e}();t.ExportFormatModalComponent=c,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(c,[{type:r.Component,args:[{selector:"export-format-modal",templateUrl:"./export-format-modal.component.html",styleUrls:[]}]}],(function(){return[{type:a.BsModalRef}]}),null)},584:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestTableComponent=void 0;var r=n(0),i=(n(33),n(30),n(7)),o=n(205),a=n(258),l=(n(518),n(16),n(112),n(111)),s=n(0),c=n(518),d=n(30),p=n(16),m=n(33),u=n(112),g=n(1),h=n(68),f=n(22),y=n(529),v=n(205),b=n(204),S=n(113),C=["myFile"];function E(e,t){1&e&&(s.ɵɵelementStart(0,"h4",35),s.ɵɵelement(1,"localize",44),s.ɵɵelementEnd())}function x(e,t){1&e&&(s.ɵɵelementStart(0,"h4",35),s.ɵɵelement(1,"localize",45),s.ɵɵelementEnd())}function O(e,t){1&e&&(s.ɵɵelementStart(0,"div",46),s.ɵɵelement(1,"localize",47),s.ɵɵelementEnd())}function I(e,t){1&e&&(s.ɵɵelementStart(0,"div",46),s.ɵɵelement(1,"localize",48),s.ɵɵelementEnd())}function w(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",49),s.ɵɵelementStart(1,"label",50),s.ɵɵelement(2,"localize",51),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"textarea",52),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(2).$implicit.contributorNotes=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(2).$implicit;s.ɵɵadvance(1),s.ɵɵpropertyInterpolate1("for","contribNotesInput-",r.oid,""),s.ɵɵadvance(2),s.ɵɵpropertyInterpolate1("id","contribNotesInput-",r.oid,""),s.ɵɵproperty("ngModel",r.contributorNotes)("disabled",!r.permissions.includes("WRITE_DETAILS"))}}function M(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"geoobject-shared-attribute-editor",65,66),s.ɵɵlistener("valid",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(4).setValid(e)})),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(3).$implicit,i=s.ɵɵnextContext();s.ɵɵproperty("readOnly",!i.canEdit(r))("geoObjectType",r.current.geoObjectType)("postGeoObject","UpdateGeoObject"==r.type?r.current.geoObject:r.actions[0].geoObjectJson)("changeRequest",r)("hierarchies","UpdateGeoObject"==r.type?r.current.hierarchies:r.actions[0].parentJson)("isGeometryInlined",!0)("isNew","CreateGeoObject"===r.type)}}function T(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",67),s.ɵɵelementStart(1,"label",50),s.ɵɵelement(2,"localize",68),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"textarea",69),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(3).$implicit.maintainerNotes=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(3).$implicit;s.ɵɵadvance(1),s.ɵɵpropertyInterpolate1("for","maintainerNotesInput-",r.oid,""),s.ɵɵadvance(2),s.ɵɵpropertyInterpolate1("id","maintainerNotesInput-",r.oid,""),s.ɵɵproperty("ngModel",r.maintainerNotes)("disabled",!r.permissions.includes("WRITE_MAINTAINER_NOTES"))}}function j(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",67),s.ɵɵelementStart(1,"label",50),s.ɵɵelement(2,"localize",70),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"input",71),s.ɵɵlistener("ngModelChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext(3).$implicit.additionalNotes=e})),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(3).$implicit;s.ɵɵadvance(1),s.ɵɵpropertyInterpolate1("for","additionalNotes-",r.oid,""),s.ɵɵadvance(2),s.ɵɵpropertyInterpolate1("id","additionalNotes-",r.oid,""),s.ɵɵproperty("ngModel",r.additionalNotes)("disabled",!r.permissions.includes("WRITE_MAINTAINER_NOTES"))}}function k(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"li",75),s.ɵɵelementStart(1,"a",76),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=t.$implicit,r=s.ɵɵnextContext(4).$implicit;return s.ɵɵnextContext().onDownloadFile(r,e.oid)})),s.ɵɵtext(2),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"i",77),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=t.$implicit,r=s.ɵɵnextContext(4).$implicit;return s.ɵɵnextContext().onDeleteFile(r,e.oid)})),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=t.$implicit;s.ɵɵadvance(2),s.ɵɵtextInterpolate(r.fileName)}}function R(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",72),s.ɵɵelementStart(1,"ul",73),s.ɵɵtemplate(2,k,4,1,"li",74),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext(3).$implicit;s.ɵɵadvance(2),s.ɵɵproperty("ngForOf",n.documents)}}function z(e,t){1&e&&(s.ɵɵelementStart(0,"p",78),s.ɵɵelement(1,"localize",79),s.ɵɵelementEnd())}function P(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",80),s.ɵɵelement(1,"input",81,82),s.ɵɵelementStart(3,"button",83),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=s.ɵɵnextContext(3).$implicit;return s.ɵɵnextContext().onUpload(e)})),s.ɵɵpipe(4,"localize"),s.ɵɵelement(5,"localize",84),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(4);s.ɵɵadvance(1),s.ɵɵproperty("uploader",r.uploader),s.ɵɵadvance(2),s.ɵɵproperty("title",s.ɵɵpipeBind1(4,2,"change.request.upload.document.btn.hover"))}}function D(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"button",90),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=s.ɵɵnextContext(5).$implicit;return s.ɵɵnextContext().onReject(e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelement(2,"localize",91),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(5).$implicit;s.ɵɵproperty("disabled","PENDING"!==r.approvalStatus)("title",s.ɵɵpipeBind1(1,2,"change.request.reject.all.btn.hover"))}}function A(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"span"),s.ɵɵelementStart(1,"button",87),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=s.ɵɵnextContext(4).$implicit;return s.ɵɵnextContext().onExecute(e)})),s.ɵɵpipe(2,"localize"),s.ɵɵelement(3,"localize",88),s.ɵɵelementEnd(),s.ɵɵtemplate(4,D,3,4,"button",89),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(4).$implicit;s.ɵɵadvance(1),s.ɵɵproperty("disabled","PENDING"!==r.approvalStatus)("title",s.ɵɵpipeBind1(2,4,"change.request.implement.decisions.btn.hover")),s.ɵɵadvance(2),s.ɵɵproperty("key","UpdateGeoObject"===r.type?"change.request.accept.changes.btn":"change.request.accept.newGeoObject.btn"),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","CreateGeoObject"===r.type)}}function V(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"button",96),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext(6).onEditAttributes()})),s.ɵɵelement(1,"localize",97),s.ɵɵelementEnd()}}function N(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"button",98),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext(6).onEditAttributes()})),s.ɵɵelement(1,"localize",99),s.ɵɵelementEnd()}}function L(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"button",100),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=s.ɵɵnextContext(5).$implicit;return s.ɵɵnextContext().onUpdate(e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelement(2,"localize",101),s.ɵɵelementEnd()}2&e&&s.ɵɵproperty("title",s.ɵɵpipeBind1(1,1,"modal.button.update"))}function _(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"button",102),s.ɵɵlistener("click",(function(){s.ɵɵrestoreView(n);var e=s.ɵɵnextContext(5).$implicit;return s.ɵɵnextContext().onDelete(e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelement(2,"localize",103),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext(6);s.ɵɵproperty("disabled",!r.isEditing)("title",s.ɵɵpipeBind1(1,2,"change.request.delete.request.hover"))}}function F(e,t){if(1&e&&(s.ɵɵelementStart(0,"span"),s.ɵɵtemplate(1,V,2,0,"button",92),s.ɵɵtemplate(2,N,2,0,"button",93),s.ɵɵtemplate(3,L,3,3,"button",94),s.ɵɵtemplate(4,_,3,4,"button",95),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext(4).$implicit,r=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵproperty("ngIf",!r.isEditing),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",r.isEditing),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",r.isEditing),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.permissions.includes("DELETE")&&n.createdBy===r.getUsername())}}function H(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",85),s.ɵɵtemplate(1,A,5,6,"span",86),s.ɵɵtemplate(2,F,5,4,"span",86),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext(3).$implicit,r=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.permissions.includes("WRITE_APPROVAL_STATUS")),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",r.isValid&&n.permissions.includes("WRITE_DETAILS")&&n.createdBy===r.getUsername())}}function G(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",53),s.ɵɵelementStart(1,"div",54),s.ɵɵelementStart(2,"div",55),s.ɵɵelementStart(3,"div",1),s.ɵɵtemplate(4,M,2,7,"geoobject-shared-attribute-editor",56),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(5,"div",57),s.ɵɵelementStart(6,"div",58),s.ɵɵtemplate(7,T,4,4,"div",59),s.ɵɵtemplate(8,j,4,4,"div",59),s.ɵɵelementEnd(),s.ɵɵelementStart(9,"div",58),s.ɵɵelementStart(10,"div"),s.ɵɵelementStart(11,"label"),s.ɵɵelement(12,"localize",60),s.ɵɵelementEnd(),s.ɵɵtemplate(13,R,3,1,"div",61),s.ɵɵtemplate(14,z,2,0,"p",62),s.ɵɵtemplate(15,P,6,4,"div",63),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵtemplate(16,H,3,2,"div",64),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext(2).$implicit,r=s.ɵɵnextContext();s.ɵɵadvance(4),s.ɵɵproperty("ngIf",n),s.ɵɵadvance(3),s.ɵɵproperty("ngIf",n.permissions.includes("READ_MAINTAINER_NOTES")),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.permissions.includes("READ_MAINTAINER_NOTES")),s.ɵɵadvance(5),s.ɵɵproperty("ngIf",n.documents.length>0),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",0===n.documents.length),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.permissions.includes("WRITE_DOCUMENTS")&&r.isEditing),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.permissions.includes("WRITE_APPROVAL_STATUS")||n.permissions.includes("DELETE"))}}var q=function(e,t,n,r){return{"status-pending-container":e,"status-accepted-container":t,"status-partial-container":n,"status-rejected-container":r}};function B(e,t){if(1&e&&(s.ɵɵelementStart(0,"tr",31),s.ɵɵelementStart(1,"td",32),s.ɵɵelementStart(2,"div",33),s.ɵɵelementStart(3,"div"),s.ɵɵelementStart(4,"h3",34),s.ɵɵtext(5),s.ɵɵelementEnd(),s.ɵɵelementStart(6,"h4",35),s.ɵɵtext(7),s.ɵɵelementEnd(),s.ɵɵtemplate(8,E,2,0,"h4",36),s.ɵɵtemplate(9,x,2,0,"h4",36),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(10,"div",37),s.ɵɵelementStart(11,"div",1),s.ɵɵtemplate(12,O,2,0,"div",38),s.ɵɵtemplate(13,I,2,0,"div",38),s.ɵɵtemplate(14,w,4,4,"div",39),s.ɵɵelementStart(15,"div"),s.ɵɵelementStart(16,"p"),s.ɵɵelement(17,"localize",40),s.ɵɵtext(18," "),s.ɵɵelementStart(19,"strong"),s.ɵɵtext(20),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(21,"p"),s.ɵɵelement(22,"localize",41),s.ɵɵtext(23," "),s.ɵɵelementStart(24,"strong"),s.ɵɵtext(25),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(26,"p"),s.ɵɵelement(27,"localize",42),s.ɵɵtext(28," "),s.ɵɵelementStart(29,"strong"),s.ɵɵtext(30),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵtemplate(31,G,17,7,"div",43),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext().$implicit,r=s.ɵɵnextContext();s.ɵɵproperty("@fadeInOut",void 0)("ngClass",s.ɵɵpureFunction4(13,q,"PENDING"===n.approvalStatus,"ACCEPTED"===n.approvalStatus,"PARTIAL"===n.approvalStatus,"REJECTED"===n.approvalStatus)),s.ɵɵadvance(5),s.ɵɵtextInterpolate(n.geoObject.label),s.ɵɵadvance(2),s.ɵɵtextInterpolate(n.geoObject.code),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","UpdateGeoObject"===n.type),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","CreateGeoObject"===n.type),s.ɵɵadvance(3),s.ɵɵproperty("ngIf",!r.isRequestTooOld(n)&&"INVALID"===n.approvalStatus),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",r.isRequestTooOld(n)),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",n.permissions.includes("READ_CONTRIBUTOR_NOTES")),s.ɵɵadvance(6),s.ɵɵtextInterpolate(n.createdBy),s.ɵɵadvance(5),s.ɵɵtextInterpolate(n.email),s.ɵɵadvance(5),s.ɵɵtextInterpolate(n.phoneNumber),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","INVALID"!==n.approvalStatus&&!r.isRequestTooOld(n))}}var U=function(e){return{"row-active":e}},$=function(e,t,n,r){return{"status-pending":e,"status-accepted":t,"status-partial":n,"status-rejected":r}};function J(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"tr",21),s.ɵɵlistener("click",(function(e){s.ɵɵrestoreView(n);var r=t.$implicit;return s.ɵɵnextContext().toggle(e,r.oid)})),s.ɵɵelementStart(1,"td",22),s.ɵɵelementStart(2,"h5"),s.ɵɵelementStart(3,"strong"),s.ɵɵtext(4),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(5,"td",23),s.ɵɵelementStart(6,"h5"),s.ɵɵelementStart(7,"strong"),s.ɵɵtext(8),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(9,"td",24),s.ɵɵelementStart(10,"span",25),s.ɵɵtext(11),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(12,"td",26),s.ɵɵelementStart(13,"h5",27),s.ɵɵelementStart(14,"strong"),s.ɵɵtext(15),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(16,"td",28),s.ɵɵelement(17,"i",29),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵtemplate(18,B,32,18,"tr",30)}if(2&e){var r=t.$implicit,i=s.ɵɵnextContext();s.ɵɵproperty("ngClass",s.ɵɵpureFunction1(7,U,i.toggleId===r.oid)),s.ɵɵadvance(4),s.ɵɵtextInterpolate(r.createdBy),s.ɵɵadvance(4),s.ɵɵtextInterpolate(r.oid),s.ɵɵadvance(3),s.ɵɵtextInterpolate1(" ",i.formatDate(r.createDate)," "),s.ɵɵadvance(2),s.ɵɵproperty("ngClass",s.ɵɵpureFunction4(9,$,"PENDING"===r.approvalStatus,"ACCEPTED"===r.approvalStatus,"PARTIAL"===r.approvalStatus,"REJECTED"===r.approvalStatus)),s.ɵɵadvance(2),s.ɵɵtextInterpolate(r.statusLabel),s.ɵɵadvance(3),s.ɵɵproperty("ngIf",i.toggleId===r.oid)}}function W(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"div",19),s.ɵɵelementStart(1,"pagination-controls",104),s.ɵɵlistener("pageChange",(function(e){return s.ɵɵrestoreView(n),s.ɵɵnextContext().refresh(e)})),s.ɵɵelementEnd(),s.ɵɵelementEnd()}}var K=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}},Q=function(){function e(e,t,n,r,i,o,a,l,s){this.service=e,this.geomService=t,this.modalService=n,this.authService=r,this.localizationService=i,this.eventService=o,this.route=a,this.router=l,this.dateService=s,this.today=new Date,this.todayString=this.dateService.getDateString(new Date),this.objectKeys=Object.keys,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.requests=[],this.columns=[],this.filterCriteria="ALL",this.hasBaseDropZoneOver=!1,this.waitingOnScroll=!1,this.oid=null,this.isValid=!0,this.isEditing=!1,this.columns=[{name:i.decode("change.request.user"),prop:"createdBy",sortable:!1},{name:i.decode("change.request.createDate"),prop:"createDate",sortable:!1,width:195},{name:i.decode("change.request.status"),prop:"approvalStatus",sortable:!1}]}return e.prototype.ngOnInit=function(){var e=this;this.oid=this.route.snapshot.paramMap.get("oid"),null!=this.oid&&(this.toggleId=this.oid);var t={queueLimit:1,removeAfterUpload:!0,url:acp+"/changerequest/upload-file-cr"};this.uploader=new o.FileUploader(t),this.uploader.onBuildItemForm=function(t,n){n.append("crOid",e.uploadRequest.oid)},this.uploader.onBeforeUploadItem=function(t){e.eventService.start()},this.uploader.onCompleteItem=function(t,n,r,i){e.fileRef.nativeElement.value="",e.eventService.complete()},this.uploader.onSuccessItem=function(t,n,r,i){var o=JSON.parse(n),a=e.requests.findIndex((function(e){return e.oid===o.requestId}));-1!==a&&e.requests[a].documents.push(o)},this.uploader.onErrorItem=function(t,n,r,i){var o=JSON.parse(n);e.error({error:o})},null!=this.toggleId&&(this.onSelect({selected:[{oid:this.toggleId}]}),this.waitingOnScroll=!0),this.refresh()},e.prototype.getGOTLabel=function(e){return e.geoObjectJson&&e.geoObjectJson.attributes&&e.geoObjectJson.attributes.displayLabel&&e.geoObjectJson.attributes.displayLabel.values&&e.geoObjectJson.attributes.displayLabel.values[0]&&e.geoObjectJson.attributes.displayLabel.values[0].value&&e.geoObjectJson.attributes.displayLabel.values[0].value.localeValues&&e.geoObjectJson.attributes.displayLabel.values[0].value.localeValues[0]&&e.geoObjectJson.attributes.displayLabel.values[0].value.localeValues[0].value?e.geoObjectJson.attributes.displayLabel.values[0].value.localeValues[0].value:e.geoObjectJson&&e.geoObjectJson.attributes&&e.geoObjectJson.attributes.code?e.geoObjectJson.attributes.code:this.localizationService.decode("geoObject.label")},e.prototype.setValid=function(e){this.isValid=e},e.prototype.onUpload=function(e){this.uploadRequest=e,null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizationService.decode("io.missing.file"),error:{}})},e.prototype.onDownloadFile=function(e,t){window.location.href=acp+"/changerequest/download-file-cr?crOid="+e.oid+"&vfOid="+t},e.prototype.onDeleteFile=function(e,t){var n=this;this.service.deleteFile(e.oid,t).then((function(){var n=e.documents.findIndex((function(e){return e.oid===t}));-1!==n&&e.documents.splice(n,1)})).catch((function(e){n.error(e)}))},e.prototype.fileOverBase=function(e){this.hasBaseDropZoneOver=e},e.prototype.refresh=function(e){var t=this;void 0===e&&(e=1),this.geomService.destroy(),this.service.getAllRequests(this.page.pageSize,e,this.filterCriteria,this.oid).then((function(e){t.page=e,t.requests=e.resultSet,t.requests.forEach((function(e){if(!e.current.geoObject)for(var t=0;t<e.actions.length;t++)e.actions[0].actionType===a.ActionTypes.CREATEGEOOBJECTACTION&&(e.current.geoObject=JSON.parse(JSON.stringify(e.actions[0].geoObjectJson)))}))})).catch((function(e){t.error(e)}))},e.prototype.onSelect=function(e){var t=this;this.geomService.destroy(),this.service.getAllRequests(this.page.pageSize,1,"ALL",this.oid).then((function(e){t.requests=e.resultSet})).catch((function(e){t.error(e)}))},e.prototype.onExecute=function(e){var t=this;null!=e&&this.service.implementDecisions(e).then((function(n){e=n,t.refresh();var r=t.modalService.show(l.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});r.content.submitText=t.localizationService.decode("change.requests.more.geoobject.updates.submit.btn"),r.content.cancelText=t.localizationService.decode("change.requests.more.geoobject.updates.cancel.btn"),r.content.message=t.localizationService.decode("change.requests.more.geoobject.updates.message"),r.content.onConfirm.subscribe((function(){var e=t.getFirstGeoObjectInActions(n);if(null!=e)t.router.navigate(["/registry/location-manager",e.attributes.uid,e.geoObjectType.code,t.todayString,!0]);else{var r=n.current.geoObject,i=n.current.geoObjectType;null!=r&&null!=i&&t.router.navigate(["/registry/location-manager",r.attributes.uid,i.code,t.todayString,!0])}}))})).catch((function(e){t.error(e)}))},e.prototype.onReject=function(e){var t=this;this.service.rejectChangeRequest(e).then((function(){t.refresh()})).catch((function(e){t.error(e)}))},e.prototype.getFirstGeoObjectInActions=function(e){for(var t=0;t<e.actions.length;t++){var n=e.actions[t];if(n.hasOwnProperty("geoObjectJson"))return n.geoObjectJson}return null},e.prototype.onDelete=function(e){var t=this;if(null!=e){var n=this.modalService.show(l.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});n.content.type="danger",n.content.submitText=this.localizationService.decode("change.request.delete.request.confirm.btn"),n.content.message=this.localizationService.decode("change.request.delete.request.message"),n.content.onConfirm.subscribe((function(n){t.service.delete(e.oid).then((function(e){for(var n=-1,r=0;r<t.requests.length;r++){if(t.requests[r].oid===e){n=r;break}}n>-1&&t.requests.splice(n,1),t.refresh()})).catch((function(e){t.error(e)}))}))}},e.prototype.onUpdate=function(e){var t=this;null!=e&&this.service.update(e).then((function(e){t.refresh(),t.isEditing=!1})).catch((function(e){t.error(e)}))},e.prototype.applyActionStatusProperties=function(e){var t=this;this.service.setActionStatus(e.oid,e.approvalStatus).then((function(n){e.decisionMaker="PENDING"!==e.approvalStatus?t.authService.getUsername():""})).catch((function(e){t.error(e)}))},e.prototype.error=function(e){this.bsModalRef=l.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.prototype.requestTrackBy=function(e,t){return t.oid},e.prototype.toggle=function(e,t){var n=this;e.target.parentElement.className.includes("btn")||e.target.className.includes("btn")||(this.toggleId===t?this.toggleId=null:(this.toggleId=t,this.requests.forEach((function(e){e.oid===t&&(n.actions=e.actions)}))))},e.prototype.filter=function(e){this.filterCriteria=e,this.refresh(1)},e.prototype.setActionStatus=function(e,t){var n=this;this.modalService.show(l.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}).content.onConfirm.subscribe((function(r){e.approvalStatus=t,n.applyActionStatusProperties(e)}))},e.prototype.getActiveDetailComponent=function(e){return e.actionType.endsWith("CreateGeoObjectAction")||e.actionType.endsWith("UpdateGeoObjectAction"),e},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.getUsername=function(){return this.authService.getUsername()},e.prototype.isRequestTooOld=function(e){return!(e.actions&&e.actions.length>0)||e.actions[0].actionType===a.ActionTypes.UPDATEGEOOBJECTACTION},e.prototype.onEditAttributes=function(){this.isEditing=!this.isEditing},e.prototype.canEdit=function(e){return e.permissions.includes("WRITE_DETAILS")&&this.isEditing},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.ChangeRequestService),s.ɵɵdirectiveInject(c.GeometryService),s.ɵɵdirectiveInject(d.BsModalService),s.ɵɵdirectiveInject(p.AuthService),s.ɵɵdirectiveInject(p.LocalizationService),s.ɵɵdirectiveInject(p.EventService),s.ɵɵdirectiveInject(m.ActivatedRoute),s.ɵɵdirectiveInject(m.Router),s.ɵɵdirectiveInject(u.DateService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["request-table"]],viewQuery:function(e,t){if(1&e&&s.ɵɵviewQuery(C,1),2&e){var n;s.ɵɵqueryRefresh(n=s.ɵɵloadQuery())&&(t.fileRef=n.first)}},inputs:{toggleId:"toggleId"},decls:33,vars:15,consts:[[1,"row"],[1,"col-md-12"],[1,"form-group","button-row"],[2,"border-bottom","1px solid",3,"routerLink","ngClass","click"],["key","change.request.all.filter.link"],[2,"margin-left","5px","border-bottom","1px solid",3,"routerLink","ngClass","click"],["key","change.request.pending.filter.link"],["key","change.request.accepted.filter.link"],["key","change.request.partial.filter.link"],["key","change.request.rejected.filter.link"],[2,"border-top","solid 3px #6BA542"],[1,"table"],[2,"height","50px","color","grey"],[2,"vertical-align","middle"],["key","change.request.contributor.label"],["key","change.request.id.label"],["key","change.request.date.contributed.label"],["key","change.request.status.label"],["ngFor","",3,"ngForOf","ngForTrackBy"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[1,"clickable",2,"height","50px",3,"ngClass","click"],[1,"col-md-3"],[1,"col-md-4"],[1,"col-md-2",2,"vertical-align","middle","color","grey"],[1,"date-string-display"],[1,"col-md-2"],[3,"ngClass"],[1,"col-md-1",2,"vertical-align","middle","text-align","right","padding-right","25px"],["aria-hidden","true",1,"arrow","arrow-right"],["style","background-color:#f7f7f7;",3,"ngClass",4,"ngIf"],[2,"background-color","#f7f7f7",3,"ngClass"],["colspan","5"],[1,"geoobject-panel-header"],[2,"margin-top","10px"],[2,"font-style","italic"],["style","font-style: italic;",4,"ngIf"],[1,"row",2,"margin","0","background","white"],["class","cr-details-invalid error-message",4,"ngIf"],["class","form-group","style","margin-top:20px;",4,"ngIf"],["key","change.request.contributor.prefix.label"],["key","change.request.contributor.email.prefix.label"],["key","change.request.contributor.phone.prefix.label"],["class","cr-details",4,"ngIf"],["key","change.request.type.update.geoobject.label"],["key","change.request.type.create.geoobject.label"],[1,"cr-details-invalid","error-message"],["key","change.request.invalid"],["key","change.request.tooOld"],[1,"form-group",2,"margin-top","20px"],[3,"for"],["key","change.request.contributor.notes.label"],[1,"form-control",2,"height","90px","max-width","100%",3,"id","ngModel","disabled","ngModelChange"],[1,"cr-details"],[1,"action-card",2,"margin-bottom","10px","background-color","white"],[1,"row",2,"background","white"],[3,"readOnly","geoObjectType","postGeoObject","changeRequest","hierarchies","isGeometryInlined","isNew","valid",4,"ngIf"],[1,"row",2,"border-top","1px grey solid","margin","0","padding","10px 0"],[1,"col-md-6"],["class","form-group",4,"ngIf"],["key","change.request.reference.documents.label"],["style","border:1px solid #ccc;border-radius: 4px;",4,"ngIf"],["style","color:grey;font-style:italic;",4,"ngIf"],["style","padding:10px 0;",4,"ngIf"],["class","button-holder","style","margin-bottom:20px;min-height:40px;",4,"ngIf"],[3,"readOnly","geoObjectType","postGeoObject","changeRequest","hierarchies","isGeometryInlined","isNew","valid"],["attributeEditor",""],[1,"form-group"],["key","change.request.maintainer.notes.label"],[1,"form-control",2,"height","90px","max-width","100%","margin","0",3,"id","ngModel","disabled","ngModelChange"],["key","change.request.action.detail.additionalNotes"],["type","text",1,"form-control",2,"width","100%",3,"id","ngModel","disabled","ngModelChange"],[2,"border","1px solid #ccc","border-radius","4px"],[2,"padding","10px","margin","0"],["class","list-group-item","style","padding:0;font-size:inherit;",4,"ngFor","ngForOf"],[1,"list-group-item",2,"padding","0","font-size","inherit"],[3,"click"],["aria-hidden","true",1,"fa","fa-times","ico-remove",2,"margin-left","10px",3,"click"],[2,"color","grey","font-style","italic"],["key","change.request.no.documents.label"],[2,"padding","10px 0"],["name","file","type","file","ng2FileSelect","","required","",1,"ghost-input",2,"display","inline-block","padding","0","height","auto","border-radius","0","margin-top","10px",3,"uploader"],["myFile",""],[1,"btn","btn-primary","pull-right",2,"margin","0",3,"title","click"],["key","change.request.reference.document.upload"],[1,"button-holder",2,"margin-bottom","20px","min-height","40px"],[4,"ngIf"],["type","submit","role","button",1,"btn","btn-primary",2,"margin","0",3,"disabled","title","click"],[3,"key"],["type","submit","class","btn btn-danger","style","margin:0 10px;","role","button",3,"disabled","title","click",4,"ngIf"],["type","submit","role","button",1,"btn","btn-danger",2,"margin","0 10px",3,"disabled","title","click"],["key","change.request.reject.all.btn"],["type","submit","class","btn btn-primary","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-default","role","button",3,"click",4,"ngIf"],["type","submit","role","button","class","btn btn-primary",3,"title","click",4,"ngIf"],["type","submit","role","button","class","btn btn-danger pull-right",3,"disabled","title","click",4,"ngIf"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","changeovertime.manageVersions.button.label"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"title","click"],["key","modal.button.update"],["type","submit","role","button",1,"btn","btn-danger","pull-right",3,"disabled","title","click"],["key","change.request.delete.request.btn"],[3,"pageChange"]],template:function(e,t){1&e&&(s.ɵɵelementStart(0,"div",0),s.ɵɵelementStart(1,"div",1),s.ɵɵelementStart(2,"div",2),s.ɵɵelementStart(3,"a",3),s.ɵɵlistener("click",(function(){return t.filter("ALL")})),s.ɵɵelement(4,"localize",4),s.ɵɵelementEnd(),s.ɵɵelementStart(5,"a",5),s.ɵɵlistener("click",(function(){return t.filter("PENDING")})),s.ɵɵelement(6,"localize",6),s.ɵɵelementEnd(),s.ɵɵelementStart(7,"a",5),s.ɵɵlistener("click",(function(){return t.filter("ACCEPTED")})),s.ɵɵelement(8,"localize",7),s.ɵɵelementEnd(),s.ɵɵelementStart(9,"a",5),s.ɵɵlistener("click",(function(){return t.filter("PARTIAL")})),s.ɵɵelement(10,"localize",8),s.ɵɵelementEnd(),s.ɵɵelementStart(11,"a",5),s.ɵɵlistener("click",(function(){return t.filter("REJECTED")})),s.ɵɵelement(12,"localize",9),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelement(13,"hr",10),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(14,"div",0),s.ɵɵelementStart(15,"div",1),s.ɵɵelementStart(16,"table",11),s.ɵɵelementStart(17,"thead"),s.ɵɵelementStart(18,"tr",12),s.ɵɵelementStart(19,"th",13),s.ɵɵelement(20,"localize",14),s.ɵɵelementEnd(),s.ɵɵelementStart(21,"th",13),s.ɵɵelement(22,"localize",15),s.ɵɵelementEnd(),s.ɵɵelementStart(23,"th",13),s.ɵɵelement(24,"localize",16),s.ɵɵelementEnd(),s.ɵɵelementStart(25,"th",13),s.ɵɵelement(26,"localize",17),s.ɵɵelementEnd(),s.ɵɵelement(27,"th"),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(28,"tbody"),s.ɵɵtemplate(29,J,19,14,"ng-template",18),s.ɵɵpipe(30,"paginate"),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(31,"div",19),s.ɵɵtemplate(32,W,2,0,"div",20),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e&&(s.ɵɵadvance(3),s.ɵɵproperty("ngClass","ALL"===t.filterCriteria?"cr-filter-link-active":""),s.ɵɵadvance(2),s.ɵɵproperty("ngClass","PENDING"===t.filterCriteria?"cr-filter-link-active":""),s.ɵɵadvance(2),s.ɵɵproperty("ngClass","ACCEPTED"===t.filterCriteria?"cr-filter-link-active":""),s.ɵɵadvance(2),s.ɵɵproperty("ngClass","PARTIAL"===t.filterCriteria?"cr-filter-link-active":""),s.ɵɵadvance(2),s.ɵɵproperty("ngClass","REJECTED"===t.filterCriteria?"cr-filter-link-active":""),s.ɵɵadvance(18),s.ɵɵproperty("ngForOf",s.ɵɵpipeBind2(30,8,t.requests,s.ɵɵpureFunction3(11,K,t.page.pageSize,t.page.pageNumber,t.page.count)))("ngForTrackBy",t.requestTrackBy),s.ɵɵadvance(3),s.ɵɵproperty("ngIf",t.page.resultSet.length>0))},directives:[m.RouterLinkWithHref,g.NgClass,h.LocalizeComponent,g.NgForOf,g.NgIf,f.DefaultValueAccessor,f.NgControlStatus,f.NgModel,y.GeoObjectSharedAttributeEditorComponent,v.FileSelectDirective,b.PaginationControlsComponent],pipes:[b.PaginatePipe,S.LocalizePipe],styles:[".vertical-center {\n\tposition: relative;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n}\n\n.status-pending {\n\tcolor: orange;\n}\n\n.status-accepted,\n.status-partial {\n\tcolor: #6BA542;\n}\n\n.status-rejected {\n\tcolor: #d43f3a;\n}\n\n.status-pending-container {\n\tborder: solid 2px orange;\n}\n.status-accepted-container,\n.status-partial-container {\n\tborder: solid 2px #6BA542;\n}\n.status-rejected-container {\n\tborder: solid 2px #d43f3a;\n}\n\n.cr-filter-link-active,\n.cr-filter-link-active:active {\n\t/* border: solid 1px #6BA542; */\n    border-radius: 10px;\n    background: #6BA542;\n    color: white;\n    font-weight: bold;\n    padding: 3px 15px 3px 15px;\n}\n.cr-filter-link-active:hover,\n.cr-filter-link-active:focus {\n\tcolor:white;\n}\n\n/* .btn {\n\tborder: 2px solid; \n}\n.btn:disabled {\n\tborder: none;\n}\n\n.btn.btn-danger {\n\tbackground-color:#ffeeed; \n\tcolor:#d43f3a;\n}\n.btn.btn-danger:hover,\n.btn.btn-danger:active {\n\tcolor:#d43f3a;\n\tbackground-color:#fff7f6; \n\tborder-color: #d43f3a;\n}\n.btn.btn-danger:disabled:hover {\n\tbackground-color:#ffeeed; \n}\n\n.btn.btn-warning {\n\tbackground-color: #ffefd7;\n\tcolor: orange;\n}\n.btn.btn-warning:hover {\n\tbackground-color: #fff4e5;\n\tborder-color: orange;\n}\n.btn.btn-warning:disabled {\n\tbackground-color: #ffefd7;\n}\n\n.clickable:hover {\n\tbackground-color: #f7f7f7;\n\tcursor: pointer;\n}\n.clickable:hover .arrow.arrow-right {\n\ttransform: rotate(45deg);\n    -webkit-transform: rotate(45deg);\n} */\n\ntr.row-active {\n\tbackground-color:#f7f7f7;\n}\n\n\n.arrow {\n  border: solid black;\n  border-width: 0 1px 1px 0;\n  display: inline-block;\n  padding: 5px;\n}\n.arrow-right {\n  transform: rotate(-45deg);\n  -webkit-transform: rotate(-45deg);\n}\n.arrow-down {\n  transform: rotate(45deg);\n  -webkit-transform: rotate(45deg);\n}\n\n.form-group textarea:focus {\n\tborder-color: #edf4e8;\n\t-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(107,165,66,.6);\n\tbox-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(107,165,66,.6);\n\n}\ntextarea[readonly]:focus {\n\tbox-shadow: none;\n\tborder: 1px solid #ccc;\n\tcursor: not-allowed;\n}\n\n\n.geoobject-panel-header{\n    width: 100%;\n    background: grey;\n    color: white;\n    padding: 10px;\n}\n"],encapsulation:2,data:{animation:[[i.trigger("fadeInOut",[i.transition(":enter",[i.style({opacity:0}),i.animate("300ms")]),i.transition(":leave",i.animate("100ms",i.style({opacity:0})))]),i.trigger("fadeIn",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms")])])]]}}),e}();t.RequestTableComponent=Q,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(Q,[{type:r.Component,args:[{selector:"request-table",templateUrl:"./request-table.component.html",styleUrls:["./request-table.css"],encapsulation:r.ViewEncapsulation.None,animations:[[i.trigger("fadeInOut",[i.transition(":enter",[i.style({opacity:0}),i.animate("300ms")]),i.transition(":leave",i.animate("100ms",i.style({opacity:0})))]),i.trigger("fadeIn",[i.transition(":enter",[i.style({opacity:0}),i.animate("500ms")])])]]}]}],(function(){return[{type:c.ChangeRequestService},{type:c.GeometryService},{type:d.BsModalService},{type:p.AuthService},{type:p.LocalizationService},{type:p.EventService},{type:m.ActivatedRoute},{type:m.Router},{type:u.DateService}]}),{toggleId:[{type:r.Input}],fileRef:[{type:r.ViewChild,args:["myFile"]}]})},585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValueOverTimeCREditor=void 0;var r=n(520),i=n(377),o=n(269),a=n(153),l=n(518),s=n(31),c=n(258),d=function(){function e(e,t,n){this.onChangeSubject=new s.Subject,this._isValid=!0,this.attr=t,this.changeRequestAttributeEditor=e,this.action=n}return e.prototype.getGeoObjectTimeRangeStorage=function(){return this.valueOverTime},e.prototype.getValueFromGeoObjectForDiff=function(){return this.valueOverTime.value},e.prototype.validate=function(){var e=this.changeRequestAttributeEditor.changeRequestEditor.dateService,t=e.validateDate(null==this.startDate?null:e.getDateFromDateString(this.startDate),!0,!0),n=e.validateDate(null==this.endDate?null:e.getDateFromDateString(this.endDate),!0,!0);return this._isValid=!0,t.valid&&n.valid||(this._isValid=!1),this.validateUpdateReference(),this._isValid},e.prototype.validateUpdateReference=function(){this.conflictMessage||(this.conflictMessage=[]);for(var e=this.conflictMessage.length-1;e>=0;--e)this.conflictMessage[e].type===c.ConflictType.MISSING_REFERENCE&&this.conflictMessage.splice(e,1);"UpdateGeoObject"===this.changeRequestAttributeEditor.changeRequestEditor.changeRequest.type&&null!=this.diff&&"CREATE"!==this.diff.action&&(null==this.findExistingValueOverTimeByOid(this.diff.oid,this.attr.code)&&(this._isValid=!1,this.conflictMessage.push({severity:"ERROR",message:this.changeRequestAttributeEditor.changeRequestEditor.localizationService.decode("changeovertime.manageVersions.missingReference"),type:c.ConflictType.MISSING_REFERENCE})))},e.prototype.findExistingValueOverTimeByOid=function(e,t){if(this.changeRequestAttributeEditor.changeRequestEditor.geoObject.attributes[t]){var n=this.changeRequestAttributeEditor.changeRequestEditor.geoObject.attributes[t].values.findIndex((function(t){return t.oid===e}));if(-1!==n)return this.changeRequestAttributeEditor.changeRequestEditor.geoObject.attributes[t].values[n]}return null},Object.defineProperty(e.prototype,"oid",{get:function(){return null!=this.diff?this.diff.oid:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().oid:null},set:function(e){null!=this.diff?this.diff.oid=e:null!=this.getGeoObjectTimeRangeStorage()&&(this.getGeoObjectTimeRangeStorage().oid=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startDate",{get:function(){return null!=this.diff&&void 0!==this.diff.newStartDate?this.diff.newStartDate:null!=this.diff&&void 0!==this.diff.oldStartDate?this.diff.oldStartDate:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().startDate:null},set:function(e){if(null==this.diff||"DELETE"!==this.diff.action){var t=this.getGeoObjectTimeRangeStorage();if("UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==this.getGeoObjectTimeRangeStorage())this.constructNewDiff("CREATE");else{if(t.startDate===e)return;this.constructNewDiff("UPDATE"),this.diff.oldValue=this.getValueFromGeoObjectForDiff()}e===this.diff.oldStartDate?delete this.diff.newStartDate:this.diff.newStartDate=e,this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(t.startDate=e);this.changeRequestAttributeEditor.onChange(),this.onChangeSubject.next("startDate")}},enumerable:!1,configurable:!0}),e.prototype.constructNewDiff=function(e){if(this.diff=new r.ValueOverTimeDiff,this.diff.action=e,this.action.attributeDiff.valuesOverTime.push(this.diff),"CREATE"===e)this.diff.oid=i.v4();else{var t=this.getGeoObjectTimeRangeStorage();this.diff.oid=t.oid,this.diff.oldStartDate=t.startDate,this.diff.oldEndDate=t.endDate}},Object.defineProperty(e.prototype,"oldStartDate",{get:function(){return null!=this.diff?this.diff.oldStartDate:null},set:function(e){null!=this.diff&&(this.diff.oldStartDate=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endDate",{get:function(){return null!=this.diff&&void 0!==this.diff.newEndDate?this.diff.newEndDate:null!=this.diff&&void 0!==this.diff.oldStartDate?this.diff.oldEndDate:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().endDate:null},set:function(e){if(null==this.diff||"DELETE"!==this.diff.action){var t=this.getGeoObjectTimeRangeStorage();if("UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==t)this.constructNewDiff("CREATE");else{if(t.endDate===e)return;this.constructNewDiff("UPDATE"),this.diff.oldValue=this.getValueFromGeoObjectForDiff()}e===this.diff.oldEndDate?delete this.diff.newEndDate:this.diff.newEndDate=e,this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(t.endDate=e);this.changeRequestAttributeEditor.onChange(),this.onChangeSubject.next("endDate")}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldEndDate",{get:function(){return null!=this.diff?this.diff.oldEndDate:null},set:function(e){null!=this.diff&&(this.diff.oldEndDate=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return null!=this.diff&&void 0!==this.diff.newValue?this.diff.newValue:null!=this.diff&&void 0!==this.diff.oldValue?this.diff.oldValue:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().value:null},set:function(e){if(null==this.diff||"DELETE"!==this.diff.action){if(null!=e?"term"===this.attr.type?e=[e]:"date"===this.attr.type&&(e=new Date(e).getTime()):null==e&&("geometry"===this.attr.type?e=l.GeometryService.createEmptyGeometryValue(this.changeRequestAttributeEditor.changeRequestEditor.geoObjectType.geometryType):"character"===this.attr.type&&(e="")),"UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==this.getGeoObjectTimeRangeStorage())this.diff=new r.ValueOverTimeDiff,this.diff.oid=i.v4(),this.diff.action="CREATE",this.action.attributeDiff.valuesOverTime.push(this.diff);else{if(this.areValuesEqual(this.valueOverTime.value,e))return;this.diff=new r.ValueOverTimeDiff,this.diff.action="UPDATE",this.diff.oid=this.getGeoObjectTimeRangeStorage().oid,this.diff.oldValue=this.valueOverTime.value,this.diff.oldStartDate=this.getGeoObjectTimeRangeStorage().startDate,this.diff.oldEndDate=this.getGeoObjectTimeRangeStorage().endDate,this.action.attributeDiff.valuesOverTime.push(this.diff)}"CREATE"!==this.diff.action&&this.areValuesEqual(this.diff.oldValue,e)?delete this.diff.newValue:this.diff.newValue=JSON.parse(JSON.stringify(e)),this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(this.valueOverTime.value=e);this.changeRequestAttributeEditor.onChange(),this.onChangeSubject.next("value")}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldValue",{get:function(){return null!=this.diff?this.diff.oldValue:null},set:function(e){null!=this.diff&&(this.diff.oldValue=e)},enumerable:!1,configurable:!0}),e.prototype.setLocalizedValue=function(e){this.value=JSON.parse(JSON.stringify(e))},e.prototype.removeEmptyDiff=function(){var e=this;if(null!=this.diff&&void 0===this.diff.newValue&&void 0===this.diff.newStartDate&&void 0===this.diff.newEndDate){var t=this.action.attributeDiff.valuesOverTime,n=t.findIndex((function(t){return t.oid===e.diff.oid}));-1!==n&&t.splice(n,1),this.diff=null}},e.prototype.areValuesEqual=function(e,t){if("boolean"===this.attr.type)return e===t;if(""===e&&null==t||""===t&&null==e)return!0;if(!e&&!t)return!0;if(!e&&t||!t&&e)return!1;if("term"===this.attr.type){if(null!=e&&null!=t)return e.length===t.length&&e[0]===t[0]}else{if("geometry"===this.attr.type)return o.default(e,t);if("date"===this.attr.type)return("string"==typeof e?parseInt(e):e)===("string"==typeof t?parseInt(t):t);if("local"===this.attr.type){if(!e.localeValues||!t.localeValues||e.localeValues.length!==t.localeValues.length)return!1;for(var n=e.localeValues.length,r=0;r<n;++r){var i=e.localeValues[r],a=this.getValueAtLocale(t,i.locale),l=i.value;if(!(""===l&&null==a||""===a&&null==l)&&l!==a)return!1}return!0}}return e===t},e.prototype.getValueAtLocale=function(e,t){return new a.LocalizedValue(e.localizedValue,e.localeValues).getValue(t)},e.prototype.remove=function(){var e=this;if("UpdateAttributeAction"===this.action.actionType)if(null!=this.diff&&"CREATE"===this.diff.action){var t=this.action;(n=t.attributeDiff.valuesOverTime.findIndex((function(t){return t.oid===e.diff.oid})))>-1&&t.attributeDiff.valuesOverTime.splice(n,1)}else{if(null!=this.diff)return delete this.diff.newValue,delete this.diff.newStartDate,delete this.diff.newEndDate,this.removeEmptyDiff(),this.changeRequestAttributeEditor.onChange(),void this.onChangeSubject.next("remove");null!=this.valueOverTime&&null==this.diff&&(this.diff=new r.ValueOverTimeDiff,this.diff.action="DELETE",this.diff.oid=this.valueOverTime.oid,this.diff.oldValue=this.valueOverTime.value,this.diff.oldStartDate=this.valueOverTime.startDate,this.diff.oldEndDate=this.valueOverTime.endDate,this.action.attributeDiff.valuesOverTime.push(this.diff))}else if("CreateGeoObjectAction"===this.action.actionType){var n,i=this.action.geoObjectJson.attributes[this.attr.code].values;-1!==(n=i.findIndex((function(t){return t.oid===e.valueOverTime.oid})))&&i.splice(n,1)}this.changeRequestAttributeEditor.onChange(),this.onChangeSubject.next("remove")},e}();t.ValueOverTimeCREditor=d},586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManageVersionsComponent=void 0;var r=n(0),i=n(7),o=n(203),a=n(520),l=n(153),s=n(258),c=(n(87),n(111)),d=(n(30),n(518),n(521),n(112),n(16),n(620)),p=n(22),m=n(31),u=(n(552),n(0)),g=n(518),h=n(16),f=n(112),y=n(87),v=n(521),b=n(30),S=["dateFieldComponents"];function C(e,t){if(1&e&&(u.ɵɵelementStart(0,"h5"),u.ɵɵtext(1),u.ɵɵelementEnd()),2&e){var n=t.item;u.ɵɵadvance(1),u.ɵɵtextInterpolate2("",n.name," : ",n.code,"")}}function E(e,t){1&e&&(u.ɵɵelementStart(0,"p",16),u.ɵɵelement(1,"localize",17),u.ɵɵelementEnd())}function x(e,t){1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelement(1,"localize",18),u.ɵɵelementEnd())}function O(e,t){if(1&e&&(u.ɵɵelementStart(0,"div",32),u.ɵɵtext(1),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext().$implicit;u.ɵɵadvance(1),u.ɵɵtextInterpolate1(" ",n.summaryKeyLocalized," ")}}function I(e,t){1&e&&(u.ɵɵelementStart(0,"p",40),u.ɵɵelement(1,"localize",41),u.ɵɵelementEnd())}function w(e,t){if(1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"p",42),u.ɵɵelement(2,"localize",43),u.ɵɵtext(3),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext().$implicit,r=u.ɵɵnextContext(2).$implicit,i=u.ɵɵnextContext(4);u.ɵɵadvance(3),u.ɵɵtextInterpolate1(" ",i.getValueAtLocale(r.oldValue,n.locale)," ")}}var M=function(e){return{"has-changed":e}};function T(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"tr",34),u.ɵɵelementStart(1,"td",35),u.ɵɵelementStart(2,"h5"),u.ɵɵelement(3,"convert-key-label",36),u.ɵɵelementEnd(),u.ɵɵelementStart(4,"input",37),u.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e}))("ngModelChange",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(2).$implicit;return e.editor.setLocalizedValue(e.value)})),u.ɵɵelementEnd(),u.ɵɵelementStart(5,"div",38),u.ɵɵtemplate(6,I,2,0,"p",39),u.ɵɵelementEnd(),u.ɵɵtemplate(7,w,4,1,"div",9),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=t.index,o=u.ɵɵnextContext(2),a=o.$implicit,l=o.index,s=u.ɵɵnextContext(4);u.ɵɵadvance(3),u.ɵɵproperty("key",r.locale),u.ɵɵadvance(1),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(8,M,s.hasLocalizationChanged(a,r.locale)&&!s.isNew))("disabled",s.readonly||"DELETE"===a.summaryKey)("name","loc-val-"+l+"-"+i)("ngModel",r.value)("required","defaultLocale"===r.locale),u.ɵɵadvance(2),u.ɵɵproperty("ngIf","defaultLocale"===r.locale&&!r.value),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",s.hasLocalizationChanged(a,r.locale)&&!s.isNew)}}function j(e,t){if(1&e&&(u.ɵɵelementContainerStart(0),u.ɵɵtemplate(1,T,8,10,"tr",33),u.ɵɵelementContainerEnd()),2&e){var n=u.ɵɵnextContext().$implicit;u.ɵɵadvance(1),u.ɵɵproperty("ngForOf",n.value.localeValues)}}function k(e,t){if(1&e&&(u.ɵɵelementStart(0,"option",48),u.ɵɵtext(1),u.ɵɵelementEnd()),2&e){var n=t.$implicit;u.ɵɵproperty("value",n.code),u.ɵɵadvance(1),u.ɵɵtextInterpolate(n.label.localizedValue)}}function R(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"select",45),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).$implicit.value=e})),u.ɵɵelement(2,"option",46),u.ɵɵtemplate(3,k,2,2,"option",47),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2),i=r.$implicit,o=r.index,a=u.ɵɵnextContext(4);u.ɵɵadvance(1),u.ɵɵpropertyInterpolate1("id","mod-",a.attributeType.code,""),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(6,M,i.oldValue&&!a.isNew))("name","mod-term-"+o+"-"+a.attributeType.code)("ngModel",i.value)("disabled",a.readonly||"DELETE"===i.summaryKey),u.ɵɵadvance(2),u.ɵɵproperty("ngForOf",a.getGeoObjectTypeTermAttributeOptions(a.attributeType.code))}}function z(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"input",49),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).$implicit.value=e})),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2),i=r.$implicit,o=r.index,a=u.ɵɵnextContext(4);u.ɵɵadvance(1),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(4,M,i.oldValue&&!a.isNew))("name","char-val-"+o)("ngModel",i.value)("disabled",a.readonly||"DELETE"===i.summaryKey)}}function P(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"date-field",50),u.ɵɵlistener("valueChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).$implicit.value=e}))("validChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(6).isValid=e})),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2),i=r.$implicit,o=r.index,a=u.ɵɵnextContext(4);u.ɵɵadvance(1),u.ɵɵproperty("customStyles",i.oldValue&&!a.isNew?"color: orange;":"")("value",i.value)("inputName","date-val-"+o)("allowInfinity",!1)("allowFutureDates",!0)("required",!0)("placement","right")("valid",a.isValid)("disable",a.readonly)}}function D(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"input",51),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).$implicit.value=e})),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2),i=r.$implicit,o=r.index,a=u.ɵɵnextContext(4);u.ɵɵadvance(1),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(4,M,i.oldValue&&!a.isNew))("name","int-val-"+o)("ngModel",i.value)("disabled",a.readonly||"DELETE"===i.summaryKey)}}function A(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"label",52),u.ɵɵelementStart(2,"input",53),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).$implicit.value=e})),u.ɵɵelementEnd(),u.ɵɵelementStart(3,"span",54),u.ɵɵelement(4,"localize",55),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementStart(5,"label",56),u.ɵɵelementStart(6,"input",57),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).$implicit.value=e})),u.ɵɵelementEnd(),u.ɵɵelementStart(7,"span",54),u.ɵɵelement(8,"localize",58),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2),i=r.index,o=r.$implicit,a=u.ɵɵnextContext(4);u.ɵɵadvance(2),u.ɵɵpropertyInterpolate1("id","mod-",i,"-true"),u.ɵɵpropertyInterpolate1("name","mod-",i,"-true"),u.ɵɵproperty("checked",!0===o.value)("value",!0)("ngModel",o.value)("disabled",a.readonly||"DELETE"===o.summaryKey),u.ɵɵadvance(1),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(15,M,o.oldValue&&!a.isNew)),u.ɵɵadvance(3),u.ɵɵpropertyInterpolate1("id","mod-",i,"-false"),u.ɵɵpropertyInterpolate1("name","mod-",i,"-false"),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(17,M,o.oldValue&&!a.isNew))("checked",!1===o.value)("value",!1)("ngModel",o.value)("disabled",a.readonly||"DELETE"===o.summaryKey),u.ɵɵadvance(1),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(19,M,o.oldValue&&!a.isNew))}}function V(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"span",65),u.ɵɵlistener("click",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext().$implicit;return u.ɵɵnextContext(4).$implicit.editor.removeType(e)})),u.ɵɵelement(1,"i",66),u.ɵɵelementEnd()}}function N(e,t){1&e&&u.ɵɵelement(0,"span",67)}var L=function(e,t){return{"inline-loading":e,"has-changed":t}};function _(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div",60),u.ɵɵtext(1),u.ɵɵelementStart(2,"div",61),u.ɵɵelementStart(3,"input",62),u.ɵɵlistener("ngModelChange",(function(e){u.ɵɵrestoreView(n);var r=t.$implicit;return u.ɵɵnextContext(4).$implicit.value.parents[r.code].text=e}))("typeaheadOnSelect",(function(e){u.ɵɵrestoreView(n);var r=t.$implicit,i=u.ɵɵnextContext(4).$implicit;return u.ɵɵnextContext(4).typeaheadOnSelect(i.editor,e,r,i.value,i.startDate)}))("typeaheadLoading",(function(e){u.ɵɵrestoreView(n);var r=t.$implicit;return u.ɵɵnextContext(4).$implicit.value.loading[r.code]=e})),u.ɵɵelementEnd(),u.ɵɵtemplate(4,V,2,0,"span",63),u.ɵɵtemplate(5,N,1,0,"span",64),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=t.index,o=u.ɵɵnextContext(4),a=o.index,l=o.$implicit,s=u.ɵɵnextContext(4),c=u.ɵɵreference(2);u.ɵɵadvance(1),u.ɵɵtextInterpolate1(" ",r.label," "),u.ɵɵadvance(2),u.ɵɵproperty("name",r.code+"-"+a)("disabled",s.readonly||"DELETE"===l.summaryKey||null==l.startDate||""===l.startDate)("ngModel",l.value.parents[r.code].text)("typeaheadAsync",!0)("typeahead",s.getTypeAheadObservable(l.editor,l.startDate,r,l.value,i))("ngClass",u.ɵɵpureFunction2(13,L,l.value.loading[r.code],l.oldValue&&!s.isNew))("typeaheadOptionsLimit",7)("typeaheadItemTemplate",c)("typeaheadMinLength",0)("typeaheadWaitMs",300),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!s.readonly),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",s.readonly)}}function F(e,t){if(1&e&&(u.ɵɵelementContainerStart(0),u.ɵɵtemplate(1,_,6,16,"div",59),u.ɵɵelementContainerEnd()),2&e){var n=u.ɵɵnextContext(7);u.ɵɵadvance(1),u.ɵɵproperty("ngForOf",n.hierarchy.types)}}function H(e,t){if(1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵtemplate(1,F,2,1,"ng-container",9),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext(6);u.ɵɵadvance(1),u.ɵɵproperty("ngIf",null!=n.hierarchy&&null!=n.hierarchy.types&&n.hierarchy.types.length>0)}}function G(e,t){if(1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"p",68),u.ɵɵelement(2,"localize",43),u.ɵɵtext(3),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext(2).$implicit;u.ɵɵadvance(3),u.ɵɵtextInterpolate1(" ",n.oldValue," ")}}function q(e,t){1&e&&u.ɵɵelement(0,"localize",78)}function B(e,t){1&e&&u.ɵɵelement(0,"localize",79)}function U(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"button",75),u.ɵɵlistener("click",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(3).$implicit;return u.ɵɵnextContext(4).toggleOldGeometryView(e)})),u.ɵɵtemplate(1,q,1,0,"localize",76),u.ɵɵtemplate(2,B,1,0,"localize",77),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(3).$implicit;u.ɵɵproperty("disabled",r.coordinate&&(null!=r.coordinate.longValid&&!r.coordinate.longValid||null!=r.coordinate.latValid&&!r.coordinate.latValid)),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!r.oldLayer||!r.oldLayer.isRendering),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.oldLayer&&r.oldLayer.isRendering)}}function $(e,t){1&e&&u.ɵɵelement(0,"localize",80)}function J(e,t){1&e&&u.ɵɵelement(0,"localize",81)}function W(e,t){1&e&&u.ɵɵelement(0,"localize",84)}function K(e,t){1&e&&u.ɵɵelement(0,"localize",85)}function Q(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"button",75),u.ɵɵlistener("click",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(3).$implicit;return u.ɵɵnextContext(4).toggleGeometryEditing(e)})),u.ɵɵtemplate(1,W,1,0,"localize",82),u.ɵɵtemplate(2,K,1,0,"localize",83),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(3).$implicit,i=u.ɵɵnextContext(4);u.ɵɵproperty("disabled",i.readonly||r.coordinate&&(null!=r.coordinate.longValid&&!r.coordinate.longValid||null!=r.coordinate.latValid&&!r.coordinate.latValid)),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.newLayer&&!r.newLayer.isEditing),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.newLayer&&r.newLayer.isEditing)}}function Y(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"input",93),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(4).$implicit.value.coordinates[0][1]=e}))("change",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(4).$implicit;return u.ɵɵnextContext(4).manualCoordinateChange(e)})),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(4).$implicit,i=u.ɵɵnextContext(4);u.ɵɵproperty("readonly",i.readonly||!(r.newLayer&&r.newLayer.isEditing)||"DELETE"===r.summaryKey)("ngModel",r.value.coordinates[0][1])}}function X(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"input",93),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(4).$implicit.newCoordinateY=e}))("change",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(4).$implicit;return u.ɵɵnextContext(4).manualCoordinateChange(e)})),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(4).$implicit,i=u.ɵɵnextContext(4);u.ɵɵproperty("readonly",i.readonly||!(r.newLayer&&r.newLayer.isEditing)||"DELETE"===r.summaryKey)("ngModel",r.newCoordinateY)}}function Z(e,t){1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"p",40),u.ɵɵelement(2,"localize",94),u.ɵɵelementEnd(),u.ɵɵelementEnd())}function ee(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"input",95),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(4).$implicit.value.coordinates[0][0]=e}))("change",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(4).$implicit;return u.ɵɵnextContext(4).manualCoordinateChange(e)})),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(4).$implicit,i=u.ɵɵnextContext(4);u.ɵɵproperty("readonly",i.readonly||!(r.newLayer&&r.newLayer.isEditing)||"DELETE"===r.summaryKey)("ngModel",r.value.coordinates[0][0])}}function te(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"input",93),u.ɵɵlistener("ngModelChange",(function(e){return u.ɵɵrestoreView(n),u.ɵɵnextContext(4).$implicit.newCoordinateX=e}))("change",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(4).$implicit;return u.ɵɵnextContext(4).manualCoordinateChange(e)})),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(4).$implicit,i=u.ɵɵnextContext(4);u.ɵɵproperty("readonly",i.readonly||!(r.newLayer&&r.newLayer.isEditing)||"DELETE"===r.summaryKey)("ngModel",r.newCoordinateX)}}function ne(e,t){1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"p",40),u.ɵɵelement(2,"localize",96),u.ɵɵelementEnd(),u.ɵɵelementEnd())}function re(e,t){if(1&e&&(u.ɵɵelementStart(0,"tr"),u.ɵɵelementStart(1,"td",86),u.ɵɵelementStart(2,"h5"),u.ɵɵelement(3,"localize",87),u.ɵɵelementEnd(),u.ɵɵelementStart(4,"div",88),u.ɵɵtemplate(5,Y,1,2,"input",89),u.ɵɵtemplate(6,X,1,2,"input",89),u.ɵɵelementEnd(),u.ɵɵtemplate(7,Z,3,0,"div",9),u.ɵɵelementEnd(),u.ɵɵelementStart(8,"td",90),u.ɵɵelementStart(9,"h5"),u.ɵɵelement(10,"localize",91),u.ɵɵelementEnd(),u.ɵɵelementStart(11,"div",88),u.ɵɵtemplate(12,ee,1,2,"input",92),u.ɵɵtemplate(13,te,1,2,"input",89),u.ɵɵelementEnd(),u.ɵɵtemplate(14,ne,3,0,"div",9),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext(3).$implicit;u.ɵɵadvance(5),u.ɵɵproperty("ngIf",n.value.coordinates&&n.value.coordinates[0]),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",null==n.value.coordinates||null==n.value.coordinates[0]),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",n.coordinate&&null!=n.coordinate.latValid&&!n.coordinate.latValid),u.ɵɵadvance(5),u.ɵɵproperty("ngIf",n.value.coordinates&&n.value.coordinates[0]),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",null==n.value.coordinates||null==n.value.coordinates[0]),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",n.coordinate&&null!=n.coordinate.longValid&&!n.coordinate.longValid)}}function ie(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"table",69),u.ɵɵelementStart(1,"tr"),u.ɵɵelementStart(2,"td",70),u.ɵɵtemplate(3,U,3,3,"button",71),u.ɵɵelementStart(4,"button",72),u.ɵɵlistener("click",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext(2).$implicit;return u.ɵɵnextContext(4).toggleGeometryView(e)})),u.ɵɵtemplate(5,$,1,0,"localize",73),u.ɵɵtemplate(6,J,1,0,"localize",74),u.ɵɵelementEnd(),u.ɵɵtemplate(7,Q,3,3,"button",71),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵtemplate(8,re,15,6,"tr",9),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2).$implicit,i=u.ɵɵnextContext(4);u.ɵɵadvance(3),u.ɵɵproperty("ngIf",r.oldValue&&r.newLayer),u.ɵɵadvance(1),u.ɵɵproperty("disabled",r.coordinate&&(null!=r.coordinate.longValid&&!r.coordinate.longValid||null!=r.coordinate.latValid&&!r.coordinate.latValid)),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!r.newLayer||!r.newLayer.isRendering),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.newLayer&&r.newLayer.isRendering),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.newLayer&&r.newLayer.isRendering),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.newLayer&&r.newLayer.isRendering&&("POINT"===i.geoObjectType.geometryType||"MULTIPOINT"===i.geoObjectType.geometryType)&&r.value&&r.value.coordinates&&(1==r.value.coordinates.length||0==r.value.coordinates.length))}}function oe(e,t){if(1&e&&(u.ɵɵelementStart(0,"tr",34),u.ɵɵelementStart(1,"td",35),u.ɵɵtemplate(2,R,4,8,"div",9),u.ɵɵtemplate(3,z,2,6,"div",9),u.ɵɵtemplate(4,P,2,9,"div",9),u.ɵɵtemplate(5,D,2,6,"div",9),u.ɵɵtemplate(6,A,9,21,"div",9),u.ɵɵtemplate(7,H,2,1,"div",9),u.ɵɵtemplate(8,G,4,1,"div",9),u.ɵɵtemplate(9,ie,9,6,"table",44),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext().$implicit,r=u.ɵɵnextContext(4);u.ɵɵadvance(2),u.ɵɵproperty("ngIf","term"===r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","character"===r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","date"===r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","integer"===r.attributeType.type||"float"===r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","boolean"===r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","_PARENT_"===r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",n.oldValue&&!r.isNew&&"geometry"!==r.attributeType.type),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","geometry"===r.attributeType.type)}}function ae(e,t){if(1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"p",68),u.ɵɵelement(2,"localize",43),u.ɵɵtext(3),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext().$implicit;u.ɵɵadvance(3),u.ɵɵtextInterpolate1(" ",n.oldStartDate," ")}}var le=function(e,t){return{"error-message":e,"warning-message":t}};function se(e,t){if(1&e&&(u.ɵɵelementStart(0,"p",54),u.ɵɵtext(1),u.ɵɵelementEnd()),2&e){var n=t.$implicit;u.ɵɵproperty("ngClass",u.ɵɵpureFunction2(2,le,"ERROR"===n.severity,"WARNING"===n.severity)),u.ɵɵadvance(1),u.ɵɵtextInterpolate1(" ",n.message," ")}}function ce(e,t){if(1&e&&(u.ɵɵelementStart(0,"tr"),u.ɵɵtemplate(1,se,2,5,"p",97),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext().$implicit;u.ɵɵadvance(1),u.ɵɵproperty("ngForOf",n.editor.conflictMessage)}}var de=function(e,t){return{"fa-times":e,"fa-undo":t}};function pe(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"td",98),u.ɵɵlistener("click",(function(){u.ɵɵrestoreView(n);var e=u.ɵɵnextContext().$implicit;return u.ɵɵnextContext(4).remove(e)})),u.ɵɵpipe(1,"localize"),u.ɵɵelement(2,"i",99),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext().$implicit;u.ɵɵproperty("title",u.ɵɵpipeBind1(1,3,"UNMODIFIED"===r.summaryKey?"changeovertime.manageVersions.remove.version":"changeovertime.manageVersions.revert.version")),u.ɵɵadvance(2),u.ɵɵclassMap(u.ɵɵpureFunction2(5,de,"UNMODIFIED"===r.summaryKey,"UNMODIFIED"!==r.summaryKey))}}var me=function(e,t,n){return{"error-border":e,"warning-border":t,"geometry-edit-active":n}},ue=function(e){return{warning:e}};function ge(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"tr",20),u.ɵɵelementStart(1,"td",21),u.ɵɵtemplate(2,O,2,1,"div",22),u.ɵɵelementStart(3,"table"),u.ɵɵtemplate(4,j,2,1,"ng-container",9),u.ɵɵtemplate(5,oe,10,8,"tr",23),u.ɵɵelementStart(6,"tr",24),u.ɵɵelementStart(7,"td"),u.ɵɵelementStart(8,"h5"),u.ɵɵelement(9,"localize",25),u.ɵɵelementEnd(),u.ɵɵelementStart(10,"date-field",26,27),u.ɵɵlistener("valueChange",(function(e){return t.$implicit.startDate=e}))("change",(function(){return u.ɵɵrestoreView(n),u.ɵɵnextContext(4).onDateChange()})),u.ɵɵelementEnd(),u.ɵɵtemplate(12,ae,4,1,"div",9),u.ɵɵelementEnd(),u.ɵɵelementStart(13,"td"),u.ɵɵelementStart(14,"div",28),u.ɵɵelementStart(15,"h5"),u.ɵɵelement(16,"localize",29),u.ɵɵelementEnd(),u.ɵɵelementStart(17,"date-field",30,27),u.ɵɵlistener("valueChange",(function(e){return t.$implicit.endDate=e}))("change",(function(){return u.ɵɵrestoreView(n),u.ɵɵnextContext(4).onDateChange()})),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵtemplate(19,ce,2,1,"tr",9),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵtemplate(20,pe,3,8,"td",31),u.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=t.index,o=u.ɵɵnextContext(4);u.ɵɵproperty("@fadeInOut",void 0)("ngClass",u.ɵɵpureFunction3(24,me,r.editor.conflictMessage&&r.editor.conflictMessage.length>0&&"ERROR"===r.editor.conflictMessage[0].severity,r.editor.conflictMessage&&r.editor.conflictMessage.length>0&&"WARNING"===r.editor.conflictMessage[0].severity,r.newLayer&&r.newLayer.isEditing)),u.ɵɵadvance(1),u.ɵɵproperty("ngClass",u.ɵɵpureFunction1(28,ue,r.summaryKey&&"UNMODIFIED"!==r.summaryKey)),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",r.summaryKey&&"UNMODIFIED"!==r.summaryKey),u.ɵɵadvance(2),u.ɵɵproperty("ngIf","local"===o.attributeType.type&&r.value),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","geometry"===o.attributeType.type||"_PARENT_"===o.attributeType.type||"term"===o.attributeType.type||"character"===o.attributeType.type||"date"===o.attributeType.type||"integer"===o.attributeType.type||"float"===o.attributeType.type||"boolean"===o.attributeType.type),u.ɵɵadvance(5),u.ɵɵproperty("customStyles",r.oldStartDate&&!o.isNew?"color: orange;":"")("value",r.startDate)("inputName","startDate_"+i)("allowFutureDates",!1)("required",!0)("disable",o.readonly||"DELETE"===r.summaryKey),u.ɵɵadvance(2),u.ɵɵproperty("ngIf",r.oldStartDate&&!o.isNew),u.ɵɵadvance(5),u.ɵɵproperty("customStyles",r.oldEndDate&&!o.isNew?"color: orange;":"")("value",r.endDate)("inputName","endDate_"+i)("allowInfinity","DELETE"!==r.summaryKey&&!o.readonly)("allowFutureDates",!0)("required",!0)("placement","bottom")("oldDate",r.oldEndDate&&!o.isNew?r.oldEndDate:null)("disable",o.readonly||"DELETE"===r.summaryKey),u.ɵɵadvance(2),u.ɵɵproperty("ngIf",r.editor.conflictMessage&&r.editor.conflictMessage.length>0),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!(o.readonly||o.isNew&&"exists"===o.attributeType.code))}}function he(e,t){if(1&e&&(u.ɵɵelementContainerStart(0),u.ɵɵtemplate(1,ge,21,30,"tr",19),u.ɵɵelementContainerEnd()),2&e){var n=u.ɵɵnextContext(3);u.ɵɵadvance(1),u.ɵɵproperty("ngForOf",n.viewModels)}}function fe(e,t){if(1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵelementStart(1,"table",13),u.ɵɵelementStart(2,"tbody",14),u.ɵɵtemplate(3,E,2,0,"p",15),u.ɵɵtemplate(4,x,2,0,"div",9),u.ɵɵtemplate(5,he,2,1,"ng-container",9),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext(2);u.ɵɵadvance(3),u.ɵɵproperty("ngIf",!n.isRootOfHierarchy&&0===n.viewModels.length),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",n.isRootOfHierarchy),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!n.isRootOfHierarchy)}}function ye(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"li",100),u.ɵɵelementStart(1,"i",101),u.ɵɵlistener("click",(function(){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).onAddNewVersion()})),u.ɵɵelement(2,"localize",102),u.ɵɵelementEnd(),u.ɵɵelementEnd()}}function ve(e,t){if(1&e){var n=u.ɵɵgetCurrentView();u.ɵɵelementStart(0,"div",103),u.ɵɵelementStart(1,"button",104),u.ɵɵlistener("click",(function(){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).onApprove()})),u.ɵɵpipe(2,"localize"),u.ɵɵelement(3,"localize",105),u.ɵɵelementEnd(),u.ɵɵelementStart(4,"button",106),u.ɵɵlistener("click",(function(){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).onReject()})),u.ɵɵpipe(5,"localize"),u.ɵɵelement(6,"localize",107),u.ɵɵelementEnd(),u.ɵɵelementStart(7,"button",108),u.ɵɵlistener("click",(function(){return u.ɵɵrestoreView(n),u.ɵɵnextContext(2).onPending()})),u.ɵɵpipe(8,"localize"),u.ɵɵelement(9,"localize",109),u.ɵɵelementEnd(),u.ɵɵelementEnd()}if(2&e){var r=u.ɵɵnextContext(2);u.ɵɵadvance(1),u.ɵɵproperty("disabled","ACCEPTED"===r.changeRequestAttributeEditor.editAction.approvalStatus)("title",u.ɵɵpipeBind1(2,6,"change.request.action.accept.btn.hover")),u.ɵɵadvance(3),u.ɵɵproperty("disabled","REJECTED"===r.changeRequestAttributeEditor.editAction.approvalStatus)("title",u.ɵɵpipeBind1(5,8,"change.request.action.reject.btn.hover")),u.ɵɵadvance(3),u.ɵɵproperty("disabled","PENDING"===r.changeRequestAttributeEditor.editAction.approvalStatus)("title",u.ɵɵpipeBind1(8,10,"change.request.action.pending.btn.hover"))}}function be(e,t){1&e&&(u.ɵɵelementStart(0,"strong",112),u.ɵɵelement(1,"localize",113),u.ɵɵelementEnd())}function Se(e,t){1&e&&(u.ɵɵelementStart(0,"strong",114),u.ɵɵelement(1,"localize",115),u.ɵɵelementEnd())}function Ce(e,t){if(1&e&&(u.ɵɵelementStart(0,"div",103),u.ɵɵtemplate(1,be,2,0,"strong",110),u.ɵɵtemplate(2,Se,2,0,"strong",111),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext(2);u.ɵɵadvance(1),u.ɵɵproperty("ngIf","ACCEPTED"===n.changeRequestAttributeEditor.editAction.approvalStatus),u.ɵɵadvance(1),u.ɵɵproperty("ngIf","REJECTED"===n.changeRequestAttributeEditor.editAction.approvalStatus)}}function Ee(e,t){if(1&e&&(u.ɵɵelementStart(0,"div",6),u.ɵɵelementStart(1,"ul",7),u.ɵɵelementStart(2,"li",8),u.ɵɵtemplate(3,fe,6,3,"div",9),u.ɵɵelementEnd(),u.ɵɵtemplate(4,ye,3,0,"li",10),u.ɵɵelementEnd(),u.ɵɵtemplate(5,ve,10,12,"div",11),u.ɵɵtemplate(6,Ce,3,2,"div",12),u.ɵɵelementEnd()),2&e){var n=u.ɵɵnextContext();u.ɵɵadvance(3),u.ɵɵproperty("ngIf",n.attributeType),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!(n.readonly||n.isRootOfHierarchy||n.isNew&&"exists"===n.attributeType.code)),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!n.changeRequestEditor.changeRequest.isNew&&"PENDING"===n.changeRequestEditor.changeRequest.approvalStatus&&n.changeRequestEditor.changeRequest.permissions.includes("WRITE_APPROVAL_STATUS")&&n.changeRequestAttributeEditor.hasChanges()),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",!n.changeRequestEditor.changeRequest.isNew&&"PENDING"!==n.changeRequestEditor.changeRequest.approvalStatus)}}function xe(e,t){if(1&e&&u.ɵɵelement(0,"geoobject-editor-map",116,117),2&e){var n=u.ɵɵnextContext();u.ɵɵproperty("geometryType",n.geoObjectType.geometryType)("mapHeight",n.mapRowHeight)("readOnly",!n.geoObjectType.isGeometryEditable&&n.readonly)("bboxCode",n.changeRequestEditor.geoObject.attributes.code)("bboxType",n.geoObjectType.code)("bboxDate",n.geomService.getRenderedLayers()[0].startDate)}}var Oe=function(e){return{width:e}},Ie=function(){function e(e,t,n,i,o,a,l,s,c,d){this.geomService=e,this.cdr=t,this.service=n,this.lService=i,this.changeDetectorRef=o,this.dateService=a,this.authService=l,this.requestService=s,this.modalService=c,this.elementRef=d,this.isNew=!1,this.message=null,this.currentDate=new Date,this.isValid=!0,this.isValidChange=new r.EventEmitter,this.readonly=!1,this.isGeometryInlined=!1,this.hierarchy=null,this.viewModels=[],this.isRootOfHierarchy=!1}return e.prototype.ngOnInit=function(){this.changeRequestAttributeEditor=this.changeRequestEditor.getEditorForAttribute(this.attributeType,this.hierarchy),this.calculateViewModels(),this.isRootOfHierarchy="_PARENT_"===this.attributeType.type&&(null==this.hierarchy||null==this.hierarchy.types||0===this.hierarchy.types.length)},e.prototype.ngAfterViewInit=function(){this.isNew&&"exists"===this.attributeType.code&&0===this.viewModels.length&&this.onAddNewVersion()},e.prototype.checkDateFieldValidity=function(){for(var e=this.dateFieldComponentsArray.toArray(),t=0;t<e.length;t++){if(!e[t].valid)return!1}return!0},e.prototype.hasLocalizationChanged=function(e,t){return null!=e.editor.oldValue&&this.getValueAtLocale(e.editor.oldValue,t)!==this.getValueAtLocale(e.editor.value,t)},e.prototype.onDateChange=function(){var e=this;setTimeout((function(){e.isValid=e.changeRequestAttributeEditor.validate()&&e.checkDateFieldValidity(),e.isValidChange.emit(e.isValid)}),0)},e.prototype.remove=function(e){if(this.geomService.isEditing()&&this.geomService.stopEditing(),this.changeRequestAttributeEditor.remove(e.editor),e.summaryKey===a.SummaryKey.NEW||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type){var t=this.viewModels.findIndex((function(t){return t.editor.oid===e.editor.oid}));t>-1&&this.viewModels.splice(t,1)}"geometry"===this.attributeType.type&&this.geomService.reload()},e.prototype.onAddNewVersion=function(){var e=this.changeRequestAttributeEditor.createNewVersion();if(this.isNew&&this.changeRequestEditor.geoObject.attributes.exists){var t=this.changeRequestEditor.geoObject.attributes.exists.values;if(t&&t.length>0){var n=t[0];e.startDate=n.startDate,e.endDate=n.endDate}}this.viewModels.push(new d.VersionDiffView(this,e))},e.prototype.getValueAtLocale=function(e,t){return null==e?null:new l.LocalizedValue(e.localizedValue,e.localeValues).getValue(t)},e.prototype.getGeoObjectTypeTermAttributeOptions=function(e){return o.GeoObjectType.getGeoObjectTypeTermAttributeOptions(this.geoObjectType,e)},e.prototype.calculateViewModels=function(){var e=this,t=[],n=!1;(null==this.changeRequestEditor.changeRequest||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type||"ACCEPTED"!==this.changeRequestEditor.changeRequest.approvalStatus&&"PARTIAL"!==this.changeRequestEditor.changeRequest.approvalStatus&&"REJECTED"!==this.changeRequestEditor.changeRequest.approvalStatus)&&(n=!0),this.changeRequestAttributeEditor.getEditors(n).forEach((function(n){var r=new d.VersionDiffView(e,n);t.push(r)})),this.viewModels=t},e.prototype.onApprove=function(){var e=this;this.requestService.setActionStatus(this.changeRequestAttributeEditor.editAction.oid,s.GovernanceStatus.ACCEPTED).then((function(t){e.changeRequestAttributeEditor.editAction.approvalStatus=s.GovernanceStatus.ACCEPTED})).catch((function(t){e.error(t)}))},e.prototype.onReject=function(){var e=this;this.requestService.setActionStatus(this.changeRequestAttributeEditor.editAction.oid,s.GovernanceStatus.REJECTED).then((function(t){e.changeRequestAttributeEditor.editAction.approvalStatus=s.GovernanceStatus.REJECTED})).catch((function(t){e.error(t)}))},e.prototype.onPending=function(){var e=this;this.requestService.setActionStatus(this.changeRequestAttributeEditor.editAction.oid,s.GovernanceStatus.PENDING).then((function(t){e.changeRequestAttributeEditor.editAction.approvalStatus=s.GovernanceStatus.PENDING})).catch((function(t){e.error(t)}))},e.prototype.error=function(e){this.bsModalRef=c.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.prototype.getTypeAheadObservable=function(e,t,n,r,i){var o=this,a=n.code,l=null,s=null,c=null;if(i>0){var d=e.changeRequestAttributeEditor.hierarchy.types[i-1],p=r.parents[d.code];null!=p.geoObject&&null!=p.geoObject.properties.code&&(c=e.changeRequestAttributeEditor.hierarchy.code,l=p.geoObject.properties.code,s=p.geoObject.properties.type)}return m.Observable.create((function(d){if(null==l)for(var p=i;null==l&&p>0;){p-=1;var m=r.parents[e.changeRequestAttributeEditor.hierarchy.types[p].code];null!=m&&(null!=m.geoObject&&null!=m.geoObject.properties.code?(l=m.geoObject.properties.code,c=e.changeRequestAttributeEditor.hierarchy.code,s=e.changeRequestAttributeEditor.hierarchy.types[p].code):null!=m.goCode&&(l=m.goCode,c=e.changeRequestAttributeEditor.hierarchy.code,s=e.changeRequestAttributeEditor.hierarchy.types[p].code))}o.service.getGeoObjectSuggestions(r.parents[n.code].text,a,l,s,c,t).then((function(e){d.next(e)}))}))},e.prototype.typeaheadOnSelect=function(e,t,n,r,i){r.parents[n.code].text=t.item.name+" : "+t.item.code,r.parents[n.code].goCode=t.item.code;for(var o=[],a=0;a<e.changeRequestAttributeEditor.hierarchy.types.length;a++){var l=e.changeRequestAttributeEditor.hierarchy.types[a];if(o.push(l.code),l.code===n.code)break}this.service.getParentGeoObjects(t.item.uid,n.code,o,!0,i).then((function(t){t.parents=t.parents.filter((function(t){return t.hierarchyType===e.changeRequestAttributeEditor.hierarchy.code})),delete r.parents[n.code].goCode,r.parents[n.code].geoObject=t.geoObject,r.parents[n.code].text=t.geoObject.properties.displayLabel.localizedValue+" : "+t.geoObject.properties.code;for(var i=0;i<e.changeRequestAttributeEditor.hierarchy.types.length;i++){for(var o=e.changeRequestAttributeEditor.hierarchy.types[i],a=t;null!=a&&a.geoObject.properties.type!==o.code;)a=a.parents.length>0?a.parents[0]:null;null!=a&&(r.parents[o.code].geoObject=a.geoObject,r.parents[o.code].text=a.geoObject.properties.displayLabel.localizedValue+" : "+a.geoObject.properties.code)}e.setParentValue(n,r.parents)}))},e.prototype.toggleGeometryEditing=function(e){this.geomService.setEditing(!e.newLayer.isEditing,e.newLayer),"POINT"!==this.geoObjectType.geometryType&&"MULTIPOINT"!==this.geoObjectType.geometryType||(e.coordinate={})},e.prototype.toggleGeometryView=function(e){var t=this;setTimeout((function(){t.mapRowHeight=t.elementRef.nativeElement.children[0].getElementsByClassName("attribute-element-wrapper")[0].offsetHeight}),0);var n=this.getOrCreateLayer(e,"NEW");n.isEditing&&this.geomService.stopEditing(),this.geomService.setRendering(!n.isRendering,n)},e.prototype.toggleOldGeometryView=function(e){var t=this.getOrCreateLayer(e,"OLD");this.geomService.setRendering(!t.isRendering,t)},e.prototype.getOrCreateLayer=function(e,t){return"NEW"===t?(null!=e.newLayer||(e.newLayer=new d.Layer,e.newLayer.oid="NEW_"+e.editor.oid,e.newLayer.isEditing=!1,e.newLayer.isRendering=!1,e.newLayer.zindex=1,e.newLayer.color=s.LayerColor.NEW,e.newLayer.geojson=e.editor.value,e.newLayer.editPropagator=e.editor),e.newLayer):(null!=e.oldLayer||(e.oldLayer=new d.Layer,e.oldLayer.oid="OLD_"+e.editor.oid,e.oldLayer.isEditing=!1,e.oldLayer.isRendering=!1,e.oldLayer.zindex=0,e.oldLayer.color=s.LayerColor.OLD,e.oldLayer.geojson=e.editor.oldValue,e.oldLayer.editPropagator=null),e.oldLayer)},e.prototype.manualCoordinateChange=function(e){if(e.newCoordinateX||e.newCoordinateY){var t=e.newCoordinateX;e.value.coordinates&&e.value.coordinates[0]&&(t=e.value.coordinates[0]);var n=e.newCoordinateY;return e.value.coordinates&&e.value.coordinates[0]&&(n=e.value.coordinates[1]),e.value.coordinates=[[t||0,n||0]],delete e.newCoordinateX,void delete e.newCoordinateY}var r;if(e.coordinate.latValid=(r=e.value.coordinates[0][1],isFinite(r)&&Math.abs(r)<=90),e.coordinate.longValid=function(e){return isFinite(e)&&Math.abs(e)<=180}(e.value.coordinates[0][0]),!e.coordinate.latValid||!e.coordinate.longValid)return this.isValid=!1,void this.isValidChange.emit(this.isValid);this.geomService.setPointCoordinates(e.value.coordinates[0][1],e.value.coordinates[0][0])},e.ɵfac=function(t){return new(t||e)(u.ɵɵdirectiveInject(g.GeometryService),u.ɵɵdirectiveInject(u.ChangeDetectorRef),u.ɵɵdirectiveInject(g.RegistryService),u.ɵɵdirectiveInject(h.LocalizationService),u.ɵɵdirectiveInject(u.ChangeDetectorRef),u.ɵɵdirectiveInject(f.DateService),u.ɵɵdirectiveInject(y.AuthService),u.ɵɵdirectiveInject(v.ChangeRequestService),u.ɵɵdirectiveInject(b.BsModalService),u.ɵɵdirectiveInject(u.ElementRef))},e.ɵcmp=u.ɵɵdefineComponent({type:e,selectors:[["manage-versions"]],viewQuery:function(e,t){if(1&e&&u.ɵɵviewQuery(S,1),2&e){var n;u.ɵɵqueryRefresh(n=u.ɵɵloadQuery())&&(t.dateFieldComponentsArray=n)}},hostVars:1,hostBindings:function(e,t){2&e&&u.ɵɵsyntheticHostProperty("@fadeInOut",!0)},inputs:{isNew:"isNew",readonly:"readonly",isGeometryInlined:"isGeometryInlined",changeRequestEditor:"changeRequestEditor",geoObjectType:"geoObjectType",attributeType:"attributeType",hierarchy:"hierarchy"},outputs:{isValidChange:"isValidChange"},features:[u.ɵɵProvidersFeature([],[{provide:p.ControlContainer,useExisting:p.NgForm}])],decls:9,vars:5,consts:[["customItemTemplate",""],["name","manage-versions-form","autocomplete","off"],[1,"row"],[1,"col",2,"display","inline-block",3,"ngStyle"],["class","attribute-version-wrapper",4,"ngIf"],["style","width:55%;display:inline-block;vertical-align:top;margin-top:15px;",3,"geometryType","mapHeight","readOnly","bboxCode","bboxType","bboxDate",4,"ngIf"],[1,"attribute-version-wrapper"],[1,"list-group"],[1,"list-group-item",2,"text-align","left","padding","0"],[4,"ngIf"],["class","list-group-item","style","text-align: left;",4,"ngIf"],["style","margin-left: 15px;",4,"ngIf"],["style","margin-left:15px;",4,"ngIf"],[1,"table","table-striped"],[1,"attribute-element-wrapper"],["class","message",4,"ngIf"],[1,"message"],["key","changeovertime.manageVersions.no.versions.message"],["key","changeovertime.manageVersions.rootOfHierarchy.message"],["class","version-row",3,"ngClass",4,"ngFor","ngForOf"],[1,"version-row",3,"ngClass"],[1,"version-column-wrapper",3,"ngClass"],["class","version-column-indicator",4,"ngIf"],["class","attribute-value-row",4,"ngIf"],[1,"attribute-date-input-row"],["key","changeovertime.manageVersions.tableHeader.label.startDate"],["label","",3,"customStyles","value","inputName","allowFutureDates","required","disable","valueChange","change"],["dateFieldComponents",""],[1,"version-edit-date-container"],["key","changeovertime.manageVersions.tableHeader.label.endDate"],["label","",3,"customStyles","value","inputName","allowInfinity","allowFutureDates","required","placement","oldDate","disable","valueChange","change"],["class","manage-version-button clickable",3,"title","click",4,"ngIf"],[1,"version-column-indicator"],["class","attribute-value-row",4,"ngFor","ngForOf"],[1,"attribute-value-row"],["colspan","2"],[3,"key"],["type","text",1,"form-control",3,"ngClass","disabled","name","ngModel","required","ngModelChange"],[1,"form-input-validation-error-message-wrapper"],["class","error-message",4,"ngIf"],[1,"error-message"],["key","manage.versions.value.required.message"],[1,"warning-text","display-current-value",2,"padding","5px 0","margin-bottom","0"],["key","change.request.changed.value.prefix"],["style","padding:0;",4,"ngIf"],[1,"select-area",3,"ngClass","id","name","ngModel","disabled","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","text","required","",1,"form-control",3,"ngClass","name","ngModel","disabled","ngModelChange"],["label","",3,"customStyles","value","inputName","allowInfinity","allowFutureDates","required","placement","valid","disable","valueChange","validChange"],["type","number","required","",1,"form-control",3,"ngClass","name","ngModel","disabled","ngModelChange"],[1,"radio","radio-inline",2,"padding-left","0"],["type","radio",1,"inline-radio-input",3,"checked","value","ngModel","id","name","disabled","ngModelChange"],[3,"ngClass"],["key","change.request.boolean.option.true"],[1,"radio","radio-inline"],["type","radio",1,"inline-radio-input",3,"ngClass","checked","value","ngModel","id","name","disabled","ngModelChange"],["key","change.request.boolean.option.false"],["style","float:left;width:100%;",4,"ngFor","ngForOf"],[2,"float","left","width","100%"],[1,"input-group"],["type","text","autocomplete","off",1,"form-control",2,"width","100%",3,"name","disabled","ngModel","typeaheadAsync","typeahead","ngClass","typeaheadOptionsLimit","typeaheadItemTemplate","typeaheadMinLength","typeaheadWaitMs","ngModelChange","typeaheadOnSelect","typeaheadLoading"],["class","input-group-addon clickable addon-alert",3,"click",4,"ngIf"],["class","input-group-addon addon-alert",4,"ngIf"],[1,"input-group-addon","clickable","addon-alert",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"input-group-addon","addon-alert"],[1,"warning-text","display-current-value"],[2,"padding","0"],["colspan","2",2,"padding-left","0"],["class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","button",1,"btn","btn-primary",2,"margin-left","0",3,"disabled","click"],["key","changeovertime.manageVersions.geometry.view",4,"ngIf"],["key","changeovertime.manageVersions.geometry.hide",4,"ngIf"],["role","button",1,"btn","btn-primary",3,"disabled","click"],["key","changeovertime.manageVersions.geometry.viewOld",4,"ngIf"],["key","changeovertime.manageVersions.geometry.hideOld",4,"ngIf"],["key","changeovertime.manageVersions.geometry.viewOld"],["key","changeovertime.manageVersions.geometry.hideOld"],["key","changeovertime.manageVersions.geometry.view"],["key","changeovertime.manageVersions.geometry.hide"],["key","changeovertime.manageVersions.geometry.edit",4,"ngIf"],["key","changeovertime.manageVersions.geometry.save",4,"ngIf"],["key","changeovertime.manageVersions.geometry.edit"],["key","changeovertime.manageVersions.geometry.save"],[2,"width","50%","padding-left","0","padding-right","5px"],["key","geoobject.editor.geometry.latitude.label"],[1,"text-left"],["name","latitude","type","number","class","form-control","required","",3,"readonly","ngModel","ngModelChange","change",4,"ngIf"],[2,"width","50%"],["key","geoobject.editor.geometry.longitude.label"],["name","longitude","type","number","class","form-control","required","",3,"readonly","ngModel","ngModelChange","change",4,"ngIf"],["name","latitude","type","number","required","",1,"form-control",3,"readonly","ngModel","ngModelChange","change"],["key","change.request.geometry.invalidLatitude"],["name","longitude","type","number","required","",1,"form-control",3,"readonly","ngModel","ngModelChange","change"],["key","change.request.geometry.invalidLongitude"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"manage-version-button","clickable",3,"title","click"],[1,"fa"],[1,"list-group-item",2,"text-align","left"],[1,"fa","fa-plus","clickable",3,"click"],["key","changeovertime.manageVersions.newVersion"],[2,"margin-left","15px"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","title","click"],["key","change.request.accept.btn"],["type","submit","role","button",1,"btn","btn-danger",3,"disabled","title","click"],["key","change.request.reject.btn"],["type","submit","role","button",1,"btn","btn-warning",3,"disabled","title","click"],["key","change.request.pending.btn"],["style","color:#6BA542;",4,"ngIf"],["style","color:#6d0400;",4,"ngIf"],[2,"color","#6BA542"],["key","change.request.status.accepted"],[2,"color","#6d0400"],["key","change.request.status.rejected"],[2,"width","55%","display","inline-block","vertical-align","top","margin-top","15px",3,"geometryType","mapHeight","readOnly","bboxCode","bboxType","bboxDate"],["geometryEditor",""]],template:function(e,t){1&e&&(u.ɵɵelementStart(0,"div"),u.ɵɵtemplate(1,C,2,2,"ng-template",null,0,u.ɵɵtemplateRefExtractor),u.ɵɵelementStart(3,"form",1),u.ɵɵelementStart(4,"fieldset"),u.ɵɵelementStart(5,"div",2),u.ɵɵelementStart(6,"div",3),u.ɵɵtemplate(7,Ee,7,4,"div",4),u.ɵɵelementEnd(),u.ɵɵtemplate(8,xe,2,6,"geoobject-editor-map",5),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementEnd(),u.ɵɵelementEnd()),2&e&&(u.ɵɵadvance(6),u.ɵɵproperty("ngStyle",u.ɵɵpureFunction1(3,Oe,t.isGeometryInlined&&t.geomService.getRenderedLayers().length>0?"45%":"100%")),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",t.changeRequestEditor.geoObject),u.ɵɵadvance(1),u.ɵɵproperty("ngIf",t.isGeometryInlined&&t.geomService.getRenderedLayers().length>0))},styles:["table[_ngcontent-%COMP%] {\n border-collapse: separate;\n padding: 15px;\n}\n\n.geometry-edit-active[_ngcontent-%COMP%] {\n  background-color: #f4fcef !important;\n  border: solid 1px #6BA542 !important;\n  \n}\n\np.warning-text.display-current-value[_ngcontent-%COMP%] {\n  font-size: 12px;\n  font-weight: bold;\n}\n\n.version-column-wrapper[_ngcontent-%COMP%] {\n\tpadding-top: 0px;\n\tpadding-left: 0px;\n\tborder: solid 1px lightgrey;\n}\n.version-column-wrapper.warning[_ngcontent-%COMP%] {\n    background-color: inherit;\n    border-color: orange;\n    border-left: solid 5px orange;\n}\n\n.version-column-wrapper[_ngcontent-%COMP%]   .version-column-indicator[_ngcontent-%COMP%] {\n\tposition: relative;\n\tbackground: grey;\n    color: white;\n    left: -1px;\n    font-size: 14px;\n    font-weight: bold;\n    padding: 0 6px;\n    width: fit-content;\n    top: -1px;\n}\n.version-column-wrapper.warning[_ngcontent-%COMP%]   .version-column-indicator[_ngcontent-%COMP%] {\n    background-color: orange;\n}\n\n.version-column-wrapper[_ngcontent-%COMP%]   .manage-version-button[_ngcontent-%COMP%] {\n    border: solid 1px lightgrey;\n}\n.version-column-wrapper.warning[_ngcontent-%COMP%]   .manage-version-button[_ngcontent-%COMP%] {\n border-color: orange;\n}\n\n.has-changed[_ngcontent-%COMP%] {\n\tcolor: orange;\n}\n\n.version-row[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] {\n padding-left: 10px;\n}\n.version-row[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\n padding-left: 5px;\n}\n\n.list-group[_ngcontent-%COMP%] {\n margin-bottom: 0;\n}"],data:{animation:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}}),e}();t.ManageVersionsComponent=Ie,("undefined"==typeof ngDevMode||ngDevMode)&&u.ɵsetClassMetadata(Ie,[{type:r.Component,args:[{selector:"manage-versions",templateUrl:"./manage-versions.component.html",styleUrls:["./manage-versions.css"],host:{"[@fadeInOut]":"true"},animations:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]],viewProviders:[{provide:p.ControlContainer,useExisting:p.NgForm}]}]}],(function(){return[{type:g.GeometryService},{type:u.ChangeDetectorRef},{type:g.RegistryService},{type:h.LocalizationService},{type:u.ChangeDetectorRef},{type:f.DateService},{type:y.AuthService},{type:v.ChangeRequestService},{type:b.BsModalService},{type:u.ElementRef}]}),{isNew:[{type:r.Input}],dateFieldComponentsArray:[{type:r.ViewChildren,args:["dateFieldComponents"]}],isValidChange:[{type:r.Output}],readonly:[{type:r.Input}],isGeometryInlined:[{type:r.Input}],changeRequestEditor:[{type:r.Input}],geoObjectType:[{type:r.Input}],attributeType:[{type:r.Input}],hierarchy:[{type:r.Input}]})},587:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardAttributeEditorComponent=void 0;var r=n(0),i=n(7),o=(n(203),n(520)),a=n(258),l=(n(87),n(111)),s=(n(30),n(518),n(521),n(112),n(16),n(22)),c=(n(552),n(0)),d=n(518),p=n(16),m=n(112),u=n(87),g=n(521),h=n(30),f=n(1),y=n(22),v=n(68),b=n(113);function S(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",7),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext(2);c.ɵɵadvance(1),c.ɵɵtextInterpolate1(" ",n.view.summaryKeyLocalized," ")}}var C=function(e){return{"has-changed":e}};function E(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"label",8),c.ɵɵelementStart(2,"input",9),c.ɵɵlistener("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onValueChange()}))("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).changeRequestAttributeEditor.value=e})),c.ɵɵelementEnd(),c.ɵɵelementStart(3,"span",10),c.ɵɵelement(4,"localize",11),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(5,"label",12),c.ɵɵelementStart(6,"input",13),c.ɵɵlistener("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onValueChange()}))("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).changeRequestAttributeEditor.value=e})),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"span",10),c.ɵɵelement(8,"localize",14),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2);c.ɵɵadvance(2),c.ɵɵpropertyInterpolate1("id","mod-",r.geoObjectType.code,"-true"),c.ɵɵpropertyInterpolate1("name","mod-",r.geoObjectType.code,"-true"),c.ɵɵproperty("checked",!0===r.view.value)("value",!0)("ngModel",r.changeRequestAttributeEditor.value)("disabled",r.readonly),c.ɵɵadvance(1),c.ɵɵproperty("ngClass",c.ɵɵpureFunction1(15,C,r.view.oldValue&&!r.isNew)),c.ɵɵadvance(3),c.ɵɵpropertyInterpolate1("id","mod-",r.geoObjectType.code,"-false"),c.ɵɵpropertyInterpolate1("name","mod-",r.geoObjectType.code,"-false"),c.ɵɵproperty("ngClass",c.ɵɵpureFunction1(17,C,r.view.oldValue&&!r.isNew))("checked",!1===r.changeRequestAttributeEditor.value)("value",!1)("ngModel",r.changeRequestAttributeEditor.value)("disabled",r.readonly),c.ɵɵadvance(1),c.ɵɵproperty("ngClass",c.ɵɵpureFunction1(19,C,r.view.oldValue&&!r.isNew))}}function x(e,t){if(1&e&&(c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"p",15),c.ɵɵelement(2,"localize",16),c.ɵɵtext(3),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext(2);c.ɵɵadvance(3),c.ɵɵtextInterpolate1(" ",n.view.oldValue," ")}}var O=function(e){return{warning:e}};function I(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",3),c.ɵɵtemplate(1,S,2,1,"div",4),c.ɵɵelementStart(2,"div",5),c.ɵɵtemplate(3,E,9,21,"div",6),c.ɵɵtemplate(4,x,4,1,"div",6),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵproperty("ngClass",c.ɵɵpureFunction1(4,O,n.view.summaryKey&&"UNMODIFIED"!==n.view.summaryKey)),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",n.view.summaryKey&&"UNMODIFIED"!==n.view.summaryKey),c.ɵɵadvance(2),c.ɵɵproperty("ngIf","boolean"===n.attributeType.type),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",null!==n.view.oldValue&&void 0!==n.view.oldValue&&!n.isNew)}}function w(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"button",18),c.ɵɵlistener("click",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onApprove()})),c.ɵɵpipe(2,"localize"),c.ɵɵelement(3,"localize",19),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"button",20),c.ɵɵlistener("click",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onReject()})),c.ɵɵpipe(5,"localize"),c.ɵɵelement(6,"localize",21),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"button",22),c.ɵɵlistener("click",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).onPending()})),c.ɵɵpipe(8,"localize"),c.ɵɵelement(9,"localize",23),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2);c.ɵɵadvance(1),c.ɵɵproperty("disabled","ACCEPTED"===r.changeRequestAttributeEditor.editAction.approvalStatus)("title",c.ɵɵpipeBind1(2,6,"change.request.action.accept.btn.hover")),c.ɵɵadvance(3),c.ɵɵproperty("disabled","REJECTED"===r.changeRequestAttributeEditor.editAction.approvalStatus)("title",c.ɵɵpipeBind1(5,8,"change.request.action.reject.btn.hover")),c.ɵɵadvance(3),c.ɵɵproperty("disabled","PENDING"===r.changeRequestAttributeEditor.editAction.approvalStatus)("title",c.ɵɵpipeBind1(8,10,"change.request.action.pending.btn.hover"))}}function M(e,t){1&e&&(c.ɵɵelementStart(0,"strong",26),c.ɵɵelement(1,"localize",27),c.ɵɵelementEnd())}function T(e,t){1&e&&(c.ɵɵelementStart(0,"strong",28),c.ɵɵelement(1,"localize",29),c.ɵɵelementEnd())}function j(e,t){if(1&e&&(c.ɵɵelementStart(0,"div"),c.ɵɵtemplate(1,M,2,0,"strong",24),c.ɵɵtemplate(2,T,2,0,"strong",25),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext(2);c.ɵɵadvance(1),c.ɵɵproperty("ngIf","ACCEPTED"===n.changeRequestAttributeEditor.editAction.approvalStatus),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","REJECTED"===n.changeRequestAttributeEditor.editAction.approvalStatus)}}function k(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",17),c.ɵɵtemplate(1,w,10,12,"div",6),c.ɵɵtemplate(2,j,3,2,"div",6),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(1),c.ɵɵproperty("ngIf","PENDING"===n.changeRequest.approvalStatus&&n.changeRequest.permissions.includes("WRITE_APPROVAL_STATUS")&&n.changeRequestAttributeEditor.editAction&&n.changeRequestAttributeEditor.diff),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","PENDING"!==n.changeRequest.approvalStatus)}}var R=function(){function e(e,t,n,i,o,a,l,s,c){this.cdr=e,this.service=t,this.lService=n,this.changeDetectorRef=i,this.dateService=o,this.authService=a,this.requestService=l,this.modalService=s,this.elementRef=c,this.isNew=!1,this.message=null,this.isValid=!0,this.isValidChange=new r.EventEmitter,this.readonly=!1,this.isNewGeoObject=!1}return e.prototype.ngOnInit=function(){this.changeRequestAttributeEditor=this.changeRequestEditor.getEditorForAttribute(this.attributeType,null),this.calculateView()},e.prototype.ngAfterViewInit=function(){},e.prototype.calculateView=function(){var e=this.changeRequestAttributeEditor.diff;if(null!=e){var t=null==e.newValue?null:JSON.parse(JSON.stringify(e.newValue));this.view={value:t,summaryKey:o.SummaryKey.VALUE_CHANGE,summaryKeyLocalized:this.lService.decode("changeovertime.manageVersions.summaryKey."+o.SummaryKey.VALUE_CHANGE)},null!==e.oldValue&&void 0!==e.oldValue&&(this.view.oldValue=JSON.parse(JSON.stringify(e.oldValue)))}else this.view={value:this.changeRequestAttributeEditor.value,summaryKey:o.SummaryKey.UNMODIFIED,summaryKeyLocalized:this.lService.decode("changeovertime.manageVersions.summaryKey."+o.SummaryKey.UNMODIFIED)}},e.prototype.onValueChange=function(){this.calculateView()},e.prototype.onApprove=function(){var e=this,t=this.changeRequestAttributeEditor.editAction;this.requestService.setActionStatus(t.oid,a.GovernanceStatus.ACCEPTED).then((function(e){t.approvalStatus=a.GovernanceStatus.ACCEPTED})).catch((function(t){e.error(t)}))},e.prototype.onReject=function(){var e=this,t=this.changeRequestAttributeEditor.editAction;this.requestService.setActionStatus(t.oid,a.GovernanceStatus.REJECTED).then((function(e){t.approvalStatus=a.GovernanceStatus.REJECTED})).catch((function(t){e.error(t)}))},e.prototype.onPending=function(){var e=this,t=this.changeRequestAttributeEditor.editAction;this.requestService.setActionStatus(t.oid,a.GovernanceStatus.PENDING).then((function(e){t.approvalStatus=a.GovernanceStatus.PENDING})).catch((function(t){e.error(t)}))},e.prototype.error=function(e){this.bsModalRef=l.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(c.ɵɵdirectiveInject(c.ChangeDetectorRef),c.ɵɵdirectiveInject(d.RegistryService),c.ɵɵdirectiveInject(p.LocalizationService),c.ɵɵdirectiveInject(c.ChangeDetectorRef),c.ɵɵdirectiveInject(m.DateService),c.ɵɵdirectiveInject(u.AuthService),c.ɵɵdirectiveInject(g.ChangeRequestService),c.ɵɵdirectiveInject(h.BsModalService),c.ɵɵdirectiveInject(c.ElementRef))},e.ɵcmp=c.ɵɵdefineComponent({type:e,selectors:[["standard-attribute-editor"]],hostVars:1,hostBindings:function(e,t){2&e&&c.ɵɵsyntheticHostProperty("@fadeInOut",!0)},inputs:{isNew:"isNew",readonly:"readonly",attributeType:"attributeType",changeRequest:"changeRequest",geoObjectType:"geoObjectType",geoObject:"geoObject",isNewGeoObject:"isNewGeoObject",changeRequestEditor:"changeRequestEditor"},outputs:{isValidChange:"isValidChange"},features:[c.ɵɵProvidersFeature([],[{provide:s.ControlContainer,useExisting:s.NgForm}])],decls:4,vars:3,consts:[[1,"value-box"],["class","value-box-wrapper",3,"ngClass",4,"ngIf"],["class","cr-maintainer-options",4,"ngIf"],[1,"value-box-wrapper",3,"ngClass"],["class","value-box-indicator",4,"ngIf"],[1,"inner-value"],[4,"ngIf"],[1,"value-box-indicator"],[1,"radio","radio-inline",2,"padding-left","0"],["type","radio",1,"inline-radio-input",3,"checked","value","ngModel","id","name","disabled","change","ngModelChange"],[3,"ngClass"],["key","change.request.boolean.option.true"],[1,"radio","radio-inline"],["type","radio",1,"inline-radio-input",3,"ngClass","checked","value","ngModel","id","name","disabled","change","ngModelChange"],["key","change.request.boolean.option.false"],[1,"warning-text","display-current-value"],["key","change.request.changed.value.prefix"],[1,"cr-maintainer-options"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","title","click"],["key","change.request.accept.btn"],["type","submit","role","button",1,"btn","btn-danger",3,"disabled","title","click"],["key","change.request.reject.btn"],["type","submit","role","button",1,"btn","btn-warning",3,"disabled","title","click"],["key","change.request.pending.btn"],["style","color:#6BA542;",4,"ngIf"],["style","color:#6d0400;",4,"ngIf"],[2,"color","#6BA542"],["key","change.request.status.accepted"],[2,"color","#6d0400"],["key","change.request.status.rejected"]],template:function(e,t){1&e&&(c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"div",0),c.ɵɵtemplate(2,I,5,6,"div",1),c.ɵɵelementEnd(),c.ɵɵtemplate(3,k,3,2,"div",2),c.ɵɵelementEnd()),2&e&&(c.ɵɵadvance(1),c.ɵɵproperty("@fadeInOut",void 0),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.view),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.changeRequest&&!t.changeRequest.isNew))},directives:[f.NgIf,f.NgClass,y.RadioControlValueAccessor,y.DefaultValueAccessor,y.NgControlStatus,y.NgModel,v.LocalizeComponent],pipes:[b.LocalizePipe],styles:[".cr-maintainer-options[_ngcontent-%COMP%] {\n\tpadding-top:15px;\n}\n\np.warning-text.display-current-value[_ngcontent-%COMP%] {\n  font-size: 12px;\n  font-weight: bold;\n}\n\n.value-box-wrapper[_ngcontent-%COMP%] {\n\tpadding-top: 0px;\n\tpadding-left: 0px;\n\tborder: solid 1px lightgrey;\n}\n.value-box-wrapper.warning[_ngcontent-%COMP%] {\n    background-color: inherit;\n    border-color: orange;\n    border-left: solid 5px orange;\n}\n\n.value-box[_ngcontent-%COMP%] {\n background-color: #f9f9f9;\n margin-top: 10px;\n}\n\n.value-box[_ngcontent-%COMP%]   .inner-value[_ngcontent-%COMP%] {\n\tpadding-left: 10px;\n}\n\n.value-box-wrapper[_ngcontent-%COMP%]   .value-box-indicator[_ngcontent-%COMP%] {\n\tposition: relative;\n\tbackground: grey;\n    color: white;\n    left: -1px;\n    font-size: 14px;\n    font-weight: bold;\n    padding: 0 6px;\n    width: fit-content;\n    top: -1px;\n}\n.value-box-wrapper.warning[_ngcontent-%COMP%]   .value-box-indicator[_ngcontent-%COMP%] {\n    background-color: orange;\n}\n\n.value-box-wrapper[_ngcontent-%COMP%]   .manage-version-button[_ngcontent-%COMP%] {\n    border: solid 1px lightgrey;\n}\n.value-box-wrapper.warning[_ngcontent-%COMP%]   .manage-version-button[_ngcontent-%COMP%] {\n border-color: orange;\n}\n\n.has-changed[_ngcontent-%COMP%] {\n\tcolor: orange;\n}"],data:{animation:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}}),e}();t.StandardAttributeEditorComponent=R,("undefined"==typeof ngDevMode||ngDevMode)&&c.ɵsetClassMetadata(R,[{type:r.Component,args:[{selector:"standard-attribute-editor",templateUrl:"./standard-attribute-editor.component.html",styleUrls:["./standard-attribute-editor.component.css"],host:{"[@fadeInOut]":"true"},animations:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]],viewProviders:[{provide:s.ControlContainer,useExisting:s.NgForm}]}]}],(function(){return[{type:c.ChangeDetectorRef},{type:d.RegistryService},{type:p.LocalizationService},{type:c.ChangeDetectorRef},{type:m.DateService},{type:u.AuthService},{type:g.ChangeRequestService},{type:h.BsModalService},{type:c.ElementRef}]}),{isNew:[{type:r.Input}],isValidChange:[{type:r.Output}],readonly:[{type:r.Input}],attributeType:[{type:r.Input}],changeRequest:[{type:r.Input}],geoObjectType:[{type:r.Input}],geoObject:[{type:r.Input}],isNewGeoObject:[{type:r.Input}],changeRequestEditor:[{type:r.Input}]})},588:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectAttributeExcludesPipe=void 0;var r=n(0),i=n(0),o=function(){function e(){}return e.prototype.transform=function(e,t){return e&&t?e.filter((function(e){return-1===t.indexOf(e.code)})):e},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=i.ɵɵdefinePipe({name:"geoObjectAttributeExcludesFilter",type:e,pure:!0}),e}();t.GeoObjectAttributeExcludesPipe=o,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(o,[{type:r.Pipe,args:[{name:"geoObjectAttributeExcludesFilter",pure:!0}]}],null,null)},589:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeRequestPageComponent=void 0;var r=n(0),i=(n(30),n(33),n(16),n(111)),o=n(0),a=n(16),l=n(30),s=n(33),c=n(122),d=n(86),p=n(584),m=n(1),u=n(553);function g(e,t){1&e&&o.ɵɵelement(0,"submit-change-request")}var h=function(){function e(e,t,n,r){this.localizationService=e,this.modalService=t,this.service=n,this.route=r,this.isAdmin=n.isAdmin(),this.isMaintainer=this.isAdmin||n.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||n.isContributer(),this.isContributorOnly=n.isContributerOnly()}return e.prototype.ngOnInit=function(){var e=this;this.urlSubscriber=this.route.params.subscribe((function(t){e.highlightOid=t.oid}))},e.prototype.ngOnDestroy=function(){this.urlSubscriber.unsubscribe()},e.prototype.error=function(e){this.bsModalRef=i.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.LocalizationService),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(a.AuthService),o.ɵɵdirectiveInject(s.ActivatedRoute))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["change-request-page"]],decls:13,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid",2,"height","100%"],[1,"row"],[1,"col-md-12"],[1,"heading"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[3,"toggleId"],[4,"ngIf"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelement(1,"cgr-header"),o.ɵɵelement(2,"loading-bar"),o.ɵɵelementStart(3,"div",1),o.ɵɵelementStart(4,"div",2),o.ɵɵelementStart(5,"div",3),o.ɵɵelementStart(6,"div"),o.ɵɵelementStart(7,"div",4),o.ɵɵelementStart(8,"h2"),o.ɵɵtext(9),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(10,"div",5),o.ɵɵelement(11,"request-table",6),o.ɵɵtemplate(12,g,1,0,"submit-change-request",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(9),o.ɵɵtextInterpolate(t.pageTitle),o.ɵɵadvance(2),o.ɵɵproperty("toggleId",t.highlightOid),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.isContributorOnly))},directives:[c.CgrHeaderComponent,d.LoadingBarComponent,p.RequestTableComponent,m.NgIf,u.SubmitChangeRequestComponent],styles:["a.active[_ngcontent-%COMP%] {\n\tborder-bottom: solid 2px #6BA542;\n}"]}),e}();t.ChangeRequestPageComponent=h,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(h,[{type:r.Component,args:[{selector:"change-request-page",templateUrl:"./change-request-page.component.html",styleUrls:["./change-request-page.css"]}]}],(function(){return[{type:a.LocalizationService},{type:l.BsModalService},{type:a.AuthService},{type:s.ActivatedRoute}]}),null)},590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CascadingGeoSelector=void 0;var r=n(0),i=(n(30),n(518),n(111)),o=n(0),a=n(30),l=n(518),s=n(22),c=n(1),d=n(68),p=["mainForm"];function m(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",10),o.ɵɵtext(1),o.ɵɵelement(2,"input",11),o.ɵɵelementEnd()),2&e){var n=t.$implicit,r=o.ɵɵnextContext().$implicit;o.ɵɵadvance(1),o.ɵɵtextInterpolate1(" ",n.label," "),o.ɵɵadvance(1),o.ɵɵproperty("value",n.geoObject.properties.displayLabel.localizedValue+" : "+n.geoObject.properties.code)("name",r.code+"-"+n.code+"-input")}}function u(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",7),o.ɵɵelementStart(1,"div",12),o.ɵɵelementStart(2,"div",13),o.ɵɵelementStart(3,"button",14),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=o.ɵɵnextContext().$implicit;return o.ɵɵnextContext().onManageVersions(e.code)})),o.ɵɵelement(4,"localize",15),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}}function g(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",3),o.ɵɵelementStart(1,"div",4),o.ɵɵelementStart(2,"label"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div",5),o.ɵɵelementStart(5,"div",6),o.ɵɵelementStart(6,"div",7),o.ɵɵtemplate(7,m,3,3,"div",8),o.ɵɵelementEnd(),o.ɵɵtemplate(8,u,5,0,"div",9),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=t.$implicit,r=o.ɵɵnextContext();o.ɵɵadvance(3),o.ɵɵtextInterpolate1(" ",n.label," "),o.ɵɵadvance(4),o.ɵɵproperty("ngForOf",n.parents),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!r.readOnly)}}var h=function(){function e(e,t){this.modalService=e,this.registryService=t,this.valid=new r.EventEmitter,this.isValid=!0,this.readOnly=!1,this.forDate=new Date,this.customEvent=!1,this.onManageVersion=new r.EventEmitter,this.cHierarchies=[],this.parentMap={}}return e.prototype.ngOnInit=function(){var e=this.forDate.getUTCDate();this.dateStr=this.forDate.getUTCFullYear()+"-"+(this.forDate.getUTCMonth()+1)+"-"+(e<10?"0":"")+e,this.forDate=new Date(Date.parse(this.dateStr)),this.calculate()},e.prototype.ngOnChanges=function(e){e.forDate&&this.calculate()},e.prototype.calculate=function(){var e=this,t=this.forDate.getTime();this.isValid=!0,this.cHierarchies=[],this.hierarchies.forEach((function(n){var r={};r.label=n.label,r.code=n.code,e.isValid=e.isValid&&e.hierarchies.length>0,n.entries.forEach((function(e){var i=Date.parse(e.startDate),o=Date.parse(e.endDate);if(t>=i&&t<=o){var a=[];n.types.forEach((function(t){var n={code:t.code,label:t.label};null!=e.parents[t.code]&&(n.text=e.parents[t.code].text,n.geoObject=e.parents[t.code].geoObject),a.push(n)})),r.parents=a}})),e.cHierarchies.push(r)})),this.valid.emit()},e.prototype.getIsValid=function(){return!0},e.prototype.getHierarchies=function(){return this.hierarchies},e.prototype.onManageVersions=function(e){var t=this.hierarchies.find((function(t){return t.code===e}));this.customEvent&&this.onManageVersion.emit(t)},e.prototype.error=function(e){this.bsModalRef=i.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.BsModalService),o.ɵɵdirectiveInject(l.RegistryService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["cascading-geo-selector"]],viewQuery:function(e,t){if(1&e&&o.ɵɵviewQuery(p,1),2&e){var n;o.ɵɵqueryRefresh(n=o.ɵɵloadQuery())&&(t.mainForm=n.first)}},inputs:{hierarchies:"hierarchies",isValid:"isValid",readOnly:"readOnly",forDate:"forDate",customEvent:"customEvent"},outputs:{valid:"valid",onManageVersion:"onManageVersion"},features:[o.ɵɵNgOnChangesFeature],decls:5,vars:1,consts:[["name","cascading-geo-selector",1,"modal-form",2,"overflow","visible"],["mainForm","ngForm"],["class","row-holder","style","overflow:visible;",4,"ngFor","ngForOf"],[1,"row-holder",2,"overflow","visible"],[1,"label-holder"],[1,"holder"],[1,"container",2,"width","100%"],[1,"row"],["class","col-sm-12","style","float:left;width:150px;",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"col-sm-12",2,"float","left","width","150px"],["type","text","disabled","",1,"form-control",2,"width","150px",3,"value","name"],[1,"col-sm-12"],[1,"button-holder",2,"padding","20px 0 20px 0","text-align","left"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","changeovertime.manageVersions.button.label"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"form",0,1),o.ɵɵelementStart(2,"fieldset"),o.ɵɵelementStart(3,"div"),o.ɵɵtemplate(4,g,9,3,"div",2),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(4),o.ɵɵproperty("ngForOf",t.cHierarchies))},directives:[s.ɵangular_packages_forms_forms_ba,s.NgControlStatusGroup,s.NgForm,c.NgForOf,c.NgIf,d.LocalizeComponent],encapsulation:2}),e}();t.CascadingGeoSelector=h,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(h,[{type:r.Component,args:[{selector:"cascading-geo-selector",templateUrl:"./cascading-geo-selector.html"}]}],(function(){return[{type:a.BsModalService},{type:l.RegistryService}]}),{hierarchies:[{type:r.Input}],valid:[{type:r.Output}],isValid:[{type:r.Input}],readOnly:[{type:r.Input}],mainForm:[{type:r.ViewChild,args:["mainForm"]}],forDate:[{type:r.Input}],customEvent:[{type:r.Input}],onManageVersion:[{type:r.Output}]})},591:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MasterListComponent=void 0;var r=n(0),i=(n(33),n(30),n(31)),o=n(379),a=(n(518),n(112),n(583)),l=n(554),s=n(111),c=(n(16),n(0)),d=n(518),p=n(16),m=n(33),u=n(112),g=n(30),h=n(122),f=n(86),y=n(1),v=n(68),b=n(204),S=n(156),C=n(262),E=n(73),x=n(22),O=n(261),I=n(154),w=n(113);function M(e,t){1&e&&c.ɵɵelement(0,"progress-bar")}function T(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",26),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.message)}}function j(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",8),c.ɵɵelementStart(1,"h2"),c.ɵɵtext(2),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(2),c.ɵɵtextInterpolate1(" ",n.list.displayLabel," ")}}function k(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",7),c.ɵɵelementStart(1,"div",8),c.ɵɵelementStart(2,"h4"),c.ɵɵelement(3,"localize",27),c.ɵɵtext(4," : "),c.ɵɵelementStart(5,"span",28),c.ɵɵtext(6),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"h4"),c.ɵɵelement(8,"localize",29),c.ɵɵtext(9," : "),c.ɵɵelementStart(10,"span",28),c.ɵɵtext(11),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(6),c.ɵɵtextInterpolate1(" ",n.formatDate(n.list.publishDate)," "),c.ɵɵadvance(5),c.ɵɵtextInterpolate1(" ",n.formatDate(n.list.forDate)," ")}}function R(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",7),c.ɵɵelementStart(1,"div",30),c.ɵɵelementStart(2,"boolean-field",31),c.ɵɵlistener("valueChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext().showInvalid=e}))("change",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().onShowInvalidChange()})),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext();c.ɵɵadvance(2),c.ɵɵproperty("value",r.showInvalid)("localizeLabelKey","masterlist.showInvalid")}}function z(e,t){if(1&e&&(c.ɵɵelementStart(0,"li"),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit;c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.label)}}function P(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",7),c.ɵɵelementStart(1,"div",30),c.ɵɵelement(2,"localize",32),c.ɵɵelementStart(3,"ol"),c.ɵɵtemplate(4,z,2,1,"li",33),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(4),c.ɵɵproperty("ngForOf",n.filter)}}var D=function(){return{"fa fa-refresh clickable":!0}};function A(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"span",10),c.ɵɵlistener("click",(function(){return c.ɵɵrestoreView(n),c.ɵɵnextContext().onPublish()})),c.ɵɵelement(1,"i",34),c.ɵɵelement(2,"localize",35),c.ɵɵelementEnd()}2&e&&(c.ɵɵadvance(1),c.ɵɵproperty("ngClass",c.ɵɵpureFunction0(1,D)))}var V=function(e,t,n,r,i,o){return["/registry/dataset-location-manager",e,t,n,r,"__NEW__",i,o]};function N(e,t){if(1&e&&(c.ɵɵelementStart(0,"button",36),c.ɵɵelement(1,"localize",37),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵproperty("routerLink",c.ɵɵpureFunction6(1,V,n.list.oid,n.list.typeCode,!n.isWritable,n.list.forDate,!n.isWritable||n.list.isAbstract,"ML"+(n.isPublished?"T":"F")+n.list.oid))}}function L(e,t){if(1&e&&(c.ɵɵelementStart(0,"li"),c.ɵɵelementStart(1,"a",44),c.ɵɵtext(2),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=t.$implicit,r=c.ɵɵnextContext(2);c.ɵɵadvance(1),c.ɵɵproperty("routerLink",c.ɵɵpureFunction6(2,V,r.list.oid,n.code,!r.isWritable,r.list.forDate,!r.isWritable||r.list.isAbstract,"ML"+(r.isPublished?"T":"F")+r.list.oid)),c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.label)}}function _(e,t){if(1&e&&(c.ɵɵelementStart(0,"span",38),c.ɵɵelementStart(1,"button",39),c.ɵɵelement(2,"localize",37),c.ɵɵelement(3,"span",40),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"ul",41),c.ɵɵelementStart(5,"li"),c.ɵɵelement(6,"localize",42),c.ɵɵelementEnd(),c.ɵɵelement(7,"li",43),c.ɵɵtemplate(8,L,3,9,"li",33),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(8),c.ɵɵproperty("ngForOf",n.list.subtypes)}}function F(e,t){1&e&&c.ɵɵelement(0,"localize",45)}function H(e,t){1&e&&c.ɵɵelement(0,"localize",46)}function G(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",60),c.ɵɵelementStart(1,"a",61),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext().$implicit;return c.ɵɵnextContext(2).toggleFilter(e)})),c.ɵɵelement(2,"i",62),c.ɵɵpipe(3,"localize"),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext().$implicit;c.ɵɵadvance(1),c.ɵɵattribute("aria-expanded",!r.isCollapsed),c.ɵɵadvance(1),c.ɵɵproperty("title",c.ɵɵpipeBind1(3,2,"button.filter.helptext"))}}function q(e,t){1&e&&c.ɵɵelement(0,"i",63)}function B(e,t){1&e&&c.ɵɵelement(0,"i",64)}function U(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"input",68),c.ɵɵlistener("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).$implicit.value=e}))("keyup.enter",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2).$implicit;return c.ɵɵnextContext(2).handleInputChange(e)})),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2).$implicit;c.ɵɵproperty("name",r.name)("ngModel",r.value)}}function $(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"date-field",69),c.ɵɵlistener("valueChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).$implicit.value.start=e}))("change",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2).$implicit;return c.ɵɵnextContext(2).handleDateChange(e)})),c.ɵɵelementEnd(),c.ɵɵelementStart(2,"date-field",69),c.ɵɵlistener("valueChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).$implicit.value.end=e}))("change",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2).$implicit;return c.ɵɵnextContext(2).handleDateChange(e)})),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2).$implicit;c.ɵɵadvance(1),c.ɵɵproperty("value",r.value.start)("classNames","search-input")("inputName",r.name+"Start")("allowInfinity",!1)("allowFutureDates",!1)("required",!1)("placement","bottom"),c.ɵɵadvance(1),c.ɵɵproperty("value",r.value.end)("classNames","search-input")("inputName",r.name+"End")("allowInfinity",!1)("allowFutureDates",!1)("required",!1)("placement","bottom")}}var J=function(e){return{"inline-loading":e}};function W(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"input",70),c.ɵɵlistener("ngModelChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(2).$implicit.search=e}))("typeaheadOnSelect",(function(e){c.ɵɵrestoreView(n);var t=c.ɵɵnextContext(2).$implicit;return c.ɵɵnextContext(2).handleListChange(e,t)}))("typeaheadLoading",(function(e){c.ɵɵrestoreView(n);var t=c.ɵɵnextContext(2).$implicit;return c.ɵɵnextContext(2).changeTypeaheadLoading(t,e)})),c.ɵɵpipe(1,"localize"),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2).$implicit,i=c.ɵɵnextContext(2);c.ɵɵproperty("placeholder",c.ɵɵpipeBind1(1,9,"masterlist.search")+"...")("name",r.name)("ngModel",r.search)("typeaheadAsync",!0)("typeahead",i.getValues(r))("typeaheadOptionsLimit",100)("typeaheadMinLength",0)("typeaheadWaitMs",300)("ngClass",c.ɵɵpureFunction1(11,J,r.loading))}}function K(e,t){if(1&e&&(c.ɵɵelementStart(0,"div"),c.ɵɵelementStart(1,"div",65),c.ɵɵtemplate(2,U,1,2,"input",66),c.ɵɵtemplate(3,$,3,14,"div",1),c.ɵɵtemplate(4,W,2,13,"input",67),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext().$implicit;c.ɵɵadvance(1),c.ɵɵproperty("collapse",n.isCollapsed),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","input"===n.type),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","date"===n.type),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","list"===n.type)}}function Q(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"th",54),c.ɵɵtemplate(1,G,4,4,"div",55),c.ɵɵelementStart(2,"a",56),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=t.$implicit;return c.ɵɵnextContext(2).onSort(e)})),c.ɵɵtext(3),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"a",57),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=t.$implicit;return c.ɵɵnextContext(2).onSort(e)})),c.ɵɵtemplate(5,q,1,0,"i",58),c.ɵɵtemplate(6,B,1,0,"i",59),c.ɵɵelementEnd(),c.ɵɵtemplate(7,K,5,4,"div",1),c.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=c.ɵɵnextContext(2);c.ɵɵadvance(1),c.ɵɵproperty("ngIf",i.isFilterable(r)),c.ɵɵadvance(2),c.ɵɵtextInterpolate1("",r.label," "),c.ɵɵadvance(2),c.ɵɵproperty("ngIf","ASC"===i.sort.order&&i.sort.attribute===r.name),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","DESC"===i.sort.order&&i.sort.attribute===r.name),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",i.isFilterable(r))}}function Y(e,t){if(1&e&&(c.ɵɵelementStart(0,"td",75),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=t.$implicit,r=c.ɵɵnextContext().$implicit;c.ɵɵadvance(1),c.ɵɵtextInterpolate(r[n.name])}}var X=function(e,t,n,r,i,o,a){return["/registry/dataset-location-manager",e,t,n,r,i,o,a]};function Z(e,t){if(1&e&&(c.ɵɵelementStart(0,"tr",71),c.ɵɵelementStart(1,"td",72),c.ɵɵelement(2,"a",73),c.ɵɵelementEnd(),c.ɵɵtemplate(3,Y,2,1,"td",74),c.ɵɵelementEnd()),2&e){var n=t.$implicit,r=c.ɵɵnextContext(2);c.ɵɵadvance(2),c.ɵɵproperty("ngClass",r.isWritable?"fa fa-pencil":"fa fa-eye")("routerLink",c.ɵɵpureFunction7(3,X,r.list.oid,r.list.typeCode,!r.isWritable,r.list.forDate,n.code,!r.isWritable||r.list.isAbstract,"ML"+(r.isPublished?"T":"F")+r.list.oid)),c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",r.listAttrs)}}var ee=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function te(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",47),c.ɵɵelementStart(1,"table",48),c.ɵɵelementStart(2,"thead",49),c.ɵɵelementStart(3,"tr"),c.ɵɵelementStart(4,"th",50),c.ɵɵelement(5,"localize",51),c.ɵɵelementEnd(),c.ɵɵtemplate(6,Q,8,5,"th",52),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"tbody"),c.ɵɵtemplate(8,Z,4,11,"tr",53),c.ɵɵpipe(9,"paginate"),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(6),c.ɵɵproperty("ngForOf",n.listAttrs),c.ɵɵadvance(2),c.ɵɵproperty("ngForOf",c.ɵɵpipeBind2(9,2,n.page.results,c.ɵɵpureFunction3(5,ee,n.page.pageSize,n.page.pageNumber,n.page.count)))}}var ne=function(){function e(e,t,n,r,i,o,a){this.service=e,this.pService=t,this.route=n,this.dateService=r,this.modalService=i,this.localizeService=o,this.authService=a,this.message=null,this.list=null,this.p=1,this.current="",this.filter=[],this.selected=[],this.page={count:0,pageNumber:1,pageSize:100,results:[]},this.sort={attribute:"code",order:"ASC"},this.isPublished=!0,this.isRefreshing=!1,this.isWritable=!1,this.showInvalid=!1,this.searchPlaceholder="",this.searchPlaceholder=o.decode("masterlist.search")}return e.prototype.ngOnInit=function(){var e=this,t=this.route.snapshot.paramMap.get("oid");this.isPublished="true"===this.route.snapshot.paramMap.get("published"),this.service.getMasterListVersion(t).then((function(t){e.setList(t);var n=e.list.orgCode,r=null!=e.list.superTypeCode?e.list.superTypeCode:e.list.typeCode;e.isWritable=e.authService.isGeoObjectTypeRC(n,r),e.onPageChange(1),null!=t.refreshProgress&&e.handleProgressChange(t.refreshProgress)}));var n="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=o.webSocket(n+"/websocket/progress/"+t),this.notifier.subscribe((function(t){null!=t.content?e.handleProgressChange(t.content):e.handleProgressChange(t)}))},e.prototype.ngOnDestroy=function(){this.notifier.complete()},e.prototype.ngAfterViewInit=function(){},e.prototype.setList=function(e){this.list=e,this.listAttrs=this.calculateListAttributes()},e.prototype.onShowInvalidChange=function(){this.onPageChange(1)},e.prototype.onPageChange=function(e){var t=this;this.message=null,this.service.data(this.list.oid,e,this.page.pageSize,this.getFilter(),this.sort).then((function(e){t.page=e,t.listAttrs=t.calculateListAttributes()})).catch((function(e){t.error(e)}))},e.prototype.onSort=function(e){this.sort.attribute===e.name?this.sort.order="ASC"===this.sort.order?"DESC":"ASC":this.sort={attribute:e.name,order:"ASC"},this.onPageChange(1)},e.prototype.clearFilters=function(){this.list.attributes.forEach((function(e){e.search=null})),this.filter=[],this.showInvalid=!1,this.selected=[],this.onPageChange(1)},e.prototype.toggleFilter=function(e){e.isCollapsed=!e.isCollapsed},e.prototype.getFilter=function(){var e=JSON.parse(JSON.stringify(this.filter));return this.showInvalid||e.push({attribute:"invalid",value:"false"}),e},e.prototype.calculateListAttributes=function(){var e;if(this.showInvalid)e=this.list.attributes;else{var t=(e=JSON.parse(JSON.stringify(this.list.attributes))).findIndex((function(e){return"invalid"===e.name}));-1!==t&&e.splice(t,1)}return e.forEach((function(e){e.isCollapsed=!0})),e},e.prototype.getValues=function(e){var t=this;return i.Observable.create((function(n){t.message=null,t.service.values(t.list.oid,e.search,e.name,e.base,t.getFilter()).then((function(e){e.unshift({label:"["+t.localizeService.decode("masterlist.nofilter")+"]",value:null}),n.next(e)})).catch((function(e){t.error(e)}))}))},e.prototype.handleProgressChange=function(e){this.isRefreshing=e.current<e.total,this.pService.progress(e),this.isRefreshing||this.onPageChange(1)},e.prototype.handleDateChange=function(e){if(e.isCollapsed=!0,this.filter=this.filter.filter((function(t){return t.attribute!==e.base})),this.selected=this.selected.filter((function(t){return t!==e.base})),null!=e.value&&(null!=e.value.start&&""!==e.value.start||null!=e.value.end&&""!==e.value.end)){var t="["+e.label+"] : [";null!=e.value.start&&(t+=e.value.start),null!=e.value.start&&null!=e.value.end&&(t+=" - "),null!=e.value.end&&(t+=e.value.end),t+="]",this.filter.push({attribute:e.base,value:e.value,label:t}),this.selected.push(e.base)}this.onPageChange(1)},e.prototype.handleInputChange=function(e){if(e.isCollapsed=!0,this.filter=this.filter.filter((function(t){return t.attribute!==e.base})),this.selected=this.selected.filter((function(t){return t!==e.base})),null!=e.value&&""!==e.value){var t="["+e.label+"] : ["+e.value+"]";this.filter.push({attribute:e.base,value:e.value,label:t}),this.selected.push(e.base)}this.onPageChange(1)},e.prototype.handleListChange=function(e,t){if(t.value=e.item,t.isCollapsed=!0,this.filter=this.filter.filter((function(e){return e.attribute!==t.base})),this.selected=this.selected.filter((function(e){return e!==t.base})),this.list.attributes.forEach((function(e){e.base===t.base&&(e.search="")})),null!=t.value.value&&""!==t.value.value){var n="["+t.label+"] : ["+t.value.label+"]";this.filter.push({attribute:t.base,value:e.item.value,label:n}),this.selected.push(t.base),t.search=e.item.label}else t.search="";this.onPageChange(1)},e.prototype.isFilterable=function(e){return"none"!==e.type&&"invalid"!==e.name&&(0===e.dependency.length||-1!==this.selected.indexOf(e.base)||this.selected.filter((function(t){return e.dependency.includes(t)})).length>0)},e.prototype.onEdit=function(e){var t=this,n=this.modalService.show(l.GeoObjectEditorComponent,{backdrop:!0,ignoreBackdropClick:!0});n.content.configureAsExisting(e.code,this.list.typeCode,this.list.forDate,this.list.isGeometryEditable),n.content.setMasterListId(this.list.oid),n.content.setOnSuccessCallback((function(){t.onPageChange(t.page.pageNumber)}))},e.prototype.onPublish=function(){var e=this;this.message=null,this.service.publishMasterList(this.list.oid).toPromise().then((function(t){e.isRefreshing=!0})).catch((function(t){e.error(t)}))},e.prototype.onNewGeoObject=function(){var e=this,t=this.modalService.show(l.GeoObjectEditorComponent,{backdrop:!0,ignoreBackdropClick:!0});t.content.configureAsNew(this.list.typeCode,this.list.forDate,this.list.isGeometryEditable),t.content.setMasterListId(this.list.oid),t.content.setOnSuccessCallback((function(){e.onPageChange(e.page.pageNumber)}))},e.prototype.onExport=function(){var e=this;this.bsModalRef=this.modalService.show(a.ExportFormatModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.onFormat.subscribe((function(t){"SHAPEFILE"===t?window.location.href=acp+"/master-list/export-shapefile?oid="+e.list.oid+"&filter="+encodeURIComponent(JSON.stringify(e.getFilter())):"EXCEL"===t&&(window.location.href=acp+"/master-list/export-spreadsheet?oid="+e.list.oid+"&filter="+encodeURIComponent(JSON.stringify(e.getFilter())))}))},e.prototype.changeTypeaheadLoading=function(e,t){e.loading=t},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.onWheel=function(e){e.target.parentElement.closest("table").parentElement.scrollLeft+=e.deltaY,e.preventDefault()},e.prototype.error=function(e){this.message=s.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(c.ɵɵdirectiveInject(d.RegistryService),c.ɵɵdirectiveInject(p.ProgressService),c.ɵɵdirectiveInject(m.ActivatedRoute),c.ɵɵdirectiveInject(u.DateService),c.ɵɵdirectiveInject(g.BsModalService),c.ɵɵdirectiveInject(p.LocalizationService),c.ɵɵdirectiveInject(p.AuthService))},e.ɵcmp=c.ɵɵdefineComponent({type:e,selectors:[["master-list"]],decls:35,vars:15,consts:[[1,"new-admin-design-main"],[4,"ngIf"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"row"],["class","col-md-12",4,"ngIf"],["class","row form-group",4,"ngIf"],[1,"row","form-group"],[1,"col-md-12"],[1,"button-holder","pull-right"],[1,"clickable",2,"padding","10px",3,"click"],[1,"fa-stack","fa-md"],[1,"fa","fa-filter","fa-stack-2x",2,"font-size","25px"],[1,"fa","fa-times-circle","fa-stack-1x",2,"font-size","13px","top","4px","left","6px"],["key","masterlist.clearFilters"],["class","clickable","style","padding: 10px;",3,"click",4,"ngIf"],["type","submit","routerLinkActive","active","class","btn btn-primary","role","button",3,"routerLink",4,"ngIf"],["class","dropdown",4,"ngIf"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","io.export.allrows",4,"ngIf"],["key","io.export.filteredrows",4,"ngIf"],["class","col-md-12 table-responsive text-nowrap","id","list-view-table","style","max-height:calc(100vh - 399px);",4,"ngIf"],[2,"display","inline-block",3,"pageChange"],[2,"display","inline-block","margin-left","20px","vertical-align","middle","color","#cacaca","font-weight","bold"],["key","masterlist.pagination.showing"],["key","masterlist.pagination.of"],["role","alert",1,"alert","alert-danger"],["key","masterlist.generatedDate"],[1,"date-string-display"],["key","masterlist.forDate"],[1,"col-md-12","table-responsive"],[3,"value","localizeLabelKey","valueChange","change"],["key","masterlist.filters"],[4,"ngFor","ngForOf"],["aria-hidden","true",2,"font-size","24px","vertical-align","middle","padding-right","5px",3,"ngClass"],["key","masterlist.publish"],["type","submit","routerLinkActive","active","role","button",1,"btn","btn-primary",3,"routerLink"],["key","masterlist.newGeoObject"],[1,"dropdown"],["type","button","id","dropdownMenu1","data-toggle","dropdown","aria-haspopup","true","aria-expanded","true",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["aria-labelledby","dropdownMenu1",1,"dropdown-menu"],["key","masterlist.newGeoObject.selectASubtype",2,"padding-left","10px"],["role","separator",1,"divider"],["routerLinkActive","active",3,"routerLink"],["key","io.export.allrows"],["key","io.export.filteredrows"],["id","list-view-table",1,"col-md-12","table-responsive","text-nowrap",2,"max-height","calc(100vh - 399px)"],[1,"list-table","table","table-bordered","table-striped"],[2,"position","sticky","top","0","background","#ececec"],[1,"label-column",2,"width","3%","position","sticky","top","0"],["key","masterlist.view.column"],["style","position: sticky;top: 0","class","label-column",4,"ngFor","ngForOf"],["class","fade-ngRepeat-item",4,"ngFor","ngForOf"],[1,"label-column",2,"position","sticky","top","0"],["style","display: table-cell; padding-right: 10px; vertical-align: middle;",4,"ngIf"],[2,"display","table-cell","word-break","keep-all","word-wrap","normal",3,"click"],[2,"display","table-cell","vertical-align","middle","padding-left","5px",3,"click"],["class","fa fa-arrow-down","style","font-size: inherit;",4,"ngIf"],["class","fa fa-arrow-up","style","font-size: inherit;",4,"ngIf"],[2,"display","table-cell","padding-right","10px","vertical-align","middle"],["aria-controls","collapseBasic",1,"",3,"click"],[1,"fa","fa-filter",2,"font-size","20px",3,"title"],[1,"fa","fa-arrow-down",2,"font-size","inherit"],[1,"fa","fa-arrow-up",2,"font-size","inherit"],["id","collapseBasic",3,"collapse"],["type","text","class","form-control search-input",3,"name","ngModel","ngModelChange","keyup.enter",4,"ngIf"],["type","text","typeaheadOptionField","label","class","form-control","autocomplete","off",3,"placeholder","name","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadWaitMs","ngClass","ngModelChange","typeaheadOnSelect","typeaheadLoading",4,"ngIf"],["type","text",1,"form-control","search-input",3,"name","ngModel","ngModelChange","keyup.enter"],["label","",3,"value","classNames","inputName","allowInfinity","allowFutureDates","required","placement","valueChange","change"],["type","text","typeaheadOptionField","label","autocomplete","off",1,"form-control",3,"placeholder","name","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadWaitMs","ngClass","ngModelChange","typeaheadOnSelect","typeaheadLoading"],[1,"fade-ngRepeat-item"],[1,"label-column",2,"width","3%","text-align","center"],["routerLinkActive","active",1,"fa",2,"padding","3px",3,"ngClass","routerLink"],["class","label-column",4,"ngFor","ngForOf"],[1,"label-column"]],template:function(e,t){1&e&&(c.ɵɵelementStart(0,"div",0),c.ɵɵelement(1,"cgr-header"),c.ɵɵelement(2,"loading-bar"),c.ɵɵtemplate(3,M,1,0,"progress-bar",1),c.ɵɵelementStart(4,"div",2),c.ɵɵtemplate(5,T,2,1,"div",3),c.ɵɵelementStart(6,"div",4),c.ɵɵtemplate(7,j,3,1,"div",5),c.ɵɵelementEnd(),c.ɵɵtemplate(8,k,12,2,"div",6),c.ɵɵtemplate(9,R,3,2,"div",6),c.ɵɵtemplate(10,P,5,1,"div",6),c.ɵɵelementStart(11,"div",7),c.ɵɵelementStart(12,"div",8),c.ɵɵelementStart(13,"div",9),c.ɵɵelementStart(14,"span",10),c.ɵɵlistener("click",(function(){return t.clearFilters()})),c.ɵɵelementStart(15,"span",11),c.ɵɵelement(16,"i",12),c.ɵɵelement(17,"i",13),c.ɵɵelementEnd(),c.ɵɵelement(18,"localize",14),c.ɵɵelementEnd(),c.ɵɵtemplate(19,A,3,2,"span",15),c.ɵɵtemplate(20,N,2,8,"button",16),c.ɵɵtemplate(21,_,9,1,"span",17),c.ɵɵelementStart(22,"button",18),c.ɵɵlistener("click",(function(){return t.onExport()})),c.ɵɵtemplate(23,F,1,0,"localize",19),c.ɵɵtemplate(24,H,1,0,"localize",20),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(25,"div",7),c.ɵɵtemplate(26,te,10,9,"div",21),c.ɵɵelementEnd(),c.ɵɵelementStart(27,"div",4),c.ɵɵelementStart(28,"div",8),c.ɵɵelementStart(29,"pagination-controls",22),c.ɵɵlistener("pageChange",(function(e){return t.onPageChange(e)})),c.ɵɵelementEnd(),c.ɵɵelementStart(30,"span",23),c.ɵɵelement(31,"localize",24),c.ɵɵtext(32),c.ɵɵelement(33,"localize",25),c.ɵɵtext(34),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e&&(c.ɵɵadvance(3),c.ɵɵproperty("ngIf",t.isRefreshing),c.ɵɵadvance(2),c.ɵɵproperty("ngIf",null!=t.message),c.ɵɵadvance(2),c.ɵɵproperty("ngIf",t.list),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.list),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.isWritable),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.filter.length>0),c.ɵɵadvance(9),c.ɵɵproperty("ngIf",!t.isPublished),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.isWritable&&!t.list.isAbstract),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.isWritable&&t.list.isAbstract),c.ɵɵadvance(2),c.ɵɵproperty("ngIf",0===t.filter.length),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.filter.length>0),c.ɵɵadvance(2),c.ɵɵproperty("ngIf",t.list),c.ɵɵadvance(6),c.ɵɵtextInterpolate2("  ",(t.page.pageNumber-1)*t.page.pageSize," - ",t.page.pageNumber*t.page.pageSize,"  "),c.ɵɵadvance(2),c.ɵɵtextInterpolate1(" ",t.page.count," "))},directives:[h.CgrHeaderComponent,f.LoadingBarComponent,y.NgIf,v.LocalizeComponent,b.PaginationControlsComponent,S.ProgressBarComponent,C.BooleanFieldComponent,y.NgForOf,y.NgClass,m.RouterLinkActive,m.RouterLink,m.RouterLinkWithHref,E.CollapseDirective,x.DefaultValueAccessor,x.NgControlStatus,x.NgModel,O.DateFieldComponent,I.TypeaheadDirective],pipes:[b.PaginatePipe,w.LocalizePipe],styles:[".version-busy-overlay[_ngcontent-%COMP%]\n{\n\theight:100%;\n\twidth:100%;\n\tbackground-color: #CCCCCC;\n  position: absolute;\n  display: block;\n  opacity: 0.8;\n  z-index: 99999 !important;\n}"]}),e}();t.MasterListComponent=ne,("undefined"==typeof ngDevMode||ngDevMode)&&c.ɵsetClassMetadata(ne,[{type:r.Component,args:[{selector:"master-list",templateUrl:"./master-list.component.html",styleUrls:["./master-list.component.css"]}]}],(function(){return[{type:d.RegistryService},{type:p.ProgressService},{type:m.ActivatedRoute},{type:u.DateService},{type:g.BsModalService},{type:p.LocalizationService},{type:p.AuthService}]}),null)},592:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublishedMasterListHistoryComponent=void 0;var r=n(0),i=(n(33),n(30),n(379)),o=n(528),a=n(111),l=(n(518),n(112),n(16),n(0)),s=n(518),c=n(33),d=n(30),p=n(16),m=n(112),u=n(1),g=n(68),h=n(22),f=n(204),y=n(113);function v(e,t){if(1&e&&(l.ɵɵelementStart(0,"div",14),l.ɵɵtext(1),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext();l.ɵɵadvance(1),l.ɵɵtextInterpolate(n.message)}}function b(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",15),l.ɵɵelementStart(1,"div",16),l.ɵɵelementStart(2,"form",null,17),l.ɵɵelementStart(4,"div",18),l.ɵɵelementStart(5,"button",19),l.ɵɵlistener("click",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onPublish()})),l.ɵɵpipe(6,"localize"),l.ɵɵelement(7,"localize",20),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵreference(3);l.ɵɵadvance(5),l.ɵɵproperty("disabled",r.invalid)("title",l.ɵɵpipeBind1(6,2,"masterList.publish.help.text"))}}function S(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",36),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext().$implicit;return l.ɵɵnextContext(2).onPublishShapefile(e)})),l.ɵɵelement(1,"localize",37),l.ɵɵelementEnd()}}function C(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",30),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext().$implicit;return l.ɵɵnextContext(2).onDownloadShapefile(e)})),l.ɵɵelement(1,"localize",38),l.ɵɵelementEnd()}}function E(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",39),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext().$implicit;return l.ɵɵnextContext(2).onDeleteMasterListVersion(e)})),l.ɵɵelement(1,"localize",40),l.ɵɵelementEnd()}}function x(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"tr"),l.ɵɵelementStart(1,"td",28),l.ɵɵelementStart(2,"div",29),l.ɵɵelementStart(3,"button",30),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=t.$implicit;return l.ɵɵnextContext(2).onView(e)})),l.ɵɵelement(4,"localize",31),l.ɵɵelementEnd(),l.ɵɵtemplate(5,S,2,0,"button",32),l.ɵɵtemplate(6,C,2,0,"button",33),l.ɵɵtemplate(7,E,2,0,"button",34),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(8,"td",25),l.ɵɵelementStart(9,"span",35),l.ɵɵtext(10),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(11,"td",25),l.ɵɵelementStart(12,"span",35),l.ɵɵtext(13),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=l.ɵɵnextContext(2);l.ɵɵadvance(5),l.ɵɵproperty("ngIf",i.list&&i.list.write),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",r.shapefile),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",i.list&&i.list.write),l.ɵɵadvance(3),l.ɵɵtextInterpolate1(" ",i.formatDate(r.forDate)," "),l.ɵɵadvance(3),l.ɵɵtextInterpolate1(" ",i.formatDate(r.publishDate)," ")}}function O(e,t){if(1&e&&(l.ɵɵelementStart(0,"div",21),l.ɵɵelementStart(1,"table",22),l.ɵɵelementStart(2,"thead"),l.ɵɵelementStart(3,"tr"),l.ɵɵelementStart(4,"th",23),l.ɵɵelement(5,"localize",24),l.ɵɵelementEnd(),l.ɵɵelementStart(6,"th",25),l.ɵɵelement(7,"localize",26),l.ɵɵelementEnd(),l.ɵɵelementStart(8,"th",25),l.ɵɵelement(9,"localize",27),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(10,"tbody"),l.ɵɵtemplate(11,x,14,5,"tr",12),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext();l.ɵɵadvance(11),l.ɵɵproperty("ngForOf",n.list.versions)}}function I(e,t){if(1&e&&(l.ɵɵelementStart(0,"span",44),l.ɵɵtext(1),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext().$implicit;l.ɵɵadvance(1),l.ɵɵtextInterpolate1(" ",n.exception.message," ")}}function w(e,t){if(1&e&&(l.ɵɵelementStart(0,"tr"),l.ɵɵelementStart(1,"td",10),l.ɵɵelementStart(2,"div",41),l.ɵɵelement(3,"i",42),l.ɵɵelementStart(4,"p",43),l.ɵɵelementStart(5,"span",44),l.ɵɵtext(6),l.ɵɵelementEnd(),l.ɵɵelementStart(7,"span",44),l.ɵɵtext(8),l.ɵɵelementEnd(),l.ɵɵelementStart(9,"span",44),l.ɵɵtext(10),l.ɵɵelementEnd(),l.ɵɵelementStart(11,"span",44),l.ɵɵtext(12),l.ɵɵelementEnd(),l.ɵɵtemplate(13,I,2,1,"span",45),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e){var n=t.$implicit;l.ɵɵadvance(6),l.ɵɵtextInterpolate1(" ",n.createDate," "),l.ɵɵadvance(2),l.ɵɵtextInterpolate1(" ",n.author," "),l.ɵɵadvance(2),l.ɵɵtextInterpolate1(" ",n.type," "),l.ɵɵadvance(2),l.ɵɵtextInterpolate1(" ",n.status," "),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",n.exception)}}function M(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",46),l.ɵɵelementStart(1,"pagination-controls",47),l.ɵɵlistener("pageChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onPageChange(e)})),l.ɵɵelementEnd(),l.ɵɵelementEnd()}}var T=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}},j=function(){function e(e,t,n,r,i,o){this.service=e,this.router=t,this.modalService=n,this.authService=r,this.localizeService=i,this.dateService=o,this.message=null,this.list=null,this.page={pageSize:10,pageNumber:1,count:1,results:[]},this.isAdmin=r.isAdmin()}return e.prototype.ngOnInit=function(){var e=this;this.service.getMasterListHistory(this.oid,"PUBLISHED").then((function(t){e.list=t,e.onPageChange(1)}));var t="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=i.webSocket(t+"/websocket/notify"),this.notifier.subscribe((function(t){"PUBLISH_JOB_CHANGE"===t.type&&e.onPageChange(e.page.pageNumber)}))},e.prototype.ngOnDestroy=function(){this.notifier.complete()},e.prototype.onDeleteMasterListVersion=function(e){var t=this;this.bsModalRef=this.modalService.show(a.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+e.forDate+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.onConfirm.subscribe((function(n){t.service.deleteMasterListVersion(e.oid).then((function(e){t.updateList()})).catch((function(e){t.error(e)}))}))},e.prototype.updateList=function(){var e=this;this.service.getMasterListHistory(this.oid,"PUBLISHED").then((function(t){e.list=t})).catch((function(t){e.error(t)}))},e.prototype.onPublish=function(){var e=this;this.message=null,this.service.publishMasterListVersions(this.list.oid).then((function(t){e.onPageChange(e.page.pageNumber)})).catch((function(t){e.error(t)}))},e.prototype.onPageChange=function(e){var t=this;null!=this.list&&(this.message=null,this.service.getPublishMasterListJobs(this.list.oid,this.page.pageSize,e,"createDate",!0).then((function(e){t.page=e})).catch((function(e){t.error(e)})),this.updateList())},e.prototype.onViewMetadata=function(){this.bsModalRef=this.modalService.show(o.PublishModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.readonly=!0,this.bsModalRef.content.master=this.list,this.bsModalRef.content.isNew=!1},e.prototype.onView=function(e){this.router.navigate(["/registry/master-list/",e.oid,!0])},e.prototype.onPublishShapefile=function(e){var t=this;this.service.publishShapefile(e.oid).then((function(){t.onPageChange(t.page.pageNumber)})).catch((function(e){t.error(e)}))},e.prototype.onDownloadShapefile=function(e){window.location.href=acp+"/master-list/download-shapefile?oid="+e.oid},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=a.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(l.ɵɵdirectiveInject(s.RegistryService),l.ɵɵdirectiveInject(c.Router),l.ɵɵdirectiveInject(d.BsModalService),l.ɵɵdirectiveInject(p.AuthService),l.ɵɵdirectiveInject(p.LocalizationService),l.ɵɵdirectiveInject(m.DateService))},e.ɵcmp=l.ɵɵdefineComponent({type:e,selectors:[["published-master-list-history"]],inputs:{oid:"oid"},decls:18,vars:12,consts:[["class","alert alert-danger","role","alert",4,"ngIf"],["style","margin-bottom: 10px;","class","row",4,"ngIf"],[1,"row","form-group"],["class","col-md-12 table-responsive",4,"ngIf"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"solid-table-wrapper"],[1,"table","table-striped"],[2,"height","56px"],[2,"vertical-align","middle"],["key","masterlist.jobs"],[4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"margin-bottom","10px"],[1,"col-md-12"],["myForm","ngForm"],[1,"form-group"],["type","submit","role","button",1,"btn","btn-primary",2,"margin-left","15px",3,"disabled","title","click"],["key","masterlist.publish.versions"],[1,"col-md-12","table-responsive"],[1,"list-table","table",2,"border-bottom","solid lightgrey 3px"],[1,"label-column",2,"width","50%"],["key","masterlist.actions"],[1,"label-column",2,"width","15%"],["key","masterlist.forDate"],["key","masterlist.publishDate"],[2,"width","70%"],[1,"button-holder"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","modal.button.view"],["type","submit","class","btn btn-default","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],[1,"date-string-display"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","masterlist.publish-shapefile"],["key","masterlist.download"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","modal.button.delete"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","40px"],[2,"padding-left","60px"],[2,"display","block"],["style","display: block;",4,"ngIf"],[1,"solid-table-footer"],[3,"pageChange"]],template:function(e,t){1&e&&(l.ɵɵelementStart(0,"div"),l.ɵɵtemplate(1,v,2,1,"div",0),l.ɵɵtemplate(2,b,8,4,"div",1),l.ɵɵelementStart(3,"div",2),l.ɵɵtemplate(4,O,12,1,"div",3),l.ɵɵelementEnd(),l.ɵɵelementStart(5,"div",4),l.ɵɵelementStart(6,"div",5),l.ɵɵelementStart(7,"ul",6),l.ɵɵelementStart(8,"div",7),l.ɵɵelementStart(9,"table",8),l.ɵɵelementStart(10,"thead"),l.ɵɵelementStart(11,"tr",9),l.ɵɵelementStart(12,"th",10),l.ɵɵelement(13,"localize",11),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(14,"tbody"),l.ɵɵtemplate(15,w,14,5,"tr",12),l.ɵɵpipe(16,"paginate"),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(17,M,2,0,"div",13),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e&&(l.ɵɵadvance(1),l.ɵɵproperty("ngIf",null!=t.message),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.list&&t.list.write),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",t.list),l.ɵɵadvance(11),l.ɵɵproperty("ngForOf",l.ɵɵpipeBind2(16,5,t.page.results,l.ɵɵpureFunction3(8,T,t.page.pageSize,t.page.pageNumber,t.page.count))),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",t.page.results.length>0))},directives:[u.NgIf,g.LocalizeComponent,u.NgForOf,h.ɵangular_packages_forms_forms_ba,h.NgControlStatusGroup,h.NgForm,f.PaginationControlsComponent],pipes:[f.PaginatePipe,y.LocalizePipe],encapsulation:2}),e}();t.PublishedMasterListHistoryComponent=j,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(j,[{type:r.Component,args:[{selector:"published-master-list-history",templateUrl:"./published-master-list-history.component.html",styleUrls:[]}]}],(function(){return[{type:s.RegistryService},{type:c.Router},{type:d.BsModalService},{type:p.AuthService},{type:p.LocalizationService},{type:m.DateService}]}),{oid:[{type:r.Input}]})},593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MasterListHistoryComponent=void 0;var r=n(0),i=(n(33),n(30),n(111)),o=n(528),a=(n(518),n(112),n(16),n(0)),l=n(518),s=n(33),c=n(30),d=n(16),p=n(112),m=n(1),u=n(22),g=n(68),h=n(261);function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",4),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function y(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",5),a.ɵɵelementStart(1,"div",6),a.ɵɵelementStart(2,"form",7,8),a.ɵɵelementStart(4,"div",9),a.ɵɵelementStart(5,"label",10),a.ɵɵelement(6,"localize",11),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"date-field",12),a.ɵɵlistener("valueChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().forDate=e}))("validChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().isForDateValid=e})),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"button",13),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onPublish()})),a.ɵɵelement(9,"localize",14),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵreference(3),i=a.ɵɵnextContext();a.ɵɵadvance(7),a.ɵɵproperty("value",i.forDate)("valid",i.isForDateValid)("inputName","forDate")("allowFutureDates",!1)("required",!0)("placement","right"),a.ɵɵadvance(1),a.ɵɵproperty("disabled",r.invalid||!i.isForDateValid)}}function v(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"button",29),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext().$implicit;return a.ɵɵnextContext(2).onDelete(e)})),a.ɵɵelement(1,"localize",30),a.ɵɵelementEnd()}}function b(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"tr"),a.ɵɵelementStart(1,"td",23),a.ɵɵelementStart(2,"div",24),a.ɵɵelementStart(3,"button",25),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=t.$implicit;return a.ɵɵnextContext(2).onView(e)})),a.ɵɵelement(4,"localize",26),a.ɵɵelementEnd(),a.ɵɵtemplate(5,v,2,0,"button",27),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(6,"td",19),a.ɵɵelementStart(7,"span",28),a.ɵɵtext(8),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(9,"td",19),a.ɵɵelementStart(10,"span",28),a.ɵɵtext(11),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=a.ɵɵnextContext(2);a.ɵɵadvance(5),a.ɵɵproperty("ngIf",i.list.write),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(" ",i.formatDate(r.forDate)," "),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(" ",i.formatDate(r.createDate)," ")}}function S(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",15),a.ɵɵelementStart(1,"table",16),a.ɵɵelementStart(2,"thead"),a.ɵɵelementStart(3,"tr"),a.ɵɵelementStart(4,"th",17),a.ɵɵelement(5,"localize",18),a.ɵɵelementEnd(),a.ɵɵelementStart(6,"th",19),a.ɵɵelement(7,"localize",20),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"th",19),a.ɵɵelement(9,"localize",21),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(10,"tbody"),a.ɵɵtemplate(11,b,12,3,"tr",22),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(11),a.ɵɵproperty("ngForOf",n.list.versions)}}var C=function(){function e(e,t,n,r,i){this.service=e,this.router=t,this.modalService=n,this.localizeService=r,this.dateService=i,this.message=null,this.list=null,this.forDate="",this.isForDateValid=!0}return e.prototype.ngOnInit=function(){var e=this;this.service.getMasterListHistory(this.oid,"EXPLORATORY").then((function(t){e.list=t}))},e.prototype.onPublish=function(){var e=this;this.message=null,this.service.createMasterListVersion(this.list.oid,this.forDate).then((function(t){e.list.versions.push(t)})).catch((function(t){e.error(t)}))},e.prototype.onViewMetadata=function(){this.bsModalRef=this.modalService.show(o.PublishModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.readonly=!0,this.bsModalRef.content.master=this.list,this.bsModalRef.content.isNew=!1},e.prototype.onView=function(e){this.router.navigate(["/registry/master-list/",e.oid,!1])},e.prototype.onDelete=function(e){var t=this;this.bsModalRef=this.modalService.show(i.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+e.forDate+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.onConfirm.subscribe((function(n){t.service.deleteMasterListVersion(e.oid).then((function(n){t.list.versions=t.list.versions.filter((function(t,n,r){return t.oid!==e.oid}))})).catch((function(e){t.error(e)}))}))},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=i.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(s.Router),a.ɵɵdirectiveInject(c.BsModalService),a.ɵɵdirectiveInject(d.LocalizationService),a.ɵɵdirectiveInject(p.DateService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["master-list-history"]],inputs:{oid:"oid"},decls:5,vars:3,consts:[["class","alert alert-danger","role","alert",4,"ngIf"],["style","margin-bottom: 10px;","class","row",4,"ngIf"],[1,"row","form-group"],["class","col-md-12 table-responsive",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"margin-bottom","10px"],[1,"col-md-12"],["autocomplete","off",2,"margin-left","10px"],["myForm","ngForm"],[1,"form-group"],["for","forDate",2,"display","block","margin-bottom","0"],["key","masterlist.publishingFor"],["label","",2,"display","inline-grid",3,"value","valid","inputName","allowFutureDates","required","placement","valueChange","validChange"],["type","submit","role","button",1,"btn","btn-primary",2,"margin-left","15px",3,"disabled","click"],["key","masterlist.publishNewVersion"],[1,"col-md-12","table-responsive"],[1,"list-table","table"],[1,"label-column",2,"width","50%"],["key","masterlist.actions"],[1,"label-column",2,"width","15%"],["key","masterlist.forDate"],["key","masterlist.generatedDate"],[4,"ngFor","ngForOf"],[2,"width","70%"],[1,"button-holder"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","modal.button.view"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],[1,"date-string-display"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","modal.button.delete"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵtemplate(1,f,2,1,"div",0),a.ɵɵtemplate(2,y,10,7,"div",1),a.ɵɵelementStart(3,"div",2),a.ɵɵtemplate(4,S,12,1,"div",3),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.list&&t.list.exploratory),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",t.list))},directives:[m.NgIf,u.ɵangular_packages_forms_forms_ba,u.NgControlStatusGroup,u.NgForm,g.LocalizeComponent,h.DateFieldComponent,m.NgForOf],encapsulation:2}),e}();t.MasterListHistoryComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"master-list-history",templateUrl:"./master-list-history.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:s.Router},{type:c.BsModalService},{type:d.LocalizationService},{type:p.DateService}]}),{oid:[{type:r.Input}]})},594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MasterListViewComponent=void 0;var r=n(0),i=(n(33),n(30),n(518),n(528)),o=n(0),a=n(518),l=n(30),s=n(33),c=n(122),d=n(86),p=n(1),m=n(68),u=n(592),g=n(593);function h(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",2),o.ɵɵelementStart(1,"div",3),o.ɵɵelementStart(2,"h3"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(3),o.ɵɵtextInterpolate(n.list.displayLabel.localizedValue)}}function f(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",2),o.ɵɵelementStart(1,"div",3),o.ɵɵelementStart(2,"h5"),o.ɵɵelementStart(3,"b"),o.ɵɵelementStart(4,"a",10),o.ɵɵlistener("click",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().onViewMetadata(e)})),o.ɵɵelement(5,"localize",11),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}}var y=function(e){return{active:e}};function v(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"a",6),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().renderContent("EXP")})),o.ɵɵelement(1,"localize",12),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext();o.ɵɵproperty("ngClass",o.ɵɵpureFunction1(1,y,"EXP"===r.content))}}function b(e,t){if(1&e&&o.ɵɵelement(0,"published-master-list-history",13),2&e){var n=o.ɵɵnextContext();o.ɵɵproperty("oid",n.list.oid)}}function S(e,t){if(1&e&&o.ɵɵelement(0,"master-list-history",13),2&e){var n=o.ɵɵnextContext();o.ɵɵproperty("oid",n.list.oid)}}var C=function(){function e(e,t,n){this.service=e,this.modalService=t,this.route=n,this.content="",this.list=null}return e.prototype.ngOnInit=function(){var e=this,t=this.route.snapshot.paramMap.get("oid");null!=t&&(this.content="PUB"),this.service.getMasterList(t).then((function(t){e.list=t,t.read&&(e.content="EXP")}))},e.prototype.onViewMetadata=function(e){e.preventDefault(),this.bsModalRef=this.modalService.show(i.PublishModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.readonly=!0,this.bsModalRef.content.master=this.list,this.bsModalRef.content.isNew=!1},e.prototype.renderContent=function(e){this.content=e},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.RegistryService),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(s.ActivatedRoute))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["master-list-view"]],decls:15,vars:8,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[1,"row"],[1,"col-md-12"],["class","row",4,"ngIf"],["style","margin-right: 10px; font-size: 20px;",3,"ngClass","click",4,"ngIf"],[2,"margin-right","10px","font-size","20px",3,"ngClass","click"],["key","lists.published.link.label"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[3,"oid",4,"ngIf"],["href","#",3,"click"],["key","masterlist.view"],["key","lists.exploratory.link.label"],[3,"oid"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelement(1,"cgr-header"),o.ɵɵelement(2,"loading-bar"),o.ɵɵelementStart(3,"div",1),o.ɵɵelementStart(4,"div",2),o.ɵɵelementStart(5,"div",3),o.ɵɵtemplate(6,h,4,1,"div",4),o.ɵɵtemplate(7,f,6,0,"div",4),o.ɵɵelementStart(8,"div"),o.ɵɵtemplate(9,v,2,3,"a",5),o.ɵɵelementStart(10,"a",6),o.ɵɵlistener("click",(function(){return t.renderContent("PUB")})),o.ɵɵelement(11,"localize",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(12,"div",8),o.ɵɵtemplate(13,b,1,1,"published-master-list-history",9),o.ɵɵtemplate(14,S,1,1,"master-list-history",9),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(6),o.ɵɵproperty("ngIf",t.list),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.list),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",t.list&&t.list.read),o.ɵɵadvance(1),o.ɵɵproperty("ngClass",o.ɵɵpureFunction1(6,y,"PUB"===t.content)),o.ɵɵadvance(3),o.ɵɵproperty("ngIf",t.list&&"PUB"===t.content),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.list&&"EXP"===t.content))},directives:[c.CgrHeaderComponent,d.LoadingBarComponent,p.NgIf,p.NgClass,m.LocalizeComponent,u.PublishedMasterListHistoryComponent,g.MasterListHistoryComponent],styles:["a.active[_ngcontent-%COMP%] {\n\tborder-bottom: solid 2px #6BA542;\n}"]}),e}();t.MasterListViewComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"master-list-view",templateUrl:"./master-list-view.component.html",styleUrls:["./master-list-view.component.css"]}]}],(function(){return[{type:a.RegistryService},{type:l.BsModalService},{type:s.ActivatedRoute}]}),null)},595:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScheduledJobsComponent=void 0;var r=n(0),i=(n(33),n(30),n(31)),o=(n(518),n(111)),a=(n(16),n(112),n(260)),l=n(0),s=n(518),c=n(30),d=n(33),p=n(112),m=n(16),u=n(122),g=n(86),h=n(1),f=n(68),y=n(555),v=n(204);function b(e,t){if(1&e&&(l.ɵɵelementStart(0,"div",20),l.ɵɵtext(1),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext();l.ɵɵadvance(1),l.ɵɵtextInterpolate(n.message)}}function S(e,t){1&e&&l.ɵɵelement(0,"localize",36)}function C(e,t){1&e&&l.ɵɵelement(0,"localize",37)}function E(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",38),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext(2).$implicit;return l.ɵɵnextContext().onCancelScheduledJob(e.historyId,e)})),l.ɵɵelement(1,"localize",39),l.ɵɵelementEnd()}}function x(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",40),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext(2).$implicit;return l.ɵɵnextContext().onResolveScheduledJob(e.historyId,e)})),l.ɵɵelement(1,"localize",41),l.ɵɵelementEnd()}}function O(e,t){if(1&e&&(l.ɵɵelementStart(0,"td",28),l.ɵɵelementStart(1,"div",29),l.ɵɵelementStart(2,"a",30),l.ɵɵelementStart(3,"button",31),l.ɵɵtemplate(4,S,1,0,"localize",32),l.ɵɵtemplate(5,C,1,0,"localize",33),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(6,E,2,0,"button",34),l.ɵɵtemplate(7,x,2,0,"button",35),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext().$implicit;l.ɵɵadvance(2),l.ɵɵproperty("routerLink","/registry/job/"+n.historyId),l.ɵɵadvance(2),l.ɵɵproperty("ngIf","IMPORT_RESOLVE"===n.stage||"VALIDATION_RESOLVE"===n.stage),l.ɵɵadvance(1),l.ɵɵproperty("ngIf","IMPORT_RESOLVE"!=n.stage&&"VALIDATION_RESOLVE"!=n.stage),l.ɵɵadvance(1),l.ɵɵproperty("ngIf","VALIDATION_RESOLVE"===n.stage),l.ɵɵadvance(1),l.ɵɵproperty("ngIf","IMPORT_RESOLVE"===n.stage)}}function I(e,t){if(1&e&&(l.ɵɵelementStart(0,"tr"),l.ɵɵelementStart(1,"td",11),l.ɵɵelementStart(2,"div",21),l.ɵɵelement(3,"i",22),l.ɵɵelementStart(4,"p",23),l.ɵɵelementStart(5,"span",24),l.ɵɵtext(6),l.ɵɵelementEnd(),l.ɵɵelementStart(7,"span",24),l.ɵɵelementStart(8,"span",25),l.ɵɵtext(9),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(10,"span",24),l.ɵɵtext(11),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelement(12,"step-indicator",26),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(13,O,8,5,"td",27),l.ɵɵelementEnd()),2&e){var n=t.$implicit,r=l.ɵɵnextContext();l.ɵɵadvance(6),l.ɵɵtextInterpolate1(" ",n.fileName," "),l.ɵɵadvance(3),l.ɵɵtextInterpolate1(" ",r.formatDate(n.createDate)," "),l.ɵɵadvance(2),l.ɵɵtextInterpolate1(" ",r.formatJobStatus(n)," "),l.ɵɵadvance(1),l.ɵɵproperty("steps",n.stepConfig),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",r.isAdmin||r.isMaintainer)}}function w(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",42),l.ɵɵelementStart(1,"pagination-controls",43),l.ɵɵlistener("pageChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onActiveJobsPageChange(e)})),l.ɵɵelementEnd(),l.ɵɵelementEnd()}}function M(e,t){1&e&&(l.ɵɵelementStart(0,"th",44),l.ɵɵelement(1,"localize",45),l.ɵɵelementEnd())}function T(e,t){1&e&&(l.ɵɵelementStart(0,"th",44),l.ɵɵelement(1,"localize",46),l.ɵɵelementEnd())}function j(e,t){1&e&&(l.ɵɵelementStart(0,"th",44),l.ɵɵelement(1,"localize",47),l.ɵɵelementEnd())}function k(e,t){1&e&&(l.ɵɵelementStart(0,"th",44),l.ɵɵelement(1,"localize",48),l.ɵɵelementEnd())}function R(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"th",49),l.ɵɵelementStart(1,"button",50),l.ɵɵlistener("click",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onViewAllCompleteJobs()})),l.ɵɵelement(2,"localize",51),l.ɵɵelementEnd(),l.ɵɵelementEnd()}}function z(e,t){1&e&&l.ɵɵelement(0,"th",52)}function P(e,t){1&e&&l.ɵɵelement(0,"td",59)}function D(e,t){if(1&e&&(l.ɵɵelementStart(0,"tr"),l.ɵɵelementStart(1,"td",53),l.ɵɵelementStart(2,"div",21),l.ɵɵelement(3,"i",54),l.ɵɵelementStart(4,"p",55),l.ɵɵtext(5),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(6,"td",56),l.ɵɵelementStart(7,"p",57),l.ɵɵtext(8),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(9,"td",56),l.ɵɵelementStart(10,"p",57),l.ɵɵtext(11),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(12,"td",56),l.ɵɵelementStart(13,"span",25),l.ɵɵtext(14),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(15,"td",56),l.ɵɵelementStart(16,"span",25),l.ɵɵtext(17),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(18,P,1,0,"td",58),l.ɵɵelementEnd()),2&e){var n=t.$implicit,r=l.ɵɵnextContext();l.ɵɵadvance(5),l.ɵɵtextInterpolate(n.fileName),l.ɵɵadvance(3),l.ɵɵtextInterpolate(r.formatJobStatus(n)),l.ɵɵadvance(3),l.ɵɵtextInterpolate(n.importedRecords),l.ɵɵadvance(3),l.ɵɵtextInterpolate1(" ",r.formatDate(n.createDate)," "),l.ɵɵadvance(3),l.ɵɵtextInterpolate1(" ",r.formatDate(n.lastUpdateDate)," "),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",r.isAdmin||r.isMaintainer)}}function A(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",42),l.ɵɵelementStart(1,"pagination-controls",60),l.ɵɵlistener("pageChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onCompleteJobsPageChange(e)})),l.ɵɵelementEnd(),l.ɵɵelementEnd()}}var V=function(e,t,n){return{id:"activeJobs",itemsPerPage:e,currentPage:t,totalItems:n}},N=function(e,t,n){return{id:"completeJobs",itemsPerPage:e,currentPage:t,totalItems:n}},L=function(){function e(e,t,n,r,i,o,a){this.service=e,this.modalService=t,this.router=n,this.dateService=r,this.localizeService=i,this.ioService=a,this.message=null,this.activeJobsPage={count:0,pageNumber:1,pageSize:10,results:[]},this.completeJobsPage={count:0,pageNumber:1,pageSize:10,results:[]},this.activeTimeCounter=0,this.completeTimeCounter=0,this.isViewAllOpen=!1,this.isAdmin=o.isAdmin(),this.isMaintainer=this.isAdmin||o.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||o.isContributer()}return e.prototype.ngOnInit=function(){var e=this;this.onActiveJobsPageChange(1),this.pollingData=i.interval(1e3).subscribe((function(){e.activeTimeCounter++,e.completeTimeCounter++,e.isViewAllOpen?(e.activeTimeCounter>=4&&(e.onActiveJobsPageChange(e.activeJobsPage.pageNumber),e.activeTimeCounter=0),e.completeTimeCounter>=7&&(e.onCompleteJobsPageChange(e.completeJobsPage.pageNumber),e.completeTimeCounter=0)):e.activeTimeCounter>=2&&(e.onActiveJobsPageChange(e.activeJobsPage.pageNumber),e.activeTimeCounter=0)}))},e.prototype.ngOnDestroy=function(){this.pollingData.unsubscribe()},e.prototype.formatJobStatus=function(e){return"FEEDBACK"===e.status?this.localizeService.decode("etl.JobStatus.FEEDBACK"):"RUNNING"===e.status||"NEW"===e.status?this.localizeService.decode("etl.JobStatus.RUNNING"):"QUEUED"===e.status?this.localizeService.decode("etl.JobStatus.QUEUED"):"SUCCESS"===e.status?this.localizeService.decode("etl.JobStatus.SUCCESS"):"CANCELED"===e.status?this.localizeService.decode("etl.JobStatus.CANCELED"):"FAILURE"===e.status?this.localizeService.decode("etl.JobStatus.FAILURE"):this.localizeService.decode("etl.JobStatus.RUNNING")},e.prototype.formatStepConfig=function(e){var t=this;e.results.forEach((function(e){var n={steps:[{label:t.localizeService.decode("scheduler.step.fileImport"),status:"COMPLETE"},{label:t.localizeService.decode("scheduler.step.staging"),status:"NEW"===e.stage?t.getJobStatus(e):t.getCompletedStatus(e.stage,"NEW")},{label:t.localizeService.decode("scheduler.step.validation"),status:"VALIDATE"===e.stage||"VALIDATION_RESOLVE"===e.stage?t.getJobStatus(e):t.getCompletedStatus(e.stage,"VALIDATE")},{label:t.localizeService.decode("scheduler.step.databaseImport"),status:"IMPORT"===e.stage||"IMPORT_RESOLVE"===e.stage||"RESUME_IMPORT"===e.stage?t.getJobStatus(e):""}]};(e=e).stepConfig=n}))},e.prototype.getCompletedStatus=function(e,t){var n=["NEW","VALIDATE","VALIDATION_RESOLVE","IMPORT","IMPORT_RESOLVE","RESUME_IMPORT"],r=n.indexOf(e);return n.indexOf(t)<r?"COMPLETE":""},e.prototype.getJobStatus=function(e){return"QUEUED"===e.status||"RUNNING"===e.status?"WORKING":"FEEDBACK"===e.status?"STUCK":""},e.prototype.onViewAllCompleteJobs=function(){this.onCompleteJobsPageChange(1),this.isViewAllOpen=!0},e.prototype.onView=function(e){this.router.navigate(["/registry/master-list-history/",e])},e.prototype.onActiveJobsPageChange=function(e){var t=this;this.message=null,this.service.getScheduledJobs(this.activeJobsPage.pageSize,e,"createDate",!1).then((function(e){t.activeJobsPage=e,t.formatStepConfig(t.activeJobsPage)})).catch((function(e){t.error(e)}))},e.prototype.onCompleteJobsPageChange=function(e){var t=this;this.message=null,this.service.getCompletedScheduledJobs(this.completeJobsPage.pageSize,e,"createDate",!1).then((function(e){t.completeJobsPage=e,t.formatStepConfig(t.completeJobsPage)})).catch((function(e){t.error(e)}))},e.prototype.onCancelScheduledJob=function(e,t){var n=this;this.bsModalRef=this.modalService.show(o.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("etl.import.cancel.modal.description"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.cancel.modal.button"),this.bsModalRef.content.type=a.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(e){n.ioService.cancelImport(t.configuration).then((function(e){n.bsModalRef.hide();for(var r=0;r<n.activeJobsPage.results.length;++r){if(n.activeJobsPage.results[r].jobId===t.jobId){n.activeJobsPage.results.splice(r,1);break}}n.onViewAllCompleteJobs()})).catch((function(e){n.error(e)}))}))},e.prototype.onResolveScheduledJob=function(e,t){var n=this;this.bsModalRef=this.modalService.show(o.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("etl.import.resume.modal.importDescription"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.resume.modal.importButton"),this.bsModalRef.content.type=a.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(r){n.service.resolveScheduledJob(e).then((function(e){n.bsModalRef.hide();for(var r=0;r<n.activeJobsPage.results.length;++r){if(n.activeJobsPage.results[r].jobId===t.jobId){n.activeJobsPage.results.splice(r,1);break}}n.onViewAllCompleteJobs()})).catch((function(e){n.error(e)}))}))},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(l.ɵɵdirectiveInject(s.RegistryService),l.ɵɵdirectiveInject(c.BsModalService),l.ɵɵdirectiveInject(d.Router),l.ɵɵdirectiveInject(p.DateService),l.ɵɵdirectiveInject(m.LocalizationService),l.ɵɵdirectiveInject(m.AuthService),l.ɵɵdirectiveInject(s.IOService))},e.ɵcmp=l.ɵɵdefineComponent({type:e,selectors:[["scheduled-jobs"]],decls:37,vars:25,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","scheduledjobs.title"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"solid-table-wrapper"],[1,"table","table-striped"],[2,"height","56px"],[2,"vertical-align","middle"],["key","scheduledjobs.jobs.table.header"],[4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],[2,"width","40%","border-bottom","none"],["key","scheduledjobs.completedjobs.table.header",2,"line-height","40px"],["style","width:15%;border-bottom: none;",4,"ngIf"],["style","border-bottom: none; width:15%",4,"ngIf"],["style","border-bottom: none; width:0%",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","40px"],[2,"padding-left","60px"],[2,"display","block"],[1,"date-string-display"],[3,"steps"],["style","text-align: right;vertical-align: middle;",4,"ngIf"],[2,"text-align","right","vertical-align","middle"],[1,"button-holder",2,"float","right"],["routerLinkActive","active",3,"routerLink"],["role","button",1,"btn","btn-primary"],["key","scheduledjobs.fix.problems.button",4,"ngIf"],["key","scheduledjobs.detail.button",4,"ngIf"],["type","button","class","btn btn-danger","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],["key","scheduledjobs.fix.problems.button"],["key","scheduledjobs.detail.button"],["type","button","role","button",1,"btn","btn-danger",3,"click"],["key","etl.import.cancel.openModal"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","scheduledjobs.complete.import.button"],[1,"solid-table-footer"],["id","activeJobs",3,"pageChange"],[2,"width","15%","border-bottom","none"],["key","scheduledjobs.status",2,"line-height","40px"],["key","scheduledjobs.importedRecords",2,"line-height","40px"],["key","scheduledjobs.importStartDate",2,"line-height","40px"],["key","scheduledjobs.importEndDate",2,"line-height","40px"],[2,"border-bottom","none","width","15%"],["type","submit","role","button",1,"btn","btn-default","pull-right",3,"click"],["key","scheduledjobs.view.completed.jobs.button"],[2,"border-bottom","none","width","0%"],[2,"width","40%","vertical-align","middle"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute"],[2,"padding-left","30px","margin","0"],[2,"width","15%","vertical-align","middle"],[2,"padding-left","0px","margin","0"],["style","width:15%;text-align: right;vertical-align: middle;",4,"ngIf"],[2,"width","15%","text-align","right","vertical-align","middle"],["id","completeJobs",3,"pageChange"]],template:function(e,t){1&e&&(l.ɵɵelementStart(0,"div",0),l.ɵɵelement(1,"cgr-header"),l.ɵɵelement(2,"loading-bar"),l.ɵɵelementStart(3,"div",1),l.ɵɵtemplate(4,b,2,1,"div",2),l.ɵɵelementStart(5,"div",3),l.ɵɵelementStart(6,"h2"),l.ɵɵelement(7,"localize",4),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(8,"div",5),l.ɵɵelementStart(9,"div",6),l.ɵɵelementStart(10,"ul",7),l.ɵɵelementStart(11,"div",8),l.ɵɵelementStart(12,"table",9),l.ɵɵelementStart(13,"thead"),l.ɵɵelementStart(14,"tr",10),l.ɵɵelementStart(15,"th",11),l.ɵɵelement(16,"localize",12),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(17,"tbody"),l.ɵɵtemplate(18,I,14,5,"tr",13),l.ɵɵpipe(19,"paginate"),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(20,w,2,0,"div",14),l.ɵɵelementEnd(),l.ɵɵelementStart(21,"div",8),l.ɵɵelementStart(22,"table",9),l.ɵɵelementStart(23,"thead"),l.ɵɵelementStart(24,"tr"),l.ɵɵelementStart(25,"th",15),l.ɵɵelement(26,"localize",16),l.ɵɵelementEnd(),l.ɵɵtemplate(27,M,2,0,"th",17),l.ɵɵtemplate(28,T,2,0,"th",17),l.ɵɵtemplate(29,j,2,0,"th",17),l.ɵɵtemplate(30,k,2,0,"th",17),l.ɵɵtemplate(31,R,3,0,"th",18),l.ɵɵtemplate(32,z,1,0,"th",19),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(33,"tbody"),l.ɵɵtemplate(34,D,19,6,"tr",13),l.ɵɵpipe(35,"paginate"),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(36,A,2,0,"div",14),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e&&(l.ɵɵadvance(4),l.ɵɵproperty("ngIf",null!=t.message),l.ɵɵadvance(14),l.ɵɵproperty("ngForOf",l.ɵɵpipeBind2(19,11,t.activeJobsPage.results,l.ɵɵpureFunction3(17,V,t.activeJobsPage.pageSize,t.activeJobsPage.pageNumber,t.activeJobsPage.count))),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",t.activeJobsPage.results.length>0),l.ɵɵadvance(7),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length>0),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length>0),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length>0),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length>0),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length<1),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length>0),l.ɵɵadvance(2),l.ɵɵproperty("ngForOf",l.ɵɵpipeBind2(35,14,t.completeJobsPage.results,l.ɵɵpureFunction3(21,N,t.completeJobsPage.pageSize,t.completeJobsPage.pageNumber,t.completeJobsPage.count))),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",t.completeJobsPage.results.length>0))},directives:[u.CgrHeaderComponent,g.LoadingBarComponent,h.NgIf,f.LocalizeComponent,h.NgForOf,y.StepIndicatorComponent,d.RouterLinkWithHref,d.RouterLinkActive,v.PaginationControlsComponent],pipes:[v.PaginatePipe],styles:[".new-admin-design-main[_ngcontent-%COMP%] {\n    \n}\n\n\n.solid-table-wrapper[_ngcontent-%COMP%] {\n    background: #F4F4F4;\n    border-radius: 15px;\n    margin-bottom: 20px;\n}\n.solid-table-footer[_ngcontent-%COMP%] {\n    \n    border-radius: 0 0 15px 15px;\n    padding: 0 0 10px 10px;\n}\n\n\n\n.wrapper[_ngcontent-%COMP%] {\n    padding: 10px;\n}"]}),e}();t.ScheduledJobsComponent=L,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(L,[{type:r.Component,args:[{selector:"scheduled-jobs",templateUrl:"./scheduled-jobs.component.html",styleUrls:["./scheduled-jobs.css"]}]}],(function(){return[{type:s.RegistryService},{type:c.BsModalService},{type:d.Router},{type:p.DateService},{type:m.LocalizationService},{type:m.AuthService},{type:s.IOService}]}),null)},596:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JobComponent=void 0;var r=n(0),i=(n(33),n(30),n(379)),o=n(597),a=n(602),l=(n(518),n(112),n(111)),s=(n(16),n(260)),c=n(0),d=n(518),p=n(30),m=n(33),u=n(112),g=n(16),h=n(122),f=n(86),y=n(1),v=n(68),b=n(204);function S(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",7),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.message)}}function C(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",26),c.ɵɵelementStart(1,"span",27),c.ɵɵelement(2,"localize",28),c.ɵɵelementEnd(),c.ɵɵelementStart(3,"button",29),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2);return e.onResolveScheduledJob(e.job.historyId)})),c.ɵɵelement(4,"localize",30),c.ɵɵelementEnd(),c.ɵɵelementEnd()}}function E(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",26),c.ɵɵelementStart(1,"span",27),c.ɵɵelement(2,"localize",31),c.ɵɵelementEnd(),c.ɵɵelementStart(3,"button",29),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2);return e.onResolveScheduledJob(e.job.historyId)})),c.ɵɵelement(4,"localize",32),c.ɵɵelementEnd(),c.ɵɵelementEnd()}}function x(e,t){1&e&&c.ɵɵelement(0,"localize",36)}function O(e,t){1&e&&(c.ɵɵelementStart(0,"span"),c.ɵɵelement(1,"localize",32),c.ɵɵelementEnd())}function I(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",33),c.ɵɵelementStart(1,"button",29),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2);return e.onResolveScheduledJob(e.job.historyId)})),c.ɵɵtemplate(2,x,1,0,"localize",34),c.ɵɵtemplate(3,O,2,0,"span",35),c.ɵɵelementEnd(),c.ɵɵelementEnd()}if(2&e){var r=c.ɵɵnextContext(2);c.ɵɵadvance(2),c.ɵɵproperty("ngIf",r.job&&"VALIDATION_RESOLVE"===r.job.stage),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",r.job&&"IMPORT_RESOLVE"===r.job.stage)}}function w(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",37),c.ɵɵelementStart(1,"button",29),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext(2);return e.onReuploadAndResume(e.job.historyId)})),c.ɵɵelementStart(2,"span"),c.ɵɵelement(3,"localize",38),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()}}function M(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",8),c.ɵɵelementStart(1,"div",9),c.ɵɵelementStart(2,"div",10),c.ɵɵelement(3,"i",11),c.ɵɵelementStart(4,"p",12),c.ɵɵelementStart(5,"span",13),c.ɵɵelementStart(6,"strong"),c.ɵɵtext(7),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(8,"span",13),c.ɵɵelement(9,"localize",14),c.ɵɵtext(10),c.ɵɵelementEnd(),c.ɵɵelementStart(11,"span",13),c.ɵɵelement(12,"localize",15),c.ɵɵelementStart(13,"span",16),c.ɵɵtext(14),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(15,"div",17),c.ɵɵelementStart(16,"div"),c.ɵɵelementStart(17,"h5"),c.ɵɵelementStart(18,"b"),c.ɵɵtext(19),c.ɵɵelement(20,"localize",18),c.ɵɵtext(21),c.ɵɵelement(22,"localize",19),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(23,"h5"),c.ɵɵtext(24),c.ɵɵelement(25,"localize",20),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(26,"div",21),c.ɵɵtemplate(27,C,5,0,"div",22),c.ɵɵtemplate(28,E,5,0,"div",23),c.ɵɵtemplate(29,I,4,2,"div",24),c.ɵɵtemplate(30,w,4,0,"div",25),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(7),c.ɵɵtextInterpolate(n.job.fileName),c.ɵɵadvance(3),c.ɵɵtextInterpolate1(" ",n.job.author," "),c.ɵɵadvance(4),c.ɵɵtextInterpolate1(" ",n.formatDate(n.job.createDate)," "),c.ɵɵadvance(5),c.ɵɵtextInterpolate1("",n.job.importedRecords," "),c.ɵɵadvance(2),c.ɵɵtextInterpolate1(" ",n.job.workTotal," "),c.ɵɵadvance(3),c.ɵɵtextInterpolate1("",n.job.workTotal-n.job.importedRecords," "),c.ɵɵadvance(3),c.ɵɵproperty("ngIf",0==n.page.results.length&&n.job&&"VALIDATION_RESOLVE"===n.job.stage),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",0==n.page.results.length&&n.job&&"IMPORT_RESOLVE"===n.job.stage),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",n.page&&null!=n.page.results&&n.page.results.length>0&&!n.hasRowValidationProblem),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",n.hasRowValidationProblem)}}function T(e,t){1&e&&(c.ɵɵelementStart(0,"thead"),c.ɵɵelementStart(1,"tr"),c.ɵɵelementStart(2,"th",46),c.ɵɵelement(3,"localize",47),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"th",46),c.ɵɵelement(5,"localize",48),c.ɵɵelementEnd(),c.ɵɵelementStart(6,"th",46),c.ɵɵelement(7,"localize",49),c.ɵɵelementEnd(),c.ɵɵelement(8,"th",46),c.ɵɵelementEnd(),c.ɵɵelementEnd())}function j(e,t){1&e&&(c.ɵɵelementStart(0,"thead"),c.ɵɵelementStart(1,"tr"),c.ɵɵelementStart(2,"th",46),c.ɵɵelement(3,"localize",50),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"th",46),c.ɵɵelement(5,"localize",51),c.ɵɵelementEnd(),c.ɵɵelementStart(6,"th",46),c.ɵɵelement(7,"localize",52),c.ɵɵelementEnd(),c.ɵɵelement(8,"th",46),c.ɵɵelementEnd(),c.ɵɵelementEnd())}function k(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"td",56),c.ɵɵelementStart(1,"button",57),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext().$implicit;return c.ɵɵnextContext(4).onEdit(e)})),c.ɵɵelement(2,"localize",58),c.ɵɵelementEnd(),c.ɵɵelementEnd()}}function R(e,t){if(1&e&&(c.ɵɵelementStart(0,"tr"),c.ɵɵelementStart(1,"td",54),c.ɵɵelementStart(2,"p"),c.ɵɵtext(3),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"td",54),c.ɵɵelementStart(5,"p"),c.ɵɵtext(6),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"td",54),c.ɵɵelementStart(8,"p"),c.ɵɵtext(9),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵtemplate(10,k,3,0,"td",55),c.ɵɵelementEnd()),2&e){var n=t.$implicit,r=c.ɵɵnextContext(4);c.ɵɵadvance(3),c.ɵɵtextInterpolate(r.getFriendlyProblemType(n.exception.type)),c.ɵɵadvance(3),c.ɵɵtextInterpolate(n.exception.message),c.ɵɵadvance(3),c.ɵɵtextInterpolate(n.rowNum),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",r.isAdmin||r.isMaintainer)}}var z=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function P(e,t){if(1&e&&(c.ɵɵelementStart(0,"tbody"),c.ɵɵtemplate(1,R,11,4,"tr",53),c.ɵɵpipe(2,"paginate"),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext(3);c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",c.ɵɵpipeBind2(2,1,n.page.results,c.ɵɵpureFunction3(4,z,n.page.pageSize,n.page.pageNumber,n.page.count)))}}function D(e,t){if(1&e&&(c.ɵɵelementStart(0,"p"),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext().$implicit;c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.exception.message)}}function A(e,t){if(1&e&&(c.ɵɵelementStart(0,"p"),c.ɵɵtext(1),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext().$implicit;c.ɵɵadvance(1),c.ɵɵtextInterpolate(n.label)}}function V(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"td",56),c.ɵɵelementStart(1,"button",57),c.ɵɵlistener("click",(function(){c.ɵɵrestoreView(n);var e=c.ɵɵnextContext().$implicit;return c.ɵɵnextContext(4).onEdit(e)})),c.ɵɵelement(2,"localize",58),c.ɵɵelementEnd(),c.ɵɵelementEnd()}}function N(e,t){if(1&e&&(c.ɵɵelementStart(0,"tr"),c.ɵɵelementStart(1,"td",54),c.ɵɵelementStart(2,"p"),c.ɵɵtext(3),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementStart(4,"td",54),c.ɵɵtemplate(5,D,2,1,"p",35),c.ɵɵtemplate(6,A,2,1,"p",35),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"td",54),c.ɵɵelementStart(8,"p"),c.ɵɵtext(9),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵtemplate(10,V,3,0,"td",55),c.ɵɵelementEnd()),2&e){var n=t.$implicit,r=c.ɵɵnextContext(4);c.ɵɵadvance(3),c.ɵɵtextInterpolate(n.type),c.ɵɵadvance(2),c.ɵɵproperty("ngIf","RowValidationProblem"===n.type),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","ParentReferenceProblem"===n.type||"TermReferenceProblem"===n.type),c.ɵɵadvance(3),c.ɵɵtextInterpolate(r.formatAffectedRows(n.affectedRows)),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",r.isAdmin||r.isMaintainer)}}function L(e,t){if(1&e&&(c.ɵɵelementStart(0,"tbody"),c.ɵɵtemplate(1,N,11,5,"tr",53),c.ɵɵpipe(2,"paginate"),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext(3);c.ɵɵadvance(1),c.ɵɵproperty("ngForOf",c.ɵɵpipeBind2(2,1,n.page.results,c.ɵɵpureFunction3(4,z,n.page.pageSize,n.page.pageNumber,n.page.count)))}}function _(e,t){if(1&e){var n=c.ɵɵgetCurrentView();c.ɵɵelementStart(0,"div",44),c.ɵɵelementStart(1,"pagination-controls",59),c.ɵɵlistener("pageChange",(function(e){return c.ɵɵrestoreView(n),c.ɵɵnextContext(3).onPageChange(e)})),c.ɵɵelementEnd(),c.ɵɵelementEnd()}}function F(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",41),c.ɵɵelementStart(1,"ul",42),c.ɵɵelementStart(2,"table",43),c.ɵɵtemplate(3,T,9,0,"thead",35),c.ɵɵtemplate(4,j,9,0,"thead",35),c.ɵɵtemplate(5,P,3,8,"tbody",35),c.ɵɵtemplate(6,L,3,8,"tbody",35),c.ɵɵelementEnd(),c.ɵɵelementStart(7,"div",44),c.ɵɵtemplate(8,_,2,0,"div",45),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext(2);c.ɵɵadvance(3),c.ɵɵproperty("ngIf","IMPORT_RESOLVE"===n.job.stage),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","VALIDATION_RESOLVE"===n.job.stage),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","IMPORT_RESOLVE"===n.job.stage),c.ɵɵadvance(1),c.ɵɵproperty("ngIf","VALIDATION_RESOLVE"===n.job.stage),c.ɵɵadvance(2),c.ɵɵproperty("ngIf",n.page.results.length>0)}}function H(e,t){if(1&e&&(c.ɵɵelementStart(0,"div",39),c.ɵɵtemplate(1,F,9,5,"div",40),c.ɵɵelementEnd()),2&e){var n=c.ɵɵnextContext();c.ɵɵadvance(1),c.ɵɵproperty("ngIf",n.job)}}var G=function(){function e(e,t,n,r,i,o,a,l){this.service=e,this.modalService=t,this.router=n,this.route=r,this.dateService=i,this.localizeService=o,this.ioService=l,this.message=null,this.allSelected=!1,this.historyId="",this.page={count:0,pageNumber:1,pageSize:10,results:[]},this.timeCounter=0,this.isPolling=!1,this.hasRowValidationProblem=!1,this.isAdmin=a.isAdmin(),this.isMaintainer=this.isAdmin||a.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||a.isContributer()}return e.prototype.ngOnInit=function(){var e=this;this.historyId=this.route.snapshot.params.oid,this.onPageChange(1);var t="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=i.webSocket(t+"/websocket/notify"),this.notifier.subscribe((function(t){"IMPORT_JOB_CHANGE"===t.type&&e.onPageChange(e.page.pageNumber)}))},e.prototype.ngOnDestroy=function(){},e.prototype.formatAffectedRows=function(e){return e.replace(/,/g,", ")},e.prototype.formatValidationResolve=function(e){return JSON.stringify(e)},e.prototype.onProblemResolved=function(e){for(var t=0;t<this.page.results.length;++t){this.page.results[t].id===e.id&&this.page.results.splice(t,1)}},e.prototype.getFriendlyProblemType=function(e){return"net.geoprism.registry.io.ParentCodeException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.parent.lookup"):"net.geoprism.registry.io.PostalCodeLocationException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.postal.code.lookup"):"net.geoprism.registry.io.AmbiguousParentException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.multi.parent.lookup"):"net.geoprism.registry.io.InvalidGeometryException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.invalid.geom.lookup"):"net.geoprism.registry.DataNotFoundException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.datanotfound"):"net.geoprism.registry.geoobject.ImportOutOfRangeException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.importOutOfRange"):"net.geoprism.registry.roles.CreateGeoObjectPermissionException"===e||"net.geoprism.registry.roles.WriteGeoObjectPermissionException"===e||"net.geoprism.registry.roles.DeleteGeoObjectPermissionException"===e||"net.geoprism.registry.roles.ReadGeoObjectPermissionException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.permission"):"com.runwaysdk.dataaccess.DuplicateDataException"===e||"net.geoprism.registry.DuplicateGeoObjectException"===e||"net.geoprism.registry.DuplicateGeoObjectCodeException"===e?this.localizeService.decode("scheduledjobs.job.problem.type.duplicate.data.lookup"):e},e.prototype.onEdit=function(e){var t=this;this.bsModalRef=this.modalService.show(o.JobConflictModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.problem=e,this.bsModalRef.content.job=this.job,this.bsModalRef.content.onConflictAction.subscribe((function(e){"RESOLVED"===e.action&&t.onProblemResolved(e.data)}))},e.prototype.onPageChange=function(e){var t=this;this.message=null,this.service.getScheduledJob(this.historyId,this.page.pageSize,e,!0).then((function(e){if(t.job=e,"IMPORT_RESOLVE"===t.job.stage)t.page=t.job.importErrors;else if("VALIDATION_RESOLVE"===t.job.stage){t.page=t.job.problems;for(var n=0;n<t.page.results.length;++n){"RowValidationProblem"===t.page.results[n].type&&(t.hasRowValidationProblem=!0)}}})).catch((function(e){t.error(e)}))},e.prototype.onViewAllActiveJobs=function(){},e.prototype.onViewAllCompleteJobs=function(){},e.prototype.toggleAll=function(){var e=this;this.allSelected=!this.allSelected,this.job.importErrors.results.forEach((function(t){t.selected=e.allSelected}))},e.prototype.onReuploadAndResume=function(e){var t=this;this.bsModalRef=this.modalService.show(a.ReuploadModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.job=this.job,this.bsModalRef.content.onConfirm.subscribe((function(e){t.router.navigate(["/registry/scheduled-jobs"])}))},e.prototype.onResolveScheduledJob=function(e){var t=this;0===this.page.results.length?this.service.resolveScheduledJob(e).then((function(e){t.router.navigate(["/registry/scheduled-jobs"])})).catch((function(e){t.error(e)})):(this.bsModalRef=this.modalService.show(l.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),"VALIDATION_RESOLVE"===this.job.stage?(this.bsModalRef.content.message=this.localizeService.decode("etl.import.resume.modal.validationDescription"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.resume.modal.validationButton")):(this.bsModalRef.content.message=this.localizeService.decode("etl.import.resume.modal.importDescription"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.resume.modal.importButton")),this.bsModalRef.content.type=s.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(n){t.service.resolveScheduledJob(e).then((function(e){t.router.navigate(["/registry/scheduled-jobs"])})).catch((function(e){t.error(e)}))})))},e.prototype.onCancelScheduledJob=function(e){var t=this;this.bsModalRef=this.modalService.show(l.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("etl.import.cancel.modal.description"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.cancel.modal.button"),this.bsModalRef.content.type=s.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(e){t.ioService.cancelImport(t.job.configuration).then((function(e){t.router.navigate(["/registry/scheduled-jobs"])})).catch((function(e){t.error(e)}))}))},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=l.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(c.ɵɵdirectiveInject(d.RegistryService),c.ɵɵdirectiveInject(p.BsModalService),c.ɵɵdirectiveInject(m.Router),c.ɵɵdirectiveInject(m.ActivatedRoute),c.ɵɵdirectiveInject(u.DateService),c.ɵɵdirectiveInject(g.LocalizationService),c.ɵɵdirectiveInject(g.AuthService),c.ɵɵdirectiveInject(d.IOService))},e.ɵcmp=c.ɵɵdefineComponent({type:e,selectors:[["job"]],decls:10,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","scheduledjobs.details.title"],["class","row","style","background: #F4F4F4;\n                                border-radius: 15px;\n                                margin-bottom: 20px;\n                                margin-top: 20px;\n                                padding: 10px;",4,"ngIf"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"background","#F4F4F4","border-radius","15px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-4","order-md-1"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","scheduledjobs.job.uploaded.by.label"],["key","scheduledjobs.job.started.label"],[1,"date-string-display"],[1,"col-md-3","order-md-1"],["key","scheduledjobs.job.imported.out.of.label"],["key","scheduledjobs.job.imported.total.label"],["key","scheduledjobs.job.remaining.label"],[1,"col-md-5","order-md-1"],["style","display:block; margin: 10px;text-align: right;",4,"ngIf"],["style","display:block; margin:10px;text-align: right;",4,"ngIf"],["class","button-holder","style","display:block; margin:10px;text-align: right;",4,"ngIf"],["class","button-holder","style","display:block; margin:10px;",4,"ngIf"],[2,"display","block","margin","10px","text-align","right"],[2,"display","block","margin-bottom","10px"],["key","scheduledjobs.validation.problems.complete.msg"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","scheduledjobs.reimport.button"],["key","scheduledjobs.import.problems.complete.msg"],["key","scheduledjobs.complete.import.button"],[1,"button-holder",2,"display","block","margin","10px","text-align","right"],["key","etl.import.resume.openModal",4,"ngIf"],[4,"ngIf"],["key","etl.import.resume.openModal"],[1,"button-holder",2,"display","block","margin","10px"],["key","scheduledjobs.reupload.resume.button"],[1,"row"],["class","col-md-12 order-md-1",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"list-table","table","table-bordered","table-striped"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[1,"label-column"],["key","scheduledjobs.import.table.problem.type.header"],["key","scheduledjobs.import.table.message.header"],["key","scheduledjobs.import.table.row.number.header"],["key","scheduledjobs.validation.table.problem.type.header"],["key","scheduledjobs.validation.table.label.header"],["key","scheduledjobs.validation.table.affected.rows.header"],[4,"ngFor","ngForOf"],[1,"label-column",2,"vertical-align","middle"],["class","label-column","style","text-align: right;",4,"ngIf"],[1,"label-column",2,"text-align","right"],["type","submit","role","button",1,"btn","btn-link",3,"click"],["key","scheduledjobs.fix.problem.button"],[3,"pageChange"]],template:function(e,t){1&e&&(c.ɵɵelementStart(0,"div",0),c.ɵɵelement(1,"cgr-header"),c.ɵɵelement(2,"loading-bar"),c.ɵɵelementStart(3,"div",1),c.ɵɵtemplate(4,S,2,1,"div",2),c.ɵɵelementStart(5,"div",3),c.ɵɵelementStart(6,"h2"),c.ɵɵelement(7,"localize",4),c.ɵɵelementEnd(),c.ɵɵelementEnd(),c.ɵɵtemplate(8,M,31,10,"div",5),c.ɵɵtemplate(9,H,2,1,"div",6),c.ɵɵelementEnd(),c.ɵɵelementEnd()),2&e&&(c.ɵɵadvance(4),c.ɵɵproperty("ngIf",null!=t.message),c.ɵɵadvance(4),c.ɵɵproperty("ngIf",t.job),c.ɵɵadvance(1),c.ɵɵproperty("ngIf",t.page&&t.page.results.length>0))},directives:[h.CgrHeaderComponent,f.LoadingBarComponent,y.NgIf,v.LocalizeComponent,y.NgForOf,b.PaginationControlsComponent],pipes:[b.PaginatePipe],styles:[".new-admin-design-main[_ngcontent-%COMP%] {\n    \n}\n\n\n.solid-table-wrapper[_ngcontent-%COMP%] {\n    background: #F4F4F4;\n    border-radius: 15px;\n    margin-bottom: 20px;\n}\n.solid-table-footer[_ngcontent-%COMP%] {\n    \n    border-radius: 0 0 15px 15px;\n    padding: 0 0 10px 10px;\n}\n\n\n\n.wrapper[_ngcontent-%COMP%] {\n    padding: 10px;\n}"]}),e}();t.JobComponent=G,("undefined"==typeof ngDevMode||ngDevMode)&&c.ɵsetClassMetadata(G,[{type:r.Component,args:[{selector:"job",templateUrl:"./job.component.html",styleUrls:["./scheduled-jobs.css"]}]}],(function(){return[{type:d.RegistryService},{type:p.BsModalService},{type:m.Router},{type:m.ActivatedRoute},{type:u.DateService},{type:g.LocalizationService},{type:g.AuthService},{type:d.IOService}]}),null)},597:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JobConflictModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=(n(518),n(111)),a=(n(16),n(0)),l=n(518),s=n(16),c=n(30),d=n(1),p=n(68),m=n(22),u=n(598),g=n(599),h=n(600),f=n(601);function y(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",12),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function v(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div"),a.ɵɵelementStart(1,"import-problem-widget",13),a.ɵɵlistener("onProblemResolved",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext();return e.onProblemResolvedListener(e.problem)})),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("problem",r.problem)("job",r.job)}}function b(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"parent-reference-problem-widget",13),a.ɵɵlistener("onProblemResolved",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(2);return e.onProblemResolvedListener(e.problem)})),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵproperty("problem",r.problem)("job",r.job)}}function S(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"term-reference-problem-widget",13),a.ɵɵlistener("onProblemResolved",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(2);return e.onProblemResolvedListener(e.problem)})),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵproperty("problem",r.problem)("job",r.job)}}function C(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"row-validation-problem-widget",13),a.ɵɵlistener("onProblemResolved",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(2);return e.onProblemResolvedListener(e.problem)})),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵproperty("problem",r.problem)("job",r.job)}}function E(e,t){if(1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵtemplate(1,b,1,2,"parent-reference-problem-widget",14),a.ɵɵtemplate(2,S,1,2,"term-reference-problem-widget",14),a.ɵɵtemplate(3,C,1,2,"row-validation-problem-widget",14),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngIf","ParentReferenceProblem"===n.problem.type),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","TermReferenceProblem"===n.problem.type),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","RowValidationProblem"===n.problem.type)}}var x=function(){function e(e,t,n,r){this.service=e,this.iService=t,this.lService=n,this.bsModalRef=r,this.message=null,this.readonly=!1,this.edit=!1,this.onConflictAction=new i.Subject}return e.prototype.ngOnInit=function(){},e.prototype.onProblemResolvedListener=function(e){this.onConflictAction.next({action:"RESOLVED",data:e})},e.prototype.onCancel=function(){this.bsModalRef.hide()},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(l.IOService),a.ɵɵdirectiveInject(s.LocalizationService),a.ɵɵdirectiveInject(c.BsModalRef))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["job-conflict-modal"]],decls:15,vars:3,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"text-center"],["key","scheduledjobs.problemdetail.modal.title"],[1,"modal-form"],["form","ngForm"],[4,"ngIf"],[1,"row-holder"],[1,""],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.back"],["role","alert",1,"alert","alert-danger"],[3,"problem","job","onProblemResolved"],[3,"problem","job","onProblemResolved",4,"ngIf"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,y,2,1,"div",1),a.ɵɵelementStart(2,"div",2),a.ɵɵelementStart(3,"h2"),a.ɵɵelement(4,"localize",3),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"form",4,5),a.ɵɵelementStart(7,"fieldset"),a.ɵɵtemplate(8,v,2,2,"div",6),a.ɵɵtemplate(9,E,4,3,"div",6),a.ɵɵelementStart(10,"div",7),a.ɵɵelementStart(11,"div",8),a.ɵɵelementStart(12,"div",9),a.ɵɵelementStart(13,"button",10),a.ɵɵlistener("click",(function(){return t.onCancel()})),a.ɵɵelement(14,"localize",11),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(7),a.ɵɵproperty("ngIf",t.problem&&t.job&&"IMPORT_RESOLVE"===t.job.stage),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.problem&&t.job&&"VALIDATION_RESOLVE"===t.job.stage))},directives:[d.NgIf,p.LocalizeComponent,m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,u.ImportProblemWidgetComponent,g.ParentReferenceProblemWidgetComponent,h.TermReferenceProblemWidgetComponent,f.RowValidationProblemWidgetComponent],encapsulation:2}),e}();t.JobConflictModalComponent=x,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(x,[{type:r.Component,args:[{selector:"job-conflict-modal",templateUrl:"./job-conflict-modal.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:l.IOService},{type:s.LocalizationService},{type:c.BsModalRef}]}),null)},598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImportProblemWidgetComponent=void 0;var r=n(0),i=(n(30),n(203),n(554)),o=(n(518),n(112),n(111)),a=(n(16),n(0)),l=n(518),s=n(112),c=n(16),d=n(30),p=n(1),m=n(68);function u(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",13),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function g(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",3),a.ɵɵelementStart(1,"div",14),a.ɵɵelementStart(2,"div",15),a.ɵɵelement(3,"i",16),a.ɵɵelementStart(4,"p",17),a.ɵɵelementStart(5,"span",18),a.ɵɵelementStart(6,"strong"),a.ɵɵtext(7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"span",18),a.ɵɵelement(9,"localize",19),a.ɵɵtext(10),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"span",18),a.ɵɵelement(12,"localize",20),a.ɵɵtext(13,": "),a.ɵɵelementStart(14,"span",21),a.ɵɵtext(15),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelement(16,"div",14),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(7),a.ɵɵtextInterpolate(n.job.fileName),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(": ",n.job.author," "),a.ɵɵadvance(5),a.ɵɵtextInterpolate1(" ",n.formatDate(n.job.createDate)," ")}}function h(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",22),a.ɵɵelementStart(1,"button",23),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onEditGeoObject()})),a.ɵɵelement(2,"localize",24),a.ɵɵelementEnd(),a.ɵɵelementEnd()}}var f=function(){function e(e,t,n,i,o,a){this.service=e,this.iService=t,this.dateService=n,this.lService=i,this.bsModalRef=o,this.modalService=a,this.message=null,this.onProblemResolved=new r.EventEmitter,this.readonly=!1,this.edit=!1}return e.prototype.ngOnInit=function(){},e.prototype.onEditGeoObject=function(){var e=this,t=this.modalService.show(i.GeoObjectEditorComponent,{backdrop:!0,ignoreBackdropClick:!0});t.content.configureFromImportError(this.problem,this.job.historyId,this.job.configuration.startDate,!0),t.content.setMasterListId(null),t.content.setOnSuccessCallback((function(){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()}))},e.prototype.getFriendlyProblemType=function(e){return"net.geoprism.registry.io.ParentCodeException"===e?this.lService.decode("scheduledjobs.job.problem.type.parent.lookup"):"net.geoprism.registry.io.PostalCodeLocationException"===e?this.lService.decode("scheduledjobs.job.problem.type.postal.code.lookup"):"net.geoprism.registry.io.AmbiguousParentException"===e?this.lService.decode("scheduledjobs.job.problem.type.multi.parent.lookup"):"net.geoprism.registry.io.InvalidGeometryException"===e?this.lService.decode("scheduledjobs.job.problem.type.invalid.geom.lookup"):"net.geoprism.registry.DataNotFoundException"===e?this.lService.decode("scheduledjobs.job.problem.type.datanotfound"):"net.geoprism.registry.roles.CreateGeoObjectPermissionException"===e||"net.geoprism.registry.roles.WriteGeoObjectPermissionException"===e||"net.geoprism.registry.roles.DeleteGeoObjectPermissionException"===e||"net.geoprism.registry.roles.ReadGeoObjectPermissionException"===e?this.lService.decode("scheduledjobs.job.problem.type.permission"):"com.runwaysdk.dataaccess.DuplicateDataException"===e||"net.geoprism.registry.DuplicateGeoObjectException"===e||"net.geoprism.registry.DuplicateGeoObjectCodeException"===e?this.lService.decode("scheduledjobs.job.problem.type.duplicate.data.lookup"):e},e.prototype.onSubmit=function(){},e.prototype.onCancel=function(){this.bsModalRef.hide()},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(l.IOService),a.ɵɵdirectiveInject(s.DateService),a.ɵɵdirectiveInject(c.LocalizationService),a.ɵɵdirectiveInject(d.BsModalRef),a.ɵɵdirectiveInject(d.BsModalService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["import-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:20,vars:5,consts:[[1,""],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],[1,"row","equal",2,"display","flex","display","-webkit-flex","flex-wrap","wrap"],[1,"col-md-6",2,"padding-right","5px"],[2,"background","white","border-radius","10px","padding","10px","height","100%"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],[1,"col-md-6",2,"padding-left","5px"],["style","background: white;border-radius: 10px;padding: 10px;height: 100%;text-align: center;",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display",2,"margin-left","5px"],[2,"background","white","border-radius","10px","padding","10px","height","100%","text-align","center"],["type","submit","role","button",1,"btn","btn-primary",2,"width","90%",3,"click"],["key","scheduledjobs.editGeoObject"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,u,2,1,"div",1),a.ɵɵtemplate(2,g,17,3,"div",2),a.ɵɵelementStart(3,"div",3),a.ɵɵelementStart(4,"div",4),a.ɵɵelementStart(5,"div",5),a.ɵɵelementStart(6,"div",6),a.ɵɵelementStart(7,"div",7),a.ɵɵelementStart(8,"h4"),a.ɵɵelementStart(9,"strong"),a.ɵɵelement(10,"localize",8),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"p",9),a.ɵɵtext(12),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"h4"),a.ɵɵelementStart(14,"strong"),a.ɵɵelement(15,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(16,"p",9),a.ɵɵtext(17),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(18,"div",11),a.ɵɵtemplate(19,h,3,0,"div",12),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.problem&&t.job),a.ɵɵadvance(10),a.ɵɵtextInterpolate(t.getFriendlyProblemType(t.problem.exception.type)),a.ɵɵadvance(5),a.ɵɵtextInterpolate(t.problem.exception.message),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",null!=t.problem.object&&null!=t.problem.object.geoObject))},directives:[p.NgIf,m.LocalizeComponent],encapsulation:2}),e}();t.ImportProblemWidgetComponent=f,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(f,[{type:r.Component,args:[{selector:"import-problem-widget",templateUrl:"./import-problem-widget.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:l.IOService},{type:s.DateService},{type:c.LocalizationService},{type:d.BsModalRef},{type:d.BsModalService}]}),{problem:[{type:r.Input}],job:[{type:r.Input}],onProblemResolved:[{type:r.Output}]})},599:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParentReferenceProblemWidgetComponent=void 0;var r=n(0),i=(n(30),n(31)),o=(n(203),n(518),n(112),n(111)),a=(n(16),n(0)),l=n(518),s=n(112),c=n(16),d=n(30),p=n(1),m=n(68),u=n(22),g=n(154);function h(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",30),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",3),a.ɵɵelementStart(1,"div",31),a.ɵɵelementStart(2,"div",32),a.ɵɵelement(3,"i",33),a.ɵɵelementStart(4,"p",34),a.ɵɵelementStart(5,"span",35),a.ɵɵelementStart(6,"strong"),a.ɵɵtext(7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"span",35),a.ɵɵelement(9,"localize",36),a.ɵɵtext(10),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"span",35),a.ɵɵelement(12,"localize",37),a.ɵɵtext(13,": "),a.ɵɵelementStart(14,"span",38),a.ɵɵtext(15),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelement(16,"div",31),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(7),a.ɵɵtextInterpolate(n.job.fileName),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(": ",n.job.author," "),a.ɵɵadvance(5),a.ɵɵtextInterpolate1(" ",n.formatDate(n.job.createDate)," ")}}function y(e,t){if(1&e&&(a.ɵɵelementStart(0,"ol"),a.ɵɵelementStart(1,"li"),a.ɵɵtext(2),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵadvance(2),a.ɵɵtextInterpolate2("",n.label," (",n.type,")")}}function v(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",39),a.ɵɵtemplate(1,y,3,2,"ol",40),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngForOf",n.problem.context)}}var b=function(){function e(e,t,n,i,o,a){this.service=e,this.iService=t,this.dateService=n,this.lService=i,this.bsModalRef=o,this.modalService=a,this.message=null,this.onProblemResolved=new r.EventEmitter,this.readonly=!1,this.edit=!1}return e.prototype.ngOnInit=function(){this.problem.parent=null,this.searchLabel=""},e.prototype.getString=function(e){return JSON.stringify(e)},e.prototype.getValidationProblemDisplayLabel=function(e){return e.type},e.prototype.getTypeAheadObservable=function(e,t){var n=this,r=this.job.configuration.hierarchy;return i.Observable.create((function(t){n.service.getGeoObjectSuggestions(n.searchLabel,e,null,null,r,n.job.startDate).then((function(e){t.next(e)}))}))},e.prototype.typeaheadOnSelect=function(e,t){var n=this;this.service.getParentGeoObjects(e.item.uid,t.typeCode,[],!1,this.job.startDate).then((function(e){t.parent=e.geoObject,n.searchLabel=e.geoObject.properties.displayLabel.localizedValue})).catch((function(e){n.error(e)}))},e.prototype.onIgnore=function(){var e=this,t={resolution:"IGNORE",validationProblemId:this.problem.id};this.service.submitValidationResolve(t).then((function(t){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.onCreateSynonym=function(){var e=this,t={validationProblemId:this.problem.id,resolution:"SYNONYM",code:this.problem.parent.properties.code,typeCode:this.problem.parent.properties.type,label:this.problem.label};this.service.submitValidationResolve(t).then((function(t){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.onCancel=function(){this.bsModalRef.hide()},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(l.IOService),a.ɵɵdirectiveInject(s.DateService),a.ɵɵdirectiveInject(c.LocalizationService),a.ɵɵdirectiveInject(d.BsModalRef),a.ɵɵdirectiveInject(d.BsModalService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["parent-reference-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:55,vars:12,consts:[[1,"container"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],[1,"row"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","margin-right","7px"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],["key","etl.parentProblem.message"],["key","etl.problem.header.toResolve"],["key","etl.parentProblem.toResolve"],[1,"com-md-6",2,"background","white","border-radius","10px","width","41%","float","left","height","250px"],[1,"row-holder"],[1,"label-holder",2,"width","100px"],[1,"text"],["key","etl.problem.parent.context"],[1,"holder",2,"width","300px"],["style","margin-top:10px;",4,"ngIf"],["key","etl.problem.parent.label"],[1,"text",2,"margin-top","10px"],[1,"row-holder",2,"overflow","visible"],["key","etl.problem.parent.synonym"],["type","text","autocomplete","off","name","parentSearch","typeaheadOptionField","name",1,"form-control",2,"width","150px",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadWaitMs","ngModelChange","typeaheadOnSelect"],["key","etl.problem.parent.actions"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","etl.problem.reference.createSynonym"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","etl.problem.reference.ignore"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display"],[2,"margin-top","10px"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,h,2,1,"div",1),a.ɵɵtemplate(2,f,17,3,"div",2),a.ɵɵelementStart(3,"div",3),a.ɵɵelementStart(4,"div",4),a.ɵɵelementStart(5,"div",5),a.ɵɵelementStart(6,"div",6),a.ɵɵelementStart(7,"h4"),a.ɵɵelementStart(8,"strong"),a.ɵɵelement(9,"localize",7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(10,"p",8),a.ɵɵtext(11),a.ɵɵelementEnd(),a.ɵɵelementStart(12,"h4"),a.ɵɵelementStart(13,"strong"),a.ɵɵelement(14,"localize",9),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(15,"p",8),a.ɵɵelement(16,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementStart(17,"h4"),a.ɵɵelementStart(18,"strong"),a.ɵɵelement(19,"localize",11),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(20,"p"),a.ɵɵelement(21,"localize",12),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(22,"div",13),a.ɵɵelementStart(23,"div",14),a.ɵɵelementStart(24,"div",15),a.ɵɵelementStart(25,"label"),a.ɵɵelementStart(26,"span",16),a.ɵɵelement(27,"localize",17),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(28,"div",18),a.ɵɵtemplate(29,v,2,1,"div",19),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(30,"div",14),a.ɵɵelementStart(31,"div",15),a.ɵɵelementStart(32,"label"),a.ɵɵelementStart(33,"span",16),a.ɵɵelement(34,"localize",20),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(35,"div",18),a.ɵɵelementStart(36,"span",21),a.ɵɵtext(37),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(38,"div",22),a.ɵɵelementStart(39,"div",15),a.ɵɵelementStart(40,"label"),a.ɵɵelementStart(41,"span",16),a.ɵɵelement(42,"localize",23),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(43,"div",18),a.ɵɵelementStart(44,"input",24),a.ɵɵlistener("ngModelChange",(function(e){return t.searchLabel=e}))("typeaheadOnSelect",(function(e){return t.typeaheadOnSelect(e,t.problem)})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(45,"div",14),a.ɵɵelementStart(46,"div",15),a.ɵɵelementStart(47,"label"),a.ɵɵelementStart(48,"span",16),a.ɵɵelement(49,"localize",25),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(50,"div",18),a.ɵɵelementStart(51,"button",26),a.ɵɵlistener("click",(function(){return t.onCreateSynonym()})),a.ɵɵelement(52,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementStart(53,"button",28),a.ɵɵlistener("click",(function(){return t.onIgnore()})),a.ɵɵelement(54,"localize",29),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.problem&&t.job),a.ɵɵadvance(9),a.ɵɵtextInterpolate(t.getValidationProblemDisplayLabel(t.problem)),a.ɵɵadvance(18),a.ɵɵproperty("ngIf",t.problem.context.length>0),a.ɵɵadvance(8),a.ɵɵtextInterpolate(t.problem.label),a.ɵɵadvance(7),a.ɵɵproperty("ngModel",t.searchLabel)("typeaheadAsync",!0)("typeahead",t.getTypeAheadObservable(t.problem.typeCode,t.problem))("typeaheadOptionsLimit",7)("typeaheadMinLength",0)("typeaheadWaitMs",300),a.ɵɵadvance(7),a.ɵɵproperty("disabled",null==t.problem.parent))},directives:[p.NgIf,m.LocalizeComponent,u.DefaultValueAccessor,u.NgControlStatus,u.NgModel,g.TypeaheadDirective,p.NgForOf],encapsulation:2}),e}();t.ParentReferenceProblemWidgetComponent=b,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(b,[{type:r.Component,args:[{selector:"parent-reference-problem-widget",templateUrl:"./parent-reference-problem-widget.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:l.IOService},{type:s.DateService},{type:c.LocalizationService},{type:d.BsModalRef},{type:d.BsModalService}]}),{problem:[{type:r.Input}],job:[{type:r.Input}],onProblemResolved:[{type:r.Output}]})},600:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TermReferenceProblemWidgetComponent=void 0;var r=n(0),i=(n(30),n(31)),o=(n(203),n(518),n(112),n(16),n(111)),a=n(0),l=n(518),s=n(112),c=n(16),d=n(30),p=n(1),m=n(68),u=n(22),g=n(154);function h(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",6),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",3),a.ɵɵelementStart(1,"div",7),a.ɵɵelementStart(2,"div",8),a.ɵɵelement(3,"i",9),a.ɵɵelementStart(4,"p",10),a.ɵɵelementStart(5,"span",11),a.ɵɵelementStart(6,"strong"),a.ɵɵtext(7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"span",11),a.ɵɵelement(9,"localize",12),a.ɵɵtext(10),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"span",11),a.ɵɵelement(12,"localize",13),a.ɵɵtext(13,": "),a.ɵɵelementStart(14,"span",14),a.ɵɵtext(15),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelement(16,"div",7),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(7),a.ɵɵtextInterpolate(n.job.fileName),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(": ",n.job.author," "),a.ɵɵadvance(5),a.ɵɵtextInterpolate1(" ",n.formatDate(n.job.createDate)," ")}}function y(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",15),a.ɵɵelementStart(1,"div",16),a.ɵɵelementStart(2,"h4"),a.ɵɵelementStart(3,"strong"),a.ɵɵelement(4,"localize",17),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"p",18),a.ɵɵtext(6),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"h4"),a.ɵɵelementStart(8,"strong"),a.ɵɵelement(9,"localize",19),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(10,"p",18),a.ɵɵelement(11,"localize",20),a.ɵɵelementEnd(),a.ɵɵelementStart(12,"h4"),a.ɵɵelementStart(13,"strong"),a.ɵɵelement(14,"localize",21),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(15,"p"),a.ɵɵelement(16,"localize",22),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(17,"div",23),a.ɵɵelementStart(18,"div",24),a.ɵɵelementStart(19,"div",25),a.ɵɵelementStart(20,"label"),a.ɵɵelementStart(21,"span",26),a.ɵɵelement(22,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(23,"div",28),a.ɵɵelementStart(24,"span",29),a.ɵɵtext(25),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(26,"div",24),a.ɵɵelementStart(27,"div",25),a.ɵɵelementStart(28,"label"),a.ɵɵelementStart(29,"span",26),a.ɵɵelement(30,"localize",30),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(31,"div",28),a.ɵɵelementStart(32,"span",29),a.ɵɵtext(33),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(34,"div",31),a.ɵɵelementStart(35,"div",25),a.ɵɵelementStart(36,"label"),a.ɵɵelementStart(37,"span",26),a.ɵɵelement(38,"localize",32),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(39,"div",28),a.ɵɵelementStart(40,"input",33),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().searchLabel=e}))("typeaheadOnSelect",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().typeaheadOnSelect(e)})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(41,"div",24),a.ɵɵelementStart(42,"div",25),a.ɵɵelementStart(43,"label"),a.ɵɵelementStart(44,"span",26),a.ɵɵelement(45,"localize",34),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(46,"div",28),a.ɵɵelementStart(47,"button",35),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onCreateSynonym()})),a.ɵɵelement(48,"localize",36),a.ɵɵelementEnd(),a.ɵɵelementStart(49,"button",37),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onIgnore()})),a.ɵɵelement(50,"localize",38),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(6),a.ɵɵtextInterpolate(r.getValidationProblemDisplayLabel(r.problem)),a.ɵɵadvance(19),a.ɵɵtextInterpolate(r.problem.attributeLabel),a.ɵɵadvance(8),a.ɵɵtextInterpolate(r.problem.label),a.ɵɵadvance(7),a.ɵɵproperty("ngModel",r.searchLabel)("typeaheadAsync",!0)("typeahead",r.getTypeAheadObservable(r.problem))("typeaheadOptionsLimit",7)("typeaheadMinLength",0)("typeaheadWaitMs",300),a.ɵɵadvance(7),a.ɵɵproperty("disabled",null==r.termId)}}var v=function(){function e(e,t,n,i,o,a){this.service=e,this.iService=t,this.dateService=n,this.lService=i,this.bsModalRef=o,this.modalService=a,this.message=null,this.onProblemResolved=new r.EventEmitter,this.termId=null,this.readonly=!1,this.edit=!1}return e.prototype.ngOnInit=function(){this.problem.parent=null,this.searchLabel=""},e.prototype.getValidationProblemDisplayLabel=function(e){return e.type},e.prototype.getTypeAheadObservable=function(e){var t=this;return i.Observable.create((function(n){t.iService.getTermSuggestions(e.mdAttributeId,t.searchLabel,"20").then((function(e){n.next(e)}))}))},e.prototype.typeaheadOnSelect=function(e){this.termId=e.item.value},e.prototype.onIgnore=function(){var e=this,t={resolution:"IGNORE",validationProblemId:this.problem.id};this.service.submitValidationResolve(t).then((function(t){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.onCreateSynonym=function(){var e=this,t={validationProblemId:this.problem.id,resolution:"SYNONYM",classifierId:this.termId,label:this.problem.label};this.service.submitValidationResolve(t).then((function(t){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.onCancel=function(){this.bsModalRef.hide()},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(l.IOService),a.ɵɵdirectiveInject(s.DateService),a.ɵɵdirectiveInject(c.LocalizationService),a.ɵɵdirectiveInject(d.BsModalRef),a.ɵɵdirectiveInject(d.BsModalService))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["term-reference-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:6,vars:3,consts:[[1,"container"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display",2,"margin-left","5px"],[1,"row"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","margin-right","7px"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],["key","etl.problem.termReference.message"],["key","etl.problem.header.toResolve"],["key","etl.problem.termReference.toResolve"],[1,"com-md-6",2,"background","white","border-radius","10px","width","41%","float","left","height","250px"],[1,"row-holder"],[1,"label-holder",2,"width","100px"],[1,"text"],["key","etl.problem.termReference.attributeLabel"],[1,"holder",2,"width","300px"],[1,"text",2,"margin-top","10px"],["key","etl.problem.termReference.label"],[1,"row-holder",2,"overflow","visible"],["key","etl.problem.termReference.synonym"],["type","text","autocomplete","off","name","termSearch","typeaheadOptionField","label",1,"form-control",2,"width","150px",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadWaitMs","ngModelChange","typeaheadOnSelect"],["key","etl.problem.termReference.actions"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","etl.problem.reference.createSynonym"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","etl.problem.reference.ignore"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,h,2,1,"div",1),a.ɵɵtemplate(2,f,17,3,"div",2),a.ɵɵelementStart(3,"div",3),a.ɵɵelementStart(4,"div",4),a.ɵɵtemplate(5,y,51,10,"div",5),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.problem&&t.job),a.ɵɵadvance(3),a.ɵɵproperty("ngIf",t.problem))},directives:[p.NgIf,m.LocalizeComponent,u.DefaultValueAccessor,u.NgControlStatus,u.NgModel,g.TypeaheadDirective],encapsulation:2}),e}();t.TermReferenceProblemWidgetComponent=v,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(v,[{type:r.Component,args:[{selector:"term-reference-problem-widget",templateUrl:"./term-reference-problem-widget.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:l.IOService},{type:s.DateService},{type:c.LocalizationService},{type:d.BsModalRef},{type:d.BsModalService}]}),{problem:[{type:r.Input}],job:[{type:r.Input}],onProblemResolved:[{type:r.Output}]})},601:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowValidationProblemWidgetComponent=void 0;var r=n(0),i=(n(30),n(31)),o=(n(203),n(518),n(112),n(111)),a=(n(16),n(0)),l=n(518),s=n(112),c=n(16),d=n(30),p=n(1),m=n(68);function u(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",20),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function g(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",3),a.ɵɵelementStart(1,"div",21),a.ɵɵelementStart(2,"div",22),a.ɵɵelement(3,"i",23),a.ɵɵelementStart(4,"p",24),a.ɵɵelementStart(5,"span",25),a.ɵɵelementStart(6,"strong"),a.ɵɵtext(7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"span",25),a.ɵɵelement(9,"localize",26),a.ɵɵtext(10),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"span",25),a.ɵɵelement(12,"localize",27),a.ɵɵtext(13,": "),a.ɵɵelementStart(14,"span",28),a.ɵɵtext(15),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelement(16,"div",21),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(7),a.ɵɵtextInterpolate(n.job.fileName),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(": ",n.job.author," "),a.ɵɵadvance(5),a.ɵɵtextInterpolate1(" ",n.formatDate(n.job.createDate)," ")}}var h=function(){function e(e,t,n,i,o){this.service=e,this.iService=t,this.dateService=n,this.lService=i,this.bsModalRef=o,this.message=null,this.onProblemResolved=new r.EventEmitter,this.readonly=!1,this.edit=!1}return e.prototype.ngOnInit=function(){this.problem.parent=null,this.searchLabel=""},e.prototype.getString=function(e){return JSON.stringify(e)},e.prototype.getValidationProblemDisplayLabel=function(e){return e.type},e.prototype.getTypeAheadObservable=function(e,t){var n=this,r=this.job.configuration.hierarchy;return i.Observable.create((function(t){n.service.getGeoObjectSuggestions(n.searchLabel,e,null,null,r,n.job.startDate).then((function(e){t.next(e)}))}))},e.prototype.typeaheadOnSelect=function(e,t){var n=this;this.service.getParentGeoObjects(e.item.uid,t.typeCode,[],!1,this.job.startDate).then((function(e){t.parent=e.geoObject,n.searchLabel=e.geoObject.properties.displayLabel.localizedValue})).catch((function(e){n.error(e)}))},e.prototype.onIgnore=function(){var e=this,t={resolution:"IGNORE",validationProblemId:this.problem.id};this.service.submitValidationResolve(t).then((function(t){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.formatAffectedRows=function(e){return e.replace(/,/g,", ")},e.prototype.onCreateSynonym=function(){var e=this,t={validationProblemId:this.problem.id,resolution:"SYNONYM",code:this.problem.parent.properties.code,typeCode:this.problem.parent.properties.type,label:this.problem.label};this.service.submitValidationResolve(t).then((function(t){e.onProblemResolved.emit(e.problem),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.onCancel=function(){this.bsModalRef.hide()},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(l.IOService),a.ɵɵdirectiveInject(s.DateService),a.ɵɵdirectiveInject(c.LocalizationService),a.ɵɵdirectiveInject(d.BsModalRef))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["row-validation-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:39,vars:5,consts:[[1,"container"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],[1,"row"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","margin-right","7px"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],["key","etl.problem.rowValidation.message"],["key","etl.problem.header.toResolve"],["key","etl.problem.rowValidation.toResolve"],[1,"com-md-6",2,"background","white","border-radius","10px","width","41%","float","left","height","250px"],[1,"row-holder"],[1,"label-holder",2,"width","100px"],[1,"text"],["key","scheduledjobs.validation.table.affected.rows.header"],[1,"holder",2,"width","300px"],[1,"text",2,"margin-top","10px"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display",2,"margin-left","5px"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,u,2,1,"div",1),a.ɵɵtemplate(2,g,17,3,"div",2),a.ɵɵelementStart(3,"div",3),a.ɵɵelementStart(4,"div",4),a.ɵɵelementStart(5,"div",5),a.ɵɵelementStart(6,"div",6),a.ɵɵelementStart(7,"h4"),a.ɵɵelementStart(8,"strong"),a.ɵɵelement(9,"localize",7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(10,"p",8),a.ɵɵtext(11),a.ɵɵelementEnd(),a.ɵɵelementStart(12,"h4"),a.ɵɵelementStart(13,"strong"),a.ɵɵelement(14,"localize",9),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(15,"p",8),a.ɵɵelement(16,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementStart(17,"h4"),a.ɵɵelementStart(18,"strong"),a.ɵɵelement(19,"localize",11),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(20,"p"),a.ɵɵelement(21,"localize",12),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(22,"div",13),a.ɵɵelementStart(23,"div",14),a.ɵɵelementStart(24,"div",15),a.ɵɵelementStart(25,"label"),a.ɵɵelementStart(26,"span",16),a.ɵɵelement(27,"localize",17),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(28,"div",18),a.ɵɵelementStart(29,"span",19),a.ɵɵtext(30),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(31,"div",14),a.ɵɵelementStart(32,"div",15),a.ɵɵelementStart(33,"label"),a.ɵɵelementStart(34,"span",16),a.ɵɵelement(35,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(36,"div",18),a.ɵɵelementStart(37,"span",19),a.ɵɵtext(38),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",t.problem&&t.job),a.ɵɵadvance(9),a.ɵɵtextInterpolate(t.getValidationProblemDisplayLabel(t.problem)),a.ɵɵadvance(19),a.ɵɵtextInterpolate(t.formatAffectedRows(t.problem.affectedRows)),a.ɵɵadvance(8),a.ɵɵtextInterpolate(t.problem.exception.message))},directives:[p.NgIf,m.LocalizeComponent],encapsulation:2}),e}();t.RowValidationProblemWidgetComponent=h,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(h,[{type:r.Component,args:[{selector:"row-validation-problem-widget",templateUrl:"./row-validation-problem-widget.component.html",styleUrls:[]}]}],(function(){return[{type:l.RegistryService},{type:l.IOService},{type:s.DateService},{type:c.LocalizationService},{type:d.BsModalRef}]}),{problem:[{type:r.Input}],job:[{type:r.Input}],onProblemResolved:[{type:r.Output}]})},602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReuploadModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(205),a=n(260),l=(n(16),n(111)),s=(n(203),n(0)),c=n(30),d=n(16),p=n(1),m=n(22),u=n(68),g=n(205),h=["myFile"];function f(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",4),s.ɵɵtext(1),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵtextInterpolate(n.errorMessage)}}function y(e,t){1&e&&s.ɵɵelement(0,"localize",18)}function v(e,t){1&e&&s.ɵɵelement(0,"localize",19)}function b(e,t){if(1&e&&s.ɵɵelement(0,"input",20,21),2&e){var n=s.ɵɵnextContext(2);s.ɵɵproperty("uploader",n.uploader)}}function S(e,t){if(1&e&&s.ɵɵelement(0,"input",22,21),2&e){var n=s.ɵɵnextContext(2);s.ɵɵproperty("uploader",n.uploader)}}function C(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"form",5,6),s.ɵɵelementStart(2,"div",7),s.ɵɵelementStart(3,"label",8),s.ɵɵtemplate(4,y,1,0,"localize",9),s.ɵɵtemplate(5,v,1,0,"localize",10),s.ɵɵelementEnd(),s.ɵɵelementStart(6,"div",11),s.ɵɵtemplate(7,b,2,1,"input",12),s.ɵɵtemplate(8,S,2,1,"input",13),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(9,"div",14),s.ɵɵelementStart(10,"div",15),s.ɵɵelementStart(11,"button",16),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext().bsModalRef.hide()})),s.ɵɵelementStart(12,"span"),s.ɵɵtext(13),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(14,"button",17),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext().confirm()})),s.ɵɵelementStart(15,"span"),s.ɵɵtext(16),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵadvance(4),s.ɵɵproperty("ngIf","SHAPEFILE"===r.job.configuration.formatType),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","EXCEL"===r.job.configuration.formatType),s.ɵɵadvance(2),s.ɵɵproperty("ngIf","SHAPEFILE"===r.job.configuration.formatType),s.ɵɵadvance(1),s.ɵɵproperty("ngIf","EXCEL"===r.job.configuration.formatType),s.ɵɵadvance(5),s.ɵɵtextInterpolate(r.cancelText),s.ɵɵadvance(1),s.ɵɵproperty("ngClass","DANGER"===r.type.toUpperCase()?"btn-danger":"btn-primary"),s.ɵɵadvance(2),s.ɵɵtextInterpolate(r.submitText)}}var E=function(){function e(e,t,n){this.bsModalRef=e,this.localizeService=t,this.eventService=n,this.title=this.localizeService.decode("reuploadmodal.title"),this.message=this.localizeService.decode("reuploadmodal.message"),this.submitText=this.localizeService.decode("reuploadmodal.import"),this.cancelText=this.localizeService.decode("modal.button.cancel"),this.type=a.ModalTypes.warning}return e.prototype.ngOnInit=function(){var e=this;this.onConfirm=new i.Subject;var t={queueLimit:1,removeAfterUpload:!0,url:acp+"/etl/reimport"};this.uploader=new o.FileUploader(t),this.uploader.onBuildItemForm=function(t,n){n.append("json",JSON.stringify(e.job.configuration))},this.uploader.onBeforeUploadItem=function(t){e.eventService.start()},this.uploader.onCompleteItem=function(t,n,r,i){e.fileRef.nativeElement.value="",e.eventService.complete()},this.uploader.onSuccessItem=function(t,n,r,i){e.onConfirm.next(e.data),e.bsModalRef.hide()},this.uploader.onErrorItem=function(t,n,r,i){e.error(JSON.parse(n))}},e.prototype.toString=function(e){return JSON.stringify(e)},e.prototype.confirm=function(){null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizeService.decode("io.missing.file"),error:{}})},e.prototype.error=function(e){this.errorMessage=l.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(d.LocalizationService),s.ɵɵdirectiveInject(d.EventService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["reupload-modal"]],viewQuery:function(e,t){if(1&e&&s.ɵɵviewQuery(h,1),2&e){var n;s.ɵɵqueryRefresh(n=s.ɵɵloadQuery())&&(t.fileRef=n.first)}},inputs:{title:"title",message:"message",data:"data",submitText:"submitText",cancelText:"cancelText",type:"type",job:"job"},decls:8,vars:4,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["style","margin-top: 30px;",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[2,"margin-top","30px"],["form","ngForm"],[1,"form-group","row"],["for","file",1,"col-md-3","text-right"],["key","io.shapefile",4,"ngIf"],["key","io.spreadsheet",4,"ngIf"],[1,"col-md-9"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".zip","required","",3,"uploader",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".xlsx,.zip","required","",3,"uploader",4,"ngIf"],[1,"modal-footer"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],["type","button","role","button","aria-disabled","false",1,"btn",2,"padding","4px 18px",3,"ngClass","click"],["key","io.shapefile"],["key","io.spreadsheet"],["name","file","type","file","ng2FileSelect","","accept",".zip","required","",1,"ghost-input",3,"uploader"],["myFile",""],["name","file","type","file","ng2FileSelect","","accept",".xlsx,.zip","required","",1,"ghost-input",3,"uploader"]],template:function(e,t){1&e&&(s.ɵɵelementStart(0,"div",0),s.ɵɵtemplate(1,f,2,1,"div",1),s.ɵɵelementStart(2,"div",2),s.ɵɵelementStart(3,"h3"),s.ɵɵtext(4),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(5,"div"),s.ɵɵtext(6),s.ɵɵelementEnd(),s.ɵɵtemplate(7,C,17,7,"form",3),s.ɵɵelementEnd()),2&e&&(s.ɵɵadvance(1),s.ɵɵproperty("ngIf",t.errorMessage),s.ɵɵadvance(3),s.ɵɵtextInterpolate(t.title),s.ɵɵadvance(2),s.ɵɵtextInterpolate(t.message),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",t.job))},directives:[p.NgIf,m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,p.NgClass,u.LocalizeComponent,g.FileSelectDirective],encapsulation:2}),e}();t.ReuploadModalComponent=E,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(E,[{type:r.Component,args:[{selector:"reupload-modal",templateUrl:"./reupload-modal.component.html",styleUrls:[]}]}],(function(){return[{type:c.BsModalRef},{type:d.LocalizationService},{type:d.EventService}]}),{title:[{type:r.Input}],message:[{type:r.Input}],data:[{type:r.Input}],submitText:[{type:r.Input}],cancelText:[{type:r.Input}],type:[{type:r.Input}],job:[{type:r.Input}],fileRef:[{type:r.ViewChild,args:["myFile"]}]})},603:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaskViewerComponent=void 0;var r=n(0),i=n(1),o=(n(518),n(112),n(203),n(16),n(0)),a=n(518),l=n(16),s=n(112),c=n(122),d=n(97),p=n(68),m=n(1),u=n(204);function g(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",14),o.ɵɵelementStart(1,"div",15),o.ɵɵelementStart(2,"h4"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div",16),o.ɵɵelementStart(5,"div",4),o.ɵɵelementStart(6,"div",5),o.ɵɵelementStart(7,"label"),o.ɵɵelement(8,"localize",17),o.ɵɵelementEnd(),o.ɵɵelementStart(9,"p",18),o.ɵɵtext(10),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"label",19),o.ɵɵelement(12,"localize",20),o.ɵɵelementEnd(),o.ɵɵelementStart(13,"span",21),o.ɵɵtext(14),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(15,"div",22),o.ɵɵelementStart(16,"label",23),o.ɵɵelement(17,"input",24),o.ɵɵelementStart(18,"span"),o.ɵɵelement(19,"localize",25),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(20,"label",23),o.ɵɵelementStart(21,"input",26),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=t.$implicit;return o.ɵɵnextContext(2).onCompleteTask(e)})),o.ɵɵelementEnd(),o.ɵɵelementStart(22,"span"),o.ɵɵelement(23,"localize",27),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=o.ɵɵnextContext(2);o.ɵɵadvance(3),o.ɵɵtextInterpolate(i.upper(r.title)),o.ɵɵadvance(7),o.ɵɵtextInterpolate(r.msg),o.ɵɵadvance(4),o.ɵɵtextInterpolate1(" ",i.formatDate(r.createDate)," "),o.ɵɵadvance(3),o.ɵɵpropertyInterpolate1("id","",r.id,"-inProgress"),o.ɵɵpropertyInterpolate1("name","",r.id,"-inProgress"),o.ɵɵadvance(4),o.ɵɵpropertyInterpolate1("id","",r.id,"-completed"),o.ɵɵpropertyInterpolate1("name","",r.id,"-completed")}}function h(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",28),o.ɵɵelementStart(1,"pagination-controls",29),o.ɵɵlistener("pageChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onInProgressTasksPageChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}}var f=function(e,t,n){return{id:"inProgressTasks",itemsPerPage:e,currentPage:t,totalItems:n}};function y(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",4),o.ɵɵelementStart(1,"div",9),o.ɵɵelementStart(2,"div",11),o.ɵɵtemplate(3,g,24,7,"div",12),o.ɵɵpipe(4,"paginate"),o.ɵɵtemplate(5,h,2,0,"div",13),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(3),o.ɵɵproperty("ngForOf",o.ɵɵpipeBind2(4,2,n.inProgressTasks.results,o.ɵɵpureFunction3(5,f,n.inProgressTasks.pageSize,n.inProgressTasks.pageNumber,n.inProgressTasks.count))),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",n.inProgressTasks.results.length>0)}}function v(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",14),o.ɵɵelementStart(1,"div",15),o.ɵɵelementStart(2,"h4"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div",16),o.ɵɵelementStart(5,"div",4),o.ɵɵelementStart(6,"div",5),o.ɵɵelementStart(7,"label"),o.ɵɵelement(8,"localize",17),o.ɵɵelementEnd(),o.ɵɵelementStart(9,"p",18),o.ɵɵtext(10),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"label",19),o.ɵɵelement(12,"localize",20),o.ɵɵelementEnd(),o.ɵɵelementStart(13,"span",30),o.ɵɵtext(14),o.ɵɵelementEnd(),o.ɵɵelementStart(15,"label",19),o.ɵɵelement(16,"localize",31),o.ɵɵelementEnd(),o.ɵɵelementStart(17,"span",21),o.ɵɵtext(18),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(19,"div",22),o.ɵɵelementStart(20,"label",23),o.ɵɵelementStart(21,"input",32),o.ɵɵlistener("click",(function(){o.ɵɵrestoreView(n);var e=t.$implicit;return o.ɵɵnextContext(2).onMoveTaskToInProgress(e)})),o.ɵɵelementEnd(),o.ɵɵelementStart(22,"span"),o.ɵɵelement(23,"localize",25),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(24,"label",23),o.ɵɵelement(25,"input",33),o.ɵɵelementStart(26,"span"),o.ɵɵelement(27,"localize",27),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=o.ɵɵnextContext(2);o.ɵɵadvance(3),o.ɵɵtextInterpolate(i.upper(r.title)),o.ɵɵadvance(7),o.ɵɵtextInterpolate(r.msg),o.ɵɵadvance(4),o.ɵɵtextInterpolate1(" ",i.formatDate(r.createDate)," "),o.ɵɵadvance(4),o.ɵɵtextInterpolate1(" ",i.formatDate(r.completedDate)," "),o.ɵɵadvance(3),o.ɵɵpropertyInterpolate1("id","",r.id,"-inProgress"),o.ɵɵpropertyInterpolate1("name","",r.id,"-inProgress"),o.ɵɵadvance(4),o.ɵɵpropertyInterpolate1("id","",r.id,"-completed"),o.ɵɵpropertyInterpolate1("name","",r.id,"-completed")}}function b(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",28),o.ɵɵelementStart(1,"pagination-controls",34),o.ɵɵlistener("pageChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).onCompletedTasksPageChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}}var S=function(e,t,n){return{id:"completedTasks",itemsPerPage:e,currentPage:t,totalItems:n}};function C(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",11),o.ɵɵtemplate(1,v,28,8,"div",12),o.ɵɵpipe(2,"paginate"),o.ɵɵtemplate(3,b,2,0,"div",13),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",o.ɵɵpipeBind2(2,2,n.completedTasks.results,o.ɵɵpureFunction3(5,S,n.completedTasks.pageSize,n.completedTasks.pageNumber,n.completedTasks.count))),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",n.completedTasks.results.length>0)}}function E(e,t){1&e&&(o.ɵɵelementStart(0,"div",11),o.ɵɵelementStart(1,"p",35),o.ɵɵelement(2,"localize",36),o.ɵɵelementEnd(),o.ɵɵelementEnd())}var x=function(){function e(e,t,n){this.taskService=e,this.localizeService=t,this.dateService=n,this.inProgressTasks={count:0,pageNumber:1,pageSize:10,results:[]},this.completedTasks={count:0,pageNumber:1,pageSize:10,results:[]},this.isViewAllOpen=!1,this.activeTimeCounter=0,this.completeTimeCounter=0}return e.prototype.ngOnInit=function(){this.onInProgressTasksPageChange(1)},e.prototype.upper=function(e){return null!=e?e.toUpperCase():""},e.prototype.onInProgressTasksPageChange=function(e){var t=this;this.taskService.getMyTasks(e,this.inProgressTasks.pageSize,"UNRESOLVED").then((function(e){t.inProgressTasks=e}))},e.prototype.onCompletedTasksPageChange=function(e){var t=this;this.taskService.getMyTasks(e,this.completedTasks.pageSize,"RESOLVED").then((function(e){t.completedTasks=e}))},e.prototype.onCompleteTask=function(e){var t=this;this.taskService.completeTask(e.id).then((function(){var n=t.inProgressTasks.results.findIndex((function(t){return t.id===e.id}));-1!==n&&t.inProgressTasks.results.splice(n,1),t.completedTasks.results.push(e)}))},e.prototype.onMoveTaskToInProgress=function(e){var t=this;this.isViewAllOpen=!0,this.taskService.setTaskStatus(e.id,"UNRESOLVED").then((function(){var n=t.completedTasks.results.findIndex((function(t){return t.id===e.id}));-1!==n&&t.completedTasks.results.splice(n,1),t.completedTasks.results.splice(n,1),t.inProgressTasks.results.push(e)}))},e.prototype.onViewAllCompletedTasks=function(){this.isViewAllOpen=!0,this.onCompletedTasksPageChange(1)},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.TaskService),o.ɵɵdirectiveInject(l.LocalizationService),o.ɵɵdirectiveInject(s.DateService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["task-viewer"]],inputs:{geoObjectType:"geoObjectType"},features:[o.ɵɵProvidersFeature([i.DatePipe])],decls:18,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container"],["key","tasks.openTasksTitle"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-9"],["key","tasks.completedTasksTitle"],["type","submit","role","button",1,"btn","btn-default","pull-right",2,"margin-top","20px",3,"click"],["key","tasks.viewCompletedTasksButton"],[1,"col-md-12"],["class","content-wrapper",4,"ngIf"],[1,"content-wrapper"],["class","panel panel-default",4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],["key","tasks.taskMessage"],[2,"margin-bottom","20px"],[2,"margin-right","20px"],["key","tasks.createDateLabel"],[1,"date-string-display"],[1,"col-md-3",2,"min-height","90px","display","flex","align-items","center"],[1,"radio-inline","radio"],["type","radio","checked","","value","true",1,"inline-radio-input",2,"height","auto",3,"id","name"],["key","tasks.open"],["type","radio","value","false",1,"inline-radio-input",2,"margin-left","15px","height","auto",3,"id","name","click"],["key","tasks.complete"],[1,"solid-table-footer"],["id","inProgressTasks",3,"pageChange"],[1,"date-string-display",2,"margin-right","30px"],["key","tasks.completeDateLabel"],["type","radio","value","true",1,"inline-radio-input",2,"height","auto",3,"id","name","click"],["checked","","type","radio","value","false",1,"inline-radio-input",2,"margin-left","15px","height","auto",3,"id","name"],["id","completedTasks",3,"pageChange"],[2,"font-style","italic","color","grey"],["key","tasks.no.completed.tasks.message"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelement(1,"cgr-header"),o.ɵɵelementStart(2,"div",1),o.ɵɵelement(3,"message"),o.ɵɵelementStart(4,"h2"),o.ɵɵelement(5,"localize",2),o.ɵɵelementEnd(),o.ɵɵelement(6,"hr"),o.ɵɵtemplate(7,y,6,9,"div",3),o.ɵɵelementStart(8,"div",4),o.ɵɵelementStart(9,"h2",5),o.ɵɵelement(10,"localize",6),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"button",7),o.ɵɵlistener("click",(function(){return t.onViewAllCompletedTasks()})),o.ɵɵelement(12,"localize",8),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelement(13,"hr"),o.ɵɵelementStart(14,"div",4),o.ɵɵelementStart(15,"div",9),o.ɵɵtemplate(16,C,4,9,"div",10),o.ɵɵtemplate(17,E,3,0,"div",10),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(7),o.ɵɵproperty("ngIf",t.inProgressTasks.results.length>0),o.ɵɵadvance(9),o.ɵɵproperty("ngIf",t.isViewAllOpen&&t.completedTasks.results.length>0),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",0===t.completedTasks.results.length&&t.isViewAllOpen))},directives:[c.CgrHeaderComponent,d.MessageComponent,p.LocalizeComponent,m.NgIf,m.NgForOf,u.PaginationControlsComponent],pipes:[u.PaginatePipe],styles:['.modal-content[_ngcontent-%COMP%] {\n    overflow-y: visible !important;\n}\n\n.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type="text"][_ngcontent-%COMP%]:disabled {\n    background: #eee;\n}\n\nli.list-group-item[_ngcontent-%COMP%] {\n    font-size: 18px;\n}\n\n.warning-text[_ngcontent-%COMP%]{\n    color: orange;\n}']}),e}();t.TaskViewerComponent=x,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(x,[{type:r.Component,args:[{selector:"task-viewer",templateUrl:"./task-viewer.component.html",styleUrls:["./task-viewer.component.css"],providers:[i.DatePipe]}]}],(function(){return[{type:a.TaskService},{type:l.LocalizationService},{type:s.DateService}]}),{geoObjectType:[{type:r.Input}]})},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SynchronizationConfigManagerComponent=void 0;var r=n(0),i=(n(33),n(30),n(16),n(260)),o=n(111),a=(n(518),n(605)),l=n(0),s=n(518),c=n(16),d=n(33),p=n(30),m=n(122),u=n(86),g=n(68),h=n(1),f=n(204);function y(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"tr",15),l.ɵɵelementStart(1,"td",16),l.ɵɵelementStart(2,"a",17),l.ɵɵtext(3),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(4,"td",18),l.ɵɵelementStart(5,"button",13),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=t.$implicit;return l.ɵɵnextContext().onView(e)})),l.ɵɵelement(6,"localize",19),l.ɵɵelementEnd(),l.ɵɵelementStart(7,"button",20),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=t.$implicit;return l.ɵɵnextContext().onEdit(e)})),l.ɵɵelement(8,"localize",21),l.ɵɵelementEnd(),l.ɵɵelementStart(9,"button",22),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=t.$implicit;return l.ɵɵnextContext().onRemove(e)})),l.ɵɵelement(10,"localize",23),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=t.$implicit;l.ɵɵadvance(2),l.ɵɵproperty("routerLink","/registry/synchronization-config/"+r.oid),l.ɵɵadvance(1),l.ɵɵtextInterpolate1(" ",r.label.localizedValue," ")}}var v=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}},b=function(){function e(e,t,n,r){this.service=e,this.lService=t,this.router=n,this.modalService=r,this.message=null,this.page={resultSet:[],count:0,pageNumber:1,pageSize:20}}return e.prototype.ngOnInit=function(){this.onPageChange(1)},e.prototype.onPageChange=function(e){var t=this;this.service.getPage(e,this.page.pageSize).then((function(e){t.page=e})).catch((function(e){t.error(e)}))},e.prototype.create=function(){var e=this;this.service.edit(null).then((function(t){var n=e.modalService.show(a.SynchronizationConfigModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});n.content.init(null,t.orgs),n.content.onSuccess.subscribe((function(){e.onPageChange(e.page.pageNumber)}))}))},e.prototype.onEdit=function(e){var t=this;this.service.edit(e.oid).then((function(e){var n=t.modalService.show(a.SynchronizationConfigModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});n.content.init(e.config,e.orgs),n.content.onSuccess.subscribe((function(){t.onPageChange(t.page.pageNumber)}))}))},e.prototype.onRemove=function(e){var t=this;this.bsModalRef=this.modalService.show(o.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.lService.decode("confirm.modal.verify.delete")+" ["+e.label.localizedValue+"]",this.bsModalRef.content.submitText=this.lService.decode("modal.button.delete"),this.bsModalRef.content.type=i.ModalTypes.danger,this.bsModalRef.content.onConfirm.subscribe((function(){t.service.remove(e.oid).then((function(){t.onPageChange(t.page.pageNumber)})).catch((function(e){t.error(e)}))}))},e.prototype.onView=function(e){this.router.navigate(["/registry/synchronization-config/",e.oid])},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(l.ɵɵdirectiveInject(s.SynchronizationConfigService),l.ɵɵdirectiveInject(c.LocalizationService),l.ɵɵdirectiveInject(d.Router),l.ɵɵdirectiveInject(p.BsModalService))},e.ɵcmp=l.ɵɵdefineComponent({type:e,selectors:[["synchronization-config-manager"]],decls:22,vars:8,consts:[[1,"new-admin-design-main"],[1,"container-fluid"],[1,"heading"],["key","synchronization.config.manager"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"table"],[2,"width","70%"],["key","synchronization.config.label"],["class","clickable",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"row",2,"margin-top","30px","margin-bottom","30px"],[1,"col-md-6"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","hierarchy.management.button.create"],[1,"clickable"],[2,"width","70%","vertical-align","middle"],["routerLinkActive","active",3,"routerLink"],[2,"width","30%","text-align","right"],["key","modal.button.view"],["type","submit","role","button",1,"btn","btn-default",2,"margin-left","5px",3,"click"],["key","modal.button.edit"],["type","submit","role","button",1,"btn","btn-danger",2,"margin-left","5px",3,"click"],["key","modal.button.delete"]],template:function(e,t){1&e&&(l.ɵɵelementStart(0,"div",0),l.ɵɵelement(1,"cgr-header"),l.ɵɵelement(2,"loading-bar"),l.ɵɵelementStart(3,"div",1),l.ɵɵelementStart(4,"div",2),l.ɵɵelementStart(5,"h2"),l.ɵɵelement(6,"localize",3),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(7,"div",4),l.ɵɵelementStart(8,"div",5),l.ɵɵelementStart(9,"table",6),l.ɵɵelementStart(10,"thead"),l.ɵɵelementStart(11,"tr"),l.ɵɵelementStart(12,"th",7),l.ɵɵelement(13,"localize",8),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(14,"tbody"),l.ɵɵtemplate(15,y,11,2,"tr",9),l.ɵɵpipe(16,"paginate"),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(17,"pagination-controls",10),l.ɵɵlistener("pageChange",(function(e){return t.onPageChange(e)})),l.ɵɵelementEnd(),l.ɵɵelementStart(18,"div",11),l.ɵɵelementStart(19,"div",12),l.ɵɵelementStart(20,"button",13),l.ɵɵlistener("click",(function(){return t.create()})),l.ɵɵelement(21,"localize",14),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e&&(l.ɵɵadvance(15),l.ɵɵproperty("ngForOf",l.ɵɵpipeBind2(16,1,t.page.resultSet,l.ɵɵpureFunction3(4,v,t.page.pageSize,t.page.pageNumber,t.page.count))))},directives:[m.CgrHeaderComponent,u.LoadingBarComponent,g.LocalizeComponent,h.NgForOf,f.PaginationControlsComponent,d.RouterLinkWithHref,d.RouterLinkActive],pipes:[f.PaginatePipe],encapsulation:2}),e}();t.SynchronizationConfigManagerComponent=b,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(b,[{type:r.Component,args:[{selector:"synchronization-config-manager",templateUrl:"./synchronization-config-manager.component.html",styleUrls:[]}]}],(function(){return[{type:s.SynchronizationConfigService},{type:c.LocalizationService},{type:d.Router},{type:p.BsModalService}]}),null)},605:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SynchronizationConfigModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=(n(16),n(111)),a=(n(518),n(0)),l=n(518),s=n(16),c=n(30),d=n(1),p=n(68),m=n(22),u=n(259),g=n(113),h=["form"];function f(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",18),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function y(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"label"),a.ɵɵelement(3,"localize",19),a.ɵɵtext(4," ("),a.ɵɵelement(5,"convert-key-label",20),a.ɵɵtext(6,") "),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"div",10),a.ɵɵelementStart(8,"input",21),a.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.value=e})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵadvance(5),a.ɵɵproperty("key",n.locale),a.ɵɵadvance(3),a.ɵɵproperty("ngModel",n.value)("name","label-"+n.locale)("required","defaultLocale"===n.locale)}}function v(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label)}}function b(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label)}}function S(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"label"),a.ɵɵelement(3,"localize",23),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"div",10),a.ɵɵelementStart(5,"span",11),a.ɵɵelementStart(6,"select",24),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().config.hierarchy=e}))("change",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onChangeHierarchy()})),a.ɵɵelement(7,"option"),a.ɵɵtemplate(8,b,2,2,"option",13),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(6),a.ɵɵproperty("ngModel",r.config.hierarchy)("disabled",null!=r.config.oid),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",r.cOrg.hierarchies)}}function C(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.oid),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label)}}function E(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"label"),a.ɵɵelement(3,"localize",25),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"div",10),a.ɵɵelementStart(5,"span",11),a.ɵɵelementStart(6,"select",26),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().config.system=e}))("change",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onChangeExternalSystem()})),a.ɵɵelement(7,"option"),a.ɵɵtemplate(8,C,2,2,"option",13),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(6),a.ɵɵproperty("ngModel",r.config.system)("disabled",null!=r.config.oid),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",r.cOrg.systems)}}function x(e,t){if(1&e&&(a.ɵɵelementStart(0,"td",30),a.ɵɵelementStart(1,"label",46),a.ɵɵelement(2,"localize",47),a.ɵɵtext(3),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(3),a.ɵɵtextInterpolate1(" ",n.levelNum+1,"")}}function O(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.label.localizedValue)}}function I(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"td",32),a.ɵɵelementStart(1,"select",48),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().$implicit.level.geoObjectType=e}))("change",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(),t=e.$implicit,r=e.index;return a.ɵɵnextContext(2).onSelectGeoObjectType(t.level.geoObjectType,r)})),a.ɵɵelement(2,"option"),a.ɵɵtemplate(3,O,2,2,"option",13),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit,i=a.ɵɵnextContext(2);a.ɵɵadvance(1),a.ɵɵproperty("ngModel",r.level.geoObjectType)("name","geoObjectType"+r.levelNum),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",i.types)}}function w(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"td",32),a.ɵɵelementStart(1,"select",49),a.ɵɵlistener("change",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext().$implicit;return a.ɵɵnextContext(2).onSelectLevelType(e)}))("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().$implicit.level.type=e})),a.ɵɵelement(2,"option"),a.ɵɵelementStart(3,"option",50),a.ɵɵelement(4,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"option",51),a.ɵɵelement(6,"localize",52),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"option",53),a.ɵɵelement(8,"localize",54),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵproperty("ngModel",r.level.type)("name","type"+r.levelNum)}}function M(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.id),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.name)}}function T(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"td",35),a.ɵɵelementStart(1,"select",55),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().$implicit.level.orgUnitGroupId=e})),a.ɵɵelement(2,"option"),a.ɵɵtemplate(3,M,2,2,"option",13),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit,i=a.ɵɵnextContext(2);a.ɵɵadvance(1),a.ɵɵproperty("ngModel",r.level.orgUnitGroupId)("name","group"+r.levelNum),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",i.orgUnitGroups)}}function j(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"a",56),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(2).$implicit;return a.ɵɵnextContext(2).configureAttributes(e)})),a.ɵɵpipe(1,"localize"),a.ɵɵelement(2,"i",61),a.ɵɵelementStart(3,"label",62),a.ɵɵelement(4,"localize",63),a.ɵɵelementEnd(),a.ɵɵelementEnd()}2&e&&a.ɵɵproperty("title",a.ɵɵpipeBind1(1,1,"sync.attr.configureAttributes.helptext"))}function k(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"td",32),a.ɵɵelementStart(1,"div"),a.ɵɵelementStart(2,"a",56),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(),t=e.$implicit,r=e.index;return a.ɵɵnextContext(2).removeLevel(t.levelNum,r)})),a.ɵɵpipe(3,"localize"),a.ɵɵelement(4,"i",57),a.ɵɵelementStart(5,"label",58),a.ɵɵelement(6,"localize",59),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"div"),a.ɵɵtemplate(8,j,5,3,"a",60),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit;a.ɵɵadvance(2),a.ɵɵproperty("title",a.ɵɵpipeBind1(3,2,"button.delete.helptext")),a.ɵɵadvance(6),a.ɵɵproperty("ngIf",r.level.geoObjectType&&("ORG_UNITS"===r.level.type||"ALL"===r.level.type))}}function R(e,t){1&e&&(a.ɵɵelementStart(0,"label"),a.ɵɵelement(1,"localize",85),a.ɵɵelementEnd())}function z(e,t){1&e&&a.ɵɵelement(0,"localize",87)}function P(e,t){if(1&e&&(a.ɵɵelementStart(0,"label"),a.ɵɵtemplate(1,z,1,0,"localize",86),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!n.isOrgUnitGroup)}}function D(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",79),a.ɵɵelementStart(1,"label",88),a.ɵɵtext(2),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("ngValue",n.cgrAttr.name),a.ɵɵadvance(2),a.ɵɵtextInterpolate(n.cgrAttr.label)}}function A(e,t){if(1&e&&(a.ɵɵelementStart(0,"label",88),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.info.cgrAttr.typeLabel)}}function V(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"select",78),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).$implicit.isOrgUnitGroup=e}))("change",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(2).$implicit;return a.ɵɵnextContext(4).onChangeTargetType(e)})),a.ɵɵelementStart(1,"option",79),a.ɵɵelement(2,"localize",91),a.ɵɵelementEnd(),a.ɵɵelementStart(3,"option",79),a.ɵɵelement(4,"localize",92),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2).$implicit,i=a.ɵɵnextContext(2).index;a.ɵɵproperty("ngModel",r.isOrgUnitGroup)("name","isOrgUnitGroup"+i+r.info.cgrAttr.name),a.ɵɵadvance(1),a.ɵɵproperty("ngValue",!1),a.ɵɵadvance(2),a.ɵɵproperty("ngValue",!0)}}function N(e,t){if(1&e&&(a.ɵɵelementStart(0,"td",89),a.ɵɵtemplate(1,V,5,4,"select",90),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵproperty("ngIf","term"===n.info.cgrAttr.type)}}function L(e,t){1&e&&(a.ɵɵelementStart(0,"td",93),a.ɵɵelementStart(1,"label",88),a.ɵɵelement(2,"localize",94),a.ɵɵelementEnd(),a.ɵɵelementEnd())}function _(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",79),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("ngValue",n.dhis2Id),a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",n.name," ")}}var F=function(){return{standalone:!0}};function H(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"select",96),a.ɵɵlistener("ngModelChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).$implicit.dhis2Id=e}))("change",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext(2).$implicit;return a.ɵɵnextContext(4).onChangeDHIS2Attr(e)})),a.ɵɵelementStart(1,"option",79),a.ɵɵelement(2,"localize",97),a.ɵɵelementEnd(),a.ɵɵtemplate(3,_,2,2,"option",80),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2).$implicit;a.ɵɵproperty("ngModel",r.dhis2Id)("ngModelOptions",a.ɵɵpureFunction0(4,F)),a.ɵɵadvance(1),a.ɵɵproperty("ngValue",null),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",r.info.dhis2Attrs)}}function G(e,t){1&e&&(a.ɵɵelementStart(0,"label",88),a.ɵɵelement(1,"localize",98),a.ɵɵelementEnd())}function q(e,t){if(1&e&&(a.ɵɵelementStart(0,"td",73),a.ɵɵtemplate(1,H,4,5,"select",95),a.ɵɵtemplate(2,G,2,0,"label",81),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵproperty("ngIf",n.info.dhis2Attrs.length>0&&!n.isOrgUnitGroup),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",0==n.info.dhis2Attrs.length&&!n.isOrgUnitGroup)}}function B(e,t){1&e&&a.ɵɵelement(0,"localize",107)}function U(e,t){1&e&&a.ɵɵelement(0,"localize",108)}function $(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",n.name," ")}}function J(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"select",109),a.ɵɵlistener("ngModelChange",(function(e){a.ɵɵrestoreView(n);var t=a.ɵɵnextContext().$implicit;return a.ɵɵnextContext(2).$implicit.terms[t.code]=e})),a.ɵɵelementStart(1,"option",79),a.ɵɵelement(2,"localize",97),a.ɵɵelementEnd(),a.ɵɵtemplate(3,$,2,2,"option",13),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit,i=a.ɵɵnextContext(2).$implicit,o=a.ɵɵnextContext(4);a.ɵɵproperty("ngModel",i.terms[r.code])("ngModelOptions",a.ɵɵpureFunction0(4,F)),a.ɵɵadvance(1),a.ɵɵproperty("ngValue",null),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",o.getTermOptions(i.info,i.externalId))}}function W(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",22),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵproperty("value",n.id),a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.name)}}function K(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"select",110),a.ɵɵlistener("ngModelChange",(function(e){a.ɵɵrestoreView(n);var t=a.ɵɵnextContext().$implicit;return a.ɵɵnextContext(2).$implicit.terms[t.code]=e})),a.ɵɵelementStart(1,"option",79),a.ɵɵelement(2,"localize",97),a.ɵɵelementEnd(),a.ɵɵtemplate(3,W,2,2,"option",13),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit,i=a.ɵɵnextContext(2).$implicit,o=a.ɵɵnextContext(4);a.ɵɵproperty("ngModel",i.terms[r.code])("ngModelOptions",a.ɵɵpureFunction0(4,F)),a.ɵɵadvance(1),a.ɵɵproperty("ngValue",null),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",o.orgUnitGroups)}}function Q(e,t){if(1&e&&(a.ɵɵelementStart(0,"table",100),a.ɵɵelementStart(1,"thead"),a.ɵɵelementStart(2,"tr"),a.ɵɵelement(3,"th",32),a.ɵɵelementStart(4,"th",32),a.ɵɵelementStart(5,"label"),a.ɵɵelement(6,"localize",101),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelement(7,"th",32),a.ɵɵelementStart(8,"th",32),a.ɵɵelementStart(9,"label"),a.ɵɵtemplate(10,B,1,0,"localize",102),a.ɵɵtemplate(11,U,1,0,"localize",103),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(12,"tbody"),a.ɵɵelementStart(13,"tr"),a.ɵɵelement(14,"td"),a.ɵɵelementStart(15,"td"),a.ɵɵelementStart(16,"label",88),a.ɵɵtext(17),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(18,"td",104),a.ɵɵelementStart(19,"label",88),a.ɵɵelement(20,"localize",94),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(21,"td"),a.ɵɵtemplate(22,J,4,5,"select",105),a.ɵɵtemplate(23,K,4,5,"select",106),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit,r=a.ɵɵnextContext(2).$implicit;a.ɵɵadvance(10),a.ɵɵproperty("ngIf",!r.isOrgUnitGroup),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.isOrgUnitGroup),a.ɵɵadvance(6),a.ɵɵtextInterpolate(n.label),a.ɵɵadvance(5),a.ɵɵproperty("ngIf",!r.isOrgUnitGroup),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.isOrgUnitGroup)}}function Y(e,t){if(1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵtemplate(1,Q,24,5,"table",99),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵproperty("ngForOf",n.info.terms)}}function X(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"tr"),a.ɵɵelementStart(1,"td",70),a.ɵɵelementStart(2,"table",71),a.ɵɵelementStart(3,"thead"),a.ɵɵelementStart(4,"tr"),a.ɵɵelement(5,"th",72),a.ɵɵelementStart(6,"th",73),a.ɵɵelementStart(7,"label"),a.ɵɵelement(8,"localize",74),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(9,"th",73),a.ɵɵelementStart(10,"label"),a.ɵɵelement(11,"localize",75),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(12,"th",73),a.ɵɵtemplate(13,R,2,0,"label",76),a.ɵɵelementEnd(),a.ɵɵelementStart(14,"th",73),a.ɵɵtemplate(15,P,2,1,"label",76),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(16,"tbody"),a.ɵɵelementStart(17,"tr"),a.ɵɵelementStart(18,"td",72),a.ɵɵelementStart(19,"i",77),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=t.index,r=a.ɵɵnextContext(2).$implicit;return a.ɵɵnextContext(2).deleteMapping(r,e)})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(20,"td",73),a.ɵɵelementStart(21,"select",78),a.ɵɵlistener("ngModelChange",(function(e){return t.$implicit.cgrAttrName=e}))("change",(function(e){a.ɵɵrestoreView(n);var r=t.$implicit,i=a.ɵɵnextContext(2).$implicit;return a.ɵɵnextContext(2).mapCgrAttr(0==e.target.selectedIndex?null:i.attrCfg.attrConfigInfos[e.target.selectedIndex-1],r)})),a.ɵɵelement(22,"option",79),a.ɵɵtemplate(23,D,3,2,"option",80),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(24,"td",73),a.ɵɵtemplate(25,A,2,1,"label",81),a.ɵɵelementEnd(),a.ɵɵtemplate(26,N,2,1,"td",82),a.ɵɵtemplate(27,L,3,0,"td",83),a.ɵɵtemplate(28,q,3,2,"td",84),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(29,Y,2,1,"div",76),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=t.index,o=a.ɵɵnextContext(2),l=o.index,s=o.$implicit;a.ɵɵadvance(13),a.ɵɵproperty("ngIf",r.info&&"term"===r.info.cgrAttr.type),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",r.info),a.ɵɵadvance(6),a.ɵɵproperty("ngModel",r.cgrAttrName)("name","sourceAttrSelect"+l+"-"+i+(r.cgrAttrName?r.cgrAttrName:"")),a.ɵɵadvance(1),a.ɵɵproperty("ngValue",null),a.ɵɵadvance(1),a.ɵɵproperty("ngForOf",s.attrCfg.attrConfigInfos),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",r.info),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.info&&"term"===r.info.cgrAttr.type),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.info&&"term"!==r.info.cgrAttr.type&&r.info.cgrAttr.name),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.info),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.info&&(null!=r.externalId&&r.externalId.length>0||r.isOrgUnitGroup))}}function Z(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"td",64),a.ɵɵelementStart(1,"h4"),a.ɵɵelement(2,"localize",65),a.ɵɵelementEnd(),a.ɵɵelementStart(3,"table",66),a.ɵɵelementStart(4,"colgroup"),a.ɵɵelement(5,"col",67),a.ɵɵelement(6,"col",68),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"tbody"),a.ɵɵtemplate(8,X,30,11,"tr",69),a.ɵɵelementStart(9,"tr"),a.ɵɵelementStart(10,"td",40),a.ɵɵelementStart(11,"a",41),a.ɵɵlistener("click",(function(){a.ɵɵrestoreView(n);var e=a.ɵɵnextContext().$implicit;return a.ɵɵnextContext(2).addNewMapping(e)})),a.ɵɵpipe(12,"localize"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext().$implicit;a.ɵɵadvance(8),a.ɵɵproperty("ngForOf",r.attrCfg.mappings),a.ɵɵadvance(3),a.ɵɵproperty("title",a.ɵɵpipeBind1(12,2,"sync.attr.attributes.add.tooltip"))}}function ee(e,t){if(1&e&&(a.ɵɵelementStart(0,"tr"),a.ɵɵtemplate(1,x,4,1,"td",42),a.ɵɵtemplate(2,I,4,3,"td",43),a.ɵɵtemplate(3,w,9,2,"td",43),a.ɵɵtemplate(4,T,4,3,"td",44),a.ɵɵtemplate(5,k,9,4,"td",43),a.ɵɵtemplate(6,Z,13,4,"td",45),a.ɵɵelementEnd()),2&e){var n=t.$implicit,r=a.ɵɵnextContext(2);a.ɵɵstyleProp("background-color",!1===n.isAttributeEditor?"#F7F7F7":""),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!1===n.isAttributeEditor),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!1===n.isAttributeEditor),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!1===n.isAttributeEditor),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!1===n.isAttributeEditor&&r.orgUnitGroups.length>0),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!1===n.isAttributeEditor),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!0===n.isAttributeEditor)}}function te(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",7),a.ɵɵelementStart(1,"div",8),a.ɵɵelementStart(2,"label"),a.ɵɵelement(3,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"div",10),a.ɵɵelementStart(5,"div",28),a.ɵɵelementStart(6,"table",29),a.ɵɵelementStart(7,"thead"),a.ɵɵelementStart(8,"tr"),a.ɵɵelementStart(9,"th",30),a.ɵɵelement(10,"localize",31),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"th",32),a.ɵɵelement(12,"localize",33),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"th",32),a.ɵɵelement(14,"localize",34),a.ɵɵelementEnd(),a.ɵɵelementStart(15,"th",35),a.ɵɵelement(16,"localize",36),a.ɵɵelementEnd(),a.ɵɵelementStart(17,"th",37),a.ɵɵelement(18,"localize",38),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(19,"tbody"),a.ɵɵtemplate(20,ee,7,8,"tr",39),a.ɵɵelementStart(21,"tr"),a.ɵɵelementStart(22,"td",40),a.ɵɵelementStart(23,"a",41),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().addLevel()})),a.ɵɵpipe(24,"localize"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(20),a.ɵɵproperty("ngForOf",r.levelRows),a.ɵɵadvance(3),a.ɵɵproperty("title",a.ɵɵpipeBind1(24,2,"sync.levels.add.tooltip"))}}var ne="net.geoprism.registry.etl.DHIS2AttributeMapping",re=function(){function e(e,t,n,r){this.service=e,this.registryService=t,this.lService=n,this.bsModalRef=r,this.message=null,this.config={organization:null,system:null,hierarchy:null,label:this.lService.create(),configuration:{}},this.organizations=[],this.cOrg=null,this.cSystem=null,this.types=[],this.levelRows=[],this.orgUnitGroups=[]}return e.prototype.ngOnInit=function(){this.onSuccess=new i.Subject},e.prototype.init=function(e,t){var n=this;if(this.organizations=t,null!=e){this.config=e;var r=this.organizations.findIndex((function(e){return e.code===n.config.organization}));-1!==r&&(this.cOrg=this.organizations[r]);var i=this.cOrg.systems.findIndex((function(e){return e.oid===n.config.system}));-1!==i&&(this.cSystem=this.cOrg.systems[i]),null!=this.cSystem&&"DHIS2ExternalSystem"===this.cSystem.type&&this.service.getConfigForES(this.config.system,this.config.hierarchy).then((function(e){n.types=e.types,n.orgUnitGroups=e.orgUnitGroups})).catch((function(e){n.error(e)})),this.levelRows=[];for(var o=0;o<this.config.configuration.levels.length;++o){var a={level:this.config.configuration.levels[o],levelNum:o,isAttributeEditor:!1};this.levelRows.push(a)}}},e.prototype.buildDefaultMappings=function(){return[{attributeMappingStrategy:ne,isOrgUnitGroup:!1,cgrAttrName:"displayLabel",externalId:null,dhis2Id:"name",dhis2AttrName:"name"},{attributeMappingStrategy:ne,isOrgUnitGroup:!1,cgrAttrName:"displayLabel",externalId:null,dhis2Id:"shortName",dhis2AttrName:"shortName"},{attributeMappingStrategy:ne,isOrgUnitGroup:!1,cgrAttrName:"code",dhis2Id:"code",externalId:null,dhis2AttrName:"code"},{attributeMappingStrategy:ne,isOrgUnitGroup:!1,cgrAttrName:"createDate",externalId:null,dhis2Id:"openingDate",dhis2AttrName:"openingDate"}]},e.prototype.clearMappingData=function(){var e=this;if(this.types=[],this.levelRows=[],this.config.configuration.levels=[],null!=this.cSystem&&"DHIS2ExternalSystem"===this.cSystem.type){this.service.getConfigForES(this.config.system,this.config.hierarchy).then((function(t){e.types=t.types,e.orgUnitGroups=t.orgUnitGroups})).catch((function(t){e.error(t)}));var t={type:null,geoObjectType:null,level:0,mappings:[],orgUnitGroupId:null};this.config.configuration.levels=[t],this.levelRows.push({level:t,levelNum:0,isAttributeEditor:!1})}},e.prototype.onSelectLevelType=function(e){if("RELATIONSHIPS"===e.level.type){e.attrCfg.mappings=[],e.level.mappings=[];var t=this.getEditorIndex();-1!==t&&this.levelRows.splice(t,1)}else if(0===e.attrCfg.mappings.length){e.attrCfg.mappings=this.buildDefaultMappings(),e.level.mappings=e.attrCfg.mappings;for(var n=e.level.mappings.length,r=function(t){var n=e.level.mappings[t];e.attrCfg.attrConfigInfos.forEach((function(e){e.cgrAttr.name===n.cgrAttrName&&(n.info=e)}))},i=0;i<n;++i)r(i)}},e.prototype.onOrganizationSelected=function(){var e=this,t=this.organizations.findIndex((function(t){return t.code===e.config.organization}));-1!==t?this.cOrg=this.organizations[t]:(this.cOrg=null,this.cSystem=null),this.clearMappingData()},e.prototype.deleteMapping=function(e,t){e.attrCfg.mappings.splice(t,1)},e.prototype.addNewMapping=function(e){e.attrCfg.mappings.push({attributeMappingStrategy:ne,cgrAttrName:null,dhis2AttrName:null,externalId:null,terms:[]})},e.prototype.onChangeExternalSystem=function(){var e=this,t=this.cOrg.systems.findIndex((function(t){return t.oid===e.config.system}));this.cSystem=-1!==t?this.cOrg.systems[t]:null,this.clearMappingData()},e.prototype.onChangeHierarchy=function(){this.clearMappingData()},e.prototype.addLevel=function(){var e={type:null,geoObjectType:null,level:this.config.configuration.levels.length,mappings:[],orgUnitGroupId:null},t=this.config.configuration.levels.push(e);this.levelRows.push({level:e,levelNum:t-1,isAttributeEditor:!1})},e.prototype.removeLevel=function(e,t){if(e<this.config.configuration.levels.length){var n=this.getEditorIndex();n===t+1&&this.levelRows.splice(n,1),this.levelRows.splice(t,1);for(var r=0,i=0;i<this.levelRows.length;++i){var o=this.levelRows[i];o.levelNum=r,o.isAttributeEditor||(r+=1)}this.config.configuration.levels.splice(e,1)}},e.prototype.getEditorIndex=function(){for(var e=0;e<this.levelRows.length;++e){if(this.levelRows[e].isAttributeEditor)return e}return-1},e.prototype.configureAttributes=function(e){var t=this.getEditorIndex();-1!==t&&(this.levelRows.splice(t,1),t===e.levelNum+1)||this.onSelectGeoObjectType(e.level.geoObjectType,e.levelNum,!1)},e.prototype.getTermOptions=function(e,t){for(var n=0;n<e.dhis2Attrs.length;++n){var r=e.dhis2Attrs[n];if(r.dhis2Id===t)return r.options}},e.prototype.onChangeDHIS2Attr=function(e){if(null==e.dhis2Id||""===e.dhis2Id)return null!=e.terms&&(e.terms={}),void(e.dhis2AttrName=null);e.terms={};for(var t=e.info.dhis2Attrs.length,n=0;n<t;++n)e.info.dhis2Attrs[n].dhis2Id===e.dhis2Id&&(e.info.dhis2Attrs[n].dhis2Id!==e.info.dhis2Attrs[n].name?e.externalId=e.info.dhis2Attrs[n].dhis2Id:e.externalId=null,e.dhis2AttrName=e.info.dhis2Attrs[n].name)},e.prototype.onSelectGeoObjectType=function(e,t,n){var r=this;if(void 0===n&&(n=!0),""===e||null==e){var i=this.levelRows[t];return i.attrCfg=null,i.level.mappings=[],void(-1!==(o=this.getEditorIndex())&&o===t+1&&this.levelRows.splice(o,1))}var o,a=this.levelRows[t].attrCfg;null!=a&&a.geoObjectTypeCode===e?(-1!==(o=this.getEditorIndex())&&o!==t+1&&(this.levelRows.splice(o,1),o<t&&(t-=1)),this.levelRows.splice(t+1,0,{isAttributeEditor:!0,attrCfg:a})):this.service.getCustomAttrCfg(e,this.config.system).then((function(i){var o=r.getEditorIndex(),a=r.levelRows[t],l=a.level;(0===l.mappings.length||n)&&(l.mappings=r.buildDefaultMappings());for(var s=l.mappings.length,c=function(e){var t=l.mappings[e];i.forEach((function(e){e.cgrAttr.name===t.cgrAttrName&&(t.info=e)}))},d=0;d<s;++d)c(d);a.attrCfg={geoObjectTypeCode:e,mappings:l.mappings,attrConfigInfos:i},-1!==o&&(o===t+1||i.length>0)&&(r.levelRows.splice(o,1),o<t&&(t-=1)),n||r.levelRows.splice(t+1,0,{isAttributeEditor:!0,attrCfg:a.attrCfg,level:a.level,levelNum:a.levelNum})})).catch((function(e){r.error(e)}))},e.prototype.mapCgrAttr=function(e,t){if(null==e)return t.cgrAttrName=null,t.info=null,t.dhis2AttrName=null,t.externalId=null,t.terms=null,void(t.isOrgUnitGroup=null);t.cgrAttrName=e.cgrAttr.name,t.info=e,t.dhis2AttrName=null,t.externalId=null,t.terms={},t.isOrgUnitGroup=!1,t.attributeMappingStrategy=e.attributeMappingStrategies[0]},e.prototype.onChangeTargetType=function(e){for(var t in e.externalId=null,e.terms)e.terms.hasOwnProperty(t)&&(e.terms[t]=null)},e.prototype.onSubmit=function(){var e=this;this.service.apply(this.config).then((function(t){e.onSuccess.next(t),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.cancel=function(){var e=this;null!=this.config.oid?this.service.unlock(this.config.oid).then((function(){e.bsModalRef.hide()})).catch((function(t){e.error(t)})):this.bsModalRef.hide()},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.SynchronizationConfigService),a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(s.LocalizationService),a.ɵɵdirectiveInject(c.BsModalRef))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["synchronization-config-modal"]],viewQuery:function(e,t){if(1&e&&a.ɵɵviewQuery(h,1),2&e){var n;a.ɵɵqueryRefresh(n=a.ɵɵloadQuery())&&(t.form=n.first)}},decls:29,vars:15,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"text-center"],["key","synchronization.config.title"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],["class","row-holder",4,"ngFor","ngForOf"],[1,"row-holder"],[1,"label-holder"],["key","synchronization.config.organization"],[1,"holder"],[1,"select"],["type","text","name","organization","required","",3,"ngModel","disabled","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["class","row-holder",4,"ngIf"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"value","click"],["type","submit",1,"btn","btn-primary",3,"value","disabled"],["role","alert",1,"alert","alert-danger"],["key","synchronization.config.label"],[3,"key"],["type","text",1,"form-control",3,"ngModel","name","required","ngModelChange"],[3,"value"],["key","synchronization.config.hierarchy"],["type","text","name","hierarchy","required","",3,"ngModel","disabled","ngModelChange","change"],["key","synchronization.config.system"],["type","text","name","system","required","",3,"ngModel","disabled","ngModelChange","change"],["key","synchronization.config.units"],[1,"list-table-wrapper"],["id","manage-systems-table",1,"list-table","table","table-bordered"],[2,"width","3%"],["key","settings.external.synchronization.level.label"],[2,"width","25%"],["key","settings.external.synchronization.geoobjecttype.label"],["key","settings.external.synchronization.dhis2.synch.type.label"],[2,"width","17%"],["key","synchronization.config.orgUnitGroup"],[2,"width","25%","text-align","center"],["key","settings.external.synchronization.actions.label"],[3,"background-color",4,"ngFor","ngForOf"],[1,"button-column"],[1,"fa","fa-plus",3,"title","click"],["style","width:3%",4,"ngIf"],["style","width:25%",4,"ngIf"],["style","width:17%",4,"ngIf"],["colspan","5",4,"ngIf"],[2,"padding","10px 0","margin","0"],["key","sync.level.label"],["type","text","required","",3,"ngModel","name","ngModelChange","change"],["type","text","required","",3,"ngModel","name","change","ngModelChange"],["value","ORG_UNITS"],["value","RELATIONSHIPS"],["key","synchronization.config.relationships"],["value","ALL"],["key","synchronization.config.all"],["type","text",3,"ngModel","name","ngModelChange"],[2,"padding","10px",3,"title","click"],[1,"fa","fa-trash-o","ico-remove"],[2,"cursor","pointer","margin-left","9px"],["key","sync.level.delete"],["style","padding: 10px;",3,"title","click",4,"ngIf"],[1,"fa","fa-edit"],[2,"cursor","pointer","margin-left","3px"],["key","sync.attr.attributes.editButton"],["colspan","5"],["key","sync.attr.attributes.title"],[1,"table","table-bordered","table-striped",2,"margin-left","80px","width","calc(100% - 80px)"],["width","5%"],["width","95%"],[4,"ngFor","ngForOf"],["colspan","2",1,"row-holder"],[2,"width","80%","margin-top","15px","margin-bottom","10px"],[2,"width","5%"],[2,"width","23%"],["key","sync.attr.sourceAttribute"],["key","sync.attr.type"],[4,"ngIf"],[1,"fa","fa-times",3,"click"],[2,"width","95%",3,"ngModel","name","ngModelChange","change"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["style","color:#999;",4,"ngIf"],["style","margin-right:20px; width:23%",4,"ngIf"],["style","float:right; margin-right:20px; width:23%",4,"ngIf"],["style","width:23%",4,"ngIf"],["key","sync.attr.targetTypeHeader"],["key","sync.attr.targetAttribute",4,"ngIf"],["key","sync.attr.targetAttribute"],[2,"color","#999"],[2,"margin-right","20px","width","23%"],["style","width:95%",3,"ngModel","name","ngModelChange","change",4,"ngIf"],["key","sync.attr.targetTypeOptionSet"],["key","sync.attr.targetTypeOrgUnitGroup"],[2,"float","right","margin-right","20px","width","23%"],["key","sync.attr.to"],[3,"ngModel","ngModelOptions","ngModelChange","change",4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange","change"],["key","sync.notMapped"],["key","sync.noValid"],["class","row","style","width:80%; margin-left:80px;",4,"ngFor","ngForOf"],[1,"row",2,"width","80%","margin-left","80px"],["key","sync.attr.term.cgrTerm"],["key","sync.attr.term.dhis2Option",4,"ngIf"],["key","sync.attr.term.targetOrgUnitGroup",4,"ngIf"],[2,"float","right","margin-right","20px"],[3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["type","text",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["key","sync.attr.term.dhis2Option"],["key","sync.attr.term.targetOrgUnitGroup"],[3,"ngModel","ngModelOptions","ngModelChange"],["type","text",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",0),a.ɵɵtemplate(1,f,2,1,"div",1),a.ɵɵelementStart(2,"div",2),a.ɵɵelementStart(3,"h2"),a.ɵɵelement(4,"localize",3),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"form",4,5),a.ɵɵlistener("ngSubmit",(function(){return a.ɵɵrestoreView(n),a.ɵɵreference(6).valid&&t.onSubmit()})),a.ɵɵelementStart(7,"fieldset"),a.ɵɵtemplate(8,y,9,4,"div",6),a.ɵɵelementStart(9,"div",7),a.ɵɵelementStart(10,"div",8),a.ɵɵelementStart(11,"label"),a.ɵɵelement(12,"localize",9),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"div",10),a.ɵɵelementStart(14,"span",11),a.ɵɵelementStart(15,"select",12),a.ɵɵlistener("ngModelChange",(function(e){return t.config.organization=e}))("change",(function(){return t.onOrganizationSelected()})),a.ɵɵelement(16,"option"),a.ɵɵtemplate(17,v,2,2,"option",13),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(18,S,9,3,"div",14),a.ɵɵtemplate(19,E,9,3,"div",14),a.ɵɵtemplate(20,te,25,4,"div",14),a.ɵɵelementStart(21,"div",7),a.ɵɵelement(22,"div",8),a.ɵɵelementStart(23,"div",10),a.ɵɵelementStart(24,"div",15),a.ɵɵelementStart(25,"input",16),a.ɵɵlistener("click",(function(){return t.cancel()})),a.ɵɵpipe(26,"localize"),a.ɵɵelementEnd(),a.ɵɵelement(27,"input",17),a.ɵɵpipe(28,"localize"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵreference(6);a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(7),a.ɵɵproperty("ngForOf",t.config.label.localeValues),a.ɵɵadvance(7),a.ɵɵproperty("ngModel",t.config.organization)("disabled",null!=t.config.oid),a.ɵɵadvance(2),a.ɵɵproperty("ngForOf",t.organizations),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.cOrg),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.config.hierarchy),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.cSystem&&"DHIS2ExternalSystem"===t.cSystem.type),a.ɵɵadvance(5),a.ɵɵproperty("value",a.ɵɵpipeBind1(26,11,"dataset.cancel")),a.ɵɵadvance(2),a.ɵɵproperty("value",a.ɵɵpipeBind1(28,13,"dataset.submit"))("disabled",!r.valid)}},directives:[d.NgIf,p.LocalizeComponent,m.ɵangular_packages_forms_forms_ba,m.NgControlStatusGroup,m.NgForm,d.NgForOf,m.SelectControlValueAccessor,m.RequiredValidator,m.NgControlStatus,m.NgModel,m.NgSelectOption,m.ɵangular_packages_forms_forms_z,u.ConvertKeyLabel,m.DefaultValueAccessor],pipes:[g.LocalizePipe],encapsulation:2}),e}();t.SynchronizationConfigModalComponent=re,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(re,[{type:r.Component,args:[{selector:"synchronization-config-modal",templateUrl:"./synchronization-config-modal.component.html",styleUrls:[]}]}],(function(){return[{type:l.SynchronizationConfigService},{type:l.RegistryService},{type:s.LocalizationService},{type:c.BsModalRef}]}),{form:[{type:r.ViewChild,args:["form"]}]})},606:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SynchronizationConfigComponent=void 0;var r=n(0),i=(n(33),n(379)),o=(n(16),n(518),n(206)),a=n(0),l=n(518),s=n(16),c=n(33),d=n(122),p=n(86),m=n(1),u=n(22),g=n(68),h=n(555),f=n(204),y=n(113);function v(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",5),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function b(e,t){1&e&&a.ɵɵelement(0,"localize",25)}function S(e,t){1&e&&a.ɵɵelement(0,"localize",34)}function C(e,t){1&e&&a.ɵɵelement(0,"localize",35)}function E(e,t){if(1&e&&(a.ɵɵelementStart(0,"tr"),a.ɵɵelementStart(1,"td",9),a.ɵɵelement(2,"localize",27),a.ɵɵtext(3),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"td"),a.ɵɵtext(5),a.ɵɵelementEnd(),a.ɵɵelementStart(6,"td",29),a.ɵɵtemplate(7,b,1,0,"localize",31),a.ɵɵtemplate(8,S,1,0,"localize",32),a.ɵɵtemplate(9,C,1,0,"localize",33),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit,r=t.index;a.ɵɵadvance(3),a.ɵɵtextInterpolate1(" ",r+1," "),a.ɵɵadvance(2),a.ɵɵtextInterpolate1(" ",n.geoObjectType," "),a.ɵɵadvance(2),a.ɵɵproperty("ngIf","ORG_UNITS"===n.type),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","RELATIONSHIPS"===n.type),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","ALL"===n.type)}}function x(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",3),a.ɵɵelementStart(1,"div",6),a.ɵɵelementStart(2,"h4"),a.ɵɵelement(3,"localize",25),a.ɵɵelementEnd(),a.ɵɵelementStart(4,"table",26),a.ɵɵelementStart(5,"thead"),a.ɵɵelementStart(6,"tr"),a.ɵɵelementStart(7,"th"),a.ɵɵelement(8,"localize",27),a.ɵɵelementEnd(),a.ɵɵelementStart(9,"th"),a.ɵɵelement(10,"localize",28),a.ɵɵelementEnd(),a.ɵɵelementStart(11,"th",29),a.ɵɵelement(12,"localize",30),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"tbody"),a.ɵɵtemplate(14,E,10,5,"tr",23),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext(2);a.ɵɵadvance(14),a.ɵɵproperty("ngForOf",n.config.configuration.levels)}}function O(e,t){if(1&e&&(a.ɵɵelementStart(0,"span",39),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",n.exception.message," ")}}function I(e,t){if(1&e&&a.ɵɵelement(0,"step-indicator",45),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵproperty("steps",n.stepConfig)}}function w(e,t){if(1&e&&(a.ɵɵelementStart(0,"a",46),a.ɵɵelementStart(1,"button",47),a.ɵɵelement(2,"localize",48),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext().$implicit;a.ɵɵproperty("routerLink","/registry/sync/details/"+n.historyId)}}function M(e,t){if(1&e&&(a.ɵɵelementStart(0,"tr"),a.ɵɵelementStart(1,"td",9),a.ɵɵelementStart(2,"div",36),a.ɵɵelement(3,"i",37),a.ɵɵelementStart(4,"p",38),a.ɵɵelementStart(5,"span",39),a.ɵɵtext(6),a.ɵɵelementEnd(),a.ɵɵelementStart(7,"span",39),a.ɵɵtext(8),a.ɵɵelementEnd(),a.ɵɵelementStart(9,"span",39),a.ɵɵtext(10),a.ɵɵelementEnd(),a.ɵɵtemplate(11,O,2,1,"span",40),a.ɵɵelementEnd(),a.ɵɵtemplate(12,I,1,1,"step-indicator",41),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"td",42),a.ɵɵelementStart(14,"div",43),a.ɵɵtemplate(15,w,3,1,"a",44),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e){var n=t.$implicit,r=a.ɵɵnextContext(2);a.ɵɵadvance(6),a.ɵɵtextInterpolate1(" ",n.fileName," "),a.ɵɵadvance(2),a.ɵɵtextInterpolate1(" ",n.createDate," "),a.ɵɵadvance(2),a.ɵɵtextInterpolate1(" ",r.formatJobStatus(n)," "),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=n.exception&&"java.lang.RuntimeException"!=n.exception.type),a.ɵɵadvance(1),a.ɵɵproperty("ngIf","SUCCESS"!==n.status&&"FAILURE"!==n.status&&"CANCELED"!==n.status),a.ɵɵadvance(3),a.ɵɵproperty("ngIf","FAILURE"===n.status)}}function T(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",49),a.ɵɵelementStart(1,"pagination-controls",50),a.ɵɵlistener("pageChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).onPageChange(e)})),a.ɵɵelementEnd(),a.ɵɵelementEnd()}}var j=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function k(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",6),a.ɵɵelementStart(1,"div",3),a.ɵɵelementStart(2,"div",6),a.ɵɵelementStart(3,"h3"),a.ɵɵtext(4),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"div",7),a.ɵɵelementStart(6,"div",3),a.ɵɵelementStart(7,"div",8),a.ɵɵelementStart(8,"label",9),a.ɵɵtext(9,"CGR"),a.ɵɵelementEnd(),a.ɵɵelement(10,"i",10),a.ɵɵelementStart(11,"label",9),a.ɵɵtext(12),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(13,"div",11),a.ɵɵelementStart(14,"form",null,12),a.ɵɵelementStart(16,"div",13),a.ɵɵelementStart(17,"button",14),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onRun()})),a.ɵɵpipe(18,"localize"),a.ɵɵelement(19,"localize",15),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(20,x,15,1,"div",16),a.ɵɵelementStart(21,"div",3),a.ɵɵelementStart(22,"div",17),a.ɵɵelementStart(23,"ul",18),a.ɵɵelementStart(24,"div",19),a.ɵɵelementStart(25,"table",20),a.ɵɵelementStart(26,"thead"),a.ɵɵelementStart(27,"tr",21),a.ɵɵelementStart(28,"th",9),a.ɵɵelement(29,"localize",22),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(30,"tbody"),a.ɵɵtemplate(31,M,16,6,"tr",23),a.ɵɵpipe(32,"paginate"),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵtemplate(33,T,2,0,"div",24),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵreference(15),i=a.ɵɵnextContext();a.ɵɵadvance(4),a.ɵɵtextInterpolate(i.config.label.localizedValue),a.ɵɵadvance(8),a.ɵɵtextInterpolate(i.config.systemLabel),a.ɵɵadvance(5),a.ɵɵproperty("disabled",r.invalid)("title",a.ɵɵpipeBind1(18,7,"synchronization.config.run")),a.ɵɵadvance(3),a.ɵɵproperty("ngIf",null!=i.config&&"DHIS2ExternalSystem"===i.config.type),a.ɵɵadvance(11),a.ɵɵproperty("ngForOf",a.ɵɵpipeBind2(32,9,i.page.resultSet,a.ɵɵpureFunction3(12,j,i.page.pageSize,i.page.pageNumber,i.page.count))),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",i.page.resultSet.length>0)}}var R=function(){function e(e,t,n){this.service=e,this.lService=t,this.route=n,this.message=null,this.config=null,this.page={pageSize:10,pageNumber:1,count:1,resultSet:[]}}return e.prototype.ngOnInit=function(){var e=this,t=this.route.snapshot.paramMap.get("oid");this.service.get(t).then((function(t){e.config=t,e.onPageChange(1)}));var n="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=i.webSocket(n+"/websocket/notify"),this.notifier.subscribe((function(t){"DATA_EXPORT_JOB_CHANGE"===t.type&&e.onPageChange(e.page.pageNumber)}))},e.prototype.ngOnDestroy=function(){null!=this.notifier&&this.notifier.complete()},e.prototype.onRun=function(){var e=this;this.message=null,this.service.run(this.config.oid).then((function(){e.onPageChange(e.page.pageNumber)})).catch((function(t){e.error(t)}))},e.prototype.onPageChange=function(e){var t=this;null!=this.config&&(this.message=null,this.service.getJobs(this.config.oid,e,this.page.pageSize).then((function(e){t.formatStepConfig(e),t.page=e})).catch((function(e){t.error(e)})))},e.prototype.formatJobStatus=function(e){return"FEEDBACK"===e.status?this.lService.decode("etl.JobStatus.FEEDBACK"):"RUNNING"===e.status||"NEW"===e.status?this.lService.decode("etl.JobStatus.RUNNING"):"QUEUED"===e.status?this.lService.decode("etl.JobStatus.QUEUED"):"SUCCESS"===e.status?this.lService.decode("etl.JobStatus.SUCCESS"):"CANCELED"===e.status?this.lService.decode("etl.JobStatus.CANCELED"):"FAILURE"===e.status?this.lService.decode("etl.JobStatus.FAILURE"):this.lService.decode("etl.JobStatus.RUNNING")},e.prototype.formatStepConfig=function(e){var t=this;e.resultSet.forEach((function(e){e.stepConfig={steps:[{label:t.lService.decode("synchronization.step.Queued"),status:"NEW"===e.stage?t.getJobStatus(e):t.getCompletedStatus(e.stage,"NEW")},{label:t.lService.decode("synchronization.step.Connecting"),status:"CONNECTING"===e.stage||"CONNECTION_FAILED"===e.stage?t.getJobStatus(e):t.getCompletedStatus(e.stage,"CONNECTION_FAILED")},{label:t.lService.decode("synchronization.step.DatabaseExport"),status:"EXPORT"===e.stage||"EXPORT_RESOLVE"===e.stage||"RESUME_EXPORT"===e.stage?t.getJobStatus(e):""}]}}))},e.prototype.getCompletedStatus=function(e,t){var n=["CONNECTING","CONNECTION_FAILED","EXPORT","EXPORT_RESOLVE","RESUME_EXPORT"],r=n.indexOf(e);return n.indexOf(t)<r?"COMPLETE":""},e.prototype.getJobStatus=function(e){return"QUEUED"===e.status||"RUNNING"===e.status?"WORKING":"FEEDBACK"===e.status||"FAILURE"===e.status?"STUCK":""},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.SynchronizationConfigService),a.ɵɵdirectiveInject(s.LocalizationService),a.ɵɵdirectiveInject(c.ActivatedRoute))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["synchronization-config"]],decls:7,vars:2,consts:[[1,"new-admin-design-main"],[1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"row"],["class","col-md-12",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-12"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[1,"col-md-8"],[2,"vertical-align","middle"],["aria-hidden","true",1,"fa","fa-long-arrow-right",2,"font-size","23px","padding","0 7px","vertical-align","middle","color","#bdbdbd","margin-bottom","4px"],[1,"col-md-4"],["myForm","ngForm"],[1,"form-group","text-right",2,"margin","0"],["type","submit","role","button",1,"btn","btn-primary",2,"margin-left","15px",3,"disabled","title","click"],["key","synchronization.config.run"],["class","row",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"solid-table-wrapper"],[1,"table","table-striped"],[2,"height","56px"],["key","masterlist.jobs"],[4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],["key","synchronization.config.units"],[1,"table"],["key","settings.external.synchronization.level.label"],["key","settings.external.synchronization.geoobjecttype.label"],[2,"text-align","right"],["key","settings.external.synchronization.dhis2.synch.type.label"],["key","synchronization.config.units",4,"ngIf"],["key","synchronization.config.relationships",4,"ngIf"],["key","synchronization.config.all",4,"ngIf"],["key","synchronization.config.relationships"],["key","synchronization.config.all"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","40px"],[2,"padding-left","60px"],[2,"display","block"],["style","display: block;",4,"ngIf"],[3,"steps",4,"ngIf"],[2,"text-align","right","vertical-align","middle"],[1,"button-holder",2,"float","right"],["routerLinkActive","active",3,"routerLink",4,"ngIf"],[3,"steps"],["routerLinkActive","active",3,"routerLink"],["role","button",1,"btn","btn-primary"],["key","scheduledjobs.detail.button"],[1,"solid-table-footer"],[3,"pageChange"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div",0),a.ɵɵelement(1,"cgr-header"),a.ɵɵelement(2,"loading-bar"),a.ɵɵelementStart(3,"div",1),a.ɵɵtemplate(4,v,2,1,"div",2),a.ɵɵelementStart(5,"div",3),a.ɵɵtemplate(6,k,34,16,"div",4),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(4),a.ɵɵproperty("ngIf",null!=t.message),a.ɵɵadvance(2),a.ɵɵproperty("ngIf",null!=t.config))},directives:[d.CgrHeaderComponent,p.LoadingBarComponent,m.NgIf,u.ɵangular_packages_forms_forms_ba,u.NgControlStatusGroup,u.NgForm,g.LocalizeComponent,m.NgForOf,h.StepIndicatorComponent,c.RouterLinkWithHref,c.RouterLinkActive,f.PaginationControlsComponent],pipes:[y.LocalizePipe,f.PaginatePipe],encapsulation:2}),e}();t.SynchronizationConfigComponent=R,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(R,[{type:r.Component,args:[{selector:"synchronization-config",templateUrl:"./synchronization-config.component.html",styleUrls:[]}]}],(function(){return[{type:l.SynchronizationConfigService},{type:s.LocalizationService},{type:c.ActivatedRoute}]}),null)},607:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncDetailsComponent=void 0;var r=n(0),i=(n(33),n(16),n(111)),o=(n(518),n(0)),a=n(518),l=n(33),s=n(16),c=n(122),d=n(86),p=n(1),m=n(68),u=n(204);function g(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",7),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵtextInterpolate(n.message)}}function h(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",8),o.ɵɵelementStart(1,"div",9),o.ɵɵelementStart(2,"div",10),o.ɵɵelement(3,"i",11),o.ɵɵelementStart(4,"p",12),o.ɵɵelementStart(5,"span",13),o.ɵɵelement(6,"localize",14),o.ɵɵtext(7),o.ɵɵelementEnd(),o.ɵɵelementStart(8,"span",13),o.ɵɵelement(9,"localize",15),o.ɵɵtext(10),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"div",16),o.ɵɵelementStart(12,"div"),o.ɵɵelementStart(13,"h5"),o.ɵɵelementStart(14,"b"),o.ɵɵtext(15),o.ɵɵelement(16,"localize",17),o.ɵɵtext(17),o.ɵɵelement(18,"localize",18),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(19,"h5"),o.ɵɵtext(20),o.ɵɵelement(21,"localize",19),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(7),o.ɵɵtextInterpolate1(" ",n.job.author," "),o.ɵɵadvance(3),o.ɵɵtextInterpolate1(" ",n.job.createDate," "),o.ɵɵadvance(5),o.ɵɵtextInterpolate1("",n.job.exportedRecords," "),o.ɵɵadvance(2),o.ɵɵtextInterpolate1(" ",n.job.workTotal," "),o.ɵɵadvance(3),o.ɵɵtextInterpolate1("",n.job.workTotal-n.job.exportedRecords," ")}}function f(e,t){if(1&e&&(o.ɵɵelementStart(0,"tr"),o.ɵɵelementStart(1,"td",33),o.ɵɵelementStart(2,"p"),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"td",33),o.ɵɵelementStart(5,"p"),o.ɵɵtext(6),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(7,"td",33),o.ɵɵelementStart(8,"p"),o.ɵɵtext(9),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(3),o.ɵɵtextInterpolate(n.code),o.ɵɵadvance(3),o.ɵɵtextInterpolate(n.message),o.ɵɵadvance(3),o.ɵɵtextInterpolate(n.rowNum)}}function y(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",31),o.ɵɵelementStart(1,"pagination-controls",34),o.ɵɵlistener("pageChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(3).onPageChange(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}}var v=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function b(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",22),o.ɵɵelementStart(1,"ul",23),o.ɵɵelementStart(2,"table",24),o.ɵɵelementStart(3,"thead"),o.ɵɵelementStart(4,"tr"),o.ɵɵelementStart(5,"th",25),o.ɵɵelement(6,"localize",26),o.ɵɵtext(7," "),o.ɵɵelement(8,"localize",27),o.ɵɵelementEnd(),o.ɵɵelementStart(9,"th",25),o.ɵɵelement(10,"localize",28),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"th",25),o.ɵɵelement(12,"localize",29),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(13,"tbody"),o.ɵɵtemplate(14,f,10,3,"tr",30),o.ɵɵpipe(15,"paginate"),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(16,"div",31),o.ɵɵtemplate(17,y,2,0,"div",32),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext(2);o.ɵɵadvance(14),o.ɵɵproperty("ngForOf",o.ɵɵpipeBind2(15,2,n.page.results,o.ɵɵpureFunction3(5,v,n.page.pageSize,n.page.pageNumber,n.page.count))),o.ɵɵadvance(3),o.ɵɵproperty("ngIf",n.page.results.length>0)}}function S(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",20),o.ɵɵtemplate(1,b,18,9,"div",21),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngIf",n.job)}}var C=function(){function e(e,t,n,r){this.service=e,this.route=t,this.ioService=r,this.message=null,this.historyId="",this.page={count:0,pageNumber:1,pageSize:10,results:[]},this.isAdmin=n.isAdmin(),this.isMaintainer=this.isAdmin||n.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||n.isContributer()}return e.prototype.ngOnInit=function(){this.historyId=this.route.snapshot.params.oid,this.onPageChange(1)},e.prototype.ngOnDestroy=function(){},e.prototype.formatAffectedRows=function(e){return e.replace(/,/g,", ")},e.prototype.formatValidationResolve=function(e){return JSON.stringify(e)},e.prototype.onPageChange=function(e){var t=this;this.message=null,this.service.getExportDetails(this.historyId,this.page.pageSize,e).then((function(e){t.job=e,t.page=t.job.exportErrors})).catch((function(e){t.error(e)}))},e.prototype.error=function(e){this.message=i.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.RegistryService),o.ɵɵdirectiveInject(l.ActivatedRoute),o.ɵɵdirectiveInject(s.AuthService),o.ɵɵdirectiveInject(a.IOService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["job"]],decls:10,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","scheduledjobs.details.title"],["class","row","style","background: #F4F4F4;\n                                border-radius: 15px;\n                                margin-bottom: 20px;\n                                margin-top: 20px;\n                                padding: 10px;",4,"ngIf"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"background","#F4F4F4","border-radius","15px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-4","order-md-1"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","scheduledjobs.job.uploaded.by.label"],["key","scheduledjobs.job.started.label"],[1,"col-md-3","order-md-1"],["key","scheduledjobs.job.imported.out.of.label"],["key","scheduledjobs.job.imported.total.label"],["key","scheduledjobs.job.remaining.label"],[1,"row"],["class","col-md-12 order-md-1",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"list-table","table","table-bordered","table-striped"],[1,"label-column"],["key","geoObject.label"],["key","geoObjectType.attr.code"],["key","scheduledjobs.import.table.message.header"],["key","scheduledjobs.import.table.row.number.header"],[4,"ngFor","ngForOf"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[1,"label-column",2,"vertical-align","middle"],[3,"pageChange"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelement(1,"cgr-header"),o.ɵɵelement(2,"loading-bar"),o.ɵɵelementStart(3,"div",1),o.ɵɵtemplate(4,g,2,1,"div",2),o.ɵɵelementStart(5,"div",3),o.ɵɵelementStart(6,"h2"),o.ɵɵelement(7,"localize",4),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(8,h,22,5,"div",5),o.ɵɵtemplate(9,S,2,1,"div",6),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(4),o.ɵɵproperty("ngIf",null!=t.message),o.ɵɵadvance(4),o.ɵɵproperty("ngIf",t.job),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.page&&t.page.results.length>0))},directives:[c.CgrHeaderComponent,d.LoadingBarComponent,p.NgIf,m.LocalizeComponent,p.NgForOf,u.PaginationControlsComponent],pipes:[u.PaginatePipe],styles:[".new-admin-design-main[_ngcontent-%COMP%] {\n    \n}\n\n\n.solid-table-wrapper[_ngcontent-%COMP%] {\n    background: #F4F4F4;\n    border-radius: 15px;\n    margin-bottom: 20px;\n}\n.solid-table-footer[_ngcontent-%COMP%] {\n    \n    border-radius: 0 0 15px 15px;\n    padding: 0 0 10px 10px;\n}\n\n\n\n.wrapper[_ngcontent-%COMP%] {\n    padding: 10px;\n}"]}),e}();t.SyncDetailsComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"job",templateUrl:"./details.component.html",styleUrls:["./details.css"]}]}],(function(){return[{type:a.RegistryService},{type:l.ActivatedRoute},{type:s.AuthService},{type:a.IOService}]}),null)},608:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationManagerComponent=void 0;var r=n(0),i=(n(33),n(263)),o=(n(30),n(517)),a=(n(518),n(111)),l=(n(16),n(0)),s=n(30),c=n(518),d=n(33),p=n(16),m=n(122),u=n(86),g=n(68),h=n(261),f=n(1),y=n(556),v=n(22),b=n(557),S=n(113),C=["simpleEditControl"];function E(e,t){1&e&&(l.ɵɵelementStart(0,"div",16),l.ɵɵelement(1,"localize",17),l.ɵɵelementEnd())}function x(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",24),l.ɵɵelementStart(1,"i",25),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext(2);return e.changeMode(e.MODE.SEARCH)})),l.ɵɵelement(2,"localize",26),l.ɵɵelementEnd(),l.ɵɵelementEnd()}}function O(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",2),l.ɵɵelementStart(1,"div",4),l.ɵɵelementStart(2,"div",5),l.ɵɵelementStart(3,"div",18),l.ɵɵelementStart(4,"input",19),l.ɵɵlistener("keyup.enter",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().search()}))("ngModelChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().text=e})),l.ɵɵelementEnd(),l.ɵɵelementStart(5,"span",20),l.ɵɵelementStart(6,"button",21),l.ɵɵlistener("click",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().search()})),l.ɵɵelement(7,"span",22),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(8,x,3,0,"div",23),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵnextContext();l.ɵɵadvance(4),l.ɵɵproperty("ngModel",r.text)("disabled",r.mode!==r.MODE.SEARCH),l.ɵɵadvance(2),l.ɵɵproperty("disabled",r.mode!==r.MODE.SEARCH),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",r.mode===r.MODE.VIEW&&null!=r.current)}}function I(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",30),l.ɵɵelementStart(1,"div",31),l.ɵɵlistener("click",(function(e){l.ɵɵrestoreView(n);var r=t.$implicit;return l.ɵɵnextContext(2).select(r,e)})),l.ɵɵelementStart(2,"div",32),l.ɵɵelementStart(3,"i",33),l.ɵɵlistener("click",(function(e){l.ɵɵrestoreView(n);var r=t.$implicit;return l.ɵɵnextContext(2).zoomToFeature(r,e)})),l.ɵɵpipe(4,"localize"),l.ɵɵelementEnd(),l.ɵɵelementStart(5,"h4",34),l.ɵɵtext(6),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=t.$implicit;l.ɵɵadvance(3),l.ɵɵproperty("title",l.ɵɵpipeBind1(4,3,"explorer.zoom.label")),l.ɵɵadvance(3),l.ɵɵtextInterpolate2("",r.properties.code," - ",r.properties.displayLabel.localizedValue,"")}}function w(e,t){if(1&e&&(l.ɵɵelementStart(0,"div",2),l.ɵɵelementStart(1,"div",4),l.ɵɵelementStart(2,"div",27),l.ɵɵelementStart(3,"div",28),l.ɵɵtemplate(4,I,7,5,"div",29),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext();l.ɵɵadvance(4),l.ɵɵproperty("ngForOf",n.data)}}function M(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",2),l.ɵɵelementStart(1,"div",4),l.ɵɵelementStart(2,"feature-panel",35),l.ɵɵlistener("featureChange",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().search()}))("modeChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onModeChange(e)}))("panelCancel",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onPanelCancel()}))("panelSubmit",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onPanelSubmit(e)})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵnextContext();l.ɵɵadvance(2),l.ɵɵproperty("type",r.type)("code",r.current.properties.code)("forDate",r.forDate)("readOnly",!r.current.properties.writable)}}function T(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",36),l.ɵɵelementStart(1,"div"),l.ɵɵelementStart(2,"div"),l.ɵɵelementStart(3,"label"),l.ɵɵelement(4,"localize",37),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(5,"div"),l.ɵɵelementStart(6,"div",38),l.ɵɵelementStart(7,"input",39),l.ɵɵlistener("ngModelChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().coordinate.latitude=e}))("change",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().refreshDrawFromInput()})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(8,"div"),l.ɵɵelementStart(9,"div"),l.ɵɵelementStart(10,"label"),l.ɵɵelement(11,"localize",40),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(12,"div"),l.ɵɵelementStart(13,"div",38),l.ɵɵelementStart(14,"input",41),l.ɵɵlistener("ngModelChange",(function(e){return l.ɵɵrestoreView(n),l.ɵɵnextContext().coordinate.longitude=e}))("change",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().refreshDrawFromInput()})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵnextContext();l.ɵɵadvance(7),l.ɵɵproperty("ngModel",r.coordinate.latitude),l.ɵɵadvance(7),l.ɵɵproperty("ngModel",r.coordinate.longitude)}}var j=function(){function e(e,t,n,r,i,o,a){this.modalService=e,this.mapService=t,this.geomService=n,this.service=r,this.route=i,this.router=o,this.lService=a,this.coordinate={longitude:null,latitude:null},this.MODE={SEARCH:0,VIEW:1},this.editSessionEnabled=!1,this.data=[],this.text="",this.mode=this.MODE.SEARCH,this.dateStr=null,this.forDate=null,this.isEdit=!1,this.active=!1,this.displayDateRequiredError=!1,this.vectorLayers=[],this.baseLayers=[{name:"Satellite",label:"Satellite",id:"satellite-v9",sprite:"mapbox://sprites/mapbox/satellite-v9",url:"mapbox://mapbox.satellite",selected:!0}],this.preventSingleClick=!1,this.hideSearchOptions=!1,this.vot=null}return e.prototype.ngOnInit=function(){var e=this;this.urlSubscriber=this.route.params.subscribe((function(t){var n=t.geoobjectuid,r=t.geoobjecttypecode;e.hideSearchOptions=t.hideSearchOptions,e.backReference=e.route.snapshot?e.route.snapshot.params.backReference:null,e.dateStr=t.datestr,e.handleDateChange(),n&&r&&e.dateStr&&e.service.getGeoObject(n,r).then((function(t){e.setData([t]),e.select(t,null)})).catch((function(t){e.error(t)}))}))},e.prototype.ngOnDestroy=function(){this.geomService.destroy(),this.urlSubscriber.unsubscribe()},e.prototype.ngAfterViewInit=function(){var e=this,t=this.baseLayers[0];this.map=new i.Map({container:"map",style:{version:8,name:t.name,metadata:{"mapbox:autocomposite":!0},sources:{mapbox:{type:"raster",url:t.url,tileSize:256}},sprite:t.sprite,glyphs:window.location.protocol+"//"+window.location.host+acp+"/glyphs/{fontstack}/{range}.pbf",layers:[{id:t.id,type:"raster",source:"mapbox"}]},zoom:2,attributionControl:!1,center:[-78.880453,42.897852]}),this.map.on("load",(function(){e.initMap()})),this.simpleEditControl&&this.map.addControl(this.simpleEditControl)},e.prototype.changeMode=function(e){this.mode=e,this.mode===this.MODE.SEARCH&&(this.isEdit=!1),this.geomService.destroy(!1),this.vot=null},e.prototype.onModeChange=function(e){this.isEdit=e},e.prototype.handleDateChange=function(){null!=this.dateStr&&(this.forDate=new Date(Date.parse(this.dateStr)),this.displayDateRequiredError=!1)},e.prototype.initMap=function(){var e=this;if(this.map.on("style.load",(function(){e.addLayers()})),this.addLayers(),this.map.addControl(new i.NavigationControl({visualizePitch:!0})),this.map.addControl(new i.AttributionControl({compact:!0}),"bottom-right"),this.map.on("click","children-points",(function(t){e.handleMapClickEvent(t)})),this.map.on("click","children-polygon",(function(t){e.handleMapClickEvent(t)})),this.data){var t={type:"FeatureCollection",features:this.data};this.map.getSource("children").setData(t),this.zoomToFeature(this.data[0],null)}this.showOriginalGeometry()},e.prototype.showOriginalGeometry=function(){this.current&&this.addVectorLayer(this.current.properties.uid)},e.prototype.hideOriginalGeometry=function(){this.current&&this.removeVectorLayer(this.current.properties.uid)},e.prototype.handleMapClickEvent=function(e){if(!this.isEdit&&null!=e.features&&e.features.length>0){var t=e.features[0];null==t.properties.code||null!=this.current&&this.current.properties.code===t.properties.code||this.select(t,null)}},e.prototype.onPanelCancel=function(){null!=this.backReference&&this.backReference.length>=2?"CR"===this.backReference.substring(0,2)&&this.router.navigate(["/registry/change-requests"]):this.changeMode(this.MODE.SEARCH);this.showOriginalGeometry()},e.prototype.onPanelSubmit=function(e){var t=this;this.geomService.saveEdits(),e.isChangeRequest?null!=this.backReference&&this.backReference.length>=2&&"CR"===this.backReference.substring(0,2)?(this.bsModalRef=this.modalService.show(a.SuccessModalComponent,{backdrop:!0,class:"error-white-space-pre"}),this.bsModalRef.content.message=this.lService.decode("geoobject-editor.changerequest.submitted"),this.bsModalRef.content.submitText=this.lService.decode("geoobject-editor.changerequest.view"),this.bsModalRef.content.onConfirm.subscribe((function(){t.router.navigate(["/registry/change-requests",e.changeRequestId])}))):(this.bsModalRef=this.modalService.show(a.ConfirmModalComponent,{backdrop:!0,class:"error-white-space-pre"}),this.bsModalRef.content.message=this.lService.decode("geoobject-editor.changerequest.submitted"),this.bsModalRef.content.submitText=this.lService.decode("geoobject-editor.changerequest.view"),this.bsModalRef.content.cancelText=this.lService.decode("geoobject-editor.cancel.returnExplorer"),this.bsModalRef.content.onConfirm.subscribe((function(){t.router.navigate(["/registry/change-requests",e.changeRequestId])})),this.bsModalRef.content.onCancel.subscribe((function(){t.changeMode(t.MODE.SEARCH)}))):(this.bsModalRef=this.modalService.show(a.SuccessModalComponent,{backdrop:!0,class:"error-white-space-pre"}),this.bsModalRef.content.message=this.lService.decode("geoobject-editor.edit.submitted"),this.bsModalRef.content.submitText=this.lService.decode("geoobject-editor.cancel.returnExplorer"),this.bsModalRef.content.onConfirm.subscribe((function(){t.onPanelCancel()})))},e.prototype.addLayers=function(){var e=this,t="children";this.map.addSource(t,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:t+"-polygon",type:"fill",source:t,layout:{},paint:{"fill-color":"#80cdc1","fill-opacity":.8,"fill-outline-color":"black"},filter:["all",["match",["geometry-type"],["Polygon","MultiPolygon"],!0,!1]]}),this.map.addLayer({id:t+"-points",type:"circle",source:t,paint:{"circle-radius":10,"circle-color":"#80cdc1","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["match",["geometry-type"],["Point","MultiPont"],!0,!1]]}),this.map.addLayer({id:t+"-label",source:t,type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":["get","localizedValue",["get","displayLabel"]],"text-font":["NotoSansRegular"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}}),this.vectorLayers.forEach((function(t){e.addVectorLayer(t)}))},e.prototype.handleBasemapStyle=function(e){this.baseLayers.forEach((function(e){e.selected=!1})),e.selected=!0,this.map.setStyle({version:8,name:e.name,metadata:{"mapbox:autocomposite":!0},sources:{mapbox:{type:"raster",url:e.url,tileSize:256}},sprite:e.sprite,glyphs:window.location.protocol+"//"+window.location.host+acp+"/glyphs/{fontstack}/{range}.pbf",layers:[{id:e.id,type:"raster",source:"mapbox"}]})},e.prototype.search=function(){var e=this;this.geomService.destroy(!1),this.mapService.search(this.text,this.dateStr).then((function(t){e.map.getSource("children").setData(t),e.setData(t.features)})).catch((function(t){e.error(t)}))},e.prototype.zoomToFeature=function(e,t){var n=this;null!=t&&t.stopPropagation(),this.preventSingleClick=!1;this.timer=setTimeout((function(){if(!n.preventSingleClick&&e&&null!=e.geometry){var t=o.default(e),r=50,i=20;"Point"!==e.geometry.type&&"MultiPoint"!==e.geometry.type||(r=100,i=12),n.map.fitBounds(t,{padding:r,animate:!0,maxZoom:i})}}),200)},e.prototype.select=function(e,t){var n=this;null!=t&&t.stopPropagation(),this.service.getGeoObjectTypes([e.properties.type],null).then((function(t){n.type=t[0],n.current=e,n.mode=n.MODE.VIEW,n.geomService.initialize(n.map,n.type.geometryType,!n.isEdit),n.geomService.zoomToLayersExtent()})).catch((function(e){n.error(e)}))},e.prototype.setData=function(e){this.data=e},e.prototype.onContextLayerChange=function(e){e.active?this.addVectorLayer(e.oid):this.removeVectorLayer(e.oid)},e.prototype.removeVectorLayer=function(e){var t=this.vectorLayers.indexOf(e);-1!==t&&(this.map.removeLayer(e+"-points"),this.map.removeLayer(e+"-polygon"),this.map.removeLayer(e+"-label"),this.map.removeSource(e),this.vectorLayers.splice(t,1))},e.prototype.addVectorLayer=function(e){if(-1===this.vectorLayers.indexOf(e)){var t=window.location.protocol,n=window.location.host;this.map.addSource(e,{type:"vector",tiles:[t+"//"+n+acp+"/master-list/tile?x={x}&y={y}&z={z}&config="+encodeURIComponent(JSON.stringify({oid:e}))]}),this.map.addLayer({id:e+"-points",type:"circle",source:e,"source-layer":"context",paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["match",["geometry-type"],["Point","MultiPont"],!0,!1]]},"children-polygon"),this.map.addLayer({id:e+"-polygon",type:"fill",source:e,"source-layer":"context",layout:{},paint:{"fill-color":"#800000","fill-opacity":.8,"fill-outline-color":"black"},filter:["all",["match",["geometry-type"],["Polygon","MultiPolygon"],!0,!1]]},"children-polygon"),this.map.addLayer({id:e+"-label",source:e,"source-layer":"context",type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":["case",["has","displayLabel_"+navigator.language.toLowerCase()],["coalesce",["string",["get","displayLabel_"+navigator.language.toLowerCase()]],["string",["get","displayLabel"]]],["string",["get","displayLabel"]]],"text-font":["NotoSansRegular"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}},"children-polygon"),this.vectorLayers.push(e)}},e.prototype.error=function(e){this.bsModalRef=a.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(l.ɵɵdirectiveInject(s.BsModalService),l.ɵɵdirectiveInject(c.MapService),l.ɵɵdirectiveInject(c.GeometryService),l.ɵɵdirectiveInject(c.RegistryService),l.ɵɵdirectiveInject(d.ActivatedRoute),l.ɵɵdirectiveInject(d.Router),l.ɵɵdirectiveInject(p.LocalizationService))},e.ɵcmp=l.ɵɵdefineComponent({type:e,selectors:[["location-manager"]],viewQuery:function(e,t){if(1&e&&l.ɵɵviewQuery(C,1),2&e){var n;l.ɵɵqueryRefresh(n=l.ɵɵloadQuery())&&(t.simpleEditControl=n.first)}},decls:25,vars:13,consts:[[1,""],["id","app-container",1,"container-fluid"],[1,"row"],["id","navigator-left-sidebar",1,"col-md-5","lw-inner-col",2,"height","calc(100vh - 145px)","overflow-y","auto"],[1,"col-md-12"],[1,"location-management-widget-section"],[2,"margin-right","10px"],["key","changeOverTime.forDate","ng-reflect-key","changeOverTime.forDate"],["label","",2,"display","inline-grid",3,"value","inputName","disable","allowInfinity","allowFutureDates","required","classNames","placement","valueChange","change"],["class","error-message",4,"ngIf"],["class","row",4,"ngIf"],["id","site-explorer-map",1,"col-md-7"],[1,"base-layer-panel"],[3,"layerChange"],["id","map",1,"map-view-port"],["style","position:absolute;top:185px;right:10px;color:white;",4,"ngIf"],[1,"error-message"],["key","geoobject.editor.forDate.requiredErrorMessage"],[1,"input-group"],["type","text","name","text",1,"form-control",3,"ngModel","disabled","keyup.enter","ngModelChange"],[1,"input-group-btn"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"glyphicon","glyphicon-search"],["style","padding: 20px 0;",4,"ngIf"],[2,"padding","20px 0"],["aria-hidden","true",1,"fa","fa-arrow-left","clickable",3,"click"],["key","explorer.back.to.results"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"card","card-default",3,"click"],[1,"card-body"],["aria-hidden","true",1,"fa","fa-map-marker","clickable",2,"float","right","font-size","25px",3,"title","click"],["title","View Geo-Object details",1,"clickable",2,"word-break","break-all"],[3,"type","code","forDate","readOnly","featureChange","modeChange","panelCancel","panelSubmit"],[2,"position","absolute","top","185px","right","10px","color","white"],["key","geoobject.editor.geometry.latitude.label"],[1,"text-left"],["name","latitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["key","geoobject.editor.geometry.longitude.label"],["name","longitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"]],template:function(e,t){1&e&&(l.ɵɵelementStart(0,"div",0),l.ɵɵelement(1,"cgr-header"),l.ɵɵelement(2,"loading-bar"),l.ɵɵelementStart(3,"div",1),l.ɵɵelementStart(4,"div",2),l.ɵɵelementStart(5,"div",3),l.ɵɵelementStart(6,"div"),l.ɵɵelementStart(7,"div",2),l.ɵɵelementStart(8,"div",4),l.ɵɵelementStart(9,"div",2),l.ɵɵelementStart(10,"div",4),l.ɵɵelementStart(11,"div",5),l.ɵɵelementStart(12,"span",6),l.ɵɵelement(13,"localize",7),l.ɵɵelementEnd(),l.ɵɵelementStart(14,"date-field",8),l.ɵɵlistener("valueChange",(function(e){return t.dateStr=e}))("change",(function(){return t.handleDateChange()})),l.ɵɵelementEnd(),l.ɵɵtemplate(15,E,2,0,"div",9),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(16,O,9,4,"div",10),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(17,w,5,1,"div",10),l.ɵɵelementEnd(),l.ɵɵtemplate(18,M,3,4,"div",10),l.ɵɵelementEnd(),l.ɵɵelementStart(19,"div",11),l.ɵɵelementStart(20,"div",2),l.ɵɵelementStart(21,"article",12),l.ɵɵelementStart(22,"layer-panel",13),l.ɵɵlistener("layerChange",(function(e){return t.onContextLayerChange(e)})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelement(23,"div",14),l.ɵɵtemplate(24,T,15,2,"div",15),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e&&(l.ɵɵadvance(14),l.ɵɵproperty("value",t.dateStr)("inputName","dateStr")("disable",t.mode!==t.MODE.SEARCH&&!t.hideSearchOptions)("allowInfinity",!1)("allowFutureDates",!1)("required",!1)("classNames",t.displayDateRequiredError?"date-required-message":"")("placement","right"),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.displayDateRequiredError),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",!t.hideSearchOptions),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.mode===t.MODE.SEARCH),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.mode===t.MODE.VIEW&&null!=t.current),l.ɵɵadvance(6),l.ɵɵproperty("ngIf",t.editingControl&&("POINT"===t.type.geometryType||"MULTIPOINT"===t.type.geometryType)))},directives:[m.CgrHeaderComponent,u.LoadingBarComponent,g.LocalizeComponent,h.DateFieldComponent,f.NgIf,y.LayerPanelComponent,v.DefaultValueAccessor,v.NgControlStatus,v.NgModel,f.NgForOf,b.FeaturePanelComponent,v.NumberValueAccessor,v.RequiredValidator],pipes:[S.LocalizePipe],styles:["#hierarchy-tree-container[_ngcontent-%COMP%] {\n\theight: 100%;\n    overflow-y: auto;\n}\n\n.location-management-widget-section[_ngcontent-%COMP%] {\n\tmargin: 5px 0;\n}\n.location-management-widget-section[_ngcontent-%COMP%]    > select[_ngcontent-%COMP%] {\n\tfloat: none !important;\n}\n\n.list-group-item[_ngcontent-%COMP%] {\n\tborder: none;\n\tborder-bottom: 1px solid #ddd;\n\tmargin-bottom: 0;\n}\n.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n\n.breadcrumb[_ngcontent-%COMP%]{\n\tpadding: 10px 0;\n\tbackground-color: white;\n\tmargin:0;\n}\n\n.layer-toggle[_ngcontent-%COMP%] {\n\tcursor: pointer; \n\tbackground: #fff; \n\tpadding: 8px; \n\tborder-radius: 4px;\n\twidth: fit-content;\n}\n\n.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n\tmargin-left: 5px;\n}\n\n.arrow[_ngcontent-%COMP%] {\n  border: solid black;\n  border-width: 0 1px 1px 0;\n  display: inline-block;\n  padding: 5px;\n}\n.arrow-right[_ngcontent-%COMP%] {\n  transform: rotate(-45deg);\n  -webkit-transform: rotate(-45deg);\n}\n.arrow-down[_ngcontent-%COMP%] {\n  transform: rotate(45deg);\n  -webkit-transform: rotate(45deg);\n}\n\n.fa.fa-arrow-left[_ngcontent-%COMP%]::before {\n\tmargin-right:5px;\n}"]}),e}();t.LocationManagerComponent=j,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(j,[{type:r.Component,args:[{selector:"location-manager",templateUrl:"./location-manager.component.html",styleUrls:["./location-manager.css"]}]}],(function(){return[{type:s.BsModalService},{type:c.MapService},{type:c.GeometryService},{type:c.RegistryService},{type:d.ActivatedRoute},{type:d.Router},{type:p.LocalizationService}]}),{simpleEditControl:[{type:r.ViewChild,args:["simpleEditControl"]}]})},609:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextLayerModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(0),a=n(30),l=n(68),s=n(22),c=n(1);function d(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵelementStart(1,"input",15),o.ɵɵlistener("change",(function(){var e=t.$implicit;return e.enabled=!e.enabled})),o.ɵɵelementEnd(),o.ɵɵtext(2),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("checked",n.enabled),o.ɵɵadvance(1),o.ɵɵtextInterpolate1(" ",n.displayLabel," ")}}function p(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",14),o.ɵɵelementStart(1,"h4"),o.ɵɵtext(2),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"div",6),o.ɵɵtemplate(4,d,3,2,"div",7),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var n=o.ɵɵnextContext().$implicit;o.ɵɵadvance(2),o.ɵɵtextInterpolate(n.displayLabel),o.ɵɵadvance(2),o.ɵɵproperty("ngForOf",n.contextLayers)}}function m(e,t){if(1&e&&(o.ɵɵelementStart(0,"div"),o.ɵɵtemplate(1,p,5,2,"div",13),o.ɵɵelementEnd()),2&e){var n=t.$implicit,r=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵproperty("ngIf",r.groupHasContextLayers(n.oid))}}var u=function(){function e(e){this.bsModalRef=e}return e.prototype.ngOnInit=function(){this.onSubmit=new i.Subject},e.prototype.groupHasContextLayers=function(e){var t=!1;return this.contextLayerGroups.forEach((function(n){n.oid===e&&n.contextLayers.length>0&&(t=!0)})),t},e.prototype.confirm=function(){this.onSubmit.next(this.contextLayerGroups),this.bsModalRef.hide()},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.BsModalRef))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["context-layer-modal"]],decls:19,vars:1,consts:[[1,"modal-body"],[1,"heading"],["key","explorer.add.context.layers.modal.title"],["name","export-form",1,"modal-form"],[1,"row"],[1,"col-md-12"],[1,"list-group"],[4,"ngFor","ngForOf"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","role","button",1,"btn","btn-primary",3,"click"],["key","modal.button.submit"],["class","list-group-item","style","border: none;",4,"ngIf"],[1,"list-group-item",2,"border","none"],["type","checkbox",2,"margin-left","10px",3,"checked","change"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"div",1),o.ɵɵelementStart(2,"h2"),o.ɵɵelement(3,"localize",2),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"form",3),o.ɵɵelementStart(5,"fieldset"),o.ɵɵelementStart(6,"div",4),o.ɵɵelementStart(7,"div",5),o.ɵɵelementStart(8,"div",6),o.ɵɵtemplate(9,m,2,1,"div",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(10,"div",4),o.ɵɵelementStart(11,"div",5),o.ɵɵelementStart(12,"div",8),o.ɵɵelementStart(13,"button",9),o.ɵɵlistener("click",(function(){return t.bsModalRef.hide()})),o.ɵɵelementStart(14,"span"),o.ɵɵelement(15,"localize",10),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(16,"button",11),o.ɵɵlistener("click",(function(){return t.confirm()})),o.ɵɵelementStart(17,"span"),o.ɵɵelement(18,"localize",12),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(9),o.ɵɵproperty("ngForOf",t.contextLayerGroups))},directives:[l.LocalizeComponent,s.ɵangular_packages_forms_forms_ba,s.NgControlStatusGroup,s.NgForm,c.NgForOf,c.NgIf],styles:["#hierarchy-tree-container[_ngcontent-%COMP%] {\n\theight: 100%;\n    overflow-y: auto;\n}\n\n.location-management-widget-section[_ngcontent-%COMP%] {\n\tmargin: 5px 0;\n}\n.location-management-widget-section[_ngcontent-%COMP%]    > select[_ngcontent-%COMP%] {\n\tfloat: none !important;\n}\n\n.list-group-item[_ngcontent-%COMP%] {\n\tborder: none;\n\tborder-bottom: 1px solid #ddd;\n\tmargin-bottom: 0;\n}\n.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n\n.breadcrumb[_ngcontent-%COMP%]{\n\tpadding: 10px 0;\n\tbackground-color: white;\n\tmargin:0;\n}\n\n.layer-toggle[_ngcontent-%COMP%] {\n\tcursor: pointer; \n\tbackground: #fff; \n\tpadding: 8px; \n\tborder-radius: 4px;\n\twidth: fit-content;\n}\n\n.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n\tmargin-left: 5px;\n}\n\n.arrow[_ngcontent-%COMP%] {\n  border: solid black;\n  border-width: 0 1px 1px 0;\n  display: inline-block;\n  padding: 5px;\n}\n.arrow-right[_ngcontent-%COMP%] {\n  transform: rotate(-45deg);\n  -webkit-transform: rotate(-45deg);\n}\n.arrow-down[_ngcontent-%COMP%] {\n  transform: rotate(45deg);\n  -webkit-transform: rotate(45deg);\n}\n\n.fa.fa-arrow-left[_ngcontent-%COMP%]::before {\n\tmargin-right:5px;\n}"]}),e}();t.ContextLayerModalComponent=u,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(u,[{type:r.Component,args:[{selector:"context-layer-modal",templateUrl:"./context-layer-modal.component.html",styleUrls:["./location-manager.css"]}]}],(function(){return[{type:a.BsModalRef}]}),null)},610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatasetLocationManagerComponent=void 0;var r=n(0),i=(n(33),n(30),n(263)),o=(n(518),n(112),n(111)),a=(n(16),n(0)),l=n(518),s=n(30),c=n(33),d=n(16),p=n(112),m=n(122),u=n(86),g=n(1),h=n(556),f=n(68),y=n(557);function v(e,t){if(1&e&&(a.ɵɵelementStart(0,"h3"),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext(2);a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.type.label.localizedValue)}}function b(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",8),a.ɵɵelementStart(1,"div",1),a.ɵɵelementStart(2,"div",9),a.ɵɵelementStart(3,"div",10),a.ɵɵtemplate(4,v,2,1,"h3",11),a.ɵɵelementStart(5,"h4"),a.ɵɵelement(6,"localize",12),a.ɵɵtext(7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"feature-panel",13),a.ɵɵlistener("featureChange",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onFeatureChange()}))("modeChange",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onModeChange(e)}))("panelCancel",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onPanelCancel()}))("panelSubmit",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext().onPanelSubmit(e)})),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(4),a.ɵɵproperty("ngIf",r.type),a.ɵɵadvance(3),a.ɵɵtextInterpolate1(": ",r.formatDate(r.forDate),""),a.ɵɵadvance(1),a.ɵɵproperty("type",r.type)("code",r.code)("forDate",r.forDate)("datasetId",r.datasetId)("readOnly",r.readOnly)}}function S(e,t){1&e&&a.ɵɵelement(0,"i",17)}function C(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",18),a.ɵɵelementStart(1,"span",19),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).onNewGeoObject()})),a.ɵɵelementStart(2,"button",20),a.ɵɵelement(3,"localize",21),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}}function E(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",14),a.ɵɵlistener("mouseenter",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().toolsIconHover=!0}))("mouseleave",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().toolsIconHover=!1})),a.ɵɵtemplate(1,S,1,0,"i",15),a.ɵɵtemplate(2,C,4,0,"div",16),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!r.toolsIconHover),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",r.toolsIconHover)}}var x=function(e,t){return{"col-md-7":e,"col-md-12":t}},O=function(e){return[e]},I=function(){function e(e,t,n,r,i,o,a,l,s){this.mapService=e,this.geomService=t,this.service=n,this.modalService=r,this.route=i,this.lService=a,this.dateService=l,this.router=s,this.coordinate={longitude:null,latitude:null},this.MODE={VERSIONS:"VERSIONS",ATTRIBUTES:"ATTRIBUTES",HIERARCHY:"HIERARCHY"},this.toolsIconHover=!1,this.readOnly=!1,this.editOnly=!1,this.isEdit=!1,this.vectorLayers=[],this.baseLayers=[{name:"Satellite",label:"Satellite",id:"satellite-v9",sprite:"mapbox://sprites/mapbox/satellite-v9",url:"mapbox://mapbox.satellite",selected:!0}],this.mode=null,this.forDate=new Date,this.isMaintainer=o.isAdmin()||o.isMaintainer()}return e.prototype.ngOnInit=function(){var e=this;this.datasetId=this.route.snapshot.params.datasetId,this.typeCode=this.route.snapshot.params.typeCode,this.date=this.route.snapshot.params.date,this.readOnly="true"===this.route.snapshot.params.readOnly,this.editOnly="true"===this.route.snapshot.params.editOnly,this.backReference=this.route.snapshot.params.backReference,null!=this.route.snapshot.params.code&&(this.code=this.route.snapshot.params.code),this.forDate=this.dateService.getDateFromDateString(this.date),this.service.getGeoObjectTypes([this.typeCode],null).then((function(t){e.type=t[0],e.geomService.initialize(e.map,e.type.geometryType,!e.isEdit)})).catch((function(t){e.error(t)}))},e.prototype.onPanelCancel=function(){if(null!=this.backReference&&this.backReference.length>=2&&"ML"===this.backReference.substring(0,2)){var e="T"===this.backReference.substring(3,3),t=this.backReference.substring(3);this.router.navigate(["/registry/master-list",t,e])}this.showOriginalGeometry()},e.prototype.onPanelSubmit=function(e){var t=this;if(this.geomService.saveEdits(),this.bsModalRef=this.modalService.show(o.GenericModalComponent,{backdrop:!0,class:"error-white-space-pre"}),e.isChangeRequest){var n=this.lService.decode("geoobject-editor.changerequest.submitted");(r=[]).push({label:this.lService.decode("geoobject-editor.cancel.returnList"),onClick:function(){t.onPanelCancel()},shouldClose:!0,class:"btn-primary"}),r.push({label:this.lService.decode("geoobject-editor.changerequest.view"),onClick:function(){t.router.navigate(["/registry/change-requests",e.changeRequestId])},shouldClose:!0,class:"btn-default"}),r.push({label:this.lService.decode("geoobject-editor.continueEditing"),onClick:function(){},shouldClose:!0,class:"btn-default"}),this.bsModalRef.content.init(n,r)}else{var r;n=this.lService.decode("geoobject-editor.edit.submitted");(r=[]).push({label:this.lService.decode("geoobject-editor.cancel.returnList"),onClick:function(){t.onPanelCancel()},shouldClose:!0,class:"btn-primary"}),r.push({label:this.lService.decode("geoobject-editor.continueEditing"),onClick:function(){},shouldClose:!0,class:"btn-default"}),this.bsModalRef.content.init(n,r)}},e.prototype.ngOnDestroy=function(){this.geomService.destroy()},e.prototype.ngAfterViewInit=function(){var e=this,t=this.baseLayers[0];this.map=new i.Map({container:"dataset-map",style:{version:8,name:t.name,metadata:{"mapbox:autocomposite":!0},sources:{"mapbox-satellite":{type:"raster",url:t.url,tileSize:256}},sprite:t.sprite,glyphs:window.location.protocol+"//"+window.location.host+acp+"/glyphs/{fontstack}/{range}.pbf",layers:[]},zoom:2,attributionControl:!1,center:[-78.880453,42.897852]}),this.map.on("load",(function(){e.initMap()}))},e.prototype.onModeChange=function(e){this.isEdit=e,this.geomService.destroy(!1)},e.prototype.initMap=function(){var e=this;"__NEW__"!==this.code&&this.service.getGeoObjectBoundsAtDate(this.code,this.typeCode,this.date).then((function(t){if(t){var n=new i.LngLatBounds([t[0],t[1]],[t[2],t[3]]),r=50,o=20;"POINT"!==e.type.geometryType&&"MULTIPOINT"!==e.type.geometryType||(r=100,o=12),e.map.fitBounds(n,{padding:r,animate:!1,maxZoom:o})}})),this.map.on("style.load",(function(){e.addLayers()})),this.addLayers(),this.map.addControl(new i.NavigationControl({visualizePitch:!0})),this.map.addControl(new i.AttributionControl({compact:!0}),"bottom-right"),this.map.on("click",this.datasetId+"-points",(function(t){e.handleMapClickEvent(t)})),this.map.on("click",this.datasetId+"-polygon",(function(t){e.handleMapClickEvent(t)})),this.showOriginalGeometry()},e.prototype.showOriginalGeometry=function(){this.addVectorLayer(this.datasetId)},e.prototype.hideOriginalGeometry=function(){this.removeVectorLayer(this.datasetId)},e.prototype.addLayers=function(){var e=this;this.map.addLayer({type:"raster",id:"satellite-map",source:"mapbox-satellite"}),this.vectorLayers.forEach((function(t){e.addVectorLayer(t)}))},e.prototype.handleBasemapStyle=function(e){"streets-v11"===e.id?this.map.setStyle(e.url):"satellite-v9"===e.id&&this.map.setStyle({version:8,name:e.name,metadata:{"mapbox:autocomposite":!0},sources:{"mapbox-satellite":{type:"raster",url:e.url,tileSize:256}},sprite:e.sprite,glyphs:window.location.protocol+"//"+window.location.host+acp+"/glyphs/{fontstack}/{range}.pbf",layers:[{id:e.id,type:"raster",source:"mapbox-satellite"}]})},e.prototype.onContextLayerChange=function(e){e.active?this.addVectorLayer(e.oid):this.removeVectorLayer(e.oid)},e.prototype.removeVectorLayer=function(e){var t=this.vectorLayers.indexOf(e);-1!==t&&(this.map.removeLayer(e+"-points"),this.map.removeLayer(e+"-polygon"),this.map.removeLayer(e+"-points-selected"),this.map.removeLayer(e+"-polygon-selected"),this.map.removeLayer(e+"-label"),this.map.removeSource(e),this.vectorLayers.splice(t,1))},e.prototype.addVectorLayer=function(e){if(-1===this.vectorLayers.indexOf(e)){var t=e!==this.datasetId?this.datasetId+"-points":null,n=window.location.protocol,r=window.location.host;this.map.addSource(e,{type:"vector",tiles:[n+"//"+r+acp+"/master-list/tile?x={x}&y={y}&z={z}&config="+encodeURIComponent(JSON.stringify({oid:e}))]}),this.map.addLayer({id:e+"-points",type:"circle",source:e,"source-layer":"context",paint:{"circle-radius":10,"circle-color":"#80cdc1","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["match",["geometry-type"],["Point","MultiPont"],!0,!1]]},t),this.map.addLayer({id:e+"-polygon",type:"fill",source:e,"source-layer":"context",layout:{},paint:{"fill-color":"#80cdc1","fill-opacity":.8,"fill-outline-color":"black"},filter:["all",["match",["geometry-type"],["Polygon","MultiPolygon"],!0,!1]]},t),e===this.datasetId&&(this.map.addLayer({id:e+"-points-selected",type:"circle",source:e,"source-layer":"context",paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["==",["get","code"],null!=this.code?this.code:""],["match",["geometry-type"],["Point","MultiPont"],!0,!1]]},t),this.map.addLayer({id:e+"-polygon-selected",type:"fill",source:e,"source-layer":"context",layout:{},paint:{"fill-color":"#800000","fill-opacity":.8,"fill-outline-color":"black"},filter:["all",["==",["get","code"],null!=this.code?this.code:""],["match",["geometry-type"],["Polygon","MultiPolygon"],!0,!1]]},t)),this.map.addLayer({id:e+"-label",source:e,"source-layer":"context",type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":["case",["has","displayLabel_"+navigator.language.toLowerCase()],["coalesce",["string",["get","displayLabel_"+navigator.language.toLowerCase()]],["string",["get","displayLabel"]]],["string",["get","displayLabel"]]],"text-font":["NotoSansRegular"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}},t),this.vectorLayers.push(e)}},e.prototype.onFeatureChange=function(){this.hideOriginalGeometry(),this.showOriginalGeometry()},e.prototype.handleMapClickEvent=function(e){if(!this.isEdit&&null!=e.features&&e.features.length>0){var t=e.features[0];null!=t.properties.code&&this.code!==t.properties.code&&(this.code=t.properties.code,this.map.setFilter(this.datasetId+"-points-selected",["all",["==",["get","code"],null!=this.code?this.code:""],["match",["geometry-type"],["Point","MultiPont"],!0,!1]]),this.map.setFilter(this.datasetId+"-polygon-selected",["all",["==",["get","code"],null!=this.code?this.code:""],["match",["geometry-type"],["Polygon","MultiPolygon"],!0,!1]]))}},e.prototype.onNewGeoObject=function(){this.code="__NEW__"},e.prototype.formatDate=function(e){return this.dateService.formatDateForDisplay(e)},e.prototype.error=function(e){this.bsModalRef=o.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.MapService),a.ɵɵdirectiveInject(l.GeometryService),a.ɵɵdirectiveInject(l.RegistryService),a.ɵɵdirectiveInject(s.BsModalService),a.ɵɵdirectiveInject(c.ActivatedRoute),a.ɵɵdirectiveInject(d.AuthService),a.ɵɵdirectiveInject(d.LocalizationService),a.ɵɵdirectiveInject(p.DateService),a.ɵɵdirectiveInject(c.Router))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["dataset-location-manager"]],decls:12,vars:9,consts:[["id","app-container",1,"container-fluid"],[1,"row"],["id","navigator-left-sidebar","class","col-md-5 lw-inner-col","style","height: calc(100vh - 145px);overflow-y: auto;",4,"ngIf"],["id","site-explorer-map",3,"ngClass"],[1,"base-layer-panel"],[3,"filter","layerChange","baseLayerChange"],["class","layer-toggle","style","margin-top:10px;",3,"mouseenter","mouseleave",4,"ngIf"],["id","dataset-map",1,"map-view-port"],["id","navigator-left-sidebar",1,"col-md-5","lw-inner-col",2,"height","calc(100vh - 145px)","overflow-y","auto"],[1,"col-md-12"],["id","attributes-header"],[4,"ngIf"],["key","cgr.validity.valid.on.label"],[3,"type","code","forDate","datasetId","readOnly","featureChange","modeChange","panelCancel","panelSubmit"],[1,"layer-toggle",2,"margin-top","10px",3,"mouseenter","mouseleave"],["class","fa fa-plus-square","style","vertical-align: middle; font-size: 18px; color: black;",4,"ngIf"],["style","margin-top:10px;",4,"ngIf"],[1,"fa","fa-plus-square",2,"vertical-align","middle","font-size","18px","color","black"],[2,"margin-top","10px"],["role","button",3,"click"],[1,"btn","btn-primary"],["key","masterlist.newGeoObject"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"div"),a.ɵɵelement(1,"cgr-header"),a.ɵɵelement(2,"loading-bar"),a.ɵɵelementStart(3,"div",0),a.ɵɵelementStart(4,"div",1),a.ɵɵtemplate(5,b,9,7,"div",2),a.ɵɵelementStart(6,"div",3),a.ɵɵelementStart(7,"div",1),a.ɵɵelementStart(8,"article",4),a.ɵɵelementStart(9,"layer-panel",5),a.ɵɵlistener("layerChange",(function(e){return t.onContextLayerChange(e)}))("baseLayerChange",(function(e){return t.handleBasemapStyle(e)})),a.ɵɵelementEnd(),a.ɵɵtemplate(10,E,3,2,"div",6),a.ɵɵelementEnd(),a.ɵɵelement(11,"div",7),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(5),a.ɵɵproperty("ngIf",null!=t.type&&null!=t.code),a.ɵɵadvance(1),a.ɵɵproperty("ngClass",a.ɵɵpureFunction2(4,x,null!=t.code,null==t.code)),a.ɵɵadvance(3),a.ɵɵproperty("filter",a.ɵɵpureFunction1(7,O,t.datasetId)),a.ɵɵadvance(1),a.ɵɵproperty("ngIf",!t.editOnly))},directives:[m.CgrHeaderComponent,u.LoadingBarComponent,g.NgIf,g.NgClass,h.LayerPanelComponent,f.LocalizeComponent,y.FeaturePanelComponent],styles:["#hierarchy-tree-container[_ngcontent-%COMP%] {\n\theight: calc(100vh - 429px);\n    overflow-y: auto;\n}\n\n.location-management-widget-section[_ngcontent-%COMP%] {\n\tmargin: 5px 0;\n}\n.location-management-widget-section[_ngcontent-%COMP%]    > select[_ngcontent-%COMP%] {\n\tfloat: none !important;\n}\n\n.list-group-item[_ngcontent-%COMP%] {\n\tborder: none;\n\tborder-bottom: 1px solid #ddd;\n\tmargin-bottom: 0;\n}\n.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n\n.breadcrumb[_ngcontent-%COMP%]{\n\tpadding: 10px 0;\n\tbackground-color: white;\n\tmargin:0;\n}\n\n.layer-toggle[_ngcontent-%COMP%] {\n\tcursor: pointer; \n\tbackground: #fff; \n\tpadding: 8px; \n\tborder-radius: 4px;\n\twidth: fit-content;\n}\n\n.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\n\theight: auto;\n}\n.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\n\tmargin-left: 5px;\n}\n\n#attributes-header[_ngcontent-%COMP%] {\n\tbackground: #adadad;\n  padding: 2px 15px;\n  margin: 10px 0;\n  color: white;\n  border-radius: 3px;\n}"]}),e}();t.DatasetLocationManagerComponent=I,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(I,[{type:r.Component,args:[{selector:"dataset-location-manager",templateUrl:"./dataset-location-manager.component.html",styleUrls:["./dataset-location-manager.css"]}]}],(function(){return[{type:l.MapService},{type:l.GeometryService},{type:l.RegistryService},{type:s.BsModalService},{type:c.ActivatedRoute},{type:d.AuthService},{type:d.LocalizationService},{type:p.DateService},{type:c.Router}]}),null)},614:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SvgHierarchyNode=void 0;var r=n(378),i=n(547),o=n(575),a=n(532),l=n(111),s=function(){function e(e,t,n,r,i,o,a){this.localizeService=i,this.modalService=o,this.authService=a,this.hierarchyComponent=e,this.svgHierarchyType=t,this.geoObjectType=n,this.treeNode=r}return e.prototype.getCode=function(){return this.geoObjectType.code},e.prototype.setPos=function(e,t,n){var i=this.getBbox();r.select('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]').classed("dragging",n).attr("x",e).attr("y",t),r.select('.g-hierarchy[data-primary=true] .svg-got-header-rect[data-gotCode="'+this.getCode()+'"]').classed("dragging",n).attr("x",e).attr("y",t-o.SvgHierarchyType.gotRectH/2+2),r.select('.g-hierarchy[data-primary=true] .svg-got-label-text[data-gotCode="'+this.getCode()+'"]').classed("dragging",n).attr("x",e+5).attr("y",t+1),r.select('.g-hierarchy[data-primary=true] .svg-got-relatedhiers-button[data-gotCode="'+this.getCode()+'"]').classed("dragging",n).attr("x",e+i.width-20).attr("y",t+17);var a=r.select('.g-hierarchy[data-primary=true] .hierarchy-inherit-button[data-gotCode="'+this.getCode()+'"]').node();if(null!=a){var l=e+i.width-60,s=t+i.height-24,c=a.getBBox();r.select('.g-hierarchy[data-primary=true] .hierarchy-inherit-button[data-gotCode="'+this.getCode()+'"]').classed("dragging",n).attr("transform","translate("+(l-c.x)+" "+(s-c.y)+")")}var d=r.select('.g-hierarchy[data-primary=true] .hierarchy-uninherit-button[data-gotCode="'+this.getCode()+'"]').node();if(null!=d){l=e+i.width-71,s=t+i.height-24;var p=d.getBBox();r.select('.g-hierarchy[data-primary=true] .hierarchy-uninherit-button[data-gotCode="'+this.getCode()+'"]').classed("dragging",n).attr("transform","translate("+(l-p.x)+" "+(s-p.y)+")")}},e.prototype.getPos=function(){var e=r.select('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]');return{x:parseInt(e.attr("x")),y:parseInt(e.attr("y"))}},e.prototype.getBbox=function(){var e=r.select('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]');return{x:parseInt(e.attr("x")),y:parseInt(e.attr("y"))-3,width:parseInt(e.attr("width")),height:parseInt(e.attr("height"))+3}},e.prototype.getTreeNode=function(){return this.treeNode},e.prototype.hideRelatedHierarchy=function(){var e=r.select('.g-hierarchy[data-primary="false"]');if(null!=e.node())return e.remove(),this.hierarchyComponent.calculateSvgViewBox(),e.attr("data-code")},e.prototype.renderRelatedHierarchiesMenu=function(){var e=this,t=this,n=r.select(".g-context-menu");if(null==n.node()){var a=r.select("#svg").append("g").classed("g-context-menu",!0),l=this.svgHierarchyType.getRelatedHierarchies(this.getCode()),s=this.authService.isSRA()||this.authService.isOrganizationRA(this.svgHierarchyType.hierarchyType.organizationCode),c=this.getBbox(),d=c.x+c.width-5,p=c.y+c.height/2-8,m=this.hierarchyComponent.localize("hierarchy.content.relatedHierarchies"),u=this.hierarchyComponent.localize("hierarchy.content.actionsTitle"),g=this.hierarchyComponent.localize("hierarchy.content.removeFromHierarchy"),h=this.hierarchyComponent.localize("hierarchy.content.noRelatedHierarchies"),f=this.hierarchyComponent.localize("hierarchy.content.hideRelatedHierarchy"),y=this.hierarchyComponent.localize("hierarchy.content.uninherit"),v=this.hierarchyComponent.localize("hierarchy.content.inherit"),b=null!=r.select('.g-hierarchy[data-primary="false"]').node(),S=s?b?2:1:0,C=i.calculateTextWidth(m,9),E=i.calculateTextWidth(g,8);if(C=E>C?E:C,b){var x=i.calculateTextWidth(f,8);C=x>C?x:C}if(null!=this.treeNode.parent&&null!=this.treeNode.parent.data.inheritedHierarchyCode&&""!=this.treeNode.parent.data.inheritedHierarchyCode){var O=i.calculateTextWidth(y,8);C=O>C?O:C,S++}else{if(null!=(k=r.select('.g-hierarchy[data-primary="false"]')).node()){var I=k.attr("data-code"),w=this.hierarchyComponent.findHierarchyByCode(I),M=null!=new o.SvgHierarchyType(this.hierarchyComponent,r.select("#svg"),w,!0,this.localizeService,this.modalService,this.authService).getNodeByCode(this.getCode()).getTreeNode().parent;if(null==this.treeNode.parent&&M){var T=i.calculateTextWidth(v,8);C=T>C?T:C,S++}}}if(l.length>0)l.forEach((function(t){var n=e.hierarchyComponent.findHierarchyByCode(t),r=n.label.localizedValue;null!=e.treeNode.parent&&e.treeNode.parent.data.inheritedHierarchyCode===n.code&&(r=r+" ("+e.hierarchyComponent.localize("hierarchy.content.inherited")+")");var o=i.calculateTextWidth(r,8);o>C&&(C=o)}));else{var j=i.calculateTextWidth(h,8);C=j>C?j:C}C+=10;var k,R=l.length>0?S+2:S+3;if(a.append("rect").classed("contextmenu-relatedhiers-background",!0).attr("x",d).attr("y",p).attr("rx",5).attr("width",C).attr("height",20*(l.length+R)).attr("fill","white").attr("stroke-width",.5).attr("stroke","#aaaaaa"),a.append("text").classed("contextmenu-relatedhiers-title",!0).attr("x",d+5).attr("y",p+10+4.5).attr("font-size",9).attr("font-family","sans-serif").attr("font-weight","bold").text(m),p+=20,a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",d).attr("y1",p).attr("x2",d+C).attr("y2",p).attr("stroke","#aaaaaa").attr("stroke-width",.5),l.length>0)for(var z=function(e){var n=l[e],r=P.hierarchyComponent.findHierarchyByCode(n),i=r.label.localizedValue;null!=P.treeNode.parent&&P.treeNode.parent.data.inheritedHierarchyCode===r.code&&(i=i+" ("+P.hierarchyComponent.localize("hierarchy.content.inherited")+")"),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("data-hierCode",n).attr("x",d+5).attr("y",p+10+4).attr("font-size",8).attr("font-family","sans-serif").text(i).style("cursor","pointer").on("click",(function(e,n){t.renderSecondaryHierarchy(r)})),p+=20,e<l.length&&a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("data-hierCode",n).attr("x1",d+5).attr("y1",p).attr("x2",d+C-5).attr("y2",p).attr("stroke","#e4e4e4").attr("stroke-width",.5)},P=this,D=0;D<l.length;++D)z(D);else a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",d+5).attr("y",p+10+4).attr("font-size",8).attr("font-family","sans-serif").text(h),p+=20,a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",d+5).attr("y1",p).attr("x2",d+C-5).attr("y2",p).attr("stroke","#e4e4e4").attr("stroke-width",.5);if(s)if(a.append("text").classed("contextmenu-relatedhiers-title",!0).attr("x",d+5).attr("y",p+10+4.5).attr("font-size",9).attr("font-family","sans-serif").attr("font-weight","bold").text(u),p+=20,a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",d).attr("y1",p).attr("x2",d+C).attr("y2",p).attr("stroke","#aaaaaa").attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("data-remove","REPLACE---gotCode").attr("x",d+5).attr("y",p+10+4).attr("font-size",8).attr("font-family","sans-serif").text(g).style("cursor","pointer").on("click",(function(e,n){t.removeGotFromHierarchy()})),p+=20,null!=this.treeNode.parent&&null!=this.treeNode.parent.data.inheritedHierarchyCode&&""!=this.treeNode.parent.data.inheritedHierarchyCode)a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",d).attr("y1",p).attr("x2",d+C).attr("y2",p).attr("stroke","#aaaaaa").attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",d+5).attr("y",p+10+4).attr("font-size",8).attr("font-family","sans-serif").text(y).style("cursor","pointer").on("click",(function(e,n){t.onClickUninheritHierarchy()})),p+=20;else if(null!=(k=r.select('.g-hierarchy[data-primary="false"]')).node()){I=k.attr("data-code");var A=this.hierarchyComponent.findHierarchyByCode(I);M=null!=new o.SvgHierarchyType(this.hierarchyComponent,r.select("#svg"),A,!0,this.localizeService,this.modalService,this.authService).getNodeByCode(this.getCode()).getTreeNode().parent;null==this.treeNode.parent&&M&&(a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",d).attr("y1",p).attr("x2",d+C).attr("y2",p).attr("stroke","#aaaaaa").attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",d+5).attr("y",p+10+4).attr("font-size",8).attr("font-family","sans-serif").text(v).style("cursor","pointer").on("click",(function(e,n){t.onClickInheritHierarchy(A)})),p+=20)}b&&(a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",d).attr("y1",p).attr("x2",d+C).attr("y2",p).attr("stroke","#aaaaaa").attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",d+5).attr("y",p+10+4).attr("font-size",8).attr("font-family","sans-serif").text(f).style("cursor","pointer").on("click",(function(e,n){t.hideRelatedHierarchy();var i=r.select(".g-context-menu");null!=i.node()&&i.remove(),r.select(".g-hierarchy-got-connector").remove()}))),this.hierarchyComponent.calculateSvgViewBox()}else n.remove()},e.prototype.removeGotFromHierarchy=function(){var e=this,t=this.hierarchyComponent.primarySvgHierarchy.getNodeByCode(this.geoObjectType.code),n=this.hierarchyComponent.findGeoObjectTypeByCode(t.getCode());this.bsModalRef=this.modalService.show(l.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});var r=this.localizeService.decode("confirm.modal.verify.remove.hierarchy");r=r.replace("{label}",n.label.localizedValue),this.bsModalRef.content.message=r,this.bsModalRef.content.data=n.code,this.bsModalRef.content.onConfirm.subscribe((function(n){var r=t.getTreeNode(),i=null;i=null==r.parent||null!=r.parent.data.inheritedHierarchyCode?"ROOT":r.parent.data.geoObjectType,e.hierarchyComponent.removeFromHierarchy(i,t.getCode(),(function(e){console.log(e)}))}))},e.prototype.renderSecondaryHierarchy=function(e){r.select(".g-context-menu").remove(),r.select(".g-hierarchy-got-connector").remove();var t=this.getBbox(),n=r.select("#svg");if(this.hideRelatedHierarchy()!==e.code){var i=r.select(".g-hierarchy[data-primary=true]").node().getBBox();new o.SvgHierarchyType(this.hierarchyComponent,n,e,!1,this.localizeService,this.modalService,this.authService).render();var l=r.select('.g-hierarchy[data-primary="false"]'),s=r.select('.g-hierarchy[data-primary="false"]').node().getBBox(),c=i.width+40+(i.x-s.x);l.attr("transform","translate("+c+" 0)");var d=r.select('.g-hierarchy[data-primary=false] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]'),p={x:parseInt(d.attr("x")),y:parseInt(d.attr("y"))-3,width:parseInt(d.attr("width")),height:parseInt(d.attr("height"))+3};p.x=p.x+c,r.select(".g-hierarchy-got-connector").remove();var m=r.select("#svg").append("g").classed("g-hierarchy-got-connector",!0);m.append("path").classed("hierarchy-got-connector",!0).attr("fill","none").attr("stroke","#555").attr("stroke-opacity",.4).attr("stroke-dasharray","5,5").attr("stroke-width",1.5).attr("d","M"+(t.x+t.width)+","+(t.y+t.height/2)+"H"+((p.x-(t.x+t.width))/2+t.x+t.width)+"V"+(p.y+p.height/2)+"H"+p.x);var u=10,g=7,h=m.append("g").classed("g-hierarchy-got-connector-arrow",!0);h.append("rect").classed("hierarchy-got-connector-arrow-rect",!0).attr("x",t.x+t.width-g/2).attr("y",t.y+t.height/2-u/2).attr("width",g).attr("height",u).attr("fill",a.RELATED_NODE_BANNER_COLOR),h.append("path").classed("hierarchy-got-connector-arrow-path",!0).attr("fill","none").attr("stroke","white").attr("stroke-width",1.5).attr("d","M"+(t.x+t.width-g/2+2*g/3)+","+(t.y+t.height/2-u/2+2*u/3)+"L"+(t.x+t.width+g/2-2*g/3)+","+(t.y+t.height/2)+"L"+(t.x+t.width-g/2+2*g/3)+","+(t.y+t.height/2-u/2+u/3)),this.hierarchyComponent.calculateSvgViewBox()}},e.prototype.onClickInheritHierarchy=function(e){this.hierarchyComponent.handleInheritHierarchy(this.svgHierarchyType.getCode(),e.code,this.getCode())},e.prototype.onClickUninheritHierarchy=function(){this.hierarchyComponent.handleUninheritHierarchy(this.svgHierarchyType.getCode(),this.getCode())},e}();t.SvgHierarchyNode=s},615:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddChildToHierarchyModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(111),a=(n(518),n(0)),l=n(518),s=n(30),c=n(22),d=n(1),p=n(68);function m(e,t){if(1&e&&(a.ɵɵelementStart(0,"div",13),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=a.ɵɵnextContext(2);a.ɵɵadvance(1),a.ɵɵtextInterpolate(n.message)}}function u(e,t){if(1&e&&(a.ɵɵelementStart(0,"option",18),a.ɵɵtext(1),a.ɵɵelementEnd()),2&e){var n=t.$implicit;a.ɵɵpropertyInterpolate("value",n.code),a.ɵɵadvance(1),a.ɵɵtextInterpolate1(" ",n.label.localizedValue," ")}}function g(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"select",14),a.ɵɵlistener("change",(function(e){return a.ɵɵrestoreView(n),a.ɵɵnextContext(2).onSelect(e.target.value)})),a.ɵɵelementStart(1,"option",15),a.ɵɵtext(2,"-- "),a.ɵɵelement(3,"localize",16),a.ɵɵtext(4," --"),a.ɵɵelementEnd(),a.ɵɵelement(5,"option"),a.ɵɵtemplate(6,u,2,2,"option",17),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext(2);a.ɵɵadvance(1),a.ɵɵproperty("value",r.selectUndefinedOptionValue),a.ɵɵadvance(5),a.ɵɵproperty("ngForOf",r.allGeoObjectTypes)}}function h(e,t){if(1&e){var n=a.ɵɵgetCurrentView();a.ɵɵelementStart(0,"div",2),a.ɵɵtemplate(1,m,2,1,"div",3),a.ɵɵelementStart(2,"div",4),a.ɵɵelementStart(3,"h1"),a.ɵɵelement(4,"localize",5),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(5,"fieldset"),a.ɵɵelementStart(6,"div",6),a.ɵɵtemplate(7,g,7,2,"select",7),a.ɵɵelementEnd(),a.ɵɵelementStart(8,"div",8),a.ɵɵelementStart(9,"button",9),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().bsModalRef.hide()})),a.ɵɵelementStart(10,"span"),a.ɵɵelement(11,"localize",10),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementStart(12,"button",11),a.ɵɵlistener("click",(function(){return a.ɵɵrestoreView(n),a.ɵɵnextContext().handleOnSubmit()})),a.ɵɵelementStart(13,"span"),a.ɵɵelement(14,"localize",12),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd(),a.ɵɵelementEnd()}if(2&e){var r=a.ɵɵnextContext();a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=r.message),a.ɵɵadvance(6),a.ɵɵproperty("ngIf",r.allGeoObjectTypes)}}var f=function(){function e(e,t){this.hierarchyService=e,this.bsModalRef=t,this.toRoot=!1,this.message=null}return e.prototype.ngOnInit=function(){this.onNodeChange=new i.Subject},e.prototype.onSelect=function(e){var t=this;this.allGeoObjectTypes.forEach((function(n){n.code===e&&(t.selectedGeoObjectType=n)}))},e.prototype.handleOnSubmit=function(){var e=this;this.message=null;var t=this.toRoot?"ROOT":this.parent.data.geoObjectType;this.hierarchyService.addChildToHierarchy(this.hierarchyType.code,t,this.selectedGeoObjectType.code).then((function(t){e.onNodeChange.next(t),e.bsModalRef.hide()})).catch((function(t){e.error(t)}))},e.prototype.error=function(e){this.message=o.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(a.ɵɵdirectiveInject(l.HierarchyService),a.ɵɵdirectiveInject(s.BsModalRef))},e.ɵcmp=a.ɵɵdefineComponent({type:e,selectors:[["add-child-to-hierarchy-modal"]],decls:2,vars:1,consts:[[1,"modal-form"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","hierarchy.management.button.addRelationship"],[1,"form-group"],[3,"change",4,"ngIf"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit","role","button","aria-disabled","false",1,"btn","btn-primary",3,"click"],["key","modal.button.ok"],["role","alert",1,"alert","alert-danger"],[3,"change"],["disabled","","hidden","",3,"value"],["key","hierarchy.management.create.child.option.label.selectType"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(a.ɵɵelementStart(0,"form",0),a.ɵɵtemplate(1,h,15,2,"div",1),a.ɵɵelementEnd()),2&e&&(a.ɵɵadvance(1),a.ɵɵproperty("ngIf",null!=t.parent))},directives:[c.ɵangular_packages_forms_forms_ba,c.NgControlStatusGroup,c.NgForm,d.NgIf,p.LocalizeComponent,c.NgSelectOption,c.ɵangular_packages_forms_forms_z,d.NgForOf],encapsulation:2}),e}();t.AddChildToHierarchyModalComponent=f,("undefined"==typeof ngDevMode||ngDevMode)&&a.ɵsetClassMetadata(f,[{type:r.Component,args:[{selector:"add-child-to-hierarchy-modal",templateUrl:"./add-child-to-hierarchy-modal.component.html",styleUrls:[]}]}],(function(){return[{type:l.HierarchyService},{type:s.BsModalRef}]}),null)},616:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManageAttributesModalComponent=void 0;var r=n(0),i=(n(30),n(31)),o=n(260),a=n(111),l=(n(16),n(203),n(258)),s=(n(518),n(0)),c=n(30),d=n(16),p=n(518),m=n(1),u=n(22),g=n(68),h=n(33),f=n(113);function y(e,t){if(1&e&&(s.ɵɵelementStart(0,"div",3),s.ɵɵtext(1),s.ɵɵelementEnd()),2&e){var n=s.ɵɵnextContext();s.ɵɵadvance(1),s.ɵɵtextInterpolate(n.message)}}function v(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"a",29),s.ɵɵlistener("click",(function(e){s.ɵɵrestoreView(n);var t=s.ɵɵnextContext().$implicit;return s.ɵɵnextContext(2).editAttribute(t,e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelementEnd()}2&e&&s.ɵɵproperty("title",s.ɵɵpipeBind1(1,1,"modal.button.edit"))}function b(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"a",30),s.ɵɵlistener("click",(function(e){s.ɵɵrestoreView(n);var t=s.ɵɵnextContext().$implicit;return s.ɵɵnextContext(2).removeAttributeType(t,e)})),s.ɵɵpipe(1,"localize"),s.ɵɵelementEnd()}2&e&&s.ɵɵproperty("title",s.ɵɵpipeBind1(1,1,"modal.button.remove"))}function S(e,t){if(1&e&&(s.ɵɵelementStart(0,"tr"),s.ɵɵelementStart(1,"td"),s.ɵɵtext(2),s.ɵɵelementEnd(),s.ɵɵelementStart(3,"td",26),s.ɵɵtemplate(4,v,2,3,"a",27),s.ɵɵtemplate(5,b,2,3,"a",28),s.ɵɵelementEnd(),s.ɵɵelementEnd()),2&e){var n=t.$implicit;s.ɵɵadvance(2),s.ɵɵtextInterpolate(n.label.localizedValue),s.ɵɵadvance(2),s.ɵɵproperty("ngIf",!n.isDefault&&"keyName"!==n.code),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",!n.isDefault&&"keyName"!==n.code)}}function C(e,t){if(1&e){var n=s.ɵɵgetCurrentView();s.ɵɵelementStart(0,"form",4,5),s.ɵɵlistener("ngSubmit",(function(){return s.ɵɵrestoreView(n),s.ɵɵreference(1).valid})),s.ɵɵelementStart(2,"div",6),s.ɵɵelementStart(3,"h1"),s.ɵɵelement(4,"localize",7),s.ɵɵtext(5),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(6,"fieldset"),s.ɵɵelementStart(7,"div"),s.ɵɵelementStart(8,"div",8),s.ɵɵelementStart(9,"label"),s.ɵɵelement(10,"localize",9),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(11,"div",10),s.ɵɵelementStart(12,"div",11),s.ɵɵelementStart(13,"table",12),s.ɵɵelementStart(14,"thead"),s.ɵɵelementStart(15,"tr"),s.ɵɵelementStart(16,"th"),s.ɵɵelement(17,"localize",13),s.ɵɵelementEnd(),s.ɵɵelementStart(18,"th",14),s.ɵɵelement(19,"localize",15),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(20,"tbody"),s.ɵɵtemplate(21,S,6,3,"tr",16),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(22,"div",17),s.ɵɵelement(23,"div",8),s.ɵɵelementStart(24,"div",18),s.ɵɵelementStart(25,"i",19),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext().defineAttributeModal()})),s.ɵɵelement(26,"localize",20),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementStart(27,"div",21),s.ɵɵelementStart(28,"div",22),s.ɵɵelementStart(29,"div",23),s.ɵɵelementStart(30,"button",24),s.ɵɵlistener("click",(function(){return s.ɵɵrestoreView(n),s.ɵɵnextContext().close()})),s.ɵɵelement(31,"localize",25),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd(),s.ɵɵelementEnd()}if(2&e){var r=s.ɵɵnextContext();s.ɵɵadvance(5),s.ɵɵtextInterpolate1(" ",r.geoObjectType.label.localizedValue,""),s.ɵɵadvance(16),s.ɵɵproperty("ngForOf",r.geoObjectType.attributes)}}var E=function(){function e(e,t,n,i,o,a,s){this.bsModalRef=e,this.confirmBsModalRef=t,this.modalService=n,this.localizeService=i,this.modalStepIndicatorService=o,this.geoObjectTypeManagementService=a,this.registryService=s,this.attribute=null,this.geoObjectTypeChange=new r.EventEmitter,this.message=null,this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!0}]},this.modalState={state:l.GeoObjectTypeModalStates.manageAttributes,attribute:this.attribute,termOption:""}}return e.prototype.ngOnInit=function(){this.onDeleteAttribute=new i.Subject,this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)},e.prototype.ngOnDestroy=function(){this.onDeleteAttribute.unsubscribe()},e.prototype.defineAttributeModal=function(){this.geoObjectTypeManagementService.setModalState({state:l.GeoObjectTypeModalStates.defineAttribute,attribute:"",termOption:""})},e.prototype.editAttribute=function(e,t){this.geoObjectTypeManagementService.setModalState({state:l.GeoObjectTypeModalStates.editAttribute,attribute:e,termOption:""})},e.prototype.removeAttributeType=function(e,t){var n=this;this.confirmBsModalRef=this.modalService.show(a.ConfirmModalComponent,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.confirmBsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+"["+e.label.localizedValue+"]",this.confirmBsModalRef.content.data={attributeType:e,geoObjectType:this.geoObjectType},this.confirmBsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.confirmBsModalRef.content.type=o.ModalTypes.danger,this.confirmBsModalRef.content.onConfirm.subscribe((function(e){n.deleteAttributeType(e.geoObjectType.code,e.attributeType)}))},e.prototype.deleteAttributeType=function(e,t){var n=this;this.registryService.deleteAttributeType(e,t.code).then((function(e){n.onDeleteAttribute.next(e),e&&n.geoObjectType.attributes.splice(n.geoObjectType.attributes.indexOf(t),1),n.geoObjectTypeChange.emit(n.geoObjectType)})).catch((function(e){n.error(e)}))},e.prototype.close=function(){this.geoObjectTypeManagementService.setModalState({state:l.GeoObjectTypeModalStates.manageGeoObjectType,attribute:this.attribute,termOption:""})},e.prototype.error=function(e){this.message=a.ErrorHandler.getMessageFromError(e)},e.ɵfac=function(t){return new(t||e)(s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(c.BsModalRef),s.ɵɵdirectiveInject(c.BsModalService),s.ɵɵdirectiveInject(d.LocalizationService),s.ɵɵdirectiveInject(d.ModalStepIndicatorService),s.ɵɵdirectiveInject(p.GeoObjectTypeManagementService),s.ɵɵdirectiveInject(p.RegistryService))},e.ɵcmp=s.ɵɵdefineComponent({type:e,selectors:[["manage-attributes-modal"]],inputs:{geoObjectType:"geoObjectType",attribute:"attribute"},outputs:{geoObjectTypeChange:"geoObjectTypeChange"},decls:3,vars:2,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","modal-form",3,"ngSubmit",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"heading"],["key","hierarchy.management.manage.attributes.title"],[1,"label-holder"],["key","hierarchy.management.manage.attributes.label.displayAttributes"],[1,"holder","dataset-attr-holder"],[1,"table-responsive"],[1,"table"],["key","data.property.label.label"],[1,"button-column-header"],["key","data.property.label.actions"],[4,"ngFor","ngForOf"],[1,"row-holder"],[1,"holder"],["aria-hidden","true",1,"fa","fa-plus","clickable",2,"font-size","20px","margin","10px 0 10px 0",3,"click"],["key","modal.button.add"],[1,"row"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.back"],[1,"button-column"],["class","fa fa-pencil ico-edit",3,"routerLink","title","click",4,"ngIf"],["class","fa fa-trash-o ico-remove",3,"routerLink","title","click",4,"ngIf"],[1,"fa","fa-pencil","ico-edit",3,"routerLink","title","click"],[1,"fa","fa-trash-o","ico-remove",3,"routerLink","title","click"]],template:function(e,t){1&e&&(s.ɵɵelementStart(0,"div",0),s.ɵɵtemplate(1,y,2,1,"div",1),s.ɵɵtemplate(2,C,32,2,"form",2),s.ɵɵelementEnd()),2&e&&(s.ɵɵadvance(1),s.ɵɵproperty("ngIf",null!=t.message),s.ɵɵadvance(1),s.ɵɵproperty("ngIf",t.geoObjectType))},directives:[m.NgIf,u.ɵangular_packages_forms_forms_ba,u.NgControlStatusGroup,u.NgForm,g.LocalizeComponent,m.NgForOf,h.RouterLinkWithHref],pipes:[f.LocalizePipe],styles:["li.list-group-item[_ngcontent-%COMP%] {\n    font-size: inherit;\n    color: grey;\n}\n\n.button-column[_ngcontent-%COMP%] {\n    text-align: right;\n}\n.button-column[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%] {\n    font-size: 25px;\n    \n}\n\n\n.button-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\n    font-size: inherit;\n}\n\n\nth.button-column-header[_ngcontent-%COMP%]{\n    text-align: right;\n}"]}),e}();t.ManageAttributesModalComponent=E,("undefined"==typeof ngDevMode||ngDevMode)&&s.ɵsetClassMetadata(E,[{type:r.Component,args:[{selector:"manage-attributes-modal",templateUrl:"./manage-attributes-modal.component.html",styleUrls:["./manage-attributes-modal.css"]}]}],(function(){return[{type:c.BsModalRef},{type:c.BsModalRef},{type:c.BsModalService},{type:d.LocalizationService},{type:d.ModalStepIndicatorService},{type:p.GeoObjectTypeManagementService},{type:p.RegistryService}]}),{geoObjectType:[{type:r.Input}],attribute:[{type:r.Input}],geoObjectTypeChange:[{type:r.Output}]})},617:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeRequestChangeOverTimeAttributeEditor=void 0;var r=n(258),i=n(520),o=n(203),a=n(585),l=n(618),s=n(377),c=n(518),d=function(){function e(e,t,n){this.changeRequestEditor=e,this.attribute=t,this.hierarchy=n,this.getEditAction(),this.editors=this.generateEditors()}return e.prototype.getEditAction=function(){if(null==this.editAction){var e=i.ChangeRequest.getActionsForAttribute(this.changeRequestEditor.changeRequest,this.attribute.code,null==this.hierarchy?null:this.hierarchy.code);0===e.length?(this.editAction=new i.UpdateAttributeOverTimeAction(this.attribute.code),"_PARENT_"===this.attribute.code&&(this.editAction.attributeDiff.hierarchyCode=this.hierarchy.code)):this.editAction=e[e.length-1]}return this.editAction},e.prototype.onChange=function(){var e=this,t=this.hasChanges(),n=this.changeRequestEditor.changeRequest.actions.findIndex((function(t){return e.editAction===t}));-1===n||t?-1===n&&t&&this.changeRequestEditor.changeRequest.actions.push(this.editAction):this.changeRequestEditor.changeRequest.actions.splice(n,1),this.validate()},e.prototype.hasChanges=function(){var e=!0;this.editAction.actionType===r.ActionTypes.UPDATEATTRIBUTETACTION&&(0===this.editAction.attributeDiff.valuesOverTime.length&&(e=!1));return e},e.prototype.isValid=function(){return this._isValid},e.prototype.validate=function(e){void 0===e&&(e=!1);var t=this.validateEditors(),n=this.changeRequestEditor.dateService.checkRanges(this.attribute,this.editors),r=!1;if("exists"!==this.attribute.code){var i=o.GeoObjectType.getAttribute(this.changeRequestEditor.geoObjectType,"exists"),a=this.changeRequestEditor.getEditorForAttribute(i).getEditors();r=this.changeRequestEditor.dateService.checkExistRanges(this.editors,a)}else e||this.changeRequestEditor.validate(!0);return this._isValid=t&&!n&&!r,this._isValid},e.prototype.validateEditors=function(){var e=!0;return this.editors.forEach((function(t){t.validate()||(e=!1)})),e},e.prototype.findExistingValueOverTimeByOid=function(e,t){if(this.changeRequestEditor.geoObject.attributes[t]){var n=this.changeRequestEditor.geoObject.attributes[t].values.findIndex((function(t){return t.oid===e}));if(-1!==n)return this.changeRequestEditor.geoObject.attributes[t].values[n]}return null},e.prototype.getEditors=function(e){return void 0===e&&(e=!0),this.editors.filter((function(t){return e||null!=t.diff}))},e.prototype.generateEditors=function(){var e=this,t=i.ChangeRequest.getActionsForAttribute(this.changeRequestEditor.changeRequest,this.attribute.code,null==this.hierarchy?null:this.hierarchy.code),n=[];if((null==this.changeRequestEditor.changeRequest||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type||"ACCEPTED"!==this.changeRequestEditor.changeRequest.approvalStatus&&"PARTIAL"!==this.changeRequestEditor.changeRequest.approvalStatus&&"REJECTED"!==this.changeRequestEditor.changeRequest.approvalStatus)&&("_PARENT_"===this.attribute.code?this.hierarchy.entries.forEach((function(t){var r=new l.HierarchyCREditor(e,e.attribute,e.editAction,t,e.hierarchy);n.push(r)})):this.changeRequestEditor.geoObject.attributes[this.attribute.code]&&this.changeRequestEditor.geoObject.attributes[this.attribute.code].values.forEach((function(t){var r=new a.ValueOverTimeCREditor(e,e.attribute,e.editAction);r.valueOverTime=t,n.push(r)}))),"UpdateGeoObject"===this.changeRequestEditor.changeRequest.type)for(var r=t.length,o=0;o<r;++o){t[o].attributeDiff.valuesOverTime.forEach((function(t){var r=n.findIndex((function(e){return e.oid===t.oid})),i=-1===r?null:n[r];null==i?((i="_PARENT_"===e.attribute.code?new l.HierarchyCREditor(e,e.attribute,e.editAction,null,e.hierarchy):new a.ValueOverTimeCREditor(e,e.attribute,e.editAction)).diff=t,n.push(i)):(i.diff=t,"_PARENT_"===e.attribute.code&&(i.hierarchyEntry.parents=t.parents))}))}return n},e.prototype.createNewVersion=function(){var e;if(e="_PARENT_"===this.attribute.code?new l.HierarchyCREditor(this,this.attribute,this.editAction,null,this.hierarchy):new a.ValueOverTimeCREditor(this,this.attribute,this.editAction),"CreateGeoObject"===this.changeRequestEditor.changeRequest.type)if("_PARENT_"===this.attribute.code)e.hierarchyEntry=e.createEmptyHierarchyEntry(),e.hierarchyOverTime.entries.push(e.hierarchyEntry);else{var t=new o.ValueOverTime;t.oid=s.v4(),this.editAction.geoObjectJson.attributes[this.attribute.code].values.push(t),e.valueOverTime=t}else e.constructNewDiff("CREATE");if("local"===this.attribute.type)e.value=this.changeRequestEditor.localizationService.create();else if("geometry"===this.attribute.type){var n=this.getEditors(!0);n.length>0?e.value=JSON.parse(JSON.stringify(n[n.length-1].value)):e.value=c.GeometryService.createEmptyGeometryValue(this.changeRequestEditor.geoObjectType.geometryType)}else if("term"===this.attribute.type){var r=o.GeoObjectType.getGeoObjectTypeTermAttributeOptions(this.changeRequestEditor.geoObjectType,this.attribute.code);r&&r.length>0&&(e.value=r[0].code)}else"_PARENT_"===this.attribute.code&&"UpdateGeoObject"===this.changeRequestEditor.changeRequest.type?e.hierarchyEntry=e.createEmptyHierarchyEntry():"_PARENT_"!==this.attribute.code&&(e.value=null);return this.editors.push(e),e},e.prototype.remove=function(e){if(null!=e.diff&&"CREATE"===e.diff.action||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type){var t=this.editors.findIndex((function(t){return t.oid===e.oid}));-1!==t&&this.editors.splice(t,1)}e.remove(),this.validate()},e}();t.ChangeRequestChangeOverTimeAttributeEditor=d},618:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.HierarchyCREditor=void 0;var o=n(585),a=n(203),l=n(520),s=n(377),c=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n,r)||this;return a.hierarchyEntry=i,a.hierarchyOverTime=o,null!=a.hierarchyEntry&&(a.hierarchyEntry.loading={}),a}return i(t,e),t.prototype.getGeoObjectTimeRangeStorage=function(){return this.hierarchyEntry},t.prototype.getValueFromGeoObjectForDiff=function(){var e=this.hierarchyEntry.parents[this.hierarchyOverTime.types[this.hierarchyOverTime.types.length-1].code].geoObject;return null==e?null:e.properties.type+"_~VST~_"+e.properties.code},t.prototype.validateUpdateReference=function(){},t.prototype.setParentValue=function(e,t){if(null==this.diff||"DELETE"!==this.diff.action){var n=null;if(null!=e&&(n=t[e.code].geoObject),"UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==this.hierarchyEntry)this.diff=new l.ValueOverTimeDiff,this.diff.oid=s.v4(),this.diff.action="CREATE",this.action.attributeDiff.hierarchyCode=this.hierarchyOverTime.code,this.action.attributeDiff.valuesOverTime.push(this.diff);else{var r=this.getLowestLevelFromHierarchyEntry(this.hierarchyEntry.parents).geoObject,i=null==r?null:r.properties.type+"_~VST~_"+r.properties.code;if(null==r&&null==n||null!=r&&null!=n&&r.properties.code===n.properties.code)return;this.diff=new l.ValueOverTimeDiff,this.diff.action="UPDATE",this.diff.oid=this.hierarchyEntry.oid,this.diff.oldValue=i,this.diff.oldParents=this.hierarchyEntry.parents,this.diff.oldStartDate=this.hierarchyEntry.startDate,this.diff.oldEndDate=this.hierarchyEntry.endDate,this.action.attributeDiff.hierarchyCode=this.hierarchyOverTime.code,this.action.attributeDiff.valuesOverTime.push(this.diff)}var o=null;null!=n&&(o=n.properties.type+"_~VST~_"+n.properties.code),o===this.diff.oldValue?delete this.diff.newValue:this.diff.newValue=o,this.diff.parents=t,this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(this.hierarchyEntry.parents=t);this.changeRequestAttributeEditor.onChange(),this.onChangeSubject.next("value")}},t.prototype.getLowestLevelFromHierarchyEntry=function(e){for(var t=this.hierarchyOverTime.types.length-1;t>=0;--t){var n=this.hierarchyOverTime.types[t];if(Object.prototype.hasOwnProperty.call(e,n.code)&&e[n.code].geoObject)return e[n.code]}return null},Object.defineProperty(t.prototype,"value",{get:function(){return null!=this.diff&&void 0!==this.diff.parents?this.diff:null!=this.hierarchyEntry?this.hierarchyEntry:null},set:function(e){throw new Error("Invoke setParentValue instead")},enumerable:!1,configurable:!0}),t.prototype.removeType=function(e){var t=JSON.parse(JSON.stringify(this.value.parents));t[e.code]={text:"",geoObject:null};for(var n=this.value,r=this.hierarchyOverTime.types.length-1;r>=0;--r){var i=this.hierarchyOverTime.types[r];if(Object.prototype.hasOwnProperty.call(n.parents,i.code)&&n.parents[i.code].geoObject)return void this.setParentValue(i,t)}this.setParentValue(null,t)},t.prototype.createEmptyHierarchyEntry=function(){var e=new a.HierarchyOverTimeEntry;if(e.loading={},e.oid=s.v4(),e.parents={},this.hierarchyOverTime)for(var t=0;t<this.hierarchyOverTime.types.length;t++){var n=this.hierarchyOverTime.types[t];e.parents[n.code]={text:"",geoObject:null},e.loading={}}return e},t.prototype.remove=function(){var e=this;if("UpdateAttributeAction"===this.action.actionType)if(null!=this.diff&&"CREATE"===this.diff.action){var t=this.action;(i=t.attributeDiff.valuesOverTime.findIndex((function(t){return t.oid===e.diff.oid})))>-1&&t.attributeDiff.valuesOverTime.splice(i,1)}else{if(null!=this.diff)return delete this.diff.newValue,delete this.diff.newStartDate,delete this.diff.newEndDate,this.removeEmptyDiff(),this.changeRequestAttributeEditor.onChange(),void this.onChangeSubject.next("value");if(null!=this.hierarchyEntry&&null==this.diff){var n=this.getLowestLevelFromHierarchyEntry(this.hierarchyEntry.parents).geoObject,r=null==n?null:n.properties.type+"_~VST~_"+n.properties.code;this.diff=new l.ValueOverTimeDiff,this.diff.action="DELETE",this.diff.oid=this.hierarchyEntry.oid,this.diff.oldValue=r,this.diff.oldStartDate=this.hierarchyEntry.startDate,this.diff.oldEndDate=this.hierarchyEntry.endDate,this.action.attributeDiff.valuesOverTime.push(this.diff),this.action.attributeDiff.hierarchyCode=this.hierarchyOverTime.code}}else if("CreateGeoObjectAction"===this.action.actionType){var i;-1!==(i=this.hierarchyOverTime.entries.findIndex((function(t){return t.oid===e.hierarchyEntry.oid})))&&this.hierarchyOverTime.entries.splice(i,1)}this.changeRequestAttributeEditor.onChange(),this.onChangeSubject.next("value")},t}(o.ValueOverTimeCREditor);t.HierarchyCREditor=c},619:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardAttributeCRModel=void 0;var r=n(520),i=n(258),o=function(){function e(e,t,n){this._isValid=!0,this.attribute=e,this.geoObject=t,this.changeRequest=n,this.initialize()}return e.prototype.initialize=function(){var e=this,t=this.changeRequest.actions;"CreateGeoObject"===this.changeRequest.type?t.length>0&&t[0].actionType===i.ActionTypes.CREATEGEOOBJECTACTION&&(this.editAction=t[0]):(t.forEach((function(t){if(t.actionType===i.ActionTypes.UPDATEATTRIBUTETACTION){var n=t;e.attribute.code===n.attributeName&&(e.editAction=t)}})),null==this.editAction&&(this.editAction=new r.UpdateAttributeAction(this.attribute.code)));for(var n=this.changeRequest.actions.length,o=0;o<n;++o){var a=t[o];if(a.actionType===i.ActionTypes.UPDATEATTRIBUTETACTION){var l=a;this.attribute.code===l.attributeName&&(this.diff=l.attributeDiff)}else a.actionType===i.ActionTypes.CREATEGEOOBJECTACTION||console.log("Unexpected action : "+a.actionType,a)}},e.prototype.hasChanges=function(){return null!=this.diff},e.prototype.isValid=function(){return this._isValid},e.prototype.validate=function(){return this._isValid},Object.defineProperty(e.prototype,"value",{get:function(){return"CreateGeoObject"===this.changeRequest.type?this.geoObject.attributes[this.attribute.code]:null!=this.diff?this.diff.newValue:this.geoObject.attributes[this.attribute.code]},set:function(e){var t=this;if("CreateGeoObject"===this.changeRequest.type)this.geoObject.attributes[this.attribute.code]=e;else if(null!=this.diff)if(this.areValuesEqual(this.diff.oldValue,e)){delete this.editAction.attributeDiff,this.diff=null;var n=this.changeRequest.actions.findIndex((function(e){return e===t.editAction}));-1!==n&&this.changeRequest.actions.splice(n,1)}else this.diff.newValue=e;else this.diff={oldValue:this.geoObject.attributes[this.attribute.code],newValue:e},this.editAction.attributeDiff=this.diff,this.changeRequest.actions.push(this.editAction)},enumerable:!1,configurable:!0}),e.prototype.areValuesEqual=function(e,t){return"boolean"===this.attribute.type?e===t:""===e&&null==t||""===t&&null==e||(!e&&!t||!(!e&&t||!t&&e)&&e===t)},e}();t.StandardAttributeCRModel=o},620:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VersionDiffView=t.Layer=void 0;var r=n(520),i=n(153),o=function(){};t.Layer=o;var a=function(){function e(e,t){var n=this;this.newLayer=null,this.oldLayer=null,this.component=e,this.editor=t,this.populate(t),this.editor.onChangeSubject.subscribe((function(){n.populate(n.editor)}))}return e.prototype.populate=function(e){if("local"===this.component.attributeType.type&&null!=this._value&&null!=this.editor.value)i.LocalizedValue.populate(this._value,this.editor.value);else if("_PARENT_"===this.component.attributeType.code&&null!=this._value&&null!=this.editor.value&&null!=this.editor.value.parents)for(var t=0;t<this.component.hierarchy.types.length;t++){var n=this.component.hierarchy.types[t];this._value.parents[n.code].text=this.editor.value.parents[n.code].text,this._value.parents[n.code].geoObject=this.editor.value.parents[n.code].geoObject}else"_PARENT_"===this.component.attributeType.code?this._value=this.editor.value:this._value=this.convertValueForDisplay(null==this.editor.value?null:JSON.parse(JSON.stringify(this.editor.value)));"_PARENT_"===this.component.attributeType.code&&(this._value.loading={}),this.calculateSummaryKey()},Object.defineProperty(e.prototype,"oid",{get:function(){return this.editor.oid},set:function(e){this.editor.oid=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startDate",{get:function(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?this.editor.oldStartDate:this.editor.startDate},set:function(e){this.editor.startDate=e,this.calculateSummaryKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldStartDate",{get:function(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?null:null!=this.editor.diff&&null!=this.editor.diff.newStartDate&&void 0!==this.editor.oldStartDate?this.convertDateForDisplay(this.editor.oldStartDate):null},set:function(e){this.editor.oldStartDate=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endDate",{get:function(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?this.editor.oldEndDate:this.editor.endDate},set:function(e){this.editor.endDate=e,this.calculateSummaryKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldEndDate",{get:function(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?null:null!=this.editor.diff&&null!=this.editor.diff.newEndDate&&void 0!==this.editor.oldEndDate?this.convertDateForDisplay(this.editor.oldEndDate):null},set:function(e){this.editor.oldEndDate=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this.editor.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldValue",{get:function(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?null:null!=this.editor.diff&&null!=this.editor.diff.newValue&&void 0!==this.editor.oldValue?this.convertOldValueForDisplay(this.editor.oldValue):null},set:function(e){this.editor.oldValue=e},enumerable:!1,configurable:!0}),e.prototype.convertDateForDisplay=function(e){return null==e||0===e.length?null:this.component.dateService.formatDateForDisplay(e)},e.prototype.convertOldValueForDisplay=function(e){if("date"===this.component.attributeType.type)return this.component.dateService.formatDateForDisplay(new Date(e));if("_PARENT_"===this.component.attributeType.code&&e.includes("_~VST~_"))return e.split("_~VST~_")[1];if("term"===this.component.attributeType.type){var t=e;t instanceof Array&&(t=e[0]);var n=this.component.attributeType.rootTerm.children,r=n.findIndex((function(e){return e.code===t}));return-1!==r?n[r].label.localizedValue:e}return e},e.prototype.convertValueForDisplay=function(e){return null==e?null:e},e.prototype.calculateSummaryKey=function(){if(null!=this.editor.diff)if("CREATE"!==this.editor.diff.action)if("DELETE"!==this.editor.diff.action){var e=null!=this.editor.diff.newStartDate||null!=this.editor.diff.newEndDate,t=Object.prototype.hasOwnProperty.call(this.editor.diff,"newValue");this.summaryKey=e&&t?r.SummaryKey.UPDATE:e?r.SummaryKey.TIME_CHANGE:t?r.SummaryKey.VALUE_CHANGE:r.SummaryKey.UNMODIFIED}else this.summaryKey=r.SummaryKey.DELETE;else this.summaryKey=r.SummaryKey.NEW;else this.summaryKey=r.SummaryKey.UNMODIFIED},Object.defineProperty(e.prototype,"summaryKey",{get:function(){return this.summaryKeyData},set:function(e){this.summaryKeyData=e,this.localizeSummaryKey()},enumerable:!1,configurable:!0}),e.prototype.localizeSummaryKey=function(){this.summaryKeyLocalized=this.component.lService.decode("changeovertime.manageVersions.summaryKey."+this.summaryKeyData)},e}();t.VersionDiffView=a},621:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUpdateGeoObjectDetailComponent=void 0;var r=n(0),i=(n(30),n(518),n(16),n(111)),o=n(0),a=n(518),l=n(30),s=n(16),c=n(68),d=n(22),p=n(1),m=n(529),u=["attributeEditor"],g=["geometryEditor"],h=function(e){return[e]},f=function(e,t){return{geoObject:e,actions:t}};function y(e,t){if(1&e&&o.ɵɵelement(0,"geoobject-shared-attribute-editor",16,17),2&e){var n=o.ɵɵnextContext();o.ɵɵproperty("readOnly",n.readOnly)("geoObjectType",n.geoObjectType)("geoObjectData",o.ɵɵpureFunction2(8,f,n.postGeoObject,o.ɵɵpureFunction1(6,h,n.action)))("forDate",n.forDate)("readOnly",!1)("isGeometryInlined",!0)}}function v(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"button",18),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().startEdit()})),o.ɵɵelement(1,"localize",19),o.ɵɵelementEnd()}}function b(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"button",20),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().endEdit()})),o.ɵɵelement(1,"localize",21),o.ɵɵelementEnd()}}function S(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"button",18),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().applyAction()})),o.ɵɵelement(1,"localize",22),o.ɵɵelementEnd()}}var C=function(){function e(e,t,n,r){this.changeRequestService=e,this.modalService=t,this.registryService=n,this.authService=r,this.isMaintainer=!1,this.preGeoObject=null,this.postGeoObject=null,this.geoObjectType=null,this.isEditing=!1,this.dateStr=null,this.forDate=null,this.isMaintainer=r.isAdmin()||r.isMaintainer(),this.forDate=new Date;var i=this.forDate.getUTCDate();this.dateStr=this.forDate.getUTCFullYear()+"-"+(this.forDate.getUTCMonth()+1)+"-"+(i<10?"0":"")+i}return e.prototype.ngOnInit=function(){this.postGeoObject=this.action.geoObjectJson,this.geoObjectType=this.action.geoObjectType,this.isNew()&&(this.preGeoObject=this.postGeoObject),this.onSelect(this.action)},e.prototype.isNew=function(){return"net.geoprism.registry.action.geoobject.CreateGeoObjectAction"===this.action.actionType},e.prototype.handleDateChange=function(){this.forDate=new Date(Date.parse(this.dateStr))},e.prototype.applyAction=function(){var e=this.action;e.geoObjectJson=this.attributeEditor.getGeoObject(),null!=this.geometryEditor&&(e.geoObjectJson.geometry=this.geometryEditor.saveDraw().geometry)},e.prototype.onSelect=function(e){var t=this;"net.geoprism.registry.action.geoobject.UpdateGeoObjectAction"===this.action.actionType&&this.registryService.getGeoObjectOverTime(this.postGeoObject.attributes.code,this.geoObjectType.code).then((function(e){t.preGeoObject=e})).catch((function(e){t.error(e)}))},e.prototype.startEdit=function(){},e.prototype.endEdit=function(){},e.prototype.getUsername=function(){return this.authService.getUsername()},e.prototype.error=function(e){this.bsModalRef=i.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.ChangeRequestService),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(a.RegistryService),o.ɵɵdirectiveInject(s.AuthService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["crtable-detail-create-geo-object"]],viewQuery:function(e,t){if(1&e&&(o.ɵɵviewQuery(u,1),o.ɵɵviewQuery(g,1)),2&e){var n=void 0;o.ɵɵqueryRefresh(n=o.ɵɵloadQuery())&&(t.attributeEditor=n.first),o.ɵɵqueryRefresh(n=o.ɵɵloadQuery())&&(t.geometryEditor=n.first)}},inputs:{action:"action",readOnly:"readOnly"},decls:22,vars:9,consts:[[1,"crtable-detail-container"],[1,"heading","text-center"],[1,"action-detail-header"],[1,"detail-content"],["key","io.geoObjectType"],[2,"margin","20px 0"],[2,"margin-right","10px"],["key","changeOverTime.forDate"],["type","date","name","dateStr",3,"ngModel","ngModelChange","change"],[3,"readOnly","geoObjectType","geoObjectData","forDate","isGeometryInlined",4,"ngIf"],[1,"detail-label"],["key","change.request.action.detail.contributorNotes"],[1,"detail-value",2,"width","100%","border-radius","8px","height","70px",3,"ngModel","disabled","ngModelChange"],[1,"button-holder","text-right",2,"margin","40px 0 20px 0"],["class","btn btn-primary detail-accept",3,"click",4,"ngIf"],["class","btn btn-default detail-reject",3,"click",4,"ngIf"],[3,"readOnly","geoObjectType","geoObjectData","forDate","isGeometryInlined"],["attributeEditor",""],[1,"btn","btn-primary","detail-accept",3,"click"],["key","modal.button.edit"],[1,"btn","btn-default","detail-reject",3,"click"],["key","modal.button.cancel"],["key","modal.button.submit"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelementStart(1,"div",1),o.ɵɵelementStart(2,"h1",2),o.ɵɵtext(3),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(4,"div",3),o.ɵɵelementStart(5,"h4"),o.ɵɵelement(6,"localize",4),o.ɵɵtext(7),o.ɵɵelementEnd(),o.ɵɵelementStart(8,"div",5),o.ɵɵelementStart(9,"span",6),o.ɵɵelement(10,"localize",7),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"input",8),o.ɵɵlistener("ngModelChange",(function(e){return t.dateStr=e}))("change",(function(){return t.handleDateChange()})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(12,y,2,11,"geoobject-shared-attribute-editor",9),o.ɵɵelementStart(13,"div"),o.ɵɵelementStart(14,"label",10),o.ɵɵelement(15,"localize",11),o.ɵɵtext(16," : "),o.ɵɵelementEnd(),o.ɵɵelementStart(17,"textarea",12),o.ɵɵlistener("ngModelChange",(function(e){return t.action.contributorNotes=e})),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(18,"div",13),o.ɵɵtemplate(19,v,2,0,"button",14),o.ɵɵtemplate(20,b,2,0,"button",15),o.ɵɵtemplate(21,S,2,0,"button",14),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(3),o.ɵɵtextInterpolate(t.action.actionLabel),o.ɵɵadvance(4),o.ɵɵtextInterpolate1(": ",t.action.geoObjectType.code," "),o.ɵɵadvance(4),o.ɵɵproperty("ngModel",t.dateStr),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.action),o.ɵɵadvance(5),o.ɵɵproperty("ngModel",t.action.contributorNotes)("disabled",!t.isEditing),o.ɵɵadvance(2),o.ɵɵproperty("ngIf",!t.readOnly&&!t.isEditing),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!t.readOnly&&t.isEditing),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",!t.readOnly&&t.isEditing))},directives:[c.LocalizeComponent,d.DefaultValueAccessor,d.NgControlStatus,d.NgModel,p.NgIf,m.GeoObjectSharedAttributeEditorComponent],styles:["/* \n   WARNING viewencapsulation on the detail.component.tx was set to none to set these css\n   values to be globally scoped \n*/\n.crtable-detail-container .modal-form .label-holder {\n    display: none;\n}\n\n.crtable-detail-container .modal-form .holder {\n    border-left: 0;\n    width: 100%;\n    padding: 0;\n}\n\n.crtable-detail-container .modal-form .holder .panel .panel-body {\n    padding: 0;\n}"],encapsulation:2}),e}();t.CreateUpdateGeoObjectDetailComponent=C,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(C,[{type:r.Component,args:[{selector:"crtable-detail-create-geo-object",templateUrl:"./detail.component.html",styleUrls:["./crtable-detail-create-geo-object.css"],encapsulation:r.ViewEncapsulation.None}]}],(function(){return[{type:a.ChangeRequestService},{type:l.BsModalService},{type:a.RegistryService},{type:s.AuthService}]}),{action:[{type:r.Input}],readOnly:[{type:r.Input}],attributeEditor:[{type:r.ViewChild,args:["attributeEditor"]}],geometryEditor:[{type:r.ViewChild,args:["geometryEditor"]}]})},622:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectEditorMapComponent=void 0;var r=n(0),i=(n(518),n(263)),o=n(0),a=n(518),l=["mapDiv"],s=["geometryType",""],c=function(){function e(e,t,n){this.geomService=e,this.registryService=t,this.mapService=n,this._mapHeight=400,this.readOnly=!1}return Object.defineProperty(e.prototype,"mapHeight",{set:function(e){e>400&&(this._mapHeight=e)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout((function(){e.mapDiv.nativeElement.id=Math.floor(899999*Math.random())+1e5,e.map=new i.Map({container:e.mapDiv.nativeElement.id,style:"mapbox://styles/mapbox/satellite-v9",zoom:2,center:[110.880453,10.897852]}),e.map.on("load",(function(){e.initMap()}))}),0)},e.prototype.ngOnDestroy=function(){this.geomService.destroy()},e.prototype.getIsValid=function(){return this.geomService.isValid()},e.prototype.initMap=function(){this.map.on("style.load",(function(){})),this.geomService.initialize(this.map,this.geometryType,this.readOnly),this.map.addControl(new i.NavigationControl),this.zoomToBbox()},e.prototype.zoomToBbox=function(){this.geomService.zoomToLayersExtent()},e.prototype.error=function(e){console.log("ERROR",e)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.GeometryService),o.ɵɵdirectiveInject(a.RegistryService),o.ɵɵdirectiveInject(a.MapService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["geoobject-editor-map","geometryType",""]],viewQuery:function(e,t){if(1&e&&o.ɵɵviewQuery(l,1),2&e){var n;o.ɵɵqueryRefresh(n=o.ɵɵloadQuery())&&(t.mapDiv=n.first)}},inputs:{mapHeight:"mapHeight",geometryType:"geometryType",bboxCode:"bboxCode",bboxType:"bboxType",bboxDate:"bboxDate",readOnly:"readOnly"},attrs:s,decls:3,vars:2,consts:[[1,"geoobject-editor-map-wrapper"],[1,"map-view-port-inline","text-left",2,"width","calc(100% - 15px)"],["mapDiv",""]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0),o.ɵɵelement(1,"div",1,2),o.ɵɵelementEnd()),2&e&&(o.ɵɵadvance(1),o.ɵɵstyleProp("height",t._mapHeight,"px"))},styles:[""]}),e}();t.GeoObjectEditorMapComponent=c,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(c,[{type:r.Component,args:[{selector:"geoobject-editor-map[geometryType]",templateUrl:"./geoobject-editor-map.component.html",styleUrls:["./geoobject-editor-map.component.css"]}]}],(function(){return[{type:a.GeometryService},{type:a.RegistryService},{type:a.MapService}]}),{mapHeight:[{type:r.Input}],geometryType:[{type:r.Input}],bboxCode:[{type:r.Input}],bboxType:[{type:r.Input}],bboxDate:[{type:r.Input}],readOnly:[{type:r.Input}],mapDiv:[{type:r.ViewChild,args:["mapDiv"]}]})},623:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleEditControl=void 0;var r=n(0),i=n(0),o=n(1),a=n(68),l=n(113),s=function(e,t){return{"fa-pencil-square-o":e,"fa-save":t}};function c(e,t){if(1&e&&(i.ɵɵelement(0,"button",3),i.ɵɵpipe(1,"localize")),2&e){var n=i.ɵɵnextContext();i.ɵɵproperty("ngClass",i.ɵɵpureFunction2(4,s,!n.save,n.save))("title",i.ɵɵpipeBind1(1,2,"changeovertime.manageVersions.button.label"))}}function d(e,t){1&e&&(i.ɵɵelementStart(0,"div",4),i.ɵɵelementStart(1,"div",5),i.ɵɵelement(2,"localize",6),i.ɵɵelementEnd(),i.ɵɵelement(3,"div",7),i.ɵɵelementEnd())}var p=function(){function e(e){this.editEmitter=new r.EventEmitter,this.visible=!0,this.editSessionEnabled=!1,this.save=!1,this.elRef=e}return e.prototype.onAdd=function(e){return this.elRef.nativeElement},e.prototype.onRemove=function(e){this.elRef.nativeElement.remove()},e.prototype.onClick=function(){this.editEmitter.emit()},e.ɵfac=function(t){return new(t||e)(i.ɵɵdirectiveInject(i.ElementRef))},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["simple-edit-control"]],inputs:{visible:"visible",editSessionEnabled:"editSessionEnabled",save:"save"},outputs:{editEmitter:"editEmitter"},decls:3,vars:2,consts:[[1,"mapboxgl-ctrl-group","mapboxgl-ctrl",3,"click"],["class","fa","style","color: black; font-size: 18px;",3,"ngClass","title",4,"ngIf"],["class","map-button-info-hint-wrapper",4,"ngIf"],[1,"fa",2,"color","black","font-size","18px",3,"ngClass","title"],[1,"map-button-info-hint-wrapper"],[1,"map-button-info-hint"],["key","map.button.info.hint"],[1,"map-button-pointer"]],template:function(e,t){1&e&&(i.ɵɵelementStart(0,"div",0),i.ɵɵlistener("click",(function(){return t.onClick()})),i.ɵɵtemplate(1,c,2,7,"button",1),i.ɵɵtemplate(2,d,4,0,"div",2),i.ɵɵelementEnd()),2&e&&(i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t.editSessionEnabled),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t.editSessionEnabled))},directives:[o.NgIf,o.NgClass,a.LocalizeComponent],pipes:[l.LocalizePipe],styles:[".mapboxgl-ctrl-group.mapboxgl-ctrl[_ngcontent-%COMP%]    > button[_ngcontent-%COMP%]:hover, .mapboxgl-ctrl-group.mapboxgl-ctrl[_ngcontent-%COMP%]:hover {\n\tcursor: pointer;\n}\n\n.map-button-info-hint-wrapper[_ngcontent-%COMP%] {\n\tanimation: fadeIn ease 2s;\n\t-webkit-animation: fadeIn ease 2s;\n\t-moz-animation: fadeIn ease 2s;\n\t-o-animation: fadeIn ease 2s;\n\t-ms-animation: fadeIn ease 2s;\n}\n\n@keyframes fadeIn {\n0% {opacity:0;}\n100% {opacity:1;}\n}\n\n@-moz-keyframes fadeIn {\n0% {opacity:0;}\n100% {opacity:1;}\n}\n\n@-webkit-keyframes fadeIn {\n0% {opacity:0;}\n100% {opacity:1;}\n}\n\n@-o-keyframes fadeIn {\n0% {opacity:0;}\n100% {opacity:1;}\n}\n\n@-ms-keyframes fadeIn {\n0% {opacity:0;}\n100% {opacity:1;}\n}\n\n\n.map-button-info-hint[_ngcontent-%COMP%] {\n\tposition: absolute;\n\ttop: 0;\n\tright: 45px;\n\tbackground: rgba(255,255,255,.9);\n\tpadding: 5px;\n\twhite-space: nowrap;\n}\n\n.map-button-pointer[_ngcontent-%COMP%] {\n\tborder: solid 15px transparent;\n    border-left-color: rgba(255,255,255,.9);\n    position: absolute;\n    margin: -29px 0 0 -16px;\n}"]}),e}();t.SimpleEditControl=p,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(p,[{type:r.Component,args:[{selector:"simple-edit-control",templateUrl:"./simple-edit-control.component.html",styleUrls:["./simple-edit-control.css"]}]}],(function(){return[{type:i.ElementRef}]}),{editEmitter:[{type:r.Output}],visible:[{type:r.Input}],editSessionEnabled:[{type:r.Input}],save:[{type:r.Input}]})},624:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TreeGeoSelector=void 0;var r=n(0),i=(n(203),n(0)),o=n(1),a=n(208),l=n(68);function s(e,t){if(1&e&&(i.ɵɵelementStart(0,"div",6),i.ɵɵelement(1,"tree-root",7),i.ɵɵelementEnd()),2&e){var n=i.ɵɵnextContext();i.ɵɵadvance(1),i.ɵɵproperty("nodes",n.nodes)("options",n.options)}}function c(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"button",8),i.ɵɵlistener("click",(function(){return i.ɵɵrestoreView(n),i.ɵɵnextContext().onEdit()})),i.ɵɵelement(1,"localize",9),i.ɵɵelementEnd()}}var d=function(){function e(){this.readOnly=!1,this.forDate=null,this.onManageVersion=new r.EventEmitter,this.nodes=[],this.actionMapping={mouse:{click:null}},this.options={displayField:"name",isExpandedField:"expanded",idField:"code",actionMapping:this.actionMapping}}return e.prototype.ngOnInit=function(){this.calculate()},e.prototype.ngOnChanges=function(e){e.forDate&&this.calculate()},e.prototype.calculate=function(){var e=this,t=null;null!=this.forDate&&(t=this.forDate.getTime());var n=[],r=null;this.hierarchy.entries.forEach((function(i){var o=Date.parse(i.startDate),a=Date.parse(i.endDate);(null==t||t>=o&&t<=a)&&e.hierarchy.types.forEach((function(e){var o={code:e.code,label:e.label,children:[],expanded:!1};null!=i.parents[e.code]&&(o.name=i.parents[e.code].text,null==t&&(o.name=o.name+" ("+i.startDate+" -> "+i.endDate+")"),o.geoObject=i.parents[e.code].geoObject),null==r?n.push(o):(r.children.push(o),r.expanded=!0),r=o})),r=null})),this.nodes=n},e.prototype.onEdit=function(){this.onManageVersion.emit(this.hierarchy)},e.ɵfac=function(t){return new(t||e)},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["tree-geo-selector"]],inputs:{hierarchy:"hierarchy",readOnly:"readOnly",forDate:"forDate"},outputs:{onManageVersion:"onManageVersion"},features:[i.ɵɵNgOnChangesFeature],decls:8,vars:3,consts:[[1,"panel","panel-default"],[1,"panel-heading"],[2,"margin","0"],[1,"panel-body"],["class","tree",4,"ngIf"],["class","btn btn-primary","style","width:100%;margin-top:10px;",3,"click",4,"ngIf"],[1,"tree"],[3,"nodes","options"],[1,"btn","btn-primary",2,"width","100%","margin-top","10px",3,"click"],["key","modal.button.edit"]],template:function(e,t){1&e&&(i.ɵɵelementStart(0,"div"),i.ɵɵelementStart(1,"div",0),i.ɵɵelementStart(2,"div",1),i.ɵɵelementStart(3,"h4",2),i.ɵɵtext(4),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementStart(5,"div",3),i.ɵɵtemplate(6,s,2,2,"div",4),i.ɵɵtemplate(7,c,2,0,"button",5),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e&&(i.ɵɵadvance(4),i.ɵɵtextInterpolate(t.hierarchy.label),i.ɵɵadvance(2),i.ɵɵproperty("ngIf",t.nodes.length>0),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",!t.readOnly))},directives:[o.NgIf,a.TreeComponent,l.LocalizeComponent],styles:[""]}),e}();t.TreeGeoSelector=d,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(d,[{type:r.Component,args:[{selector:"tree-geo-selector",templateUrl:"./tree-geo-selector.html",styleUrls:["./tree-geo-selector.css"]}]}],(function(){return[]}),{hierarchy:[{type:r.Input}],readOnly:[{type:r.Input}],forDate:[{type:r.Input}],onManageVersion:[{type:r.Output}]})},625:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionDetailModalComponent=void 0;var r=n(0),i=(n(30),n(0)),o=n(30),a=["cuDetail"],l=["arDetail"],s=["spDetail"];function c(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"crtable-detail-create-geo-object",7,8),i.ɵɵlistener("actionChange",(function(e){return i.ɵɵrestoreView(n),i.ɵɵnextContext().action=e})),i.ɵɵelementEnd()}if(2&e){var r=i.ɵɵnextContext();i.ɵɵproperty("action",r.action)("readOnly",r.readonly)}}function d(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"crtable-detail-add-remove-child",7,9),i.ɵɵlistener("actionChange",(function(e){return i.ɵɵrestoreView(n),i.ɵɵnextContext().action=e})),i.ɵɵelementEnd()}if(2&e){var r=i.ɵɵnextContext();i.ɵɵproperty("action",r.action)("readOnly",r.readonly)}}function p(e,t){if(1&e){var n=i.ɵɵgetCurrentView();i.ɵɵelementStart(0,"set-parent-detail",7,10),i.ɵɵlistener("actionChange",(function(e){return i.ɵɵrestoreView(n),i.ɵɵnextContext().action=e})),i.ɵɵelementEnd()}if(2&e){var r=i.ɵɵnextContext();i.ɵɵproperty("action",r.action)("readOnly",r.readonly)}}var m=function(){function e(e){this.bsModalRef=e}return e.prototype.curAction=function(e,t){this.action=e,this.readonly=t},e.prototype.ngOnInit=function(){},e.prototype.cancel=function(){null!=this.cuDetail&&this.cuDetail.endEdit(),null!=this.arDetail&&this.arDetail.endEdit(),null!=this.spDetail&&this.spDetail.endEdit(),this.bsModalRef.hide()},e.prototype.confirm=function(){this.bsModalRef.hide()},e.ɵfac=function(t){return new(t||e)(i.ɵɵdirectiveInject(o.BsModalRef))},e.ɵcmp=i.ɵɵdefineComponent({type:e,selectors:[["action-detail-modal"]],viewQuery:function(e,t){if(1&e&&(i.ɵɵviewQuery(a,1),i.ɵɵviewQuery(l,1),i.ɵɵviewQuery(s,1)),2&e){var n=void 0;i.ɵɵqueryRefresh(n=i.ɵɵloadQuery())&&(t.cuDetail=n.first),i.ɵɵqueryRefresh(n=i.ɵɵloadQuery())&&(t.arDetail=n.first),i.ɵɵqueryRefresh(n=i.ɵɵloadQuery())&&(t.spDetail=n.first)}},inputs:{curAction:"curAction"},decls:13,vars:3,consts:[["tabindex","-1","role","dialog",1,"modal-body"],[1,"row"],[1,"col-md-12"],[3,"action","readOnly","actionChange",4,"ngIf"],[1,"button-holder","text-right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.close"],[3,"action","readOnly","actionChange"],["cuDetail",""],["arDetail",""],["spDetail",""]],template:function(e,t){1&e&&(i.ɵɵelementStart(0,"div",0),i.ɵɵelementStart(1,"div",1),i.ɵɵelementStart(2,"div",2),i.ɵɵtemplate(3,c,2,2,"crtable-detail-create-geo-object",3),i.ɵɵtemplate(4,d,2,2,"crtable-detail-add-remove-child",3),i.ɵɵtemplate(5,p,2,2,"set-parent-detail",3),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelement(6,"hr"),i.ɵɵelementStart(7,"div",1),i.ɵɵelementStart(8,"div",2),i.ɵɵelementStart(9,"div",4),i.ɵɵelementStart(10,"button",5),i.ɵɵlistener("click",(function(){return t.cancel()})),i.ɵɵelementStart(11,"span"),i.ɵɵelement(12,"localize",6),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd(),i.ɵɵelementEnd()),2&e&&(i.ɵɵadvance(3),i.ɵɵproperty("ngIf",t.action&&(t.action.actionType.endsWith("CreateGeoObjectAction")||t.action.actionType.endsWith("UpdateGeoObjectAction"))),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t.action&&(t.action.actionType.endsWith("AddChildAction")||t.action.actionType.endsWith("RemoveChildAction"))),i.ɵɵadvance(1),i.ɵɵproperty("ngIf",t.action&&t.action.actionType.endsWith("SetParentAction")))},encapsulation:2}),e}();t.ActionDetailModalComponent=m,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(m,[{type:r.Component,args:[{selector:"action-detail-modal",templateUrl:"./action-detail-modal.component.html",styleUrls:[]}]}],(function(){return[{type:o.BsModalRef}]}),{cuDetail:[{type:r.ViewChild,args:["cuDetail"]}],arDetail:[{type:r.ViewChild,args:["arDetail"]}],spDetail:[{type:r.ViewChild,args:["spDetail"]}],curAction:[{type:r.Input}]})},626:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataExportComponent=void 0;var r=n(0),i=(n(30),n(111)),o=(n(518),n(16),n(0)),a=n(518),l=n(30),s=n(16),c=n(86),d=n(1),p=n(22),m=n(68);function u(e,t){if(1&e&&(o.ɵɵelementStart(0,"option",19),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵproperty("value",n.code),o.ɵɵadvance(1),o.ɵɵtextInterpolate(n.label)}}function g(e,t){if(1&e&&(o.ɵɵelementStart(0,"option",19),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var n=t.$implicit;o.ɵɵproperty("value",n.code),o.ɵɵadvance(1),o.ɵɵtextInterpolate(n.label)}}function h(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",2),o.ɵɵelementStart(1,"label",20),o.ɵɵelement(2,"localize",21),o.ɵɵelementEnd(),o.ɵɵelementStart(3,"div",5),o.ɵɵelementStart(4,"select",22),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext(2).hierarchy=e})),o.ɵɵelement(5,"option"),o.ɵɵtemplate(6,g,2,2,"option",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵnextContext(2);o.ɵɵadvance(4),o.ɵɵproperty("ngModel",r.hierarchy),o.ɵɵadvance(2),o.ɵɵproperty("ngForOf",r.hierarchies)}}function f(e,t){if(1&e){var n=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"form",null,1),o.ɵɵelementStart(2,"div",2),o.ɵɵelementStart(3,"label",3),o.ɵɵelement(4,"localize",4),o.ɵɵelementEnd(),o.ɵɵelementStart(5,"div",5),o.ɵɵelementStart(6,"select",6),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().code=e}))("change",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().onChange(e.target.value)})),o.ɵɵelement(7,"option"),o.ɵɵtemplate(8,u,2,2,"option",7),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵtemplate(9,h,7,2,"div",8),o.ɵɵelementStart(10,"div",2),o.ɵɵelementStart(11,"label",9),o.ɵɵelement(12,"localize",10),o.ɵɵelementEnd(),o.ɵɵelementStart(13,"div",5),o.ɵɵelementStart(14,"select",11),o.ɵɵlistener("ngModelChange",(function(e){return o.ɵɵrestoreView(n),o.ɵɵnextContext().format=e})),o.ɵɵelement(15,"option"),o.ɵɵelementStart(16,"option",12),o.ɵɵelement(17,"localize",13),o.ɵɵelementEnd(),o.ɵɵelementStart(18,"option",14),o.ɵɵelement(19,"localize",15),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementStart(20,"div",2),o.ɵɵelementStart(21,"div",16),o.ɵɵelementStart(22,"button",17),o.ɵɵlistener("click",(function(){return o.ɵɵrestoreView(n),o.ɵɵnextContext().onExport()})),o.ɵɵelement(23,"localize",18),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var r=o.ɵɵreference(1),i=o.ɵɵnextContext();o.ɵɵadvance(6),o.ɵɵproperty("ngModel",i.code),o.ɵɵadvance(2),o.ɵɵproperty("ngForOf",i.types),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",i.hierarchies.length>0),o.ɵɵadvance(5),o.ɵɵproperty("ngModel",i.format),o.ɵɵadvance(8),o.ɵɵproperty("disabled",r.invalid)}}var y=function(){function e(e,t,n){this.service=e,this.modalService=t,this.authService=n,this.code=null,this.hierarchies=[],this.hierarchy=null,this.format=null}return e.prototype.ngOnInit=function(){var e=this;this.service.listGeoObjectTypes(!0).then((function(t){for(var n=[],r=0;r<t.length;++r)e.authService.isOrganizationRA(t[r].orgCode)&&n.push(t[r]);e.types=n})).catch((function(t){e.error(t)}))},e.prototype.onChange=function(e){var t=this;null!=e&&e.length>0?this.service.getHierarchiesForType(e,!1).then((function(e){t.hierarchies=e,t.hierarchy=null})).catch((function(e){t.error(e)})):(this.hierarchies=[],this.hierarchy=null)},e.prototype.onExport=function(){"SHAPEFILE"===this.format?window.location.href=acp+"/shapefile/export-shapefile?type="+this.code+"&hierarchyType="+this.hierarchy:"EXCEL"===this.format&&(window.location.href=acp+"/excel/export-spreadsheet?type="+this.code+"&hierarchyType="+this.hierarchy)},e.prototype.error=function(e){this.bsModalRef=i.ErrorHandler.showErrorAsDialog(e,this.modalService)},e.ɵfac=function(t){return new(t||e)(o.ɵɵdirectiveInject(a.IOService),o.ɵɵdirectiveInject(l.BsModalService),o.ɵɵdirectiveInject(s.AuthService))},e.ɵcmp=o.ɵɵdefineComponent({type:e,selectors:[["data-export"]],decls:2,vars:1,consts:[[4,"ngIf"],["form","ngForm"],[1,"form-group","row"],["for","code",1,"col-md-3","text-right"],["key","io.geoObjectType"],[1,"col-md-9"],["id","code","name","code","required","",1,"select-area",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["class","form-group row",4,"ngIf"],["for","format",1,"col-md-3","text-right"],["key","io.format"],["id","format","name","format","required","",1,"select-area",3,"ngModel","ngModelChange"],["value","EXCEL"],["key","io.spreadsheet"],["value","SHAPEFILE"],["key","io.shapefile"],[1,"col-md-12","text-right"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["key","io.export"],[3,"value"],[1,"col-sm-3","text-right"],["key","io.modal.hierarchy"],["name","hierarchy","required","",1,"select-area",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(o.ɵɵelement(0,"loading-bar"),o.ɵɵtemplate(1,f,24,5,"form",0)),2&e&&(o.ɵɵadvance(1),o.ɵɵproperty("ngIf",t.types))},directives:[c.LoadingBarComponent,d.NgIf,p.ɵangular_packages_forms_forms_ba,p.NgControlStatusGroup,p.NgForm,m.LocalizeComponent,p.SelectControlValueAccessor,p.RequiredValidator,p.NgControlStatus,p.NgModel,p.NgSelectOption,p.ɵangular_packages_forms_forms_z,d.NgForOf],encapsulation:2}),e}();t.DataExportComponent=y,("undefined"==typeof ngDevMode||ngDevMode)&&o.ɵsetClassMetadata(y,[{type:r.Component,args:[{selector:"data-export",templateUrl:"./data-export.component.html",styleUrls:[]}]}],(function(){return[{type:a.IOService},{type:l.BsModalService},{type:s.AuthService}]}),null)},627:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryPanelComponent=void 0;var r=n(0),i=n(7),o=n(203),a=(n(16),n(112),n(3)),l=n(0),s=n(16),c=n(112),d=n(1),p=n(22),m=n(68),u=n(261),g=n(113),h=["dateFieldComponents"];function f(e,t){1&e&&(l.ɵɵelementStart(0,"div",11),l.ɵɵelement(1,"localize",12),l.ɵɵelementEnd())}function y(e,t){1&e&&(l.ɵɵelementStart(0,"p",23),l.ɵɵelement(1,"localize",24),l.ɵɵelementEnd())}function v(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"tr",37),l.ɵɵelementStart(1,"td",38),l.ɵɵelementStart(2,"button",39),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext(),t=e.$implicit,r=e.index;return l.ɵɵnextContext(2).edit(t,r)})),l.ɵɵelement(3,"localize",40),l.ɵɵelementEnd(),l.ɵɵelementStart(4,"button",41),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=l.ɵɵnextContext().$implicit;return l.ɵɵnextContext(2).onCloneGeometryToNewVersion(e)})),l.ɵɵelement(5,"localize",42),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}}var b=function(e,t){return{"error-message":e,"warning-message":t}};function S(e,t){if(1&e&&(l.ɵɵelementStart(0,"p",25),l.ɵɵtext(1),l.ɵɵelementEnd()),2&e){var n=t.$implicit;l.ɵɵproperty("ngClass",l.ɵɵpureFunction2(2,b,"ERROR"===n.type,"WARNING"===n.type)),l.ɵɵadvance(1),l.ɵɵtextInterpolate1(" ",n.message," ")}}function C(e,t){if(1&e&&(l.ɵɵelementStart(0,"tr"),l.ɵɵtemplate(1,S,2,5,"p",19),l.ɵɵelementEnd()),2&e){var n=l.ɵɵnextContext().$implicit;l.ɵɵadvance(1),l.ɵɵproperty("ngForOf",n.conflictMessage)}}var E=function(e,t){return{"error-border":e,"warning-border":t}},x=function(e){return{active:e}};function O(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"tr",25),l.ɵɵelementStart(1,"td",25),l.ɵɵelementStart(2,"table"),l.ɵɵtemplate(3,v,6,0,"tr",26),l.ɵɵelementStart(4,"tr",27),l.ɵɵelementStart(5,"td"),l.ɵɵelementStart(6,"h5"),l.ɵɵelement(7,"localize",28),l.ɵɵelementEnd(),l.ɵɵelementStart(8,"date-field",29,30),l.ɵɵlistener("valueChange",(function(e){return t.$implicit.startDate=e}))("change",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext(2).onDateChange()})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(10,"td"),l.ɵɵelementStart(11,"div",31),l.ɵɵelementStart(12,"h5"),l.ɵɵelement(13,"localize",32),l.ɵɵelementEnd(),l.ɵɵelementStart(14,"date-field",33,30),l.ɵɵlistener("valueChange",(function(e){return t.$implicit.endDate=e}))("change",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext(2).onDateChange()})),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵtemplate(16,C,2,1,"tr",34),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(17,"td",35),l.ɵɵlistener("click",(function(){l.ɵɵrestoreView(n);var e=t.$implicit;return l.ɵɵnextContext(2).remove(e)})),l.ɵɵpipe(18,"localize"),l.ɵɵelement(19,"i",36),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=t.$implicit,i=t.index,o=l.ɵɵnextContext(2);l.ɵɵproperty("ngClass",l.ɵɵpureFunction2(17,E,r.conflictMessage&&r.conflictMessage.length>0&&"ERROR"===r.conflictMessage[0].type,r.conflictMessage&&r.conflictMessage.length>0&&"WARNING"===r.conflictMessage[0].type)),l.ɵɵadvance(1),l.ɵɵproperty("ngClass",l.ɵɵpureFunction1(20,x,i===o.isVersionForHighlight)),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",o.geoObjectType.isGeometryEditable),l.ɵɵadvance(5),l.ɵɵproperty("value",r.startDate)("inputName","startDate_"+i)("allowFutureDates",!1)("required",!0),l.ɵɵadvance(6),l.ɵɵproperty("value",r.endDate)("inputName","endDate_"+i)("allowInfinity",!0)("allowFutureDates",!0)("required",!0)("placement","bottom"),l.ɵɵadvance(2),l.ɵɵproperty("ngIf",r.conflictMessage&&r.conflictMessage.length>0),l.ɵɵadvance(1),l.ɵɵproperty("title",l.ɵɵpipeBind1(18,15,"changeovertime.manageVersions.remove.version"))}}function I(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"div",13),l.ɵɵelementStart(1,"ul",14),l.ɵɵelementStart(2,"li",15),l.ɵɵelementStart(3,"table",16),l.ɵɵelementStart(4,"tbody",17),l.ɵɵtemplate(5,y,2,0,"p",18),l.ɵɵtemplate(6,O,20,22,"tr",19),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(7,"li",20),l.ɵɵelementStart(8,"i",21),l.ɵɵlistener("click",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onAddNewVersion(null)})),l.ɵɵelement(9,"localize",22),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵnextContext();l.ɵɵadvance(5),l.ɵɵproperty("ngIf",0===r.geoObjectOverTime.attributes.geometry.values.length),l.ɵɵadvance(1),l.ɵɵproperty("ngForOf",r.geoObjectOverTime.attributes.geometry.values)}}function w(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",41),l.ɵɵlistener("click",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onCancel()})),l.ɵɵelement(1,"localize",43),l.ɵɵelementEnd()}}function M(e,t){if(1&e){var n=l.ɵɵgetCurrentView();l.ɵɵelementStart(0,"button",44),l.ɵɵlistener("click",(function(){return l.ɵɵrestoreView(n),l.ɵɵnextContext().onSubmit()})),l.ɵɵelement(1,"localize",45),l.ɵɵelementEnd()}if(2&e){var r=l.ɵɵnextContext(),i=l.ɵɵreference(3);l.ɵɵproperty("disabled",!r.isValid||!i.valid)}}var T=function(){function e(e,t,n){this.lService=e,this.changeDetectorRef=t,this.dateService=n,this.currentDate=new Date,this.isValid=!0,this.message=null,this.readonly=!1,this.hasConflict=!1,this.onChange=new r.EventEmitter,this.onCloneGeometry=new r.EventEmitter,this.onEdit=new r.EventEmitter,this.isNewGeoObject=!1,this.hasDuplicateDate=!1}return Object.defineProperty(e.prototype,"geoObjectOverTimeInput",{set:function(e){this.originalGeoObjectOverTime=JSON.parse(JSON.stringify(e)),this.geoObjectOverTime=e},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.checkDateFieldValidity=function(){for(var e=this.dateFieldComponentsArray.toArray(),t=0;t<e.length;t++){if(!e[t].valid)return!1}return!0},e.prototype.onDateChange=function(){this.hasConflict=!1,this.isValid=this.checkDateFieldValidity();var e=this.geoObjectOverTime.attributes.geometry.values;this.hasConflict=this.dateService.checkRanges(null,e)},e.prototype.edit=function(e,t){this.onEdit.emit(e),this.isVersionForHighlight=t},e.prototype.onAddNewVersion=function(e){var t=this.geoObjectOverTime.attributes.geometry.values,n=new o.ValueOverTime;n.startDate=null,n.endDate=null,e&&e.value?n.value=e.value:n.value={type:this.geoObjectType.geometryType,coordinates:[]},"MULTIPOLYGON"===this.geoObjectType.geometryType?n.value.type="MultiPolygon":"POLYGON"===this.geoObjectType.geometryType?n.value.type="Polygon":"POINT"===this.geoObjectType.geometryType?n.value.type="Point":"MULTIPOINT"===this.geoObjectType.geometryType?n.value.type="MultiPoint":"LINE"===this.geoObjectType.geometryType?n.value.type="Line":"MULTILINE"===this.geoObjectType.geometryType&&(n.value.type="MultiLine"),t.push(n),this.changeDetectorRef.detectChanges()},e.prototype.getVersionData=function(e){var t=[];return this.geoObjectOverTime.attributes[e.code].values.forEach((function(e){e.value.localeValues.forEach((function(e){t.push(e)}))})),t},e.prototype.getDefaultLocaleVal=function(e){var t=null;return e.localeValues.forEach((function(e){"defaultLocale"===e.locale&&(t=e.value)})),t},e.prototype.setDateAttribute=function(e,t){e.value=new Date(t).getTime().toString()},e.prototype.remove=function(e){for(var t=this.geoObjectOverTime.attributes.geometry,n=-1,r=0;r<t.values.length;r++){t.values[r].startDate===e.startDate&&(n=r)}n>-1&&t.values.splice(n,1)},e.prototype.formatDate=function(e){var t=a.localeData(e).longDateFormat("L");return a().format(t)},e.prototype.setInfinity=function(e,t){e.endDate===o.PRESENT?e.endDate=new Date:e.endDate=o.PRESENT,this.onDateChange()},e.prototype.sort=function(e){e.sort((function(e,t){return null==e.startDate||""===e.startDate?1:null==t.startDate||""===t.startDate?-1:new Date(e.startDate)-new Date(t.startDate)}))},e.prototype.onCloneGeometryToNewVersion=function(e){this.onAddNewVersion(e)},e.prototype.onSubmit=function(){this.onChange.emit(this.geoObjectOverTime)},e.prototype.onCancel=function(){this.onChange.emit(this.originalGeoObjectOverTime)},e.ɵfac=function(t){return new(t||e)(l.ɵɵdirectiveInject(s.LocalizationService),l.ɵɵdirectiveInject(l.ChangeDetectorRef),l.ɵɵdirectiveInject(c.DateService))},e.ɵcmp=l.ɵɵdefineComponent({type:e,selectors:[["geometry-panel"]],viewQuery:function(e,t){if(1&e&&l.ɵɵviewQuery(h,1),2&e){var n;l.ɵɵqueryRefresh(n=l.ɵɵloadQuery())&&(t.dateFieldComponentsArray=n)}},hostVars:1,hostBindings:function(e,t){2&e&&l.ɵɵsyntheticHostProperty("@fadeInOut",!0)},inputs:{geoObjectType:"geoObjectType",geoObjectOverTimeInput:"geoObjectOverTimeInput",isNewGeoObject:"isNewGeoObject"},outputs:{onChange:"onChange",onCloneGeometry:"onCloneGeometry",onEdit:"onEdit"},decls:13,vars:4,consts:[["class","alert alert-danger","role","alert",4,"ngIf"],["autocomplete","off",1,"modal-form"],["versionsform","ngForm"],[1,"row"],[1,"col-md-12"],["class","attribute-version-wrapper",4,"ngIf"],[1,"row-holder"],[1,"holder",2,"border","none","width","100%"],[1,"button-holder","pull-right"],["type","submit","class","btn btn-default","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["key","changeovertime.manageVersions.duplicateDate"],[1,"attribute-version-wrapper"],[1,"list-group"],[1,"list-group-item",2,"text-align","left","padding","0"],[1,"table","table-striped"],[1,"attribute-element-wrapper"],["class","message",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"list-group-item",2,"text-align","left"],[1,"fa","fa-plus","clickable",3,"click"],["key","changeovertime.manageVersions.newVersion"],[1,"message"],["key","changeovertime.manageVersions.no.versions.message"],[3,"ngClass"],["class","attribute-value-row",4,"ngIf"],[1,"attribute-date-input-row"],["key","changeovertime.manageVersions.tableHeader.label.startDate"],["label","",3,"value","inputName","allowFutureDates","required","valueChange","change"],["dateFieldComponents",""],[1,"version-edit-date-container"],["key","changeovertime.manageVersions.tableHeader.label.endDate"],["label","",3,"value","inputName","allowInfinity","allowFutureDates","required","placement","valueChange","change"],[4,"ngIf"],[1,"manage-version-button","clickable",2,"vertical-align","middle",3,"title","click"],[1,"fa","fa-times"],[1,"attribute-value-row"],["colspan","2"],["role","button",1,"btn","btn-primary",3,"click"],["key","changeovertime.manageVersions.geometry.edit"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","changeovertime.manageVersions.copy.geometry.button"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"]],template:function(e,t){1&e&&(l.ɵɵelementStart(0,"div"),l.ɵɵtemplate(1,f,2,0,"div",0),l.ɵɵelementStart(2,"form",1,2),l.ɵɵelementStart(4,"fieldset"),l.ɵɵelementStart(5,"div",3),l.ɵɵelementStart(6,"div",4),l.ɵɵtemplate(7,I,10,2,"div",5),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementStart(8,"div",6),l.ɵɵelementStart(9,"div",7),l.ɵɵelementStart(10,"div",8),l.ɵɵtemplate(11,w,2,0,"button",9),l.ɵɵtemplate(12,M,2,1,"button",10),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd(),l.ɵɵelementEnd()),2&e&&(l.ɵɵadvance(1),l.ɵɵproperty("ngIf",t.hasDuplicateDate),l.ɵɵadvance(6),l.ɵɵproperty("ngIf",t.geoObjectOverTime),l.ɵɵadvance(4),l.ɵɵproperty("ngIf",!t.readonly),l.ɵɵadvance(1),l.ɵɵproperty("ngIf",!t.readonly))},directives:[d.NgIf,p.ɵangular_packages_forms_forms_ba,p.NgControlStatusGroup,p.NgForm,m.LocalizeComponent,d.NgForOf,d.NgClass,u.DateFieldComponent],pipes:[g.LocalizePipe],styles:['@charset "UTF-8";\n\n.active[_ngcontent-%COMP%] {\n\tbackground-color: #f4fcef !important;\n\tborder: solid 1px #6BA542;\n}'],data:{animation:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}}),e}();t.GeometryPanelComponent=T,("undefined"==typeof ngDevMode||ngDevMode)&&l.ɵsetClassMetadata(T,[{type:r.Component,args:[{selector:"geometry-panel",templateUrl:"./geometry-panel.component.html",styleUrls:["./geometry-panel.css"],host:{"[@fadeInOut]":"true"},animations:[[i.trigger("fadeInOut",[i.transition("void => *",[i.style({opacity:0}),i.animate("500ms")]),i.transition(":leave",i.animate("500ms",i.style({opacity:0})))])]]}]}],(function(){return[{type:s.LocalizationService},{type:l.ChangeDetectorRef},{type:c.DateService}]}),{dateFieldComponentsArray:[{type:r.ViewChildren,args:["dateFieldComponents"]}],onChange:[{type:r.Output}],onCloneGeometry:[{type:r.Output}],onEdit:[{type:r.Output}],geoObjectType:[{type:r.Input}],geoObjectOverTimeInput:[{type:r.Input}],isNewGeoObject:[{type:r.Input}]})},628:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoObjectTypePipe=void 0;var r=n(0),i=n(0),o=function(){function e(){}return e.prototype.transform=function(e,t){if(!e||!t)return e;var n=[];return this.buildUnassignedGeoObjTypes(t,n),e.filter((function(e){return-1===n.indexOf(e.code)}))},e.prototype.buildUnassignedGeoObjTypes=function(e,t){var n=this;e.forEach((function(e){n.processHierarchyNodes(e,t)}))},e.prototype.processHierarchyNodes=function(e,t){var n=this;t.push(e.geoObjectType),e.children.forEach((function(e){n.processHierarchyNodes(e,t)}))},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=i.ɵɵdefinePipe({name:"geoobjecttype",type:e,pure:!1}),e}();t.GeoObjectTypePipe=o,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(o,[{type:r.Pipe,args:[{name:"geoobjecttype",pure:!1}]}],null,null)},629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToEpochDateTimePipe=void 0;var r=n(0),i=n(0),o=function(){function e(){}return e.prototype.transform=function(e){return e?new Date(e).getTime():e},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=i.ɵɵdefinePipe({name:"toEpochDateTime",type:e,pure:!0}),e}();t.ToEpochDateTimePipe=o,("undefined"==typeof ngDevMode||ngDevMode)&&i.ɵsetClassMetadata(o,[{type:r.Pipe,args:[{name:"toEpochDateTime",pure:!0}]}],null,null)},630:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegistryRoutingModule=void 0;var r=n(0),i=n(1),o=n(33),a=n(532),l=n(553),s=n(582),c=n(591),d=n(594),p=n(580),m=n(589),u=n(595),g=n(596),h=n(603),f=n(604),y=n(606),v=n(607),b=n(608),S=n(610),C=n(123),E=n(0),x=n(33),O=[{path:"",component:a.HierarchyComponent,canActivate:[C.AuthGuard]},{path:"hierarchies",component:a.HierarchyComponent,canActivate:[C.AuthGuard]},{path:"data",component:p.DataPageComponent,canActivate:[C.MaintainerGuard]},{path:"change-requests",component:m.ChangeRequestPageComponent,canActivate:[C.ContributerGuard]},{path:"change-requests/:oid",component:m.ChangeRequestPageComponent,canActivate:[C.ContributerGuard]},{path:"master-lists",component:s.MasterListManagerComponent,canActivate:[C.AuthGuard]},{path:"scheduled-jobs",component:u.ScheduledJobsComponent,canActivate:[C.MaintainerGuard]},{path:"job/:oid",component:g.JobComponent,canActivate:[C.MaintainerGuard]},{path:"master-list/:oid/:published",component:c.MasterListComponent,canActivate:[C.AuthGuard]},{path:"master-list-view/:oid",component:d.MasterListViewComponent,canActivate:[C.AuthGuard]},{path:"change-request",component:l.SubmitChangeRequestComponent,canActivate:[C.ContributerGuard]},{path:"tasks",component:h.TaskViewerComponent,canActivate:[C.MaintainerGuard]},{path:"synchronization-configs",component:f.SynchronizationConfigManagerComponent,canActivate:[C.AuthGuard]},{path:"synchronization-config/:oid",component:y.SynchronizationConfigComponent,canActivate:[C.AuthGuard]},{path:"location-manager",component:b.LocationManagerComponent,canActivate:[C.AuthGuard]},{path:"location-manager/:geoobjectuid/:geoobjecttypecode/:datestr/:hideSearchOptions",component:b.LocationManagerComponent,canActivate:[C.AuthGuard]},{path:"location-manager/:geoobjectuid/:geoobjecttypecode/:datestr/:hideSearchOptions/:backReference",component:b.LocationManagerComponent,canActivate:[C.AuthGuard]},{path:"dataset-location-manager/:datasetId/:typeCode/:readOnly/:date",component:S.DatasetLocationManagerComponent,canActivate:[C.AuthGuard]},{path:"dataset-location-manager/:datasetId/:typeCode/:readOnly/:date/:code",component:S.DatasetLocationManagerComponent,canActivate:[C.AuthGuard]},{path:"dataset-location-manager/:datasetId/:typeCode/:readOnly/:date/:code/:editOnly",component:S.DatasetLocationManagerComponent,canActivate:[C.AuthGuard]},{path:"dataset-location-manager/:datasetId/:typeCode/:readOnly/:date/:code/:editOnly/:backReference",component:S.DatasetLocationManagerComponent,canActivate:[C.AuthGuard]},{path:"sync/details/:oid",component:v.SyncDetailsComponent,canActivate:[C.MaintainerGuard]}],I=function(){function e(){}return e.ɵfac=function(t){return new(t||e)},e.ɵmod=E.ɵɵdefineNgModule({type:e}),e.ɵinj=E.ɵɵdefineInjector({providers:[{provide:i.LocationStrategy,useClass:i.HashLocationStrategy}],imports:[[o.RouterModule.forChild(O)],o.RouterModule]}),e}();t.RegistryRoutingModule=I,("undefined"==typeof ngJitMode||ngJitMode)&&E.ɵɵsetNgModuleScope(I,{imports:[x.RouterModule],exports:[o.RouterModule]}),("undefined"==typeof ngDevMode||ngDevMode)&&E.ɵsetClassMetadata(I,[{type:r.NgModule,args:[{imports:[o.RouterModule.forChild(O)],exports:[o.RouterModule],providers:[{provide:i.LocationStrategy,useClass:i.HashLocationStrategy}]}]}],null,null)}}]);
//# sourceMappingURL=1.chunk.js.map