/*
 * Copyright (c) 2022 TerraFrame, Inc. All rights reserved.
 *
 * This file is part of Geoprism Registry(tm).
 *
 * Geoprism Registry(tm) is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * Geoprism Registry(tm) is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with Geoprism Registry(tm).  If not, see <http://www.gnu.org/licenses/>.
 */
(self.webpackChunkgeoregistry=self.webpackChunkgeoregistry||[]).push([[26],{18527:function(q){q.exports=function(){"use strict";var H=function(R,B){var Y={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},Je={on:function(Qe,rt,Ft){if(void 0===Y[Qe])throw new Error("Invalid event type: "+Qe);Y[Qe].push({selector:rt,fn:Ft})},render:function(Qe){B.store.featureChanged(Qe)}},tt=function(Qe,rt){for(var Ft=Y[Qe],Dt=Ft.length;Dt--;){var dn=Ft[Dt];if(dn.selector(rt)){dn.fn.call(Je,rt)||B.store.render(),B.ui.updateMapClasses();break}}};return R.start.call(Je),{render:R.render,stop:function(){R.stop&&R.stop()},trash:function(){R.trash&&(R.trash(),B.store.render())},combineFeatures:function(){R.combineFeatures&&R.combineFeatures()},uncombineFeatures:function(){R.uncombineFeatures&&R.uncombineFeatures()},drag:function(Qe){tt("drag",Qe)},click:function(Qe){tt("click",Qe)},mousemove:function(Qe){tt("mousemove",Qe)},mousedown:function(Qe){tt("mousedown",Qe)},mouseup:function(Qe){tt("mouseup",Qe)},mouseout:function(Qe){tt("mouseout",Qe)},keydown:function(Qe){tt("keydown",Qe)},keyup:function(Qe){tt("keyup",Qe)},touchstart:function(Qe){tt("touchstart",Qe)},touchmove:function(Qe){tt("touchmove",Qe)},touchend:function(Qe){tt("touchend",Qe)},tap:function(Qe){tt("tap",Qe)}}},v=6378137;function M(R){var B=0;if(R&&R.length>0){B+=Math.abs(D(R[0]));for(var Y=1;Y<R.length;Y++)B-=Math.abs(D(R[Y]))}return B}function D(R){var B,Y,Je,tt,Qe,rt,Ft=0,Dt=R.length;if(Dt>2){for(rt=0;rt<Dt;rt++)rt===Dt-2?(Je=Dt-2,tt=Dt-1,Qe=0):rt===Dt-1?(Je=Dt-1,tt=0,Qe=1):(Je=rt,tt=rt+1,Qe=rt+2),B=R[Je],Y=R[tt],Ft+=(d(R[Qe][0])-d(B[0]))*Math.sin(d(Y[1]));Ft=Ft*v*v/2}return Ft}function d(R){return R*Math.PI/180}var T_geometry=function R(B){var Y,Je=0;switch(B.type){case"Polygon":return M(B.coordinates);case"MultiPolygon":for(Y=0;Y<B.coordinates.length;Y++)Je+=M(B.coordinates[Y]);return Je;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Y=0;Y<B.geometries.length;Y++)Je+=R(B.geometries[Y]);return Je}},Q="active",le="mapbox-gl-draw-hot",e="mapbox-gl-draw-cold",de="add",he="move",Le="pointer",Ue="none",Ie={POLYGON:"polygon",LINE:"line_string",POINT:"point"},je="Feature",X="Polygon",ie="LineString",oe="Point",ae="FeatureCollection",me={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},Ye="draw.create",Et="draw.update",_n="feature",Lt="midpoint",gn="vertex",$n="true",pn="false",Ui=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Gi={Point:0,LineString:1,Polygon:2};function yi(R,B){var Y=Gi[R.geometry.type]-Gi[B.geometry.type];return 0===Y&&R.geometry.type===X?R.area-B.area:Y}function Di(R){if(this._items={},this._nums={},this._length=R?R.length:0,R)for(var B=0,Y=R.length;B<Y;B++)this.add(R[B]),void 0!==R[B]&&("string"==typeof R[B]?this._items[R[B]]=B:this._nums[R[B]]=B)}Di.prototype.add=function(R){return this.has(R)||(this._length++,"string"==typeof R?this._items[R]=this._length:this._nums[R]=this._length),this},Di.prototype.delete=function(R){return!1===this.has(R)||(this._length--,delete this._items[R],delete this._nums[R]),this},Di.prototype.has=function(R){return!("string"!=typeof R&&"number"!=typeof R||void 0===this._items[R]&&void 0===this._nums[R])},Di.prototype.values=function(){var R=this,B=[];return Object.keys(this._items).forEach(function(Y){B.push({k:Y,v:R._items[Y]})}),Object.keys(this._nums).forEach(function(Y){B.push({k:JSON.parse(Y),v:R._nums[Y]})}),B.sort(function(Y,Je){return Y.v-Je.v}).map(function(Y){return Y.k})},Di.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var gi=[_n,Lt,gn],Ni={click:function(R,B,Y){return Mo(R,B,Y,Y.options.clickBuffer)},touch:function(R,B,Y){return Mo(R,B,Y,Y.options.touchBuffer)}};function Mo(R,B,Y,Je){if(null===Y.map)return[];var dn,ut,tt=R?(void 0===(ut=Je)&&(ut=0),[[(dn=R).point.x-ut,dn.point.y-ut],[dn.point.x+ut,dn.point.y+ut]]):B,Qe={};Y.options.styles&&(Qe.layers=Y.options.styles.map(function(dn){return dn.id}));var rt=Y.map.queryRenderedFeatures(tt,Qe).filter(function(dn){return-1!==gi.indexOf(dn.properties.meta)}),Ft=new Di,Dt=[];return rt.forEach(function(dn){var ut=dn.properties.id;Ft.has(ut)||(Ft.add(ut),Dt.push(dn))}),function(dn){return dn.map(function(ut){return ut.geometry.type===X&&(ut.area=T_geometry({type:je,property:{},geometry:ut.geometry})),ut}).sort(yi).map(function(ut){return delete ut.area,ut})}(Dt)}function No(R,B){var Y=Ni.click(R,null,B),Je={mouse:Ue};return Y[0]&&(Je.mouse=Y[0].properties.active===$n?he:Le,Je.feature=Y[0].properties.meta),-1!==B.events.currentModeName().indexOf("draw")&&(Je.mouse=de),B.ui.queueMapClasses(Je),B.ui.updateMapClasses(),Y[0]}function vr(R,B){var Y=R.x-B.x,Je=R.y-B.y;return Math.sqrt(Y*Y+Je*Je)}function Oo(R,B,Y){void 0===Y&&(Y={});var Je=null!=Y.fineTolerance?Y.fineTolerance:4,tt=null!=Y.grossTolerance?Y.grossTolerance:12,Qe=null!=Y.interval?Y.interval:500;R.point=R.point||B.point,R.time=R.time||B.time;var rt=vr(R.point,B.point);return rt<Je||rt<tt&&B.time-R.time<Qe}function So(R,B,Y){void 0===Y&&(Y={});var Je=null!=Y.tolerance?Y.tolerance:25,tt=null!=Y.interval?Y.interval:250;return R.point=R.point||B.point,R.time=R.time||B.time,vr(R.point,B.point)<Je&&B.time-R.time<tt}function ra(R,B){return R(B={exports:{}},B.exports),B.exports}var aa=ra(function(R){var B=R.exports=function(Y,Je){if(Je||(Je=16),void 0===Y&&(Y=128),Y<=0)return"0";for(var tt=Math.log(Math.pow(2,Y))/Math.log(Je),Qe=2;tt===1/0;Qe*=2)tt=Math.log(Math.pow(2,Y/Qe))/Math.log(Je)*Qe;var rt=tt-Math.floor(tt),Ft="";for(Qe=0;Qe<Math.floor(tt);Qe++)Ft=Math.floor(Math.random()*Je).toString(Je)+Ft;if(rt){var Dt=Math.pow(Je,rt);Ft=Math.floor(Math.random()*Dt).toString(Je)+Ft}var dn=parseInt(Ft,Je);return dn!==1/0&&dn>=Math.pow(2,Y)?B(Y,Je):Ft};B.rack=function(Y,Je,tt){var Qe=function(Ft){var Dt=0;do{if(Dt++>10){if(!tt)throw new Error("too many ID collisions, use more bits");Y+=tt}var dn=B(Y,Je)}while(Object.hasOwnProperty.call(rt,dn));return rt[dn]=Ft,dn},rt=Qe.hats={};return Qe.get=function(Ft){return Qe.hats[Ft]},Qe.set=function(Ft,Dt){return Qe.hats[Ft]=Dt,Qe},Qe.bits=Y||128,Qe.base=Je||16,Qe}}),bo=function(R,B){this.ctx=R,this.properties=B.properties||{},this.coordinates=B.geometry.coordinates,this.id=B.id||aa(),this.type=B.geometry.type};bo.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},bo.prototype.incomingCoords=function(R){this.setCoordinates(R)},bo.prototype.setCoordinates=function(R){this.coordinates=R,this.changed()},bo.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},bo.prototype.setProperty=function(R,B){this.properties[R]=B},bo.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:je,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},bo.prototype.internal=function(R){var B={id:this.id,meta:_n,"meta:type":this.type,active:pn,mode:R};if(this.ctx.options.userProperties)for(var Y in this.properties)B["user_"+Y]=this.properties[Y];return{type:je,properties:B,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var tr=function(R,B){bo.call(this,R,B)};(tr.prototype=Object.create(bo.prototype)).isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},tr.prototype.updateCoordinate=function(R,B,Y){this.coordinates=3===arguments.length?[B,Y]:[R,B],this.changed()},tr.prototype.getCoordinate=function(){return this.getCoordinates()};var lo=function(R,B){bo.call(this,R,B)};(lo.prototype=Object.create(bo.prototype)).isValid=function(){return this.coordinates.length>1},lo.prototype.addCoordinate=function(R,B,Y){this.changed();var Je=parseInt(R,10);this.coordinates.splice(Je,0,[B,Y])},lo.prototype.getCoordinate=function(R){var B=parseInt(R,10);return JSON.parse(JSON.stringify(this.coordinates[B]))},lo.prototype.removeCoordinate=function(R){this.changed(),this.coordinates.splice(parseInt(R,10),1)},lo.prototype.updateCoordinate=function(R,B,Y){var Je=parseInt(R,10);this.coordinates[Je]=[B,Y],this.changed()};var Po=function(R,B){bo.call(this,R,B),this.coordinates=this.coordinates.map(function(Y){return Y.slice(0,-1)})};(Po.prototype=Object.create(bo.prototype)).isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every(function(R){return R.length>2})},Po.prototype.incomingCoords=function(R){this.coordinates=R.map(function(B){return B.slice(0,-1)}),this.changed()},Po.prototype.setCoordinates=function(R){this.coordinates=R,this.changed()},Po.prototype.addCoordinate=function(R,B,Y){this.changed();var Je=R.split(".").map(function(tt){return parseInt(tt,10)});this.coordinates[Je[0]].splice(Je[1],0,[B,Y])},Po.prototype.removeCoordinate=function(R){this.changed();var B=R.split(".").map(function(Je){return parseInt(Je,10)}),Y=this.coordinates[B[0]];Y&&(Y.splice(B[1],1),Y.length<3&&this.coordinates.splice(B[0],1))},Po.prototype.getCoordinate=function(R){var B=R.split(".").map(function(Je){return parseInt(Je,10)});return JSON.parse(JSON.stringify(this.coordinates[B[0]][B[1]]))},Po.prototype.getCoordinates=function(){return this.coordinates.map(function(R){return R.concat([R[0]])})},Po.prototype.updateCoordinate=function(R,B,Y){this.changed();var Je=R.split("."),tt=parseInt(Je[0],10),Qe=parseInt(Je[1],10);void 0===this.coordinates[tt]&&(this.coordinates[tt]=[]),this.coordinates[tt][Qe]=[B,Y]};var xa={MultiPoint:tr,MultiLineString:lo,MultiPolygon:Po},Ur=function(R,B,Y,Je,tt){var Qe=Y.split("."),rt=parseInt(Qe[0],10),Ft=Qe[1]?Qe.slice(1).join("."):null;return R[rt][B](Ft,Je,tt)},Eo=function(R,B){if(bo.call(this,R,B),delete this.coordinates,this.model=xa[B.geometry.type],void 0===this.model)throw new TypeError(B.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(B.geometry.coordinates)};function Bn(R){this.map=R.map,this.drawConfig=JSON.parse(JSON.stringify(R.options||{})),this._ctx=R}(Eo.prototype=Object.create(bo.prototype))._coordinatesToFeatures=function(R){var B=this,Y=this.model.bind(this);return R.map(function(Je){return new Y(B.ctx,{id:aa(),type:je,properties:{},geometry:{coordinates:Je,type:B.type.replace("Multi","")}})})},Eo.prototype.isValid=function(){return this.features.every(function(R){return R.isValid()})},Eo.prototype.setCoordinates=function(R){this.features=this._coordinatesToFeatures(R),this.changed()},Eo.prototype.getCoordinate=function(R){return Ur(this.features,"getCoordinate",R)},Eo.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(R){return R.type===X?R.getCoordinates():R.coordinates})))},Eo.prototype.updateCoordinate=function(R,B,Y){Ur(this.features,"updateCoordinate",R,B,Y),this.changed()},Eo.prototype.addCoordinate=function(R,B,Y){Ur(this.features,"addCoordinate",R,B,Y),this.changed()},Eo.prototype.removeCoordinate=function(R){Ur(this.features,"removeCoordinate",R),this.changed()},Eo.prototype.getFeatures=function(){return this.features},Bn.prototype.setSelected=function(R){return this._ctx.store.setSelected(R)},Bn.prototype.setSelectedCoordinates=function(R){var B=this;this._ctx.store.setSelectedCoordinates(R),R.reduce(function(Y,Je){return void 0===Y[Je.feature_id]&&(Y[Je.feature_id]=!0,B._ctx.store.get(Je.feature_id).changed()),Y},{})},Bn.prototype.getSelected=function(){return this._ctx.store.getSelected()},Bn.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Bn.prototype.isSelected=function(R){return this._ctx.store.isSelected(R)},Bn.prototype.getFeature=function(R){return this._ctx.store.get(R)},Bn.prototype.select=function(R){return this._ctx.store.select(R)},Bn.prototype.deselect=function(R){return this._ctx.store.deselect(R)},Bn.prototype.deleteFeature=function(R,B){return void 0===B&&(B={}),this._ctx.store.delete(R,B)},Bn.prototype.addFeature=function(R){return this._ctx.store.add(R)},Bn.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Bn.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Bn.prototype.setActionableState=function(R){return void 0===R&&(R={}),this._ctx.events.actionable({trash:R.trash||!1,combineFeatures:R.combineFeatures||!1,uncombineFeatures:R.uncombineFeatures||!1})},Bn.prototype.changeMode=function(R,B,Y){return void 0===B&&(B={}),void 0===Y&&(Y={}),this._ctx.events.changeMode(R,B,Y)},Bn.prototype.updateUIClasses=function(R){return this._ctx.ui.queueMapClasses(R)},Bn.prototype.activateUIButton=function(R){return this._ctx.ui.setActiveButton(R)},Bn.prototype.featuresAt=function(R,B,Y){if(void 0===Y&&(Y="click"),"click"!==Y&&"touch"!==Y)throw new Error("invalid buffer type");return Ni[Y](R,B,this._ctx)},Bn.prototype.newFeature=function(R){var B=R.geometry.type;return B===oe?new tr(this._ctx,R):B===ie?new lo(this._ctx,R):B===X?new Po(this._ctx,R):new Eo(this._ctx,R)},Bn.prototype.isInstanceOf=function(R,B){if(R===oe)return B instanceof tr;if(R===ie)return B instanceof lo;if(R===X)return B instanceof Po;if("MultiFeature"===R)return B instanceof Eo;throw new Error("Unknown feature class: "+R)},Bn.prototype.doRender=function(R){return this._ctx.store.featureChanged(R)},Bn.prototype.onSetup=function(){},Bn.prototype.onDrag=function(){},Bn.prototype.onClick=function(){},Bn.prototype.onMouseMove=function(){},Bn.prototype.onMouseDown=function(){},Bn.prototype.onMouseUp=function(){},Bn.prototype.onMouseOut=function(){},Bn.prototype.onKeyUp=function(){},Bn.prototype.onKeyDown=function(){},Bn.prototype.onTouchStart=function(){},Bn.prototype.onTouchMove=function(){},Bn.prototype.onTouchEnd=function(){},Bn.prototype.onTap=function(){},Bn.prototype.onStop=function(){},Bn.prototype.onTrash=function(){},Bn.prototype.onCombineFeature=function(){},Bn.prototype.onUncombineFeature=function(){},Bn.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var br={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},sl=Object.keys(br);function qr(R){return[].concat(R).filter(function(B){return void 0!==B})}function Ra(){var R=this;if(!R.ctx.map||void 0===R.ctx.map.getSource(le))return Dt();var B=R.ctx.events.currentModeName();R.ctx.ui.queueMapClasses({mode:B});var Y=[],Je=[];R.isDirty?Je=R.getAllIds():(Y=R.getChangedIds().filter(function(dn){return void 0!==R.get(dn)}),Je=R.sources.hot.filter(function(dn){return dn.properties.id&&-1===Y.indexOf(dn.properties.id)&&void 0!==R.get(dn.properties.id)}).map(function(dn){return dn.properties.id})),R.sources.hot=[];var tt=R.sources.cold.length;R.sources.cold=R.isDirty?[]:R.sources.cold.filter(function(dn){return-1===Y.indexOf(dn.properties.id||dn.properties.parent)});var Qe=tt!==R.sources.cold.length||Je.length>0;function rt(dn,ut){var tn=R.get(dn).internal(B);R.ctx.events.currentModeRender(tn,function(hn){R.sources[ut].push(hn)})}if(Y.forEach(function(dn){return rt(dn,"hot")}),Je.forEach(function(dn){return rt(dn,"cold")}),Qe&&R.ctx.map.getSource(e).setData({type:ae,features:R.sources.cold}),R.ctx.map.getSource(le).setData({type:ae,features:R.sources.hot}),R._emitSelectionChange&&(R.ctx.map.fire("draw.selectionchange",{features:R.getSelected().map(function(dn){return dn.toGeoJSON()}),points:R.getSelectedCoordinates().map(function(dn){return{type:je,properties:{},geometry:{type:oe,coordinates:dn.coordinates}}})}),R._emitSelectionChange=!1),R._deletedFeaturesToEmit.length){var Ft=R._deletedFeaturesToEmit.map(function(dn){return dn.toGeoJSON()});R._deletedFeaturesToEmit=[],R.ctx.map.fire("draw.delete",{features:Ft})}function Dt(){R.isDirty=!1,R.clearChangedIds()}Dt(),R.ctx.map.fire("draw.render",{})}function Ri(R){var B,Y=this;this._features={},this._featureIds=new Di,this._selectedFeatureIds=new Di,this._selectedCoordinates=[],this._changedFeatureIds=new Di,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=R,this.sources={hot:[],cold:[]},this.render=function(){B||(B=requestAnimationFrame(function(){B=null,Ra.call(Y)}))},this.isDirty=!1}function Fs(R,B){var Y=R._selectedCoordinates.filter(function(Je){return R._selectedFeatureIds.has(Je.feature_id)});R._selectedCoordinates.length===Y.length||B.silent||(R._emitSelectionChange=!0),R._selectedCoordinates=Y}Ri.prototype.createRenderBatch=function(){var R=this,B=this.render,Y=0;return this.render=function(){Y++},function(){R.render=B,Y>0&&R.render()}},Ri.prototype.setDirty=function(){return this.isDirty=!0,this},Ri.prototype.featureChanged=function(R){return this._changedFeatureIds.add(R),this},Ri.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Ri.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Ri.prototype.getAllIds=function(){return this._featureIds.values()},Ri.prototype.add=function(R){return this.featureChanged(R.id),this._features[R.id]=R,this._featureIds.add(R.id),this},Ri.prototype.delete=function(R,B){var Y=this;return void 0===B&&(B={}),qr(R).forEach(function(Je){Y._featureIds.has(Je)&&(Y._featureIds.delete(Je),Y._selectedFeatureIds.delete(Je),B.silent||-1===Y._deletedFeaturesToEmit.indexOf(Y._features[Je])&&Y._deletedFeaturesToEmit.push(Y._features[Je]),delete Y._features[Je],Y.isDirty=!0)}),Fs(this,B),this},Ri.prototype.get=function(R){return this._features[R]},Ri.prototype.getAll=function(){var R=this;return Object.keys(this._features).map(function(B){return R._features[B]})},Ri.prototype.select=function(R,B){var Y=this;return void 0===B&&(B={}),qr(R).forEach(function(Je){Y._selectedFeatureIds.has(Je)||(Y._selectedFeatureIds.add(Je),Y._changedFeatureIds.add(Je),B.silent||(Y._emitSelectionChange=!0))}),this},Ri.prototype.deselect=function(R,B){var Y=this;return void 0===B&&(B={}),qr(R).forEach(function(Je){Y._selectedFeatureIds.has(Je)&&(Y._selectedFeatureIds.delete(Je),Y._changedFeatureIds.add(Je),B.silent||(Y._emitSelectionChange=!0))}),Fs(this,B),this},Ri.prototype.clearSelected=function(R){return void 0===R&&(R={}),this.deselect(this._selectedFeatureIds.values(),{silent:R.silent}),this},Ri.prototype.setSelected=function(R,B){var Y=this;return void 0===B&&(B={}),R=qr(R),this.deselect(this._selectedFeatureIds.values().filter(function(Je){return-1===R.indexOf(Je)}),{silent:B.silent}),this.select(R.filter(function(Je){return!Y._selectedFeatureIds.has(Je)}),{silent:B.silent}),this},Ri.prototype.setSelectedCoordinates=function(R){return this._selectedCoordinates=R,this._emitSelectionChange=!0,this},Ri.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Ri.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Ri.prototype.getSelected=function(){var R=this;return this._selectedFeatureIds.values().map(function(B){return R.get(B)})},Ri.prototype.getSelectedCoordinates=function(){var R=this;return this._selectedCoordinates.map(function(B){return{coordinates:R.get(B.feature_id).getCoordinate(B.coord_path)}})},Ri.prototype.isSelected=function(R){return this._selectedFeatureIds.has(R)},Ri.prototype.setFeatureProperty=function(R,B,Y){this.get(R).setProperty(B,Y),this.featureChanged(R)},Ri.prototype.storeMapConfig=function(){var R=this;Ui.forEach(function(B){R.ctx.map[B]&&(R._mapInitialConfig[B]=R.ctx.map[B].isEnabled())})},Ri.prototype.restoreMapConfig=function(){var R=this;Object.keys(this._mapInitialConfig).forEach(function(B){R._mapInitialConfig[B]?R.ctx.map[B].enable():R.ctx.map[B].disable()})},Ri.prototype.getInitialConfigValue=function(R){return void 0===this._mapInitialConfig[R]||this._mapInitialConfig[R]};var qi=function(){for(var R=arguments,B={},Y=0;Y<arguments.length;Y++){var Je=R[Y];for(var tt in Je)te.call(Je,tt)&&(B[tt]=Je[tt])}return B},te=Object.prototype.hasOwnProperty,re=["mode","feature","mouse"];function fe(R){var B=null,Y=null,Je={onRemove:function(){return R.map.off("load",Je.connect),clearInterval(Y),Je.removeLayers(),R.store.restoreMapConfig(),R.ui.removeButtons(),R.events.removeEventListeners(),R.ui.clearMapClasses(),R.map=null,R.container=null,R.store=null,B&&B.parentNode&&B.parentNode.removeChild(B),B=null,this},connect:function(){R.map.off("load",Je.connect),clearInterval(Y),Je.addLayers(),R.store.storeMapConfig(),R.events.addEventListeners()},onAdd:function(tt){var Qe=tt.fire;return tt.fire=function(rt,Ft){var Dt=arguments;return 1===Qe.length&&1!==arguments.length&&(Dt=[qi({},{type:rt},Ft)]),Qe.apply(tt,Dt)},R.map=tt,R.events=function(rt){var Ft=Object.keys(rt.options.modes).reduce(function(Ot,yn){return Ot[yn]=function Ca(R){var B=Object.keys(R);return function(Y,Je){void 0===Je&&(Je={});var tt={},Qe=B.reduce(function(rt,Ft){return rt[Ft]=R[Ft],rt},new Bn(Y));return{start:function(){var rt=this;tt=Qe.onSetup(Je),sl.forEach(function(Ft){var Dt,dn=br[Ft],ut=function(){return!1};R[dn]&&(ut=function(){return!0}),rt.on(Ft,ut,(Dt=dn,function(tn){return Qe[Dt](tt,tn)}))})},stop:function(){Qe.onStop(tt)},trash:function(){Qe.onTrash(tt)},combineFeatures:function(){Qe.onCombineFeatures(tt)},uncombineFeatures:function(){Qe.onUncombineFeatures(tt)},render:function(rt,Ft){Qe.toDisplayFeatures(tt,rt,Ft)}}}}(rt.options.modes[yn]),Ot},{}),Dt={},dn={},ut={},tn=null,hn=null;ut.drag=function(Ot,yn){yn({point:Ot.point,time:(new Date).getTime()})?(rt.ui.queueMapClasses({mouse:"drag"}),hn.drag(Ot)):Ot.originalEvent.stopPropagation()},ut.mousedrag=function(Ot){ut.drag(Ot,function(yn){return!Oo(Dt,yn)})},ut.touchdrag=function(Ot){ut.drag(Ot,function(yn){return!So(dn,yn)})},ut.mousemove=function(Ot){if(1===(void 0!==Ot.originalEvent.buttons?Ot.originalEvent.buttons:Ot.originalEvent.which))return ut.mousedrag(Ot);var yn=No(Ot,rt);Ot.featureTarget=yn,hn.mousemove(Ot)},ut.mousedown=function(Ot){Dt={time:(new Date).getTime(),point:Ot.point};var yn=No(Ot,rt);Ot.featureTarget=yn,hn.mousedown(Ot)},ut.mouseup=function(Ot){var yn=No(Ot,rt);Ot.featureTarget=yn,Oo(Dt,{point:Ot.point,time:(new Date).getTime()})?hn.click(Ot):hn.mouseup(Ot)},ut.mouseout=function(Ot){hn.mouseout(Ot)},ut.touchstart=function(Ot){if(Ot.originalEvent.preventDefault(),rt.options.touchEnabled){dn={time:(new Date).getTime(),point:Ot.point};var yn=Ni.touch(Ot,null,rt)[0];Ot.featureTarget=yn,hn.touchstart(Ot)}},ut.touchmove=function(Ot){if(Ot.originalEvent.preventDefault(),rt.options.touchEnabled)return hn.touchmove(Ot),ut.touchdrag(Ot)},ut.touchend=function(Ot){if(Ot.originalEvent.preventDefault(),rt.options.touchEnabled){var yn=Ni.touch(Ot,null,rt)[0];Ot.featureTarget=yn,So(dn,{time:(new Date).getTime(),point:Ot.point})?hn.tap(Ot):hn.touchend(Ot)}};var In=function(Ot){return!(8===Ot||46===Ot||Ot>=48&&Ot<=57)};function Nn(Ot,yn,Zt){void 0===Zt&&(Zt={}),hn.stop();var ci=Ft[Ot];if(void 0===ci)throw new Error(Ot+" is not valid");tn=Ot;var Ji=ci(rt,yn);hn=H(Ji,rt),Zt.silent||rt.map.fire("draw.modechange",{mode:Ot}),rt.store.setDirty(),rt.store.render()}ut.keydown=function(Ot){"mapboxgl-canvas"===(Ot.srcElement||Ot.target).classList[0]&&(8!==Ot.keyCode&&46!==Ot.keyCode||!rt.options.controls.trash?In(Ot.keyCode)?hn.keydown(Ot):49===Ot.keyCode&&rt.options.controls.point?Nn(me.DRAW_POINT):50===Ot.keyCode&&rt.options.controls.line_string?Nn(me.DRAW_LINE_STRING):51===Ot.keyCode&&rt.options.controls.polygon&&Nn(me.DRAW_POLYGON):(Ot.preventDefault(),hn.trash()))},ut.keyup=function(Ot){In(Ot.keyCode)&&hn.keyup(Ot)},ut.zoomend=function(){rt.store.changeZoom()},ut.data=function(Ot){if("style"===Ot.dataType){var yn=rt.setup,Zt=rt.map,Ji=rt.store;rt.options.styles.some(function(Tn){return Zt.getLayer(Tn.id)})||(yn.addLayers(),Ji.setDirty(),Ji.render())}};var Wi={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){hn=H(Ft[tn=rt.options.defaultMode](rt),rt)},changeMode:Nn,actionable:function(Ot){var yn=!1;Object.keys(Ot).forEach(function(Zt){if(void 0===Wi[Zt])throw new Error("Invalid action type");Wi[Zt]!==Ot[Zt]&&(yn=!0),Wi[Zt]=Ot[Zt]}),yn&&rt.map.fire("draw.actionable",{actions:Wi})},currentModeName:function(){return tn},currentModeRender:function(Ot,yn){return hn.render(Ot,yn)},fire:function(Ot,yn){ut[Ot]&&ut[Ot](yn)},addEventListeners:function(){rt.map.on("mousemove",ut.mousemove),rt.map.on("mousedown",ut.mousedown),rt.map.on("mouseup",ut.mouseup),rt.map.on("data",ut.data),rt.map.on("touchmove",ut.touchmove),rt.map.on("touchstart",ut.touchstart),rt.map.on("touchend",ut.touchend),rt.container.addEventListener("mouseout",ut.mouseout),rt.options.keybindings&&(rt.container.addEventListener("keydown",ut.keydown),rt.container.addEventListener("keyup",ut.keyup))},removeEventListeners:function(){rt.map.off("mousemove",ut.mousemove),rt.map.off("mousedown",ut.mousedown),rt.map.off("mouseup",ut.mouseup),rt.map.off("data",ut.data),rt.map.off("touchmove",ut.touchmove),rt.map.off("touchstart",ut.touchstart),rt.map.off("touchend",ut.touchend),rt.container.removeEventListener("mouseout",ut.mouseout),rt.options.keybindings&&(rt.container.removeEventListener("keydown",ut.keydown),rt.container.removeEventListener("keyup",ut.keyup))},trash:function(Ot){hn.trash(Ot)},combineFeatures:function(){hn.combineFeatures()},uncombineFeatures:function(){hn.uncombineFeatures()},getMode:function(){return tn}}}(R),R.ui=function(rt){var Ft={},Dt=null,dn={mode:null,feature:null,mouse:null},ut={mode:null,feature:null,mouse:null};function tn(Ot){ut=qi(ut,Ot)}function hn(){var Ot,yn;if(rt.container){var Zt=[],ci=[];re.forEach(function(Ji){ut[Ji]!==dn[Ji]&&(Zt.push(Ji+"-"+dn[Ji]),null!==ut[Ji]&&ci.push(Ji+"-"+ut[Ji]))}),Zt.length>0&&(Ot=rt.container.classList).remove.apply(Ot,Zt),ci.length>0&&(yn=rt.container.classList).add.apply(yn,ci),dn=qi(dn,ut)}}function In(Ot,yn){void 0===yn&&(yn={});var Zt=document.createElement("button");return Zt.className="mapbox-gl-draw_ctrl-draw-btn "+yn.className,Zt.setAttribute("title",yn.title),yn.container.appendChild(Zt),Zt.addEventListener("click",function(ci){if(ci.preventDefault(),ci.stopPropagation(),ci.target===Dt)return Nn(),void yn.onDeactivate();Wi(Ot),yn.onActivate()},!0),Zt}function Nn(){Dt&&(Dt.classList.remove(Q),Dt=null)}function Wi(Ot){Nn();var yn=Ft[Ot];yn&&yn&&"trash"!==Ot&&(yn.classList.add(Q),Dt=yn)}return{setActiveButton:Wi,queueMapClasses:tn,updateMapClasses:hn,clearMapClasses:function(){tn({mode:null,feature:null,mouse:null}),hn()},addButtons:function(){var Ot=rt.options.controls,yn=document.createElement("div");return yn.className="mapboxgl-ctrl-group mapboxgl-ctrl",Ot&&(Ot[Ie.LINE]&&(Ft[Ie.LINE]=In(Ie.LINE,{container:yn,className:"mapbox-gl-draw_line",title:"LineString tool "+(rt.options.keybindings?"(l)":""),onActivate:function(){return rt.events.changeMode(me.DRAW_LINE_STRING)},onDeactivate:function(){return rt.events.trash()}})),Ot[Ie.POLYGON]&&(Ft[Ie.POLYGON]=In(Ie.POLYGON,{container:yn,className:"mapbox-gl-draw_polygon",title:"Polygon tool "+(rt.options.keybindings?"(p)":""),onActivate:function(){return rt.events.changeMode(me.DRAW_POLYGON)},onDeactivate:function(){return rt.events.trash()}})),Ot[Ie.POINT]&&(Ft[Ie.POINT]=In(Ie.POINT,{container:yn,className:"mapbox-gl-draw_point",title:"Marker tool "+(rt.options.keybindings?"(m)":""),onActivate:function(){return rt.events.changeMode(me.DRAW_POINT)},onDeactivate:function(){return rt.events.trash()}})),Ot.trash&&(Ft.trash=In("trash",{container:yn,className:"mapbox-gl-draw_trash",title:"Delete",onActivate:function(){rt.events.trash()}})),Ot.combine_features&&(Ft.combine_features=In("combineFeatures",{container:yn,className:"mapbox-gl-draw_combine",title:"Combine",onActivate:function(){rt.events.combineFeatures()}})),Ot.uncombine_features&&(Ft.uncombine_features=In("uncombineFeatures",{container:yn,className:"mapbox-gl-draw_uncombine",title:"Uncombine",onActivate:function(){rt.events.uncombineFeatures()}}))),yn},removeButtons:function(){Object.keys(Ft).forEach(function(Ot){var yn=Ft[Ot];yn.parentNode&&yn.parentNode.removeChild(yn),delete Ft[Ot]})}}}(R),R.container=tt.getContainer(),R.store=new Ri(R),B=R.ui.addButtons(),R.options.boxSelect&&(tt.boxZoom.disable(),tt.dragPan.disable(),tt.dragPan.enable()),tt.loaded()?Je.connect():(tt.on("load",Je.connect),Y=setInterval(function(){tt.loaded()&&Je.connect()},16)),R.events.start(),B},addLayers:function(){R.map.addSource(e,{data:{type:ae,features:[]},type:"geojson"}),R.map.addSource(le,{data:{type:ae,features:[]},type:"geojson"}),R.options.styles.forEach(function(tt){R.map.addLayer(tt)}),R.store.setDirty(!0),R.store.render()},removeLayers:function(){R.options.styles.forEach(function(tt){R.map.getLayer(tt.id)&&R.map.removeLayer(tt.id)}),R.map.getSource(e)&&R.map.removeSource(e),R.map.getSource(le)&&R.map.removeSource(le)}};return R.setup=Je,Je}function Ce(R){return function(B){var Y=B.featureTarget;return!!Y&&!!Y.properties&&Y.properties.meta===R}}function Pe(R){return!!R.featureTarget&&!!R.featureTarget.properties&&R.featureTarget.properties.active===$n&&R.featureTarget.properties.meta===_n}function qe(R){return!!R.featureTarget&&!!R.featureTarget.properties&&R.featureTarget.properties.active===pn&&R.featureTarget.properties.meta===_n}function Ge(R){return void 0===R.featureTarget}function ye(R){var B=R.featureTarget;return!!B&&!!B.properties&&B.properties.meta===gn}function Ze(R){return!!R.originalEvent&&!0===R.originalEvent.shiftKey}function $e(R){return 27===R.keyCode}function Mt(R){return 13===R.keyCode}var It=ht;function ht(R,B){this.x=R,this.y=B}function At(R,B){var Y=B.getBoundingClientRect();return new It(R.clientX-Y.left-(B.clientLeft||0),R.clientY-Y.top-(B.clientTop||0))}function sn(R,B,Y,Je){return{type:je,properties:{meta:gn,parent:R,coord_path:Y,active:Je?$n:pn},geometry:{type:oe,coordinates:B}}}function an(R,B,Y){void 0===B&&(B={}),void 0===Y&&(Y=null);var Je,tt=R.geometry,Qe=tt.type,rt=tt.coordinates,Ft=R.properties&&R.properties.id,Dt=[];function dn(tn,hn){var In="",Nn=null;tn.forEach(function(Wi,Ot){var yn=null!=hn?hn+"."+Ot:String(Ot),Zt=sn(Ft,Wi,yn,ut(yn));if(B.midpoints&&Nn){var ci=function(Tn,Br,xr){var ui=Br.geometry.coordinates,Ir=xr.geometry.coordinates;if(ui[1]>85||ui[1]<-85||Ir[1]>85||Ir[1]<-85)return null;var Hi={lng:(ui[0]+Ir[0])/2,lat:(ui[1]+Ir[1])/2};return{type:je,properties:{meta:Lt,parent:Tn,lng:Hi.lng,lat:Hi.lat,coord_path:xr.properties.coord_path},geometry:{type:oe,coordinates:[Hi.lng,Hi.lat]}}}(Ft,Nn,Zt);ci&&Dt.push(ci)}Nn=Zt;var Ji=JSON.stringify(Wi);In!==Ji&&Dt.push(Zt),0===Ot&&(In=Ji)})}function ut(tn){return!!B.selectedPaths&&-1!==B.selectedPaths.indexOf(tn)}return Qe===oe?Dt.push(sn(Ft,rt,Y,ut(Y))):Qe===X?rt.forEach(function(tn,hn){dn(tn,null!==Y?Y+"."+hn:String(hn))}):Qe===ie?dn(rt,Y):0===Qe.indexOf("Multi")&&(Je=Qe.replace("Multi",""),rt.forEach(function(tn,hn){Dt=Dt.concat(an({type:je,properties:R.properties,geometry:{type:Je,coordinates:tn}},B,hn))})),Dt}ht.prototype={clone:function(){return new ht(this.x,this.y)},add:function(R){return this.clone()._add(R)},sub:function(R){return this.clone()._sub(R)},multByPoint:function(R){return this.clone()._multByPoint(R)},divByPoint:function(R){return this.clone()._divByPoint(R)},mult:function(R){return this.clone()._mult(R)},div:function(R){return this.clone()._div(R)},rotate:function(R){return this.clone()._rotate(R)},rotateAround:function(R,B){return this.clone()._rotateAround(R,B)},matMult:function(R){return this.clone()._matMult(R)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(R){return this.x===R.x&&this.y===R.y},dist:function(R){return Math.sqrt(this.distSqr(R))},distSqr:function(R){var B=R.x-this.x,Y=R.y-this.y;return B*B+Y*Y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(R){return Math.atan2(this.y-R.y,this.x-R.x)},angleWith:function(R){return this.angleWithSep(R.x,R.y)},angleWithSep:function(R,B){return Math.atan2(this.x*B-this.y*R,this.x*R+this.y*B)},_matMult:function(R){var Y=R[2]*this.x+R[3]*this.y;return this.x=R[0]*this.x+R[1]*this.y,this.y=Y,this},_add:function(R){return this.x+=R.x,this.y+=R.y,this},_sub:function(R){return this.x-=R.x,this.y-=R.y,this},_mult:function(R){return this.x*=R,this.y*=R,this},_div:function(R){return this.x/=R,this.y/=R,this},_multByPoint:function(R){return this.x*=R.x,this.y*=R.y,this},_divByPoint:function(R){return this.x/=R.x,this.y/=R.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var R=this.y;return this.y=this.x,this.x=-R,this},_rotate:function(R){var B=Math.cos(R),Y=Math.sin(R),tt=Y*this.x+B*this.y;return this.x=B*this.x-Y*this.y,this.y=tt,this},_rotateAround:function(R,B){var Y=Math.cos(R),Je=Math.sin(R),Qe=B.y+Je*(this.x-B.x)+Y*(this.y-B.y);return this.x=B.x+Y*(this.x-B.x)-Je*(this.y-B.y),this.y=Qe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ht.convert=function(R){return R instanceof ht?R:Array.isArray(R)?new ht(R[0],R[1]):R};var ft=function(R){setTimeout(function(){R.map&&R.map.doubleClickZoom&&R._ctx&&R._ctx.store&&R._ctx.store.getInitialConfigValue&&R._ctx.store.getInitialConfigValue("doubleClickZoom")&&R.map.doubleClickZoom.enable()},0)},Qt=function(R){setTimeout(function(){R.map&&R.map.doubleClickZoom&&R.map.doubleClickZoom.disable()},0)},Jt=function(R){if(!R||!R.type)return null;var B=Yt[R.type];return B?"geometry"===B?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:R}]}:"feature"===B?{type:"FeatureCollection",features:[R]}:"featurecollection"===B?R:void 0:null},Yt={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function Gn(R){switch(R&&R.type||null){case"FeatureCollection":return R.features=R.features.reduce(function(B,Y){return B.concat(Gn(Y))},[]),R;case"Feature":return R.geometry?Gn(R.geometry).map(function(B){var Y={type:"Feature",properties:JSON.parse(JSON.stringify(R.properties)),geometry:B};return void 0!==R.id&&(Y.id=R.id),Y}):[R];case"MultiPoint":return R.coordinates.map(function(B){return{type:"Point",coordinates:B}});case"MultiPolygon":return R.coordinates.map(function(B){return{type:"Polygon",coordinates:B}});case"MultiLineString":return R.coordinates.map(function(B){return{type:"LineString",coordinates:B}});case"GeometryCollection":return R.geometries.map(Gn).reduce(function(B,Y){return B.concat(Y)},[]);case"Point":case"Polygon":case"LineString":return[R]}}var li=ra(function(R){var B=R.exports=function(ut){return new Y(ut)};function Y(ut){this.value=ut}function Je(ut,tn,hn){var In=[],Nn=[],Wi=!0;return function Ot(yn){var Zt=hn?tt(yn):yn,ci={},Ji=!0,Tn={node:Zt,node_:yn,path:[].concat(In),parent:Nn[Nn.length-1],parents:Nn,key:In.slice(-1)[0],isRoot:0===In.length,level:In.length,circular:null,update:function(ui,Ir){Tn.isRoot||(Tn.parent.node[Tn.key]=ui),Tn.node=ui,Ir&&(Ji=!1)},delete:function(ui){delete Tn.parent.node[Tn.key],ui&&(Ji=!1)},remove:function(ui){Ft(Tn.parent.node)?Tn.parent.node.splice(Tn.key,1):delete Tn.parent.node[Tn.key],ui&&(Ji=!1)},keys:null,before:function(ui){ci.before=ui},after:function(ui){ci.after=ui},pre:function(ui){ci.pre=ui},post:function(ui){ci.post=ui},stop:function(){Wi=!1},block:function(){Ji=!1}};if(!Wi)return Tn;function Br(){if("object"==typeof Tn.node&&null!==Tn.node){Tn.keys&&Tn.node_===Tn.node||(Tn.keys=Qe(Tn.node)),Tn.isLeaf=0==Tn.keys.length;for(var ui=0;ui<Nn.length;ui++)if(Nn[ui].node_===yn){Tn.circular=Nn[ui];break}}else Tn.isLeaf=!0,Tn.keys=null;Tn.notLeaf=!Tn.isLeaf,Tn.notRoot=!Tn.isRoot}Br();var xr=tn.call(Tn,Tn.node);return void 0!==xr&&Tn.update&&Tn.update(xr),ci.before&&ci.before.call(Tn,Tn.node),Ji&&("object"!=typeof Tn.node||null===Tn.node||Tn.circular||(Nn.push(Tn),Br(),Dt(Tn.keys,function(ui,Ir){In.push(ui),ci.pre&&ci.pre.call(Tn,Tn.node[ui],ui);var Hi=Ot(Tn.node[ui]);hn&&dn.call(Tn.node,ui)&&(Tn.node[ui]=Hi.node),Hi.isLast=Ir==Tn.keys.length-1,Hi.isFirst=0==Ir,ci.post&&ci.post.call(Tn,Hi),In.pop()}),Nn.pop()),ci.after&&ci.after.call(Tn,Tn.node)),Tn}(ut).node}function tt(ut){if("object"==typeof ut&&null!==ut){var tn;if(Ft(ut))tn=[];else if("[object Date]"===rt(ut))tn=new Date(ut.getTime?ut.getTime():ut);else if("[object RegExp]"===rt(ut))tn=new RegExp(ut);else if("[object Error]"===rt(ut))tn={message:ut.message};else if(function(Nn){return"[object Boolean]"===rt(Nn)}(ut))tn=new Boolean(ut);else if(function(Nn){return"[object Number]"===rt(Nn)}(ut))tn=new Number(ut);else if(function(Nn){return"[object String]"===rt(Nn)}(ut))tn=new String(ut);else if(Object.create&&Object.getPrototypeOf)tn=Object.create(Object.getPrototypeOf(ut));else if(ut.constructor===Object)tn={};else{var In=function(){};In.prototype=ut.constructor&&ut.constructor.prototype||ut.__proto__||{},tn=new In}return Dt(Qe(ut),function(Nn){tn[Nn]=ut[Nn]}),tn}return ut}Y.prototype.get=function(ut){for(var tn=this.value,hn=0;hn<ut.length;hn++){var In=ut[hn];if(!tn||!dn.call(tn,In)){tn=void 0;break}tn=tn[In]}return tn},Y.prototype.has=function(ut){for(var tn=this.value,hn=0;hn<ut.length;hn++){var In=ut[hn];if(!tn||!dn.call(tn,In))return!1;tn=tn[In]}return!0},Y.prototype.set=function(ut,tn){for(var hn=this.value,In=0;In<ut.length-1;In++){var Nn=ut[In];dn.call(hn,Nn)||(hn[Nn]={}),hn=hn[Nn]}return hn[ut[In]]=tn,tn},Y.prototype.map=function(ut){return Je(this.value,ut,!0)},Y.prototype.forEach=function(ut){return this.value=Je(this.value,ut,!1),this.value},Y.prototype.reduce=function(ut,tn){var hn=1===arguments.length,In=hn?this.value:tn;return this.forEach(function(Nn){this.isRoot&&hn||(In=ut.call(this,In,Nn))}),In},Y.prototype.paths=function(){var ut=[];return this.forEach(function(tn){ut.push(this.path)}),ut},Y.prototype.nodes=function(){var ut=[];return this.forEach(function(tn){ut.push(this.node)}),ut},Y.prototype.clone=function(){var ut=[],tn=[];return function hn(In){for(var Nn=0;Nn<ut.length;Nn++)if(ut[Nn]===In)return tn[Nn];if("object"==typeof In&&null!==In){var Wi=tt(In);return ut.push(In),tn.push(Wi),Dt(Qe(In),function(Ot){Wi[Ot]=hn(In[Ot])}),ut.pop(),tn.pop(),Wi}return In}(this.value)};var Qe=Object.keys||function(ut){var tn=[];for(var hn in ut)tn.push(hn);return tn};function rt(ut){return Object.prototype.toString.call(ut)}var Ft=Array.isArray||function(ut){return"[object Array]"===Object.prototype.toString.call(ut)},Dt=function(ut,tn){if(ut.forEach)return ut.forEach(tn);for(var hn=0;hn<ut.length;hn++)tn(ut[hn],hn,ut)};Dt(Qe(Y.prototype),function(ut){B[ut]=function(tn){var hn=[].slice.call(arguments,1),In=new Y(tn);return In[ut].apply(In,hn)}});var dn=Object.hasOwnProperty||function(ut,tn){return tn in ut}}),zi=zn;function zn(R){if(!(this instanceof zn))return new zn(R);this._bbox=R||[1/0,1/0,-1/0,-1/0],this._valid=!!R}zn.prototype.include=function(R){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],R[0]),this._bbox[1]=Math.min(this._bbox[1],R[1]),this._bbox[2]=Math.max(this._bbox[2],R[0]),this._bbox[3]=Math.max(this._bbox[3],R[1]),this},zn.prototype.equals=function(R){var B;return B=R instanceof zn?R.bbox():R,this._bbox[0]==B[0]&&this._bbox[1]==B[1]&&this._bbox[2]==B[2]&&this._bbox[3]==B[3]},zn.prototype.center=function(R){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},zn.prototype.union=function(R){var B;return this._valid=!0,B=R instanceof zn?R.bbox():R,this._bbox[0]=Math.min(this._bbox[0],B[0]),this._bbox[1]=Math.min(this._bbox[1],B[1]),this._bbox[2]=Math.max(this._bbox[2],B[2]),this._bbox[3]=Math.max(this._bbox[3],B[3]),this},zn.prototype.bbox=function(){return this._valid?this._bbox:null},zn.prototype.contains=function(R){if(!R)return this._fastContains();if(!this._valid)return null;var B=R[0],Y=R[1];return this._bbox[0]<=B&&this._bbox[1]<=Y&&this._bbox[2]>=B&&this._bbox[3]>=Y},zn.prototype.intersect=function(R){return this._valid?(B=R instanceof zn?R.bbox():R,!(this._bbox[0]>B[2]||this._bbox[2]<B[0]||this._bbox[3]<B[1]||this._bbox[1]>B[3])):null;var B},zn.prototype._fastContains=function(){return this._valid?new Function("ll","return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]"):new Function("return null;")},zn.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var vi={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},ri=Object.keys(vi),jo=function(R){return Ci(R).bbox()};function Ci(R){for(var B=zi(),Y=function(R){if(!R)return[];var B=Gn(Jt(R)),Y=[];return B.features.forEach(function(Je){Je.geometry&&(Y=Y.concat(function tt(Qe){return Array.isArray(Qe)&&Qe.length&&"number"==typeof Qe[0]?[Qe]:Qe.reduce(function(rt,Ft){return Array.isArray(Ft)&&Array.isArray(Ft[0])?rt.concat(tt(Ft)):(rt.push(Ft),rt)},[])}(Je.geometry.coordinates)))}),Y}(R),Je=0;Je<Y.length;Je++)B.include(Y[Je]);return B}function eo(R,B){var Y=-90,Je=90,tt=-90,Qe=90,rt=270,Ft=-270;R.forEach(function(dn){var ut=jo(dn),tn=ut[1],hn=ut[3],In=ut[0],Nn=ut[2];tn>Y&&(Y=tn),hn<Je&&(Je=hn),hn>tt&&(tt=hn),tn<Qe&&(Qe=tn),In<rt&&(rt=In),Nn>Ft&&(Ft=Nn)});var Dt=B;return Y+Dt.lat>85&&(Dt.lat=85-Y),tt+Dt.lat>90&&(Dt.lat=90-tt),Je+Dt.lat<-85&&(Dt.lat=-85-Je),Qe+Dt.lat<-90&&(Dt.lat=-90-Qe),rt+Dt.lng<=-270&&(Dt.lng+=360*Math.ceil(Math.abs(Dt.lng)/360)),Ft+Dt.lng>=270&&(Dt.lng-=360*Math.ceil(Math.abs(Dt.lng)/360)),Dt}function Oi(R,B){var Y=eo(R.map(function(Je){return Je.toGeoJSON()}),B);R.forEach(function(Je){var tt,Qe=Je.getCoordinates(),rt=function(Dt){var dn={lng:Dt[0]+Y.lng,lat:Dt[1]+Y.lat};return[dn.lng,dn.lat]},Ft=function(Dt){return Dt.map(function(dn){return rt(dn)})};Je.type===oe?tt=rt(Qe):Je.type===ie||"MultiPoint"===Je.type?tt=Qe.map(rt):Je.type===X||"MultiLineString"===Je.type?tt=Qe.map(Ft):"MultiPolygon"===Je.type&&(tt=Qe.map(function(Dt){return Dt.map(function(dn){return Ft(dn)})})),Je.incomingCoords(tt)})}jo.polygon=function(R){return Ci(R).polygon()},jo.bboxify=function(R){return li(R).map(function(B){B&&ri.some(function(Y){return!!B[Y]&&-1!==vi[Y].indexOf(B.type)})&&(B.bbox=Ci(B).bbox(),this.update(B))})};var Zn={onSetup:function(R){var B=this,Y={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:R.featureIds||[]};return this.setSelected(Y.initiallySelectedFeatureIds.filter(function(Je){return void 0!==B.getFeature(Je)})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Y},fireUpdate:function(){this.map.fire(Et,{action:"move",features:this.getSelected().map(function(R){return R.toGeoJSON()})})},fireActionable:function(){var R=this,B=this.getSelected(),Y=B.filter(function(Ft){return R.isInstanceOf("MultiFeature",Ft)}),Je=!1;if(B.length>1){Je=!0;var tt=B[0].type.replace("Multi","");B.forEach(function(Ft){Ft.type.replace("Multi","")!==tt&&(Je=!1)})}this.setActionableState({combineFeatures:Je,uncombineFeatures:Y.length>0,trash:B.length>0})},getUniqueIds:function(R){return R.length?R.map(function(B){return B.properties.id}).filter(function(B){return void 0!==B}).reduce(function(B,Y){return B.add(Y),B},new Di).values():[]},stopExtendedInteractions:function(R){R.boxSelectElement&&(R.boxSelectElement.parentNode&&R.boxSelectElement.parentNode.removeChild(R.boxSelectElement),R.boxSelectElement=null),this.map.dragPan.enable(),R.boxSelecting=!1,R.canBoxSelect=!1,R.dragMoving=!1,R.canDragMove=!1},onStop:function(){ft(this)},onMouseMove:function(R){return this.stopExtendedInteractions(R),!0},onMouseOut:function(R){return!R.dragMoving||this.fireUpdate()}};Zn.onTap=Zn.onClick=function(R,B){return Ge(B)?this.clickAnywhere(R,B):Ce(gn)(B)?this.clickOnVertex(R,B):(Y=B).featureTarget&&Y.featureTarget.properties&&Y.featureTarget.properties.meta===_n?this.clickOnFeature(R,B):void 0;var Y},Zn.clickAnywhere=function(R){var B=this,Y=this.getSelectedIds();Y.length&&(this.clearSelectedFeatures(),Y.forEach(function(Je){return B.doRender(Je)})),ft(this),this.stopExtendedInteractions(R)},Zn.clickOnVertex=function(R,B){this.changeMode(me.DIRECT_SELECT,{featureId:B.featureTarget.properties.parent,coordPath:B.featureTarget.properties.coord_path,startPos:B.lngLat}),this.updateUIClasses({mouse:he})},Zn.startOnActiveFeature=function(R,B){this.stopExtendedInteractions(R),this.map.dragPan.disable(),this.doRender(B.featureTarget.properties.id),R.canDragMove=!0,R.dragMoveLocation=B.lngLat},Zn.clickOnFeature=function(R,B){var Y=this;Qt(this),this.stopExtendedInteractions(R);var Je=Ze(B),tt=this.getSelectedIds(),Qe=B.featureTarget.properties.id,rt=this.isSelected(Qe);if(!Je&&rt&&this.getFeature(Qe).type!==oe)return this.changeMode(me.DIRECT_SELECT,{featureId:Qe});rt&&Je?(this.deselect(Qe),this.updateUIClasses({mouse:Le}),1===tt.length&&ft(this)):!rt&&Je?(this.select(Qe),this.updateUIClasses({mouse:he})):rt||Je||(tt.forEach(function(Ft){return Y.doRender(Ft)}),this.setSelected(Qe),this.updateUIClasses({mouse:he})),this.doRender(Qe)},Zn.onMouseDown=function(R,B){return Pe(B)?this.startOnActiveFeature(R,B):this.drawConfig.boxSelect&&(Y=B).originalEvent&&Y.originalEvent.shiftKey&&0===Y.originalEvent.button?this.startBoxSelect(R,B):void 0;var Y},Zn.startBoxSelect=function(R,B){this.stopExtendedInteractions(R),this.map.dragPan.disable(),R.boxSelectStartLocation=At(B.originalEvent,this.map.getContainer()),R.canBoxSelect=!0},Zn.onTouchStart=function(R,B){if(Pe(B))return this.startOnActiveFeature(R,B)},Zn.onDrag=function(R,B){return R.canDragMove?this.dragMove(R,B):this.drawConfig.boxSelect&&R.canBoxSelect?this.whileBoxSelect(R,B):void 0},Zn.whileBoxSelect=function(R,B){R.boxSelecting=!0,this.updateUIClasses({mouse:de}),R.boxSelectElement||(R.boxSelectElement=document.createElement("div"),R.boxSelectElement.classList.add("mapbox-gl-draw_boxselect"),this.map.getContainer().appendChild(R.boxSelectElement));var Y=At(B.originalEvent,this.map.getContainer()),Je=Math.min(R.boxSelectStartLocation.x,Y.x),tt=Math.max(R.boxSelectStartLocation.x,Y.x),Qe=Math.min(R.boxSelectStartLocation.y,Y.y),rt=Math.max(R.boxSelectStartLocation.y,Y.y),Ft="translate("+Je+"px, "+Qe+"px)";R.boxSelectElement.style.transform=Ft,R.boxSelectElement.style.WebkitTransform=Ft,R.boxSelectElement.style.width=tt-Je+"px",R.boxSelectElement.style.height=rt-Qe+"px"},Zn.dragMove=function(R,B){R.dragMoving=!0,B.originalEvent.stopPropagation();var Y={lng:B.lngLat.lng-R.dragMoveLocation.lng,lat:B.lngLat.lat-R.dragMoveLocation.lat};Oi(this.getSelected(),Y),R.dragMoveLocation=B.lngLat},Zn.onMouseUp=function(R,B){var Y=this;if(R.dragMoving)this.fireUpdate();else if(R.boxSelecting){var Je=[R.boxSelectStartLocation,At(B.originalEvent,this.map.getContainer())],tt=this.featuresAt(null,Je,"click"),Qe=this.getUniqueIds(tt).filter(function(rt){return!Y.isSelected(rt)});Qe.length&&(this.select(Qe),Qe.forEach(function(rt){return Y.doRender(rt)}),this.updateUIClasses({mouse:he}))}this.stopExtendedInteractions(R)},Zn.toDisplayFeatures=function(R,B,Y){B.properties.active=this.isSelected(B.properties.id)?$n:pn,Y(B),this.fireActionable(),B.properties.active===$n&&B.geometry.type!==oe&&an(B).forEach(Y)},Zn.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Zn.onCombineFeatures=function(){var R=this.getSelected();if(!(0===R.length||R.length<2)){for(var B=[],Y=[],Je=R[0].type.replace("Multi",""),tt=0;tt<R.length;tt++){var Qe=R[tt];if(Qe.type.replace("Multi","")!==Je)return;Qe.type.includes("Multi")?Qe.getCoordinates().forEach(function(Ft){B.push(Ft)}):B.push(Qe.getCoordinates()),Y.push(Qe.toGeoJSON())}if(Y.length>1){var rt=this.newFeature({type:je,properties:Y[0].properties,geometry:{type:"Multi"+Je,coordinates:B}});this.addFeature(rt),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([rt.id]),this.map.fire("draw.combine",{createdFeatures:[rt.toGeoJSON()],deletedFeatures:Y})}this.fireActionable()}},Zn.onUncombineFeatures=function(){var R=this,B=this.getSelected();if(0!==B.length){for(var Y=[],Je=[],tt=function(rt){var Ft=B[rt];R.isInstanceOf("MultiFeature",Ft)&&(Ft.getFeatures().forEach(function(Dt){R.addFeature(Dt),Dt.properties=Ft.properties,Y.push(Dt.toGeoJSON()),R.select([Dt.id])}),R.deleteFeature(Ft.id,{silent:!0}),Je.push(Ft.toGeoJSON()))},Qe=0;Qe<B.length;Qe++)tt(Qe);Y.length>1&&this.map.fire("draw.uncombine",{createdFeatures:Y,deletedFeatures:Je}),this.fireActionable()}};var wi=Ce(gn),dr=Ce(Lt),wa={fireUpdate:function(){this.map.fire(Et,{action:"change_coordinates",features:this.getSelected().map(function(R){return R.toGeoJSON()})})},fireActionable:function(R){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:R.selectedCoordPaths.length>0})},startDragging:function(R,B){this.map.dragPan.disable(),R.canDragMove=!0,R.dragMoveLocation=B.lngLat},stopDragging:function(R){this.map.dragPan.enable(),R.dragMoving=!1,R.canDragMove=!1,R.dragMoveLocation=null},onVertex:function(R,B){this.startDragging(R,B);var Y=B.featureTarget.properties,Je=R.selectedCoordPaths.indexOf(Y.coord_path);Ze(B)||-1!==Je?Ze(B)&&-1===Je&&R.selectedCoordPaths.push(Y.coord_path):R.selectedCoordPaths=[Y.coord_path];var tt=this.pathsToCoordinates(R.featureId,R.selectedCoordPaths);this.setSelectedCoordinates(tt)},onMidpoint:function(R,B){this.startDragging(R,B);var Y=B.featureTarget.properties;R.feature.addCoordinate(Y.coord_path,Y.lng,Y.lat),this.fireUpdate(),R.selectedCoordPaths=[Y.coord_path]},pathsToCoordinates:function(R,B){return B.map(function(Y){return{feature_id:R,coord_path:Y}})},onFeature:function(R,B){0===R.selectedCoordPaths.length?this.startDragging(R,B):this.stopDragging(R)},dragFeature:function(R,B,Y){Oi(this.getSelected(),Y),R.dragMoveLocation=B.lngLat},dragVertex:function(R,B,Y){for(var Je=R.selectedCoordPaths.map(function(Ft){return R.feature.getCoordinate(Ft)}),tt=eo(Je.map(function(Ft){return{type:je,properties:{},geometry:{type:oe,coordinates:Ft}}}),Y),Qe=0;Qe<Je.length;Qe++){var rt=Je[Qe];R.feature.updateCoordinate(R.selectedCoordPaths[Qe],rt[0]+tt.lng,rt[1]+tt.lat)}},clickNoTarget:function(){this.changeMode(me.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(me.SIMPLE_SELECT)},clickActiveFeature:function(R){R.selectedCoordPaths=[],this.clearSelectedCoordinates(),R.feature.changed()},onSetup:function(R){var B=R.featureId,Y=this.getFeature(B);if(!Y)throw new Error("You must provide a featureId to enter direct_select mode");if(Y.type===oe)throw new TypeError("direct_select mode doesn't handle point features");var Je={featureId:B,feature:Y,dragMoveLocation:R.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:R.coordPath?[R.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(B,Je.selectedCoordPaths)),this.setSelected(B),Qt(this),this.setActionableState({trash:!0}),Je},onStop:function(){ft(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(R,B,Y){R.featureId===B.properties.id?(B.properties.active=$n,Y(B),an(B,{map:this.map,midpoints:!0,selectedPaths:R.selectedCoordPaths}).forEach(Y)):(B.properties.active=pn,Y(B)),this.fireActionable(R)},onTrash:function(R){R.selectedCoordPaths.sort(function(B,Y){return Y.localeCompare(B,"en",{numeric:!0})}).forEach(function(B){return R.feature.removeCoordinate(B)}),this.fireUpdate(),R.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(R),!1===R.feature.isValid()&&(this.deleteFeature([R.featureId]),this.changeMode(me.SIMPLE_SELECT,{}))},onMouseMove:function(R,B){var Y=Pe(B),Je=wi(B),tt=0===R.selectedCoordPaths.length;return this.updateUIClasses(Y&&tt||Je&&!tt?{mouse:he}:{mouse:Ue}),this.stopDragging(R),!0},onMouseOut:function(R){return R.dragMoving&&this.fireUpdate(),!0}};wa.onTouchStart=wa.onMouseDown=function(R,B){return wi(B)?this.onVertex(R,B):Pe(B)?this.onFeature(R,B):dr(B)?this.onMidpoint(R,B):void 0},wa.onDrag=function(R,B){if(!0===R.canDragMove){R.dragMoving=!0,B.originalEvent.stopPropagation();var Y={lng:B.lngLat.lng-R.dragMoveLocation.lng,lat:B.lngLat.lat-R.dragMoveLocation.lat};R.selectedCoordPaths.length>0?this.dragVertex(R,B,Y):this.dragFeature(R,B,Y),R.dragMoveLocation=B.lngLat}},wa.onClick=function(R,B){return Ge(B)?this.clickNoTarget(R,B):Pe(B)?this.clickActiveFeature(R,B):qe(B)?this.clickInactive(R,B):void this.stopDragging(R)},wa.onTap=function(R,B){return Ge(B)?this.clickNoTarget(R,B):Pe(B)?this.clickActiveFeature(R,B):qe(B)?this.clickInactive(R,B):void 0},wa.onTouchEnd=wa.onMouseUp=function(R){R.dragMoving&&this.fireUpdate(),this.stopDragging(R)};var Yi={};function Ko(R,B){return!!R.lngLat&&R.lngLat.lng===B[0]&&R.lngLat.lat===B[1]}Yi.onSetup=function(){var R=this.newFeature({type:je,properties:{},geometry:{type:oe,coordinates:[]}});return this.addFeature(R),this.clearSelectedFeatures(),this.updateUIClasses({mouse:de}),this.activateUIButton(Ie.POINT),this.setActionableState({trash:!0}),{point:R}},Yi.stopDrawingAndRemove=function(R){this.deleteFeature([R.point.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT)},Yi.onTap=Yi.onClick=function(R,B){this.updateUIClasses({mouse:he}),R.point.updateCoordinate("",B.lngLat.lng,B.lngLat.lat),this.map.fire(Ye,{features:[R.point.toGeoJSON()]}),this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.point.id]})},Yi.onStop=function(R){this.activateUIButton(),R.point.getCoordinate().length||this.deleteFeature([R.point.id],{silent:!0})},Yi.toDisplayFeatures=function(R,B,Y){var Je=B.properties.id===R.point.id;if(B.properties.active=Je?$n:pn,!Je)return Y(B)},Yi.onTrash=Yi.stopDrawingAndRemove,Yi.onKeyUp=function(R,B){if($e(B)||Mt(B))return this.stopDrawingAndRemove(R,B)};var rs={onSetup:function(){var R=this.newFeature({type:je,properties:{},geometry:{type:X,coordinates:[[]]}});return this.addFeature(R),this.clearSelectedFeatures(),Qt(this),this.updateUIClasses({mouse:de}),this.activateUIButton(Ie.POLYGON),this.setActionableState({trash:!0}),{polygon:R,currentVertexPosition:0}},clickAnywhere:function(R,B){if(R.currentVertexPosition>0&&Ko(B,R.polygon.coordinates[0][R.currentVertexPosition-1]))return this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.polygon.id]});this.updateUIClasses({mouse:de}),R.polygon.updateCoordinate("0."+R.currentVertexPosition,B.lngLat.lng,B.lngLat.lat),R.currentVertexPosition++,R.polygon.updateCoordinate("0."+R.currentVertexPosition,B.lngLat.lng,B.lngLat.lat)},clickOnVertex:function(R){return this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.polygon.id]})},onMouseMove:function(R,B){R.polygon.updateCoordinate("0."+R.currentVertexPosition,B.lngLat.lng,B.lngLat.lat),ye(B)&&this.updateUIClasses({mouse:Le})}};rs.onTap=rs.onClick=function(R,B){return ye(B)?this.clickOnVertex(R,B):this.clickAnywhere(R,B)},rs.onKeyUp=function(R,B){$e(B)?(this.deleteFeature([R.polygon.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT)):Mt(B)&&this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.polygon.id]})},rs.onStop=function(R){this.updateUIClasses({mouse:Ue}),ft(this),this.activateUIButton(),void 0!==this.getFeature(R.polygon.id)&&(R.polygon.removeCoordinate("0."+R.currentVertexPosition),R.polygon.isValid()?this.map.fire(Ye,{features:[R.polygon.toGeoJSON()]}):(this.deleteFeature([R.polygon.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT,{},{silent:!0})))},rs.toDisplayFeatures=function(R,B,Y){var Je=B.properties.id===R.polygon.id;if(B.properties.active=Je?$n:pn,!Je)return Y(B);if(0!==B.geometry.coordinates.length){var tt=B.geometry.coordinates[0].length;if(!(tt<3)){if(B.properties.meta=_n,Y(sn(R.polygon.id,B.geometry.coordinates[0][0],"0.0",!1)),tt>3){var Qe=B.geometry.coordinates[0].length-3;Y(sn(R.polygon.id,B.geometry.coordinates[0][Qe],"0."+Qe,!1))}if(tt<=4&&(Y({type:je,properties:B.properties,geometry:{coordinates:[[B.geometry.coordinates[0][0][0],B.geometry.coordinates[0][0][1]],[B.geometry.coordinates[0][1][0],B.geometry.coordinates[0][1][1]]],type:ie}}),3===tt))return;return Y(B)}}},rs.onTrash=function(R){this.deleteFeature([R.polygon.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT)};var Ta={onSetup:function(R){var B,Y,Je=(R=R||{}).featureId,tt="forward";if(Je){if(!(B=this.getFeature(Je)))throw new Error("Could not find a feature with the provided featureId");var Qe=R.from;if(Qe&&"Feature"===Qe.type&&Qe.geometry&&"Point"===Qe.geometry.type&&(Qe=Qe.geometry),Qe&&"Point"===Qe.type&&Qe.coordinates&&2===Qe.coordinates.length&&(Qe=Qe.coordinates),!Qe||!Array.isArray(Qe))throw new Error("Please use the `from` property to indicate which point to continue the line from");var rt=B.coordinates.length-1;if(B.coordinates[rt][0]===Qe[0]&&B.coordinates[rt][1]===Qe[1])B.addCoordinate.apply(B,[Y=rt+1].concat(B.coordinates[rt]));else{if(B.coordinates[0][0]!==Qe[0]||B.coordinates[0][1]!==Qe[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");tt="backwards",B.addCoordinate.apply(B,[Y=0].concat(B.coordinates[0]))}}else B=this.newFeature({type:je,properties:{},geometry:{type:ie,coordinates:[]}}),Y=0,this.addFeature(B);return this.clearSelectedFeatures(),Qt(this),this.updateUIClasses({mouse:de}),this.activateUIButton(Ie.LINE),this.setActionableState({trash:!0}),{line:B,currentVertexPosition:Y,direction:tt}},clickAnywhere:function(R,B){if(R.currentVertexPosition>0&&Ko(B,R.line.coordinates[R.currentVertexPosition-1])||"backwards"===R.direction&&Ko(B,R.line.coordinates[R.currentVertexPosition+1]))return this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.line.id]});this.updateUIClasses({mouse:de}),R.line.updateCoordinate(R.currentVertexPosition,B.lngLat.lng,B.lngLat.lat),"forward"===R.direction?(R.currentVertexPosition++,R.line.updateCoordinate(R.currentVertexPosition,B.lngLat.lng,B.lngLat.lat)):R.line.addCoordinate(0,B.lngLat.lng,B.lngLat.lat)},clickOnVertex:function(R){return this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.line.id]})},onMouseMove:function(R,B){R.line.updateCoordinate(R.currentVertexPosition,B.lngLat.lng,B.lngLat.lat),ye(B)&&this.updateUIClasses({mouse:Le})}};Ta.onTap=Ta.onClick=function(R,B){if(ye(B))return this.clickOnVertex(R,B);this.clickAnywhere(R,B)},Ta.onKeyUp=function(R,B){Mt(B)?this.changeMode(me.SIMPLE_SELECT,{featureIds:[R.line.id]}):$e(B)&&(this.deleteFeature([R.line.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT))},Ta.onStop=function(R){ft(this),this.activateUIButton(),void 0!==this.getFeature(R.line.id)&&(R.line.removeCoordinate(""+R.currentVertexPosition),R.line.isValid()?this.map.fire(Ye,{features:[R.line.toGeoJSON()]}):(this.deleteFeature([R.line.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT,{},{silent:!0})))},Ta.onTrash=function(R){this.deleteFeature([R.line.id],{silent:!0}),this.changeMode(me.SIMPLE_SELECT)},Ta.toDisplayFeatures=function(R,B,Y){var Je=B.properties.id===R.line.id;if(B.properties.active=Je?$n:pn,!Je)return Y(B);B.geometry.coordinates.length<2||(B.properties.meta=_n,Y(sn(R.line.id,B.geometry.coordinates["forward"===R.direction?B.geometry.coordinates.length-2:1],""+("forward"===R.direction?B.geometry.coordinates.length-2:1),!1)),Y(B))};var to={simple_select:Zn,direct_select:wa,draw_point:Yi,draw_polygon:rs,draw_line_string:Ta},nc={defaultMode:me.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}],modes:to,controls:{},userProperties:!1},nr={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Bo={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function kr(R,B){return R.map(function(Y){return Y.source?Y:qi(Y,{id:Y.id+"."+B,source:"hot"===B?le:e})})}var no=ra(function(R,B){var Y="[object Arguments]",Je="[object Map]",tt="[object Object]",Qe="[object Set]",rt=/^\[object .+?Constructor\]$/,Ft=/^(?:0|[1-9]\d*)$/,Dt={};Dt["[object Float32Array]"]=Dt["[object Float64Array]"]=Dt["[object Int8Array]"]=Dt["[object Int16Array]"]=Dt["[object Int32Array]"]=Dt["[object Uint8Array]"]=Dt["[object Uint8ClampedArray]"]=Dt["[object Uint16Array]"]=Dt["[object Uint32Array]"]=!0,Dt[Y]=Dt["[object Array]"]=Dt["[object ArrayBuffer]"]=Dt["[object Boolean]"]=Dt["[object DataView]"]=Dt["[object Date]"]=Dt["[object Error]"]=Dt["[object Function]"]=Dt[Je]=Dt["[object Number]"]=Dt[tt]=Dt["[object RegExp]"]=Dt[Qe]=Dt["[object String]"]=Dt["[object WeakMap]"]=!1;var dn="object"==typeof global&&global&&global.Object===Object&&global,ut="object"==typeof self&&self&&self.Object===Object&&self,tn=dn||ut||Function("return this")(),hn=B&&!B.nodeType&&B,In=hn&&R&&!R.nodeType&&R,Nn=In&&In.exports===hn,Wi=Nn&&dn.process,Ot=function(){try{return Wi&&Wi.binding&&Wi.binding("util")}catch{}}(),yn=Ot&&Ot.isTypedArray;function Zt(Ke,Ct){for(var en=-1,xn=null==Ke?0:Ke.length;++en<xn;)if(Ct(Ke[en],en,Ke))return!0;return!1}function ci(Ke){var Ct=-1,en=Array(Ke.size);return Ke.forEach(function(xn,io){en[++Ct]=[io,xn]}),en}function Ji(Ke){var Ct=-1,en=Array(Ke.size);return Ke.forEach(function(xn){en[++Ct]=xn}),en}var Tn,Br,xr,ui=Array.prototype,Hi=Object.prototype,co=tn["__core-js_shared__"],xs=Function.prototype.toString,Oa=Hi.hasOwnProperty,Sl=(Tn=/[^.]+$/.exec(co&&co.keys&&co.keys.IE_PROTO||""))?"Symbol(src)_1."+Tn:"",du=Hi.toString,ic=RegExp("^"+xs.call(Oa).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oc=Nn?tn.Buffer:void 0,ll=tn.Symbol,rc=tn.Uint8Array,Pc=Hi.propertyIsEnumerable,hu=ui.splice,Us=ll?ll.toStringTag:void 0,cl=Object.getOwnPropertySymbols,Pl=oc?oc.isBuffer:void 0,fu=(Br=Object.keys,xr=Object,function(Ke){return Br(xr(Ke))}),Lo=Vr(tn,"DataView"),qs=Vr(tn,"Map"),Fa=Vr(tn,"Promise"),Ua=Vr(tn,"Set"),as=Vr(tn,"WeakMap"),Sa=Vr(Object,"create"),qa=Ba(Lo),Cs=Ba(qs),Ja=Ba(Fa),ws=Ba(Ua),gu=Ba(as),Ec=ll?ll.prototype:void 0,Li=Ec?Ec.valueOf:void 0;function Js(Ke){var Ct=-1,en=null==Ke?0:Ke.length;for(this.clear();++Ct<en;){var xn=Ke[Ct];this.set(xn[0],xn[1])}}function sa(Ke){var Ct=-1,en=null==Ke?0:Ke.length;for(this.clear();++Ct<en;){var xn=Ke[Ct];this.set(xn[0],xn[1])}}function Ts(Ke){var Ct=-1,en=null==Ke?0:Ke.length;for(this.clear();++Ct<en;){var xn=Ke[Ct];this.set(xn[0],xn[1])}}function ul(Ke){var Ct=-1,en=null==Ke?0:Ke.length;for(this.__data__=new Ts;++Ct<en;)this.add(Ke[Ct])}function ss(Ke){var Ct=this.__data__=new sa(Ke);this.size=Ct.size}function ja(Ke,Ct){for(var en=Ke.length;en--;)if(yu(Ke[en][0],Ct))return en;return-1}function la(Ke){return null==Ke?void 0===Ke?"[object Undefined]":"[object Null]":Us&&Us in Object(Ke)?function(Ct){var en=Oa.call(Ct,Us),xn=Ct[Us];try{Ct[Us]=void 0;var io=!0}catch{}var bi=du.call(Ct);return io&&(en?Ct[Us]=xn:delete Ct[Us]),bi}(Ke):du.call(Ke)}function Gr(Ke){return ls(Ke)&&la(Ke)==Y}function Ac(Ke,Ct,en,xn,io){return Ke===Ct||(null==Ke||null==Ct||!ls(Ke)&&!ls(Ct)?Ke!=Ke&&Ct!=Ct:function(bi,uo,oo,Cr,xo,Ao){var Hr=El(bi),cs=El(uo),$o=Hr?"[object Array]":Yr(bi),Pa=cs?"[object Array]":Yr(uo),Bs=($o=$o==Y?tt:$o)==tt,dl=(Pa=Pa==Y?tt:Pa)==tt,wr=$o==Pa;if(wr&&Zc(bi)){if(!Zc(uo))return!1;Hr=!0,Bs=!1}if(wr&&!Bs)return Ao||(Ao=new ss),Hr||kl(bi)?Ms(bi,uo,oo,Cr,xo,Ao):function(Qi,Si,ji,Ga,Va,Go,Wn){switch(ji){case"[object DataView]":if(Qi.byteLength!=Si.byteLength||Qi.byteOffset!=Si.byteOffset)return!1;Qi=Qi.buffer,Si=Si.buffer;case"[object ArrayBuffer]":return!(Qi.byteLength!=Si.byteLength||!Go(new rc(Qi),new rc(Si)));case"[object Boolean]":case"[object Date]":case"[object Number]":return yu(+Qi,+Si);case"[object Error]":return Qi.name==Si.name&&Qi.message==Si.message;case"[object RegExp]":case"[object String]":return Qi==Si+"";case Je:var Ti=ci;case Qe:if(Ti||(Ti=Ji),Qi.size!=Si.size&&!(1&Ga))return!1;var zo=Wn.get(Qi);if(zo)return zo==Si;Ga|=2,Wn.set(Qi,Si);var ua=Ms(Ti(Qi),Ti(Si),Ga,Va,Go,Wn);return Wn.delete(Qi),ua;case"[object Symbol]":if(Li)return Li.call(Qi)==Li.call(Si)}return!1}(bi,uo,$o,oo,Cr,xo,Ao);if(!(1&oo)){var Gs=Bs&&Oa.call(bi,"__wrapped__"),sc=dl&&Oa.call(uo,"__wrapped__");if(Gs||sc){var lc=Gs?bi.value():bi,Zl=sc?uo.value():uo;return Ao||(Ao=new ss),xo(lc,Zl,oo,Cr,Ao)}}return!!wr&&(Ao||(Ao=new ss),function(Qi,Si,ji,Ga,Va,Go){var Wn=1&ji,Ti=ac(Qi),Wo=Ti.length;if(Wo!=ac(Si).length&&!Wn)return!1;for(var ua=Wo;ua--;){var hr=Ti[ua];if(!(Wn?hr in Si:Oa.call(Si,hr)))return!1}var Lc=Go.get(Qi);if(Lc&&Go.get(Si))return Lc==Si;var Nl=!0;Go.set(Qi,Si),Go.set(Si,Qi);for(var Ya=Wn;++ua<Wo;){var Vs=Qi[hr=Ti[ua]],Qr=Si[hr];if(Ga)var Co=Wn?Ga(Qr,Vs,hr,Si,Qi,Go):Ga(Vs,Qr,hr,Qi,Si,Go);if(!(void 0===Co?Vs===Qr||Va(Vs,Qr,ji,Ga,Go):Co)){Nl=!1;break}Ya||(Ya="constructor"==hr)}if(Nl&&!Ya){var Ha=Qi.constructor,Ys=Si.constructor;Ha==Ys||!("constructor"in Qi)||!("constructor"in Si)||"function"==typeof Ha&&Ha instanceof Ha&&"function"==typeof Ys&&Ys instanceof Ys||(Nl=!1)}return Go.delete(Qi),Go.delete(Si),Nl}(bi,uo,oo,Cr,xo,Ao))}(Ke,Ct,en,xn,Ac,io))}function Ms(Ke,Ct,en,xn,io,bi){var uo=1&en,oo=Ke.length,Cr=Ct.length;if(oo!=Cr&&!(uo&&Cr>oo))return!1;var xo=bi.get(Ke);if(xo&&bi.get(Ct))return xo==Ct;var Ao=-1,Hr=!0,cs=2&en?new ul:void 0;for(bi.set(Ke,Ct),bi.set(Ct,Ke);++Ao<oo;){var $o=Ke[Ao],Pa=Ct[Ao];if(xn)var Bs=uo?xn(Pa,$o,Ao,Ct,Ke,bi):xn($o,Pa,Ao,Ke,Ct,bi);if(void 0!==Bs){if(Bs)continue;Hr=!1;break}if(cs){if(!Zt(Ct,function(dl,wr){if(!cs.has(wr)&&($o===dl||io($o,dl,en,xn,bi)))return cs.push(wr)})){Hr=!1;break}}else if($o!==Pa&&!io($o,Pa,en,xn,bi)){Hr=!1;break}}return bi.delete(Ke),bi.delete(Ct),Hr}function ac(Ke){return xn=Ic,io=function Il(Ke){return null!=(Ct=Ke)&&Al(Ct.length)&&!Nc(Ct)?function _u(Ke,Ct){var en=El(Ke),xn=!en&&pl(Ke),io=!en&&!xn&&Zc(Ke),bi=!en&&!xn&&!io&&kl(Ke),uo=en||xn||io||bi,oo=uo?function(Ao,Hr){for(var cs=-1,$o=Array(Ao);++cs<Ao;)$o[cs]=Hr(cs);return $o}(Ke.length,String):[],Cr=oo.length;for(var xo in Ke)!Ct&&!Oa.call(Ke,xo)||uo&&("length"==xo||io&&("offset"==xo||"parent"==xo)||bi&&("buffer"==xo||"byteLength"==xo||"byteOffset"==xo)||Vi(xo,Cr))||oo.push(xo);return oo}(Ke):function kc(Ke){if(en=(Ct=Ke)&&Ct.constructor,Ct!==("function"==typeof en&&en.prototype||Hi))return fu(Ke);var Ct,en,io=[];for(var bi in Object(Ke))Oa.call(Ke,bi)&&"constructor"!=bi&&io.push(bi);return io}(Ke);var Ct}(Ct=Ke),El(Ct)?io:function(bi,uo){for(var oo=-1,Cr=uo.length,xo=bi.length;++oo<Cr;)bi[xo+oo]=uo[oo];return bi}(io,xn(Ct));var Ct,xn,io}function ca(Ke,Ct){var en,xn,io=Ke.__data__;return("string"==(xn=typeof(en=Ct))||"number"==xn||"symbol"==xn||"boolean"==xn?"__proto__"!==en:null===en)?io["string"==typeof Ct?"string":"hash"]:io.map}function Vr(Ke,Ct){var en=Ke?.[Ct];return function mu(Ke){return!(!js(Ke)||(Ct=Ke,Sl&&Sl in Ct))&&(Nc(Ke)?ic:rt).test(Ba(Ke));var Ct}(en)?en:void 0}Js.prototype.clear=function(){this.__data__=Sa?Sa(null):{},this.size=0},Js.prototype.delete=function(Ke){var Ct=this.has(Ke)&&delete this.__data__[Ke];return this.size-=Ct?1:0,Ct},Js.prototype.get=function(Ke){var Ct=this.__data__;if(Sa){var en=Ct[Ke];return"__lodash_hash_undefined__"===en?void 0:en}return Oa.call(Ct,Ke)?Ct[Ke]:void 0},Js.prototype.has=function(Ke){var Ct=this.__data__;return Sa?void 0!==Ct[Ke]:Oa.call(Ct,Ke)},Js.prototype.set=function(Ke,Ct){var en=this.__data__;return this.size+=this.has(Ke)?0:1,en[Ke]=Sa&&void 0===Ct?"__lodash_hash_undefined__":Ct,this},sa.prototype.clear=function(){this.__data__=[],this.size=0},sa.prototype.delete=function(Ke){var Ct=this.__data__,en=ja(Ct,Ke);return!(en<0||(en==Ct.length-1?Ct.pop():hu.call(Ct,en,1),--this.size,0))},sa.prototype.get=function(Ke){var Ct=this.__data__,en=ja(Ct,Ke);return en<0?void 0:Ct[en][1]},sa.prototype.has=function(Ke){return ja(this.__data__,Ke)>-1},sa.prototype.set=function(Ke,Ct){var en=this.__data__,xn=ja(en,Ke);return xn<0?(++this.size,en.push([Ke,Ct])):en[xn][1]=Ct,this},Ts.prototype.clear=function(){this.size=0,this.__data__={hash:new Js,map:new(qs||sa),string:new Js}},Ts.prototype.delete=function(Ke){var Ct=ca(this,Ke).delete(Ke);return this.size-=Ct?1:0,Ct},Ts.prototype.get=function(Ke){return ca(this,Ke).get(Ke)},Ts.prototype.has=function(Ke){return ca(this,Ke).has(Ke)},Ts.prototype.set=function(Ke,Ct){var en=ca(this,Ke),xn=en.size;return en.set(Ke,Ct),this.size+=en.size==xn?0:1,this},ul.prototype.add=ul.prototype.push=function(Ke){return this.__data__.set(Ke,"__lodash_hash_undefined__"),this},ul.prototype.has=function(Ke){return this.__data__.has(Ke)},ss.prototype.clear=function(){this.__data__=new sa,this.size=0},ss.prototype.delete=function(Ke){var Ct=this.__data__,en=Ct.delete(Ke);return this.size=Ct.size,en},ss.prototype.get=function(Ke){return this.__data__.get(Ke)},ss.prototype.has=function(Ke){return this.__data__.has(Ke)},ss.prototype.set=function(Ke,Ct){var en=this.__data__;if(en instanceof sa){var xn=en.__data__;if(!qs||xn.length<199)return xn.push([Ke,Ct]),this.size=++en.size,this;en=this.__data__=new Ts(xn)}return en.set(Ke,Ct),this.size=en.size,this};var Ic=cl?function(Ke){return null==Ke?[]:(Ke=Object(Ke),function(Ct,en){for(var xn=-1,io=null==Ct?0:Ct.length,bi=0,uo=[];++xn<io;){var oo=Ct[xn];en(oo)&&(uo[bi++]=oo)}return uo}(cl(Ke),function(Ct){return Pc.call(Ke,Ct)}))}:function(){return[]},Yr=la;function Vi(Ke,Ct){return!!(Ct=Ct??9007199254740991)&&("number"==typeof Ke||Ft.test(Ke))&&Ke>-1&&Ke%1==0&&Ke<Ct}function Ba(Ke){if(null!=Ke){try{return xs.call(Ke)}catch{}try{return Ke+""}catch{}}return""}function yu(Ke,Ct){return Ke===Ct||Ke!=Ke&&Ct!=Ct}(Lo&&"[object DataView]"!=Yr(new Lo(new ArrayBuffer(1)))||qs&&Yr(new qs)!=Je||Fa&&"[object Promise]"!=Yr(Fa.resolve())||Ua&&Yr(new Ua)!=Qe||as&&"[object WeakMap]"!=Yr(new as))&&(Yr=function(Ke){var Ct=la(Ke),en=Ct==tt?Ke.constructor:void 0,xn=en?Ba(en):"";if(xn)switch(xn){case qa:return"[object DataView]";case Cs:return Je;case Ja:return"[object Promise]";case ws:return Qe;case gu:return"[object WeakMap]"}return Ct});var pl=Gr(function(){return arguments}())?Gr:function(Ke){return ls(Ke)&&Oa.call(Ke,"callee")&&!Pc.call(Ke,"callee")},El=Array.isArray,Zc=Pl||function(){return!1};function Nc(Ke){if(!js(Ke))return!1;var Ct=la(Ke);return"[object Function]"==Ct||"[object GeneratorFunction]"==Ct||"[object AsyncFunction]"==Ct||"[object Proxy]"==Ct}function Al(Ke){return"number"==typeof Ke&&Ke>-1&&Ke%1==0&&Ke<=9007199254740991}function js(Ke){var Ct=typeof Ke;return null!=Ke&&("object"==Ct||"function"==Ct)}function ls(Ke){return null!=Ke&&"object"==typeof Ke}var Ke,kl=yn?(Ke=yn,function(Ct){return Ke(Ct)}):function(Ke){return ls(Ke)&&Al(Ke.length)&&!!Dt[la(Ke)]};R.exports=function(Ke,Ct){return Ac(Ke,Ct)}}),Ma={Polygon:Po,LineString:lo,Point:tr,MultiPolygon:Eo,MultiLineString:Eo,MultiPoint:Eo};var Sc=function(R,B){var Y={options:R=function(tt){void 0===tt&&(tt={});var Qe=qi(tt);return tt.controls||(Qe.controls={}),Qe.controls=qi(!1===tt.displayControlsDefault?Bo:nr,tt.controls),(Qe=qi(nc,Qe)).styles=kr(Qe.styles,"cold").concat(kr(Qe.styles,"hot")),Qe}(R)};B=function Jr(R,B){return B.modes=me,B.getFeatureIdsAt=function(Y){return Ni.click({point:Y},null,R).map(function(Je){return Je.properties.id})},B.getSelectedIds=function(){return R.store.getSelectedIds()},B.getSelected=function(){return{type:ae,features:R.store.getSelectedIds().map(function(Y){return R.store.get(Y)}).map(function(Y){return Y.toGeoJSON()})}},B.getSelectedPoints=function(){return{type:ae,features:R.store.getSelectedCoordinates().map(function(Y){return{type:je,properties:{},geometry:{type:oe,coordinates:Y.coordinates}}})}},B.set=function(Y){if(void 0===Y.type||Y.type!==ae||!Array.isArray(Y.features))throw new Error("Invalid FeatureCollection");var Je=R.store.createRenderBatch(),tt=R.store.getAllIds().slice(),Qe=B.add(Y),rt=new Di(Qe);return(tt=tt.filter(function(Ft){return!rt.has(Ft)})).length&&B.delete(tt),Je(),Qe},B.add=function(Y){var Je=JSON.parse(JSON.stringify(Jt(Y))).features.map(function(tt){if(tt.id=tt.id||aa(),null===tt.geometry)throw new Error("Invalid geometry: null");if(void 0===R.store.get(tt.id)||R.store.get(tt.id).type!==tt.geometry.type){var Qe=Ma[tt.geometry.type];if(void 0===Qe)throw new Error("Invalid geometry type: "+tt.geometry.type+".");var rt=new Qe(R,tt);R.store.add(rt)}else{var Ft=R.store.get(tt.id);Ft.properties=tt.properties,no(Ft.getCoordinates(),tt.geometry.coordinates)||Ft.incomingCoords(tt.geometry.coordinates)}return tt.id});return R.store.render(),Je},B.get=function(Y){var Je=R.store.get(Y);if(Je)return Je.toGeoJSON()},B.getAll=function(){return{type:ae,features:R.store.getAll().map(function(Y){return Y.toGeoJSON()})}},B.delete=function(Y){return R.store.delete(Y,{silent:!0}),B.getMode()!==me.DIRECT_SELECT||R.store.getSelectedIds().length?R.store.render():R.events.changeMode(me.SIMPLE_SELECT,void 0,{silent:!0}),B},B.deleteAll=function(){return R.store.delete(R.store.getAllIds(),{silent:!0}),B.getMode()===me.DIRECT_SELECT?R.events.changeMode(me.SIMPLE_SELECT,void 0,{silent:!0}):R.store.render(),B},B.changeMode=function(Y,Je){return void 0===Je&&(Je={}),Y===me.SIMPLE_SELECT&&B.getMode()===me.SIMPLE_SELECT?(tt=Je.featureIds||[],Qe=R.store.getSelectedIds(),tt.length===Qe.length&&JSON.stringify(tt.map(function(rt){return rt}).sort())===JSON.stringify(Qe.map(function(rt){return rt}).sort())||(R.store.setSelected(Je.featureIds,{silent:!0}),R.store.render()),B):(Y===me.DIRECT_SELECT&&B.getMode()===me.DIRECT_SELECT&&Je.featureId===R.store.getSelectedIds()[0]||R.events.changeMode(Y,Je,{silent:!0}),B);var tt,Qe},B.getMode=function(){return R.events.getMode()},B.trash=function(){return R.events.trash({silent:!0}),B},B.combineFeatures=function(){return R.events.combineFeatures({silent:!0}),B},B.uncombineFeatures=function(){return R.events.uncombineFeatures({silent:!0}),B},B.setFeatureProperty=function(Y,Je,tt){return R.store.setFeatureProperty(Y,Je,tt),B},B}(Y,B),Y.api=B;var Je=fe(Y);return B.onAdd=Je.onAdd,B.onRemove=Je.onRemove,B.types=Ie,B.options=R,B};function jr(R){Sc(R,this)}return jr.modes=to,jr}()},8026:(q,H,v)=>{"use strict";v.r(H),v.d(H,{RegistryModule:()=>Bd});var M={};v.r(M),v.d(M,{forceCenter:()=>D_,forceCollide:()=>rg,forceLink:()=>$p,forceManyBody:()=>rh,forceRadial:()=>lg,forceSimulation:()=>Wp,forceX:()=>K_,forceY:()=>cg});var D={};v.r(D),v.d(D,{dispatch:()=>ka});var d={};v.r(d),v.d(d,{interval:()=>pg,now:()=>un,timeout:()=>Yo,timer:()=>fa,timerFlush:()=>or});var T=v(36895),w=v(28091),y=v(90433),S=v(63666),P=v(91805),E=v(23077),Z=v(35896),A=v(83420),I=v(63150),U=v(68567),Q=v(81217),W=v(58430),le=v(89079),e=v(94650);const de=["move","copy","link"],he="application/x-dnd",ke="application/json",Le="Text";function Ue(i){return i.substr(0,he.length)===he}function Ie(i){if(i.dataTransfer){const n=i.dataTransfer.types;if(!n)return Le;for(let t=0;t<n.length;t++)if(n[t]===Le||n[t]===ke||Ue(n[t]))return n[t]}return null}function ie(i,n){return"all"===n||"uninitialized"===n?i:i.filter(function(t){return-1!==n.toLowerCase().indexOf(t)})}function pe(i,n){const t=window.getComputedStyle(n),o=parseFloat(t.paddingTop)||0,a=parseFloat(t.paddingLeft)||0,l=parseFloat(t.borderTopWidth)||0,_=parseFloat(t.borderLeftWidth)||0;return{x:i.offsetX+a+_,y:i.offsetY+o+l}}const Ne={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function me(){Ne.isDragging=!1,Ne.dropEffect=void 0,Ne.effectAllowed=void 0,Ne.type=void 0}function Ye(i,n){!0===Ne.isDragging&&(Ne.dropEffect=n),i.dataTransfer&&(i.dataTransfer.dropEffect=n)}function mt(i,n){let o=ie(de,i.dataTransfer?i.dataTransfer.effectAllowed:"uninitialized");return!0===Ne.isDragging&&(o=ie(o,Ne.effectAllowed)),n&&(o=ie(o,n)),0===o.length?"none":i.ctrlKey&&-1!==o.indexOf("copy")?"copy":i.altKey&&-1!==o.indexOf("link")?"link":o[0]}function Et(i){if(!0===Ne.isDragging)return Ne.type;const n=Ie(i);return null!==n&&n!==Le&&n!==ke&&n.substr(he.length+1)||void 0}function Tt(){return!1===Ne.isDragging}const Nt=Ne;let Pn=(()=>{class i{constructor(t,o,a){this.elementRef=t,this.renderer=o,this.ngZone=a,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=pe,this.dndStart=new e.vpe,this.dndDrag=new e.vpe,this.dndEnd=new e.vpe,this.dndMoved=new e.vpe,this.dndCopied=new e.vpe,this.dndLinked=new e.vpe,this.dndCanceled=new e.vpe,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=l=>this.onDrag(l)}set dndDisableIf(t){this.draggable=!t,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}set dndDisableDragIf(t){this.dndDisableIf=t}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("drag",this.dragEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&me()}onDragStart(t){if(!1===this.draggable||typeof this.dndHandle<"u"&&typeof t._dndUsingHandle>"u")return!1;(function we(i,n,t){Ne.isDragging=!0,Ne.dropEffect="none",Ne.effectAllowed=n,Ne.type=t,i.dataTransfer&&(i.dataTransfer.effectAllowed=n)})(t,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function je(i,n,t){const o=he+(n.type?"-"+n.type:""),a=JSON.stringify(n);try{i.dataTransfer?.setData(o,a)}catch{try{i.dataTransfer?.setData(ke,a)}catch{const C=ie(de,t);i.dataTransfer&&(i.dataTransfer.effectAllowed=C[0]),i.dataTransfer?.setData(Le,a)}}}(t,{data:this.dndDraggable,type:this.dndType},Nt.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),(typeof this.dndDragImageElementRef<"u"||typeof t._dndUsingHandle<"u")&&function xe(i,n,t){const o=t(i,n)||{x:0,y:0};i.dataTransfer.setDragImage(n,o.x,o.y)}(t,this.dragImage,this.dndDragImageOffsetFunction);const o=this.renderer.listen(this.elementRef.nativeElement,"drag",()=>{this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggingSourceClass),o()});return this.dndStart.emit(t),t.stopPropagation(),!0}onDrag(t){this.dndDrag.emit(t)}onDragEnd(t){let a;switch(Nt.dropEffect){case"copy":a=this.dndCopied;break;case"link":a=this.dndLinked;break;case"move":a=this.dndMoved;break;default:a=this.dndCanceled}a.emit(t),this.dndEnd.emit(t),me(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout(()=>{this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggingSourceClass)},0),t.stopPropagation()}registerDragHandle(t){this.dndHandle=t}registerDragImage(t){this.dndDragImageElementRef=t}determineDragImage(){return typeof this.dndDragImageElementRef<"u"?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(e.R0b))},i.\u0275dir=e.lG2({type:i,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(t,o){1&t&&e.NdJ("dragstart",function(l){return o.onDragStart(l)})("dragend",function(l){return o.onDragEnd(l)}),2&t&&e.uIk("draggable",o.draggable)},inputs:{dndDraggable:"dndDraggable",dndEffectAllowed:"dndEffectAllowed",dndType:"dndType",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),i})(),st=(()=>{class i{constructor(t){this.elementRef=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275dir=e.lG2({type:i,selectors:[["","dndPlaceholderRef",""]]}),i})(),at=(()=>{class i{constructor(t,o,a){this.ngZone=t,this.elementRef=o,this.renderer=a,this.dndDropzone="",this.dndEffectAllowed="uninitialized",this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new e.vpe,this.dndDrop=new e.vpe,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=l=>this.onDragEnter(l),this.dragOverEventHandler=l=>this.onDragOver(l),this.dragLeaveEventHandler=l=>this.onDragLeave(l)}set dndDisableIf(t){this.disabled=!!t,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}set dndDisableDropIf(t){this.dndDisableIf=t}ngAfterViewInit(){this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.addEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.addEventListener("dragleave",this.dragLeaveEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}onDragEnter(t){if(!0===t._dndDropzoneActive)return void this.cleanupDragoverState();if(typeof t._dndDropzoneActive>"u"){const a=document.elementFromPoint(t.clientX,t.clientY);this.elementRef.nativeElement.contains(a)&&(t._dndDropzoneActive=!0)}const o=Et(t);!1!==this.isDropAllowed(o)&&t.preventDefault()}onDragOver(t){if(t.defaultPrevented)return;const o=Et(t);if(!1===this.isDropAllowed(o))return;this.checkAndUpdatePlaceholderPosition(t);const a=mt(t,this.dndEffectAllowed);"none"!==a?(t.preventDefault(),Ye(t,a),this.dndDragover.emit(t),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}onDrop(t){try{const o=Et(t);if(!1===this.isDropAllowed(o))return;const a=function X(i,n){const t=Ie(i);return!0===n?null!==t&&Ue(t)?JSON.parse(i.dataTransfer?.getData(t)??"{}"):{}:null!==t?JSON.parse(i.dataTransfer?.getData(t)??"{}"):{}}(t,Tt());if(!1===this.isDropAllowed(a.type))return;t.preventDefault();const l=mt(t);if(Ye(t,l),"none"===l)return;const _=this.getPlaceholderIndex();if(-1===_)return;this.dndDrop.emit({event:t,dropEffect:l,isExternal:Tt(),data:a.data,index:_,type:o}),t.stopPropagation()}finally{this.cleanupDragoverState()}}onDragLeave(t){if(typeof t._dndDropzoneActive>"u"){const o=document.elementFromPoint(t.clientX,t.clientY);if(this.elementRef.nativeElement.contains(o))return void(t._dndDropzoneActive=!0)}this.cleanupDragoverState(),Ye(t,"none")}isDropAllowed(t){if(!0===this.disabled||!0===Tt()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone||!t)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(t)}tryGetPlaceholder(){return typeof this.dndPlaceholderRef<"u"?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}removePlaceholderFromDOM(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}checkAndUpdatePlaceholderPosition(t){if(null===this.placeholder)return;this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);const o=function oe(i,n){let t=n;for(;t.parentNode!==i;){if(!t.parentNode)return null;t=t.parentNode}return t}(this.elementRef.nativeElement,t.target);null!==o&&o!==this.placeholder&&(function ae(i,n,t){const o=n.getBoundingClientRect();return t?i.clientX<o.left+o.width/2:i.clientY<o.top+o.height/2}(t,o,this.dndHorizontal)?o.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,o):o.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,o.nextSibling))}getPlaceholderIndex(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}cleanupDragoverState(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.R0b),e.Y36(e.SBq),e.Y36(e.Qsj))},i.\u0275dir=e.lG2({type:i,selectors:[["","dndDropzone",""]],contentQueries:function(t,o,a){if(1&t&&e.Suo(a,st,5),2&t){let l;e.iGM(l=e.CRH())&&(o.dndPlaceholderRef=l.first)}},hostBindings:function(t,o){1&t&&e.NdJ("drop",function(l){return o.onDrop(l)})},inputs:{dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed",dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),i})(),$t=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[T.ez]}),i})();var _n=v(76590),Lt=v(14565),gn=v(14865),$n=v(185),pn=v(77579),Ui=v(50727),Gi=v(34986),yi=v(5963);function Di(i=0,n=Gi.z){return i<0&&(i=0),(0,yi.H)(i,i,n)}var gi=v(66406),Ni=v(69751),Mo=v(56451),No=v(82722),vr=v(68675),Oo=v(54004),So=v(95698),ra=v(18505),aa=v(63900),bo=v(53887);function tr(i,n,t){for(let o in n)if(n.hasOwnProperty(o)){const a=n[o];a?i.setProperty(o,a,t?.has(o)?"important":""):i.removeProperty(o)}return i}function lo(i,n){const t=n?"":"none";tr(i.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function Po(i,n,t){tr(i.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},t)}function xa(i,n){return n&&"none"!=n?i+" "+n:i}function Ur(i){const n=i.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(i)*n}function Bn(i,n){return i.getPropertyValue(n).split(",").map(o=>o.trim())}function br(i){const n=i.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height}}function sl(i,n,t){const{top:o,bottom:a,left:l,right:_}=i;return t>=o&&t<=a&&n>=l&&n<=_}function Ca(i,n,t){i.top+=n,i.bottom=i.top+i.height,i.left+=t,i.right=i.left+i.width}function qr(i,n,t,o){const{top:a,right:l,bottom:_,left:C,width:N,height:F}=i,V=N*n,ue=F*n;return o>a-ue&&o<_+ue&&t>C-V&&t<l+V}class Ra{constructor(n,t){this._document=n,this._viewportRuler=t,this.positions=new Map}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),n.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:br(t)})})}handleScroll(n){const t=(0,Lt.sA)(n),o=this.positions.get(t);if(!o)return null;const a=t===this._document?t.documentElement:t,l=o.scrollPosition;let _,C;if(t===this._document){const V=this._viewportRuler.getViewportScrollPosition();_=V.top,C=V.left}else _=t.scrollTop,C=t.scrollLeft;const N=l.top-_,F=l.left-C;return this.positions.forEach((V,ue)=>{V.clientRect&&t!==ue&&a.contains(ue)&&Ca(V.clientRect,N,F)}),l.top=_,l.left=C,{top:N,left:F}}}function Ri(i){const n=i.cloneNode(!0),t=n.querySelectorAll("[id]"),o=i.nodeName.toLowerCase();n.removeAttribute("id");for(let a=0;a<t.length;a++)t[a].removeAttribute("id");return"canvas"===o?re(i,n):("input"===o||"select"===o||"textarea"===o)&&te(i,n),Fs("canvas",i,n,re),Fs("input, textarea, select",i,n,te),n}function Fs(i,n,t,o){const a=n.querySelectorAll(i);if(a.length){const l=t.querySelectorAll(i);for(let _=0;_<a.length;_++)o(a[_],l[_])}}let qi=0;function te(i,n){"file"!==n.type&&(n.value=i.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${qi++}`)}function re(i,n){const t=n.getContext("2d");if(t)try{t.drawImage(i,0,0)}catch{}}const fe=(0,Lt.i$)({passive:!0}),Ce=(0,Lt.i$)({passive:!1}),qe=new Set(["position"]);class Ge{constructor(n,t,o,a,l,_){this._config=t,this._document=o,this._ngZone=a,this._viewportRuler=l,this._dragDropRegistry=_,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new pn.x,this._pointerMoveSubscription=Ui.w0.EMPTY,this._pointerUpSubscription=Ui.w0.EMPTY,this._scrollSubscription=Ui.w0.EMPTY,this._resizeSubscription=Ui.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new pn.x,this.started=new pn.x,this.released=new pn.x,this.ended=new pn.x,this.entered=new pn.x,this.exited=new pn.x,this.dropped=new pn.x,this.moved=this._moveEvents,this._pointerDown=C=>{if(this.beforeStarted.next(),this._handles.length){const N=this._handles.find(F=>{const V=(0,Lt.sA)(C);return!!V&&(V===F||F.contains(V))});N&&!this._disabledHandles.has(N)&&!this.disabled&&this._initializeDragSequence(N,C)}else this.disabled||this._initializeDragSequence(this._rootElement,C)},this._pointerMove=C=>{const N=this._getPointerPositionOnPage(C);if(!this._hasStartedDragging){if(Math.abs(N.x-this._pickupPositionOnPage.x)+Math.abs(N.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const Te=Date.now()>=this._dragStartTime+this._getDragStartDelay(C),We=this._dropContainer;if(!Te)return void this._endDragSequence(C);(!We||!We.isDragging()&&!We.isReceiving())&&(C.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(C)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),C.preventDefault();const F=this._getConstrainedPointerPosition(N);if(this._hasMoved=!0,this._lastKnownPointerPosition=N,this._updatePointerDirectionDelta(F),this._dropContainer)this._updateActiveDropContainer(F,N);else{const V=this._activeTransform;V.x=F.x-this._pickupPositionOnPage.x+this._passiveTransform.x,V.y=F.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(V.x,V.y),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${V.x} ${V.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:F,event:C,distance:this._getDragDistance(F),delta:this._pointerDirectionDelta})})},this._pointerUp=C=>{this._endDragSequence(C)},this.withRootElement(n).withParent(t.parentDragRef||null),this._parentPositions=new Ra(o,l),_.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){const t=(0,gn.Ig)(n);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(o=>lo(o,t)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(o=>(0,gn.fI)(o)),this._handles.forEach(o=>lo(o,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(o=>{this._handles.indexOf(o)>-1&&t.add(o)}),this._disabledHandles=t,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const t=(0,gn.fI)(n);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,Ce),t.addEventListener("touchstart",this._pointerDown,fe)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?(0,gn.fI)(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&$e(this._rootElement),$e(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),lo(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),lo(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&$e(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&$e(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){Mt(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const o=this._rootElement,a=o.parentNode,l=this._placeholder=this._createPlaceholderElement(),_=this._anchor=this._anchor||this._document.createComment(""),C=this._getShadowRoot();a.insertBefore(_,o),this._initialTransform=o.style.transform||"",this._preview=this._createPreviewElement(),Po(o,!1,qe),this._document.body.appendChild(a.replaceChild(l,o)),this._getPreviewInsertionPoint(a,C).appendChild(this._preview),this.started.next({source:this}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(n,t){this._parentDragRef&&t.stopPropagation();const o=this.isDragging(),a=Mt(t),l=!a&&0!==t.button,_=this._rootElement,C=(0,Lt.sA)(t),N=!a&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),F=a?(0,$n.yG)(t):(0,$n.X6)(t);if(C&&C.draggable&&"mousedown"===t.type&&t.preventDefault(),o||l||N||F)return;this._handles.length&&(this._rootElementTapHighlight=_.style.webkitTapHighlightColor||"",_.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(ce=>this._updateOnScroll(ce)),this._boundaryElement&&(this._boundaryRect=br(this._boundaryElement));const V=this._previewTemplate;this._pickupPositionInElement=V&&V.template&&!V.matchSize?{x:0,y:0}:this._getPointerPositionInElement(n,t);const ue=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:ue.x,y:ue.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(n){Po(this._rootElement,!0,qe),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,o=t.getItemIndex(this),a=this._getPointerPositionOnPage(n),l=this._getDragDistance(a),_=t._isOverContainer(a.x,a.y);this.ended.next({source:this,distance:l,dropPoint:a}),this.dropped.next({item:this,currentIndex:o,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:_,distance:l,dropPoint:a}),t.drop(this,o,this._initialIndex,this._initialContainer,_,l,a),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:t},{x:o,y:a}){let l=this._initialContainer._getSiblingContainerFromPosition(this,n,t);!l&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,t)&&(l=this._initialContainer),l&&l!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=l,this._dropContainer.enter(this,n,t,l===this._initialContainer&&l.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:l,currentIndex:l.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(o,a),this._dropContainer._sortItem(this,n,t,this._pointerDirectionDelta),this._applyPreviewTransform(n-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const n=this._previewTemplate,t=this.previewClass,o=n?n.template:null;let a;if(o&&n){const l=n.matchSize?this._rootElement.getBoundingClientRect():null,_=n.viewContainer.createEmbeddedView(o,n.context);_.detectChanges(),a=It(_,this._document),this._previewRef=_,n.matchSize?ht(a,l):a.style.transform=ye(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const l=this._rootElement;a=Ri(l),ht(a,l.getBoundingClientRect()),this._initialTransform&&(a.style.transform=this._initialTransform)}return tr(a.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},qe),lo(a,!1),a.classList.add("cdk-drag-preview"),a.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(l=>a.classList.add(l)):a.classList.add(t)),a}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const t=function Eo(i){const n=getComputedStyle(i),t=Bn(n,"transition-property"),o=t.find(C=>"transform"===C||"all"===C);if(!o)return 0;const a=t.indexOf(o),l=Bn(n,"transition-duration"),_=Bn(n,"transition-delay");return Ur(l[a])+Ur(_[a])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(o=>{const a=_=>{var C;(!_||(0,Lt.sA)(_)===this._preview&&"transform"===_.propertyName)&&(null===(C=this._preview)||void 0===C||C.removeEventListener("transitionend",a),o(),clearTimeout(l))},l=setTimeout(a,1.5*t);this._preview.addEventListener("transitionend",a)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,t=n?n.template:null;let o;return t?(this._placeholderRef=n.viewContainer.createEmbeddedView(t,n.context),this._placeholderRef.detectChanges(),o=It(this._placeholderRef,this._document)):o=Ri(this._rootElement),o.classList.add("cdk-drag-placeholder"),o}_getPointerPositionInElement(n,t){const o=this._rootElement.getBoundingClientRect(),a=n===this._rootElement?null:n,l=a?a.getBoundingClientRect():o,_=Mt(t)?t.targetTouches[0]:t,C=this._getViewportScrollPosition();return{x:l.left-o.left+(_.pageX-l.left-C.left),y:l.top-o.top+(_.pageY-l.top-C.top)}}_getPointerPositionOnPage(n){const t=this._getViewportScrollPosition(),o=Mt(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,a=o.pageX-t.left,l=o.pageY-t.top;if(this._ownerSVGElement){const _=this._ownerSVGElement.getScreenCTM();if(_){const C=this._ownerSVGElement.createSVGPoint();return C.x=a,C.y=l,C.matrixTransform(_.inverse())}}return{x:a,y:l}}_getConstrainedPointerPosition(n){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:o,y:a}=this.constrainPosition?this.constrainPosition(n,this):n;if("x"===this.lockAxis||"x"===t?a=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(o=this._pickupPositionOnPage.x),this._boundaryRect){const{x:l,y:_}=this._pickupPositionInElement,C=this._boundaryRect,N=this._previewRect,F=C.top+_,V=C.bottom-(N.height-_);o=Ze(o,C.left+l,C.right-(N.width-l)),a=Ze(a,F,V)}return{x:o,y:a}}_updatePointerDirectionDelta(n){const{x:t,y:o}=n,a=this._pointerDirectionDelta,l=this._pointerPositionAtLastDirectionChange,_=Math.abs(t-l.x),C=Math.abs(o-l.y);return _>this._config.pointerDirectionChangeThreshold&&(a.x=t>l.x?1:-1,l.x=t),C>this._config.pointerDirectionChangeThreshold&&(a.y=o>l.y?1:-1,l.y=o),a}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,lo(this._rootElement,n))}_removeRootElementListeners(n){n.removeEventListener("mousedown",this._pointerDown,Ce),n.removeEventListener("touchstart",this._pointerDown,fe)}_applyRootElementTransform(n,t){const o=ye(n,t);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform&&"none"!=this._rootElement.style.transform?this._rootElement.style.transform:""),this._rootElement.style.transform=xa(o,this._initialTransform)}_applyPreviewTransform(n,t){var o;const a=null!==(o=this._previewTemplate)&&void 0!==o&&o.template?void 0:this._initialTransform,l=ye(n,t);this._preview.style.transform=xa(l,a)}_getDragDistance(n){const t=this._pickupPositionOnPage;return t?{x:n.x-t.x,y:n.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:t}=this._passiveTransform;if(0===n&&0===t||this.isDragging()||!this._boundaryElement)return;const o=this._boundaryElement.getBoundingClientRect(),a=this._rootElement.getBoundingClientRect();if(0===o.width&&0===o.height||0===a.width&&0===a.height)return;const l=o.left-a.left,_=a.right-o.right,C=o.top-a.top,N=a.bottom-o.bottom;o.width>a.width?(l>0&&(n+=l),_>0&&(n-=_)):n=0,o.height>a.height?(C>0&&(t+=C),N>0&&(t-=N)):t=0,(n!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:n})}_getDragStartDelay(n){const t=this.dragStartDelay;return"number"==typeof t?t:Mt(n)?t.touch:t?t.mouse:0}_updateOnScroll(n){const t=this._parentPositions.handleScroll(n);if(t){const o=(0,Lt.sA)(n);this._boundaryRect&&(o===this._document||o!==this._boundaryElement&&o.contains(this._boundaryElement))&&Ca(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const n=this._parentPositions.positions.get(this._document);return n?n.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,Lt.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,t){const o=this._previewContainer||"global";if("parent"===o)return n;if("global"===o){const a=this._document;return t||a.fullscreenElement||a.webkitFullscreenElement||a.mozFullScreenElement||a.msFullscreenElement||a.body}return(0,gn.fI)(o)}}function ye(i,n){return`translate3d(${Math.round(i)}px, ${Math.round(n)}px, 0)`}function Ze(i,n,t){return Math.max(n,Math.min(t,i))}function $e(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function Mt(i){return"t"===i.type[0]}function It(i,n){const t=i.rootNodes;if(1===t.length&&t[0].nodeType===n.ELEMENT_NODE)return t[0];const o=n.createElement("div");return t.forEach(a=>o.appendChild(a)),o}function ht(i,n){i.style.width=`${n.width}px`,i.style.height=`${n.height}px`,i.style.transform=ye(n.left,n.top)}function At(i,n,t){const o=ft(n,i.length-1),a=ft(t,i.length-1);if(o===a)return;const l=i[o],_=a<o?-1:1;for(let C=o;C!==a;C+=_)i[C]=i[C+_];i[a]=l}function ft(i,n){return Math.max(0,Math.min(n,i))}class Yt{constructor(n,t,o,a,l){this._dragDropRegistry=t,this._ngZone=a,this._viewportRuler=l,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new pn.x,this.entered=new pn.x,this.exited=new pn.x,this.dropped=new pn.x,this.sorted=new pn.x,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=Ui.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new pn.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),Di(0,gi.Z).pipe((0,No.R)(this._stopScrollTimers)).subscribe(()=>{const _=this._scrollNode,C=this.autoScrollStep;1===this._verticalScrollDirection?Wt(_,-C):2===this._verticalScrollDirection&&Wt(_,C),1===this._horizontalScrollDirection?li(_,-C):2===this._horizontalScrollDirection&&li(_,C)})},this.element=(0,gn.fI)(n),this._document=o,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new Ra(o,l)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,t,o,a){let l;this._draggingStarted(),null==a?(l=this.sortingDisabled?this._draggables.indexOf(n):-1,-1===l&&(l=this._getItemIndexFromPointerPosition(n,t,o))):l=a;const _=this._activeDraggables,C=_.indexOf(n),N=n.getPlaceholderElement();let F=_[l];if(F===n&&(F=_[l+1]),C>-1&&_.splice(C,1),F&&!this._dragDropRegistry.isDragging(F)){const V=F.getRootElement();V.parentElement.insertBefore(N,V),_.splice(l,0,n)}else if(this._shouldEnterAsFirstChild(t,o)){const V=_[0].getRootElement();V.parentNode.insertBefore(N,V),_.unshift(n)}else(0,gn.fI)(this.element).appendChild(N),_.push(n);N.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,t,o,a,l,_,C){this._reset(),this.dropped.next({item:n,currentIndex:t,previousIndex:o,container:this,previousContainer:a,isPointerOverContainer:l,distance:_,dropPoint:C})}withItems(n){const t=this._draggables;return this._draggables=n,n.forEach(o=>o._withDropContainer(this)),this.isDragging()&&(t.filter(a=>a.isDragging()).every(a=>-1===n.indexOf(a))?this._reset():this._cacheItems()),this}withDirection(n){return this._direction=n,this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){return this._orientation=n,this}withScrollableParents(n){const t=(0,gn.fI)(this.element);return this._scrollableElements=-1===n.indexOf(t)?[t,...n]:n.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?Gn("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,o=>o.drag===n):this._draggables.indexOf(n)}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,t,o,a){if(this.sortingDisabled||!this._clientRect||!qr(this._clientRect,.05,t,o))return;const l=this._itemPositions,_=this._getItemIndexFromPointerPosition(n,t,o,a);if(-1===_&&l.length>0)return;const C="horizontal"===this._orientation,N=Gn(l,He=>He.drag===n),F=l[_],ue=F.clientRect,ce=N>_?1:-1,Te=this._getItemOffsetPx(l[N].clientRect,ue,ce),We=this._getSiblingOffsetPx(N,l,ce),it=l.slice();At(l,N,_),this.sorted.next({previousIndex:N,currentIndex:_,container:this,item:n}),l.forEach((He,et)=>{if(it[et]===He)return;const xt=He.drag===n,bt=xt?Te:We,vt=xt?n.getPlaceholderElement():He.drag.getRootElement();He.offset+=bt,C?(vt.style.transform=xa(`translate3d(${Math.round(He.offset)}px, 0, 0)`,He.initialTransform),Ca(He.clientRect,0,bt)):(vt.style.transform=xa(`translate3d(0, ${Math.round(He.offset)}px, 0)`,He.initialTransform),Ca(He.clientRect,bt,0))}),this._previousSwap.overlaps=sl(ue,t,o),this._previousSwap.drag=F.drag,this._previousSwap.delta=C?a.x:a.y}_startScrollingIfNecessary(n,t){if(this.autoScrollDisabled)return;let o,a=0,l=0;if(this._parentPositions.positions.forEach((_,C)=>{C===this._document||!_.clientRect||o||qr(_.clientRect,.05,n,t)&&([a,l]=function vi(i,n,t,o){const a=zi(n,o),l=zn(n,t);let _=0,C=0;if(a){const N=i.scrollTop;1===a?N>0&&(_=1):i.scrollHeight-N>i.clientHeight&&(_=2)}if(l){const N=i.scrollLeft;1===l?N>0&&(C=1):i.scrollWidth-N>i.clientWidth&&(C=2)}return[_,C]}(C,_.clientRect,n,t),(a||l)&&(o=C))}),!a&&!l){const{width:_,height:C}=this._viewportRuler.getViewportSize(),N={width:_,height:C,top:0,right:_,bottom:C,left:0};a=zi(N,t),l=zn(N,n),o=window}o&&(a!==this._verticalScrollDirection||l!==this._horizontalScrollDirection||o!==this._scrollNode)&&(this._verticalScrollDirection=a,this._horizontalScrollDirection=l,this._scrollNode=o,(a||l)&&o?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=(0,gn.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const n=(0,gn.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(n).clientRect}_cacheItemPositions(){const n="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const o=t.getVisibleElement();return{drag:t,offset:0,initialTransform:o.style.transform||"",clientRect:br(o)}}).sort((t,o)=>n?t.clientRect.left-o.clientRect.left:t.clientRect.top-o.clientRect.top)}_reset(){this._isDragging=!1;const n=(0,gn.fI)(this.element).style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{var o;const a=t.getRootElement();if(a){const l=null===(o=this._itemPositions.find(_=>_.drag===t))||void 0===o?void 0:o.initialTransform;a.style.transform=l||""}}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(n,t,o){const a="horizontal"===this._orientation,l=t[n].clientRect,_=t[n+-1*o];let C=l[a?"width":"height"]*o;if(_){const N=a?"left":"top",F=a?"right":"bottom";-1===o?C-=_.clientRect[N]-l[F]:C+=l[N]-_.clientRect[F]}return C}_getItemOffsetPx(n,t,o){const a="horizontal"===this._orientation;let l=a?t.left-n.left:t.top-n.top;return-1===o&&(l+=a?t.width-n.width:t.height-n.height),l}_shouldEnterAsFirstChild(n,t){if(!this._activeDraggables.length)return!1;const o=this._itemPositions,a="horizontal"===this._orientation;if(o[0].drag!==this._activeDraggables[0]){const _=o[o.length-1].clientRect;return a?n>=_.right:t>=_.bottom}{const _=o[0].clientRect;return a?n<=_.left:t<=_.top}}_getItemIndexFromPointerPosition(n,t,o,a){const l="horizontal"===this._orientation,_=Gn(this._itemPositions,({drag:C,clientRect:N},F,V)=>{if(C===n)return V.length<2;if(a){const ue=l?a.x:a.y;if(C===this._previousSwap.drag&&this._previousSwap.overlaps&&ue===this._previousSwap.delta)return!1}return l?t>=Math.floor(N.left)&&t<Math.floor(N.right):o>=Math.floor(N.top)&&o<Math.floor(N.bottom)});return-1!==_&&this.sortPredicate(_,n,this)?_:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(n,t){return null!=this._clientRect&&sl(this._clientRect,n,t)}_getSiblingContainerFromPosition(n,t,o){return this._siblings.find(a=>a._canReceive(n,t,o))}_canReceive(n,t,o){if(!this._clientRect||!sl(this._clientRect,t,o)||!this.enterPredicate(n,this))return!1;const a=this._getShadowRoot().elementFromPoint(t,o);if(!a)return!1;const l=(0,gn.fI)(this.element);return a===l||l.contains(a)}_startReceiving(n,t){const o=this._activeSiblings;!o.has(n)&&t.every(a=>this.enterPredicate(a,this)||this._draggables.indexOf(a)>-1)&&(o.add(n),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(n);t&&(this._itemPositions.forEach(({clientRect:o})=>{Ca(o,t.top,t.left)}),this._itemPositions.forEach(({drag:o})=>{this._dragDropRegistry.isDragging(o)&&o._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=(0,Lt.kV)((0,gn.fI)(this.element));this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,n))}}function Gn(i,n){for(let t=0;t<i.length;t++)if(n(i[t],t,i))return t;return-1}function Wt(i,n){i===window?i.scrollBy(0,n):i.scrollTop+=n}function li(i,n){i===window?i.scrollBy(n,0):i.scrollLeft+=n}function zi(i,n){const{top:t,bottom:o,height:a}=i,l=.05*a;return n>=t-l&&n<=t+l?1:n>=o-l&&n<=o+l?2:0}function zn(i,n){const{left:t,right:o,width:a}=i,l=.05*a;return n>=t-l&&n<=t+l?1:n>=o-l&&n<=o+l?2:0}const ri=(0,Lt.i$)({passive:!1,capture:!0});let jo=(()=>{class i{constructor(t,o){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=a=>a.isDragging(),this.pointerMove=new pn.x,this.pointerUp=new pn.x,this.scroll=new pn.x,this._preventDefaultWhileDragging=a=>{this._activeDragInstances.length>0&&a.preventDefault()},this._persistentTouchmoveListener=a=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&a.preventDefault(),this.pointerMove.next(a))},this._document=o}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,ri)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,ri)}startDragging(t,o){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const a=o.type.startsWith("touch");this._globalListeners.set(a?"touchend":"mouseup",{handler:l=>this.pointerUp.next(l),options:!0}).set("scroll",{handler:l=>this.scroll.next(l),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:ri}),a||this._globalListeners.set("mousemove",{handler:l=>this.pointerMove.next(l),options:ri}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((l,_)=>{this._document.addEventListener(_,l.handler,l.options)})})}}stopDragging(t){const o=this._activeDragInstances.indexOf(t);o>-1&&(this._activeDragInstances.splice(o,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const o=[this.scroll];return t&&t!==this._document&&o.push(new Ni.y(a=>this._ngZone.runOutsideAngular(()=>{const _=C=>{this._activeDragInstances.length&&a.next(C)};return t.addEventListener("scroll",_,!0),()=>{t.removeEventListener("scroll",_,!0)}}))),(0,Mo.T)(...o)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,o)=>{this._document.removeEventListener(o,t.handler,t.options)}),this._globalListeners.clear()}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(e.R0b),e.LFG(T.K0))},i.\u0275prov=e.Yz7({factory:function(){return new i(e.LFG(e.R0b),e.LFG(T.K0))},token:i,providedIn:"root"}),i})();const Ci={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let eo=(()=>{class i{constructor(t,o,a,l){this._document=t,this._ngZone=o,this._viewportRuler=a,this._dragDropRegistry=l}createDrag(t,o=Ci){return new Ge(t,o,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Yt(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(T.K0),e.LFG(e.R0b),e.LFG(_n.rL),e.LFG(jo))},i.\u0275prov=e.Yz7({factory:function(){return new i(e.LFG(T.K0),e.LFG(e.R0b),e.LFG(_n.rL),e.LFG(jo))},token:i,providedIn:"root"}),i})();const Oi=new e.OlP("CDK_DRAG_PARENT"),Zn=new e.OlP("CdkDropListGroup"),dr=new e.OlP("CDK_DRAG_CONFIG");let Yi=0;const Ko=new e.OlP("CdkDropList");let Ta=(()=>{class i{constructor(t,o,a,l,_,C,N){this.element=t,this._changeDetectorRef=a,this._scrollDispatcher=l,this._dir=_,this._group=C,this._destroyed=new pn.x,this.connectedTo=[],this.id="cdk-drop-list-"+Yi++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.sorted=new e.vpe,this._unsortedItems=new Set,this._dropListRef=o.createDropList(t),this._dropListRef.data=this,N&&this._assignDefaults(N),this._dropListRef.enterPredicate=(F,V)=>this.enterPredicate(F.data,V.data),this._dropListRef.sortPredicate=(F,V,ue)=>this.sortPredicate(F,V.data,ue.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),i._dropLists.push(this),C&&C._items.add(this)}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=(0,gn.Ig)(t)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,o)=>t._dragRef.getVisibleElement().compareDocumentPosition(o._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=i._dropLists.indexOf(this);t>-1&&i._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe((0,vr.O)(this._dir.value),(0,No.R)(this._destroyed)).subscribe(o=>t.withDirection(o)),t.beforeStarted.subscribe(()=>{const o=(0,gn.Eq)(this.connectedTo).map(a=>"string"==typeof a?i._dropLists.find(_=>_.id===a):a);if(this._group&&this._group._items.forEach(a=>{-1===o.indexOf(a)&&o.push(a)}),!this._scrollableParentsResolved){const a=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(l=>l.getElementRef().nativeElement);this._dropListRef.withScrollableParents(a),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=(0,gn.Ig)(this.sortingDisabled),t.autoScrollDisabled=(0,gn.Ig)(this.autoScrollDisabled),t.autoScrollStep=(0,gn.su)(this.autoScrollStep,2),t.connectedTo(o.filter(a=>a&&a!==this).map(a=>a._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(o=>{this.entered.emit({container:this,item:o.item.data,currentIndex:o.currentIndex})}),t.exited.subscribe(o=>{this.exited.emit({container:this,item:o.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(o=>{this.sorted.emit({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:o.item.data})}),t.dropped.subscribe(o=>{this.dropped.emit({previousIndex:o.previousIndex,currentIndex:o.currentIndex,previousContainer:o.previousContainer.data,container:o.container.data,item:o.item.data,isPointerOverContainer:o.isPointerOverContainer,distance:o.distance,dropPoint:o.dropPoint}),this._changeDetectorRef.markForCheck()})}_assignDefaults(t){const{lockAxis:o,draggingDisabled:a,sortingDisabled:l,listAutoScrollDisabled:_,listOrientation:C}=t;this.disabled=a??!1,this.sortingDisabled=l??!1,this.autoScrollDisabled=_??!1,this.orientation=C||"vertical",o&&(this.lockAxis=o)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(eo),e.Y36(e.sBO),e.Y36(_n.mF),e.Y36(bo.Is,8),e.Y36(Zn,12),e.Y36(dr,8))},i.\u0275dir=e.lG2({type:i,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,o){2&t&&(e.uIk("id",o.id),e.ekj("cdk-drop-list-disabled",o.disabled)("cdk-drop-list-dragging",o._dropListRef.isDragging())("cdk-drop-list-receiving",o._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[e._Bn([{provide:Zn,useValue:void 0},{provide:Ko,useExisting:i}])]}),i._dropLists=[],i})();const to=new e.OlP("CdkDragHandle"),nr=new e.OlP("CdkDragPlaceholder");let Bo=(()=>{class i{constructor(t){this.templateRef=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.Rgc))},i.\u0275dir=e.lG2({type:i,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"},features:[e._Bn([{provide:nr,useExisting:i}])]}),i})();const kr=new e.OlP("CdkDragPreview");let Jr=(()=>{class i{constructor(t,o,a,l,_,C,N,F,V,ue,ce){this.element=t,this.dropContainer=o,this._ngZone=l,this._viewContainerRef=_,this._dir=N,this._changeDetectorRef=V,this._selfHandle=ue,this._parentDrag=ce,this._destroyed=new pn.x,this.started=new e.vpe,this.released=new e.vpe,this.ended=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.dropped=new e.vpe,this.moved=new Ni.y(Te=>{const We=this._dragRef.moved.pipe((0,Oo.U)(it=>({source:this,pointerPosition:it.pointerPosition,event:it.event,delta:it.delta,distance:it.distance}))).subscribe(Te);return()=>{We.unsubscribe()}}),this._dragRef=F.createDrag(t,{dragStartThreshold:C&&null!=C.dragStartThreshold?C.dragStartThreshold:5,pointerDirectionChangeThreshold:C&&null!=C.pointerDirectionChangeThreshold?C.pointerDirectionChangeThreshold:5,zIndex:C?.zIndex}),this._dragRef.data=this,i._dragInstances.push(this),C&&this._assignDefaults(C),o&&(this._dragRef._withDropContainer(o._dropListRef),o.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=(0,gn.Ig)(t),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,So.q)(1),(0,No.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const o=t.rootElementSelector,a=t.freeDragPosition;o&&!o.firstChange&&this._updateRootElement(),a&&!a.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=i._dragInstances.indexOf(this);t>-1&&i._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement,o=this.rootElementSelector?Sc(t,this.rootElementSelector):t;this._dragRef.withRootElement(o||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?Sc(this.element.nativeElement,t):(0,gn.fI)(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const o=this._dir,a=this.dragStartDelay,l=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,_=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof a&&a?a:(0,gn.su)(a),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(l).withPreviewTemplate(_).withPreviewContainer(this.previewContainer||"global"),o&&t.withDirection(o.value)}}),t.beforeStarted.pipe((0,So.q)(1)).subscribe(()=>{var o,a;if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let l=this.element.nativeElement.parentElement;for(;l;){if(null!==(o=l.classList)&&void 0!==o&&o.contains("cdk-drag")){t.withParent((null===(a=i._dragInstances.find(_=>_.element.nativeElement===l))||void 0===a?void 0:a._dragRef)||null);break}l=l.parentElement}})}_handleEvents(t){t.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(()=>{this.released.emit({source:this})}),t.ended.subscribe(o=>{this.ended.emit({source:this,distance:o.distance,dropPoint:o.dropPoint}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(o=>{this.entered.emit({container:o.container.data,item:this,currentIndex:o.currentIndex})}),t.exited.subscribe(o=>{this.exited.emit({container:o.container.data,item:this})}),t.dropped.subscribe(o=>{this.dropped.emit({previousIndex:o.previousIndex,currentIndex:o.currentIndex,previousContainer:o.previousContainer.data,container:o.container.data,isPointerOverContainer:o.isPointerOverContainer,item:this,distance:o.distance,dropPoint:o.dropPoint})})}_assignDefaults(t){const{lockAxis:o,dragStartDelay:a,constrainPosition:l,previewClass:_,boundaryElement:C,draggingDisabled:N,rootElementSelector:F,previewContainer:V}=t;this.disabled=N??!1,this.dragStartDelay=a||0,o&&(this.lockAxis=o),l&&(this.constrainPosition=l),_&&(this.previewClass=_),C&&(this.boundaryElement=C),F&&(this.rootElementSelector=F),V&&(this.previewContainer=V)}_setupHandlesListener(){this._handles.changes.pipe((0,vr.O)(this._handles),(0,ra.b)(t=>{const o=t.filter(a=>a._parentDrag===this).map(a=>a.element);this._selfHandle&&this.rootElementSelector&&o.push(this.element),this._dragRef.withHandles(o)}),(0,aa.w)(t=>(0,Mo.T)(...t.map(o=>o._stateChanges.pipe((0,vr.O)(o))))),(0,No.R)(this._destroyed)).subscribe(t=>{const o=this._dragRef,a=t.element.nativeElement;t.disabled?o.disableHandle(a):o.enableHandle(a)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(Ko,12),e.Y36(T.K0),e.Y36(e.R0b),e.Y36(e.s_b),e.Y36(dr,8),e.Y36(bo.Is,8),e.Y36(eo),e.Y36(e.sBO),e.Y36(to,10),e.Y36(Oi,12))},i.\u0275dir=e.lG2({type:i,selectors:[["","cdkDrag",""]],contentQueries:function(t,o,a){if(1&t&&(e.Suo(a,kr,5),e.Suo(a,nr,5),e.Suo(a,to,5)),2&t){let l;e.iGM(l=e.CRH())&&(o._previewTemplate=l.first),e.iGM(l=e.CRH())&&(o._placeholderTemplate=l.first),e.iGM(l=e.CRH())&&(o._handles=l)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,o){2&t&&e.ekj("cdk-drag-disabled",o.disabled)("cdk-drag-dragging",o._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],previewContainer:["cdkDragPreviewContainer","previewContainer"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[e._Bn([{provide:Oi,useExisting:i}]),e.TTD]}),i._dragInstances=[],i})();function Sc(i,n){let t=i.parentElement;for(;t;){if(t.matches?t.matches(n):t.msMatchesSelector(n))return t;t=t.parentElement}return null}let jr=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[eo],imports:[_n.ZD]}),i})();var R=v(61135),B=v(39300),Y=v(37340),Je=v(11481);const tt=["overlay"];function Qe(i,n){1&i&&e._UZ(0,"div")}function rt(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Qe,1,0,"div",6),e.qZA()),2&i){const t=e.oxw(2);e.Tol(t.spinner.class),e.Udp("color",t.spinner.color),e.xp6(1),e.Q6J("ngForOf",t.spinner.divArray)}}function Ft(i,n){if(1&i&&(e._UZ(0,"div",7),e.ALo(1,"safeHtml")),2&i){const t=e.oxw(2);e.Q6J("innerHTML",e.lcZ(1,1,t.template),e.oJD)}}function Dt(i,n){if(1&i&&(e.TgZ(0,"div",1,2),e.YNc(2,rt,2,5,"div",3),e.YNc(3,Ft,2,3,"div",4),e.TgZ(4,"div",5),e.Hsn(5),e.qZA()()),2&i){const t=e.oxw();e.Udp("background-color",t.spinner.bdColor)("z-index",t.spinner.zIndex)("position",t.spinner.fullScreen?"fixed":"absolute"),e.Q6J("@.disabled",t.disableAnimation)("@fadeIn","in"),e.xp6(2),e.Q6J("ngIf",!t.template),e.xp6(1),e.Q6J("ngIf",t.template),e.xp6(1),e.Udp("z-index",t.spinner.zIndex)}}const dn=["*"],ut={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":4,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1},hn="primary";class In{constructor(n){Object.assign(this,n)}}let Nn=(()=>{class i{constructor(){this.spinnerObservable=new R.X(null)}getSpinner(t){return this.spinnerObservable.asObservable().pipe((0,B.h)(o=>o&&o.name===t))}show(t=hn,o){return new Promise((a,l)=>{setTimeout(()=>{o&&Object.keys(o).length?(o.name=t,this.spinnerObservable.next(new In(Object.assign(Object.assign({},o),{show:!0}))),a(!0)):(this.spinnerObservable.next(new In({name:t,show:!0})),a(!0))},10)})}hide(t=hn,o=10){return new Promise((a,l)=>{setTimeout(()=>{this.spinnerObservable.next(new In({name:t,show:!1})),a(!0)},o)})}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({factory:function(){return new i},token:i,providedIn:"root"}),i})(),Wi=(()=>{class i{constructor(t,o){this.spinnerService=t,this.changeDetector=o,this.disableAnimation=!1,this.spinner=new In,this.ngUnsubscribe=new pn.x,this.setDefaultOptions=()=>{this.spinner=new In({name:this.name,bdColor:this.bdColor,size:this.size,color:this.color,type:this.type,fullScreen:this.fullScreen,divArray:this.divArray,divCount:this.divCount,show:this.show,zIndex:this.zIndex,template:this.template,showSpinner:this.showSpinner})},this.bdColor="rgba(51,51,51,0.8)",this.zIndex=99999,this.color="#fff",this.type="ball-scale-multiple",this.size="large",this.fullScreen=!0,this.name=hn,this.template=null,this.showSpinner=!1,this.divArray=[],this.divCount=0,this.show=!1}handleKeyboardEvent(t){this.spinnerDOM&&this.spinnerDOM.nativeElement&&this.fullScreen&&(t.returnValue=!1,t.preventDefault())}ngOnInit(){this.setDefaultOptions(),this.spinnerService.getSpinner(this.name).pipe((0,No.R)(this.ngUnsubscribe)).subscribe(t=>{this.setDefaultOptions(),Object.assign(this.spinner,t),t.show&&this.onInputChange(),this.changeDetector.detectChanges()})}ngOnChanges(t){for(const o in t)if(o){const a=t[o];if(a.isFirstChange())return;typeof a.currentValue<"u"&&a.currentValue!==a.previousValue&&""!==a.currentValue&&(this.spinner[o]=a.currentValue,"showSpinner"===o&&(a.currentValue?this.spinnerService.show(this.spinner.name,this.spinner):this.spinnerService.hide(this.spinner.name)))}}getClass(t,o){this.spinner.divCount=ut[t],this.spinner.divArray=Array(this.spinner.divCount).fill(0).map((l,_)=>_);let a="";switch(o.toLowerCase()){case"small":a="la-sm";break;case"medium":a="la-2x";break;case"large":a="la-3x"}return"la-"+t+" "+a}onInputChange(){this.spinner.class=this.getClass(this.spinner.type,this.spinner.size)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Nn),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ngx-spinner"]],viewQuery:function(t,o){if(1&t&&e.Gf(tt,5),2&t){let a;e.iGM(a=e.CRH())&&(o.spinnerDOM=a.first)}},hostBindings:function(t,o){1&t&&e.NdJ("keydown",function(l){return o.handleKeyboardEvent(l)},!1,e.evT)},inputs:{disableAnimation:"disableAnimation",bdColor:"bdColor",zIndex:"zIndex",color:"color",type:"type",size:"size",fullScreen:"fullScreen",name:"name",template:"template",showSpinner:"showSpinner"},features:[e.TTD],ngContentSelectors:dn,decls:1,vars:1,consts:[["class","ngx-spinner-overlay",3,"background-color","z-index","position",4,"ngIf"],[1,"ngx-spinner-overlay"],["overlay",""],[3,"class","color",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"loading-text"],[4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(t,o){1&t&&(e.F$t(),e.YNc(0,Dt,6,12,"div",0)),2&t&&e.Q6J("ngIf",o.spinner.show)},dependencies:function(){return[T.sg,T.O5,Ot]},styles:['.la-ball-8bits[_ngcontent-%COMP%], .la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-8bits[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-8bits.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-8bits[_ngcontent-%COMP%]{width:12px;height:12px}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:4px;height:4px;border-radius:0;opacity:0;transform:translate(100%,100%);-webkit-animation:_ngcontent-%COMP%_ball-8bits 1s ease 0s infinite;animation:_ngcontent-%COMP%_ball-8bits 1s ease 0s infinite}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:-.9375s;animation-delay:-.9375s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.8125s;animation-delay:-.8125s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.6875s;animation-delay:-.6875s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-delay:-.5625s;animation-delay:-.5625s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-delay:-.4375s;animation-delay:-.4375s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(10){-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(11){-webkit-animation-delay:-.3125s;animation-delay:-.3125s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(12){-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(13){-webkit-animation-delay:-.1875s;animation-delay:-.1875s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(14){-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(15){-webkit-animation-delay:-.0625s;animation-delay:-.0625s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(16){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:-100%;left:0}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:-100%;left:33.3333333333%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:-66.6666666667%;left:66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:-33.3333333333%;left:100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:0;left:100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:33.3333333333%;left:100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:66.6666666667%;left:66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:100%;left:33.3333333333%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){top:100%;left:0}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(10){top:100%;left:-33.3333333333%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(11){top:66.6666666667%;left:-66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(12){top:33.3333333333%;left:-100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(13){top:0;left:-100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(14){top:-33.3333333333%;left:-100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(15){top:-66.6666666667%;left:-66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(16){top:-100%;left:-33.3333333333%}.la-ball-8bits.la-sm[_ngcontent-%COMP%]{width:6px;height:6px}.la-ball-8bits.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:2px}.la-ball-8bits.la-2x[_ngcontent-%COMP%]{width:24px;height:24px}.la-ball-8bits.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px}.la-ball-8bits.la-3x[_ngcontent-%COMP%]{width:36px;height:36px}.la-ball-8bits.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:12px}@-webkit-keyframes _ngcontent-%COMP%_ball-8bits{0%{opacity:1}50%{opacity:1}51%{opacity:0}}@keyframes _ngcontent-%COMP%_ball-8bits{0%{opacity:1}50%{opacity:1}51%{opacity:0}}.la-ball-atom[_ngcontent-%COMP%], .la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-atom[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-atom.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-atom[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{position:absolute;top:50%;left:50%;z-index:1;width:60%;height:60%;background:#aaa;border-radius:100%;transform:translate(-50%,-50%);-webkit-animation:_ngcontent-%COMP%_ball-atom-shrink 4.5s linear infinite;animation:_ngcontent-%COMP%_ball-atom-shrink 4.5s linear infinite}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){position:absolute;left:0;z-index:0;width:100%;height:100%;background:none;-webkit-animation:_ngcontent-%COMP%_ball-atom-zindex 1.5s steps(2) 0s infinite;animation:_ngcontent-%COMP%_ball-atom-zindex 1.5s steps(2) 0s infinite}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):before{position:absolute;top:0;left:0;width:10px;height:10px;margin-top:-5px;margin-left:-5px;content:"";background:currentColor;border-radius:50%;opacity:.75;-webkit-animation:_ngcontent-%COMP%_ball-atom-position 1.5s ease 0s infinite,ball-atom-size 1.5s ease 0s infinite;animation:_ngcontent-%COMP%_ball-atom-position 1.5s ease 0s infinite,ball-atom-size 1.5s ease 0s infinite}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:.75s;animation-delay:.75s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2):before{-webkit-animation-delay:0s,-1.125s;animation-delay:0s,-1.125s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){transform:rotate(120deg);-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3):before{-webkit-animation-delay:-1s,-.75s;animation-delay:-1s,-.75s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){transform:rotate(240deg);-webkit-animation-delay:.25s;animation-delay:.25s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4):before{-webkit-animation-delay:-.5s,-.125s;animation-delay:-.5s,-.125s}.la-ball-atom.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-atom.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):before{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-atom.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-atom.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):before{width:20px;height:20px;margin-top:-10px;margin-left:-10px}.la-ball-atom.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-atom.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):before{width:30px;height:30px;margin-top:-15px;margin-left:-15px}@-webkit-keyframes _ngcontent-%COMP%_ball-atom-position{50%{top:100%;left:100%}}@keyframes _ngcontent-%COMP%_ball-atom-position{50%{top:100%;left:100%}}@-webkit-keyframes _ngcontent-%COMP%_ball-atom-size{50%{transform:scale(.5)}}@keyframes _ngcontent-%COMP%_ball-atom-size{50%{transform:scale(.5)}}@-webkit-keyframes _ngcontent-%COMP%_ball-atom-zindex{50%{z-index:10}}@keyframes _ngcontent-%COMP%_ball-atom-zindex{50%{z-index:10}}@-webkit-keyframes _ngcontent-%COMP%_ball-atom-shrink{50%{transform:translate(-50%,-50%) scale(.8)}}@keyframes _ngcontent-%COMP%_ball-atom-shrink{50%{transform:translate(-50%,-50%) scale(.8)}}.la-ball-beat[_ngcontent-%COMP%], .la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-beat[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-beat.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-beat[_ngcontent-%COMP%]{width:54px;height:18px}.la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;margin:4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-beat .7s linear -.15s infinite;animation:_ngcontent-%COMP%_ball-beat .7s linear -.15s infinite}.la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2n-1){-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-beat.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-beat.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-beat.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-beat.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-beat.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-beat.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes _ngcontent-%COMP%_ball-beat{50%{opacity:.2;transform:scale(.75)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-beat{50%{opacity:.2;transform:scale(.75)}to{opacity:1;transform:scale(1)}}.la-ball-circus[_ngcontent-%COMP%], .la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-circus[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-circus.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-circus[_ngcontent-%COMP%], .la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:-100%;display:block;width:100%;height:100%;border-radius:100%;opacity:.5;-webkit-animation:_ngcontent-%COMP%_ball-circus-position 2.5s cubic-bezier(.25,0,.75,1) infinite,ball-circus-size 2.5s cubic-bezier(.25,0,.75,1) infinite;animation:_ngcontent-%COMP%_ball-circus-position 2.5s cubic-bezier(.25,0,.75,1) infinite,ball-circus-size 2.5s cubic-bezier(.25,0,.75,1) infinite}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:0s,-.5s;animation-delay:0s,-.5s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.5s,-1s;animation-delay:-.5s,-1s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-1s,-1.5s;animation-delay:-1s,-1.5s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-1.5s,-2s;animation-delay:-1.5s,-2s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-2s,-2.5s;animation-delay:-2s,-2.5s}.la-ball-circus.la-sm[_ngcontent-%COMP%], .la-ball-circus.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px}.la-ball-circus.la-2x[_ngcontent-%COMP%], .la-ball-circus.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-circus.la-3x[_ngcontent-%COMP%], .la-ball-circus.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:48px;height:48px}@-webkit-keyframes _ngcontent-%COMP%_ball-circus-position{50%{left:100%}}@keyframes _ngcontent-%COMP%_ball-circus-position{50%{left:100%}}@-webkit-keyframes _ngcontent-%COMP%_ball-circus-size{50%{transform:scale(.3)}}@keyframes _ngcontent-%COMP%_ball-circus-size{50%{transform:scale(.3)}}.la-ball-climbing-dot[_ngcontent-%COMP%], .la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-climbing-dot[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-climbing-dot.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-climbing-dot[_ngcontent-%COMP%]{width:42px;height:32px}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{position:absolute;bottom:32%;left:18%;width:14px;height:14px;border-radius:100%;transform-origin:center bottom;-webkit-animation:_ngcontent-%COMP%_ball-climbing-dot-jump .6s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-climbing-dot-jump .6s ease-in-out infinite}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){position:absolute;top:0;right:0;width:14px;height:2px;border-radius:0;transform:translate(60%);-webkit-animation:_ngcontent-%COMP%_ball-climbing-dot-steps 1.8s linear infinite;animation:_ngcontent-%COMP%_ball-climbing-dot-steps 1.8s linear infinite}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):nth-child(2){-webkit-animation-delay:0ms;animation-delay:0ms}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):nth-child(3){-webkit-animation-delay:-.6s;animation-delay:-.6s}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child):nth-child(4){-webkit-animation-delay:-1.2s;animation-delay:-1.2s}.la-ball-climbing-dot.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-ball-climbing-dot.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:6px;height:6px}.la-ball-climbing-dot.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){width:6px;height:1px}.la-ball-climbing-dot.la-2x[_ngcontent-%COMP%]{width:84px;height:64px}.la-ball-climbing-dot.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:28px;height:28px}.la-ball-climbing-dot.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){width:28px;height:4px}.la-ball-climbing-dot.la-3x[_ngcontent-%COMP%]{width:126px;height:96px}.la-ball-climbing-dot.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:42px;height:42px}.la-ball-climbing-dot.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:first-child){width:42px;height:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-climbing-dot-jump{0%{transform:scaleY(.7)}20%{transform:scale(.7,1.2)}40%{transform:scale(1)}50%{bottom:125%}46%{transform:scale(1)}80%{transform:scale(.7,1.2)}90%{transform:scale(.7,1.2)}to{transform:scaleY(.7)}}@keyframes _ngcontent-%COMP%_ball-climbing-dot-jump{0%{transform:scaleY(.7)}20%{transform:scale(.7,1.2)}40%{transform:scale(1)}50%{bottom:125%}46%{transform:scale(1)}80%{transform:scale(.7,1.2)}90%{transform:scale(.7,1.2)}to{transform:scaleY(.7)}}@-webkit-keyframes _ngcontent-%COMP%_ball-climbing-dot-steps{0%{top:0;right:0;opacity:0}50%{opacity:1}to{top:100%;right:100%;opacity:0}}@keyframes _ngcontent-%COMP%_ball-climbing-dot-steps{0%{top:0;right:0;opacity:0}50%{opacity:1}to{top:100%;right:100%;opacity:0}}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%], .la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-clip-rotate-multiple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;background:transparent;border-style:solid;border-width:2px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-clip-rotate-multiple-rotate 1s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-clip-rotate-multiple-rotate 1s ease-in-out infinite}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{position:absolute;width:32px;height:32px;border-right-color:transparent;border-left-color:transparent}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:16px;height:16px;border-top-color:transparent;border-bottom-color:transparent;-webkit-animation-duration:.5s;animation-duration:.5s;-webkit-animation-direction:reverse;animation-direction:reverse}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:1px}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:16px;height:16px}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:8px;height:8px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:4px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:64px;height:64px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:32px;height:32px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:6px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:96px;height:96px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:48px;height:48px}@-webkit-keyframes _ngcontent-%COMP%_ball-clip-rotate-multiple-rotate{0%{transform:translate(-50%,-50%) rotate(0deg)}50%{transform:translate(-50%,-50%) rotate(180deg)}to{transform:translate(-50%,-50%) rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-clip-rotate-multiple-rotate{0%{transform:translate(-50%,-50%) rotate(0deg)}50%{transform:translate(-50%,-50%) rotate(180deg)}to{transform:translate(-50%,-50%) rotate(1turn)}}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%], .la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-clip-rotate-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;border-radius:100%}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{position:absolute;width:32px;height:32px;background:transparent;border-bottom-style:solid;border-top-style:solid;border-bottom-width:2px;border-top-width:2px;border-right:2px solid transparent;border-left:2px solid transparent;-webkit-animation:_ngcontent-%COMP%_ball-clip-rotate-pulse-rotate 1s cubic-bezier(.09,.57,.49,.9) infinite;animation:_ngcontent-%COMP%_ball-clip-rotate-pulse-rotate 1s cubic-bezier(.09,.57,.49,.9) infinite}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:16px;height:16px;-webkit-animation:_ngcontent-%COMP%_ball-clip-rotate-pulse-scale 1s cubic-bezier(.09,.57,.49,.9) infinite;animation:_ngcontent-%COMP%_ball-clip-rotate-pulse-scale 1s cubic-bezier(.09,.57,.49,.9) infinite}.la-ball-clip-rotate-pulse.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-clip-rotate-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:16px;height:16px;border-width:1px}.la-ball-clip-rotate-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:8px;height:8px}.la-ball-clip-rotate-pulse.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-clip-rotate-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:64px;height:64px;border-width:4px}.la-ball-clip-rotate-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:32px;height:32px}.la-ball-clip-rotate-pulse.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-clip-rotate-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:96px;height:96px;border-width:6px}.la-ball-clip-rotate-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:48px;height:48px}@-webkit-keyframes _ngcontent-%COMP%_ball-clip-rotate-pulse-rotate{0%{transform:translate(-50%,-50%) rotate(0deg)}50%{transform:translate(-50%,-50%) rotate(180deg)}to{transform:translate(-50%,-50%) rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-clip-rotate-pulse-rotate{0%{transform:translate(-50%,-50%) rotate(0deg)}50%{transform:translate(-50%,-50%) rotate(180deg)}to{transform:translate(-50%,-50%) rotate(1turn)}}@-webkit-keyframes _ngcontent-%COMP%_ball-clip-rotate-pulse-scale{0%,to{opacity:1;transform:translate(-50%,-50%) scale(1)}30%{opacity:.3;transform:translate(-50%,-50%) scale(.15)}}@keyframes _ngcontent-%COMP%_ball-clip-rotate-pulse-scale{0%,to{opacity:1;transform:translate(-50%,-50%) scale(1)}30%{opacity:.3;transform:translate(-50%,-50%) scale(.15)}}.la-ball-clip-rotate[_ngcontent-%COMP%], .la-ball-clip-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-clip-rotate[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-clip-rotate.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-clip-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-clip-rotate[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-clip-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:32px;height:32px;background:transparent;border-width:2px;border-bottom-color:transparent;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-clip-rotate .75s linear infinite;animation:_ngcontent-%COMP%_ball-clip-rotate .75s linear infinite}.la-ball-clip-rotate.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-clip-rotate.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-ball-clip-rotate.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-clip-rotate.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-ball-clip-rotate.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-clip-rotate.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-clip-rotate{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-clip-rotate{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}.la-ball-elastic-dots[_ngcontent-%COMP%], .la-ball-elastic-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-elastic-dots[_ngcontent-%COMP%]{display:block;color:#fff}.la-ball-elastic-dots.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-elastic-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{float:none;background-color:currentColor;border:0 solid}.la-ball-elastic-dots[_ngcontent-%COMP%]{width:120px;height:10px;font-size:0;text-align:center}.la-ball-elastic-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;width:10px;height:10px;white-space:nowrap;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-elastic-dots-anim 1s infinite;animation:_ngcontent-%COMP%_ball-elastic-dots-anim 1s infinite}.la-ball-elastic-dots.la-sm[_ngcontent-%COMP%]{width:60px;height:4px}.la-ball-elastic-dots.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-elastic-dots.la-2x[_ngcontent-%COMP%]{width:240px;height:20px}.la-ball-elastic-dots.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-elastic-dots.la-3x[_ngcontent-%COMP%]{width:360px;height:30px}.la-ball-elastic-dots.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes _ngcontent-%COMP%_ball-elastic-dots-anim{0%,to{margin:0;transform:scale(1)}50%{margin:0 5%;transform:scale(.65)}}@keyframes _ngcontent-%COMP%_ball-elastic-dots-anim{0%,to{margin:0;transform:scale(1)}50%{margin:0 5%;transform:scale(.65)}}.la-ball-fall[_ngcontent-%COMP%], .la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-fall[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-fall.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-fall[_ngcontent-%COMP%]{width:54px;height:18px}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;margin:4px;border-radius:100%;opacity:0;-webkit-animation:_ngcontent-%COMP%_ball-fall 1s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-fall 1s ease-in-out infinite}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:-.2s;animation-delay:-.2s}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.1s;animation-delay:-.1s}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:0ms;animation-delay:0ms}.la-ball-fall.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-fall.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-fall.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-fall.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-fall.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-fall.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes _ngcontent-%COMP%_ball-fall{0%{opacity:0;transform:translateY(-145%)}10%{opacity:.5}20%{opacity:1;transform:translateY(0)}80%{opacity:1;transform:translateY(0)}90%{opacity:.5}to{opacity:0;transform:translateY(145%)}}@keyframes _ngcontent-%COMP%_ball-fall{0%{opacity:0;transform:translateY(-145%)}10%{opacity:.5}20%{opacity:1;transform:translateY(0)}80%{opacity:1;transform:translateY(0)}90%{opacity:.5}to{opacity:0;transform:translateY(145%)}}.la-ball-fussion[_ngcontent-%COMP%], .la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-fussion[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-fussion.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-fussion[_ngcontent-%COMP%]{width:8px;height:8px}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;width:12px;height:12px;border-radius:100%;transform:translate(-50%,-50%);-webkit-animation:_ngcontent-%COMP%_ball-fussion-ball1 1s ease 0s infinite;animation:_ngcontent-%COMP%_ball-fussion-ball1 1s ease 0s infinite}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:0;left:50%;z-index:1}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:50%;left:100%;z-index:2;-webkit-animation-name:_ngcontent-%COMP%_ball-fussion-ball2;animation-name:_ngcontent-%COMP%_ball-fussion-ball2}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:100%;left:50%;z-index:1;-webkit-animation-name:_ngcontent-%COMP%_ball-fussion-ball3;animation-name:_ngcontent-%COMP%_ball-fussion-ball3}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:50%;left:0;z-index:2;-webkit-animation-name:_ngcontent-%COMP%_ball-fussion-ball4;animation-name:_ngcontent-%COMP%_ball-fussion-ball4}.la-ball-fussion.la-sm[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-fussion.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px}.la-ball-fussion.la-2x[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-fussion.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-ball-fussion.la-3x[_ngcontent-%COMP%]{width:24px;height:24px}.la-ball-fussion.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px}@-webkit-keyframes _ngcontent-%COMP%_ball-fussion-ball1{0%{opacity:.35}50%{top:-100%;left:200%;opacity:1}to{top:50%;left:100%;z-index:2;opacity:.35}}@keyframes _ngcontent-%COMP%_ball-fussion-ball1{0%{opacity:.35}50%{top:-100%;left:200%;opacity:1}to{top:50%;left:100%;z-index:2;opacity:.35}}@-webkit-keyframes _ngcontent-%COMP%_ball-fussion-ball2{0%{opacity:.35}50%{top:200%;left:200%;opacity:1}to{top:100%;left:50%;z-index:1;opacity:.35}}@keyframes _ngcontent-%COMP%_ball-fussion-ball2{0%{opacity:.35}50%{top:200%;left:200%;opacity:1}to{top:100%;left:50%;z-index:1;opacity:.35}}@-webkit-keyframes _ngcontent-%COMP%_ball-fussion-ball3{0%{opacity:.35}50%{top:200%;left:-100%;opacity:1}to{top:50%;left:0;z-index:2;opacity:.35}}@keyframes _ngcontent-%COMP%_ball-fussion-ball3{0%{opacity:.35}50%{top:200%;left:-100%;opacity:1}to{top:50%;left:0;z-index:2;opacity:.35}}@-webkit-keyframes _ngcontent-%COMP%_ball-fussion-ball4{0%{opacity:.35}50%{top:-100%;left:-100%;opacity:1}to{top:0;left:50%;z-index:1;opacity:.35}}@keyframes _ngcontent-%COMP%_ball-fussion-ball4{0%{opacity:.35}50%{top:-100%;left:-100%;opacity:1}to{top:0;left:50%;z-index:1;opacity:.35}}.la-ball-grid-beat[_ngcontent-%COMP%], .la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-grid-beat[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-grid-beat.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-grid-beat[_ngcontent-%COMP%]{width:36px;height:36px}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px;margin:2px;border-radius:100%;-webkit-animation-name:_ngcontent-%COMP%_ball-grid-beat;animation-name:_ngcontent-%COMP%_ball-grid-beat;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-duration:.65s;animation-duration:.65s;-webkit-animation-delay:.03s;animation-delay:.03s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:1.02s;animation-duration:1.02s;-webkit-animation-delay:.09s;animation-delay:.09s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:1.06s;animation-duration:1.06s;-webkit-animation-delay:-.69s;animation-delay:-.69s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-delay:-.41s;animation-delay:-.41s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:1.6s;animation-duration:1.6s;-webkit-animation-delay:.04s;animation-delay:.04s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-duration:.84s;animation-duration:.84s;-webkit-animation-delay:.07s;animation-delay:.07s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-duration:.68s;animation-duration:.68s;-webkit-animation-delay:-.66s;animation-delay:-.66s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-duration:.93s;animation-duration:.93s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-duration:1.24s;animation-duration:1.24s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-beat.la-sm[_ngcontent-%COMP%]{width:18px;height:18px}.la-ball-grid-beat.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-grid-beat.la-2x[_ngcontent-%COMP%]{width:72px;height:72px}.la-ball-grid-beat.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin:4px}.la-ball-grid-beat.la-3x[_ngcontent-%COMP%]{width:108px;height:108px}.la-ball-grid-beat.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-grid-beat{0%{opacity:1}50%{opacity:.35}to{opacity:1}}@keyframes _ngcontent-%COMP%_ball-grid-beat{0%{opacity:1}50%{opacity:.35}to{opacity:1}}.la-ball-grid-pulse[_ngcontent-%COMP%], .la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-grid-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-grid-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-grid-pulse[_ngcontent-%COMP%]{width:36px;height:36px}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px;margin:2px;border-radius:100%;-webkit-animation-name:_ngcontent-%COMP%_ball-grid-pulse;animation-name:_ngcontent-%COMP%_ball-grid-pulse;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-duration:.65s;animation-duration:.65s;-webkit-animation-delay:.03s;animation-delay:.03s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:1.02s;animation-duration:1.02s;-webkit-animation-delay:.09s;animation-delay:.09s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:1.06s;animation-duration:1.06s;-webkit-animation-delay:-.69s;animation-delay:-.69s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-delay:-.41s;animation-delay:-.41s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:1.6s;animation-duration:1.6s;-webkit-animation-delay:.04s;animation-delay:.04s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-duration:.84s;animation-duration:.84s;-webkit-animation-delay:.07s;animation-delay:.07s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-duration:.68s;animation-duration:.68s;-webkit-animation-delay:-.66s;animation-delay:-.66s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-duration:.93s;animation-duration:.93s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-duration:1.24s;animation-duration:1.24s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-pulse.la-sm[_ngcontent-%COMP%]{width:18px;height:18px}.la-ball-grid-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-grid-pulse.la-2x[_ngcontent-%COMP%]{width:72px;height:72px}.la-ball-grid-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin:4px}.la-ball-grid-pulse.la-3x[_ngcontent-%COMP%]{width:108px;height:108px}.la-ball-grid-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-grid-pulse{0%{opacity:1;transform:scale(1)}50%{opacity:.35;transform:scale(.45)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-grid-pulse{0%{opacity:1;transform:scale(1)}50%{opacity:.35;transform:scale(.45)}to{opacity:1;transform:scale(1)}}.la-ball-newton-cradle[_ngcontent-%COMP%], .la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-newton-cradle[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-newton-cradle.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-newton-cradle[_ngcontent-%COMP%]{width:40px;height:10px}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:100%}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{transform:translateX(0);-webkit-animation:_ngcontent-%COMP%_ball-newton-cradle-left 1s ease-out 0s infinite;animation:_ngcontent-%COMP%_ball-newton-cradle-left 1s ease-out 0s infinite}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{transform:translateX(0);-webkit-animation:_ngcontent-%COMP%_ball-newton-cradle-right 1s ease-out 0s infinite;animation:_ngcontent-%COMP%_ball-newton-cradle-right 1s ease-out 0s infinite}.la-ball-newton-cradle.la-sm[_ngcontent-%COMP%]{width:20px;height:4px}.la-ball-newton-cradle.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-newton-cradle.la-2x[_ngcontent-%COMP%]{width:80px;height:20px}.la-ball-newton-cradle.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-newton-cradle.la-3x[_ngcontent-%COMP%]{width:120px;height:30px}.la-ball-newton-cradle.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes _ngcontent-%COMP%_ball-newton-cradle-left{25%{transform:translateX(-100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{transform:translateX(0)}}@keyframes _ngcontent-%COMP%_ball-newton-cradle-left{25%{transform:translateX(-100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{transform:translateX(0)}}@-webkit-keyframes _ngcontent-%COMP%_ball-newton-cradle-right{50%{transform:translateX(0)}75%{transform:translateX(100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{transform:translateX(0)}}@keyframes _ngcontent-%COMP%_ball-newton-cradle-right{50%{transform:translateX(0)}75%{transform:translateX(100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{transform:translateX(0)}}.la-ball-pulse-rise[_ngcontent-%COMP%], .la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-pulse-rise[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-pulse-rise.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-pulse-rise[_ngcontent-%COMP%]{width:70px;height:14px}.la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;margin:2px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-pulse-rise-even 1s cubic-bezier(.15,.36,.9,.6) 0s infinite;animation:_ngcontent-%COMP%_ball-pulse-rise-even 1s cubic-bezier(.15,.36,.9,.6) 0s infinite}.la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2n-1){-webkit-animation-name:_ngcontent-%COMP%_ball-pulse-rise-odd;animation-name:_ngcontent-%COMP%_ball-pulse-rise-odd}.la-ball-pulse-rise.la-sm[_ngcontent-%COMP%]{width:34px;height:6px}.la-ball-pulse-rise.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-pulse-rise.la-2x[_ngcontent-%COMP%]{width:140px;height:28px}.la-ball-pulse-rise.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:4px}.la-ball-pulse-rise.la-3x[_ngcontent-%COMP%]{width:210px;height:42px}.la-ball-pulse-rise.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-pulse-rise-even{0%{opacity:1;transform:scale(1.1)}25%{transform:translateY(-200%)}50%{opacity:.35;transform:scale(.3)}75%{transform:translateY(200%)}to{opacity:1;transform:translateY(0);transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-pulse-rise-even{0%{opacity:1;transform:scale(1.1)}25%{transform:translateY(-200%)}50%{opacity:.35;transform:scale(.3)}75%{transform:translateY(200%)}to{opacity:1;transform:translateY(0);transform:scale(1)}}@-webkit-keyframes _ngcontent-%COMP%_ball-pulse-rise-odd{0%{opacity:.35;transform:scale(.4)}25%{transform:translateY(200%)}50%{opacity:1;transform:scale(1.1)}75%{transform:translateY(-200%)}to{opacity:.35;transform:translateY(0);transform:scale(.75)}}@keyframes _ngcontent-%COMP%_ball-pulse-rise-odd{0%{opacity:.35;transform:scale(.4)}25%{transform:translateY(200%)}50%{opacity:1;transform:scale(1.1)}75%{transform:translateY(-200%)}to{opacity:.35;transform:translateY(0);transform:scale(.75)}}.la-ball-pulse-sync[_ngcontent-%COMP%], .la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-pulse-sync[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-pulse-sync.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-pulse-sync[_ngcontent-%COMP%]{width:54px;height:18px}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;margin:4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-pulse-sync .6s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-pulse-sync .6s ease-in-out infinite}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:-.14s;animation-delay:-.14s}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.07s;animation-delay:-.07s}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-pulse-sync.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-pulse-sync.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-pulse-sync.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-pulse-sync.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-pulse-sync.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-pulse-sync.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes _ngcontent-%COMP%_ball-pulse-sync{33%{transform:translateY(100%)}66%{transform:translateY(-100%)}to{transform:translateY(0)}}@keyframes _ngcontent-%COMP%_ball-pulse-sync{33%{transform:translateY(100%)}66%{transform:translateY(-100%)}to{transform:translateY(0)}}.la-ball-pulse[_ngcontent-%COMP%], .la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-pulse[_ngcontent-%COMP%]{width:54px;height:18px}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:-.2s;animation-delay:-.2s}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.1s;animation-delay:-.1s}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:0ms;animation-delay:0ms}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px;margin:4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-pulse 1s ease infinite;animation:_ngcontent-%COMP%_ball-pulse 1s ease infinite}.la-ball-pulse.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-pulse.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-pulse.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes _ngcontent-%COMP%_ball-pulse{0%,60%,to{opacity:1;transform:scale(1)}30%{opacity:.1;transform:scale(.01)}}@keyframes _ngcontent-%COMP%_ball-pulse{0%,60%,to{opacity:1;transform:scale(1)}30%{opacity:.1;transform:scale(.01)}}.la-ball-rotate[_ngcontent-%COMP%], .la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-rotate[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-rotate.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-rotate[_ngcontent-%COMP%], .la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:10px;height:10px}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-rotate-animation 1s cubic-bezier(.7,-.13,.22,.86) infinite;animation:_ngcontent-%COMP%_ball-rotate-animation 1s cubic-bezier(.7,-.13,.22,.86) infinite}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{position:absolute;width:inherit;height:inherit;margin:inherit;content:"";background:currentColor;border-radius:inherit;opacity:.8}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:0;left:-150%}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{top:0;left:150%}.la-ball-rotate.la-sm[_ngcontent-%COMP%], .la-ball-rotate.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-rotate.la-2x[_ngcontent-%COMP%], .la-ball-rotate.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-rotate.la-3x[_ngcontent-%COMP%], .la-ball-rotate.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes _ngcontent-%COMP%_ball-rotate-animation{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-rotate-animation{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}.la-ball-running-dots[_ngcontent-%COMP%], .la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-running-dots[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-running-dots.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-running-dots[_ngcontent-%COMP%]{width:10px;height:10px}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;width:10px;height:10px;margin-left:-25px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-running-dots-animate 2s linear infinite;animation:_ngcontent-%COMP%_ball-running-dots-animate 2s linear infinite}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:0s;animation-delay:0s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.4s;animation-delay:-.4s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.8s;animation-delay:-.8s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-1.2s;animation-delay:-1.2s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-1.6s;animation-delay:-1.6s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-delay:-2.4s;animation-delay:-2.4s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-delay:-2.8s;animation-delay:-2.8s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-delay:-3.2s;animation-delay:-3.2s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(10){-webkit-animation-delay:-3.6s;animation-delay:-3.6s}.la-ball-running-dots.la-sm[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-running-dots.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-left:-12px}.la-ball-running-dots.la-2x[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-running-dots.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:-50px}.la-ball-running-dots.la-3x[_ngcontent-%COMP%]{width:30px;height:30px}.la-ball-running-dots.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin-left:-75px}@-webkit-keyframes _ngcontent-%COMP%_ball-running-dots-animate{0%,to{width:100%;height:100%;transform:translateY(0) translateX(500%)}80%{transform:translateY(0) translateX(0)}85%{width:100%;height:100%;transform:translateY(-125%) translateX(0)}90%{width:200%;height:75%}95%{width:100%;height:100%;transform:translateY(-100%) translateX(500%)}}@keyframes _ngcontent-%COMP%_ball-running-dots-animate{0%,to{width:100%;height:100%;transform:translateY(0) translateX(500%)}80%{transform:translateY(0) translateX(0)}85%{width:100%;height:100%;transform:translateY(-125%) translateX(0)}90%{width:200%;height:75%}95%{width:100%;height:100%;transform:translateY(-100%) translateX(500%)}}.la-ball-scale-multiple[_ngcontent-%COMP%], .la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-multiple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-scale-multiple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-scale-multiple[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:32px;height:32px;border-radius:100%;opacity:0;-webkit-animation:_ngcontent-%COMP%_ball-scale-multiple 1s linear 0s infinite;animation:_ngcontent-%COMP%_ball-scale-multiple 1s linear 0s infinite}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}.la-ball-scale-multiple.la-sm[_ngcontent-%COMP%], .la-ball-scale-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-multiple.la-2x[_ngcontent-%COMP%], .la-ball-scale-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-multiple.la-3x[_ngcontent-%COMP%], .la-ball-scale-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes _ngcontent-%COMP%_ball-scale-multiple{0%{opacity:0;transform:scale(0)}5%{opacity:.75}to{opacity:0;transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-scale-multiple{0%{opacity:0;transform:scale(0)}5%{opacity:.75}to{opacity:0;transform:scale(1)}}.la-ball-scale-pulse[_ngcontent-%COMP%], .la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-scale-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-scale-pulse[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:32px;height:32px;border-radius:100%;opacity:.5;-webkit-animation:_ngcontent-%COMP%_ball-scale-pulse 2s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-scale-pulse 2s ease-in-out infinite}.la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation-delay:-1s;animation-delay:-1s}.la-ball-scale-pulse.la-sm[_ngcontent-%COMP%], .la-ball-scale-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-pulse.la-2x[_ngcontent-%COMP%], .la-ball-scale-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-pulse.la-3x[_ngcontent-%COMP%], .la-ball-scale-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes _ngcontent-%COMP%_ball-scale-pulse{0%,to{transform:scale(0)}50%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-scale-pulse{0%,to{transform:scale(0)}50%{transform:scale(1)}}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%], .la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-scale-ripple-multiple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:32px;height:32px;background:transparent;border-width:2px;border-radius:100%;opacity:0;-webkit-animation:_ngcontent-%COMP%_ball-scale-ripple-multiple 1.25s cubic-bezier(.21,.53,.56,.8) 0s infinite;animation:_ngcontent-%COMP%_ball-scale-ripple-multiple 1.25s cubic-bezier(.21,.53,.56,.8) 0s infinite}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:0s;animation-delay:0s}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:.25s;animation-delay:.25s}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:.5s;animation-delay:.5s}.la-ball-scale-ripple-multiple.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-ripple-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-ball-scale-ripple-multiple.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-ripple-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-ball-scale-ripple-multiple.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-scale-ripple-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-scale-ripple-multiple{0%{opacity:1;transform:scale(.1)}70%{opacity:.5;transform:scale(1)}95%{opacity:0}}@keyframes _ngcontent-%COMP%_ball-scale-ripple-multiple{0%{opacity:1;transform:scale(.1)}70%{opacity:.5;transform:scale(1)}95%{opacity:0}}.la-ball-scale-ripple[_ngcontent-%COMP%], .la-ball-scale-ripple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-ripple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-scale-ripple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-ripple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-scale-ripple[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-scale-ripple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:32px;height:32px;background:transparent;border-width:2px;border-radius:100%;opacity:0;-webkit-animation:_ngcontent-%COMP%_ball-scale-ripple 1s cubic-bezier(.21,.53,.56,.8) 0s infinite;animation:_ngcontent-%COMP%_ball-scale-ripple 1s cubic-bezier(.21,.53,.56,.8) 0s infinite}.la-ball-scale-ripple.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-ripple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-ball-scale-ripple.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-ripple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-ball-scale-ripple.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-scale-ripple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-scale-ripple{0%{opacity:1;transform:scale(.1)}70%{opacity:.65;transform:scale(1)}to{opacity:0}}@keyframes _ngcontent-%COMP%_ball-scale-ripple{0%{opacity:1;transform:scale(.1)}70%{opacity:.65;transform:scale(1)}to{opacity:0}}.la-ball-scale[_ngcontent-%COMP%], .la-ball-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-scale.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-scale[_ngcontent-%COMP%], .la-ball-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-radius:100%;opacity:0;-webkit-animation:_ngcontent-%COMP%_ball-scale 1s ease-in-out 0s infinite;animation:_ngcontent-%COMP%_ball-scale 1s ease-in-out 0s infinite}.la-ball-scale.la-sm[_ngcontent-%COMP%], .la-ball-scale.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale.la-2x[_ngcontent-%COMP%], .la-ball-scale.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale.la-3x[_ngcontent-%COMP%], .la-ball-scale.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes _ngcontent-%COMP%_ball-scale{0%{opacity:1;transform:scale(0)}to{opacity:0;transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-scale{0%{opacity:1;transform:scale(0)}to{opacity:0;transform:scale(1)}}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%], .la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin-clockwise-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%]{width:32px;height:32px;-webkit-animation:_ngcontent-%COMP%_ball-spin-clockwise-fade-rotating-rotate 6s linear infinite;animation:_ngcontent-%COMP%_ball-spin-clockwise-fade-rotating-rotate 6s linear infinite}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin-clockwise-fade-rotating 1s linear infinite;animation:_ngcontent-%COMP%_ball-spin-clockwise-fade-rotating 1s linear infinite}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:5%;left:50%;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-clockwise-fade-rotating-rotate{to{transform:rotate(-1turn)}}@keyframes _ngcontent-%COMP%_ball-spin-clockwise-fade-rotating-rotate{to{transform:rotate(-1turn)}}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-clockwise-fade-rotating{50%{opacity:.25;transform:scale(.5)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-spin-clockwise-fade-rotating{50%{opacity:.25;transform:scale(.5)}to{opacity:1;transform:scale(1)}}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%], .la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin-clockwise-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin-clockwise-fade 1s linear infinite;animation:_ngcontent-%COMP%_ball-spin-clockwise-fade 1s linear infinite}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:5%;left:50%;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-spin-clockwise-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-clockwise-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-clockwise-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-clockwise-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-clockwise-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-clockwise-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-clockwise-fade{50%{opacity:.25;transform:scale(.5)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-spin-clockwise-fade{50%{opacity:.25;transform:scale(.5)}to{opacity:1;transform:scale(1)}}.la-ball-spin-clockwise[_ngcontent-%COMP%], .la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-clockwise[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin-clockwise.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin-clockwise[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin-clockwise 1s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-spin-clockwise 1s ease-in-out infinite}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:5%;left:50%;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-spin-clockwise.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-clockwise.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-clockwise.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-clockwise.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-clockwise.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-clockwise.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-clockwise{0%,to{opacity:1;transform:scale(1)}20%{opacity:1}80%{opacity:0;transform:scale(0)}}@keyframes _ngcontent-%COMP%_ball-spin-clockwise{0%,to{opacity:1;transform:scale(1)}20%{opacity:1}80%{opacity:0;transform:scale(0)}}.la-ball-spin-fade-rotating[_ngcontent-%COMP%], .la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin-fade-rotating[_ngcontent-%COMP%]{width:32px;height:32px;-webkit-animation:_ngcontent-%COMP%_ball-spin-fade-rotate 6s linear infinite;animation:_ngcontent-%COMP%_ball-spin-fade-rotate 6s linear infinite}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin-fade 1s linear infinite;animation:_ngcontent-%COMP%_ball-spin-fade 1s linear infinite}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:5%;left:50%;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-spin-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-fade-rotate{to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-spin-fade-rotate{to{transform:rotate(1turn)}}.la-ball-spin-fade[_ngcontent-%COMP%], .la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin-fade[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin-fade 1s linear infinite;animation:_ngcontent-%COMP%_ball-spin-fade 1s linear infinite}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:5%;left:50%;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-spin-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-fade{0%,to{opacity:1;transform:scale(1)}50%{opacity:.25;transform:scale(.5)}}@keyframes _ngcontent-%COMP%_ball-spin-fade{0%,to{opacity:1;transform:scale(1)}50%{opacity:.25;transform:scale(.5)}}.la-ball-spin-rotate[_ngcontent-%COMP%], .la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-rotate[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin-rotate.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin-rotate[_ngcontent-%COMP%]{width:32px;height:32px;-webkit-animation:_ngcontent-%COMP%_ball-spin-rotate 2s linear infinite;animation:_ngcontent-%COMP%_ball-spin-rotate 2s linear infinite}.la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;width:60%;height:60%;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin-bounce 2s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-spin-bounce 2s ease-in-out infinite}.la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{top:auto;bottom:0;-webkit-animation-delay:-1s;animation-delay:-1s}.la-ball-spin-rotate.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-rotate.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-rotate.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-rotate{to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-spin-rotate{to{transform:rotate(1turn)}}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-bounce{0%,to{transform:scale(0)}50%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-spin-bounce{0%,to{transform:scale(0)}50%{transform:scale(1)}}.la-ball-spin[_ngcontent-%COMP%], .la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-spin[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-spin 1s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-spin 1s ease-in-out infinite}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:5%;left:50%;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-spin.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin{0%,to{opacity:1;transform:scale(1)}20%{opacity:1}80%{opacity:0;transform:scale(0)}}@keyframes _ngcontent-%COMP%_ball-spin{0%,to{opacity:1;transform:scale(1)}20%{opacity:1}80%{opacity:0;transform:scale(0)}}.la-ball-square-clockwise-spin[_ngcontent-%COMP%], .la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-square-clockwise-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-square-clockwise-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-square-clockwise-spin[_ngcontent-%COMP%]{width:26px;height:26px}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:12px;height:12px;margin-top:-6px;margin-left:-6px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-square-clockwise-spin 1s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-square-clockwise-spin 1s ease-in-out infinite}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:0;left:0;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0;left:50%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:0;left:100%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:50%;left:100%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:100%;left:100%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:100%;left:50%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:100%;left:0;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:50%;left:0;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-square-clockwise-spin.la-sm[_ngcontent-%COMP%]{width:12px;height:12px}.la-ball-square-clockwise-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;margin-top:-3px;margin-left:-3px}.la-ball-square-clockwise-spin.la-2x[_ngcontent-%COMP%]{width:52px;height:52px}.la-ball-square-clockwise-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}.la-ball-square-clockwise-spin.la-3x[_ngcontent-%COMP%]{width:78px;height:78px}.la-ball-square-clockwise-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px;margin-top:-18px;margin-left:-18px}@-webkit-keyframes _ngcontent-%COMP%_ball-square-clockwise-spin{0%,40%,to{transform:scale(.4)}70%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-square-clockwise-spin{0%,40%,to{transform:scale(.4)}70%{transform:scale(1)}}.la-ball-square-spin[_ngcontent-%COMP%], .la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-square-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-square-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-square-spin[_ngcontent-%COMP%]{width:26px;height:26px}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:12px;height:12px;margin-top:-6px;margin-left:-6px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_ball-square-spin 1s ease-in-out infinite;animation:_ngcontent-%COMP%_ball-square-spin 1s ease-in-out infinite}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:0;left:0;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0;left:50%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:0;left:100%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:50%;left:100%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:100%;left:100%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:100%;left:50%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:100%;left:0;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:50%;left:0;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-square-spin.la-sm[_ngcontent-%COMP%]{width:12px;height:12px}.la-ball-square-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;margin-top:-3px;margin-left:-3px}.la-ball-square-spin.la-2x[_ngcontent-%COMP%]{width:52px;height:52px}.la-ball-square-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}.la-ball-square-spin.la-3x[_ngcontent-%COMP%]{width:78px;height:78px}.la-ball-square-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px;margin-top:-18px;margin-left:-18px}@-webkit-keyframes _ngcontent-%COMP%_ball-square-spin{0%,40%,to{transform:scale(.4)}70%{transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-square-spin{0%,40%,to{transform:scale(.4)}70%{transform:scale(1)}}.la-ball-triangle-path[_ngcontent-%COMP%], .la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-triangle-path[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-triangle-path.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-triangle-path[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:10px;height:10px;border-radius:100%}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation:_ngcontent-%COMP%_ball-triangle-path-ball-one 2s ease-in-out 0s infinite;animation:_ngcontent-%COMP%_ball-triangle-path-ball-one 2s ease-in-out 0s infinite}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation:_ngcontent-%COMP%_ball-triangle-path-ball-two 2s ease-in-out 0s infinite;animation:_ngcontent-%COMP%_ball-triangle-path-ball-two 2s ease-in-out 0s infinite}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation:_ngcontent-%COMP%_ball-triangle-path-ball-tree 2s ease-in-out 0s infinite;animation:_ngcontent-%COMP%_ball-triangle-path-ball-tree 2s ease-in-out 0s infinite}.la-ball-triangle-path.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-triangle-path.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-triangle-path.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-triangle-path.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-triangle-path.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-triangle-path.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes _ngcontent-%COMP%_ball-triangle-path-ball-one{0%{transform:translateY(220%)}17%{opacity:.25}33%{opacity:1;transform:translate(110%)}50%{opacity:.25}66%{opacity:1;transform:translate(220%,220%)}83%{opacity:.25}to{opacity:1;transform:translateY(220%)}}@keyframes _ngcontent-%COMP%_ball-triangle-path-ball-one{0%{transform:translateY(220%)}17%{opacity:.25}33%{opacity:1;transform:translate(110%)}50%{opacity:.25}66%{opacity:1;transform:translate(220%,220%)}83%{opacity:.25}to{opacity:1;transform:translateY(220%)}}@-webkit-keyframes _ngcontent-%COMP%_ball-triangle-path-ball-two{0%{transform:translate(110%)}17%{opacity:.25}33%{opacity:1;transform:translate(220%,220%)}50%{opacity:.25}66%{opacity:1;transform:translateY(220%)}83%{opacity:.25}to{opacity:1;transform:translate(110%)}}@keyframes _ngcontent-%COMP%_ball-triangle-path-ball-two{0%{transform:translate(110%)}17%{opacity:.25}33%{opacity:1;transform:translate(220%,220%)}50%{opacity:.25}66%{opacity:1;transform:translateY(220%)}83%{opacity:.25}to{opacity:1;transform:translate(110%)}}@-webkit-keyframes _ngcontent-%COMP%_ball-triangle-path-ball-tree{0%{transform:translate(220%,220%)}17%{opacity:.25}33%{opacity:1;transform:translateY(220%)}50%{opacity:.25}66%{opacity:1;transform:translate(110%)}83%{opacity:.25}to{opacity:1;transform:translate(220%,220%)}}@keyframes _ngcontent-%COMP%_ball-triangle-path-ball-tree{0%{transform:translate(220%,220%)}17%{opacity:.25}33%{opacity:1;transform:translateY(220%)}50%{opacity:.25}66%{opacity:1;transform:translate(110%)}83%{opacity:.25}to{opacity:1;transform:translate(220%,220%)}}.la-ball-zig-zag-deflect[_ngcontent-%COMP%], .la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-zig-zag-deflect[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-zig-zag-deflect.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-zig-zag-deflect[_ngcontent-%COMP%]{position:relative;width:32px;height:32px}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:10px;height:10px;margin-top:-5px;margin-left:-5px;border-radius:100%}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation:_ngcontent-%COMP%_ball-zig-deflect 1.5s linear 0s infinite;animation:_ngcontent-%COMP%_ball-zig-deflect 1.5s linear 0s infinite}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation:_ngcontent-%COMP%_ball-zag-deflect 1.5s linear 0s infinite;animation:_ngcontent-%COMP%_ball-zag-deflect 1.5s linear 0s infinite}.la-ball-zig-zag-deflect.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-zig-zag-deflect.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-zig-zag-deflect.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-zig-zag-deflect.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin-top:-10px;margin-left:-10px}.la-ball-zig-zag-deflect.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-zig-zag-deflect.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin-top:-15px;margin-left:-15px}@-webkit-keyframes _ngcontent-%COMP%_ball-zig-deflect{17%{transform:translate(-80%,-160%)}34%{transform:translate(80%,-160%)}50%{transform:translate(0)}67%{transform:translate(80%,-160%)}84%{transform:translate(-80%,-160%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_ball-zig-deflect{17%{transform:translate(-80%,-160%)}34%{transform:translate(80%,-160%)}50%{transform:translate(0)}67%{transform:translate(80%,-160%)}84%{transform:translate(-80%,-160%)}to{transform:translate(0)}}@-webkit-keyframes _ngcontent-%COMP%_ball-zag-deflect{17%{transform:translate(80%,160%)}34%{transform:translate(-80%,160%)}50%{transform:translate(0)}67%{transform:translate(-80%,160%)}84%{transform:translate(80%,160%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_ball-zag-deflect{17%{transform:translate(80%,160%)}34%{transform:translate(-80%,160%)}50%{transform:translate(0)}67%{transform:translate(-80%,160%)}84%{transform:translate(80%,160%)}to{transform:translate(0)}}.la-ball-zig-zag[_ngcontent-%COMP%], .la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-zig-zag[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-zig-zag.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-ball-zig-zag[_ngcontent-%COMP%]{position:relative;width:32px;height:32px}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:10px;height:10px;margin-top:-5px;margin-left:-5px;border-radius:100%}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation:_ngcontent-%COMP%_ball-zig-effect .7s linear 0s infinite;animation:_ngcontent-%COMP%_ball-zig-effect .7s linear 0s infinite}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation:_ngcontent-%COMP%_ball-zag-effect .7s linear 0s infinite;animation:_ngcontent-%COMP%_ball-zag-effect .7s linear 0s infinite}.la-ball-zig-zag.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-zig-zag.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-zig-zag.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-zig-zag.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin-top:-10px;margin-left:-10px}.la-ball-zig-zag.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-zig-zag.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin-top:-15px;margin-left:-15px}@-webkit-keyframes _ngcontent-%COMP%_ball-zig-effect{0%{transform:translate(0)}33%{transform:translate(-75%,-150%)}66%{transform:translate(75%,-150%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_ball-zig-effect{0%{transform:translate(0)}33%{transform:translate(-75%,-150%)}66%{transform:translate(75%,-150%)}to{transform:translate(0)}}@-webkit-keyframes _ngcontent-%COMP%_ball-zag-effect{0%{transform:translate(0)}33%{transform:translate(75%,150%)}66%{transform:translate(-75%,150%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_ball-zag-effect{0%{transform:translate(0)}33%{transform:translate(75%,150%)}66%{transform:translate(-75%,150%)}to{transform:translate(0)}}.la-cog[_ngcontent-%COMP%], .la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-cog[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-cog.la-dark[_ngcontent-%COMP%]{color:#333}.la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-cog[_ngcontent-%COMP%]{width:31px;height:31px}.la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%;background-color:transparent;border-style:dashed;border-width:2px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_cog-rotate 4s linear infinite;animation:_ngcontent-%COMP%_cog-rotate 4s linear infinite}.la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";border:2px solid;border-radius:100%}.la-cog.la-sm[_ngcontent-%COMP%]{width:15px;height:15px}.la-cog.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-cog.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{border-width:1px}.la-cog.la-2x[_ngcontent-%COMP%]{width:61px;height:61px}.la-cog.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-cog.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{border-width:4px}.la-cog.la-3x[_ngcontent-%COMP%]{width:91px;height:91px}.la-cog.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-cog.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{border-width:6px}@-webkit-keyframes _ngcontent-%COMP%_cog-rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_cog-rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.la-cube-transition[_ngcontent-%COMP%], .la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-cube-transition[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-cube-transition.la-dark[_ngcontent-%COMP%]{color:#333}.la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-cube-transition[_ngcontent-%COMP%]{width:32px;height:32px}.la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:14px;height:14px;margin-top:-7px;margin-left:-7px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_cube-transition 1.6s ease-in-out 0s infinite;animation:_ngcontent-%COMP%_cube-transition 1.6s ease-in-out 0s infinite}.la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation-delay:-.8s;animation-delay:-.8s}.la-cube-transition.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-cube-transition.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;margin-top:-3px;margin-left:-3px}.la-cube-transition.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-cube-transition.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:28px;height:28px;margin-top:-14px;margin-left:-14px}.la-cube-transition.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-cube-transition.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:42px;height:42px;margin-top:-21px;margin-left:-21px}@-webkit-keyframes _ngcontent-%COMP%_cube-transition{25%{top:0;left:100%;transform:scale(.5) rotate(-90deg)}50%{top:100%;left:100%;transform:scale(1) rotate(-180deg)}75%{top:100%;left:0;transform:scale(.5) rotate(-270deg)}to{top:0;left:0;transform:scale(1) rotate(-1turn)}}@keyframes _ngcontent-%COMP%_cube-transition{25%{top:0;left:100%;transform:scale(.5) rotate(-90deg)}50%{top:100%;left:100%;transform:scale(1) rotate(-180deg)}75%{top:100%;left:0;transform:scale(.5) rotate(-270deg)}to{top:0;left:0;transform:scale(1) rotate(-1turn)}}.la-fire[_ngcontent-%COMP%], .la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-fire[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-fire.la-dark[_ngcontent-%COMP%]{color:#333}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-fire[_ngcontent-%COMP%]{width:32px;height:32px}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;bottom:0;left:50%;width:12px;height:12px;border-radius:0;border-radius:2px;transform:translateY(0) translateX(-50%) rotate(45deg) scale(0);-webkit-animation:_ngcontent-%COMP%_fire-diamonds 1.5s linear infinite;animation:_ngcontent-%COMP%_fire-diamonds 1.5s linear infinite}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:-.85s;animation-delay:-.85s}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-1.85s;animation-delay:-1.85s}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-2.85s;animation-delay:-2.85s}.la-fire.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-fire.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px}.la-fire.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-fire.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px}.la-fire.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-fire.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px}@-webkit-keyframes _ngcontent-%COMP%_fire-diamonds{0%{transform:translateY(75%) translateX(-50%) rotate(45deg) scale(0)}50%{transform:translateY(-87.5%) translateX(-50%) rotate(45deg) scale(1)}to{transform:translateY(-212.5%) translateX(-50%) rotate(45deg) scale(0)}}@keyframes _ngcontent-%COMP%_fire-diamonds{0%{transform:translateY(75%) translateX(-50%) rotate(45deg) scale(0)}50%{transform:translateY(-87.5%) translateX(-50%) rotate(45deg) scale(1)}to{transform:translateY(-212.5%) translateX(-50%) rotate(45deg) scale(0)}}.la-line-scale-party[_ngcontent-%COMP%], .la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale-party[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-scale-party.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-scale-party[_ngcontent-%COMP%]{width:40px;height:32px}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation-name:_ngcontent-%COMP%_line-scale-party;animation-name:_ngcontent-%COMP%_line-scale-party;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-duration:.43s;animation-duration:.43s;-webkit-animation-delay:-.23s;animation-delay:-.23s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:.62s;animation-duration:.62s;-webkit-animation-delay:-.32s;animation-delay:-.32s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:.43s;animation-duration:.43s;-webkit-animation-delay:-.44s;animation-delay:-.44s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:.8s;animation-duration:.8s;-webkit-animation-delay:-.31s;animation-delay:-.31s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:.74s;animation-duration:.74s;-webkit-animation-delay:-.24s;animation-delay:-.24s}.la-line-scale-party.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale-party.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale-party.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale-party.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale-party.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale-party.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes _ngcontent-%COMP%_line-scale-party{0%{transform:scaleY(1)}50%{transform:scaleY(.3)}to{transform:scaleY(1)}}@keyframes _ngcontent-%COMP%_line-scale-party{0%{transform:scaleY(1)}50%{transform:scaleY(.3)}to{transform:scaleY(1)}}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%], .la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-scale-pulse-out-rapid.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%]{width:40px;height:32px}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-scale-pulse-out-rapid .9s cubic-bezier(.11,.49,.38,.78) infinite;animation:_ngcontent-%COMP%_line-scale-pulse-out-rapid .9s cubic-bezier(.11,.49,.38,.78) infinite}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.9s;animation-delay:-.9s}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2), .la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.65s;animation-delay:-.65s}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.4s;animation-delay:-.4s}.la-line-scale-pulse-out-rapid.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale-pulse-out-rapid.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale-pulse-out-rapid.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale-pulse-out-rapid.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale-pulse-out-rapid.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale-pulse-out-rapid.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes _ngcontent-%COMP%_line-scale-pulse-out-rapid{0%{transform:scaley(1)}80%{transform:scaley(.3)}90%{transform:scaley(1)}}@keyframes _ngcontent-%COMP%_line-scale-pulse-out-rapid{0%{transform:scaley(1)}80%{transform:scaley(.3)}90%{transform:scaley(1)}}.la-line-scale-pulse-out[_ngcontent-%COMP%], .la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale-pulse-out[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-scale-pulse-out.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-scale-pulse-out[_ngcontent-%COMP%]{width:40px;height:32px}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-scale-pulse-out .9s cubic-bezier(.85,.25,.37,.85) infinite;animation:_ngcontent-%COMP%_line-scale-pulse-out .9s cubic-bezier(.85,.25,.37,.85) infinite}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.9s;animation-delay:-.9s}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2), .la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.7s;animation-delay:-.7s}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-line-scale-pulse-out.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale-pulse-out.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale-pulse-out.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale-pulse-out.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale-pulse-out.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale-pulse-out.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes _ngcontent-%COMP%_line-scale-pulse-out{0%{transform:scaley(1)}50%{transform:scaley(.3)}to{transform:scaley(1)}}@keyframes _ngcontent-%COMP%_line-scale-pulse-out{0%{transform:scaley(1)}50%{transform:scaley(.3)}to{transform:scaley(1)}}.la-line-scale[_ngcontent-%COMP%], .la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-scale.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-scale[_ngcontent-%COMP%]{width:40px;height:32px}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-scale 1.2s ease infinite;animation:_ngcontent-%COMP%_line-scale 1.2s ease infinite}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation-delay:-1.2s;animation-delay:-1.2s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-1.1s;animation-delay:-1.1s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-1s;animation-delay:-1s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.9s;animation-delay:-.9s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.8s;animation-delay:-.8s}.la-line-scale.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes _ngcontent-%COMP%_line-scale{0%,40%,to{transform:scaleY(.4)}20%{transform:scaleY(1)}}@keyframes _ngcontent-%COMP%_line-scale{0%,40%,to{transform:scaleY(.4)}20%{transform:scaleY(1)}}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%], .la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-spin-clockwise-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%]{width:32px;height:32px;-webkit-animation:_ngcontent-%COMP%_line-spin-clockwise-fade-rotating-rotate 6s linear infinite;animation:_ngcontent-%COMP%_line-spin-clockwise-fade-rotating-rotate 6s linear infinite}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-spin-clockwise-fade-rotating 1s ease-in-out infinite;animation:_ngcontent-%COMP%_line-spin-clockwise-fade-rotating 1s ease-in-out infinite}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:15%;left:50%;transform:rotate(0deg);-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;transform:rotate(45deg);-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;transform:rotate(90deg);-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;transform:rotate(135deg);-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;transform:rotate(180deg);-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;transform:rotate(225deg);-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;transform:rotate(270deg);-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;transform:rotate(315deg);-webkit-animation-delay:0s;animation-delay:0s}.la-line-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes _ngcontent-%COMP%_line-spin-clockwise-fade-rotating-rotate{to{transform:rotate(-1turn)}}@keyframes _ngcontent-%COMP%_line-spin-clockwise-fade-rotating-rotate{to{transform:rotate(-1turn)}}@-webkit-keyframes _ngcontent-%COMP%_line-spin-clockwise-fade-rotating{50%{opacity:.2}to{opacity:1}}@keyframes _ngcontent-%COMP%_line-spin-clockwise-fade-rotating{50%{opacity:.2}to{opacity:1}}.la-line-spin-clockwise-fade[_ngcontent-%COMP%], .la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-clockwise-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-spin-clockwise-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-spin-clockwise-fade[_ngcontent-%COMP%]{width:32px;height:32px}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-spin-clockwise-fade 1s ease-in-out infinite;animation:_ngcontent-%COMP%_line-spin-clockwise-fade 1s ease-in-out infinite}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:15%;left:50%;transform:rotate(0deg);-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;transform:rotate(45deg);-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;transform:rotate(90deg);-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;transform:rotate(135deg);-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;transform:rotate(180deg);-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;transform:rotate(225deg);-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;transform:rotate(270deg);-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;transform:rotate(315deg);-webkit-animation-delay:0s;animation-delay:0s}.la-line-spin-clockwise-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-clockwise-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-clockwise-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-clockwise-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-clockwise-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-clockwise-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes _ngcontent-%COMP%_line-spin-clockwise-fade{50%{opacity:.2}to{opacity:1}}@keyframes _ngcontent-%COMP%_line-spin-clockwise-fade{50%{opacity:.2}to{opacity:1}}.la-line-spin-fade-rotating[_ngcontent-%COMP%], .la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-spin-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-spin-fade-rotating[_ngcontent-%COMP%]{width:32px;height:32px;-webkit-animation:_ngcontent-%COMP%_ball-spin-fade-rotating-rotate 6s linear infinite;animation:_ngcontent-%COMP%_ball-spin-fade-rotating-rotate 6s linear infinite}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-spin-fade-rotating 1s ease-in-out infinite;animation:_ngcontent-%COMP%_line-spin-fade-rotating 1s ease-in-out infinite}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:15%;left:50%;transform:rotate(0deg);-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;transform:rotate(45deg);-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;transform:rotate(90deg);-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;transform:rotate(135deg);-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;transform:rotate(180deg);-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;transform:rotate(225deg);-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;transform:rotate(270deg);-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;transform:rotate(315deg);-webkit-animation-delay:-2s;animation-delay:-2s}.la-line-spin-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes _ngcontent-%COMP%_ball-spin-fade-rotating-rotate{to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_ball-spin-fade-rotating-rotate{to{transform:rotate(1turn)}}@-webkit-keyframes _ngcontent-%COMP%_line-spin-fade-rotating{50%{opacity:.2}to{opacity:1}}@keyframes _ngcontent-%COMP%_line-spin-fade-rotating{50%{opacity:.2}to{opacity:1}}.la-line-spin-fade[_ngcontent-%COMP%], .la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-line-spin-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-line-spin-fade[_ngcontent-%COMP%]{width:32px;height:32px}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_line-spin-fade 1s ease-in-out infinite;animation:_ngcontent-%COMP%_line-spin-fade 1s ease-in-out infinite}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:15%;left:50%;transform:rotate(0deg);-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;transform:rotate(45deg);-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;transform:rotate(90deg);-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;transform:rotate(135deg);-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;transform:rotate(180deg);-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;transform:rotate(225deg);-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;transform:rotate(270deg);-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;transform:rotate(315deg);-webkit-animation-delay:-2s;animation-delay:-2s}.la-line-spin-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes _ngcontent-%COMP%_line-spin-fade{50%{opacity:.2}to{opacity:1}}@keyframes _ngcontent-%COMP%_line-spin-fade{50%{opacity:.2}to{opacity:1}}.la-pacman[_ngcontent-%COMP%], .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-pacman[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-pacman.la-dark[_ngcontent-%COMP%]{color:#333}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-pacman[_ngcontent-%COMP%]{width:32px;height:32px}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){width:0;height:0;background:transparent;border-style:solid;border-right:solid transparent;border-width:16px;border-radius:100%;-webkit-animation:_ngcontent-%COMP%_pacman-rotate-half-up .5s 0s infinite;animation:_ngcontent-%COMP%_pacman-rotate-half-up .5s 0s infinite;position:absolute}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-name:_ngcontent-%COMP%_pacman-rotate-half-down;animation-name:_ngcontent-%COMP%_pacman-rotate-half-down;top:0}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){position:absolute;top:50%;left:200%;width:8px;height:8px;border-radius:100%;opacity:0;-webkit-animation:_ngcontent-%COMP%_pacman-balls 2s linear 0s infinite;animation:_ngcontent-%COMP%_pacman-balls 2s linear 0s infinite}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-1.44s;animation-delay:-1.44s}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-1.94s;animation-delay:-1.94s}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-2.44s;animation-delay:-2.44s}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-delay:-2.94s;animation-delay:-2.94s}.la-pacman.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){border-width:8px;position:absolute}.la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0}.la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){width:4px;height:4px}.la-pacman.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){border-width:32px;position:absolute}.la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0}.la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){width:16px;height:16px}.la-pacman.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){border-width:48px;position:absolute}.la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0}.la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){width:24px;height:24px}@-webkit-keyframes _ngcontent-%COMP%_pacman-rotate-half-up{0%,to{transform:rotate(270deg)}50%{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_pacman-rotate-half-up{0%,to{transform:rotate(270deg)}50%{transform:rotate(1turn)}}@-webkit-keyframes _ngcontent-%COMP%_pacman-rotate-half-down{0%,to{transform:rotate(90deg)}50%{transform:rotate(0deg)}}@keyframes _ngcontent-%COMP%_pacman-rotate-half-down{0%,to{transform:rotate(90deg)}50%{transform:rotate(0deg)}}@-webkit-keyframes _ngcontent-%COMP%_pacman-balls{0%{left:200%;opacity:0;transform:translateY(-50%)}5%{opacity:.5}66%{opacity:1}67%{opacity:0}to{left:0;transform:translateY(-50%)}}@keyframes _ngcontent-%COMP%_pacman-balls{0%{left:200%;opacity:0;transform:translateY(-50%)}5%{opacity:.5}66%{opacity:1}67%{opacity:0}to{left:0;transform:translateY(-50%)}}.la-square-jelly-box[_ngcontent-%COMP%], .la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-square-jelly-box[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-square-jelly-box.la-dark[_ngcontent-%COMP%]{color:#333}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-square-jelly-box[_ngcontent-%COMP%]{width:32px;height:32px}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){position:absolute;left:0;width:100%}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{top:-25%;z-index:1;height:100%;border-radius:10%;-webkit-animation:_ngcontent-%COMP%_square-jelly-box-animate .6s linear -.1s infinite;animation:_ngcontent-%COMP%_square-jelly-box-animate .6s linear -.1s infinite}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){bottom:-9%;height:10%;background:#000;border-radius:50%;opacity:.2;-webkit-animation:_ngcontent-%COMP%_square-jelly-box-shadow .6s linear -.1s infinite;animation:_ngcontent-%COMP%_square-jelly-box-shadow .6s linear -.1s infinite}.la-square-jelly-box.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-square-jelly-box.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-square-jelly-box.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes _ngcontent-%COMP%_square-jelly-box-animate{17%{border-bottom-right-radius:10%}25%{transform:translateY(25%) rotate(22.5deg)}50%{border-bottom-right-radius:100%;transform:translateY(50%) scaleY(.9) rotate(45deg)}75%{transform:translateY(25%) rotate(67.5deg)}to{transform:translateY(0) rotate(90deg)}}@keyframes _ngcontent-%COMP%_square-jelly-box-animate{17%{border-bottom-right-radius:10%}25%{transform:translateY(25%) rotate(22.5deg)}50%{border-bottom-right-radius:100%;transform:translateY(50%) scaleY(.9) rotate(45deg)}75%{transform:translateY(25%) rotate(67.5deg)}to{transform:translateY(0) rotate(90deg)}}@-webkit-keyframes _ngcontent-%COMP%_square-jelly-box-shadow{50%{transform:scaleX(1.25)}}@keyframes _ngcontent-%COMP%_square-jelly-box-shadow{50%{transform:scaleX(1.25)}}.la-square-loader[_ngcontent-%COMP%], .la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-square-loader[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-square-loader.la-dark[_ngcontent-%COMP%]{color:#333}.la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-square-loader[_ngcontent-%COMP%]{width:32px;height:32px}.la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%;background:transparent;border-width:2px;border-radius:0;-webkit-animation:_ngcontent-%COMP%_square-loader 2s ease infinite;animation:_ngcontent-%COMP%_square-loader 2s ease infinite}.la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{display:inline-block;width:100%;vertical-align:top;content:"";background-color:currentColor;-webkit-animation:_ngcontent-%COMP%_square-loader-inner 2s ease-in infinite;animation:_ngcontent-%COMP%_square-loader-inner 2s ease-in infinite}.la-square-loader.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-square-loader.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:1px}.la-square-loader.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-square-loader.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:4px}.la-square-loader.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-square-loader.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:6px}@-webkit-keyframes _ngcontent-%COMP%_square-loader{0%{transform:rotate(0deg)}25%{transform:rotate(180deg)}50%{transform:rotate(180deg)}75%{transform:rotate(1turn)}to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_square-loader{0%{transform:rotate(0deg)}25%{transform:rotate(180deg)}50%{transform:rotate(180deg)}75%{transform:rotate(1turn)}to{transform:rotate(1turn)}}@-webkit-keyframes _ngcontent-%COMP%_square-loader-inner{0%{height:0}25%{height:0}50%{height:100%}75%{height:100%}to{height:0}}@keyframes _ngcontent-%COMP%_square-loader-inner{0%{height:0}25%{height:0}50%{height:100%}75%{height:100%}to{height:0}}.la-square-spin[_ngcontent-%COMP%], .la-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-square-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-square-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-square-spin[_ngcontent-%COMP%]{width:32px;height:32px}.la-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:0;-webkit-animation:_ngcontent-%COMP%_square-spin 3s cubic-bezier(.09,.57,.49,.9) 0s infinite;animation:_ngcontent-%COMP%_square-spin 3s cubic-bezier(.09,.57,.49,.9) 0s infinite}.la-square-spin.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-square-spin.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-square-spin.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes _ngcontent-%COMP%_square-spin{0%{transform:perspective(100px) rotateX(0) rotateY(0)}25%{transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{transform:perspective(100px) rotateX(0) rotateY(180deg)}to{transform:perspective(100px) rotateX(0) rotateY(1turn)}}@keyframes _ngcontent-%COMP%_square-spin{0%{transform:perspective(100px) rotateX(0) rotateY(0)}25%{transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{transform:perspective(100px) rotateX(0) rotateY(180deg)}to{transform:perspective(100px) rotateX(0) rotateY(1turn)}}.la-timer[_ngcontent-%COMP%], .la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-timer[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-timer.la-dark[_ngcontent-%COMP%]{color:#333}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-timer[_ngcontent-%COMP%], .la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:32px;height:32px}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background:transparent;border-width:2px;border-radius:100%}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{position:absolute;top:14px;left:14px;display:block;width:2px;margin-top:-1px;margin-left:-1px;content:"";background:currentColor;border-radius:2px;transform-origin:1px 1px 0;-webkit-animation:_ngcontent-%COMP%_timer-loader 1.25s linear infinite;animation:_ngcontent-%COMP%_timer-loader 1.25s linear infinite;-webkit-animation-delay:-625ms;animation-delay:-625ms}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:12px}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:8px;-webkit-animation-duration:15s;animation-duration:15s;-webkit-animation-delay:-7.5s;animation-delay:-7.5s}.la-timer.la-sm[_ngcontent-%COMP%], .la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:1px}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:7px;left:7px;width:1px;margin-top:-.5px;margin-left:-.5px;border-radius:1px;transform-origin:.5px .5px 0}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:6px}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:4px}.la-timer.la-2x[_ngcontent-%COMP%], .la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:4px}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:28px;left:28px;width:4px;margin-top:-2px;margin-left:-2px;border-radius:4px;transform-origin:2px 2px 0}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:24px}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:16px}.la-timer.la-3x[_ngcontent-%COMP%], .la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:6px}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:42px;left:42px;width:6px;margin-top:-3px;margin-left:-3px;border-radius:6px;transform-origin:3px 3px 0}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:36px}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:24px}@-webkit-keyframes _ngcontent-%COMP%_timer-loader{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes _ngcontent-%COMP%_timer-loader{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.la-triangle-skew-spin[_ngcontent-%COMP%], .la-triangle-skew-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-triangle-skew-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-triangle-skew-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-triangle-skew-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid}.la-triangle-skew-spin[_ngcontent-%COMP%]{width:32px;height:16px}.la-triangle-skew-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:0;height:0;background:transparent;border-left:none;border-right:none;border-color:currentcolor transparent;border-style:solid;border-width:0 16px 16px;-webkit-animation:_ngcontent-%COMP%_triangle-skew-spin 3s cubic-bezier(.09,.57,.49,.9) 0s infinite;animation:_ngcontent-%COMP%_triangle-skew-spin 3s cubic-bezier(.09,.57,.49,.9) 0s infinite}.la-triangle-skew-spin.la-sm[_ngcontent-%COMP%]{width:16px;height:8px}.la-triangle-skew-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:0 8px 8px}.la-triangle-skew-spin.la-2x[_ngcontent-%COMP%]{width:64px;height:32px}.la-triangle-skew-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:0 32px 32px}.la-triangle-skew-spin.la-3x[_ngcontent-%COMP%]{width:96px;height:48px}.la-triangle-skew-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:0 48px 48px}@-webkit-keyframes _ngcontent-%COMP%_triangle-skew-spin{0%{transform:perspective(100px) rotateX(0) rotateY(0)}25%{transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{transform:perspective(100px) rotateX(0) rotateY(180deg)}to{transform:perspective(100px) rotateX(0) rotateY(1turn)}}@keyframes _ngcontent-%COMP%_triangle-skew-spin{0%{transform:perspective(100px) rotateX(0) rotateY(0)}25%{transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{transform:perspective(100px) rotateX(0) rotateY(180deg)}to{transform:perspective(100px) rotateX(0) rotateY(1turn)}}.ngx-spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%}.ngx-spinner-overlay[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.loading-text){top:50%;left:50%;margin:0;position:absolute;transform:translate(-50%,-50%)}.loading-text[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;transform:translate(-50%,-60%)}'],data:{animation:[(0,Y.X$)("fadeIn",[(0,Y.SB)("in",(0,Y.oB)({opacity:1})),(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)(300)]),(0,Y.eR)(":leave",(0,Y.jt)(200,(0,Y.oB)({opacity:0})))])]},changeDetection:0}),i})(),Ot=(()=>{class i{constructor(t){this._sanitizer=t}transform(t){if(t)return this._sanitizer.bypassSecurityTrustHtml(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Je.H7,16))},i.\u0275pipe=e.Yjl({name:"safeHtml",type:i,pure:!0}),i})(),yn=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[T.ez]}),i})();var Zt=v(75832),ci=v(70655);function Ji(){}function Tn(i){return null==i?Ji:function(){return this.querySelector(i)}}function xr(){return[]}function ui(i){return null==i?xr:function(){return this.querySelectorAll(i)}}function Hi(i){return function(){return this.matches(i)}}function xs(i){return new Array(i.length)}function Sl(i,n){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=n}function oc(i,n,t,o,a,l){for(var C,_=0,N=n.length,F=l.length;_<F;++_)(C=n[_])?(C.__data__=l[_],o[_]=C):t[_]=new Sl(i,l[_]);for(;_<N;++_)(C=n[_])&&(a[_]=C)}function ll(i,n,t,o,a,l,_){var C,N,Te,F={},V=n.length,ue=l.length,ce=new Array(V);for(C=0;C<V;++C)(N=n[C])&&(ce[C]=Te="$"+_.call(N,N.__data__,C,n),Te in F?a[C]=N:F[Te]=N);for(C=0;C<ue;++C)(N=F[Te="$"+_.call(i,l[C],C,l)])?(o[C]=N,N.__data__=l[C],F[Te]=null):t[C]=new Sl(i,l[C]);for(C=0;C<V;++C)(N=n[C])&&F[ce[C]]===N&&(a[C]=N)}function fu(i,n){return i<n?-1:i>n?1:i>=n?0:NaN}Sl.prototype={constructor:Sl,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,n){return this._parent.insertBefore(i,n)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};var qa="http://www.w3.org/1999/xhtml";const Cs={svg:"http://www.w3.org/2000/svg",xhtml:qa,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ja(i){var n=i+="",t=n.indexOf(":");return t>=0&&"xmlns"!==(n=i.slice(0,t))&&(i=i.slice(t+1)),Cs.hasOwnProperty(n)?{space:Cs[n],local:i}:i}function ws(i){return function(){this.removeAttribute(i)}}function gu(i){return function(){this.removeAttributeNS(i.space,i.local)}}function Ec(i,n){return function(){this.setAttribute(i,n)}}function Li(i,n){return function(){this.setAttributeNS(i.space,i.local,n)}}function Js(i,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(i):this.setAttribute(i,t)}}function sa(i,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,t)}}function ul(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function ss(i){return function(){this.style.removeProperty(i)}}function _u(i,n,t){return function(){this.style.setProperty(i,n,t)}}function ja(i,n,t){return function(){var o=n.apply(this,arguments);null==o?this.style.removeProperty(i):this.style.setProperty(i,o,t)}}function Gr(i,n){return i.style.getPropertyValue(n)||ul(i).getComputedStyle(i,null).getPropertyValue(n)}function Ac(i){return function(){delete this[i]}}function mu(i,n){return function(){this[i]=n}}function kc(i,n){return function(){var t=n.apply(this,arguments);null==t?delete this[i]:this[i]=t}}function ac(i){return i.trim().split(/^|\s+/)}function ca(i){return i.classList||new Vr(i)}function Vr(i){this._node=i,this._names=ac(i.getAttribute("class")||"")}function Ic(i,n){for(var t=ca(i),o=-1,a=n.length;++o<a;)t.add(n[o])}function Yr(i,n){for(var t=ca(i),o=-1,a=n.length;++o<a;)t.remove(n[o])}function Vi(i){return function(){Ic(this,i)}}function Ba(i){return function(){Yr(this,i)}}function yu(i,n){return function(){(n.apply(this,arguments)?Ic:Yr)(this,i)}}function El(){this.textContent=""}function Zc(i){return function(){this.textContent=i}}function Nc(i){return function(){var n=i.apply(this,arguments);this.textContent=n??""}}function js(){this.innerHTML=""}function ls(i){return function(){this.innerHTML=i}}function kl(i){return function(){var n=i.apply(this,arguments);this.innerHTML=n??""}}function Ke(){this.nextSibling&&this.parentNode.appendChild(this)}function en(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function io(i){return function(){var n=this.ownerDocument,t=this.namespaceURI;return t===qa&&n.documentElement.namespaceURI===qa?n.createElement(i):n.createElementNS(t,i)}}function bi(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function uo(i){var n=Ja(i);return(n.local?bi:io)(n)}function Cr(){return null}function Ao(){var i=this.parentNode;i&&i.removeChild(this)}function cs(){var i=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(i,this.nextSibling):i}function $o(){var i=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(i,this.nextSibling):i}Vr.prototype={add:function(i){this._names.indexOf(i)<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var n=this._names.indexOf(i);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};var dl={},wr=null;function sc(i,n,t){return i=lc(i,n,t),function(o){var a=o.relatedTarget;(!a||a!==this&&!(8&a.compareDocumentPosition(this)))&&i.call(this,o)}}function lc(i,n,t){return function(o){var a=wr;wr=o;try{i.call(this,this.__data__,n,t)}finally{wr=a}}}function Zl(i){return i.trim().split(/^|\s+/).map(function(n){var t="",o=n.indexOf(".");return o>=0&&(t=n.slice(o+1),n=n.slice(0,o)),{type:n,name:t}})}function Qi(i){return function(){var n=this.__on;if(n){for(var l,t=0,o=-1,a=n.length;t<a;++t)l=n[t],i.type&&l.type!==i.type||l.name!==i.name?n[++o]=l:this.removeEventListener(l.type,l.listener,l.capture);++o?n.length=o:delete this.__on}}}function Si(i,n,t){var o=dl.hasOwnProperty(i.type)?sc:lc;return function(a,l,_){var N,C=this.__on,F=o(n,l,_);if(C)for(var V=0,ue=C.length;V<ue;++V)if((N=C[V]).type===i.type&&N.name===i.name)return this.removeEventListener(N.type,N.listener,N.capture),this.addEventListener(N.type,N.listener=F,N.capture=t),void(N.value=n);this.addEventListener(i.type,F,t),N={type:i.type,name:i.name,value:n,listener:F,capture:t},C?C.push(N):this.__on=[N]}}function Va(i,n,t){var o=ul(i),a=o.CustomEvent;"function"==typeof a?a=new a(n,t):(a=o.document.createEvent("Event"),t?(a.initEvent(n,t.bubbles,t.cancelable),a.detail=t.detail):a.initEvent(n,!1,!1)),i.dispatchEvent(a)}function Go(i,n){return function(){return Va(this,i,n)}}function Wn(i,n){return function(){return Va(this,i,n.apply(this,arguments))}}typeof document<"u"&&("onmouseenter"in document.documentElement||(dl={mouseenter:"mouseover",mouseleave:"mouseout"}));var Wo=[null];function zo(i,n){this._groups=i,this._parents=n}function ua(){return new zo([[document.documentElement]],Wo)}zo.prototype=ua.prototype={constructor:zo,select:function Br(i){"function"!=typeof i&&(i=Tn(i));for(var n=this._groups,t=n.length,o=new Array(t),a=0;a<t;++a)for(var N,F,l=n[a],_=l.length,C=o[a]=new Array(_),V=0;V<_;++V)(N=l[V])&&(F=i.call(N,N.__data__,V,l))&&("__data__"in N&&(F.__data__=N.__data__),C[V]=F);return new zo(o,this._parents)},selectAll:function Ir(i){"function"!=typeof i&&(i=ui(i));for(var n=this._groups,t=n.length,o=[],a=[],l=0;l<t;++l)for(var N,_=n[l],C=_.length,F=0;F<C;++F)(N=_[F])&&(o.push(i.call(N,N.__data__,F,_)),a.push(N));return new zo(o,a)},filter:function co(i){"function"!=typeof i&&(i=Hi(i));for(var n=this._groups,t=n.length,o=new Array(t),a=0;a<t;++a)for(var N,l=n[a],_=l.length,C=o[a]=[],F=0;F<_;++F)(N=l[F])&&i.call(N,N.__data__,F,l)&&C.push(N);return new zo(o,this._parents)},data:function rc(i,n){if(!i)return Te=new Array(this.size()),F=-1,this.each(function(Dn){Te[++F]=Dn}),Te;var t=n?ll:oc,o=this._parents,a=this._groups;"function"!=typeof i&&(i=function du(i){return function(){return i}}(i));for(var l=a.length,_=new Array(l),C=new Array(l),N=new Array(l),F=0;F<l;++F){var V=o[F],ue=a[F],ce=ue.length,Te=i.call(V,V&&V.__data__,F,o),We=Te.length,it=C[F]=new Array(We),He=_[F]=new Array(We);t(V,ue,it,He,N[F]=new Array(ce),Te,n);for(var vt,Vt,xt=0,bt=0;xt<We;++xt)if(vt=it[xt]){for(xt>=bt&&(bt=xt+1);!(Vt=He[bt])&&++bt<We;);vt._next=Vt||null}}return(_=new zo(_,o))._enter=C,_._exit=N,_},enter:function Oa(){return new zo(this._enter||this._groups.map(xs),this._parents)},exit:function Pc(){return new zo(this._exit||this._groups.map(xs),this._parents)},join:function hu(i,n,t){var o=this.enter(),a=this,l=this.exit();return o="function"==typeof i?i(o):o.append(i+""),null!=n&&(a=n(a)),null==t?l.remove():t(l),o&&a?o.merge(a).order():a},merge:function Us(i){for(var n=this._groups,t=i._groups,o=n.length,l=Math.min(o,t.length),_=new Array(o),C=0;C<l;++C)for(var ce,N=n[C],F=t[C],V=N.length,ue=_[C]=new Array(V),Te=0;Te<V;++Te)(ce=N[Te]||F[Te])&&(ue[Te]=ce);for(;C<o;++C)_[C]=n[C];return new zo(_,this._parents)},order:function cl(){for(var i=this._groups,n=-1,t=i.length;++n<t;)for(var _,o=i[n],a=o.length-1,l=o[a];--a>=0;)(_=o[a])&&(l&&4^_.compareDocumentPosition(l)&&l.parentNode.insertBefore(_,l),l=_);return this},sort:function Pl(i){function n(ue,ce){return ue&&ce?i(ue.__data__,ce.__data__):!ue-!ce}i||(i=fu);for(var t=this._groups,o=t.length,a=new Array(o),l=0;l<o;++l){for(var F,_=t[l],C=_.length,N=a[l]=new Array(C),V=0;V<C;++V)(F=_[V])&&(N[V]=F);N.sort(n)}return new zo(a,this._parents).order()},call:function Lo(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this},nodes:function qs(){var i=new Array(this.size()),n=-1;return this.each(function(){i[++n]=this}),i},node:function Fa(){for(var i=this._groups,n=0,t=i.length;n<t;++n)for(var o=i[n],a=0,l=o.length;a<l;++a){var _=o[a];if(_)return _}return null},size:function Ua(){var i=0;return this.each(function(){++i}),i},empty:function as(){return!this.node()},each:function Sa(i){for(var n=this._groups,t=0,o=n.length;t<o;++t)for(var C,a=n[t],l=0,_=a.length;l<_;++l)(C=a[l])&&i.call(C,C.__data__,l,a);return this},attr:function Ts(i,n){var t=Ja(i);if(arguments.length<2){var o=this.node();return t.local?o.getAttributeNS(t.space,t.local):o.getAttribute(t)}return this.each((null==n?t.local?gu:ws:"function"==typeof n?t.local?sa:Js:t.local?Li:Ec)(t,n))},style:function la(i,n,t){return arguments.length>1?this.each((null==n?ss:"function"==typeof n?ja:_u)(i,n,t??"")):Gr(this.node(),i)},property:function Ms(i,n){return arguments.length>1?this.each((null==n?Ac:"function"==typeof n?kc:mu)(i,n)):this.node()[i]},classed:function pl(i,n){var t=ac(i+"");if(arguments.length<2){for(var o=ca(this.node()),a=-1,l=t.length;++a<l;)if(!o.contains(t[a]))return!1;return!0}return this.each(("function"==typeof n?yu:n?Vi:Ba)(t,n))},text:function Al(i){return arguments.length?this.each(null==i?El:("function"==typeof i?Nc:Zc)(i)):this.node().textContent},html:function Il(i){return arguments.length?this.each(null==i?js:("function"==typeof i?kl:ls)(i)):this.node().innerHTML},raise:function Ct(){return this.each(Ke)},lower:function xn(){return this.each(en)},append:function oo(i){var n="function"==typeof i?i:uo(i);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function xo(i,n){var t="function"==typeof i?i:uo(i),o=null==n?Cr:"function"==typeof n?n:Tn(n);return this.select(function(){return this.insertBefore(t.apply(this,arguments),o.apply(this,arguments)||null)})},remove:function Hr(){return this.each(Ao)},clone:function Pa(i){return this.select(i?$o:cs)},datum:function Bs(i){return arguments.length?this.property("__data__",i):this.node().__data__},on:function ji(i,n,t){var a,_,o=Zl(i+""),l=o.length;if(!(arguments.length<2)){for(C=n?Si:Qi,null==t&&(t=!1),a=0;a<l;++a)this.each(C(o[a],n,t));return this}var C=this.node().__on;if(C)for(var V,N=0,F=C.length;N<F;++N)for(a=0,V=C[N];a<l;++a)if((_=o[a]).type===V.type&&_.name===V.name)return V.value},dispatch:function Ti(i,n){return this.each(("function"==typeof n?Wn:Go)(i,n))}};const hr=ua;function Lc(i){return"string"==typeof i?new zo([[document.querySelector(i)]],[document.documentElement]):new zo([[i]],Wo)}function Nl(i,n,t){i._context.bezierCurveTo((2*i._x0+i._x1)/3,(2*i._y0+i._y1)/3,(i._x0+2*i._x1)/3,(i._y0+2*i._y1)/3,(i._x0+4*i._x1+n)/6,(i._y0+4*i._y1+t)/6)}function Ya(i){this._context=i}function Qr(i,n){this._basis=new Ya(i),this._beta=n}Ya.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Nl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,n){switch(i=+i,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,n):this._context.moveTo(i,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Nl(this,i,n)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=n}},Qr.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var i=this._x,n=this._y,t=i.length-1;if(t>0)for(var N,o=i[0],a=n[0],l=i[t]-o,_=n[t]-a,C=-1;++C<=t;)this._basis.point(this._beta*i[C]+(1-this._beta)*(o+(N=C/t)*l),this._beta*n[C]+(1-this._beta)*(a+N*_));this._x=this._y=null,this._basis.lineEnd()},point:function(i,n){this._x.push(+i),this._y.push(+n)}};const Co=function i(n){function t(o){return 1===n?new Ya(o):new Qr(o,n)}return t.beta=function(o){return i(+o)},t}(.85);var Ha=Math.PI,Ys=2*Ha,ro=1e-6,cn=Ys-ro;function Zr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function zc(){return new Zr}Zr.prototype=zc.prototype={constructor:Zr,moveTo:function(i,n){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(i,n){this._+="L"+(this._x1=+i)+","+(this._y1=+n)},quadraticCurveTo:function(i,n,t,o){this._+="Q"+ +i+","+ +n+","+(this._x1=+t)+","+(this._y1=+o)},bezierCurveTo:function(i,n,t,o,a,l){this._+="C"+ +i+","+ +n+","+ +t+","+ +o+","+(this._x1=+a)+","+(this._y1=+l)},arcTo:function(i,n,t,o,a){var l=this._x1,_=this._y1,C=(t=+t)-(i=+i),N=(o=+o)-(n=+n),F=l-i,V=_-n,ue=F*F+V*V;if((a=+a)<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=i)+","+(this._y1=n);else if(ue>ro)if(Math.abs(V*C-N*F)>ro&&a){var ce=t-l,Te=o-_,We=C*C+N*N,it=ce*ce+Te*Te,He=Math.sqrt(We),et=Math.sqrt(ue),xt=a*Math.tan((Ha-Math.acos((We+ue-it)/(2*He*et)))/2),bt=xt/et,vt=xt/He;Math.abs(bt-1)>ro&&(this._+="L"+(i+bt*F)+","+(n+bt*V)),this._+="A"+a+","+a+",0,0,"+ +(V*ce>F*Te)+","+(this._x1=i+vt*C)+","+(this._y1=n+vt*N)}else this._+="L"+(this._x1=i)+","+(this._y1=n)},arc:function(i,n,t,o,a,l){i=+i,n=+n,l=!!l;var _=(t=+t)*Math.cos(o),C=t*Math.sin(o),N=i+_,F=n+C,V=1^l,ue=l?o-a:a-o;if(t<0)throw new Error("negative radius: "+t);null===this._x1?this._+="M"+N+","+F:(Math.abs(this._x1-N)>ro||Math.abs(this._y1-F)>ro)&&(this._+="L"+N+","+F),t&&(ue<0&&(ue=ue%Ys+Ys),ue>cn?this._+="A"+t+","+t+",0,1,"+V+","+(i-_)+","+(n-C)+"A"+t+","+t+",0,1,"+V+","+(this._x1=N)+","+(this._y1=F):ue>ro&&(this._+="A"+t+","+t+",0,"+ +(ue>=Ha)+","+V+","+(this._x1=i+t*Math.cos(a))+","+(this._y1=n+t*Math.sin(a))))},rect:function(i,n,t,o){this._+="M"+(this._x0=this._x1=+i)+","+(this._y0=this._y1=+n)+"h"+ +t+"v"+ +o+"h"+-t+"Z"},toString:function(){return this._}};const cc=zc;function pa(i){return function(){return i}}function Kr(i){this._context=i}function op(i){return new Kr(i)}function Ht(i){return i[0]}function rp(i){return i[1]}Kr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,n){switch(i=+i,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,n):this._context.moveTo(i,n);break;case 1:this._point=2;default:this._context.lineTo(i,n)}}};var bu=Math.PI;function Dc(i){return(1-Math.cos(bu*i))/2}var da={value:function(){}};function Os(){for(var o,i=0,n=arguments.length,t={};i<n;++i){if(!(o=arguments[i]+"")||o in t||/[\s.]/.test(o))throw new Error("illegal type: "+o);t[o]=[]}return new Rc(t)}function Rc(i){this._=i}function Fc(i,n){return i.trim().split(/^|\s+/).map(function(t){var o="",a=t.indexOf(".");if(a>=0&&(o=t.slice(a+1),t=t.slice(0,a)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:o}})}function sp(i,n){for(var a,t=0,o=i.length;t<o;++t)if((a=i[t]).name===n)return a.value}function xu(i,n,t){for(var o=0,a=i.length;o<a;++o)if(i[o].name===n){i[o]=da,i=i.slice(0,o).concat(i.slice(o+1));break}return null!=t&&i.push({name:n,value:t}),i}Rc.prototype=Os.prototype={constructor:Rc,on:function(i,n){var a,t=this._,o=Fc(i+"",t),l=-1,_=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++l<_;)if(a=(i=o[l]).type)t[a]=xu(t[a],i.name,n);else if(null==n)for(a in t)t[a]=xu(t[a],i.name,null);return this}for(;++l<_;)if((a=(i=o[l]).type)&&(a=sp(t[a],i.name)))return a},copy:function(){var i={},n=this._;for(var t in n)i[t]=n[t].slice();return new Rc(i)},call:function(i,n){if((a=arguments.length-2)>0)for(var a,l,t=new Array(a),o=0;o<a;++o)t[o]=arguments[o+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(o=0,a=(l=this._[i]).length;o<a;++o)l[o].value.apply(n,t)},apply:function(i,n,t){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var o=this._[i],a=0,l=o.length;a<l;++a)o[a].value.apply(n,t)}};const ka=Os;var Vo,us,fr=0,oi=0,ha=0,ps=0,Tr=0,ir=0,Hs="object"==typeof performance&&performance.now?performance:Date,Cn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function un(){return Tr||(Cn(Cu),Tr=Hs.now()+ir)}function Cu(){Tr=0}function Xo(){this._call=this._time=this._next=null}function fa(i,n,t){var o=new Xo;return o.restart(i,n,t),o}function or(){un(),++fr;for(var n,i=Vo;i;)(n=Tr-i._time)>=0&&i._call.call(null,n),i=i._next;--fr}function ds(){Tr=(ps=Hs.now())+ir,fr=oi=0;try{or()}finally{fr=0,function wu(){for(var i,t,n=Vo,o=1/0;n;)n._call?(o>n._time&&(o=n._time),i=n,n=n._next):(t=n._next,n._next=null,n=i?i._next=t:Vo=t);us=i,ki(o)}(),Tr=0}}function lp(){var i=Hs.now(),n=i-ps;n>1e3&&(ir-=n,ps=i)}function ki(i){fr||(oi&&(oi=clearTimeout(oi)),i-Tr>24?(i<1/0&&(oi=setTimeout(ds,i-Hs.now()-ir)),ha&&(ha=clearInterval(ha))):(ha||(ps=Hs.now(),ha=setInterval(lp,1e3)),fr=1,Cn(ds)))}function Yo(i,n,t){var o=new Xo;return o.restart(function(a){o.stop(),i(a+n)},n=null==n?0:+n,t),o}Xo.prototype=fa.prototype={constructor:Xo,restart:function(i,n,t){if("function"!=typeof i)throw new TypeError("callback is not a function");t=(null==t?un():+t)+(null==n?0:+n),!this._next&&us!==this&&(us?us._next=this:Vo=this,us=this),this._call=i,this._time=t,ki()},stop:function(){this._call&&(this._call=null,this._time=1/0,ki())}};var Jp=ka("start","end","cancel","interrupt"),Ll=[];function hl(i,n,t,o,a,l){var _=i.__transition;if(_){if(t in _)return}else i.__transition={};!function cp(i,n,t){var a,o=i.__transition;function _(F){var V,ue,ce,Te;if(1!==t.state)return N();for(V in o)if((Te=o[V]).name===t.name){if(3===Te.state)return Yo(_);4===Te.state?(Te.state=6,Te.timer.stop(),Te.on.call("interrupt",i,i.__data__,Te.index,Te.group),delete o[V]):+V<n&&(Te.state=6,Te.timer.stop(),Te.on.call("cancel",i,i.__data__,Te.index,Te.group),delete o[V])}if(Yo(function(){3===t.state&&(t.state=4,t.timer.restart(C,t.delay,t.time),C(F))}),t.state=2,t.on.call("start",i,i.__data__,t.index,t.group),2===t.state){for(t.state=3,a=new Array(ce=t.tween.length),V=0,ue=-1;V<ce;++V)(Te=t.tween[V].value.call(i,i.__data__,t.index,t.group))&&(a[++ue]=Te);a.length=ue+1}}function C(F){for(var V=F<t.duration?t.ease.call(null,F/t.duration):(t.timer.restart(N),t.state=5,1),ue=-1,ce=a.length;++ue<ce;)a[ue].call(i,V);5===t.state&&(t.on.call("end",i,i.__data__,t.index,t.group),N())}function N(){for(var F in t.state=6,t.timer.stop(),delete o[n],o)return;delete i.__transition}o[n]=t,t.timer=fa(function l(F){t.state=1,t.timer.restart(_,t.delay,t.time),t.delay<=F&&_(F-t.delay)},0,t.time)}(i,t,{name:n,index:o,group:a,on:Jp,tween:Ll,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:0})}function Uc(i,n){var t=Mr(i,n);if(t.state>0)throw new Error("too late; already scheduled");return t}function $r(i,n){var t=Mr(i,n);if(t.state>3)throw new Error("too late; already running");return t}function Mr(i,n){var t=i.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function Qa(i,n){return i=+i,n=+n,function(t){return i*(1-t)+n*t}}var _l,$s=180/Math.PI,ga={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Mu(i,n,t,o,a,l){var _,C,N;return(_=Math.sqrt(i*i+n*n))&&(i/=_,n/=_),(N=i*t+n*o)&&(t-=i*N,o-=n*N),(C=Math.sqrt(t*t+o*o))&&(t/=C,o/=C,N/=C),i*o<n*t&&(i=-i,n=-n,N=-N,_=-_),{translateX:a,translateY:l,rotate:Math.atan2(n,i)*$s,skewX:Math.atan(N)*$s,scaleX:_,scaleY:C}}function u(i,n,t,o){function a(F){return F.length?F.pop()+" ":""}return function(F,V){var ue=[],ce=[];return F=i(F),V=i(V),function l(F,V,ue,ce,Te,We){if(F!==ue||V!==ce){var it=Te.push("translate(",null,n,null,t);We.push({i:it-4,x:Qa(F,ue)},{i:it-2,x:Qa(V,ce)})}else(ue||ce)&&Te.push("translate("+ue+n+ce+t)}(F.translateX,F.translateY,V.translateX,V.translateY,ue,ce),function _(F,V,ue,ce){F!==V?(F-V>180?V+=360:V-F>180&&(F+=360),ce.push({i:ue.push(a(ue)+"rotate(",null,o)-2,x:Qa(F,V)})):V&&ue.push(a(ue)+"rotate("+V+o)}(F.rotate,V.rotate,ue,ce),function C(F,V,ue,ce){F!==V?ce.push({i:ue.push(a(ue)+"skewX(",null,o)-2,x:Qa(F,V)}):V&&ue.push(a(ue)+"skewX("+V+o)}(F.skewX,V.skewX,ue,ce),function N(F,V,ue,ce,Te,We){if(F!==ue||V!==ce){var it=Te.push(a(Te)+"scale(",null,",",null,")");We.push({i:it-4,x:Qa(F,ue)},{i:it-2,x:Qa(V,ce)})}else(1!==ue||1!==ce)&&Te.push(a(Te)+"scale("+ue+","+ce+")")}(F.scaleX,F.scaleY,V.scaleX,V.scaleY,ue,ce),F=V=null,function(Te){for(var He,We=-1,it=ce.length;++We<it;)ue[(He=ce[We]).i]=He.x(Te);return ue.join("")}}}var h=u(function up(i){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(i+"");return n.isIdentity?ga:Mu(n.a,n.b,n.c,n.d,n.e,n.f)},"px, ","px)","deg)"),p=u(function Ou(i){return null!=i&&(_l||(_l=document.createElementNS("http://www.w3.org/2000/svg","g")),_l.setAttribute("transform",i),i=_l.transform.baseVal.consolidate())?Mu((i=i.matrix).a,i.b,i.c,i.d,i.e,i.f):ga},", ",")",")");function g(i,n){var t,o;return function(){var a=$r(this,i),l=a.tween;if(l!==t)for(var _=0,C=(o=t=l).length;_<C;++_)if(o[_].name===n){(o=o.slice()).splice(_,1);break}a.tween=o}}function x(i,n,t){var o,a;if("function"!=typeof t)throw new Error;return function(){var l=$r(this,i),_=l.tween;if(_!==o){a=(o=_).slice();for(var C={name:n,value:t},N=0,F=a.length;N<F;++N)if(a[N].name===n){a[N]=C;break}N===F&&a.push(C)}l.tween=a}}function L(i,n,t){var o=i._id;return i.each(function(){var a=$r(this,o);(a.value||(a.value={}))[n]=t.apply(this,arguments)}),function(a){return Mr(a,o).value[n]}}function J(i,n,t){i.prototype=n.prototype=t,t.constructor=i}function K(i,n){var t=Object.create(i.prototype);for(var o in n)t[o]=n[o];return t}function ne(){}var ve=1/.7,be="\\s*([+-]?\\d+)\\s*",Ee="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Oe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Re=/^#([0-9a-f]{3,8})$/,Se=new RegExp("^rgb\\("+[be,be,be]+"\\)$"),De=new RegExp("^rgb\\("+[Oe,Oe,Oe]+"\\)$"),Be=new RegExp("^rgba\\("+[be,be,be,Ee]+"\\)$"),Xe=new RegExp("^rgba\\("+[Oe,Oe,Oe,Ee]+"\\)$"),_t=new RegExp("^hsl\\("+[Ee,Oe,Oe]+"\\)$"),ct=new RegExp("^hsla\\("+[Ee,Oe,Oe,Ee]+"\\)$"),yt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function St(){return this.rgb().formatHex()}function Rt(){return this.rgb().formatRgb()}function Kt(i){var n,t;return i=(i+"").trim().toLowerCase(),(n=Re.exec(i))?(t=n[1].length,n=parseInt(n[1],16),6===t?wn(n):3===t?new Gt(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===t?Mn(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===t?Mn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Se.exec(i))?new Gt(n[1],n[2],n[3],1):(n=De.exec(i))?new Gt(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Be.exec(i))?Mn(n[1],n[2],n[3],n[4]):(n=Xe.exec(i))?Mn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=_t.exec(i))?Un(n[1],n[2]/100,n[3]/100,1):(n=ct.exec(i))?Un(n[1],n[2]/100,n[3]/100,n[4]):yt.hasOwnProperty(i)?wn(yt[i]):"transparent"===i?new Gt(NaN,NaN,NaN,0):null}function wn(i){return new Gt(i>>16&255,i>>8&255,255&i,1)}function Mn(i,n,t,o){return o<=0&&(i=n=t=NaN),new Gt(i,n,t,o)}function En(i){return i instanceof ne||(i=Kt(i)),i?new Gt((i=i.rgb()).r,i.g,i.b,i.opacity):new Gt}function _i(i,n,t,o){return 1===arguments.length?En(i):new Gt(i,n,t,o??1)}function Gt(i,n,t,o){this.r=+i,this.g=+n,this.b=+t,this.opacity=+o}function jn(){return"#"+Fn(this.r)+Fn(this.g)+Fn(this.b)}function ti(){var i=this.opacity;return(1===(i=isNaN(i)?1:Math.max(0,Math.min(1,i)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===i?")":", "+i+")")}function Fn(i){return((i=Math.max(0,Math.min(255,Math.round(i)||0)))<16?"0":"")+i.toString(16)}function Un(i,n,t,o){return o<=0?i=n=t=NaN:t<=0||t>=1?i=n=NaN:n<=0&&(i=NaN),new bn(i,n,t,o)}function Xn(i){if(i instanceof bn)return new bn(i.h,i.s,i.l,i.opacity);if(i instanceof ne||(i=Kt(i)),!i)return new bn;if(i instanceof bn)return i;var n=(i=i.rgb()).r/255,t=i.g/255,o=i.b/255,a=Math.min(n,t,o),l=Math.max(n,t,o),_=NaN,C=l-a,N=(l+a)/2;return C?(_=n===l?(t-o)/C+6*(t<o):t===l?(o-n)/C+2:(n-t)/C+4,C/=N<.5?l+a:2-l-a,_*=60):C=N>0&&N<1?0:_,new bn(_,C,N,i.opacity)}function bn(i,n,t,o){this.h=+i,this.s=+n,this.l=+t,this.opacity=+o}function Do(i,n,t){return 255*(i<60?n+(t-n)*i/60:i<180?t:i<240?n+(t-n)*(240-i)/60:n)}function yo(i,n,t,o,a){var l=i*i,_=l*i;return((1-3*i+3*l-_)*n+(4-6*l+3*_)*t+(1+3*i+3*l-3*_)*o+_*a)/6}J(ne,Kt,{copy:function(i){return Object.assign(new this.constructor,this,i)},displayable:function(){return this.rgb().displayable()},hex:St,formatHex:St,formatHsl:function Ut(){return Xn(this).formatHsl()},formatRgb:Rt,toString:Rt}),J(Gt,_i,K(ne,{brighter:function(i){return i=null==i?ve:Math.pow(ve,i),new Gt(this.r*i,this.g*i,this.b*i,this.opacity)},darker:function(i){return i=null==i?.7:Math.pow(.7,i),new Gt(this.r*i,this.g*i,this.b*i,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:jn,formatHex:jn,formatRgb:ti,toString:ti})),J(bn,function qn(i,n,t,o){return 1===arguments.length?Xn(i):new bn(i,n,t,o??1)},K(ne,{brighter:function(i){return i=null==i?ve:Math.pow(ve,i),new bn(this.h,this.s,this.l*i,this.opacity)},darker:function(i){return i=null==i?.7:Math.pow(.7,i),new bn(this.h,this.s,this.l*i,this.opacity)},rgb:function(){var i=this.h%360+360*(this.h<0),n=isNaN(i)||isNaN(this.s)?0:this.s,t=this.l,o=t+(t<.5?t:1-t)*n,a=2*t-o;return new Gt(Do(i>=240?i-240:i+120,a,o),Do(i,a,o),Do(i<120?i+240:i-120,a,o),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var i=this.opacity;return(1===(i=isNaN(i)?1:Math.max(0,Math.min(1,i)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===i?")":", "+i+")")}}));const po=i=>()=>i;function Lr(i,n){var t=n-i;return t?function wo(i,n){return function(t){return i+t*n}}(i,t):po(isNaN(i)?n:i)}const ma=function i(n){var t=function ml(i){return 1==(i=+i)?Lr:function(n,t){return t-n?function _a(i,n,t){return i=Math.pow(i,t),n=Math.pow(n,t)-i,t=1/t,function(o){return Math.pow(i+o*n,t)}}(n,t,i):po(isNaN(n)?t:n)}}(n);function o(a,l){var _=t((a=_i(a)).r,(l=_i(l)).r),C=t(a.g,l.g),N=t(a.b,l.b),F=Lr(a.opacity,l.opacity);return function(V){return a.r=_(V),a.g=C(V),a.b=N(V),a.opacity=F(V),a+""}}return o.gamma=i,o}(1);function Za(i){return function(n){var _,C,t=n.length,o=new Array(t),a=new Array(t),l=new Array(t);for(_=0;_<t;++_)C=_i(n[_]),o[_]=C.r||0,a[_]=C.g||0,l[_]=C.b||0;return o=i(o),a=i(a),l=i(l),C.opacity=1,function(N){return C.r=o(N),C.g=a(N),C.b=l(N),C+""}}}Za(function Or(i){var n=i.length-1;return function(t){var o=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),a=i[o],l=i[o+1];return yo((t-o/n)*n,o>0?i[o-1]:2*a-l,a,l,o<n-1?i[o+2]:2*l-a)}}),Za(function rr(i){var n=i.length;return function(t){var o=Math.floor(((t%=1)<0?++t:t)*n);return yo((t-o/n)*n,i[(o+n-1)%n],i[o%n],i[(o+1)%n],i[(o+2)%n])}});var Ps=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yl=new RegExp(Ps.source,"g");function pc(i,n){var o,a,l,t=Ps.lastIndex=yl.lastIndex=0,_=-1,C=[],N=[];for(i+="",n+="";(o=Ps.exec(i))&&(a=yl.exec(n));)(l=a.index)>t&&(l=n.slice(t,l),C[_]?C[_]+=l:C[++_]=l),(o=o[0])===(a=a[0])?C[_]?C[_]+=a:C[++_]=a:(C[++_]=null,N.push({i:_,x:Qa(o,a)})),t=yl.lastIndex;return t<n.length&&(l=n.slice(t),C[_]?C[_]+=l:C[++_]=l),C.length<2?N[0]?function Es(i){return function(n){return i(n)+""}}(N[0].x):function Jc(i){return function(){return i}}(n):(n=N.length,function(F){for(var ue,V=0;V<n;++V)C[(ue=N[V]).i]=ue.x(F);return C.join("")})}function fs(i,n){var t;return("number"==typeof n?Qa:n instanceof Kt?ma:(t=Kt(n))?(n=t,ma):pc)(i,n)}function er(i){return function(){this.removeAttribute(i)}}function Ws(i){return function(){this.removeAttributeNS(i.space,i.local)}}function vl(i,n,t){var o,l,a=t+"";return function(){var _=this.getAttribute(i);return _===a?null:_===o?l:l=n(o=_,t)}}function zl(i,n,t){var o,l,a=t+"";return function(){var _=this.getAttributeNS(i.space,i.local);return _===a?null:_===o?l:l=n(o=_,t)}}function Ii(i,n,t){var o,a,l;return function(){var _,N,C=t(this);return null==C?void this.removeAttribute(i):(_=this.getAttribute(i))===(N=C+"")?null:_===o&&N===a?l:(a=N,l=n(o=_,C))}}function Na(i,n,t){var o,a,l;return function(){var _,N,C=t(this);return null==C?void this.removeAttributeNS(i.space,i.local):(_=this.getAttributeNS(i.space,i.local))===(N=C+"")?null:_===o&&N===a?l:(a=N,l=n(o=_,C))}}function Dl(i,n){return function(t){this.setAttribute(i,n.call(this,t))}}function Gd(i,n){return function(t){this.setAttributeNS(i.space,i.local,n.call(this,t))}}function Pu(i,n){var t,o;function a(){var l=n.apply(this,arguments);return l!==o&&(t=(o=l)&&Gd(i,l)),t}return a._value=n,a}function Vd(i,n){var t,o;function a(){var l=n.apply(this,arguments);return l!==o&&(t=(o=l)&&Dl(i,l)),t}return a._value=n,a}function jp(i,n){return function(){Uc(this,i).delay=+n.apply(this,arguments)}}function dc(i,n){return n=+n,function(){Uc(this,i).delay=n}}function Yd(i,n){return function(){$r(this,i).duration=+n.apply(this,arguments)}}function Bc(i,n){return n=+n,function(){$r(this,i).duration=n}}function c_(i,n){if("function"!=typeof n)throw new Error;return function(){$r(this,i).ease=n}}function f_(i,n,t){var o,a,l=function Hd(i){return(i+"").trim().split(/^|\s+/).every(function(n){var t=n.indexOf(".");return t>=0&&(n=n.slice(0,t)),!n||"start"===n})}(n)?Uc:$r;return function(){var _=l(this,i),C=_.on;C!==o&&(a=(o=C).copy()).on(n,t),_.on=a}}var __=hr.prototype.constructor;function Ff(i){return function(){this.style.removeProperty(i)}}function Au(i,n,t){return function(o){this.style.setProperty(i,n.call(this,o),t)}}function C_(i,n,t){var o,a;function l(){var _=n.apply(this,arguments);return _!==a&&(o=(a=_)&&Au(i,_,t)),o}return l._value=n,l}function Yp(i){return function(n){this.textContent=i.call(this,n)}}function dp(i){var n,t;function o(){var a=i.apply(this,arguments);return a!==t&&(n=(t=a)&&Yp(a)),n}return o._value=i,o}var Kd=0;function Xs(i,n,t,o){this._groups=i,this._parents=n,this._name=t,this._id=o}function ku(){return++Kd}var Rl=hr.prototype;Xs.prototype=function w_(i){return hr().transition(i)}.prototype={constructor:Xs,select:function pp(i){var n=this._name,t=this._id;"function"!=typeof i&&(i=Tn(i));for(var o=this._groups,a=o.length,l=new Array(a),_=0;_<a;++_)for(var V,ue,C=o[_],N=C.length,F=l[_]=new Array(N),ce=0;ce<N;++ce)(V=C[ce])&&(ue=i.call(V,V.__data__,ce,C))&&("__data__"in V&&(ue.__data__=V.__data__),F[ce]=ue,hl(F[ce],n,t,ce,F,Mr(V,t)));return new Xs(l,this._parents,n,t)},selectAll:function g_(i){var n=this._name,t=this._id;"function"!=typeof i&&(i=ui(i));for(var o=this._groups,a=o.length,l=[],_=[],C=0;C<a;++C)for(var V,N=o[C],F=N.length,ue=0;ue<F;++ue)if(V=N[ue]){for(var Te,ce=i.call(V,V.__data__,ue,N),We=Mr(V,t),it=0,He=ce.length;it<He;++it)(Te=ce[it])&&hl(Te,n,t,it,ce,We);l.push(ce),_.push(V)}return new Xs(l,_,n,t)},selectChild:Rl.selectChild,selectChildren:Rl.selectChildren,filter:function d_(i){"function"!=typeof i&&(i=Hi(i));for(var n=this._groups,t=n.length,o=new Array(t),a=0;a<t;++a)for(var N,l=n[a],_=l.length,C=o[a]=[],F=0;F<_;++F)(N=l[F])&&i.call(N,N.__data__,F,l)&&C.push(N);return new Xs(o,this._parents,this._name,this._id)},merge:function h_(i){if(i._id!==this._id)throw new Error;for(var n=this._groups,t=i._groups,o=n.length,l=Math.min(o,t.length),_=new Array(o),C=0;C<l;++C)for(var ce,N=n[C],F=t[C],V=N.length,ue=_[C]=new Array(V),Te=0;Te<V;++Te)(ce=N[Te]||F[Te])&&(ue[Te]=ce);for(;C<o;++C)_[C]=n[C];return new Xs(_,this._parents,this._name,this._id)},selection:function m_(){return new __(this._groups,this._parents)},transition:function Jf(){for(var i=this._name,n=this._id,t=ku(),o=this._groups,a=o.length,l=0;l<a;++l)for(var N,_=o[l],C=_.length,F=0;F<C;++F)if(N=_[F]){var V=Mr(N,n);hl(N,i,t,F,_,{time:V.time+V.delay+V.duration,delay:0,duration:V.duration,ease:V.ease})}return new Xs(o,this._parents,i,t)},call:Rl.call,nodes:Rl.nodes,node:Rl.node,size:Rl.size,empty:Rl.empty,each:Rl.each,on:function Bp(i,n){var t=this._id;return arguments.length<2?Mr(this.node(),t).on.on(i):this.each(f_(t,i,n))},attr:function Xr(i,n){var t=Ja(i),o="transform"===t?p:fs;return this.attrTween(i,"function"==typeof n?(t.local?Na:Ii)(t,o,L(this,"attr."+i,n)):null==n?(t.local?Ws:er)(t):(t.local?zl:vl)(t,o,n))},attrTween:function jc(i,n){var t="attr."+i;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==n)return this.tween(t,null);if("function"!=typeof n)throw new Error;var o=Ja(i);return this.tween(t,(o.local?Pu:Vd)(o,n))},style:function x_(i,n,t){var o="transform"==(i+="")?h:fs;return null==n?this.styleTween(i,function y_(i,n){var t,o,a;return function(){var l=Gr(this,i),_=(this.style.removeProperty(i),Gr(this,i));return l===_?null:l===t&&_===o?a:a=n(t=l,o=_)}}(i,o)).on("end.style."+i,Ff(i)):"function"==typeof n?this.styleTween(i,function b_(i,n,t){var o,a,l;return function(){var _=Gr(this,i),C=t(this),N=C+"";return null==C&&(this.style.removeProperty(i),N=C=Gr(this,i)),_===N?null:_===o&&N===a?l:(a=N,l=n(o=_,C))}}(i,o,L(this,"style."+i,n))).each(function Qd(i,n){var t,o,a,C,l="style."+n,_="end."+l;return function(){var N=$r(this,i),F=N.on,V=null==N.value[l]?C||(C=Ff(n)):void 0;(F!==t||a!==V)&&(o=(t=F).copy()).on(_,a=V),N.on=o}}(this._id,i)):this.styleTween(i,function v_(i,n,t){var o,l,a=t+"";return function(){var _=Gr(this,i);return _===a?null:_===o?l:l=n(o=_,t)}}(i,o,n),t).on("end.style."+i,null)},styleTween:function Ho(i,n,t){var o="style."+(i+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==n)return this.tween(o,null);if("function"!=typeof n)throw new Error;return this.tween(o,C_(i,n,t??""))},text:function Vp(i){return this.tween("text","function"==typeof i?function Uf(i){return function(){var n=i(this);this.textContent=n??""}}(L(this,"text",i)):function Gp(i){return function(){this.textContent=i}}(null==i?"":i+""))},textTween:function qf(i){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==i)return this.tween(n,null);if("function"!=typeof i)throw new Error;return this.tween(n,dp(i))},remove:function hc(){return this.on("end.remove",function Rf(i){return function(){var n=this.parentNode;for(var t in this.__transition)if(+t!==i)return;n&&n.removeChild(this)}}(this._id))},tween:function k(i,n){var t=this._id;if(i+="",arguments.length<2){for(var _,o=Mr(this.node(),t).tween,a=0,l=o.length;a<l;++a)if((_=o[a]).name===i)return _.value;return null}return this.each((null==n?g:x)(t,i,n))},delay:function Eu(i){var n=this._id;return arguments.length?this.each(("function"==typeof i?jp:dc)(n,i)):Mr(this.node(),n).delay},duration:function ya(i){var n=this._id;return arguments.length?this.each(("function"==typeof i?Yd:Bc)(n,i)):Mr(this.node(),n).duration},ease:function Df(i){var n=this._id;return arguments.length?this.each(c_(n,i)):Mr(this.node(),n).ease},easeVarying:function p_(i){if("function"!=typeof i)throw new Error;return this.each(function u_(i,n){return function(){var t=n.apply(this,arguments);if("function"!=typeof t)throw new Error;$r(this,i).ease=t}}(this._id,i))},end:function hp(){var i,n,t=this,o=t._id,a=t.size();return new Promise(function(l,_){var C={value:_},N={value:function(){0==--a&&l()}};t.each(function(){var F=$r(this,o),V=F.on;V!==i&&((n=(i=V).copy())._.cancel.push(C),n._.interrupt.push(C),n._.end.push(N)),F.on=n}),0===a&&l()})},[Symbol.iterator]:Rl[Symbol.iterator]};var Wd={time:null,delay:0,duration:250,ease:function $d(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}};function el(i,n){for(var t;!(t=i.__transition)||!(t=t[n]);)if(!(i=i.parentNode))throw new Error(`transition ${n} not found`);return t}hr.prototype.interrupt=function gl(i){return this.each(function(){!function fl(i,n){var o,a,_,t=i.__transition,l=!0;if(t){for(_ in n=null==n?null:n+"",t)(o=t[_]).name===n?(a=o.state>2&&o.state<5,o.state=6,o.timer.stop(),o.on.call(a?"interrupt":"cancel",i,i.__data__,o.index,o.group),delete t[_]):l=!1;l&&delete i.__transition}}(this,i)})},hr.prototype.transition=function T_(i){var n,t;i instanceof Xs?(n=i._id,i=i._name):(n=ku(),(t=Wd).time=un(),i=null==i?null:i+"");for(var o=this._groups,a=o.length,l=0;l<a;++l)for(var N,_=o[l],C=_.length,F=0;F<C;++F)(N=_[F])&&hl(N,i,n,F,_,t||el(N,n));return new Xs(o,this._parents,i,n)};var Bf=v(39646),Gf=v(54968),M_=v(50590),Xd=v(78372);function fp(i){return typeof i>"u"}function I_(i){if(Array.isArray(i)){for(var n=0,t=Array(i.length);n<i.length;n++)t[n]=i[n];return t}return Array.from(i)}function Z_(i){return Array.isArray(i)?i:Array.from(i)}function gp(){for(var i=arguments.length,n=Array(i),t=0;t<i;t++)n[t]=arguments[t];var o=function(ue,ce){return{a:ue.a*ce.a+ue.c*ce.b,c:ue.a*ce.c+ue.c*ce.d,e:ue.a*ce.e+ue.c*ce.f+ue.e,b:ue.b*ce.a+ue.d*ce.b,d:ue.b*ce.c+ue.d*ce.d,f:ue.b*ce.e+ue.d*ce.f+ue.f}};switch((n=Array.isArray(n[0])?n[0]:n).length){case 0:throw new Error("no matrices provided");case 1:return n[0];case 2:return o(n[0],n[1]);default:var a=n,l=Z_(a),_=l[0],C=l[1],N=l.slice(2),F=o(_,C);return gp.apply(void 0,[F].concat(I_(N)))}}function zr(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{a:1,c:0,e:i,b:0,d:1,f:n}}function $f(i,n){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(n).domain(i)}return this}"function"==typeof Symbol&&Symbol,Math,Math,Math,Math;const Wf=Symbol("implicit");function eh(){var i=new Map,n=[],t=[],o=Wf;function a(l){var _=l+"",C=i.get(_);if(!C){if(o!==Wf)return o;i.set(_,C=n.push(l))}return t[(C-1)%t.length]}return a.domain=function(l){if(!arguments.length)return n.slice();n=[],i=new Map;for(const _ of l){const C=_+"";i.has(C)||i.set(C,n.push(_))}return a},a.range=function(l){return arguments.length?(t=Array.from(l),a):t.slice()},a.unknown=function(l){return arguments.length?(o=l,a):o},a.copy=function(){return eh(n,t).unknown(o)},$f.apply(a,arguments),a}var fc=v(59695);function D_(i,n){var t;function o(){var a,_,l=t.length,C=0,N=0;for(a=0;a<l;++a)C+=(_=t[a]).x,N+=_.y;for(C=C/l-i,N=N/l-n,a=0;a<l;++a)(_=t[a]).x-=C,_.y-=N}return null==i&&(i=0),null==n&&(n=0),o.initialize=function(a){t=a},o.x=function(a){return arguments.length?(i=+a,o):i},o.y=function(a){return arguments.length?(n=+a,o):n},o}function Sr(i){return function(){return i}}function Fl(){return 1e-6*(Math.random()-.5)}function Xf(i,n,t,o){if(isNaN(n)||isNaN(t))return i;var a,ue,ce,Te,We,it,He,et,xt,l=i._root,_={data:o},C=i._x0,N=i._y0,F=i._x1,V=i._y1;if(!l)return i._root=_,i;for(;l.length;)if((it=n>=(ue=(C+F)/2))?C=ue:F=ue,(He=t>=(ce=(N+V)/2))?N=ce:V=ce,a=l,!(l=l[et=He<<1|it]))return a[et]=_,i;if(Te=+i._x.call(null,l.data),We=+i._y.call(null,l.data),n===Te&&t===We)return _.next=l,a?a[et]=_:i._root=_,i;do{a=a?a[et]=new Array(4):i._root=new Array(4),(it=n>=(ue=(C+F)/2))?C=ue:F=ue,(He=t>=(ce=(N+V)/2))?N=ce:V=ce}while((et=He<<1|it)==(xt=(We>=ce)<<1|Te>=ue));return a[xt]=l,a[et]=_,i}function pi(i,n,t,o,a){this.node=i,this.x0=n,this.y0=t,this.x1=o,this.y1=a}function J_(i){return i[0]}function B_(i){return i[1]}function th(i,n,t){var o=new nh(n??J_,t??B_,NaN,NaN,NaN,NaN);return null==i?o:o.addAll(i)}function nh(i,n,t,o,a,l){this._x=i,this._y=n,this._x0=t,this._y0=o,this._x1=a,this._y1=l,this._root=void 0}function mp(i){for(var n={data:i.data},t=n;i=i.next;)t=t.next={data:i.data};return n}var gr=th.prototype=nh.prototype;function og(i){return i.x+i.vx}function V_(i){return i.y+i.vy}function rg(i){var n,t,o=1,a=1;function l(){for(var N,V,ue,ce,Te,We,it,F=n.length,He=0;He<a;++He)for(V=th(n,og,V_).visitAfter(_),N=0;N<F;++N)it=(We=t[(ue=n[N]).index])*We,ce=ue.x+ue.vx,Te=ue.y+ue.vy,V.visit(et);function et(xt,bt,vt,Vt,Dn){var ei=xt.data,Yn=xt.r,Hn=We+Yn;if(!ei)return bt>ce+Hn||Vt<ce-Hn||vt>Te+Hn||Dn<Te-Hn;if(ei.index>ue.index){var Rn=ce-ei.x-ei.vx,hi=Te-ei.y-ei.vy,qo=Rn*Rn+hi*hi;qo<Hn*Hn&&(0===Rn&&(qo+=(Rn=Fl())*Rn),0===hi&&(qo+=(hi=Fl())*hi),qo=(Hn-(qo=Math.sqrt(qo)))/qo*o,ue.vx+=(Rn*=qo)*(Hn=(Yn*=Yn)/(it+Yn)),ue.vy+=(hi*=qo)*Hn,ei.vx-=Rn*(Hn=1-Hn),ei.vy-=hi*Hn)}}}function _(N){if(N.data)return N.r=t[N.data.index];for(var F=N.r=0;F<4;++F)N[F]&&N[F].r>N.r&&(N.r=N[F].r)}function C(){if(n){var N,V,F=n.length;for(t=new Array(F),N=0;N<F;++N)t[(V=n[N]).index]=+i(V,N,n)}}return"function"!=typeof i&&(i=Sr(null==i?1:+i)),l.initialize=function(N){n=N,C()},l.iterations=function(N){return arguments.length?(a=+N,l):a},l.strength=function(N){return arguments.length?(o=+N,l):o},l.radius=function(N){return arguments.length?(i="function"==typeof N?N:Sr(+N),C(),l):i},l}gr.copy=function(){var t,o,i=new nh(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return i;if(!n.length)return i._root=mp(n),i;for(t=[{source:n,target:i._root=new Array(4)}];n=t.pop();)for(var a=0;a<4;++a)(o=n.source[a])&&(o.length?t.push({source:o,target:n.target[a]=new Array(4)}):n.target[a]=mp(o));return i},gr.add=function R_(i){var n=+this._x.call(null,i),t=+this._y.call(null,i);return Xf(this.cover(n,t),n,t,i)},gr.addAll=function _p(i){var n,t,a,l,o=i.length,_=new Array(o),C=new Array(o),N=1/0,F=1/0,V=-1/0,ue=-1/0;for(t=0;t<o;++t)isNaN(a=+this._x.call(null,n=i[t]))||isNaN(l=+this._y.call(null,n))||(_[t]=a,C[t]=l,a<N&&(N=a),a>V&&(V=a),l<F&&(F=l),l>ue&&(ue=l));if(N>V||F>ue)return this;for(this.cover(N,F).cover(V,ue),t=0;t<o;++t)Xf(this,_[t],C[t],i[t]);return this},gr.cover=function eg(i,n){if(isNaN(i=+i)||isNaN(n=+n))return this;var t=this._x0,o=this._y0,a=this._x1,l=this._y1;if(isNaN(t))a=(t=Math.floor(i))+1,l=(o=Math.floor(n))+1;else{for(var N,F,_=a-t,C=this._root;t>i||i>=a||o>n||n>=l;)switch(F=(n<o)<<1|i<t,N=new Array(4),N[F]=C,C=N,_*=2,F){case 0:a=t+_,l=o+_;break;case 1:t=a-_,l=o+_;break;case 2:a=t+_,o=l-_;break;case 3:t=a-_,o=l-_}this._root&&this._root.length&&(this._root=C)}return this._x0=t,this._y0=o,this._x1=a,this._y1=l,this},gr.data=function tg(){var i=[];return this.visit(function(n){if(!n.length)do{i.push(n.data)}while(n=n.next)}),i},gr.extent=function Qp(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},gr.find=function ng(i,n,t){var o,_,C,N,F,We,it,a=this._x0,l=this._y0,V=this._x1,ue=this._y1,ce=[],Te=this._root;for(Te&&ce.push(new pi(Te,a,l,V,ue)),null==t?t=1/0:(a=i-t,l=n-t,V=i+t,ue=n+t,t*=t);We=ce.pop();)if(!(!(Te=We.node)||(_=We.x0)>V||(C=We.y0)>ue||(N=We.x1)<a||(F=We.y1)<l))if(Te.length){var He=(_+N)/2,et=(C+F)/2;ce.push(new pi(Te[3],He,et,N,F),new pi(Te[2],_,et,He,F),new pi(Te[1],He,C,N,et),new pi(Te[0],_,C,He,et)),(it=(n>=et)<<1|i>=He)&&(We=ce[ce.length-1],ce[ce.length-1]=ce[ce.length-1-it],ce[ce.length-1-it]=We)}else{var xt=i-+this._x.call(null,Te.data),bt=n-+this._y.call(null,Te.data),vt=xt*xt+bt*bt;if(vt<t){var Vt=Math.sqrt(t=vt);a=i-Vt,l=n-Vt,V=i+Vt,ue=n+Vt,o=Te.data}}return o},gr.remove=function Ul(i){if(isNaN(V=+this._x.call(null,i))||isNaN(ue=+this._y.call(null,i)))return this;var n,o,a,l,V,ue,ce,Te,We,it,He,et,t=this._root,_=this._x0,C=this._y0,N=this._x1,F=this._y1;if(!t)return this;if(t.length)for(;;){if((We=V>=(ce=(_+N)/2))?_=ce:N=ce,(it=ue>=(Te=(C+F)/2))?C=Te:F=Te,n=t,!(t=t[He=it<<1|We]))return this;if(!t.length)break;(n[He+1&3]||n[He+2&3]||n[He+3&3])&&(o=n,et=He)}for(;t.data!==i;)if(a=t,!(t=t.next))return this;return(l=t.next)&&delete t.next,a?(l?a.next=l:delete a.next,this):n?(l?n[He]=l:delete n[He],(t=n[0]||n[1]||n[2]||n[3])&&t===(n[3]||n[2]||n[1]||n[0])&&!t.length&&(o?o[et]=t:this._root=t),this):(this._root=l,this)},gr.removeAll=function Lu(i){for(var n=0,t=i.length;n<t;++n)this.remove(i[n]);return this},gr.root=function ig(){return this._root},gr.size=function F_(){var i=0;return this.visit(function(n){if(!n.length)do{++i}while(n=n.next)}),i},gr.visit=function U_(i){var t,a,l,_,C,N,n=[],o=this._root;for(o&&n.push(new pi(o,this._x0,this._y0,this._x1,this._y1));t=n.pop();)if(!i(o=t.node,l=t.x0,_=t.y0,C=t.x1,N=t.y1)&&o.length){var F=(l+C)/2,V=(_+N)/2;(a=o[3])&&n.push(new pi(a,F,V,C,N)),(a=o[2])&&n.push(new pi(a,l,V,F,N)),(a=o[1])&&n.push(new pi(a,F,_,C,V)),(a=o[0])&&n.push(new pi(a,l,_,F,V))}return this},gr.visitAfter=function q_(i){var o,n=[],t=[];for(this._root&&n.push(new pi(this._root,this._x0,this._y0,this._x1,this._y1));o=n.pop();){var a=o.node;if(a.length){var l,_=o.x0,C=o.y0,N=o.x1,F=o.y1,V=(_+N)/2,ue=(C+F)/2;(l=a[0])&&n.push(new pi(l,_,C,V,ue)),(l=a[1])&&n.push(new pi(l,V,C,N,ue)),(l=a[2])&&n.push(new pi(l,_,ue,V,F)),(l=a[3])&&n.push(new pi(l,V,ue,N,F))}t.push(o)}for(;o=t.pop();)i(o.node,o.x0,o.y0,o.x1,o.y1);return this},gr.x=function j_(i){return arguments.length?(this._x=i,this):this._x},gr.y=function G_(i){return arguments.length?(this._y=i,this):this._y};var As="$";function yp(){}function vp(i,n){var t=new yp;if(i instanceof yp)i.each(function(C,N){t.set(N,C)});else if(Array.isArray(i)){var l,o=-1,a=i.length;if(null==n)for(;++o<a;)t.set(o,i[o]);else for(;++o<a;)t.set(n(l=i[o],o,i),l)}else if(i)for(var _ in i)t.set(_,i[_]);return t}yp.prototype=vp.prototype={constructor:yp,has:function(i){return As+i in this},get:function(i){return this[As+i]},set:function(i,n){return this[As+i]=n,this},remove:function(i){var n=As+i;return n in this&&delete this[n]},clear:function(){for(var i in this)i[0]===As&&delete this[i]},keys:function(){var i=[];for(var n in this)n[0]===As&&i.push(n.slice(1));return i},values:function(){var i=[];for(var n in this)n[0]===As&&i.push(this[n]);return i},entries:function(){var i=[];for(var n in this)n[0]===As&&i.push({key:n.slice(1),value:this[n]});return i},size:function(){var i=0;for(var n in this)n[0]===As&&++i;return i},empty:function(){for(var i in this)if(i[0]===As)return!1;return!0},each:function(i){for(var n in this)n[0]===As&&i(this[n],n.slice(1),this)}};const Gc=vp;function Vc(){}var ar=Gc.prototype;function H_(i){return i.index}function ih(i,n){var t=i.get(n);if(!t)throw new Error("missing: "+n);return t}function $p(i){var o,l,_,C,N,n=H_,t=function V(it){return 1/Math.min(C[it.source.index],C[it.target.index])},a=Sr(30),F=1;function ue(it){for(var He=0,et=i.length;He<F;++He)for(var bt,vt,Vt,Dn,ei,Yn,Hn,xt=0;xt<et;++xt)Dn=(Vt=(bt=i[xt]).target).x+Vt.vx-(vt=bt.source).x-vt.vx||Fl(),ei=Vt.y+Vt.vy-vt.y-vt.vy||Fl(),ei*=Yn=((Yn=Math.sqrt(Dn*Dn+ei*ei))-l[xt])/Yn*it*o[xt],Vt.vx-=(Dn*=Yn)*(Hn=N[xt]),Vt.vy-=ei*Hn,vt.vx+=Dn*(Hn=1-Hn),vt.vy+=ei*Hn}function ce(){if(_){var it,bt,He=_.length,et=i.length,xt=Gc(_,n);for(it=0,C=new Array(He);it<et;++it)(bt=i[it]).index=it,"object"!=typeof bt.source&&(bt.source=ih(xt,bt.source)),"object"!=typeof bt.target&&(bt.target=ih(xt,bt.target)),C[bt.source.index]=(C[bt.source.index]||0)+1,C[bt.target.index]=(C[bt.target.index]||0)+1;for(it=0,N=new Array(et);it<et;++it)N[it]=C[(bt=i[it]).source.index]/(C[bt.source.index]+C[bt.target.index]);o=new Array(et),Te(),l=new Array(et),We()}}function Te(){if(_)for(var it=0,He=i.length;it<He;++it)o[it]=+t(i[it],it,i)}function We(){if(_)for(var it=0,He=i.length;it<He;++it)l[it]=+a(i[it],it,i)}return null==i&&(i=[]),ue.initialize=function(it){_=it,ce()},ue.links=function(it){return arguments.length?(i=it,ce(),ue):i},ue.id=function(it){return arguments.length?(n=it,ue):n},ue.iterations=function(it){return arguments.length?(F=+it,ue):F},ue.strength=function(it){return arguments.length?(t="function"==typeof it?it:Sr(+it),Te(),ue):t},ue.distance=function(it){return arguments.length?(a="function"==typeof it?it:Sr(+it),We(),ue):a},ue}function oh(i){return i.x}function Q_(i){return i.y}Vc.prototype=function ag(i,n){var t=new Vc;if(i instanceof Vc)i.each(function(l){t.add(l)});else if(i){var o=-1,a=i.length;if(null==n)for(;++o<a;)t.add(i[o]);else for(;++o<a;)t.add(n(i[o],o,i))}return t}.prototype={constructor:Vc,has:ar.has,add:function(i){return this[As+(i+="")]=i,this},remove:ar.remove,clear:ar.clear,values:ar.keys,size:ar.size,empty:ar.empty,each:ar.each};var Du=Math.PI*(3-Math.sqrt(5));function Wp(i){var n,t=1,o=.001,a=1-Math.pow(o,1/300),l=0,_=.6,C=Gc(),N=fa(V),F=ka("tick","end");function V(){ue(),F.call("tick",n),t<o&&(N.stop(),F.call("end",n))}function ue(We){var it,et,He=i.length;void 0===We&&(We=1);for(var xt=0;xt<We;++xt)for(t+=(l-t)*a,C.each(function(bt){bt(t)}),it=0;it<He;++it)null==(et=i[it]).fx?et.x+=et.vx*=_:(et.x=et.fx,et.vx=0),null==et.fy?et.y+=et.vy*=_:(et.y=et.fy,et.vy=0);return n}function ce(){for(var He,We=0,it=i.length;We<it;++We){if((He=i[We]).index=We,null!=He.fx&&(He.x=He.fx),null!=He.fy&&(He.y=He.fy),isNaN(He.x)||isNaN(He.y)){var et=10*Math.sqrt(We),xt=We*Du;He.x=et*Math.cos(xt),He.y=et*Math.sin(xt)}(isNaN(He.vx)||isNaN(He.vy))&&(He.vx=He.vy=0)}}function Te(We){return We.initialize&&We.initialize(i),We}return null==i&&(i=[]),ce(),n={tick:ue,restart:function(){return N.restart(V),n},stop:function(){return N.stop(),n},nodes:function(We){return arguments.length?(i=We,ce(),C.each(Te),n):i},alpha:function(We){return arguments.length?(t=+We,n):t},alphaMin:function(We){return arguments.length?(o=+We,n):o},alphaDecay:function(We){return arguments.length?(a=+We,n):+a},alphaTarget:function(We){return arguments.length?(l=+We,n):l},velocityDecay:function(We){return arguments.length?(_=1-We,n):1-_},force:function(We,it){return arguments.length>1?(null==it?C.remove(We):C.set(We,Te(it)),n):C.get(We)},find:function(We,it,He){var bt,vt,Vt,Dn,ei,et=0,xt=i.length;for(null==He?He=1/0:He*=He,et=0;et<xt;++et)(Vt=(bt=We-(Dn=i[et]).x)*bt+(vt=it-Dn.y)*vt)<He&&(ei=Dn,He=Vt);return ei},on:function(We,it){return arguments.length>1?(F.on(We,it),n):F.on(We)}}}function rh(){var i,n,t,a,o=Sr(-30),l=1,_=1/0,C=.81;function N(ce){var Te,We=i.length,it=th(i,oh,Q_).visitAfter(V);for(t=ce,Te=0;Te<We;++Te)n=i[Te],it.visit(ue)}function F(){if(i){var ce,We,Te=i.length;for(a=new Array(Te),ce=0;ce<Te;++ce)a[(We=i[ce]).index]=+o(We,ce,i)}}function V(ce){var We,it,et,xt,bt,Te=0,He=0;if(ce.length){for(et=xt=bt=0;bt<4;++bt)(We=ce[bt])&&(it=Math.abs(We.value))&&(Te+=We.value,He+=it,et+=it*We.x,xt+=it*We.y);ce.x=et/He,ce.y=xt/He}else{(We=ce).x=We.data.x,We.y=We.data.y;do{Te+=a[We.data.index]}while(We=We.next)}ce.value=Te}function ue(ce,Te,We,it){if(!ce.value)return!0;var He=ce.x-n.x,et=ce.y-n.y,xt=it-Te,bt=He*He+et*et;if(xt*xt/C<bt)return bt<_&&(0===He&&(bt+=(He=Fl())*He),0===et&&(bt+=(et=Fl())*et),bt<l&&(bt=Math.sqrt(l*bt)),n.vx+=He*ce.value*t/bt,n.vy+=et*ce.value*t/bt),!0;if(!(ce.length||bt>=_)){(ce.data!==n||ce.next)&&(0===He&&(bt+=(He=Fl())*He),0===et&&(bt+=(et=Fl())*et),bt<l&&(bt=Math.sqrt(l*bt)));do{ce.data!==n&&(n.vx+=He*(xt=a[ce.data.index]*t/bt),n.vy+=et*xt)}while(ce=ce.next)}}return N.initialize=function(ce){i=ce,F()},N.strength=function(ce){return arguments.length?(o="function"==typeof ce?ce:Sr(+ce),F(),N):o},N.distanceMin=function(ce){return arguments.length?(l=ce*ce,N):Math.sqrt(l)},N.distanceMax=function(ce){return arguments.length?(_=ce*ce,N):Math.sqrt(_)},N.theta=function(ce){return arguments.length?(C=ce*ce,N):Math.sqrt(C)},N}function lg(i,n,t){var o,l,_,a=Sr(.1);function C(F){for(var V=0,ue=o.length;V<ue;++V){var ce=o[V],Te=ce.x-n||1e-6,We=ce.y-t||1e-6,it=Math.sqrt(Te*Te+We*We),He=(_[V]-it)*l[V]*F/it;ce.vx+=Te*He,ce.vy+=We*He}}function N(){if(o){var F,V=o.length;for(l=new Array(V),_=new Array(V),F=0;F<V;++F)_[F]=+i(o[F],F,o),l[F]=isNaN(_[F])?0:+a(o[F],F,o)}}return"function"!=typeof i&&(i=Sr(+i)),null==n&&(n=0),null==t&&(t=0),C.initialize=function(F){o=F,N()},C.strength=function(F){return arguments.length?(a="function"==typeof F?F:Sr(+F),N(),C):a},C.radius=function(F){return arguments.length?(i="function"==typeof F?F:Sr(+F),N(),C):i},C.x=function(F){return arguments.length?(n=+F,C):n},C.y=function(F){return arguments.length?(t=+F,C):t},C}function K_(i){var t,o,a,n=Sr(.1);function l(C){for(var V,N=0,F=t.length;N<F;++N)(V=t[N]).vx+=(a[N]-V.x)*o[N]*C}function _(){if(t){var C,N=t.length;for(o=new Array(N),a=new Array(N),C=0;C<N;++C)o[C]=isNaN(a[C]=+i(t[C],C,t))?0:+n(t[C],C,t)}}return"function"!=typeof i&&(i=Sr(null==i?0:+i)),l.initialize=function(C){t=C,_()},l.strength=function(C){return arguments.length?(n="function"==typeof C?C:Sr(+C),_(),l):n},l.x=function(C){return arguments.length?(i="function"==typeof C?C:Sr(+C),_(),l):i},l}function cg(i){var t,o,a,n=Sr(.1);function l(C){for(var V,N=0,F=t.length;N<F;++N)(V=t[N]).vy+=(a[N]-V.y)*o[N]*C}function _(){if(t){var C,N=t.length;for(o=new Array(N),a=new Array(N),C=0;C<N;++C)o[C]=isNaN(a[C]=+i(t[C],C,t))?0:+n(t[C],C,t)}}return"function"!=typeof i&&(i=Sr(null==i?0:+i)),l.initialize=function(C){t=C,_()},l.strength=function(C){return arguments.length?(n="function"==typeof C?C:Sr(+C),_(),l):n},l.y=function(C){return arguments.length?(i="function"==typeof C?C:Sr(+C),_(),l):i},l}var ug=v(67824);function pg(i,n,t){var o=new Xo,a=n;return null==n?(o.restart(i,n,t),o):(n=+n,t=null==t?un():+t,o.restart(function l(_){_+=a,o.restart(l,a+=n,t),i(_)},n,t),o)}const dg=["linkTemplate"],$_=["nodeTemplate"],W_=["clusterTemplate"],hg=["defsTemplate"],fg=["miniMapNodeTemplate"],Xp=["nodeElement"],gg=["linkElement"];function ed(i,n){if(1&i&&(e.O4$(),e.GkF(0,14)),2&i){const t=e.oxw(2);e.Q6J("ngTemplateOutlet",t.defsTemplate)}}function td(i,n){if(1&i&&(e.O4$(),e._UZ(0,"path",15)),2&i){const t=n.$implicit;e.uIk("d",t.textPath)("id",t.id)}}const gc=function(i){return{$implicit:i}};function Ru(i,n){if(1&i&&(e.O4$(),e.GkF(0,20)),2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.clusterTemplate)("ngTemplateOutletContext",e.VKq(2,gc,t))}}function X_(i,n){if(1&i&&(e.O4$(),e.TgZ(0,"g",21),e._UZ(1,"rect"),e.TgZ(2,"text",22),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.uIk("width",t.dimension.width)("height",t.dimension.height)("fill",null==t.data?null:t.data.color),e.xp6(1),e.uIk("x",10)("y",t.dimension.height/2),e.xp6(1),e.hij(" ",t.label," ")}}function em(i,n){if(1&i){const t=e.EpF();e.O4$(),e.TgZ(0,"g",16,17),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.onClick(l))}),e.YNc(2,Ru,1,4,"ng-container",18),e.YNc(3,X_,4,6,"g",19),e.qZA()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.ekj("old-node",o.animate&&o.oldClusters.has(t.id)),e.Q6J("id",t.id),e.uIk("transform",t.transform),e.xp6(2),e.Q6J("ngIf",o.clusterTemplate),e.xp6(1),e.Q6J("ngIf",!o.clusterTemplate)}}function tm(i,n){if(1&i&&(e.O4$(),e.GkF(0,20)),2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.linkTemplate)("ngTemplateOutletContext",e.VKq(2,gc,t))}}function Fu(i,n){if(1&i&&(e.O4$(),e._UZ(0,"path",26)),2&i){const t=e.oxw().$implicit;e.uIk("d",t.line)}}function ah(i,n){if(1&i&&(e.O4$(),e.TgZ(0,"g",23,24),e.YNc(2,tm,1,4,"ng-container",18),e.YNc(3,Fu,1,1,"path",25),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(2);e.Q6J("id",t.id),e.xp6(2),e.Q6J("ngIf",o.linkTemplate),e.xp6(1),e.Q6J("ngIf",!o.linkTemplate)}}function _g(i,n){if(1&i&&(e.O4$(),e.GkF(0,20)),2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.nodeTemplate)("ngTemplateOutletContext",e.VKq(2,gc,t))}}function sh(i,n){if(1&i&&(e.O4$(),e._UZ(0,"circle",30)),2&i){const t=e.oxw().$implicit;e.uIk("cx",t.dimension.width/2)("cy",t.dimension.height/2)("fill",null==t.data?null:t.data.color)}}function mg(i,n){if(1&i){const t=e.EpF();e.O4$(),e.TgZ(0,"g",27,28),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.onClick(l))})("mousedown",function(a){const _=e.CHM(t).$implicit,C=e.oxw(2);return e.KtG(C.onNodeMouseDown(a,_))}),e.YNc(2,_g,1,4,"ng-container",18),e.YNc(3,sh,1,3,"circle",29),e.qZA()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.ekj("old-node",o.animate&&o.oldNodes.has(t.id)),e.Q6J("id",t.id),e.uIk("transform",t.transform),e.xp6(2),e.Q6J("ngIf",o.nodeTemplate),e.xp6(1),e.Q6J("ngIf",!o.nodeTemplate)}}function yg(i,n){if(1&i){const t=e.EpF();e.O4$(),e.TgZ(0,"g",4),e.NdJ("touchstart",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onTouchStart(a))})("touchend",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onTouchEnd(a))}),e.TgZ(1,"defs"),e.YNc(2,ed,1,1,"ng-container",5),e.YNc(3,td,1,2,"path",6),e.qZA(),e.TgZ(4,"rect",7),e.NdJ("mousedown",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.isPanning=!0)}),e.qZA(),e.Hsn(5),e.TgZ(6,"g",8),e.YNc(7,em,4,6,"g",9),e.qZA(),e.TgZ(8,"g",10),e.YNc(9,ah,4,3,"g",11),e.qZA(),e.TgZ(10,"g",12),e.YNc(11,mg,4,6,"g",13),e.qZA()()}if(2&i){const t=e.oxw();e.uIk("transform",t.transform),e.xp6(2),e.Q6J("ngIf",t.defsTemplate),e.xp6(1),e.Q6J("ngForOf",t.graph.edges),e.xp6(1),e.uIk("width",100*t.dims.width)("height",100*t.dims.height)("transform","translate("+50*(-t.dims.width||0)+","+50*(-t.dims.height||0)+")"),e.xp6(3),e.Q6J("ngForOf",t.graph.clusters)("ngForTrackBy",t.trackNodeBy),e.xp6(2),e.Q6J("ngForOf",t.graph.edges)("ngForTrackBy",t.trackLinkBy),e.xp6(2),e.Q6J("ngForOf",t.graph.nodes)("ngForTrackBy",t.trackNodeBy)}}function nm(i,n){if(1&i&&(e.O4$(),e.GkF(0,20)),2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.miniMapNodeTemplate)("ngTemplateOutletContext",e.VKq(2,gc,t))}}function im(i,n){if(1&i&&(e.O4$(),e.GkF(0,20)),2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("ngTemplateOutlet",o.nodeTemplate)("ngTemplateOutletContext",e.VKq(2,gc,t))}}function om(i,n){if(1&i&&(e.O4$(),e._UZ(0,"circle",30)),2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.uIk("cx",t.dimension.width/2/o.minimapScaleCoefficient)("cy",t.dimension.height/2/o.minimapScaleCoefficient)("fill",null==t.data?null:t.data.color)}}function nd(i,n){if(1&i&&(e.O4$(),e.TgZ(0,"g",36,28),e.YNc(2,nm,1,4,"ng-container",18),e.YNc(3,im,1,4,"ng-container",18),e.YNc(4,om,1,3,"circle",29),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(2);e.ekj("old-node",o.animate&&o.oldNodes.has(t.id)),e.Q6J("id",t.id),e.uIk("transform",t.transform),e.xp6(2),e.Q6J("ngIf",o.miniMapNodeTemplate),e.xp6(1),e.Q6J("ngIf",!o.miniMapNodeTemplate&&o.nodeTemplate),e.xp6(1),e.Q6J("ngIf",!o.nodeTemplate&&!o.miniMapNodeTemplate)}}function lh(i,n){if(1&i){const t=e.EpF();e.O4$(),e.TgZ(0,"g",31)(1,"rect",32),e.NdJ("mousedown",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onMinimapPanTo(a))}),e.qZA(),e.TgZ(2,"g")(3,"g",33),e.YNc(4,nd,5,7,"g",34),e.qZA(),e.TgZ(5,"rect",35),e.NdJ("mousedown",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onMinimapDragMouseDown())}),e.qZA()()()}if(2&i){const t=e.oxw();e.uIk("transform",t.minimapTransform)("clip-path","url(#"+t.minimapClipPathId+")"),e.xp6(1),e.uIk("width",t.graphDims.width/t.minimapScaleCoefficient)("height",t.graphDims.height/t.minimapScaleCoefficient),e.xp6(1),e.Udp("transform","translate("+-t.minimapOffsetX/t.minimapScaleCoefficient+"px,"+-t.minimapOffsetY/t.minimapScaleCoefficient+"px)"),e.xp6(1),e.Udp("transform","scale("+1/t.minimapScaleCoefficient+")"),e.xp6(1),e.Q6J("ngForOf",t.graph.nodes)("ngForTrackBy",t.trackNodeBy),e.xp6(1),e.ekj("panning",t.isMinimapPanning),e.uIk("transform","translate("+t.panOffsetX/t.zoomLevel/-t.minimapScaleCoefficient+","+t.panOffsetY/t.zoomLevel/-t.minimapScaleCoefficient+")")("width",t.width/t.minimapScaleCoefficient/t.zoomLevel)("height",t.height/t.minimapScaleCoefficient/t.zoomLevel)}}const rm=["*"],Yc={};function gs(){let i=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return i=`a${i}`,Yc[i]?gs():(Yc[i]=!0,i)}var Pi=(()=>{return(i=Pi||(Pi={})).Both="both",i.Horizontal="horizontal",i.Vertical="vertical",Pi;var i})(),Uu=(()=>{return(i=Uu||(Uu={})).UpperLeft="UpperLeft",i.UpperRight="UpperRight",Uu;var i})();function ch(i,n,t){t=t||{};let o,a,l,_=null,C=0;function N(){C=!1===t.leading?0:+new Date,_=null,l=i.apply(o,a)}return function(...F){const V=+new Date;!C&&!1===t.leading&&(C=V);const ue=n-(V-C);return o=this,a=F,ue<=0?(clearTimeout(_),_=null,C=V,l=i.apply(o,a)):!_&&!1!==t.trailing&&(_=setTimeout(N,ue)),l}}function qu(i,n){return function(o,a,l){return{configurable:!0,enumerable:l.enumerable,get:function(){return Object.defineProperty(this,a,{configurable:!0,enumerable:l.enumerable,value:ch(l.value,i,n)}),this[a]}}}}const vg=[{name:"vivid",selectable:!0,group:"Ordinal",domain:["#647c8a","#3f51b5","#2196f3","#00b862","#afdf0a","#a7b61a","#f3e562","#ff9800","#ff5722","#ff4514"]},{name:"natural",selectable:!0,group:"Ordinal",domain:["#bf9d76","#e99450","#d89f59","#f2dfa7","#a5d7c6","#7794b1","#afafaf","#707160","#ba9383","#d9d5c3"]},{name:"cool",selectable:!0,group:"Ordinal",domain:["#a8385d","#7aa3e5","#a27ea8","#aae3f5","#adcded","#a95963","#8796c0","#7ed3ed","#50abcc","#ad6886"]},{name:"fire",selectable:!0,group:"Ordinal",domain:["#ff3d00","#bf360c","#ff8f00","#ff6f00","#ff5722","#e65100","#ffca28","#ffab00"]},{name:"solar",selectable:!0,group:"Continuous",domain:["#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00"]},{name:"air",selectable:!0,group:"Continuous",domain:["#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b"]},{name:"aqua",selectable:!0,group:"Continuous",domain:["#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#00acc1","#0097a7","#00838f","#006064"]},{name:"flame",selectable:!1,group:"Ordinal",domain:["#A10A28","#D3342D","#EF6D49","#FAAD67","#FDDE90","#DBED91","#A9D770","#6CBA67","#2C9653","#146738"]},{name:"ocean",selectable:!1,group:"Ordinal",domain:["#1D68FB","#33C0FC","#4AFFFE","#AFFFFF","#FFFC63","#FDBD2D","#FC8A25","#FA4F1E","#FA141B","#BA38D1"]},{name:"forest",selectable:!1,group:"Ordinal",domain:["#55C22D","#C1F33D","#3CC099","#AFFFFF","#8CFC9D","#76CFFA","#BA60FB","#EE6490","#C42A1C","#FC9F32"]},{name:"horizon",selectable:!1,group:"Ordinal",domain:["#2597FB","#65EBFD","#99FDD0","#FCEE4B","#FEFCFA","#FDD6E3","#FCB1A8","#EF6F7B","#CB96E8","#EFDEE0"]},{name:"neons",selectable:!1,group:"Ordinal",domain:["#FF3333","#FF33FF","#CC33FF","#0000FF","#33CCFF","#33FFFF","#33FF66","#CCFF33","#FFCC00","#FF6600"]},{name:"picnic",selectable:!1,group:"Ordinal",domain:["#FAC51D","#66BD6D","#FAA026","#29BB9C","#E96B56","#55ACD2","#B7332F","#2C83C9","#9166B8","#92E7E8"]},{name:"night",selectable:!1,group:"Ordinal",domain:["#2B1B5A","#501356","#183356","#28203F","#391B3C","#1E2B3C","#120634","#2D0432","#051932","#453080","#75267D","#2C507D","#4B3880","#752F7D","#35547D"]},{name:"nightLights",selectable:!1,group:"Ordinal",domain:["#4e31a5","#9c25a7","#3065ab","#57468b","#904497","#46648b","#32118d","#a00fb3","#1052a2","#6e51bd","#b63cc3","#6c97cb","#8671c1","#b455be","#7496c3"]}];class am{constructor(n,t,o){"string"==typeof n&&(n=vg.find(a=>a.name===n)),this.colorDomain=n.domain,this.domain=t,this.customColors=o,this.scale=this.generateColorScheme(n,this.domain)}generateColorScheme(n,t){return"string"==typeof n&&(n=vg.find(o=>o.name===n)),eh().range(n.domain).domain(t)}getColor(n){if(null==n)throw new Error("Value can not be null");if("function"==typeof this.customColors)return this.customColors(n);const t=n.toString();let o;return this.customColors&&this.customColors.length>0&&(o=this.customColors.find(a=>a.name.toLowerCase()===t.toLowerCase())),o?o.value:this.scale(n)}}let lm=(()=>{class i{constructor(t,o){this.element=t,this.zone=o,this.visible=new e.vpe,this.isVisible=!1,this.runCheck()}destroy(){clearTimeout(this.timeout)}onVisibilityChange(){this.zone.run(()=>{this.isVisible=!0,this.visible.emit(!0)})}runCheck(){const t=()=>{if(!this.element)return;const{offsetHeight:o,offsetWidth:a}=this.element.nativeElement;o&&a?(clearTimeout(this.timeout),this.onVisibilityChange()):(clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t(),100)}))};this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>t())})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(e.R0b))},i.\u0275dir=e.lG2({type:i,selectors:[["visibility-observer"]],outputs:{visible:"visible"}}),i})();var Hc=(()=>{return(i=Hc||(Hc={})).LEFT_TO_RIGHT="LR",i.RIGHT_TO_LEFT="RL",i.TOP_TO_BOTTOM="TB",i.BOTTOM_TO_TOM="BT",Hc;var i})();function ks(i){return"string"==typeof i?{id:i,x:0,y:0}:i}function Qc(i,n){return"number"==typeof n?i[n]:n}const Ro={dagre:class cm{constructor(){this.defaultSettings={orientation:Hc.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(n){this.createDagreGraph(n),fc.layout(this.dagreGraph),n.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const o=this.dagreGraph._nodes[t],a=n.nodes.find(l=>l.id===o.id);a.position={x:o.x,y:o.y},a.dimension={width:o.width,height:o.height}}return n}updateEdge(n,t){const o=n.nodes.find(N=>N.id===t.source),a=n.nodes.find(N=>N.id===t.target),l=o.position.y<=a.position.y?-1:1;return t.points=[{x:o.position.x,y:o.position.y-l*(o.dimension.height/2)},{x:a.position.x,y:a.position.y+l*(a.dimension.height/2)}],n}createDagreGraph(n){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new fc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=n.nodes.map(o=>{const a=Object.assign({},o);return a.width=o.dimension.width,a.height=o.dimension.height,a.x=o.position.x,a.y=o.position.y,a}),this.dagreEdges=n.edges.map(o=>{const a=Object.assign({},o);return a.id||(a.id=gs()),a});for(const o of this.dagreNodes)o.width||(o.width=20),o.height||(o.height=30),this.dagreGraph.setNode(o.id,o);for(const o of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(o.source,o.target,o,o.id):this.dagreGraph.setEdge(o.source,o.target);return this.dagreGraph}},dagreCluster:class bg{constructor(){this.defaultSettings={orientation:Hc.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(n){this.createDagreGraph(n),fc.layout(this.dagreGraph),n.edgeLabels=this.dagreGraph._edgeLabels;const t=o=>{const a=this.dagreGraph._nodes[o.id];return{...o,position:{x:a.x,y:a.y},dimension:{width:a.width,height:a.height}}};return n.clusters=(n.clusters||[]).map(t),n.nodes=n.nodes.map(t),n}updateEdge(n,t){const o=n.nodes.find(N=>N.id===t.source),a=n.nodes.find(N=>N.id===t.target),l=o.position.y<=a.position.y?-1:1;return t.points=[{x:o.position.x,y:o.position.y-l*(o.dimension.height/2)},{x:a.position.x,y:a.position.y+l*(a.dimension.height/2)}],n}createDagreGraph(n){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new fc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=n.nodes.map(o=>{const a=Object.assign({},o);return a.width=o.dimension.width,a.height=o.dimension.height,a.x=o.position.x,a.y=o.position.y,a}),this.dagreClusters=n.clusters||[],this.dagreEdges=n.edges.map(o=>{const a=Object.assign({},o);return a.id||(a.id=gs()),a});for(const o of this.dagreNodes)this.dagreGraph.setNode(o.id,o);for(const o of this.dagreClusters)this.dagreGraph.setNode(o.id,o),o.childNodeIds.forEach(a=>{this.dagreGraph.setParent(a,o.id)});for(const o of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(o.source,o.target,o,o.id):this.dagreGraph.setEdge(o.source,o.target);return this.dagreGraph}},dagreNodesOnly:class id{constructor(){this.defaultSettings={orientation:Hc.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,curveDistance:20,multigraph:!0,compound:!0},this.settings={}}run(n){this.createDagreGraph(n),fc.layout(this.dagreGraph),n.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const o=this.dagreGraph._nodes[t],a=n.nodes.find(l=>l.id===o.id);a.position={x:o.x,y:o.y},a.dimension={width:o.width,height:o.height}}for(const t of n.edges)this.updateEdge(n,t);return n}updateEdge(n,t){const o=n.nodes.find(We=>We.id===t.source),a=n.nodes.find(We=>We.id===t.target),l="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",_="y"===l?"x":"y",C="y"===l?"height":"width",N=o.position[l]<=a.position[l]?-1:1,F={[_]:o.position[_],[l]:o.position[l]-N*(o.dimension[C]/2)},V={[_]:a.position[_],[l]:a.position[l]+N*(a.dimension[C]/2)},ue=this.settings.curveDistance||this.defaultSettings.curveDistance;t.points=[F,{[_]:F[_],[l]:F[l]-N*ue},{[_]:V[_],[l]:V[l]+N*ue},V];const Te=n.edgeLabels[`${t.source}\x01${t.target}\x01\0`];return Te&&(Te.points=t.points),n}createDagreGraph(n){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new fc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=n.nodes.map(o=>{const a=Object.assign({},o);return a.width=o.dimension.width,a.height=o.dimension.height,a.x=o.position.x,a.y=o.position.y,a}),this.dagreEdges=n.edges.map(o=>{const a=Object.assign({},o);return a.id||(a.id=gs()),a});for(const o of this.dagreNodes)o.width||(o.width=20),o.height||(o.height=30),this.dagreGraph.setNode(o.id,o);for(const o of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(o.source,o.target,o,o.id):this.dagreGraph.setEdge(o.source,o.target);return this.dagreGraph}},d3ForceDirected:class ph{constructor(){this.defaultSettings={force:Wp().force("charge",rh().strength(-150)).force("collide",rg(5)),forceLink:$p().id(n=>n.id).distance(()=>100)},this.settings={},this.outputGraph$=new pn.x}run(n){return this.inputGraph=n,this.d3Graph={nodes:[...this.inputGraph.nodes.map(t=>({...t}))],edges:[...this.inputGraph.edges.map(t=>({...t}))]},this.outputGraph={nodes:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&this.settings.force.nodes(this.d3Graph.nodes).force("link",this.settings.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}updateEdge(n,t){const o=Object.assign({},this.defaultSettings,this.settings);return o.force&&o.force.nodes(this.d3Graph.nodes).force("link",o.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}d3GraphToOutputGraph(n){return this.outputGraph.nodes=this.d3Graph.nodes.map(t=>({...t,id:t.id||gs(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:`translate(${t.x-(t.dimension&&t.dimension.width||20)/2||0}, ${t.y-(t.dimension&&t.dimension.height||20)/2||0})`})),this.outputGraph.edges=this.d3Graph.edges.map(t=>({...t,source:ks(t.source).id,target:ks(t.target).id,points:[{x:ks(t.source).x,y:ks(t.source).y},{x:ks(t.target).x,y:ks(t.target).y}]})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(n,t){this.settings.force.alphaTarget(.3).restart();const o=this.d3Graph.nodes.find(a=>a.id===n.id);!o||(this.draggingStart={x:t.x-o.x,y:t.y-o.y},o.fx=t.x-this.draggingStart.x,o.fy=t.y-this.draggingStart.y)}onDrag(n,t){if(!n)return;const o=this.d3Graph.nodes.find(a=>a.id===n.id);!o||(o.fx=t.x-this.draggingStart.x,o.fy=t.y-this.draggingStart.y)}onDragEnd(n,t){if(!n)return;const o=this.d3Graph.nodes.find(a=>a.id===n.id);!o||(this.settings.force.alphaTarget(0),o.fx=void 0,o.fy=void 0)}},colaForceDirected:class Cg{constructor(){this.defaultSettings={force:(0,ug.d3adaptor)({...D,...M,...d}).linkDistance(150).avoidOverlaps(!0),viewDimensions:{width:600,height:600}},this.settings={},this.outputGraph$=new pn.x}run(n){return this.inputGraph=n,this.inputGraph.clusters||(this.inputGraph.clusters=[]),this.internalGraph={nodes:[...this.inputGraph.nodes.map(t=>({...t,width:t.dimension?t.dimension.width:20,height:t.dimension?t.dimension.height:20}))],groups:[...this.inputGraph.clusters.map(t=>({padding:5,groups:t.childNodeIds.map(o=>this.inputGraph.clusters.findIndex(a=>a.id===o)).filter(o=>o>=0),leaves:t.childNodeIds.map(o=>this.inputGraph.nodes.findIndex(a=>a.id===o)).filter(o=>o>=0)}))],links:[...this.inputGraph.edges.map(t=>{const o=this.inputGraph.nodes.findIndex(l=>t.source===l.id),a=this.inputGraph.nodes.findIndex(l=>t.target===l.id);if(-1!==o&&-1!==a)return{...t,source:o,target:a}}).filter(t=>!!t)],groupLinks:[...this.inputGraph.edges.map(t=>{const o=this.inputGraph.nodes.findIndex(l=>t.source===l.id),a=this.inputGraph.nodes.findIndex(l=>t.target===l.id);if(!(o>=0&&a>=0))return t}).filter(t=>!!t)]},this.outputGraph={nodes:[],clusters:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&(this.settings.force=this.settings.force.nodes(this.internalGraph.nodes).groups(this.internalGraph.groups).links(this.internalGraph.links).alpha(.5).on("tick",()=>{this.settings.onTickListener&&this.settings.onTickListener(this.internalGraph),this.outputGraph$.next(this.internalGraphToOutputGraph(this.internalGraph))}),this.settings.viewDimensions&&(this.settings.force=this.settings.force.size([this.settings.viewDimensions.width,this.settings.viewDimensions.height])),this.settings.forceModifierFn&&(this.settings.force=this.settings.forceModifierFn(this.settings.force)),this.settings.force.start()),this.outputGraph$.asObservable()}updateEdge(n,t){const o=Object.assign({},this.defaultSettings,this.settings);return o.force&&o.force.start(),this.outputGraph$.asObservable()}internalGraphToOutputGraph(n){return this.outputGraph.nodes=n.nodes.map(t=>({...t,id:t.id||gs(),position:{x:t.x,y:t.y},dimension:{width:t.dimension&&t.dimension.width||20,height:t.dimension&&t.dimension.height||20},transform:`translate(${t.x-(t.dimension&&t.dimension.width||20)/2||0}, ${t.y-(t.dimension&&t.dimension.height||20)/2||0})`})),this.outputGraph.edges=n.links.map(t=>{const o=Qc(n.nodes,t.source),a=Qc(n.nodes,t.target);return{...t,source:o.id,target:a.id,points:[o.bounds.rayIntersection(a.bounds.cx(),a.bounds.cy()),a.bounds.rayIntersection(o.bounds.cx(),o.bounds.cy())]}}).concat(n.groupLinks.map(t=>{const o=n.nodes.find(C=>C.id===t.source),a=n.nodes.find(C=>C.id===t.target),l=o||n.groups.find(C=>C.id===t.source),_=a||n.groups.find(C=>C.id===t.target);return{...t,source:l.id,target:_.id,points:[l.bounds.rayIntersection(_.bounds.cx(),_.bounds.cy()),_.bounds.rayIntersection(l.bounds.cx(),l.bounds.cy())]}})),this.outputGraph.clusters=n.groups.map((t,o)=>({...this.inputGraph.clusters[o],dimension:{width:t.bounds?t.bounds.width():20,height:t.bounds?t.bounds.height():20},position:{x:t.bounds?t.bounds.x+t.bounds.width()/2:0,y:t.bounds?t.bounds.y+t.bounds.height()/2:0}})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(n,t){const o=this.outputGraph.nodes.findIndex(l=>l.id===n.id),a=this.internalGraph.nodes[o];!a||(this.draggingStart={x:a.x-t.x,y:a.y-t.y},a.fixed=1,this.settings.force.start())}onDrag(n,t){if(!n)return;const o=this.outputGraph.nodes.findIndex(l=>l.id===n.id),a=this.internalGraph.nodes[o];!a||(a.x=this.draggingStart.x+t.x,a.y=this.draggingStart.y+t.y)}onDragEnd(n,t){if(!n)return;const o=this.outputGraph.nodes.findIndex(l=>l.id===n.id),a=this.internalGraph.nodes[o];!a||(a.fixed=0)}}};let ao=(()=>{class i{getLayout(t){if(Ro[t])return new Ro[t];throw new Error(`Unknown layout type '${t}'`)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),wg=(()=>{class i{constructor(){this.mouseWheelUp=new e.vpe,this.mouseWheelDown=new e.vpe}onMouseWheelChrome(t){this.mouseWheelFunc(t)}onMouseWheelFirefox(t){this.mouseWheelFunc(t)}onWheel(t){this.mouseWheelFunc(t)}onMouseWheelIE(t){this.mouseWheelFunc(t)}mouseWheelFunc(t){window.event&&(t=window.event);const o=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail||t.deltaY||t.deltaX)),l=t.wheelDelta?o<0:o>0;(t.wheelDelta?o>0:o<0)?this.mouseWheelUp.emit(t):l&&this.mouseWheelDown.emit(t),t.returnValue=!1,t.preventDefault&&t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=e.lG2({type:i,selectors:[["","mouseWheel",""]],hostBindings:function(t,o){1&t&&e.NdJ("mousewheel",function(l){return o.onMouseWheelChrome(l)})("DOMMouseScroll",function(l){return o.onMouseWheelFirefox(l)})("wheel",function(l){return o.onWheel(l)})("onmousewheel",function(l){return o.onMouseWheelIE(l)})},outputs:{mouseWheelUp:"mouseWheelUp",mouseWheelDown:"mouseWheelDown"}}),i})(),Tg=(()=>{class i{constructor(t,o,a,l){this.el=t,this.zone=o,this.cd=a,this.layoutService=l,this.nodes=[],this.clusters=[],this.links=[],this.activeEntries=[],this.draggingEnabled=!0,this.panningEnabled=!0,this.panningAxis=Pi.Both,this.enableZoom=!0,this.zoomSpeed=.1,this.minZoomLevel=.1,this.maxZoomLevel=4,this.autoZoom=!1,this.panOnZoom=!0,this.animate=!1,this.autoCenter=!1,this.enableTrackpadSupport=!1,this.showMiniMap=!1,this.miniMapMaxWidth=100,this.miniMapPosition=Uu.UpperRight,this.scheme="cool",this.animations=!0,this.select=new e.vpe,this.activate=new e.vpe,this.deactivate=new e.vpe,this.zoomChange=new e.vpe,this.clickHandler=new e.vpe,this.isMouseMoveCalled=!1,this.graphSubscription=new Ui.w0,this.subscriptions=[],this.isPanning=!1,this.isDragging=!1,this.initialized=!1,this.graphDims={width:0,height:0},this._oldLinks=[],this.oldNodes=new Set,this.oldClusters=new Set,this.transformationMatrix={a:1,c:0,e:0,b:0,d:1,f:0},this._touchLastX=null,this._touchLastY=null,this.minimapScaleCoefficient=3,this.minimapOffsetX=0,this.minimapOffsetY=0,this.isMinimapPanning=!1,this.groupResultsBy=_=>_.label}get zoomLevel(){return this.transformationMatrix.a}set zoomLevel(t){this.zoomTo(Number(t))}get panOffsetX(){return this.transformationMatrix.e}set panOffsetX(t){this.panTo(Number(t),null)}get panOffsetY(){return this.transformationMatrix.f}set panOffsetY(t){this.panTo(null,Number(t))}ngOnInit(){this.update$&&this.subscriptions.push(this.update$.subscribe(()=>{this.update()})),this.center$&&this.subscriptions.push(this.center$.subscribe(()=>{this.center()})),this.zoomToFit$&&this.subscriptions.push(this.zoomToFit$.subscribe(()=>{this.zoomToFit()})),this.panToNode$&&this.subscriptions.push(this.panToNode$.subscribe(t=>{this.panToNodeId(t)})),this.minimapClipPathId=`minimapClip${gs()}`}ngOnChanges(t){this.basicUpdate();const{layoutSettings:a}=t;this.setLayout(this.layout),a&&this.setLayoutSettings(this.layoutSettings),this.update()}setLayout(t){this.initialized=!1,t||(t="dagre"),"string"==typeof t&&(this.layout=this.layoutService.getLayout(t),this.setLayoutSettings(this.layoutSettings))}setLayoutSettings(t){this.layout&&"string"!=typeof this.layout&&(this.layout.settings=t)}ngOnDestroy(){this.unbindEvents(),this.visibilityObserver&&(this.visibilityObserver.visible.unsubscribe(),this.visibilityObserver.destroy());for(const t of this.subscriptions)t.unsubscribe();this.subscriptions=null}ngAfterViewInit(){this.bindWindowResizeEvent(),this.visibilityObserver=new lm(this.el,this.zone),this.visibilityObserver.visible.subscribe(this.update.bind(this)),setTimeout(()=>this.update())}update(){this.basicUpdate(),this.curve||(this.curve=Co.beta(1)),this.zone.run(()=>{this.dims=function sm({width:i,height:n}){let t=i,o=n;return t=Math.max(0,t),o=Math.max(0,o),{width:Math.floor(t),height:Math.floor(o)}}({width:this.width,height:this.height}),this.seriesDomain=this.getSeriesDomain(),this.setColors(),this.createGraph(),this.updateTransform(),this.initialized=!0})}createGraph(){this.graphSubscription.unsubscribe(),this.graphSubscription=new Ui.w0;const t=o=>(o.meta||(o.meta={}),o.id||(o.id=gs()),o.dimension?o.meta.forceDimensions=void 0===o.meta.forceDimensions||o.meta.forceDimensions:(o.dimension={width:this.nodeWidth?this.nodeWidth:30,height:this.nodeHeight?this.nodeHeight:30},o.meta.forceDimensions=!1),o.position||(o.position={x:0,y:0}),o.data=o.data?o.data:{},o);this.graph={nodes:this.nodes.length>0?[...this.nodes].map(t):[],clusters:this.clusters&&this.clusters.length>0?[...this.clusters].map(t):[],edges:this.links.length>0?[...this.links].map(o=>(o.id||(o.id=gs()),o)):[]},requestAnimationFrame(()=>this.draw())}draw(){if(!this.layout||"string"==typeof this.layout)return;this.applyNodeDimensions();const t=this.layout.run(this.graph),o=t instanceof Ni.y?t:(0,Bf.of)(t);this.graphSubscription.add(o.subscribe(a=>{this.graph=a,this.tick()})),0!==this.graph.nodes.length&&o.pipe((0,M_.P)()).subscribe(()=>this.applyNodeDimensions())}tick(){const t=new Set;this.graph.nodes.map(l=>{l.transform=`translate(${l.position.x-l.dimension.width/2||0}, ${l.position.y-l.dimension.height/2||0})`,l.data||(l.data={}),l.data.color=this.colors.getColor(this.groupResultsBy(l)),t.add(l.id)});const o=new Set;(this.graph.clusters||[]).map(l=>{l.transform=`translate(${l.position.x-l.dimension.width/2||0}, ${l.position.y-l.dimension.height/2||0})`,l.data||(l.data={}),l.data.color=this.colors.getColor(this.groupResultsBy(l)),o.add(l.id)}),setTimeout(()=>{this.oldNodes=t,this.oldClusters=o},500);const a=[];for(const l in this.graph.edgeLabels){const _=this.graph.edgeLabels[l],C=l.replace(/[^\w-]*/g,""),N=this.layout&&"string"!=typeof this.layout&&this.layout.settings&&this.layout.settings.multigraph;let F=this._oldLinks.find(N?it=>`${it.source}${it.target}${it.id}`===C:it=>`${it.source}${it.target}`===C);const V=this.graph.edges.find(N?it=>`${it.source}${it.target}${it.id}`===C:it=>`${it.source}${it.target}`===C);F?F.data&&V&&V.data&&JSON.stringify(F.data)!==JSON.stringify(V.data)&&(F.data=V.data):F=V||_,F.oldLine=F.line;const ue=_.points,ce=this.generateLine(ue),Te=Object.assign({},F);Te.line=ce,Te.points=ue,this.updateMidpointOnEdge(Te,ue);const We=ue[Math.floor(ue.length/2)];We&&(Te.textTransform=`translate(${We.x||0},${We.y||0})`),Te.textAngle=0,Te.oldLine||(Te.oldLine=Te.line),this.calcDominantBaseline(Te),a.push(Te)}this.graph.edges=a,this.graph.edges&&(this._oldLinks=this.graph.edges.map(l=>{const _=Object.assign({},l);return _.oldLine=l.line,_})),this.updateMinimap(),this.autoZoom&&this.zoomToFit(),this.autoCenter&&this.center(),requestAnimationFrame(()=>this.redrawLines()),this.cd.markForCheck()}getMinimapTransform(){switch(this.miniMapPosition){case Uu.UpperLeft:return"";case Uu.UpperRight:return"translate("+(this.dims.width-this.graphDims.width/this.minimapScaleCoefficient)+",0)";default:return""}}updateGraphDims(){let t=1/0,o=-1/0,a=1/0,l=-1/0;for(let _=0;_<this.graph.nodes.length;_++){const C=this.graph.nodes[_];t=C.position.x<t?C.position.x:t,a=C.position.y<a?C.position.y:a,o=C.position.x+C.dimension.width>o?C.position.x+C.dimension.width:o,l=C.position.y+C.dimension.height>l?C.position.y+C.dimension.height:l}t-=100,a-=100,o+=100,l+=100,this.graphDims.width=o-t,this.graphDims.height=l-a,this.minimapOffsetX=t,this.minimapOffsetY=a}updateMinimap(){this.graph.nodes&&this.graph.nodes.length&&(this.updateGraphDims(),this.miniMapMaxWidth&&(this.minimapScaleCoefficient=this.graphDims.width/this.miniMapMaxWidth),this.miniMapMaxHeight&&(this.minimapScaleCoefficient=Math.max(this.minimapScaleCoefficient,this.graphDims.height/this.miniMapMaxHeight)),this.minimapTransform=this.getMinimapTransform())}applyNodeDimensions(){this.nodeElements&&this.nodeElements.length&&this.nodeElements.map(t=>{const o=t.nativeElement,a=this.graph.nodes.find(_=>_.id===o.id);if(!a)return;let l;try{if(l=o.getBBox(),!l.width||!l.height)return}catch{return}if(a.dimension.height=this.nodeHeight?a.dimension.height&&a.meta.forceDimensions?a.dimension.height:this.nodeHeight:a.dimension.height&&a.meta.forceDimensions?a.dimension.height:l.height,this.nodeMaxHeight&&(a.dimension.height=Math.max(a.dimension.height,this.nodeMaxHeight)),this.nodeMinHeight&&(a.dimension.height=Math.min(a.dimension.height,this.nodeMinHeight)),this.nodeWidth)a.dimension.width=a.dimension.width&&a.meta.forceDimensions?a.dimension.width:this.nodeWidth;else if(o.getElementsByTagName("text").length){let _;try{for(const C of o.getElementsByTagName("text")){const N=C.getBBox();_?(N.width>_.width&&(_.width=N.width),N.height>_.height&&(_.height=N.height)):_=N}}catch{return}a.dimension.width=a.dimension.width&&a.meta.forceDimensions?a.dimension.width:_.width+20}else a.dimension.width=a.dimension.width&&a.meta.forceDimensions?a.dimension.width:l.width;this.nodeMaxWidth&&(a.dimension.width=Math.max(a.dimension.width,this.nodeMaxWidth)),this.nodeMinWidth&&(a.dimension.width=Math.min(a.dimension.width,this.nodeMinWidth))})}redrawLines(t=this.animate){this.linkElements.map(o=>{const a=this.graph.edges.find(l=>l.id===o.nativeElement.id);a&&(Lc(o.nativeElement).select(".line").attr("d",a.oldLine).transition().ease(Dc).duration(t?500:0).attr("d",a.line),Lc(this.el.nativeElement).select(`#${a.id}`).attr("d",a.oldTextPath).transition().ease(Dc).duration(t?500:0).attr("d",a.textPath),this.updateMidpointOnEdge(a,a.points))})}calcDominantBaseline(t){const o=t.points[0],a=t.points[t.points.length-1];t.oldTextPath=t.textPath,a.x<o.x?(t.dominantBaseline="text-before-edge",t.textPath=this.generateLine([...t.points].reverse())):(t.dominantBaseline="text-after-edge",t.textPath=t.line)}generateLine(t){return function vu(){var i=Ht,n=rp,t=pa(!0),o=null,a=op,l=null;function _(C){var N,V,ce,F=C.length,ue=!1;for(null==o&&(l=a(ce=cc())),N=0;N<=F;++N)!(N<F&&t(V=C[N],N,C))===ue&&((ue=!ue)?l.lineStart():l.lineEnd()),ue&&l.point(+i(V,N,C),+n(V,N,C));if(ce)return l=null,ce+""||null}return _.x=function(C){return arguments.length?(i="function"==typeof C?C:pa(+C),_):i},_.y=function(C){return arguments.length?(n="function"==typeof C?C:pa(+C),_):n},_.defined=function(C){return arguments.length?(t="function"==typeof C?C:pa(!!C),_):t},_.curve=function(C){return arguments.length?(a=C,null!=o&&(l=a(o)),_):a},_.context=function(C){return arguments.length?(null==C?o=l=null:l=a(o=C),_):o},_}().x(a=>a.x).y(a=>a.y).curve(this.curve)(t)}onZoom(t,o){if(this.enableTrackpadSupport&&!t.ctrlKey)return void this.pan(-1*t.deltaX,-1*t.deltaY);const a=1+("in"===o?this.zoomSpeed:-this.zoomSpeed),l=this.zoomLevel*a;if(!(l<=this.minZoomLevel||l>=this.maxZoomLevel)&&this.enableZoom)if(!0===this.panOnZoom&&t){const _=t.clientX,C=t.clientY,N=this.el.nativeElement.querySelector("svg"),F=N.querySelector("g.chart"),V=N.createSVGPoint();V.x=_,V.y=C;const ue=V.matrixTransform(F.getScreenCTM().inverse());this.pan(ue.x,ue.y,!0),this.zoom(a),this.pan(-ue.x,-ue.y,!0)}else this.zoom(a)}pan(t,o,a=!1){const l=a?1:this.zoomLevel;this.transformationMatrix=gp(this.transformationMatrix,zr(t/l,o/l)),this.updateTransform()}panTo(t,o){null==t||isNaN(t)||null==o||isNaN(o)||(this.transformationMatrix=gp(this.transformationMatrix,zr((-this.panOffsetX-t*this.zoomLevel+this.dims.width/2)/this.zoomLevel,(-this.panOffsetY-o*this.zoomLevel+this.dims.height/2)/this.zoomLevel)),this.updateTransform())}zoom(t){this.transformationMatrix=gp(this.transformationMatrix,function tl(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return fp(n)&&(n=i),{a:i,c:0,e:0,b:0,d:n,f:0}}(t,t)),this.zoomChange.emit(this.zoomLevel),this.updateTransform()}zoomTo(t){this.transformationMatrix.a=isNaN(t)?this.transformationMatrix.a:Number(t),this.transformationMatrix.d=isNaN(t)?this.transformationMatrix.d:Number(t),this.zoomChange.emit(this.zoomLevel),this.updateTransform(),this.update()}onDrag(t){if(!this.draggingEnabled)return;const o=this.draggingNode;this.layout&&"string"!=typeof this.layout&&this.layout.onDrag&&this.layout.onDrag(o,t),o.position.x+=t.movementX/this.zoomLevel,o.position.y+=t.movementY/this.zoomLevel,o.transform=`translate(${o.position.x-o.dimension.width/2}, ${o.position.y-o.dimension.height/2})`;for(const _ of this.graph.edges)if((_.target===o.id||_.source===o.id||_.target.id===o.id||_.source.id===o.id)&&this.layout&&"string"!=typeof this.layout){const C=this.layout.updateEdge(this.graph,_),N=C instanceof Ni.y?C:(0,Bf.of)(C);this.graphSubscription.add(N.subscribe(F=>{this.graph=F,this.redrawEdge(_)}))}this.redrawLines(!1),this.updateMinimap()}redrawEdge(t){const o=this.generateLine(t.points);this.calcDominantBaseline(t),t.oldLine=t.line,t.line=o}updateTransform(){this.transform=function Qf(i){return function Kf(i){return"matrix("+i.a+","+i.b+","+i.c+","+i.d+","+i.e+","+i.f+")"}(i)}(function L_(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return{a:Math.round(i.a*n)/n,b:Math.round(i.b*n)/n,c:Math.round(i.c*n)/n,d:Math.round(i.d*n)/n,e:Math.round(i.e*n)/n,f:Math.round(i.f*n)/n}}(this.transformationMatrix,100))}onClick(t){this.select.emit(t)}onActivate(t){this.activeEntries.indexOf(t)>-1||(this.activeEntries=[t,...this.activeEntries],this.activate.emit({value:t,entries:this.activeEntries}))}onDeactivate(t){const o=this.activeEntries.indexOf(t);this.activeEntries.splice(o,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:t,entries:this.activeEntries})}getSeriesDomain(){return this.nodes.map(t=>this.groupResultsBy(t)).reduce((t,o)=>-1!==t.indexOf(o)?t:t.concat([o]),[]).sort()}trackLinkBy(t,o){return o.id}trackNodeBy(t,o){return o.id}setColors(){this.colors=new am(this.scheme,this.seriesDomain,this.customColors)}onMouseMove(t){this.isMouseMoveCalled=!0,(this.isPanning||this.isMinimapPanning)&&this.panningEnabled?this.panWithConstraints(this.panningAxis,t):this.isDragging&&this.draggingEnabled&&this.onDrag(t)}onMouseDown(t){this.isMouseMoveCalled=!1}graphClick(t){this.isMouseMoveCalled||this.clickHandler.emit(t)}onTouchStart(t){this._touchLastX=t.changedTouches[0].clientX,this._touchLastY=t.changedTouches[0].clientY,this.isPanning=!0}onTouchMove(t){if(this.isPanning&&this.panningEnabled){const o=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY,l=o-this._touchLastX,_=a-this._touchLastY;this._touchLastX=o,this._touchLastY=a,this.pan(l,_)}}onTouchEnd(t){this.isPanning=!1}onMouseUp(t){this.isDragging=!1,this.isPanning=!1,this.isMinimapPanning=!1,this.layout&&"string"!=typeof this.layout&&this.layout.onDragEnd&&this.layout.onDragEnd(this.draggingNode,t)}onNodeMouseDown(t,o){!this.draggingEnabled||(this.isDragging=!0,this.draggingNode=o,this.layout&&"string"!=typeof this.layout&&this.layout.onDragStart&&this.layout.onDragStart(o,t))}onMinimapDragMouseDown(){this.isMinimapPanning=!0}onMinimapPanTo(t){this.panTo((t.offsetX-(this.dims.width-(this.graphDims.width+this.minimapOffsetX)/this.minimapScaleCoefficient))*this.minimapScaleCoefficient,(t.offsetY+this.minimapOffsetY/this.minimapScaleCoefficient)*this.minimapScaleCoefficient),this.isMinimapPanning=!0}center(){this.panTo(this.graphDims.width/2,this.graphDims.height/2)}zoomToFit(){let a=Math.min(this.dims.height/this.graphDims.height,this.dims.width/this.graphDims.width,1);a<this.minZoomLevel&&(a=this.minZoomLevel),a>this.maxZoomLevel&&(a=this.maxZoomLevel),a!==this.zoomLevel&&(this.zoomLevel=a,this.updateTransform(),this.zoomChange.emit(this.zoomLevel))}panToNodeId(t){const o=this.graph.nodes.find(a=>a.id===t);!o||this.panTo(o.position.x,o.position.y)}panWithConstraints(t,o){let a=o.movementX,l=o.movementY;switch(this.isMinimapPanning&&(a=-this.minimapScaleCoefficient*a*this.zoomLevel,l=-this.minimapScaleCoefficient*l*this.zoomLevel),t){case Pi.Horizontal:this.pan(a,0);break;case Pi.Vertical:this.pan(0,l);break;default:this.pan(a,l)}}updateMidpointOnEdge(t,o){if(t&&o)if(o.length%2==1)t.midPoint=o[Math.floor(o.length/2)];else{const a=o[o.length/2],l=o[o.length/2-1];t.midPoint={x:(a.x+l.x)/2,y:(a.y+l.y)/2}}}basicUpdate(){if(this.view)this.width=this.view[0],this.height=this.view[1];else{const t=this.getContainerDims();t&&(this.width=t.width,this.height=t.height)}this.width||(this.width=600),this.height||(this.height=400),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this.cd&&this.cd.markForCheck()}getContainerDims(){let t,o;const a=this.el.nativeElement;if(null!==a.parentNode){const l=a.parentNode.getBoundingClientRect();t=l.width,o=l.height}return t&&o?{width:t,height:o}:null}unbindEvents(){this.resizeSubscription&&this.resizeSubscription.unsubscribe()}bindWindowResizeEvent(){const o=(0,Gf.R)(window,"resize").pipe((0,Xd.b)(200)).subscribe(a=>{this.update(),this.cd&&this.cd.markForCheck()});this.resizeSubscription=o}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(ao))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ngx-graph"]],contentQueries:function(t,o,a){if(1&t&&(e.Suo(a,dg,5),e.Suo(a,$_,5),e.Suo(a,W_,5),e.Suo(a,hg,5),e.Suo(a,fg,5)),2&t){let l;e.iGM(l=e.CRH())&&(o.linkTemplate=l.first),e.iGM(l=e.CRH())&&(o.nodeTemplate=l.first),e.iGM(l=e.CRH())&&(o.clusterTemplate=l.first),e.iGM(l=e.CRH())&&(o.defsTemplate=l.first),e.iGM(l=e.CRH())&&(o.miniMapNodeTemplate=l.first)}},viewQuery:function(t,o){if(1&t&&(e.Gf(Xp,5),e.Gf(gg,5)),2&t){let a;e.iGM(a=e.CRH())&&(o.nodeElements=a),e.iGM(a=e.CRH())&&(o.linkElements=a)}},hostBindings:function(t,o){1&t&&e.NdJ("mousemove",function(l){return o.onMouseMove(l)},!1,e.evT)("mousedown",function(l){return o.onMouseDown(l)},!1,e.evT)("click",function(l){return o.graphClick(l)},!1,e.evT)("touchmove",function(l){return o.onTouchMove(l)},!1,e.evT)("mouseup",function(l){return o.onMouseUp(l)},!1,e.evT)},inputs:{nodes:"nodes",clusters:"clusters",links:"links",activeEntries:"activeEntries",curve:"curve",draggingEnabled:"draggingEnabled",nodeHeight:"nodeHeight",nodeMaxHeight:"nodeMaxHeight",nodeMinHeight:"nodeMinHeight",nodeWidth:"nodeWidth",nodeMinWidth:"nodeMinWidth",nodeMaxWidth:"nodeMaxWidth",panningEnabled:"panningEnabled",panningAxis:"panningAxis",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",minZoomLevel:"minZoomLevel",maxZoomLevel:"maxZoomLevel",autoZoom:"autoZoom",panOnZoom:"panOnZoom",animate:"animate",autoCenter:"autoCenter",update$:"update$",center$:"center$",zoomToFit$:"zoomToFit$",panToNode$:"panToNode$",layout:"layout",layoutSettings:"layoutSettings",enableTrackpadSupport:"enableTrackpadSupport",showMiniMap:"showMiniMap",miniMapMaxWidth:"miniMapMaxWidth",miniMapMaxHeight:"miniMapMaxHeight",miniMapPosition:"miniMapPosition",view:"view",scheme:"scheme",customColors:"customColors",animations:"animations",groupResultsBy:"groupResultsBy",zoomLevel:"zoomLevel",panOffsetX:"panOffsetX",panOffsetY:"panOffsetY"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",zoomChange:"zoomChange",clickHandler:"clickHandler"},features:[e.TTD],ngContentSelectors:rm,decls:6,vars:11,consts:[["mouseWheel","",1,"ngx-charts-outer",3,"mouseWheelUp","mouseWheelDown"],[1,"ngx-charts"],["class","graph chart",3,"touchstart","touchend",4,"ngIf"],["class","minimap",4,"ngIf"],[1,"graph","chart",3,"touchstart","touchend"],[3,"ngTemplateOutlet",4,"ngIf"],["class","text-path",4,"ngFor","ngForOf"],[1,"panning-rect",3,"mousedown"],[1,"clusters"],["class","node-group",3,"old-node","id","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"links"],["class","link-group",3,"id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nodes"],["class","node-group",3,"old-node","id","click","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngTemplateOutlet"],[1,"text-path"],[1,"node-group",3,"id","click"],["clusterElement",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["class","node cluster",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"node","cluster"],["alignment-baseline","central"],[1,"link-group",3,"id"],["linkElement",""],["class","edge",4,"ngIf"],[1,"edge"],[1,"node-group",3,"id","click","mousedown"],["nodeElement",""],["r","10",4,"ngIf"],["r","10"],[1,"minimap"],[1,"minimap-background",3,"mousedown"],[1,"minimap-nodes"],["class","node-group",3,"old-node","id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"minimap-drag",3,"mousedown"],[1,"node-group",3,"id"]],template:function(t,o){1&t&&(e.F$t(),e.TgZ(0,"div",0),e.NdJ("mouseWheelUp",function(l){return o.onZoom(l,"in")})("mouseWheelDown",function(l){return o.onZoom(l,"out")}),e.O4$(),e.TgZ(1,"svg",1),e.YNc(2,yg,12,12,"g",2),e.TgZ(3,"clipPath"),e._UZ(4,"rect"),e.qZA(),e.YNc(5,lh,6,15,"g",3),e.qZA()()),2&t&&(e.Udp("width",o.width,"px"),e.Q6J("@animationState","active")("@.disabled",!o.animations),e.xp6(1),e.uIk("width",o.width)("height",o.height),e.xp6(1),e.Q6J("ngIf",o.initialized&&o.graph),e.xp6(1),e.uIk("id",o.minimapClipPathId),e.xp6(1),e.uIk("width",o.graphDims.width/o.minimapScaleCoefficient)("height",o.graphDims.height/o.minimapScaleCoefficient),e.xp6(1),e.Q6J("ngIf",o.showMiniMap))},dependencies:[wg,T.O5,T.tP,T.sg],styles:[".minimap .minimap-background{fill:#0000001a}.minimap .minimap-drag{fill:#0003;stroke:#fff;stroke-width:1px;stroke-dasharray:2px;stroke-dashoffset:2px;cursor:pointer}.minimap .minimap-drag.panning{fill:#0000004d}.minimap .minimap-nodes{opacity:.5;pointer-events:none}.graph{-webkit-user-select:none;user-select:none}.graph .edge{stroke:#666;fill:none}.graph .edge .edge-label{stroke:none;font-size:12px;fill:#251e1e}.graph .panning-rect{fill:#0000;cursor:move}.graph .node-group.old-node{transition:transform .5s ease-in-out}.graph .node-group .node:focus{outline:none}.graph .cluster rect{opacity:.2}\n"],encapsulation:2,data:{animation:[(0,Y.X$)("animationState",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms 100ms",(0,Y.oB)({opacity:1}))])])]},changeDetection:0}),(0,ci.gn)([qu(500)],i.prototype,"updateMinimap",null),i})(),Mg=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[ao],imports:[[T.ez]]}),i})(),Og=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[T.ez],Mg]}),i})();var xp=(()=>{return(i=xp||(xp={})).LEFT_TO_RIGHT="LR",i.RIGHT_TO_LEFT="RL",i.TOP_TO_BOTTOM="TB",i.BOTTOM_TO_TOM="BT",xp;var i})();class Qo{constructor(){this.defaultSettings={orientation:xp.LEFT_TO_RIGHT,marginX:0,marginY:0,edgePadding:au.PADDING.BETWEEN_NODES,rankPadding:100,nodePadding:au.PADDING.BETWEEN_NODES,curveDistance:0,multigraph:!1,compound:!0},this.settings={}}run(n){this.createDagreGraph(n),fc.layout(this.dagreGraph),n.edgeLabels=this.dagreGraph._edgeLabels;for(const t in this.dagreGraph._nodes){const o=this.dagreGraph._nodes[t],a=n.nodes.find(l=>l.id===o.id);a.position={x:o.x,y:o.y},a.dimension={width:o.width,height:o.height}}for(const t of n.edges)this.updateEdge(n,t);return n}updateEdge(n,t){const o=n.nodes.find(We=>We.id===t.source),a=n.nodes.find(We=>We.id===t.target),l="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",_="y"===l?"x":"y",C="y"===l?"height":"width",N=o.position[l]<=a.position[l]?-1:1,F={[_]:o.position[_],[l]:o.position[l]-N*(o.dimension[C]/2)},V={[_]:a.position[_],[l]:a.position[l]+N*(a.dimension[C]/2)};t.points=[F,{[l]:o.position[l]+(a.position[l]-o.position[l])/2,[_]:F[_]},{[_]:V[_],[l]:o.position[l]+(a.position[l]-o.position[l])/2},V];const Te=n.edgeLabels[`${t.source}\x01${t.target}\x01\0`];return Te&&(Te.points=t.points),n}createDagreGraph(n){const t=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new fc.graphlib.Graph({compound:t.compound,multigraph:t.multigraph}),this.dagreGraph.setGraph({rankdir:t.orientation,marginx:t.marginX,marginy:t.marginY,edgesep:t.edgePadding,ranksep:t.rankPadding,nodesep:t.nodePadding,align:t.align,acyclicer:t.acyclicer,ranker:t.ranker,multigraph:t.multigraph,compound:t.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=n.nodes.map(o=>{const a=Object.assign({},o);return a.width=o.dimension.width,a.height=o.dimension.height,a.x=o.position.x,a.y=o.position.y,a}),this.dagreEdges=n.edges.map(o=>{let a=1;const l=Object.assign({},o);return l.id||(l.id=a,a++),l});for(const o of this.dagreNodes)o.width||(o.width=20),o.height||(o.height=30),this.dagreGraph.setNode(o.id,o);for(const o of this.dagreEdges)t.multigraph?this.dagreGraph.setEdge(o.source,o.target,o,o.id):this.dagreGraph.setEdge(o.source,o.target);return this.dagreGraph}}function ju(i){this._context=i}function ql(i){return new ju(i)}ju.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(i,n){switch(i=+i,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,n):this._context.moveTo(i,n);break;case 1:this._point=2;default:this._context.lineTo(i,n)}}};var Er=(()=>{return(i=Er||(Er={})).CREATEGEOOBJECTACTION="CreateGeoObjectAction",i.UPDATEATTRIBUTETACTION="UpdateAttributeAction",i.UPDATEGEOOBJECTACTION="UpdateGeoObjectAction",Er;var i})(),Dr=(()=>{return(i=Dr||(Dr={})).PENDING="PENDING",i.ACCEPTED="ACCEPTED",i.REJECTED="REJECTED",Dr;var i})(),ko=(()=>{return(i=ko||(ko={})).manageAttributes="MANAGE-ATTRIBUTES",i.editAttribute="EDIT-ATTRIBUTE",i.defineAttribute="DEFINE-ATTRIBUTE",i.manageTermOption="MANAGE-TERM-OPTION",i.editTermOption="EDIT-TERM-OPTION",i.manageGeoObjectType="MANAGE-GEO-OBJECT-TYPE",ko;var i})(),$a=(()=>{return(i=$a||($a={})).NEW_AND_UPDATE="NEW_AND_UPDATE",i.NEW_ONLY="NEW_ONLY",i.UPDATE_ONLY="UPDATE_ONLY",$a;var i})(),Fo=(()=>{return(i=Fo||(Fo={})).END_DATE="endDate",i.START_DATE="startDate",i.VALUE="value",i.REMOVE="remove",i.ADD="add",Fo;var i})();var nl,bl=v(51557),sr=v(69898),ot=v(80529),Pg=new Uint8Array(16);function r(){if(!nl&&!(nl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return nl(Pg)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,f=function c(i){return"string"==typeof i&&s.test(i)};for(var m=[],b=0;b<256;++b)m.push((b+256).toString(16).substr(1));const G=function j(i,n,t){var o=(i=i||{}).random||(i.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){t=t||0;for(var a=0;a<16;++a)n[t+a]=o[a];return n}return function O(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(m[i[n+0]]+m[i[n+1]]+m[i[n+2]]+m[i[n+3]]+"-"+m[i[n+4]]+m[i[n+5]]+"-"+m[i[n+6]]+m[i[n+7]]+"-"+m[i[n+8]]+m[i[n+9]]+"-"+m[i[n+10]]+m[i[n+11]]+m[i[n+12]]+m[i[n+13]]+m[i[n+14]]+m[i[n+15]]).toLowerCase();if(!f(t))throw TypeError("Stringified UUID is invalid");return t}(o)};function Me(i,n,t){if(!function Xi(i){return!!i&&i.constructor===Object}(t=t||{}))throw new Error("options is invalid");var o=t.bbox,a=t.id;if(void 0===i)throw new Error("geometry is required");if(n&&n.constructor!==Object)throw new Error("properties must be an Object");o&&function ho(i){if(!i)throw new Error("bbox is required");if(!Array.isArray(i))throw new Error("bbox must be an Array");if(4!==i.length&&6!==i.length)throw new Error("bbox must be an Array of 4 or 6 numbers");i.forEach(function(n){if(!si(n))throw new Error("bbox must only contain numbers")})}(o),a&&function fo(i){if(!i)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof i))throw new Error("id must be a number or a string")}(a);var l={type:"Feature"};return a&&(l.id=a),o&&(l.bbox=o),l.properties=n||{},l.geometry=i,l}function si(i){return!isNaN(i)&&null!==i&&!Array.isArray(i)}function _o(i,n,t){if(null!==i)for(var o,a,l,_,C,N,F,ce,V=0,ue=0,Te=i.type,We="FeatureCollection"===Te,it="Feature"===Te,He=We?i.features.length:1,et=0;et<He;et++){C=(ce=!!(F=We?i.features[et].geometry:it?i.geometry:i)&&"GeometryCollection"===F.type)?F.geometries.length:1;for(var xt=0;xt<C;xt++){var bt=0,vt=0;if(null!==(_=ce?F.geometries[xt]:F)){N=_.coordinates;var Vt=_.type;switch(V=!t||"Polygon"!==Vt&&"MultiPolygon"!==Vt?0:1,Vt){case null:break;case"Point":n(N,ue,et,bt,vt),ue++,bt++;break;case"LineString":case"MultiPoint":for(o=0;o<N.length;o++)n(N[o],ue,et,bt,vt),ue++,"MultiPoint"===Vt&&bt++;"LineString"===Vt&&bt++;break;case"Polygon":case"MultiLineString":for(o=0;o<N.length;o++){for(a=0;a<N[o].length-V;a++)n(N[o][a],ue,et,bt,vt),ue++;"MultiLineString"===Vt&&bt++,"Polygon"===Vt&&vt++}"Polygon"===Vt&&bt++;break;case"MultiPolygon":for(o=0;o<N.length;o++){for("MultiPolygon"===Vt&&(vt=0),a=0;a<N[o].length;a++){for(l=0;l<N[o][a].length-V;l++)n(N[o][a][l],ue,et,bt,vt),ue++;vt++}bt++}break;case"GeometryCollection":for(o=0;o<_.geometries.length;o++)_o(_.geometries[o],n,t);break;default:throw new Error("Unknown Geometry Type")}}}}}const _s=function Zo(i){var n=[1/0,1/0,-1/0,-1/0];return _o(i,function(t){n[0]>t[0]&&(n[0]=t[0]),n[1]>t[1]&&(n[1]=t[1]),n[2]<t[0]&&(n[2]=t[0]),n[3]<t[1]&&(n[3]=t[1])}),n};var La=v(18527);class Bl{constructor(n,t){this.layers=n,this.label=t}getGroupName(){return this.groupName}setGroupName(n){this.groupName=n}getLayers(){return this.layers}setLayers(n){this.layers=n}getLabel(){return this.label}setLabel(n){this.label=n}}class _c{constructor(n){this.localService=n}getLayerGroups(n){let t=[];return t.push(new Bl(n.filter(o=>o.dataSource instanceof za),this.localService.decode("explorer.layerPanel.layerGroup.search"))),t.push(new Bl(n.filter(o=>o.dataSource instanceof Zs||o.dataSource instanceof Cc),this.localService.decode("explorer.layerPanel.layerGroup.geoObject"))),t.push(new Bl(n.filter(o=>o.dataSource instanceof na),this.localService.decode("explorer.layerPanel.layerGroup.relationship"))),t.push(new Bl(n.filter(o=>o.dataSource instanceof xc),this.localService.decode("explorer.layerPanel.layerGroup.list"))),t.filter(o=>o.getLayers().length>0)}sortLayers(n){let t=[];return this.getLayerGroups(n).forEach(a=>a.getLayers().forEach(l=>t.push(l))),t}}class Is{constructor(n,t,o,a,l){this.type=n,this.newLayer=t,this.newLayerIndex=o,this.oldLayer=a,this.oldLayerIndex=l}equals(n){return n instanceof Is&&this.type===n.type&&this.newLayerIndex===n.newLayerIndex&&this.oldLayerIndex===n.oldLayerIndex&&(null==this.newLayer&&null==n.newLayer||null!=this.newLayer&&null!=n.newLayer&&this.newLayer.getId()===n.newLayer.getId())&&(null==this.oldLayer&&null==n.oldLayer||null!=this.oldLayer&&null!=n.oldLayer&&this.oldLayer.getId()===n.oldLayer.getId())}}class xl{constructor(n,t){this.diffs=[],this.newLayers=n,this.oldLayers=t,this.calculateDiffs()}getDiffs(){return this.diffs}calculateDiffs(){this.diffs=[];let n=Math.max(this.newLayers.length,this.oldLayers.length);for(let t=0;t<n;++t){let o=null,a=null,l=-1,_=-1;t<this.newLayers.length&&(o=this.newLayers[t],l=t,_=this.oldLayers.findIndex(C=>C.getId()===o.getId()),-1!==_&&(a=this.oldLayers[_]),this.diffLayers(o,l,a,_)),o=null,a=null,l=-1,_=-1,t<this.oldLayers.length&&(a=this.oldLayers[t],_=t,l=this.newLayers.findIndex(C=>C.getId()===a.getId()),-1!==l&&(o=this.newLayers[l]),this.diffLayers(o,l,a,_))}}addDiff(n){-1===this.diffs.findIndex(t=>t.equals(n))&&this.diffs.push(n)}diffLayers(n,t,o,a){null!=n&&null!=o?(t!==a&&this.addDiff(new Is("LAYER_REORDER",n,t,o,a)),n.rendered!==o.rendered&&this.addDiff(new Is("RENDERED_CHANGE",n,t,o,a)),n.color!==o.color&&this.addDiff(new Is("COLOR_CHANGE",n,t,o,a))):null!=n&&null==o?this.addDiff(new Is("NEW_LAYER",n,t,o,a)):null==n&&null!=o&&this.addDiff(new Is("REMOVE_LAYER",n,t,o,a))}}function Bu(i,n,t){var o,a,l;void 0===n&&(n=50),void 0===t&&(t={});var _=null!=(o=t.isImmediate)&&o,C=null!=(a=t.callback)&&a,N=t.maxWait,F=Date.now(),V=[];function ue(){if(void 0!==N){var Te=Date.now()-F;if(Te+n>=N)return N-Te}return n}var ce=function(){var Te=[].slice.call(arguments),We=this;return new Promise(function(it,He){var et=_&&void 0===l;if(void 0!==l&&clearTimeout(l),l=setTimeout(function(){if(l=void 0,F=Date.now(),!_){var bt=i.apply(We,Te);C&&C(bt),V.forEach(function(vt){return(0,vt.resolve)(bt)}),V=[]}},ue()),et){var xt=i.apply(We,Te);return C&&C(xt),it(xt)}V.push({resolve:it,reject:He})})};return ce.cancel=function(Te){void 0!==l&&clearTimeout(l),V.forEach(function(We){return(0,We.reject)(Te)}),V=[]},ce}var Bt=v(28746),pt=v(92340),nn=v(44728);class Zi{constructor(n,t){this.http=n,this.eventService=t}init(){return this.http.get(pt.N.apiUrl+"/api/cgr/init").toPromise()}getGeoObjectTypes(n){let t=new ot.LE;return null!=n&&(t=t.set("types",JSON.stringify(n))),this.http.get(pt.N.apiUrl+"/api/geoobjecttype/get-all",{params:t}).toPromise()}getParentGeoObjects(n,t,o,a,l){let _=new ot.LE;return _=_.set("childCode",n),_=_.set("childTypeCode",t),_=_.set("parentTypes",JSON.stringify(o)),_=_.set("recursive",JSON.stringify(a)),null!=l&&(_=_.set("date",l)),this.http.get(pt.N.apiUrl+"/api/geoobject/get-parent-geoobjects",{params:_}).toPromise()}getChildGeoObjects(n,t,o,a){let l=new ot.LE;return l=l.set("parentCode",n),l=l.set("parentTypeCode",t),l=l.set("childrenTypes",JSON.stringify(o)),l=l.set("recursive",JSON.stringify(a)),this.http.get(pt.N.apiUrl+"/api/geoobject/getchildren",{params:l}).toPromise()}doesGeoObjectExistAtRange(n,t,o,a){let l=new ot.LE;return l=l.set("startDate",n),l=l.set("endDate",t),l=l.set("typeCode",o),l=l.set("code",a),this.http.get(pt.N.apiUrl+"/api/geoobject/exists-at-range",{params:l}).toPromise()}newGeoObjectInstance(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobject/newGeoObjectInstance",JSON.stringify({typeCode:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}createGeoObjectType(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/create",JSON.stringify({gtJSON:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}updateGeoObjectType(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/update",JSON.stringify({gtJSON:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteGeoObjectType(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/delete",JSON.stringify({code:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}addAttributeType(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/addattribute",JSON.stringify({geoObjTypeCode:n,attributeType:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}updateAttributeType(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/updateattribute",JSON.stringify({geoObjTypeCode:n,attributeType:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteAttributeType(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/deleteattribute",JSON.stringify({geoObjTypeId:n,attributeName:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}addAttributeTermTypeOption(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/addterm",JSON.stringify({parentTermCode:n,termJSON:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}updateAttributeTermTypeOption(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/updateterm",JSON.stringify({parentTermCode:n,termJSON:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteAttributeTermTypeOption(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobjecttype/deleteterm",JSON.stringify({parentTermCode:n,termCode:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getGeoObject(n,t,o=!0){let a=new ot.LE;return a=a.set("id",n),a=a.set("typeCode",t),o&&this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/geoobject/get",{params:a}).pipe((0,Bt.x)(()=>{o&&this.eventService.complete()})).toPromise()}getGeoObjectBounds(n,t){let o=new ot.LE;return o=o.set("code",n),o=o.set("typeCode",t),this.http.get(pt.N.apiUrl+"/api/geoobject/get-bounds",{params:o}).toPromise()}getGeoObjectBoundsAtDate(n,t,o){let a=new ot.LE;return a=a.set("code",n),a=a.set("typeCode",t),null!=o&&(a=a.set("date",o)),this.http.get(pt.N.apiUrl+"/api/geoobject-time/get-bounds",{params:a}).toPromise()}getGeoObjectByCode(n,t){let o=new ot.LE;return o=o.set("code",n),o=o.set("typeCode",t),this.http.get(pt.N.apiUrl+"/api/geoobject/get-code",{params:o}).toPromise()}getHierarchiesForGeoObject(n,t,o=!0){let a=new ot.LE;return a=a.set("code",n),a=a.set("typeCode",t),o&&this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/geoobject/get-hierarchies-over-time",{params:a}).pipe((0,Bt.x)(()=>{o&&this.eventService.complete()})).toPromise()}getGeoObjectSuggestions(n,t,o,a,l,_,C){let N=new ot.LE;return N=N.set("text",n),N=N.set("type",t),null!=o&&null!=l&&(N=N.set("parent",o),N=N.set("hierarchy",l)),null!=a&&(N=N.set("parentTypeCode",a)),null!=_&&null!=C&&(N=N.set("startDate",_),N=N.set("endDate",C)),this.http.get(pt.N.apiUrl+"/api/geoobject/suggestions",{params:N}).toPromise()}getGeoObjectSuggestionsTypeAhead(n,t){let o=new ot.LE;return o=o.set("text",n),o=o.set("type",t),this.http.get(pt.N.apiUrl+"/api/geoobject/suggestions",{params:o}).toPromise()}getScheduledJobs(n,t,o,a){let l=new ot.LE;return l=l.set("pageSize",n.toString()),l=l.set("pageNumber",t.toString()),l=l.set("sortAttr",o),l=l.set("isAscending",a.toString()),this.http.get(pt.N.apiUrl+"/api/etl/get-active",{params:l}).toPromise()}getCompletedScheduledJobs(n,t,o,a){let l=new ot.LE;return l=l.set("pageSize",n.toString()),l=l.set("pageNumber",t.toString()),l=l.set("sortAttr",o),l=l.set("isAscending",a.toString()),this.http.get(pt.N.apiUrl+"/api/etl/get-completed",{params:l}).toPromise()}getScheduledJob(n,t,o,a){let l=new ot.LE;return l=l.set("historyId",n),l=l.set("pageSize",t.toString()),l=l.set("pageNumber",o.toString()),l=l.set("onlyUnresolved",a.toString()),this.http.get(pt.N.apiUrl+"/api/etl/get-import-details",{params:l}).toPromise()}getExportDetails(n,t,o){let a=new ot.LE;return a=a.set("historyId",n),a=a.set("pageSize",t.toString()),a=a.set("pageNumber",o.toString()),this.http.get(pt.N.apiUrl+"/api/etl/get-export-details",{params:a}).toPromise()}resolveScheduledJob(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/etl/import-resolve",JSON.stringify({historyId:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}submitValidationResolve(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/etl/validation-resolve",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}submitErrorResolve(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/etl/error-resolve",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getLocales(){let n=new ot.LE;return this.http.get(pt.N.apiUrl+"/api/localization/get-locales",{params:n}).toPromise()}getGeoObjectOverTime(n,t){let o=new ot.LE;return o=o.set("code",n),o=o.set("typeCode",t),this.http.get(pt.N.apiUrl+"/api/geoobject-time/get-code",{params:o}).toPromise()}newGeoObjectOverTime(n,t=!0){let o=new ot.WM({"Content-Type":"application/json"});return t&&this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobject-time/newGeoObjectInstance",JSON.stringify({typeCode:n}),{headers:o}).pipe((0,Bt.x)(()=>{t&&this.eventService.complete()})).toPromise()}applyGeoObjectEdit(n,t,o,a,l,_=!0){let C=new ot.WM({"Content-Type":"application/json"}),N={geoObjectCode:n,geoObjectTypeCode:t,actions:o};return null!=a&&(N.masterListId=a),null!=l&&(N.notes=l),_&&this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobject-editor/update-geo-object",JSON.stringify(N),{headers:C}).pipe((0,Bt.x)(()=>{_&&this.eventService.complete()})).toPromise()}applyGeoObjectCreate(n,t,o,a,l,_=!0){let C=new ot.WM({"Content-Type":"application/json"});for(const F in t.attributes){let V=t.attributes[F];"date"===V.type&&V.values.forEach(ue=>{ue.value=new Date(ue.value).getTime().toString()})}let N={geoObject:t,isNew:o,masterListId:a};return null!=n&&(N.parentTreeNode=n),null!=l&&(N.notes=l),_&&this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/geoobject-editor/create-geo-object",JSON.stringify(N),{headers:C}).pipe((0,Bt.x)(()=>{_&&this.eventService.complete()})).toPromise()}progress(n){let t=new ot.LE;return t=t.set("oid",n),this.http.get(pt.N.apiUrl+"/master-list/progress",{params:t}).toPromise()}getDatasetBounds(n){let t=new ot.LE;return t=t.set("oid",n),this.http.get(pt.N.apiUrl+"/master-list/bounds",{params:t}).toPromise()}getOrganizations(){return this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/organization/get-all").pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}}Zi.\u0275fac=function(n){return new(n||Zi)(e.LFG(ot.eN),e.LFG(nn.PO))},Zi.\u0275prov=e.Yz7({token:Zi,factory:Zi.\u0275fac});class Xa{constructor(n,t,o){this.http=n,this.eventService=t,this.route=o}tree(n,t,o,a,l){let _=new ot.LE;return _=_.set("sourceVertex",JSON.stringify(o)),null!=n&&(_=_.set("relationshipType",n)),null!=t&&(_=_.set("graphTypeCode",t)),a&&(_=_.set("date",a)),l&&(_=_.set("boundsWKT",l)),this.http.get(pt.N.apiUrl+"/api/relationship-visualization/tree",{params:_}).pipe((0,Bt.x)(()=>{})).toPromise()}treeAsGeoJson(n,t,o,a,l){let _=new ot.LE;return _=_.set("sourceVertex",JSON.stringify(o)),_=_.set("graphTypeCode",t),null!=n&&(_=_.set("relationshipType",n)),a&&(_=_.set("date",a)),l&&(_=_.set("boundsWKT",l)),this.http.get(pt.N.apiUrl+"/api/relationship-visualization/treeAsGeoJson",{params:_}).pipe((0,Bt.x)(()=>{})).toPromise()}relationships(n,t){let o=new ot.LE;return o=o.set("objectType",n),o=o.set("typeCode",t),this.http.get(pt.N.apiUrl+"/api/relationship-visualization/relationships",{params:o}).pipe((0,Bt.x)(()=>{})).toPromise()}}Xa.\u0275fac=function(n){return new(n||Xa)(e.LFG(ot.eN),e.LFG(nn.PO),e.LFG(w.gz))},Xa.\u0275prov=e.Yz7({token:Xa,factory:Xa.\u0275fac});var mc=v(83905),Wc=v(69661);class ys{constructor(n,t,o){this.configuration=n,this.http=t,this.eventService=o,sr.accessToken=n.getMapboxAccessToken()}roots(n,t,o){let a=new ot.LE;return null!=n&&(a=a.set("typeCode",n)),null!=t&&(a=a.set("hierarchyCode",t)),null!=o&&(a=a.set("date",o)),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/registrylocation/roots",{params:a}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}search(n,t,o=!0){let a=new ot.LE;return a=a.set("text",n),null!=t&&(a=a.set("date",t)),o&&this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/registrylocation/search",{params:a}).pipe((0,Bt.x)(()=>{o&&this.eventService.complete()})).toPromise()}labels(n,t,o=!0){let a=new ot.LE;return a=a.set("text",n),null!=t&&(a=a.set("date",t)),o&&this.eventService.start(),(0,mc.z)(this.http.get(pt.N.apiUrl+"/api/registrylocation/labels",{params:a}).pipe((0,Bt.x)(()=>{o&&this.eventService.complete()})))}}ys.\u0275fac=function(n){return new(n||ys)(e.LFG(Wc.e),e.LFG(ot.eN),e.LFG(nn.PO))},ys.\u0275prov=e.Yz7({token:ys,factory:ys.\u0275fac});class Uo{constructor(n,t){this.http=n,this.eventService=t}listForType(n){let t=new ot.LE;return t=t.set("typeCode",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/list-type/list-for-type",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}entries(n){let t=new ot.LE;return t=t.set("oid",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/list-type/entries",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}versions(n){let t=new ot.LE;return t=t.set("oid",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/list-type/versions",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getVersion(n){let t=new ot.LE;return t=t.set("oid",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/list-type/version",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}fetchVersionsAsListVersion(n){let t=new ot.LE;return t=t.set("oids",n.join(",")),this.http.get(pt.N.apiUrl+"/api/list-type/fetchVersionsAsListVersion",{params:t}).pipe((0,Bt.x)(()=>{})).toPromise()}apply(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/list-type/apply",JSON.stringify({list:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}createEntries(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/list-type/create-entries",JSON.stringify({oid:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}remove(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/list-type/remove",JSON.stringify({oid:n.oid}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}createVersion(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/list-type/create-version",JSON.stringify({oid:n.oid,metadata:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}applyVersion(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/list-type/apply-version",JSON.stringify({oid:n.oid,metadata:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}removeVersion(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/list-type/remove-version",JSON.stringify({oid:n.oid}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}page(n,t){let o=new ot.LE;return o=o.set("oid",t.oid),o=o.set("showInvalid",t.showInvalid),o=o.set("criteria",JSON.stringify(n)),this.http.get(pt.N.apiUrl+"/api/list-type/data",{params:o}).toPromise()}record(n,t,o=!0){let a=new ot.LE;return a=a.set("oid",n),a=a.set("uid",t),o&&this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/list-type/record",{params:a}).pipe((0,Bt.x)(()=>{o&&this.eventService.complete()})).toPromise()}values(n,t,o,a){let l=new ot.LE;return l=l.set("oid",n),l=l.set("attributeName",o),null!=a&&(l=l.set("criteria",JSON.stringify({filters:a}))),null!=t&&t.length>0&&(l=l.set("value",t)),this.http.get(pt.N.apiUrl+"/api/list-type/values",{params:l}).toPromise()}publishList(n){let t=new ot.WM({"Content-Type":"application/json"});return this.http.post(pt.N.apiUrl+"/api/list-type/publish",JSON.stringify({oid:n}),{headers:t})}getAllLists(){let n=new ot.LE;return this.http.get(pt.N.apiUrl+"/api/list-type/list-all",{params:n}).toPromise()}getPublicVersions(n){let t=new ot.LE;return t=t.append("oid",n),this.http.get(pt.N.apiUrl+"/api/list-type/get-public-versions",{params:t}).toPromise()}getGeospatialVersions(n,t){let o=new ot.LE;return null!=n&&n.length>0&&(o=o.append("startDate",n)),null!=t&&t.length>0&&(o=o.append("endDate",t)),this.http.get(pt.N.apiUrl+"/api/list-type/get-geospatial-versions",{params:o}).toPromise()}getBounds(n,t){let o=new ot.LE;return o=o.append("oid",n),null!=t&&(o=o.append("uid",t)),this.http.get(pt.N.apiUrl+"/api/list-type/bounds",{params:o}).toPromise()}getCurationInfo(n,t,o,a){let l=new ot.LE;return l=l.set("historyId",n.curation.curationId),l=l.set("onlyUnresolved",t.toString()),l=l.set("pageSize",a.toString()),l=l.set("pageNumber",o.toString()),this.http.get(pt.N.apiUrl+"/api/curation/details",{params:l}).toPromise()}getCurationPage(n,t,o,a){let l=new ot.LE;return l=l.set("historyId",n.curation.curationId),l=l.set("onlyUnresolved",t.toString()),l=l.set("pageSize",a.toString()),l=l.set("pageNumber",o.toString()),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/curation/page",{params:l}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}createCurationJob(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/curation/curate",JSON.stringify({listTypeVersionId:n.oid}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}submitErrorResolve(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/curation/problem-resolve",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}setResolution(n,t){let o=new ot.WM({"Content-Type":"application/json"});const a={problemId:n.id};return null!=t&&(a.resolution=t),this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/curation/set-resolution",JSON.stringify(a),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getJob(n){let t=new ot.LE;return t=t.append("historyOid",n),this.http.get(pt.N.apiUrl+"/api/list-type/get-publish-job",{params:t}).toPromise()}}Uo.\u0275fac=function(n){return new(n||Uo)(e.LFG(ot.eN),e.LFG(nn.PO))},Uo.\u0275prov=e.Yz7({token:Uo,factory:Uo.\u0275fac});var mo=v(3722);const yc="#800000",vc="search";class vo{constructor(n,t,o,a,l,_,C){this.route=n,this.router=t,this.registryService=o,this.relVizService=a,this.mapService=l,this.listService=_,this.localService=C,this.layers=[],this.currentMapState=[],this.editingControl=null,this.simpleEditControl=null,this._zoomOnReady=[],this.isZooming=!1,this.geometryChange=new e.vpe,this.layersChange=new e.vpe,this.syncWithUrlParams=!1,this.state={attrPanelOpen:!0},this.dataSourceFactory=new Yl(this,this.registryService,this.relVizService,this.mapService,this.listService),this.layerSorter=new _c(this.localService),this.syncMapState=Bu(this._syncMapState,50),this.stateChange$=new e.vpe,this.setState=Bu(this._setState,50)}initialize(n,t,o){this.syncWithUrlParams=o,this.map=n,this.geometryType=t,o&&(this.urlSub=this.route.queryParams.subscribe(a=>{try{let l=JSON.parse(JSON.stringify(a));l.graphPanelOpen="true"===l.graphPanelOpen,l.attrPanelOpen="true"===l.attrPanelOpen||void 0===l.attrPanelOpen,this.stateChange(l)}catch(l){console.log(l)}})),this.map.on("style.load",()=>{}),this.map.on("draw.create",()=>{this.saveEdits()}),this.map.on("draw.delete",()=>{this.saveEdits()}),this.map.on("draw.update",()=>{this.saveEdits()}),this.map.on("zoomstart",()=>{this.isZooming=!0}),this.map.on("zoomend",()=>{this.isZooming=!1}),window.onbeforeunload=()=>this.destroy(),this.syncMapState()}ngOnDestroy(){this.urlSub&&this.urlSub.unsubscribe()}serializeLayers(n){let t;t=null!=this.layerSorter?this.layerSorter.sortLayers(n):n;let o=this.dataSourceFactory.serializeLayers(t);return JSON.stringify(o)}deserializeLayers(n){return this.dataSourceFactory.deserializeLayers(JSON.parse(n))}getState(){return this.state}_setState(n,t){Object.assign(this.state,n),this.router.navigate([],{relativeTo:this.route,queryParams:JSON.parse(JSON.stringify(this.state)),queryParamsHandling:"merge",replaceUrl:!t})}stateChange(n){if(this.state=n,null!=this.state){if(null!=this.state.layers){let t=JSON.parse(this.state.layers),o=this.layers,a=this.dataSourceFactory.deserializeLayers(t);this.layers=null!=this.layerSorter?this.layerSorter.sortLayers(a):a,new xl(this.layers,o).getDiffs().length>0&&this.layersChange.emit(this.getLayers()),this.syncMapState()}this.stateChange$.emit(JSON.parse(JSON.stringify(this.state)))}}_syncMapState(){if(this.map){let t=new xl(this.layers,this.currentMapState).getDiffs(),o=t.length>0||this.layers.length!==this.currentMapState.length;if(1!==t.length||"RENDERED_CHANGE"!==t[0].type&&"COLOR_CHANGE"!==t[0].type){if(1===t.filter(a=>"NEW_LAYER"===a.type).length&&0===t.filter(a=>"NEW_LAYER"!==a.type&&"LAYER_REORDER"!==a.type).length&&this.layers.length===this.currentMapState.length+1){const a=t.filter(_=>"NEW_LAYER"===_.type)[0];let l=null;if(a.newLayerIndex>0)for(let _=0;_<a.newLayerIndex;++_)l=this.currentMapState[_];this.mapboxMapLayer(this.layers[a.newLayerIndex],l),o=!1}else if(1===t.filter(a=>"REMOVE_LAYER"===a.type).length&&0===t.filter(a=>"REMOVE_LAYER"!==a.type&&"LAYER_REORDER"!==a.type).length&&this.layers.length===this.currentMapState.length-1){const a=t.filter(l=>"REMOVE_LAYER"===l.type)[0];this.mapboxUnmapLayer(a.oldLayer),o=!1}else if(t.length>0&&this.layers.length===this.currentMapState.length&&0===t.filter(a=>"LAYER_REORDER"!==a.type).length){this.currentMapState=this.layers;for(let a=this.currentMapState.length-1;a>-1;a--){const l=this.currentMapState[a];this.map.getLayer(l.getId()+"-POLYGON")&&this.map.moveLayer(l.getId()+"-POLYGON"),this.map.getLayer(l.getId()+"-POINT")&&this.map.moveLayer(l.getId()+"-POINT"),this.map.getLayer(l.getId()+"-LINE")&&this.map.moveLayer(l.getId()+"-LINE"),this.map.getLayer(l.getId()+"-LABEL")&&this.map.moveLayer(l.getId()+"-LABEL")}o=!1}else if(2===t.length&&1===t.filter(a=>"REMOVE_LAYER"===a.type).length&&1===t.filter(a=>"NEW_LAYER"===a.type).length&&this.layers.length===this.currentMapState.length&&0===t.filter(a=>"REMOVE_LAYER"!==a.type&&"NEW_LAYER"!==a.type).length){const a=t.filter(_=>"NEW_LAYER"===_.type)[0],l=t.filter(_=>"REMOVE_LAYER"===_.type)[0];if(null!=l.oldLayer&&null!=a.newLayer){this.mapboxUnmapLayer(l.oldLayer);let _=null;if(a.newLayerIndex>0)for(let C=0;C<a.newLayerIndex;++C)_=this.currentMapState[C];this.mapboxMapLayer(a.newLayer,_),o=!1}}}else{const a=t[0];let l=null;if(a.oldLayerIndex>0)for(let _=0;_<a.oldLayerIndex;++_)l=this.currentMapState[_];"RENDERED_CHANGE"===a.type?a.newLayer.rendered?this.mapboxShowLayer(a.newLayer):this.mapboxHideLayer(a.oldLayer):"COLOR_CHANGE"===a.type&&(this.mapboxUnmapLayer(a.oldLayer),this.mapboxMapLayer(a.newLayer,l)),o=!1}if(o?(this.unmapAllLayers(),this.currentMapState=this.layers,this.mapAllLayers()):this.currentMapState=this.layers,null!=this._zoomOnReady&&this._zoomOnReady.length>0&&!this.isZooming)for(let a=0;a<this._zoomOnReady.length;++a){let l=this._zoomOnReady[a],_=this.layers.findIndex(C=>C.getId()===l);if(-1!==_){let C=this.layers[_];this.zoomToLayer(C),this._zoomOnReady.splice(this._zoomOnReady.indexOf(C.getId()),1);break}}}}dumpLayers(){this.layers=[],this.currentMapState=[]}isMapZooming(){return this.isZooming}refreshDatasets(n){let t=null;this.getLayers().forEach(o=>{o.dataSource.getDataSourceType()===n&&(this.mapboxUnmapLayer(o),this.mapboxMapLayer(o,t)),t=o})}setLayers(n){if(this.layers=null!=this.layerSorter?this.layerSorter.sortLayers(n):n,this.syncWithUrlParams){let t=this.dataSourceFactory.serializeLayers(n);this.setState({layers:JSON.stringify(t)},!1)}else this.syncMapState();this.layersChange.emit(this.getLayers())}zoomOnReady(n){-1===this._zoomOnReady.indexOf(n)&&this._zoomOnReady.push(n)}zoomToLayer(n){return n.dataSource.getBounds(n).then(t=>{if(null!=t){let o=this.calculateZoomConfig(null);this.isZooming=!0,this.map.fitBounds(t,o),window.setTimeout(()=>{this.isZooming=!1},6e3)}})}calculateZoomConfig(n){let t={padding:{top:10,bottom:10,left:10,right:10},animate:!0,maxDuration:5e3,maxZoom:20};return("Point"===n||"MultiPoint"===n)&&(t.padding={top:50,bottom:50,left:50,right:50},t.maxZoom=12),this.state.graphPanelOpen&&!this.state.attrPanelOpen?t.padding.left+=Math.round(window.innerWidth/2):this.state.attrPanelOpen&&null!=this.state.text&&!this.state.graphPanelOpen&&(t.padding.left+=Math.round(window.innerWidth/3)),null!=this.state.layersPanelSize&&(1===Number.parseInt(this.state.layersPanelSize)||2)&&(t.padding.right+=50),t}setGeometryType(n){this.geometryType=n}getLayerFromMapboxLayer(n){let t=n.id;t.endsWith("-POINT")?t=t.substring(0,t.length-6):t.endsWith("-POLYGON")?t=t.substring(0,t.length-8):t.endsWith("-LINE")?t=t.substring(0,t.length-5):t.endsWith("-LABEL")&&(t=t.substring(0,t.length-6));let o=this.getLayers().filter(a=>a.getId()===t);if(o.length>0)return o[0]}destroy(n=!0){null!=this.editingControl&&(this.map.removeControl(this.editingControl),this.editingControl=null),null!=this.map&&n?(this.map.remove(),this.map=null):null!=this.map&&this.unmapAllLayers(),null!=this.layers&&this.layers.forEach(t=>{t instanceof Vl&&(t.editing=!1)}),this.editingLayer=null,this.layers=[],this.currentMapState=[],this.dataSourceFactory=new Yl(this,this.registryService,this.relVizService,this.mapService,this.listService)}getMap(){return this.map}getDataSourceFactory(){return this.dataSourceFactory}setDataSourceFactory(n){this.dataSourceFactory=n}getRegisteredDataSource(n){return this.dataSourceFactory.getRegisteredDataSource(n)}registerDataSource(n){this.dataSourceFactory.registerDataSource(n)}unregisterDataSource(n){this.dataSourceFactory.unregisterDataSource(n)}startEditing(n){this.isEditing()&&this.stopEditing(),this.editingLayer=n,this.editingLayer.editing=!0,this.readOnly||this.enableEditing(),this.addEditingLayers()}stopEditing(n=!0){this.isEditing()&&(this.saveEdits(n),this.editingLayer.editing=!1,this.editingLayer=null,this.editingControl.deleteAll(),this.map.removeControl(this.editingControl),this.editingControl=null)}isEditing(){return null!=this.editingLayer}setPointCoordinates(n,t){null!=this.editingLayer&&(this.editingControl.set({type:"FeatureCollection",features:[{id:this.editingLayer.getId(),type:"Feature",properties:{},geometry:{type:"Point",coordinates:[t,n]}}]}),this.editingControl.changeMode("simple_select",{featureIds:this.editingLayer.getId()}),this.saveEdits())}isValid(){if(!this.readOnly){let n=!1;return null!=this.editingControl&&this.editingControl.getAll().features.length>0&&(n=!0),n}return!0}saveEdits(n=!0){if(null!=this.editingLayer){let t=this.getDrawGeometry();this.editingLayer.dataSource.setLayerData(t),n&&(this.unmapAllLayers(),this.mapAllLayers())}}reload(){null!=this.map&&(this.unmapAllLayers(),this.mapAllLayers(),null!=this.editingControl&&this.editingControl.deleteAll(),this.addEditingLayers())}setEditing(n,t){this.isEditing()&&this.stopEditing(),t.editing=n,n&&this.startEditing(t)}addOrUpdateLayer(n,t){let o=this.getLayers(),a=o.findIndex(l=>l.getId()===n.getId());-1!==a?o[a]=n:null!=t?o.splice(t,0,n):o.push(n),n instanceof Vl&&n.editing&&this.startEditing(n),this.setLayers(o)}removeLayer(n){let t=this.getLayers(),o=t.findIndex(a=>a.getId()===n);-1!==o?(t.splice(o,1),this.setLayers(t)):console.log("Could not remove layer with id "+n+" because one does not exist.")}removeLayers(n){let t=this.getLayers();t=t.filter(o=>-1===n.indexOf(o.getId())),this.setLayers(t)}getLayers(){return this.dataSourceFactory.deserializeLayers(this.dataSourceFactory.serializeLayers(this.layers))}enableEditing(){null==this.editingControl&&("MULTIPOLYGON"===this.geometryType||"POLYGON"===this.geometryType?this.editingControl=new La({controls:{point:!1,line_string:!1,polygon:!0,trash:!0,combine_features:!1,uncombine_features:!1}}):"POINT"===this.geometryType||"MULTIPOINT"===this.geometryType?this.editingControl=new La({userProperties:!0,controls:{point:!0,line_string:!1,polygon:!1,trash:!0,combine_features:!1,uncombine_features:!1},styles:[{id:"highlight-active-points",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","true"]],paint:{"circle-radius":13,"circle-color":"#33FFF9","circle-stroke-width":4,"circle-stroke-color":"white"}},{id:"points-are-blue",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"],["==","active","false"]],paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"white"}}]}):"LINE"===this.geometryType||"MULTILINE"===this.geometryType?this.editingControl=new La({controls:{point:!1,line_string:!0,polygon:!1,trash:!0,combine_features:!1,uncombine_features:!1}}):"MIXED"===this.geometryType&&(this.editingControl=new La({controls:{point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!1,uncombine_features:!1}})),null==this.map.getSource("mapbox-gl-draw-cold")&&this.map.addControl(this.editingControl,"bottom-right"))}addEditingLayers(){null!=this.editingLayer&&null!=this.editingControl&&this.editingLayer.dataSource.getLayerData().then(n=>{n&&this.editingControl.add(n)})}mapboxUnmapLayer(n){this.map&&(this.getMapboxLayerIdsForLayer(n).forEach(o=>{null!=this.map.getLayer(o)?this.map.removeLayer(o):console.log("Attempted to remove a layer ["+o+"] which does not exist.")}),!(this.currentMapState.filter(o=>n.getId()!==o.getId()&&o.dataSource.getId()===n.dataSource.getId()).length>0)&&null!=this.map.getSource(n.dataSource.getId())&&this.map.removeSource(n.dataSource.getId()))}unmapAllLayers(){if(null!=this.currentMapState&&this.currentMapState.length>0){let n=this.currentMapState.length;for(let t=0;t<n;++t)this.mapboxUnmapLayer(this.currentMapState[t])}}mapAllLayers(){if(null!=this.currentMapState&&this.currentMapState.length>0){let n=null,t=this.currentMapState.length;for(let o=0;o<t;++o){let a=this.currentMapState[o];this.mapboxMapLayer(a,n),n=a}}}mapboxHideLayer(n){!this.map||this.getMapboxLayerIdsForLayer(n).forEach(t=>{null!=this.map.getLayer(t)?this.map.setLayoutProperty(t,"visibility","none"):console.log("Attempted to hide a layer ["+t+"] which does not exist.")})}mapboxShowLayer(n){!this.map||this.getMapboxLayerIdsForLayer(n).forEach(t=>{null!=this.map.getLayer(t)?this.map.setLayoutProperty(t,"visibility","visible"):console.log("Attempted to show a layer ["+t+"] which does not exist.")})}mapboxMapLayer(n,t){if(!this.map)return;let o=n.dataSource.buildMapboxSource();null==this.map.getSource(n.dataSource.getId())&&this.map.addSource(n.dataSource.getId(),o),n.dataSource instanceof eu&&n.dataSource.getLayerData().then(l=>{null!=this.map.getSource(n.dataSource.getId())&&this.map.getSource(n.dataSource.getId()).setData(l)}),"MIXED"===n.dataSource.getGeometryType()?(this.mapboxMapLayerAsType("POLYGON",n,t),this.mapboxMapLayerAsType("POINT",n,t),this.mapboxMapLayerAsType("LINE",n,t)):this.mapboxMapLayerAsType(n.dataSource.getGeometryType(),n,t);let a={id:n.getId()+"-LABEL",source:n.dataSource.getId(),type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":["get","localizedValue",["get","displayLabel"]],"text-font":["NotoSansRegular"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}};n.rendered||(a.layout.visibility="none"),n.configureMapboxLayer("LABEL",a),this.map.addLayer(a,t?t.getId()+"-LABEL":null)}mapboxMapLayerAsType(n,t,o){let a;if("MULTIPOLYGON"===n||"POLYGON"===n)a={id:t.getId()+"-"+this.getLayerIdGeomTypePostfix(n),type:"fill",source:t.dataSource.getId(),paint:{"fill-color":["case",["boolean",["feature-state","selected"],!1],yc,t.color],"fill-outline-color":"black","fill-opacity":.7},filter:["all",["match",["geometry-type"],["Polygon","MultiPolygon"],!0,!1]]};else if("POINT"===n||"MULTIPOINT"===n)a={id:t.getId()+"-"+this.getLayerIdGeomTypePostfix(n),type:"circle",source:t.dataSource.getId(),paint:{"circle-radius":10,"circle-color":["case",["boolean",["feature-state","selected"],!1],yc,t.color],"circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["match",["geometry-type"],["Point","MultiPont"],!0,!1]]};else{if("LINE"!==n&&"MULTILINE"!==n)return void console.log("Unexpected geometry type ["+n+"]");a={id:t.getId()+"-"+this.getLayerIdGeomTypePostfix(n),source:t.dataSource.getId(),type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["case",["boolean",["feature-state","selected"],!1],yc,t.color],"line-width":3},filter:["all",["match",["geometry-type"],["LineString","MultiLineString"],!0,!1]]}}t.configureMapboxLayer(n,a),t.rendered||(a.layout=null==a.layout?{}:a.layout,a.layout.visibility="none"),this.map.addLayer(a,o?o.getId()+"-"+this.getLayerIdGeomTypePostfix(o.dataSource.getGeometryType()):null)}getLayerIdGeomTypePostfix(n){return"MULTIPOLYGON"===n||"POLYGON"===n?"POLYGON":"POINT"===n||"MULTIPOINT"===n?"POINT":"LINE"===n||"MULTILINE"===n?"LINE":"POLYGON"}getMapboxLayerIdsForLayer(n){let t=[];return t="MIXED"===n.dataSource.getGeometryType()?["POLYGON","POINT","LINE","LABEL"]:[this.getLayerIdGeomTypePostfix(n.dataSource.getGeometryType()),"LABEL"],t.map(o=>n.getId()+"-"+o)}getDrawGeometry(){if(null!=this.editingControl){let n=this.editingControl.getAll();if(n.features.length>0){if("MULTIPOLYGON"===this.geometryType){let t=[];for(let o=0;o<n.features.length;o++){let a=n.features[o];if("MultiPolygon"===a.geometry.type)for(let l=0;l<a.geometry.coordinates.length;l++)t.push(a.geometry.coordinates[l]);else t.push(a.geometry.coordinates)}return{coordinates:t,type:"MultiPolygon"}}if("MULTIPOINT"===this.geometryType){let t=[];for(let o=0;o<n.features.length;o++){let a=n.features[o];if("MultiPoint"===a.geometry.type)for(let l=0;l<a.geometry.coordinates.length;l++)t.push(a.geometry.coordinates[l]);else t.push(a.geometry.coordinates)}return{coordinates:t,type:"MultiPoint"}}if("MULTILINE"===this.geometryType){let t=[];for(let o=0;o<n.features.length;o++){let a=n.features[o];if("MultiLineString"===a.geometry.type)for(let l=0;l<a.geometry.coordinates.length;l++)t.push(a.geometry.coordinates[l]);else t.push(a.geometry.coordinates)}return{coordinates:t,type:"MultiLineString"}}return n.features[0].geometry}}return null}static createEmptyGeometryValue(n){let t={type:n,coordinates:[]},o=n.toUpperCase();return"MULTIPOLYGON"===o||"MIXED"===o?t.type="MultiPolygon":"POLYGON"===o?t.type="Polygon":"POINT"===o?t.type="Point":"MULTIPOINT"===o?t.type="MultiPoint":"LINE"===o?t.type="Line":"MULTILINE"===o&&(t.type="MultiLine"),t}zoomToLayersExtent(){let n=this.getLayers(),t=null;n.forEach(o=>{o instanceof Vl&&o.rendered&&(t=o)}),t?.dataSource.getLayerData().then(o=>{if(null!=o){const a=null!=o.type?o.type.toUpperCase():this.geometryType;if("MULTIPOINT"===a||"POINT"===a){let l=o.coordinates;if(l){let _=new sr.LngLatBounds;l.forEach(F=>{_.extend(F)});let C=_.getCenter(),N=new sr.LngLat(C.lng,C.lat);this.map.flyTo({center:N,zoom:9,essential:!0})}}else if("MULTIPOLYGON"===a||"POLYGON"===a||"MIXED"===a){let l=o.coordinates;if(l){let _=new sr.LngLatBounds;l.forEach(C=>{C.forEach(N=>{N.forEach(F=>{_.extend(F)})})}),this.map.fitBounds(_,{padding:20})}}else if("LINE"===a||"MULTILINE"===a){let l=o.coordinates;if(l){let _=new sr.LngLatBounds;l.forEach(C=>{C.forEach(N=>{N.forEach(F=>{_.extend(F)})})}),this.map.fitBounds(_,{padding:20})}}}})}}vo.\u0275fac=function(n){return new(n||vo)(e.LFG(w.gz),e.LFG(w.F0),e.LFG(Zi),e.LFG(Xa),e.LFG(ys),e.LFG(Uo),e.LFG(mo.o))},vo.\u0275prov=e.Yz7({token:vo,factory:vo.\u0275fac});var Xc=v(32329);class bc{constructor(n){this.dataSourceType=n,this.id=G()}getDataSourceType(){return this.dataSourceType}createLayer(n,t,o){return new Gl(this,n,t,o)}fromJSON(n){Object.assign(this,n)}toJSON(){return{dataSourceType:this.dataSourceType,id:this.id}}getId(){return this.id}}class eu extends bc{buildMapboxSource(){return{type:"geojson",data:vo.createEmptyGeometryValue(this.getGeometryType())}}getBounds(n){return this.getLayerData().then(t=>{try{return _s(t)}catch(o){console.log(o)}return null})}}class Gl{constructor(n,t,o,a){this.dataSource=n,this.legendLabel=t,this.rendered=o,this.color=a,this.pinned=!1}fromJSON(n){Object.assign(this,n)}toJSON(){return{legendLabel:this.legendLabel,rendered:this.rendered,color:this.color,pinned:this.pinned}}getId(){return this.dataSource.getId()}getKey(){return this.dataSource.getKey()}getPinned(){return this.pinned}setPinned(n){this.pinned=n}configureMapboxLayer(n,t){}}class Vl extends Gl{constructor(n,t,o,a){super(n,t,o,a),this.editing=!1}}const il="GEOOBJ";class Zs extends bc{constructor(n,t,o,a){super(il),this.registryService=n,this.code=t,this.typeCode=o,this.date=a}toJSON(){return Object.assign(super.toJSON(),{code:this.code,typeCode:this.typeCode,date:this.date})}getCode(){return this.code}setCode(n){this.code=n}getTypeCode(){return this.typeCode}setTypeCode(n){this.typeCode=n}getDate(){return this.date}setDate(n){this.date=n}getDataSourceType(){return il}getKey(){return this.getDataSourceType()+this.getCode()+this.getTypeCode()+(null==this.getDate()?"":this.getDate())}getGeometryType(){return"MIXED"}buildMapboxSource(){let n=new ot.LE;return n=n.set("code",this.code),n=n.set("typeCode",this.typeCode),null!=this.date&&(n=n.set("date",this.date)),{type:"geojson",data:pt.N.apiUrl+"/api/geoobject/get-code?"+n.toString()}}getBounds(n){return this.registryService.getGeoObjectBoundsAtDate(this.code,this.typeCode,this.date).then(t=>t&&Array.isArray(t)?new sr.LngLatBounds([t[0],t[1]],[t[2],t[3]]):null)}getVersionId(){}}const vs="LISTVECT";class xc extends bc{constructor(n,t){super(vs),this.versionId=t,this.listService=n}toJSON(){return Object.assign(super.toJSON(),{versionId:this.versionId})}getVersionId(){return this.versionId}getKey(){return this.getDataSourceType()+this.getVersionId()}createLayer(n,t,o){return new gh(this,n,t,o)}buildMapboxSource(){return{type:"vector",tiles:[window.location.protocol+"//"+window.location.host+Xc.Z.getApiUrl()+"/api/list-type/tile?x={x}&y={y}&z={z}&config="+encodeURIComponent(JSON.stringify({oid:this.versionId}))],promoteId:"uid"}}getGeometryType(){return"MIXED"}getBounds(n){let t=null;return n instanceof gh&&(t=n.getObjectFilter()),this.listService.getBounds(this.versionId,t).then(o=>o&&Array.isArray(o)?new sr.LngLatBounds([o[0],o[1]],[o[2],o[3]]):null)}}class gh extends Gl{configureMapboxLayer(n,t){if(t["source-layer"]="context",null!=this.objectFilter){let o=["match",["get","uid"],this.objectFilter,!0,!1];null!=t.filter?t.filter.push(o):t.filter=o}"LABEL"===n&&(t.layout["text-field"]=["case",["has","displayLabel_"+navigator.language.toLowerCase()],["coalesce",["get","displayLabel_"+navigator.language.toLowerCase()],["get","displayLabel"],["get","code"]],["coalesce",["get","displayLabel"],["string",["get","code"]]]])}toJSON(){return Object.assign(super.toJSON(),{objectFilter:this.objectFilter})}getId(){return null==this.objectFilter?this.dataSource.getId():this.objectFilter+this.dataSource.getId()}getKey(){return null==this.objectFilter?this.dataSource.getKey():this.objectFilter+this.dataSource.getKey()}setObjectFilter(n){this.objectFilter=n}getObjectFilter(){return this.objectFilter}}const Gu="CRNEW";class Cc extends eu{constructor(n,t){super("NEW"===n?Gu:"CROLD"),this.votEditor=t}setLayerData(n){this.getDataSourceType()===Gu?this.votEditor.value=n:console.log("ERROR. Cannot edit old geometry")}getLayerData(){return new Promise((n,t)=>{this.getDataSourceType()===Gu?n(this.votEditor.value):n(this.votEditor.oldValue)})}getGeometryType(){return this.votEditor.changeRequestAttributeEditor.changeRequestEditor.geoObjectType.geometryType}getKey(){return this.getDataSourceType()+this.votEditor.oid}createLayer(n,t,o){return new Vl(this,n,t,o)}getBounds(n){return this.getLayerData().then(t=>_s(t))}getVersionId(){}}const Tp="SEARCH";class za extends eu{constructor(n,t,o){super(Tp),this.mapService=n,this.text=t,this.date=o}toJSON(){return Object.assign(super.toJSON(),{text:this.text,date:this.date})}getText(){return this.text}getDate(){return this.date}setLayerData(n){throw new Error("Method not implemented.")}getLayerData(){return null!=this.geojson?new Promise((n,t)=>{n(this.geojson)}):this.mapService.search(this.text,this.date,!1).then(n=>(this.geojson=n,n))}getGeometryType(){return"MIXED"}getKey(){return Tp+this.text+(null==this.date?"":this.date)}getVersionId(){}}const $i="RELVIZ";class na extends eu{constructor(n,t,o,a,l,_,C){super($i),this.vizService=n,this.geomService=t,this.relationshipType=o,this.relationshipCode=a,this.sourceObject=l,this.bounds=_,this.date=C}toJSON(){return Object.assign(super.toJSON(),{relationshipType:this.relationshipType,relationshipCode:this.relationshipCode,sourceObject:this.sourceObject,bounds:this.bounds,date:this.date})}getKey(){return $i+this.relationshipCode+this.sourceObject.code+this.sourceObject.typeCode+this.bounds+(null==this.date?"":this.date)}createLayer(n,t,o){return new Eg(this,n,t,o)}getRelationshipType(){return this.relationshipType}getRelationshipCode(){return this.relationshipCode}getSourceObject(){return this.sourceObject}hasSameSourceObject(n){return this.sourceObject.code===n.code&&this.sourceObject.objectType===n.objectType&&this.sourceObject.typeCode===n.typeCode}getDate(){return this.date}setLayerData(n){throw new Error("Method not implemented.")}getLayerData(){return this.data?new Promise((n,t)=>{n(this.data)}):(null!=this.dataPromise||(this.dataPromise=this.vizService.treeAsGeoJson(this.relationshipType,this.relationshipCode,this.sourceObject,this.date,this.getBoundsAsWKT()).then(n=>(this.data=n,this.dataPromise=null,this.data))),this.dataPromise)}getBoundsAsWKT(){let n=null;if(null!=this.bounds){const t=new sr.LngLatBounds(JSON.parse(this.bounds));n=this.convertBoundsToWKT(t)}return n}convertBoundsToWKT(n){let t=n.getSouthEast(),o=n.getSouthWest(),a=n.getNorthWest(),l=n.getNorthEast();return"POLYGON (("+t.lng+" "+t.lat+","+o.lng+" "+o.lat+","+a.lng+" "+a.lat+","+l.lng+" "+l.lat+","+t.lng+" "+t.lat+"))"}getGeometryType(){return"MIXED"}getBounds(n){return this.getLayerData().then(t=>null==t?null:(null!=n.getRelatedTypeFilter()&&(t.features=t.features.filter(o=>o.properties.type===n.getRelatedTypeFilter())),_s(t)))}getVersionId(){}}class Eg extends Gl{toJSON(){return Object.assign(super.toJSON(),{relatedTypeFilter:this.relatedTypeFilter})}getId(){return null==this.relatedTypeFilter?"":this.relatedTypeFilter+this.dataSource.getId()}getKey(){return null==this.relatedTypeFilter?"":this.relatedTypeFilter+this.dataSource.getKey()}setRelatedTypeFilter(n){this.relatedTypeFilter=n}getRelatedTypeFilter(){return this.relatedTypeFilter}configureMapboxLayer(n,t){if(null!=this.relatedTypeFilter){let o=["match",["get","type"],this.relatedTypeFilter,!0,!1];null!=t.filter?t.filter.push(o):t.filter=o}}}class Yl{constructor(n,t,o,a,l){this.dataSources={},this.geomService=n,this.registryService=t,this.vizService=o,this.mapService=a,this.listService=l}getRegisteredDataSource(n){return this.dataSources[n]}registerDataSource(n){n instanceof za?this.dataSources[vc]=n:this.dataSources[n.getId()]=n}unregisterDataSource(n){delete this.dataSources[n]}newDataSourceFromType(n){return n===il?new Zs(this.registryService):n===$i?new na(this.vizService,this.geomService):n===vs?new xc(this.listService):n===Tp?new za(this.mapService):(console.log("Cannot find data source of type '"+n+"'"),null)}deserializeDataSource(n){let t=this.newDataSourceFromType(n.dataSourceType);if(null==t&&null!=this.dataSources[n.id])return this.dataSources[n.id];if(null==t)return null;if(t.fromJSON(n),t instanceof za){const o=this.dataSources[vc];if(null!=o&&o.getKey()===t.getKey())return o}return t}serializeDataSource(n){return n.toJSON()}deserializeLayer(n,t){let o;return o=t.createLayer(n.legendLabel,n.rendered,n.color),Object.assign(o,n),o.dataSource=t,o}serializeLayer(n){let t=n.toJSON();return t.dataSource=n.dataSource.getId(),t}deserializeLayers(n){let t=[],o=[];return n.dataSources.forEach(a=>{let l=this.deserializeDataSource(a);null!=l&&o.push(l)}),n.layers.forEach(a=>{let l=o.findIndex(_=>_.getId()===a.dataSource);-1!==l&&t.push(this.deserializeLayer(a,o[l]))}),t}serializeLayers(n){let t={layers:[],dataSources:[]};return n.forEach(o=>{if(-1===t.dataSources.findIndex(a=>a.id===o.dataSource.getId())){let a=this.serializeDataSource(o.dataSource);t.dataSources.push(a)}}),n.forEach(o=>{let a=this.serializeLayer(o);t.layers.push(a)}),t}}function ad(){}function sd(i){return null==i?ad:function(){return this.querySelector(i)}}function xh(i){return"object"==typeof i&&"length"in i?i:Array.from(i)}function Ig(){return[]}function wc(i){return null==i?Ig:function(){return this.querySelectorAll(i)}}function tu(i){return function(){return this.matches(i)}}function nu(i){return function(n){return n.matches(i)}}var Zg=Array.prototype.find;function Lg(){return this.firstElementChild}var Ch=Array.prototype.filter;function wh(){return this.children}function ld(i){return new Array(i.length)}function Hu(i,n){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=n}function Fg(i){return function(){return i}}function Ug(i,n,t,o,a,l){for(var C,_=0,N=n.length,F=l.length;_<F;++_)(C=n[_])?(C.__data__=l[_],o[_]=C):t[_]=new Hu(i,l[_]);for(;_<N;++_)(C=n[_])&&(a[_]=C)}function Mh(i,n,t,o,a,l,_){var C,N,Te,F=new Map,V=n.length,ue=l.length,ce=new Array(V);for(C=0;C<V;++C)(N=n[C])&&(ce[C]=Te=_.call(N,N.__data__,C,n)+"",F.has(Te)?a[C]=N:F.set(Te,N));for(C=0;C<ue;++C)Te=_.call(i,l[C],C,l)+"",(N=F.get(Te))?(o[C]=N,N.__data__=l[C],F.delete(Te)):t[C]=new Hu(i,l[C]);for(C=0;C<V;++C)(N=n[C])&&F.get(ce[C])===N&&(a[C]=N)}function qg(i){return i.__data__}function bm(i,n){return i<n?-1:i>n?1:i>=n?0:NaN}Hu.prototype={constructor:Hu,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,n){return this._parent.insertBefore(i,n)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};var Ns="http://www.w3.org/1999/xhtml";const Op={svg:"http://www.w3.org/2000/svg",xhtml:Ns,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Sp(i){var n=i+="",t=n.indexOf(":");return t>=0&&"xmlns"!==(n=i.slice(0,t))&&(i=i.slice(t+1)),Op.hasOwnProperty(n)?{space:Op[n],local:i}:i}function Pp(i){return function(){this.removeAttribute(i)}}function Bg(i){return function(){this.removeAttributeNS(i.space,i.local)}}function dv(i,n){return function(){this.setAttribute(i,n)}}function hv(i,n){return function(){this.setAttributeNS(i.space,i.local,n)}}function fv(i,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(i):this.setAttribute(i,t)}}function gv(i,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,t)}}function uy(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function mv(i){return function(){this.style.removeProperty(i)}}function yv(i,n,t){return function(){this.style.setProperty(i,n,t)}}function vv(i,n,t){return function(){var o=n.apply(this,arguments);null==o?this.style.removeProperty(i):this.style.setProperty(i,o,t)}}function ud(i,n){return i.style.getPropertyValue(n)||uy(i).getComputedStyle(i,null).getPropertyValue(n)}function xv(i){return function(){delete this[i]}}function Cv(i,n){return function(){this[i]=n}}function wv(i,n){return function(){var t=n.apply(this,arguments);null==t?delete this[i]:this[i]=t}}function py(i){return i.trim().split(/^|\s+/)}function Sm(i){return i.classList||new dy(i)}function dy(i){this._node=i,this._names=py(i.getAttribute("class")||"")}function hy(i,n){for(var t=Sm(i),o=-1,a=n.length;++o<a;)t.add(n[o])}function fy(i,n){for(var t=Sm(i),o=-1,a=n.length;++o<a;)t.remove(n[o])}function Mv(i){return function(){hy(this,i)}}function Ov(i){return function(){fy(this,i)}}function Sv(i,n){return function(){(n.apply(this,arguments)?hy:fy)(this,i)}}function Ev(){this.textContent=""}function Av(i){return function(){this.textContent=i}}function kv(i){return function(){var n=i.apply(this,arguments);this.textContent=n??""}}function Zv(){this.innerHTML=""}function Nv(i){return function(){this.innerHTML=i}}function Lv(i){return function(){var n=i.apply(this,arguments);this.innerHTML=n??""}}function Dv(){this.nextSibling&&this.parentNode.appendChild(this)}function Fv(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qv(i){return function(){var n=this.ownerDocument,t=this.namespaceURI;return t===Ns&&n.documentElement.namespaceURI===Ns?n.createElement(i):n.createElementNS(t,i)}}function Jv(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function gy(i){var n=Sp(i);return(n.local?Jv:qv)(n)}function Bv(){return null}function Vv(){var i=this.parentNode;i&&i.removeChild(this)}function Hv(){var i=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(i,this.nextSibling):i}function Qv(){var i=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(i,this.nextSibling):i}function Xv(i){return i.trim().split(/^|\s+/).map(function(n){var t="",o=n.indexOf(".");return o>=0&&(t=n.slice(o+1),n=n.slice(0,o)),{type:n,name:t}})}function e1(i){return function(){var n=this.__on;if(n){for(var l,t=0,o=-1,a=n.length;t<a;++t)l=n[t],i.type&&l.type!==i.type||l.name!==i.name?n[++o]=l:this.removeEventListener(l.type,l.listener,l.options);++o?n.length=o:delete this.__on}}}function t1(i,n,t){return function(){var a,o=this.__on,l=function Wv(i){return function(n){i.call(this,n,this.__data__)}}(n);if(o)for(var _=0,C=o.length;_<C;++_)if((a=o[_]).type===i.type&&a.name===i.name)return this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=t),void(a.value=n);this.addEventListener(i.type,l,t),a={type:i.type,name:i.name,value:n,listener:l,options:t},o?o.push(a):this.__on=[a]}}function _y(i,n,t){var o=uy(i),a=o.CustomEvent;"function"==typeof a?a=new a(n,t):(a=o.document.createEvent("Event"),t?(a.initEvent(n,t.bubbles,t.cancelable),a.detail=t.detail):a.initEvent(n,!1,!1)),i.dispatchEvent(a)}function i1(i,n){return function(){return _y(this,i,n)}}function o1(i,n){return function(){return _y(this,i,n.apply(this,arguments))}}dy.prototype={add:function(i){this._names.indexOf(i)<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var n=this._names.indexOf(i);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};var Pm=[null];function ts(i,n){this._groups=i,this._parents=n}function my(){return new ts([[document.documentElement]],Pm)}ts.prototype=my.prototype={constructor:ts,select:function Cl(i){"function"!=typeof i&&(i=sd(i));for(var n=this._groups,t=n.length,o=new Array(t),a=0;a<t;++a)for(var N,F,l=n[a],_=l.length,C=o[a]=new Array(_),V=0;V<_;++V)(N=l[V])&&(F=i.call(N,N.__data__,V,l))&&("__data__"in N&&(F.__data__=N.__data__),C[V]=F);return new ts(o,this._parents)},selectAll:function Yu(i){i="function"==typeof i?function Vu(i){return function(){var n=i.apply(this,arguments);return null==n?[]:xh(n)}}(i):wc(i);for(var n=this._groups,t=n.length,o=[],a=[],l=0;l<t;++l)for(var N,_=n[l],C=_.length,F=0;F<C;++F)(N=_[F])&&(o.push(i.call(N,N.__data__,F,_)),a.push(N));return new ts(o,a)},selectChild:function zg(i){return this.select(null==i?Lg:function Ng(i){return function(){return Zg.call(this.children,i)}}("function"==typeof i?i:nu(i)))},selectChildren:function Dg(i){return this.selectAll(null==i?wh:function Ql(i){return function(){return Ch.call(this.children,i)}}("function"==typeof i?i:nu(i)))},filter:function Th(i){"function"!=typeof i&&(i=tu(i));for(var n=this._groups,t=n.length,o=new Array(t),a=0;a<t;++a)for(var N,l=n[a],_=l.length,C=o[a]=[],F=0;F<_;++F)(N=l[F])&&i.call(N,N.__data__,F,l)&&C.push(N);return new ts(o,this._parents)},data:function Mp(i,n){if(!arguments.length)return Array.from(this,qg);var t=n?Mh:Ug,o=this._parents,a=this._groups;"function"!=typeof i&&(i=Fg(i));for(var l=a.length,_=new Array(l),C=new Array(l),N=new Array(l),F=0;F<l;++F){var V=o[F],ue=a[F],ce=ue.length,Te=xh(i.call(V,V&&V.__data__,F,o)),We=Te.length,it=C[F]=new Array(We),He=_[F]=new Array(We),et=N[F]=new Array(ce);t(V,ue,it,He,et,Te,n);for(var vt,Vt,xt=0,bt=0;xt<We;++xt)if(vt=it[xt]){for(xt>=bt&&(bt=xt+1);!(Vt=He[bt])&&++bt<We;);vt._next=Vt||null}}return(_=new ts(_,o))._enter=C,_._exit=N,_},enter:function Rg(){return new ts(this._enter||this._groups.map(ld),this._parents)},exit:function Jg(){return new ts(this._exit||this._groups.map(ld),this._parents)},join:function cd(i,n,t){var o=this.enter(),a=this,l=this.exit();return o="function"==typeof i?i(o):o.append(i+""),null!=n&&(a=n(a)),null==t?l.remove():t(l),o&&a?o.merge(a).order():a},merge:function ym(i){if(!(i instanceof ts))throw new Error("invalid merge");for(var n=this._groups,t=i._groups,o=n.length,l=Math.min(o,t.length),_=new Array(o),C=0;C<l;++C)for(var ce,N=n[C],F=t[C],V=N.length,ue=_[C]=new Array(V),Te=0;Te<V;++Te)(ce=N[Te]||F[Te])&&(ue[Te]=ce);for(;C<o;++C)_[C]=n[C];return new ts(_,this._parents)},selection:function s1(){return this},order:function jg(){for(var i=this._groups,n=-1,t=i.length;++n<t;)for(var _,o=i[n],a=o.length-1,l=o[a];--a>=0;)(_=o[a])&&(l&&4^_.compareDocumentPosition(l)&&l.parentNode.insertBefore(_,l),l=_);return this},sort:function vm(i){function n(ue,ce){return ue&&ce?i(ue.__data__,ce.__data__):!ue-!ce}i||(i=bm);for(var t=this._groups,o=t.length,a=new Array(o),l=0;l<o;++l){for(var F,_=t[l],C=_.length,N=a[l]=new Array(C),V=0;V<C;++V)(F=_[V])&&(N[V]=F);N.sort(n)}return new ts(a,this._parents).order()},call:function xm(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this},nodes:function Cm(){return Array.from(this)},node:function wm(){for(var i=this._groups,n=0,t=i.length;n<t;++n)for(var o=i[n],a=0,l=o.length;a<l;++a){var _=o[a];if(_)return _}return null},size:function Tm(){let i=0;for(const n of this)++i;return i},empty:function Mm(){return!this.node()},each:function Om(i){for(var n=this._groups,t=0,o=n.length;t<o;++t)for(var C,a=n[t],l=0,_=a.length;l<_;++l)(C=a[l])&&i.call(C,C.__data__,l,a);return this},attr:function _v(i,n){var t=Sp(i);if(arguments.length<2){var o=this.node();return t.local?o.getAttributeNS(t.space,t.local):o.getAttribute(t)}return this.each((null==n?t.local?Bg:Pp:"function"==typeof n?t.local?gv:fv:t.local?hv:dv)(t,n))},style:function bv(i,n,t){return arguments.length>1?this.each((null==n?mv:"function"==typeof n?vv:yv)(i,n,t??"")):ud(this.node(),i)},property:function Tv(i,n){return arguments.length>1?this.each((null==n?xv:"function"==typeof n?wv:Cv)(i,n)):this.node()[i]},classed:function Pv(i,n){var t=py(i+"");if(arguments.length<2){for(var o=Sm(this.node()),a=-1,l=t.length;++a<l;)if(!o.contains(t[a]))return!1;return!0}return this.each(("function"==typeof n?Sv:n?Mv:Ov)(t,n))},text:function Iv(i){return arguments.length?this.each(null==i?Ev:("function"==typeof i?kv:Av)(i)):this.node().textContent},html:function zv(i){return arguments.length?this.each(null==i?Zv:("function"==typeof i?Lv:Nv)(i)):this.node().innerHTML},raise:function Rv(){return this.each(Dv)},lower:function Uv(){return this.each(Fv)},append:function jv(i){var n="function"==typeof i?i:gy(i);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function Gv(i,n){var t="function"==typeof i?i:gy(i),o=null==n?Bv:"function"==typeof n?n:sd(n);return this.select(function(){return this.insertBefore(t.apply(this,arguments),o.apply(this,arguments)||null)})},remove:function Yv(){return this.each(Vv)},clone:function Kv(i){return this.select(i?Qv:Hv)},datum:function $v(i){return arguments.length?this.property("__data__",i):this.node().__data__},on:function n1(i,n,t){var a,_,o=Xv(i+""),l=o.length;if(!(arguments.length<2)){for(C=n?t1:e1,a=0;a<l;++a)this.each(C(o[a],n,t));return this}var C=this.node().__on;if(C)for(var V,N=0,F=C.length;N<F;++N)for(a=0,V=C[N];a<l;++a)if((_=o[a]).type===V.type&&_.name===V.name)return V.value},dispatch:function r1(i,n){return this.each(("function"==typeof n?o1:i1)(i,n))},[Symbol.iterator]:function*a1(){for(var i=this._groups,n=0,t=i.length;n<t;++n)for(var _,o=i[n],a=0,l=o.length;a<l;++a)(_=o[a])&&(yield _)}};const Oh=my;var l1={value:()=>{}};function yy(){for(var o,i=0,n=arguments.length,t={};i<n;++i){if(!(o=arguments[i]+"")||o in t||/[\s.]/.test(o))throw new Error("illegal type: "+o);t[o]=[]}return new Gg(t)}function Gg(i){this._=i}function c1(i,n){return i.trim().split(/^|\s+/).map(function(t){var o="",a=t.indexOf(".");if(a>=0&&(o=t.slice(a+1),t=t.slice(0,a)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:o}})}function u1(i,n){for(var a,t=0,o=i.length;t<o;++t)if((a=i[t]).name===n)return a.value}function vy(i,n,t){for(var o=0,a=i.length;o<a;++o)if(i[o].name===n){i[o]=l1,i=i.slice(0,o).concat(i.slice(o+1));break}return null!=t&&i.push({name:n,value:t}),i}Gg.prototype=yy.prototype={constructor:Gg,on:function(i,n){var a,t=this._,o=c1(i+"",t),l=-1,_=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++l<_;)if(a=(i=o[l]).type)t[a]=vy(t[a],i.name,n);else if(null==n)for(a in t)t[a]=vy(t[a],i.name,null);return this}for(;++l<_;)if((a=(i=o[l]).type)&&(a=u1(t[a],i.name)))return a},copy:function(){var i={},n=this._;for(var t in n)i[t]=n[t].slice();return new Gg(i)},call:function(i,n){if((a=arguments.length-2)>0)for(var a,l,t=new Array(a),o=0;o<a;++o)t[o]=arguments[o+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(o=0,a=(l=this._[i]).length;o<a;++o)l[o].value.apply(n,t)},apply:function(i,n,t){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var o=this._[i],a=0,l=o.length;a<l;++a)o[a].value.apply(n,t)}};const by=yy;var Vg,Eh,pd=0,Sh=0,Ph=0,Yg=0,Ep=0,Hg=0,Ah="object"==typeof performance&&performance.now?performance:Date,Cy="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function Em(){return Ep||(Cy(p1),Ep=Ah.now()+Hg)}function p1(){Ep=0}function Qg(){this._call=this._time=this._next=null}function wy(i,n,t){var o=new Qg;return o.restart(i,n,t),o}function Ty(){Ep=(Yg=Ah.now())+Hg,pd=Sh=0;try{!function d1(){Em(),++pd;for(var n,i=Vg;i;)(n=Ep-i._time)>=0&&i._call.call(null,n),i=i._next;--pd}()}finally{pd=0,function f1(){for(var i,t,n=Vg,o=1/0;n;)n._call?(o>n._time&&(o=n._time),i=n,n=n._next):(t=n._next,n._next=null,n=i?i._next=t:Vg=t);Eh=i,Am(o)}(),Ep=0}}function h1(){var i=Ah.now(),n=i-Yg;n>1e3&&(Hg-=n,Yg=i)}function Am(i){pd||(Sh&&(Sh=clearTimeout(Sh)),i-Ep>24?(i<1/0&&(Sh=setTimeout(Ty,i-Ah.now()-Hg)),Ph&&(Ph=clearInterval(Ph))):(Ph||(Yg=Ah.now(),Ph=setInterval(h1,1e3)),pd=1,Cy(Ty)))}function kh(i,n,t){var o=new Qg;return o.restart(a=>{o.stop(),i(a+n)},n=null==n?0:+n,t),o}Qg.prototype=wy.prototype={constructor:Qg,restart:function(i,n,t){if("function"!=typeof i)throw new TypeError("callback is not a function");t=(null==t?Em():+t)+(null==n?0:+n),!this._next&&Eh!==this&&(Eh?Eh._next=this:Vg=this,Eh=this),this._call=i,this._time=t,Am()},stop:function(){this._call&&(this._call=null,this._time=1/0,Am())}};var g1=by("start","end","cancel","interrupt"),_1=[];function Wg(i,n,t,o,a,l){var _=i.__transition;if(_){if(t in _)return}else i.__transition={};!function m1(i,n,t){var a,o=i.__transition;function _(F){var V,ue,ce,Te;if(1!==t.state)return N();for(V in o)if((Te=o[V]).name===t.name){if(3===Te.state)return kh(_);4===Te.state?(Te.state=6,Te.timer.stop(),Te.on.call("interrupt",i,i.__data__,Te.index,Te.group),delete o[V]):+V<n&&(Te.state=6,Te.timer.stop(),Te.on.call("cancel",i,i.__data__,Te.index,Te.group),delete o[V])}if(kh(function(){3===t.state&&(t.state=4,t.timer.restart(C,t.delay,t.time),C(F))}),t.state=2,t.on.call("start",i,i.__data__,t.index,t.group),2===t.state){for(t.state=3,a=new Array(ce=t.tween.length),V=0,ue=-1;V<ce;++V)(Te=t.tween[V].value.call(i,i.__data__,t.index,t.group))&&(a[++ue]=Te);a.length=ue+1}}function C(F){for(var V=F<t.duration?t.ease.call(null,F/t.duration):(t.timer.restart(N),t.state=5,1),ue=-1,ce=a.length;++ue<ce;)a[ue].call(i,V);5===t.state&&(t.on.call("end",i,i.__data__,t.index,t.group),N())}function N(){for(var F in t.state=6,t.timer.stop(),delete o[n],o)return;delete i.__transition}o[n]=t,t.timer=wy(function l(F){t.state=1,t.timer.restart(_,t.delay,t.time),t.delay<=F&&_(F-t.delay)},0,t.time)}(i,t,{name:n,index:o,group:a,on:g1,tween:_1,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:0})}function Zm(i,n){var t=Kl(i,n);if(t.state>0)throw new Error("too late; already scheduled");return t}function Tc(i,n){var t=Kl(i,n);if(t.state>3)throw new Error("too late; already running");return t}function Kl(i,n){var t=i.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function b1(i,n){var t,o;return function(){var a=Tc(this,i),l=a.tween;if(l!==t)for(var _=0,C=(o=t=l).length;_<C;++_)if(o[_].name===n){(o=o.slice()).splice(_,1);break}a.tween=o}}function x1(i,n,t){var o,a;if("function"!=typeof t)throw new Error;return function(){var l=Tc(this,i),_=l.tween;if(_!==o){a=(o=_).slice();for(var C={name:n,value:t},N=0,F=a.length;N<F;++N)if(a[N].name===n){a[N]=C;break}N===F&&a.push(C)}l.tween=a}}function Nm(i,n,t){var o=i._id;return i.each(function(){var a=Tc(this,o);(a.value||(a.value={}))[n]=t.apply(this,arguments)}),function(a){return Kl(a,o).value[n]}}function Py(i,n){var t;return("number"==typeof n?Qa:n instanceof Kt?ma:(t=Kt(n))?(n=t,ma):pc)(i,n)}function w1(i){return function(){this.removeAttribute(i)}}function T1(i){return function(){this.removeAttributeNS(i.space,i.local)}}function M1(i,n,t){var o,l,a=t+"";return function(){var _=this.getAttribute(i);return _===a?null:_===o?l:l=n(o=_,t)}}function O1(i,n,t){var o,l,a=t+"";return function(){var _=this.getAttributeNS(i.space,i.local);return _===a?null:_===o?l:l=n(o=_,t)}}function S1(i,n,t){var o,a,l;return function(){var _,N,C=t(this);return null==C?void this.removeAttribute(i):(_=this.getAttribute(i))===(N=C+"")?null:_===o&&N===a?l:(a=N,l=n(o=_,C))}}function P1(i,n,t){var o,a,l;return function(){var _,N,C=t(this);return null==C?void this.removeAttributeNS(i.space,i.local):(_=this.getAttributeNS(i.space,i.local))===(N=C+"")?null:_===o&&N===a?l:(a=N,l=n(o=_,C))}}function A1(i,n){return function(t){this.setAttribute(i,n.call(this,t))}}function k1(i,n){return function(t){this.setAttributeNS(i.space,i.local,n.call(this,t))}}function I1(i,n){var t,o;function a(){var l=n.apply(this,arguments);return l!==o&&(t=(o=l)&&k1(i,l)),t}return a._value=n,a}function Z1(i,n){var t,o;function a(){var l=n.apply(this,arguments);return l!==o&&(t=(o=l)&&A1(i,l)),t}return a._value=n,a}function L1(i,n){return function(){Zm(this,i).delay=+n.apply(this,arguments)}}function z1(i,n){return n=+n,function(){Zm(this,i).delay=n}}function R1(i,n){return function(){Tc(this,i).duration=+n.apply(this,arguments)}}function F1(i,n){return n=+n,function(){Tc(this,i).duration=n}}function q1(i,n){if("function"!=typeof n)throw new Error;return function(){Tc(this,i).ease=n}}function H1(i,n,t){var o,a,l=function Y1(i){return(i+"").trim().split(/^|\s+/).every(function(n){var t=n.indexOf(".");return t>=0&&(n=n.slice(0,t)),!n||"start"===n})}(n)?Zm:Tc;return function(){var _=l(this,i),C=_.on;C!==o&&(a=(o=C).copy()).on(n,t),_.on=a}}var eb=Oh.prototype.constructor;function Ey(i){return function(){this.style.removeProperty(i)}}function sb(i,n,t){return function(o){this.style.setProperty(i,n.call(this,o),t)}}function lb(i,n,t){var o,a;function l(){var _=n.apply(this,arguments);return _!==a&&(o=(a=_)&&sb(i,_,t)),o}return l._value=n,l}function hb(i){return function(n){this.textContent=i.call(this,n)}}function fb(i){var n,t;function o(){var a=i.apply(this,arguments);return a!==t&&(n=(t=a)&&hb(a)),n}return o._value=i,o}var yb=0;function iu(i,n,t,o){this._groups=i,this._parents=n,this._name=t,this._id=o}function Ay(){return++yb}var Ap=Oh.prototype;iu.prototype=function vb(i){return Oh().transition(i)}.prototype={constructor:iu,select:function W1(i){var n=this._name,t=this._id;"function"!=typeof i&&(i=sd(i));for(var o=this._groups,a=o.length,l=new Array(a),_=0;_<a;++_)for(var V,ue,C=o[_],N=C.length,F=l[_]=new Array(N),ce=0;ce<N;++ce)(V=C[ce])&&(ue=i.call(V,V.__data__,ce,C))&&("__data__"in V&&(ue.__data__=V.__data__),F[ce]=ue,Wg(F[ce],n,t,ce,F,Kl(V,t)));return new iu(l,this._parents,n,t)},selectAll:function X1(i){var n=this._name,t=this._id;"function"!=typeof i&&(i=wc(i));for(var o=this._groups,a=o.length,l=[],_=[],C=0;C<a;++C)for(var V,N=o[C],F=N.length,ue=0;ue<F;++ue)if(V=N[ue]){for(var Te,ce=i.call(V,V.__data__,ue,N),We=Kl(V,t),it=0,He=ce.length;it<He;++it)(Te=ce[it])&&Wg(Te,n,t,it,ce,We);l.push(ce),_.push(V)}return new iu(l,_,n,t)},filter:function G1(i){"function"!=typeof i&&(i=tu(i));for(var n=this._groups,t=n.length,o=new Array(t),a=0;a<t;++a)for(var N,l=n[a],_=l.length,C=o[a]=[],F=0;F<_;++F)(N=l[F])&&i.call(N,N.__data__,F,l)&&C.push(N);return new iu(o,this._parents,this._name,this._id)},merge:function V1(i){if(i._id!==this._id)throw new Error;for(var n=this._groups,t=i._groups,o=n.length,l=Math.min(o,t.length),_=new Array(o),C=0;C<l;++C)for(var ce,N=n[C],F=t[C],V=N.length,ue=_[C]=new Array(V),Te=0;Te<V;++Te)(ce=N[Te]||F[Te])&&(ue[Te]=ce);for(;C<o;++C)_[C]=n[C];return new iu(_,this._parents,this._name,this._id)},selection:function tb(){return new eb(this._groups,this._parents)},transition:function _b(){for(var i=this._name,n=this._id,t=Ay(),o=this._groups,a=o.length,l=0;l<a;++l)for(var N,_=o[l],C=_.length,F=0;F<C;++F)if(N=_[F]){var V=Kl(N,n);Wg(N,i,t,F,_,{time:V.time+V.delay+V.duration,delay:0,duration:V.duration,ease:V.ease})}return new iu(o,this._parents,i,t)},call:Ap.call,nodes:Ap.nodes,node:Ap.node,size:Ap.size,empty:Ap.empty,each:Ap.each,on:function Q1(i,n){var t=this._id;return arguments.length<2?Kl(this.node(),t).on.on(i):this.each(H1(t,i,n))},attr:function E1(i,n){var t=Sp(i),o="transform"===t?p:Py;return this.attrTween(i,"function"==typeof n?(t.local?P1:S1)(t,o,Nm(this,"attr."+i,n)):null==n?(t.local?T1:w1)(t):(t.local?O1:M1)(t,o,n))},attrTween:function N1(i,n){var t="attr."+i;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==n)return this.tween(t,null);if("function"!=typeof n)throw new Error;var o=Sp(i);return this.tween(t,(o.local?I1:Z1)(o,n))},style:function ab(i,n,t){var o="transform"==(i+="")?h:Py;return null==n?this.styleTween(i,function nb(i,n){var t,o,a;return function(){var l=ud(this,i),_=(this.style.removeProperty(i),ud(this,i));return l===_?null:l===t&&_===o?a:a=n(t=l,o=_)}}(i,o)).on("end.style."+i,Ey(i)):"function"==typeof n?this.styleTween(i,function ob(i,n,t){var o,a,l;return function(){var _=ud(this,i),C=t(this),N=C+"";return null==C&&(this.style.removeProperty(i),N=C=ud(this,i)),_===N?null:_===o&&N===a?l:(a=N,l=n(o=_,C))}}(i,o,Nm(this,"style."+i,n))).each(function rb(i,n){var t,o,a,C,l="style."+n,_="end."+l;return function(){var N=Tc(this,i),F=N.on,V=null==N.value[l]?C||(C=Ey(n)):void 0;(F!==t||a!==V)&&(o=(t=F).copy()).on(_,a=V),N.on=o}}(this._id,i)):this.styleTween(i,function ib(i,n,t){var o,l,a=t+"";return function(){var _=ud(this,i);return _===a?null:_===o?l:l=n(o=_,t)}}(i,o,n),t).on("end.style."+i,null)},styleTween:function cb(i,n,t){var o="style."+(i+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==n)return this.tween(o,null);if("function"!=typeof n)throw new Error;return this.tween(o,lb(i,n,t??""))},text:function db(i){return this.tween("text","function"==typeof i?function pb(i){return function(){var n=i(this);this.textContent=n??""}}(Nm(this,"text",i)):function ub(i){return function(){this.textContent=i}}(null==i?"":i+""))},textTween:function gb(i){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==i)return this.tween(n,null);if("function"!=typeof i)throw new Error;return this.tween(n,fb(i))},remove:function $1(){return this.on("end.remove",function K1(i){return function(){var n=this.parentNode;for(var t in this.__transition)if(+t!==i)return;n&&n.removeChild(this)}}(this._id))},tween:function C1(i,n){var t=this._id;if(i+="",arguments.length<2){for(var _,o=Kl(this.node(),t).tween,a=0,l=o.length;a<l;++a)if((_=o[a]).name===i)return _.value;return null}return this.each((null==n?b1:x1)(t,i,n))},delay:function D1(i){var n=this._id;return arguments.length?this.each(("function"==typeof i?L1:z1)(n,i)):Kl(this.node(),n).delay},duration:function U1(i){var n=this._id;return arguments.length?this.each(("function"==typeof i?R1:F1)(n,i)):Kl(this.node(),n).duration},ease:function J1(i){var n=this._id;return arguments.length?this.each(q1(n,i)):Kl(this.node(),n).ease},easeVarying:function B1(i){if("function"!=typeof i)throw new Error;return this.each(function j1(i,n){return function(){var t=n.apply(this,arguments);if("function"!=typeof t)throw new Error;Tc(this,i).ease=t}}(this._id,i))},end:function mb(){var i,n,t=this,o=t._id,a=t.size();return new Promise(function(l,_){var C={value:_},N={value:function(){0==--a&&l()}};t.each(function(){var F=Tc(this,o),V=F.on;V!==i&&((n=(i=V).copy())._.cancel.push(C),n._.interrupt.push(C),n._.end.push(N)),F.on=n}),0===a&&l()})},[Symbol.iterator]:Ap[Symbol.iterator]};var xb={time:null,delay:0,duration:250,ease:function bb(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}};function Cb(i,n){for(var t;!(t=i.__transition)||!(t=t[n]);)if(!(i=i.parentNode))throw new Error(`transition ${n} not found`);return t}Oh.prototype.interrupt=function v1(i){return this.each(function(){!function y1(i,n){var o,a,_,t=i.__transition,l=!0;if(t){for(_ in n=null==n?null:n+"",t)(o=t[_]).name===n?(a=o.state>2&&o.state<5,o.state=6,o.timer.stop(),o.on.call(a?"interrupt":"cancel",i,i.__data__,o.index,o.group),delete t[_]):l=!1;l&&delete i.__transition}}(this,i)})},Oh.prototype.transition=function wb(i){var n,t;i instanceof iu?(n=i._id,i=i._name):(n=Ay(),(t=xb).time=Em(),i=null==i?null:i+"");for(var o=this._groups,a=o.length,l=0;l<a;++l)for(var N,_=o[l],C=_.length,F=0;F<C;++F)(N=_[F])&&Wg(N,i,n,F,_,t||Cb(N,n));return new iu(o,this._parents,i,n)};Math;function Ih(i){return{type:i}}function ln(i){return"string"==typeof i?new ts([[document.querySelector(i)]],[document.documentElement]):new ts([[i]],Pm)}function zy(i,n){if(i=function Ib(i){let n;for(;n=i.sourceEvent;)i=n;return i}(i),void 0===n&&(n=i.currentTarget),n){var t=n.ownerSVGElement||n;if(t.createSVGPoint){var o=t.createSVGPoint();return o.x=i.clientX,o.y=i.clientY,[(o=o.matrixTransform(n.getScreenCTM().inverse())).x,o.y]}if(n.getBoundingClientRect){var a=n.getBoundingClientRect();return[i.clientX-a.left-n.clientLeft,i.clientY-a.top-n.clientTop]}}return[i.pageX,i.pageY]}function Fm(i){i.stopImmediatePropagation()}function fd(i){i.preventDefault(),i.stopImmediatePropagation()}["w","e"].map(Ih),["n","s"].map(Ih),["n","w","e","s","nw","ne","sw","se"].map(Ih);const t_=i=>()=>i;function Um(i,{sourceEvent:n,subject:t,target:o,identifier:a,active:l,x:_,y:C,dx:N,dy:F,dispatch:V}){Object.defineProperties(this,{type:{value:i,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:_,enumerable:!0,configurable:!0},y:{value:C,enumerable:!0,configurable:!0},dx:{value:N,enumerable:!0,configurable:!0},dy:{value:F,enumerable:!0,configurable:!0},_:{value:V}})}function Lb(i){return!i.ctrlKey&&!i.button}function zb(){return this.parentNode}function Db(i,n){return n??{x:i.x,y:i.y}}function Rb(){return navigator.maxTouchPoints||"ontouchstart"in this}function Dy(){var C,N,F,V,i=Lb,n=zb,t=Db,o=Rb,a={},l=by("start","drag","end"),_=0,ue=0;function ce(vt){vt.on("mousedown.drag",Te).filter(o).on("touchstart.drag",He).on("touchmove.drag",et).on("touchend.drag touchcancel.drag",xt).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function Te(vt,Vt){if(!V&&i.call(this,vt,Vt)){var Dn=bt(this,n.call(this,vt,Vt),vt,Vt,"mouse");!Dn||(ln(vt.view).on("mousemove.drag",We,!0).on("mouseup.drag",it,!0),function Zb(i){var n=i.document.documentElement,t=ln(i).on("dragstart.drag",fd,!0);"onselectstart"in n?t.on("selectstart.drag",fd,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}(vt.view),Fm(vt),F=!1,C=vt.clientX,N=vt.clientY,Dn("start",vt))}}function We(vt){if(fd(vt),!F){var Vt=vt.clientX-C,Dn=vt.clientY-N;F=Vt*Vt+Dn*Dn>ue}a.mouse("drag",vt)}function it(vt){ln(vt.view).on("mousemove.drag mouseup.drag",null),function Nb(i,n){var t=i.document.documentElement,o=ln(i).on("dragstart.drag",null);n&&(o.on("click.drag",fd,!0),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in t?o.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}(vt.view,F),fd(vt),a.mouse("end",vt)}function He(vt,Vt){if(i.call(this,vt,Vt)){var Hn,Rn,Dn=vt.changedTouches,ei=n.call(this,vt,Vt),Yn=Dn.length;for(Hn=0;Hn<Yn;++Hn)(Rn=bt(this,ei,vt,Vt,Dn[Hn].identifier,Dn[Hn]))&&(Fm(vt),Rn("start",vt,Dn[Hn]))}}function et(vt){var ei,Yn,Vt=vt.changedTouches,Dn=Vt.length;for(ei=0;ei<Dn;++ei)(Yn=a[Vt[ei].identifier])&&(fd(vt),Yn("drag",vt,Vt[ei]))}function xt(vt){var ei,Yn,Vt=vt.changedTouches,Dn=Vt.length;for(V&&clearTimeout(V),V=setTimeout(function(){V=null},500),ei=0;ei<Dn;++ei)(Yn=a[Vt[ei].identifier])&&(Fm(vt),Yn("end",vt,Vt[ei]))}function bt(vt,Vt,Dn,ei,Yn,Hn){var qo,fi,dt,Rn=l.copy(),hi=zy(Hn||Dn,Vt);if(null!=(dt=t.call(vt,new Um("beforestart",{sourceEvent:Dn,target:ce,identifier:Yn,active:_,x:hi[0],y:hi[1],dx:0,dy:0,dispatch:Rn}),ei)))return qo=dt.x-hi[0]||0,fi=dt.y-hi[1]||0,function fn(Pt,kn,Qn){var Kn,Vn=hi;switch(Pt){case"start":a[Yn]=fn,Kn=_++;break;case"end":delete a[Yn],--_;case"drag":hi=zy(Qn||kn,Vt),Kn=_}Rn.call(Pt,vt,new Um(Pt,{sourceEvent:kn,subject:dt,target:ce,identifier:Yn,active:Kn,x:hi[0]+qo,y:hi[1]+fi,dx:hi[0]-Vn[0],dy:hi[1]-Vn[1],dispatch:Rn}),ei)}}return ce.filter=function(vt){return arguments.length?(i="function"==typeof vt?vt:t_(!!vt),ce):i},ce.container=function(vt){return arguments.length?(n="function"==typeof vt?vt:t_(vt),ce):n},ce.subject=function(vt){return arguments.length?(t="function"==typeof vt?vt:t_(vt),ce):t},ce.touchable=function(vt){return arguments.length?(o="function"==typeof vt?vt:t_(!!vt),ce):o},ce.on=function(){var vt=l.on.apply(l,arguments);return vt===l?ce:vt},ce.clickDistance=function(vt){return arguments.length?(ue=(vt=+vt)*vt,ce):Math.sqrt(ue)},ce}function Fb(i){var n=0,t=i.children,o=t&&t.length;if(o)for(;--o>=0;)n+=t[o].value;else n=1;i.value=n}function Zh(i,n){i instanceof Map?(i=[void 0,i],void 0===n&&(n=n0)):void 0===n&&(n=t0);for(var o,l,_,C,N,t=new Nh(i),a=[t];o=a.pop();)if((_=n(o.data))&&(N=(_=Array.from(_)).length))for(o.children=_,C=N-1;C>=0;--C)a.push(l=_[C]=new Nh(_[C])),l.parent=o,l.depth=o.depth+1;return t.eachBefore(r0)}function t0(i){return i.children}function n0(i){return Array.isArray(i)?i[1]:null}function o0(i){void 0!==i.data.value&&(i.value=i.data.value),i.data=i.data.data}function r0(i){var n=0;do{i.height=n}while((i=i.parent)&&i.height<++n)}function Nh(i){this.data=i,this.depth=this.height=0,this.parent=null}function a0(i,n){return i.parent===n.parent?1:2}function qm(i){var n=i.children;return n?n[0]:i.t}function Jm(i){var n=i.children;return n?n[n.length-1]:i.t}function s0(i,n,t){var o=t/(n.i-i.i);n.c-=o,n.s+=t,i.c+=o,n.z+=t,n.m+=t}function c0(i,n,t){return i.a.parent===n.parent?i.a:t}function n_(i,n){this._=i,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function Ry(){var i=a0,n=1,t=1,o=null;function a(F){var V=function u0(i){for(var t,a,l,_,C,n=new n_(i,0),o=[n];t=o.pop();)if(l=t._.children)for(t.children=new Array(C=l.length),_=C-1;_>=0;--_)o.push(a=t.children[_]=new n_(l[_],_)),a.parent=t;return(n.parent=new n_(null,0)).children=[n],n}(F);if(V.eachAfter(l),V.parent.m=-V.z,V.eachBefore(_),o)F.eachBefore(N);else{var ue=F,ce=F,Te=F;F.eachBefore(function(xt){xt.x<ue.x&&(ue=xt),xt.x>ce.x&&(ce=xt),xt.depth>Te.depth&&(Te=xt)});var We=ue===ce?1:i(ue,ce)/2,it=We-ue.x,He=n/(ce.x+We+it),et=t/(Te.depth||1);F.eachBefore(function(xt){xt.x=(xt.x+it)*He,xt.y=xt.depth*et})}return F}function l(F){var V=F.children,ue=F.parent.children,ce=F.i?ue[F.i-1]:null;if(V){!function l0(i){for(var l,n=0,t=0,o=i.children,a=o.length;--a>=0;)(l=o[a]).z+=n,l.m+=n,n+=l.s+(t+=l.c)}(F);var Te=(V[0].z+V[V.length-1].z)/2;ce?(F.z=ce.z+i(F._,ce._),F.m=F.z-Te):F.z=Te}else ce&&(F.z=ce.z+i(F._,ce._));F.parent.A=function C(F,V,ue){if(V){for(var vt,ce=F,Te=F,We=V,it=ce.parent.children[0],He=ce.m,et=Te.m,xt=We.m,bt=it.m;We=Jm(We),ce=qm(ce),We&&ce;)it=qm(it),(Te=Jm(Te)).a=F,(vt=We.z+xt-ce.z-He+i(We._,ce._))>0&&(s0(c0(We,F,ue),F,vt),He+=vt,et+=vt),xt+=We.m,He+=ce.m,bt+=it.m,et+=Te.m;We&&!Jm(Te)&&(Te.t=We,Te.m+=xt-et),ce&&!qm(it)&&(it.t=ce,it.m+=He-bt,ue=F)}return ue}(F,ce,F.parent.A||ue[0])}function _(F){F._.x=F.z+F.parent.m,F.m+=F.parent.m}function N(F){F.x*=n,F.y=F.depth*t}return a.separation=function(F){return arguments.length?(i=F,a):i},a.size=function(F){return arguments.length?(o=!1,n=+F[0],t=+F[1],a):o?null:[n,t]},a.nodeSize=function(F){return arguments.length?(o=!0,n=+F[0],t=+F[1],a):o?[n,t]:null},a}function Qu(i){return"string"==typeof i?new ts([document.querySelectorAll(i)],[document.documentElement]):new ts([null==i?[]:xh(i)],Pm)}function gd(i,n,t){this.k=i,this.x=n,this.y=t}function wl(i,n,t="#svg"){let _=ln(t).append("g").classed("g-text-calc",!0).append("text").attr("x",-5e3).attr("y",-5e3).attr("font-size",n).text(i).node().getBBox();return ln(".g-text-calc").remove(),_.width+2}function jm(i,n){let t=ln("#svg").node(),o=t.createSVGPoint();return o.x=i,o.y=n,o.matrixTransform(t.getScreenCTM().inverse())}function Tl(i,n){return i.y>n.y&&i.y<n.y+n.height&&i.x>n.x&&i.x<n.x+n.width}function Bm(i){return{x:parseInt(i.attr("x")),y:parseInt(i.attr("y")),width:parseInt(i.attr("width")),height:parseInt(i.attr("height"))}}Um.prototype.on=function(){var i=this._.on.apply(this._,arguments);return i===this._?this:i},Nh.prototype=Zh.prototype={constructor:Nh,count:function Ub(){return this.eachAfter(Fb)},each:function qb(i,n){let t=-1;for(const o of this)i.call(n,o,++t,this);return this},eachAfter:function jb(i,n){for(var l,_,C,t=this,o=[t],a=[],N=-1;t=o.pop();)if(a.push(t),l=t.children)for(_=0,C=l.length;_<C;++_)o.push(l[_]);for(;t=a.pop();)i.call(n,t,++N,this);return this},eachBefore:function Jb(i,n){for(var a,l,t=this,o=[t],_=-1;t=o.pop();)if(i.call(n,t,++_,this),a=t.children)for(l=a.length-1;l>=0;--l)o.push(a[l]);return this},find:function Bb(i,n){let t=-1;for(const o of this)if(i.call(n,o,++t,this))return o},sum:function Gb(i){return this.eachAfter(function(n){for(var t=+i(n.data)||0,o=n.children,a=o&&o.length;--a>=0;)t+=o[a].value;n.value=t})},sort:function Vb(i){return this.eachBefore(function(n){n.children&&n.children.sort(i)})},path:function Yb(i){for(var n=this,t=function Hb(i,n){if(i===n)return i;var t=i.ancestors(),o=n.ancestors(),a=null;for(i=t.pop(),n=o.pop();i===n;)a=i,i=t.pop(),n=o.pop();return a}(n,i),o=[n];n!==t;)o.push(n=n.parent);for(var a=o.length;i!==t;)o.splice(a,0,i),i=i.parent;return o},ancestors:function Qb(){for(var i=this,n=[i];i=i.parent;)n.push(i);return n},descendants:function Kb(){return Array.from(this)},leaves:function $b(){var i=[];return this.eachBefore(function(n){n.children||i.push(n)}),i},links:function Wb(){var i=this,n=[];return i.each(function(t){t!==i&&n.push({source:t.parent,target:t})}),n},copy:function e0(){return Zh(this).eachBefore(o0)},[Symbol.iterator]:function*Xb(){var n,o,a,l,i=this,t=[i];do{for(n=t.reverse(),t=[];i=n.pop();)if(yield i,o=i.children)for(a=0,l=o.length;a<l;++a)t.push(o[a])}while(t.length)}},n_.prototype=Object.create(Nh.prototype),gd.prototype={constructor:gd,scale:function(i){return 1===i?this:new gd(this.k*i,this.x,this.y)},translate:function(i,n){return 0===i&0===n?this:new gd(this.k,this.x+this.k*i,this.y+this.k*n)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new gd(1,0,0);var Ln=v(80018);class ru{constructor(n,t){this.localizedValue=n,this.localeValues=t}getValue(n){let t=this.localeValues.length;for(let o=0;o<t;++o){let a=this.localeValues[o];if(a.locale===n)return a.value}return this.localizedValue}static populate(n,t){null==n||null==t||(n.localizedValue=t.localizedValue,null!=t.localeValues&&t.localeValues.forEach(o=>{if(n.localeValues){let a=!1;n.localeValues.forEach(l=>{!a&&l.locale===o.locale&&(l.value=o.value,a=!0)}),a||n.localeValues.push(JSON.parse(JSON.stringify(o)))}else n.localeValues=t.localeValues}))}}var y0=v(15013),v0=v.n(y0);function Lh(i){if(!i)throw new Error("obj is required");var n;if(i.length?n=i:i.coordinates?n=i.coordinates:i.geometry&&i.geometry.coordinates&&(n=i.geometry.coordinates),n)return Uy(n),n;throw new Error("No valid coordinates")}function Uy(i){if(i.length>1&&si(i[0])&&si(i[1]))return!0;if(Array.isArray(i[0])&&i[0].length)return Uy(i[0]);throw new Error("coordinates must only contain numbers")}function Gm(i,n){if(!i)throw new Error((n||"geojson")+" is required");if(i.geometry&&i.geometry.type)return i.geometry.type;if(i.type)return i.type;throw new Error((n||"geojson")+" is invalid")}function Vm(i){var n=Lh(i);if(2===n.length&&!function x0(i,n){return i[0]===n[0]&&i[1]===n[1]}(n[0],n[1]))return n;var o,a,l=[],_=n.length-1;l.push(n[0]);for(var C=1;C<_;C++)C0(n[C-1],a=n[C+1],o=n[C])||l.push(o);return l.push(a),l}function C0(i,n,t){var o=t[0],a=t[1],l=i[0],_=i[1],C=n[0],N=n[1],ue=C-l,ce=N-_;return 0==(o-l)*ce-(a-_)*ue&&(Math.abs(ue)>=Math.abs(ce)?ue>0?l<=o&&o<=C:C<=o&&o<=l:ce>0?_<=a&&a<=N:N<=a&&a<=_)}const qy=function b0(i,n){var t="object"==typeof n?n.mutate:n;if(!i)throw new Error("geojson is required");var o=Gm(i),a=[];switch(o){case"LineString":a=Vm(i);break;case"MultiLineString":case"Polygon":Lh(i).forEach(function(_){a.push(Vm(_))});break;case"MultiPolygon":Lh(i).forEach(function(_){var C=[];_.forEach(function(N){C.push(Vm(N))}),a.push(C)});break;case"Point":return i;case"MultiPoint":var l={};Lh(i).forEach(function(_){var C=_.join("-");l.hasOwnProperty(C)||(a.push(_),l[C]=!0)});break;default:throw new Error(o+" geometry not supported")}return i.coordinates?!0===t?(i.coordinates=a,i):{type:o,coordinates:a}:!0===t?(i.geometry.coordinates=a,i):Me({type:o,coordinates:a},i.properties,i.bbox)},Jy=function w0(i,n){if(!i)throw new Error("feature1 is required");if(!n)throw new Error("feature2 is required");return Gm(i)===Gm(n)&&new(v0())({precision:6}).compare(qy(i),qy(n))};class ol{static removeStatuses(n){let t=[];for(let o=0;o<n.length;++o)"CGR:Status-New"===n[o].code||"CGR:Status-Pending"===n[o].code||t.push(n[o]);return t}static formatDateString(n){const t=n.getUTCDate(),o=n.getUTCMonth()+1;return n.getUTCFullYear()+"-"+(o<10?"0":"")+o+"-"+(t<10?"0":"")+t}static dateRangeOverlaps(n,t,o,a){return n<=o&&o<=t||n<=a&&a<=t||o<n&&t<a}static dateRangeOutside(n,t,o,a){return n<o||t>a}static dateEndBeforeStart(n,t){return t<n}static hasGap(n,t){return t-n>864e5}static areValuesEqual(n,t,o){if("boolean"===n.type)return t===o;if(""===t&&null==o||""===o&&null==t||!t&&!o)return!0;if(!t&&o||!o&&t)return!1;if("term"===n.type){if(null!=t&&null!=o)return t.length===o.length&&t[0]===o[0]}else{if("geometry"===n.type)return(null==t||null==t.coordinates||null==t.coordinates.length||null==o||null==o.coordinates||null==o.coordinates.length||t.coordinates.length===o.coordinates.length)&&Jy(t,o);if("date"===n.type)return("string"==typeof t?parseInt(t):t)===("string"==typeof o?parseInt(o):o);if("local"===n.type){if(!t.localeValues||!o.localeValues||t.localeValues.length!==o.localeValues.length)return!1;let a=t.localeValues.length;for(let l=0;l<a;++l){let _=t.localeValues[l],C=this.getValueAtLocale(o,_.locale),N=_.value;if(!(""===N&&null==C||""===C&&null==N)&&N!==C)return!1}return!0}if("_PARENT_"===n.type&&t.parents&&o.parents){for(const[a,l]of Object.entries(t.parents)){let _=l;if(o.parents[a]){let C=o.parents[a];if(null!=_.geoObject||null!=C.geoObject){if(null==_.geoObject&&null!=C.geoObject||null==C.geoObject&&null!=_.geoObject)return!1;if(_.geoObject.properties.code!==C.geoObject.properties.code)return!1}}}return!0}if("integer"===n.type)return("string"==typeof t?parseInt(t):t)===("string"==typeof o?parseInt(o):o);if("float"===n.type)return("string"==typeof t?parseFloat(t):t)===("string"==typeof o?parseFloat(o):o)}return t===o}static getValueAtLocale(n,t){return new ru(n.localizedValue,n.localeValues).getValue(t)}static arrayMove(n,t,o){if(o>=n.length){let a=o-n.length+1;for(;a--;)n.push(void 0)}n.splice(o,0,n.splice(t,1)[0])}static createColumn(n,t,o){let a={headerType:"ATTRIBUTE",header:n.label,field:n.name,type:"TEXT",sortable:!t,filter:!t,rowspan:n.rowspan,colspan:n.colspan};return"date"===n.type?a.type="DATE":"invalid"===n.name||"boolean"===n.type?a.type="BOOLEAN":"number"===n.type?a.type="NUMBER":!t&&"list"===n.type&&(a.type="AUTOCOMPLETE",a.text="",a.onComplete=()=>{o(n,a)}),a}static createColumns(n,t,o,a){const l=!o&&t,_=[],C=[],N=[],F=[];if(!o&&(n.isMember||"PUBLIC"===n.geospatialMetadata.visibility)){const V={header:"",type:"ACTIONS",sortable:!1,rowspan:3,colspan:1,headerType:"ATTRIBUTE"};C.push(V),_.push(V)}return n.attributes.forEach(V=>{(l||"invalid"!==V.name)&&(C.push({header:V.label,colspan:V.colspan,rowspan:V.rowspan,headerType:"GROUP"}),V.columns.forEach(ue=>{if(null!=ue.columns)N.push({header:ue.label,colspan:ue.colspan,rowspan:ue.rowspan,headerType:"GROUP"}),ue.columns.forEach(ce=>{if(l||"invalid"!==ce.name){const Te=this.createColumn(ce,o,a);F.push(Te),_.push(Te)}});else if(l||"invalid"!==ue.name){const ce=this.createColumn(ue,o,a);N.push(ce),_.push(ce)}}))}),{headers:[C,N,F],columns:_}}}class T0{constructor(n){this.registryService=n,this.refreshPromise=this.refresh()}waitOnTypes(){return this.refreshPromise?this.refreshPromise:null==this.types?this.refreshPromise=this.refresh():new Promise((n,t)=>n(this.types))}ready(){return null!=this.types}refresh(){return this.registryService.getGeoObjectTypes(null).then(n=>(this.refreshPromise=null,this.types=n,this.types)).catch(n=>(this.types=null,this.refreshPromise=null,this.types))}getTypeByCode(n){if(!this.types)return null;let t=this.types.findIndex(o=>o.code===n);return-1===t?null:this.types[t]}getTypes(){return this.types}}class _d{constructor(){this.attributes=[]}static getAttribute(n,t){let o=n.attributes.length;for(let a=0;a<o;a++){let l=n.attributes[a];if(l.code===t)return l}return null}static getGeoObjectTypeTermAttributeOptions(n,t){for(let o=0;o<n.attributes.length;o++){let a=n.attributes[o];if("term"===a.type&&a.code===t){let l=a.rootTerm.children;if(l.length>0)return"status"===a.code?ol.removeStatuses(l):l}}return null}}class kp{constructor(n,t){this.geoObjectType=n,this.attributes=t}getVotAtDate(n,t,o){let a={startDate:n,endDate:null,value:null};const l=n.getTime();for(let _=0;_<this.geoObjectType.attributes.length;++_){let C=this.geoObjectType.attributes[_];if(C.code===t){"local"===C.type&&(a.value=o.create()),C.isChangeOverTime?this.attributes[C.code].values.forEach(F=>{const V=Date.parse(F.startDate),ue=Date.parse(F.endDate);l>=V&&l<=ue&&(a.value="local"===C.type?JSON.parse(JSON.stringify(F.value)):"term"===C.type&&null!=F.value&&Array.isArray(F.value)&&F.value.length>0?F.value[0]:F.value)}):a.value=this.attributes[C.code];break}}return a}}class M0{}class O0{}class md{static buildBaseUrl(){let n="wss";return n=-1!==window.location.protocol.indexOf("https")?"wss":"ws",n+"://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+Xc.Z.getApiUrl()}}var S0=v(70930),Ym=v(4707);const P0={url:"",deserializer:i=>JSON.parse(i.data),serializer:i=>JSON.stringify(i)};class Hm extends pn.u{constructor(n,t){if(super(),this._socket=null,n instanceof Ni.y)this.destination=t,this.source=n;else{const o=this._config=Object.assign({},P0);if(this._output=new pn.x,"string"==typeof n)o.url=n;else for(const a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);if(!o.WebSocketCtor&&WebSocket)o.WebSocketCtor=WebSocket;else if(!o.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new Ym.t}}lift(n){const t=new Hm(this._config,this.destination);return t.operator=n,t.source=this,t}_resetState(){this._socket=null,this.source||(this.destination=new Ym.t),this._output=new pn.x}multiplex(n,t,o){const a=this;return new Ni.y(l=>{try{a.next(n())}catch(C){l.error(C)}const _=a.subscribe({next:C=>{try{o(C)&&l.next(C)}catch(N){l.error(N)}},error:C=>l.error(C),complete:()=>l.complete()});return()=>{try{a.next(t())}catch(C){l.error(C)}_.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:n,protocol:t,url:o,binaryType:a}=this._config,l=this._output;let _=null;try{_=t?new n(o,t):new n(o),this._socket=_,a&&(this._socket.binaryType=a)}catch(N){return void l.error(N)}const C=new Ui.w0(()=>{this._socket=null,_&&1===_.readyState&&_.close()});_.onopen=N=>{const{_socket:F}=this;if(!F)return _.close(),void this._resetState();const{openObserver:V}=this._config;V&&V.next(N);const ue=this.destination;this.destination=S0.Lv.create(ce=>{if(1===_.readyState)try{const{serializer:Te}=this._config;_.send(Te(ce))}catch(Te){this.destination.error(Te)}},ce=>{const{closingObserver:Te}=this._config;Te&&Te.next(void 0),ce&&ce.code?_.close(ce.code,ce.reason):l.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:ce}=this._config;ce&&ce.next(void 0),_.close(),this._resetState()}),ue&&ue instanceof Ym.t&&C.add(ue.subscribe(this.destination))},_.onerror=N=>{this._resetState(),l.error(N)},_.onclose=N=>{_===this._socket&&this._resetState();const{closeObserver:F}=this._config;F&&F.next(N),N.wasClean?l.complete():l.error(N)},_.onmessage=N=>{try{const{deserializer:F}=this._config;l.next(F(N))}catch(F){l.error(F)}}}_subscribe(n){const{source:t}=this;return t?t.subscribe(n):(this._socket||this._connectSocket(),this._output.subscribe(n),n.add(()=>{const{_socket:o}=this;0===this._output.observers.length&&(o&&(1===o.readyState||0===o.readyState)&&o.close(),this._resetState())}),n)}unsubscribe(){const{_socket:n}=this;n&&(1===n.readyState||0===n.readyState)&&n.close(),this._resetState(),super.unsubscribe()}}function Ip(i){return new Hm(i)}class $l{constructor(n,t){this.http=n,this.eventService=t}implementDecisions(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/changerequest/implement-decisions",JSON.stringify({request:n,newCode:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}update(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/changerequest/update",JSON.stringify({request:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}setActionStatus(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/changerequest/set-action-status",JSON.stringify({actionOid:n,status:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getAllRequests(n,t,o,a,l){let _=new ot.LE;return _=_.set("pageSize",n.toString()),_=_.set("pageNumber",t.toString()),_=_.set("filter",o),_=_.set("sort",JSON.stringify(a)),null!=l&&(_=_.set("oid",l)),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/changerequest/get-all-requests",{params:_}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}rejectChangeRequest(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/changerequest/reject",JSON.stringify({request:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}delete(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/changerequest/delete",JSON.stringify({requestId:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteFile(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/changerequest/delete-file-cr",JSON.stringify({requestId:n,fileId:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}}$l.\u0275fac=function(n){return new(n||$l)(e.LFG(ot.eN),e.LFG(nn.PO))},$l.\u0275prov=e.Yz7({token:$l,factory:$l.\u0275fac});class Wl{constructor(n,t){this.http=n,this.eventService=t}getHierarchyTypes(n){let t=new ot.LE;return t=t.set("types",JSON.stringify(n)),this.http.get(pt.N.apiUrl+"/api/hierarchytype/get-all",{params:t}).toPromise()}getHierarchyGroupedTypes(){let n=new ot.LE;return this.http.get(pt.N.apiUrl+"/api/hierarchytype/groupedTypes",{params:n}).toPromise()}addChildToHierarchy(n,t,o){let a=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/add",JSON.stringify({hierarchyCode:n,parentGeoObjectTypeCode:t,childGeoObjectTypeCode:o}),{headers:a}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}insertBetweenTypes(n,t,o,a){let l=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/insertBetweenTypes",JSON.stringify({hierarchyCode:n,parentGeoObjectTypeCode:t,middleGeoObjectTypeCode:o,youngestGeoObjectTypeCode:a}),{headers:l}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}removeFromHierarchy(n,t,o){let a=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/remove",JSON.stringify({hierarchyCode:n,parentGeoObjectTypeCode:t,childGeoObjectTypeCode:o}),{headers:a}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}createHierarchyType(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/create",JSON.stringify({hierarchyType:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}updateHierarchyType(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/update",JSON.stringify({hierarchyType:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteHierarchyType(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/delete",{code:n},{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}setInheritedHierarchy(n,t,o){let a=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/setInherited",JSON.stringify({hierarchyTypeCode:n,inheritedHierarchyTypeCode:t,geoObjectTypeCode:o}),{headers:a}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}removeInheritedHierarchy(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/hierarchytype/removeInherited",JSON.stringify({hierarchyTypeCode:n,geoObjectTypeCode:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}}Wl.\u0275fac=function(n){return new(n||Wl)(e.LFG(ot.eN),e.LFG(nn.PO))},Wl.\u0275prov=e.Yz7({token:Wl,factory:Wl.\u0275fac});class pr{constructor(n,t){this.http=n,this.eventService=t}importSpreadsheet(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/etl/import",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}cancelImport(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/etl/cancel-import",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}importShapefile(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/etl/import",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}listGeoObjectTypes(n){let t=new ot.LE;return t=t.set("includeAbstractTypes",n.toString()),this.http.get(pt.N.apiUrl+"/api/geoobjecttype/list-types",{params:t}).toPromise()}getTypeAncestors(n,t,o,a=!1){let l=new ot.LE;return l=l.set("code",n),l=l.set("hierarchyCode",t),l=l.set("includeInheritedTypes",o.toString()),l=l.set("includeChild",a.toString()),this.http.get(pt.N.apiUrl+"/api/geoobjecttype/get-ancestors",{params:l}).toPromise()}getHierarchiesForType(n,t){let o=new ot.LE;return o=o.set("code",n),o=o.set("includeTypes",t.toString()),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/geoobjecttype/get-hierarchies",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getHierarchiesForSubtypes(n,t){let o=new ot.LE;return o=o.set("code",n),o=o.set("includeTypes",t.toString()),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/geoobjecttype/get-subtype-hierarchies",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getGeoObjectSuggestions(n,t,o,a){let l=new ot.LE;return l=l.set("text",n),l=l.set("type",t),null!=o&&null!=a&&(l=l.set("parent",o),l=l.set("hierarchy",a)),this.http.get(pt.N.apiUrl+"/api/geoobject/suggestions",{params:l}).toPromise()}createGeoObjectSynonym(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/geo-synonym/create-geo-entity-synonym",JSON.stringify({entityId:n,label:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteGeoObjectSynonym(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/geo-synonym/create-geo-entity-synonym",JSON.stringify({oid:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getTermSuggestions(n,t,o){let a=new ot.LE;return a=a.set("mdAttributeId",n),a=a.set("text",t),a=a.set("limit",o),this.http.get(pt.N.apiUrl+"/uploader/getClassifierSuggestions",{params:a}).toPromise()}createTermSynonym(n,t){let o=new ot.WM({"Content-Type":"application/json"}),a=JSON.stringify({classifierId:n,label:t});return this.http.post(pt.N.apiUrl+"/uploader/createClassifierSynonym",a,{headers:o}).toPromise()}deleteTermSynonym(n){let t=new ot.WM({"Content-Type":"application/json"}),o=JSON.stringify({synonymId:n});return this.http.post(pt.N.apiUrl+"/uploader/deleteClassifierSynonym",o,{headers:t}).toPromise()}createTerm(n,t,o){let a=new ot.WM({"Content-Type":"application/json"});return this.http.post(pt.N.apiUrl+"/api/geoobjecttype/addterm",JSON.stringify({parentTermCode:o,termJSON:{label:n,code:t}}),{headers:a}).toPromise()}removeTerm(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.http.post(pt.N.apiUrl+"/api/geoobjecttype/deleteterm",JSON.stringify({parentTermCode:n,termCode:t}),{headers:o}).toPromise()}}pr.\u0275fac=function(n){return new(n||pr)(e.LFG(ot.eN),e.LFG(nn.PO))},pr.\u0275prov=e.Yz7({token:pr,factory:pr.\u0275fac});class Zp{constructor(n,t){this.http=n,this.eventService=t}getNewLocaleInfo(){return this.http.get(pt.N.apiUrl+"/api/localization/getNewLocaleInformation").toPromise()}installLocale(n,t,o){let a=new ot.LE;return null!=n&&(a=a.set("language",n)),null!=t&&(a=a.set("country",t)),null!=o&&(a=a.set("variant",o)),this.http.get(pt.N.apiUrl+"/api/localization/installLocale",{params:a}).toPromise()}}Zp.\u0275fac=function(n){return new(n||Zp)(e.LFG(ot.eN),e.LFG(nn.PO))},Zp.\u0275prov=e.Yz7({token:Zp,factory:Zp.\u0275fac});class Ls{constructor(n,t){this.http=n,this.eventService=t}getPage(n,t){let o=new ot.LE;return o=o.set("pageNumber",n.toString()),o=o.set("pageSize",t.toString()),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/synchronization-config/get-all",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}get(n){let t=new ot.LE;return t=t.set("oid",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/synchronization-config/get",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getCustomAttrCfg(n,t){let o=new ot.LE;return o=o.set("externalId",t),o=o.set("geoObjectTypeCode",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/synchronization-config/get-custom-attr",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getConfigForES(n,t){let o=new ot.LE;return o=o.set("externalSystemId",n),o=o.set("hierarchyTypeCode",t),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/synchronization-config/get-config-for-es",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}apply(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/synchronization-config/apply",JSON.stringify({config:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}edit(n){let t=new ot.WM({"Content-Type":"application/json"}),o={};return null!=n&&(o={oid:n}),this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/synchronization-config/edit",JSON.stringify(o),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}remove(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/synchronization-config/remove",JSON.stringify({oid:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}unlock(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/synchronization-config/unlock",JSON.stringify({oid:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}run(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/synchronization-config/run",JSON.stringify({oid:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getJobs(n,t,o){let a=new ot.LE;return a=a.set("oid",n),a=a.set("pageNumber",t.toString()),a=a.set("pageSize",o.toString()),this.http.get(pt.N.apiUrl+"/api/synchronization-config/get-jobs",{params:a}).toPromise()}getFhirExportImplementations(){let n=new ot.LE;return this.http.get(pt.N.apiUrl+"/api/synchronization-config/get-fhir-export-implementations",{params:n}).toPromise()}getFhirImportImplementations(){let n=new ot.LE;return this.http.get(pt.N.apiUrl+"/api/synchronization-config/get-fhir-import-implementations",{params:n}).toPromise()}}Ls.\u0275fac=function(n){return new(n||Ls)(e.LFG(ot.eN),e.LFG(nn.PO))},Ls.\u0275prov=e.Yz7({token:Ls,factory:Ls.\u0275fac});class Ku{constructor(n,t){this.http=n,this.eventService=t}getMyTasks(n,t,o){let a=new ot.LE;return a=a.set("orderBy","createDate"),a=a.set("pageNum",n.toString()),a=a.set("pageSize",t.toString()),a=a.set("whereStatus",o),this.http.get(pt.N.apiUrl+"/api/tasks/get",{params:a}).toPromise()}completeTask(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/tasks/complete",JSON.stringify({id:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}setTaskStatus(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/tasks/setTaskStatus",JSON.stringify({id:n,status:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}}Ku.\u0275fac=function(n){return new(n||Ku)(e.LFG(ot.eN),e.LFG(nn.PO))},Ku.\u0275prov=e.Yz7({token:Ku,factory:Ku.\u0275fac});class Ml{constructor(n){this.service=n,this.subscription=null,this.typeCache=new T0(this.service);let t=md.buildBaseUrl();this.notifier=Ip(t+"/websocket/notify"),this.subscription=this.notifier.subscribe(o=>{"TYPE_CACHE_CHANGE"===o.type&&this.typeCache.refresh()})}getTypeCache(){return this.typeCache}}Ml.\u0275fac=function(n){return new(n||Ml)(e.LFG(Zi))},Ml.\u0275prov=e.Yz7({token:Ml,factory:Ml.\u0275fac});var rl=v(78818);function A0(i,n){1&i&&e._UZ(0,"option")}function k0(i,n){if(1&i&&(e.TgZ(0,"option",11),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.oid),e.xp6(1),e.Oqu(t.label.localizedValue)}}function I0(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",9),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.graphOid=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSelectRelationship())}),e.YNc(1,A0,1,0,"option",8),e.YNc(2,k0,2,2,"option",10),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("ngModel",t.graphOid),e.xp6(1),e.Q6J("ngIf",0===t.relationships.length),e.xp6(1),e.Q6J("ngForOf",t.relationships)}}const Z0=function(i){return{background:i}};function N0(i,n){if(1&i&&(e.TgZ(0,"div",12),e._UZ(1,"div",13),e.TgZ(2,"label"),e._uU(3),e.qZA()()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngStyle",e.VKq(2,Z0,t.value.color)),e.xp6(2),e.Oqu(t.value.label)}}function L0(i,n){1&i&&(e.ynx(0),e.O4$(),e.TgZ(1,"marker",21),e._UZ(2,"path",22),e.qZA(),e.BQk())}function z0(i,n){if(1&i&&e.YNc(0,L0,3,0,"ng-container",8),2&i){const t=e.oxw(4);e.Q6J("ngIf","UndirectedGraphType"!==t.relationship.type)}}function D0(i,n){if(1&i&&(e.O4$(),e._UZ(0,"polygon")),2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.uIk("points",o.getHexagonPoints(t))("fill",null==o.state.code?t.data.color:o.typeLegend[t.typeCode].color)}}function R0(i,n){if(1&i&&(e.O4$(),e._UZ(0,"rect")),2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.uIk("width",o.DIMENSIONS.NODE.WIDTH)("height",o.DIMENSIONS.NODE.HEIGHT)("y",o.DIMENSIONS.NODE.HEIGHT/2)("x","VERTICAL"===o.relationship.layout?"CHILD"===t.relation?o.DIMENSIONS.LABEL.WIDTH/2-o.DIMENSIONS.NODE.WIDTH/2:(o.DIMENSIONS.LABEL.WIDTH+o.DIMENSIONS.PADDING.NODE_LABEL+o.DIMENSIONS.NODE.WIDTH)/2-o.DIMENSIONS.NODE.WIDTH/2:"PARENT"===t.relation?o.DIMENSIONS.LABEL.WIDTH+o.DIMENSIONS.PADDING.NODE_LABEL+o.DIMENSIONS.PADDING.NODE_EDGE:o.DIMENSIONS.PADDING.NODE_EDGE)("fill",null==o.state.code?t.data.color:o.typeLegend[t.typeCode].color)}}const F0=function(i,n,t){return{"text-align":i,color:n,"font-weight":t}};function U0(i,n){if(1&i){const t=e.EpF();e.O4$(),e.TgZ(0,"g",23),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(4);return e.KtG(_.onClickNode(l))}),e.YNc(1,D0,1,2,"polygon",8),e.YNc(2,R0,1,5,"rect",8),e.TgZ(3,"foreignObject"),e.kcU(),e.TgZ(4,"span")(5,"p",24),e._uU(6),e.qZA()()()()}if(2&i){const t=n.$implicit,o=e.oxw(4);e.Udp("cursor","SELECTED"===t.relation?"default":"pointer"),e.xp6(1),e.Q6J("ngIf","GEOOBJECT"===t.objectType),e.xp6(1),e.Q6J("ngIf","BUSINESS"===t.objectType),e.xp6(1),e.uIk("x","VERTICAL"===o.relationship.layout?"CHILD"===t.relation?0:(o.DIMENSIONS.LABEL.WIDTH+o.DIMENSIONS.PADDING.NODE_LABEL+o.DIMENSIONS.NODE.WIDTH)/2+o.DIMENSIONS.NODE.WIDTH/2+o.DIMENSIONS.PADDING.NODE_LABEL:"PARENT"===t.relation?o.DIMENSIONS.PADDING.NODE_LABEL:o.DIMENSIONS.NODE.WIDTH+o.DIMENSIONS.PADDING.NODE_LABEL+o.DIMENSIONS.PADDING.NODE_EDGE)("y","VERTICAL"===o.relationship.layout&&"CHILD"===t.relation?o.DIMENSIONS.NODE.HEIGHT+o.DIMENSIONS.PADDING.NODE_LABEL:0)("width",o.getLabelWidth(t))("height",o.DIMENSIONS.LABEL.HEIGHT),e.xp6(1),e.Akn("width:"+o.DIMENSIONS.LABEL.WIDTH+"px; height:"+o.DIMENSIONS.LABEL.HEIGHT+"px; overflow:hidden; display: inline-block;"),e.xp6(1),e.Akn("font-size: "+o.DIMENSIONS.LABEL.FONTSIZE+"px; display: table-cell; vertical-align: middle; height:"+o.DIMENSIONS.LABEL.HEIGHT+"px; width:"+o.DIMENSIONS.LABEL.WIDTH+"px; line-height:"+o.DIMENSIONS.LABEL.FONTSIZE+"px;"),e.Q6J("ngStyle",e.kEZ(14,F0,"VERTICAL"===o.relationship.layout?"CHILD"===t.relation?"center":"left":"SELECTED"===t.relation?"left":"PARENT"===t.relation?"right":"left","SELECTED"===t.relation?o.SELECTED_NODE_COLOR:"unset","g-"+o.state.uid===t.id?"bold":"unset")),e.xp6(1),e.hij(" ",t.label,"")}}function q0(i,n){1&i&&(e.O4$(),e.TgZ(0,"g",25),e._UZ(1,"path",26),e.qZA())}const J0=function(i,n){return[i,n]},j0=function(i){return{orientation:i}};function B0(i,n){if(1&i&&(e.TgZ(0,"ngx-graph",17),e.YNc(1,z0,1,1,"ng-template",null,18,e.W1O),e.YNc(3,U0,7,18,"ng-template",null,19,e.W1O),e.YNc(5,q0,2,0,"ng-template",null,20,e.W1O),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("view",e.WLB(12,J0,t.svgWidth,t.svgHeight))("links",t.data.edges)("nodes",t.data.verticies)("animate",!1)("autoZoom",!0)("autoCenter",!0)("layout",t.layout)("layoutSettings",e.VKq(15,j0,"VERTICAL"===t.relationship.layout?t.CONSTANTS.ORIENTATION.TOP_TO_BOTTOM:t.CONSTANTS.ORIENTATION.LEFT_TO_RIGHT))("curve",t.curve)("draggingEnabled",!1)("panToNode$",t.panToNode$)("update$",t.update$)}}function G0(i,n){if(1&i&&(e.TgZ(0,"div")(1,"div",14)(2,"div",15),e.YNc(3,B0,7,17,"ngx-graph",16),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.data)}}function V0(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1),e._UZ(1,"ngx-spinner",2),e.TgZ(2,"div"),e.YNc(3,I0,3,3,"select",3),e.TgZ(4,"div",4)(5,"boolean-field",5),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.restrictToMapBounds=a)})("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.fetchData())}),e.qZA()(),e.TgZ(6,"div",6),e.YNc(7,N0,4,4,"div",7),e.ALo(8,"keyvalue"),e.qZA(),e.YNc(9,G0,4,1,"div",8),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("fullScreen",!1)("name",t.CONSTANTS.OVERLAY),e.xp6(2),e.Q6J("ngIf",t.relationships),e.xp6(2),e.Q6J("value",t.restrictToMapBounds),e.xp6(2),e.Q6J("ngForOf",e.lcZ(8,6,t.typeLegend)),e.xp6(2),e.Q6J("ngIf",t.relationships)}}const jy="#4287f5",au={NODE:{WIDTH:30,HEIGHT:30},LABEL:{WIDTH:170,HEIGHT:60,FONTSIZE:14},PADDING:{BETWEEN_NODES:0,NODE_LABEL:5,NODE_EDGE:5}};class zh{constructor(n,t,o,a,l,_,C){this.modalService=n,this.spinner=t,this.vizService=o,this.cacheService=a,this.geomService=l,this.router=_,this.route=C,this.CONSTANTS={OVERLAY:"visualizer-panel",ORIENTATION:Hc},this.state={},this.nodeSelect=new e.vpe,this.DIMENSIONS=au,this.SELECTED_NODE_COLOR=jy,this.svgHeight=null,this.svgWidth=null,this.panToNode$=new pn.x,this.update$=new pn.x,this.layout=new Qo,this.curve=ql,this.typeLegend={},this.relationship=null,this.data=null,this.panelOpen=!0,this.loading=!0,this.restrictToMapBounds=!1}ngOnInit(){this.typeCache=this.cacheService.getTypeCache(),this.stateSub=this.geomService.stateChange$.subscribe(n=>this.stateChange(n)),window.setTimeout(()=>{this.loading=!1,this.stateChange(this.geomService.getState())},10)}ngOnDestroy(){this.stateSub.unsubscribe()}stateChange(n){if(null==n.type||null==n.code)return;let t=JSON.parse(JSON.stringify(n)),o=JSON.parse(JSON.stringify(this.state));this.state=t,this.panelOpen="true"===t.graphPanelOpen,t.graphOid&&t.graphOid!==o.graphOid&&null!=this.relationships&&(this.relationship=this.relationships[this.relationships.findIndex(a=>a.oid===this.graphOid)]),this.loading||(null==this.relationships||null==this.relationship||t.objectType!==o.objectType||t.type!==o.type?(this.relationships=null,this.graphOid=null,this.data=null,this.fetchRelationships()):null!=this.relationships&&this.relationship&&(this.restrictToMapBounds&&t.bounds!==o.bounds||t.code!==o.code||t.date!==o.date||t.uid!==o.uid||t.graphOid!==o.graphOid)&&this.fetchData()),this.panelOpen&&window.setTimeout(()=>{this.resizeDimensions()},1)}resizeDimensions(){let n=document.getElementById("graph-container");n&&(this.svgHeight=n.clientHeight-50,this.svgWidth=n.clientWidth)}getHexagonPoints(n){let t=this.DIMENSIONS.LABEL.HEIGHT/2-this.DIMENSIONS.NODE.HEIGHT/2,o="VERTICAL"===this.relationship.layout?"CHILD"===n.relation?this.DIMENSIONS.LABEL.WIDTH/2-this.DIMENSIONS.NODE.WIDTH/2:(this.DIMENSIONS.LABEL.WIDTH+au.PADDING.NODE_LABEL+this.DIMENSIONS.NODE.WIDTH)/2-this.DIMENSIONS.NODE.WIDTH/2:"PARENT"===n.relation?this.DIMENSIONS.LABEL.WIDTH+this.DIMENSIONS.PADDING.NODE_LABEL+this.DIMENSIONS.PADDING.NODE_EDGE:0,a=this.DIMENSIONS.NODE.WIDTH/2,l=this.DIMENSIONS.NODE.HEIGHT,_=this.DIMENSIONS.NODE.WIDTH;return[0,1,2,3,4,5,6].map((N,F)=>{let ue=Math.PI/180*(60*F-30);return[_/2+a*Math.cos(ue)+o,l/2+a*Math.sin(ue)+t]}).map(N=>N.join(",")).join(" ")}fetchRelationships(){null!=this.state.type&&(this.relationships=[],this.spinner.show(this.CONSTANTS.OVERLAY),this.vizService.relationships(this.state.objectType,this.state.type).then(n=>{this.relationships=n,this.relationships&&this.relationships.length>0?this.state.graphOid&&-1!==this.relationships.findIndex(t=>t.oid===this.state.graphOid)?(this.relationship=this.relationships[this.relationships.findIndex(t=>t.oid===this.state.graphOid)],this.graphOid=this.state.graphOid,this.fetchData()):(this.relationship=null!=this.relationship&&"BUSINESS"===this.relationship.code&&"BUSINESS"===this.state.objectType&&-1!==this.relationships.findIndex(t=>"GEOOBJECT"===t.code)?this.relationships[this.relationships.findIndex(t=>"GEOOBJECT"===t.code)]:null!=this.relationship&&"GEOOBJECT"===this.relationship.code&&"GEOOBJECT"===this.state.objectType&&-1!==this.relationships.findIndex(t=>"BUSINESS"===t.code)?this.relationships[this.relationships.findIndex(t=>"BUSINESS"===t.code)]:this.relationships[0],this.graphOid=this.relationship.oid,this.onSelectRelationship()):this.relationship=null}).catch(n=>{this.error(n)}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)}))}onSelectRelationship(){this.relationship=this.relationships[this.relationships.findIndex(t=>t.oid===this.graphOid)],this.geomService.setState({graphOid:this.graphOid},!1)}fetchData(){null!=this.relationship&&(this.spinner.show(this.CONSTANTS.OVERLAY),this.vizService.tree(this.relationship.type,this.relationship.code,{code:this.state.code,typeCode:this.state.type,objectType:this.state.objectType},this.state.date,this.getBoundsAsWKT()).then(t=>{this.data=null,window.setTimeout(()=>{this.data=t,this.resizeDimensions(),this.calculateTypeLegend(this.data.relatedTypes),this.addLayers(this.data.relatedTypes)},0),this.resizeDimensions()}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)}))}addLayers(n){if("BUSINESS"===this.relationship.type||"BUSINESS"===this.state.objectType&&"GEOOBJECT"!==this.relationship.type){let C=this.geomService.getLayers().filter(N=>N.getPinned()||N.dataSource.getDataSourceType()!==$i);return void this.geomService.setLayers(C)}let t=this.geomService.getLayers(),l=new na(this.vizService,this.geomService,this.relationship.type,this.relationship.code,{code:this.state.code,typeCode:this.state.type,objectType:this.state.objectType},this.restrictToMapBounds?this.state.bounds:null,this.state.date);t=t.filter(C=>C.getPinned()||C.dataSource.getDataSourceType()!==$i||C.dataSource.getRelationshipCode()===this.relationship.code&&C.dataSource.getRelationshipType()===this.relationship.type&&-1!==n.map(N=>N.code).indexOf(C.getRelatedTypeFilter()));let _={};for(let C=0;C<t.length;++C)if(t[C].dataSource.getDataSourceType()===$i){let N=t[C];_[N.getRelatedTypeFilter()]={index:C,layer:N}}n.forEach(C=>{if("GEOOBJECT"===C.objectType){let N=l.createLayer(this.relationship.label.localizedValue+" "+C.label,!0,this.typeLegend[C.code].color);if(N.setRelatedTypeFilter(C.code),-1===t.findIndex(F=>F.getKey()===N.getKey())){let F=_[C.code];null==F||F.layer.getPinned()?t.push(N):(N.rendered=F.layer.rendered,t.splice(F.index,1,N))}}}),this.geomService.setLayers(t)}getBoundsAsWKT(){let n=null;if(null!=this.state.bounds&&this.restrictToMapBounds){const t=new sr.LngLatBounds(JSON.parse(this.state.bounds));n=this.convertBoundsToWKT(t)}return n}convertBoundsToWKT(n){let t=n.getSouthEast(),o=n.getSouthWest(),a=n.getNorthWest(),l=n.getNorthEast();return"POLYGON (("+t.lng+" "+t.lat+","+o.lng+" "+o.lat+","+a.lng+" "+a.lat+","+l.lng+" "+l.lat+","+t.lng+" "+t.lat+"))"}calculateTypeLegend(n){let t=this.typeLegend;this.typeLegend={};const o=this.geomService.getLayers();n.forEach(a=>{if(!this.typeLegend[a.code]){let l,_=o.findIndex(C=>C instanceof Eg&&C.getRelatedTypeFilter()===a.code);l=-1!==_?o[_].color:null!=t&&null!=t[a.code]?t[a.code].color:bl().hexString(),this.typeLegend[a.code]={color:l,label:a.label}}}),this.typeLegend[this.state.type]||(this.typeLegend[this.state.type]={color:jy,label:this.state.type})}collapseAnimation(n){if(!this.state.type)return new Promise((_,C)=>{_()});let t=document.getElementById(n);if(!t)return new Promise((_,C)=>{_()});let o=this.getBBox(t,!0),a=document.querySelectorAll("g.nodes > g");return a.forEach(_=>{if(_.id!==t.id){let C=this.getBBox(_,!1),N=document.createElementNS("http://www.w3.org/2000/svg","animateTransform");N.setAttribute("attributeName","transform"),N.setAttribute("attributeType","XML"),N.setAttribute("type","translate"),N.setAttribute("fill","freeze"),N.setAttribute("to",o.x-C.x+" "+(o.y-C.y)),N.setAttribute("begin","indefinite"),N.setAttribute("additive","replace"),N.setAttribute("dur","500ms"),N.setAttribute("repeatCount","0"),_.appendChild(N),N.beginElement()}}),document.querySelectorAll("g.links > g").forEach(_=>{_.remove()}),new Promise((_,C)=>{setTimeout(()=>{a.forEach(N=>{N.id!==t.id&&N.remove()}),_()},500)})}getBBox(n,t=!0){if(!t)return n.getBBox();let o=n.cloneNode(!0),a=document.createElementNS("http://www.w3.org/2000/svg","g");document.querySelector("svg").appendChild(a),a.appendChild(o);let l=a.getBBox();return o.remove(),a.remove(),l}onClickNode(n){if(n.code!==this.state.code||n.typeCode!==this.state.type){let t=o=>{this.collapseAnimation(n.id).then(()=>{o()})};this.nodeSelect.emit({objectType:n.objectType,id:n.id.substring(2),code:n.code,typeCode:n.typeCode,label:n.label,selectAnimation:t})}}getLabelWidth(n){return"HORIZONTAL"===this.relationship.layout&&"SELECTED"===n.relation?Math.min(au.LABEL.WIDTH,wl(n.label,au.LABEL.FONTSIZE,"svg.ngx-charts"))+au.PADDING.NODE_LABEL:au.LABEL.WIDTH+au.PADDING.NODE_LABEL}error(n){Zt.qL.showErrorAsDialog(n,this.modalService)}}zh.\u0275fac=function(n){return new(n||zh)(e.Y36(Ln.tT),e.Y36(Nn),e.Y36(Xa),e.Y36(Ml),e.Y36(vo),e.Y36(w.F0),e.Y36(w.gz))},zh.\u0275cmp=e.Xpm({type:zh,selectors:[["relationship-visualizer"]],outputs:{nodeSelect:"nodeSelect"},decls:1,vars:1,consts:[["id","relationship-visualizer-root-node","style","height:100%; overflow:hidden;",4,"ngIf"],["id","relationship-visualizer-root-node",2,"height","100%","overflow","hidden"],["type","ball-clip-rotate-multiple","size","medium",3,"fullScreen","name"],["id","relationshipId","name","relationshipId","class","select-area","required","","style","margin:10px;width:auto;min-width:200px;",3,"ngModel","ngModelChange","change",4,"ngIf"],[2,"padding-top","20px"],["localizeLabelKey","graph.visualizer.restrictToMapBounds",3,"value","valueChange","change"],[1,"legend"],["class","legend-item",4,"ngFor","ngForOf"],[4,"ngIf"],["id","relationshipId","name","relationshipId","required","",1,"select-area",2,"margin","10px","width","auto","min-width","200px",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"legend-item"],[1,"square",3,"ngStyle"],[1,"hierarchy-content"],["id","graph-container"],["class","chart-container",3,"view","links","nodes","animate","autoZoom","autoCenter","layout","layoutSettings","curve","draggingEnabled","panToNode$","update$",4,"ngIf"],[1,"chart-container",3,"view","links","nodes","animate","autoZoom","autoCenter","layout","layoutSettings","curve","draggingEnabled","panToNode$","update$"],["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"node",3,"click"],["xmlns","http://www.w3.org/1999/xhtml","text-anchor","start",3,"ngStyle"],[1,"edge"],["stroke-width","2","marker-end","url(#arrow)",1,"line"]],template:function(n,t){1&n&&e.YNc(0,V0,10,8,"div",0),2&n&&e.Q6J("ngIf",t.state.code)},dependencies:[T.sg,T.O5,T.PC,y.YN,y.Kr,y.EJ,y.JJ,y.Q7,y.On,rl.M,Tg,Wi,T.Nd],styles:["#relationship-visualizer-root-node[_ngcontent-%COMP%]{border-radius:4px}.visualize-mode-hierarchy[_ngcontent-%COMP%]{color:#000}.legend[_ngcontent-%COMP%]{position:absolute;padding:10px;bottom:0}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:table}.legend[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%]{width:25px;height:25px;margin-right:5px;float:left}.legend[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{float:left;line-height:25px;height:25px}.map-button[_ngcontent-%COMP%]{background-color:#fff;margin-top:150px;z-index:1001;border-radius:4px;padding:8px;width:46px;width:-moz-fit-content;width:fit-content}.map-button-icon[_ngcontent-%COMP%]{font-size:23px;text-align:center;width:30px;height:30px;vertical-align:middle}.map-button-icon[_ngcontent-%COMP%] > span.glyphicon[_ngcontent-%COMP%]{line-height:30px}[_nghost-%COMP%]  .graph .panning-rect{cursor:grab}"]});var bs=(()=>{return(i=bs||(bs={})).NEW="NEW",i.UNMODIFIED="UNMODIFIED",i.DELETE="DELETE",i.UPDATE="UPDATE",i.TIME_CHANGE="TIME_CHANGE",i.VALUE_CHANGE="VALUE_CHANGE",bs;var i})();class Np{}class Qm{}class Y0 extends Qm{constructor(){super(),this.actionType=Er.CREATEGEOOBJECTACTION}}class H0 extends Qm{constructor(n){super(),this.actionType=Er.UPDATEATTRIBUTETACTION,this.attributeName=n,this.attributeDiff={valuesOverTime:[]}}}class Q0 extends Qm{constructor(n){super(),this.actionType=Er.UPDATEATTRIBUTETACTION,this.attributeName=n,this.attributeDiff={}}}class Km{constructor(){this.isNew=!0}static getActionsForAttribute(n,t,o){if("CreateGeoObject"===n.type)return n.actions;{let a=[];for(let l=0;l<n.actions.length;++l){let _=n.actions[l];if("UpdateAttributeAction"===_.actionType){let C=_;C.attributeName===t&&("_PARENT_"!==t||C.attributeDiff.hierarchyCode===o)&&a.push(n.actions[l])}}return a}}}class i_{constructor(n,t,o){this.onChangeSubject=new pn.x,this._isValid=!0,this.attr=t,this.changeRequestAttributeEditor=n,this.action=o}removeType(n){}onChange(n){this.changeRequestAttributeEditor.onChange(n),this.onChangeSubject.next(n)}getGeoObjectTimeRangeStorage(){return this.valueOverTime}getValueFromGeoObjectForDiff(){return this.valueOverTime.value}validate(){this.conflictMessages||(this.conflictMessages=new Set);let n=this.changeRequestAttributeEditor.changeRequestEditor.dateService,t=n.validateDate(null==this.startDate?null:n.getDateFromDateString(this.startDate),!0,!0),o=n.validateDate(null==this.endDate?null:n.getDateFromDateString(this.endDate),!0,!0);return this._isValid=!0,(!t.valid||!o.valid)&&(this._isValid=!1),this.validateUpdateReference(),this._isValid}validateUpdateReference(){let n=this.changeRequestAttributeEditor.changeRequestEditor.dateService.missingReference;this.conflictMessages.delete(n),"UpdateGeoObject"===this.changeRequestAttributeEditor.changeRequestEditor.changeRequest.type&&null!=this.diff&&"CREATE"!==this.diff.action&&null==this.findExistingValueOverTimeByOid(this.diff.oid)&&(this._isValid=!1,this.conflictMessages.add(n))}findExistingValueOverTimeByOid(n){if(this.changeRequestAttributeEditor.changeRequestEditor.geoObject.attributes[this.attr.code]){let t=this.changeRequestAttributeEditor.changeRequestEditor.geoObject.attributes[this.attr.code].values.findIndex(o=>o.oid===n);if(-1!==t)return this.changeRequestAttributeEditor.changeRequestEditor.geoObject.attributes[this.attr.code].values[t]}return null}set oid(n){null!=this.diff?this.diff.oid=n:null!=this.getGeoObjectTimeRangeStorage()&&(this.getGeoObjectTimeRangeStorage().oid=n)}get oid(){return null!=this.diff?this.diff.oid:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().oid:null}get startDate(){return this.getStartDate()}getStartDate(){return null!=this.diff&&void 0!==this.diff.newStartDate?this.diff.newStartDate:null!=this.diff&&void 0!==this.diff.oldStartDate?this.diff.oldStartDate:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().startDate:null}constructNewDiff(n){if(this.diff=new Np,this.diff.action=n,this.action.attributeDiff.valuesOverTime.push(this.diff),"CREATE"===n)this.diff.oid=G();else{let t=this.getGeoObjectTimeRangeStorage();this.diff.oid=t.oid,this.diff.oldStartDate=t.startDate,this.diff.oldEndDate=t.endDate}}set oldStartDate(n){null!=this.diff&&(this.diff.oldStartDate=n)}get oldStartDate(){return null!=this.diff?this.diff.oldStartDate:null}get endDate(){return this.getEndDate()}getEndDate(){return null!=this.diff&&void 0!==this.diff.newEndDate?this.diff.newEndDate:null!=this.diff&&void 0!==this.diff.oldStartDate?this.diff.oldEndDate:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().endDate:null}set startDate(n){this.setStartDate(n)}setStartDate(n){if(this.isDelete())return;let t=this.getGeoObjectTimeRangeStorage();if("UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==this.getGeoObjectTimeRangeStorage())this.constructNewDiff("CREATE");else{if(t.startDate===n)return;this.constructNewDiff("UPDATE"),this.diff.oldValue=this.getValueFromGeoObjectForDiff()}n===this.diff.oldStartDate?delete this.diff.newStartDate:this.diff.newStartDate=n,this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(t.startDate=n);this.onChange(Fo.START_DATE)}set endDate(n){if(this.isDelete())return;let t=this.getGeoObjectTimeRangeStorage();if("UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==t)this.constructNewDiff("CREATE");else{if(t.endDate===n)return;this.constructNewDiff("UPDATE"),this.diff.oldValue=this.getValueFromGeoObjectForDiff()}n===this.diff.oldEndDate?delete this.diff.newEndDate:this.diff.newEndDate=n,this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(t.endDate=n);this.onChange(Fo.END_DATE)}set oldEndDate(n){null!=this.diff&&(this.diff.oldEndDate=n)}get oldEndDate(){return null!=this.diff?this.diff.oldEndDate:null}get value(){return null!=this.diff&&void 0!==this.diff.newValue?this.diff.newValue:null!=this.diff&&void 0!==this.diff.oldValue?this.diff.oldValue:null!=this.getGeoObjectTimeRangeStorage()?this.getGeoObjectTimeRangeStorage().value:null}set value(n){if(!this.isDelete()){if(null!=n){if("term"===this.attr.type)n=[n];else if("date"===this.attr.type)n=new Date(n).getTime();else if("geometry"===this.attr.type){let t=6;if("MultiPoint"===n.type)for(let o=0;o<n.coordinates.length;++o){let a=n.coordinates[o];a[0]=Number.parseFloat(a[0].toFixed(t)),a[1]=Number.parseFloat(a[1].toFixed(t))}else"Point"===n.type&&(n.coordinates=[Number.parseFloat(n.coordinates[0].toFixed(t)),Number.parseFloat(n.coordinates[1].toFixed(t))])}}else null==n&&("geometry"===this.attr.type?n=vo.createEmptyGeometryValue(this.changeRequestAttributeEditor.changeRequestEditor.geoObjectType.geometryType):"character"===this.attr.type&&(n=""));if("UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==this.getGeoObjectTimeRangeStorage())this.diff=new Np,this.diff.oid=G(),this.diff.action="CREATE",this.action.attributeDiff.valuesOverTime.push(this.diff);else{if(this.areValuesEqual(this.valueOverTime.value,n))return;this.diff=new Np,this.diff.action="UPDATE",this.diff.oid=this.getGeoObjectTimeRangeStorage().oid,this.diff.oldValue=this.valueOverTime.value,this.diff.oldStartDate=this.getGeoObjectTimeRangeStorage().startDate,this.diff.oldEndDate=this.getGeoObjectTimeRangeStorage().endDate,this.action.attributeDiff.valuesOverTime.push(this.diff)}"CREATE"!==this.diff.action&&this.areValuesEqual(this.diff.oldValue,n)?delete this.diff.newValue:this.diff.newValue=JSON.parse(JSON.stringify(n)),this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(this.valueOverTime.value=n);this.onChange(Fo.VALUE)}}set oldValue(n){null!=this.diff&&(this.diff.oldValue=n)}get oldValue(){return null!=this.diff?this.diff.oldValue:null}setLocalizedValue(n){this.value=JSON.parse(JSON.stringify(n))}removeEmptyDiff(){if(null!=this.diff&&void 0===this.diff.newValue&&void 0===this.diff.newStartDate&&void 0===this.diff.newEndDate){const n=this.action.attributeDiff.valuesOverTime,t=n.findIndex(o=>o.oid===this.diff.oid);-1!==t&&n.splice(t,1),this.diff=null}}areValuesEqual(n,t){if("boolean"===this.attr.type)return n===t;if(""===n&&null==t||""===t&&null==n||!n&&!t)return!0;if(!n&&t||!t&&n)return!1;if("term"===this.attr.type){if(null!=n&&null!=t)return n.length===t.length&&n[0]===t[0]}else{if("geometry"===this.attr.type)return(null==n||null==n.coordinates||null==n.coordinates.length||null==t||null==t.coordinates||null==t.coordinates.length||n.coordinates.length===t.coordinates.length)&&Jy(n,t);if("date"===this.attr.type)return("string"==typeof n?parseInt(n):n)===("string"==typeof t?parseInt(t):t);if("local"===this.attr.type){if(!n.localeValues||!t.localeValues||n.localeValues.length!==t.localeValues.length)return!1;let o=n.localeValues.length;for(let a=0;a<o;++a){let l=n.localeValues[a],_=this.getValueAtLocale(t,l.locale),C=l.value;if(!(""===C&&null==_||""===_&&null==C)&&C!==_)return!1}return!0}}return n===t}getValueAtLocale(n,t){return new ru(n.localizedValue,n.localeValues).getValue(t)}remove(){if("UpdateAttributeAction"===this.action.actionType)if(null!=this.diff&&"CREATE"===this.diff.action){let n=this.action;const t=n.attributeDiff.valuesOverTime.findIndex(o=>o.oid===this.diff.oid);t>-1&&n.attributeDiff.valuesOverTime.splice(t,1)}else{if(null!=this.diff)return delete this.diff.newValue,delete this.diff.newStartDate,delete this.diff.newEndDate,this.removeEmptyDiff(),void this.onChange(Fo.REMOVE);null!=this.valueOverTime&&null==this.diff&&(this.diff=new Np,this.diff.action="DELETE",this.diff.oid=this.valueOverTime.oid,this.diff.oldValue=this.valueOverTime.value,this.diff.oldStartDate=this.valueOverTime.startDate,this.diff.oldEndDate=this.valueOverTime.endDate,this.action.attributeDiff.valuesOverTime.push(this.diff))}else if("CreateGeoObjectAction"===this.action.actionType){let n=this.action.geoObjectJson.attributes[this.attr.code].values,t=n.findIndex(o=>o.oid===this.valueOverTime.oid);-1!==t&&n.splice(t,1)}this.onChange(Fo.REMOVE)}isDelete(){return null!=this.diff&&"DELETE"===this.diff.action}buildDataSource(n){let t=this;return{setLayerData(o){"NEW"===n?t.value=o:console.log("ERROR. Cannot edit old geometry")},getLayerData:()=>"NEW"===n?t.value:t.oldValue,buildMapboxSource(){return{type:"geojson",data:this.getLayerData()}},getGeometryType:()=>t.changeRequestAttributeEditor.changeRequestEditor.geoObjectType.geometryType,getDataSourceId:()=>n+"_"+t.oid,getDataSourceProviderId:()=>t.changeRequestAttributeEditor.changeRequestEditor.changeRequest.oid,createLayer(o,a,l,_){return new Vl(this,a,l,_)},getBounds(o,a,l){return new Promise((_,C)=>{_(_s(this.getLayerData()))})}}}}class o_ extends i_{constructor(n,t,o,a,l){super(n,t,o),this.existRangeStale=!1,this.hierarchyEntry=a,this.hierarchyOverTime=l,null!=this.hierarchyEntry&&(this.hierarchyEntry.loading={})}getGeoObjectTimeRangeStorage(){return this.hierarchyEntry}getValueFromGeoObjectForDiff(){let n=null==this.hierarchyEntry?null:this.hierarchyEntry.parents[this.hierarchyOverTime.types[this.hierarchyOverTime.types.length-1].code].geoObject;return null==n?null:n.properties.type+"_~VST~_"+n.properties.code}onChange(n){(n===Fo.END_DATE||n===Fo.START_DATE)&&(this.existRangeStale=!0),super.onChange(n)}validate(){if(super.validate(),this._isValid&&null!=this.hierarchyEntry){let n=this.changeRequestAttributeEditor.changeRequestEditor.dateService.invalidParent,t=this.changeRequestAttributeEditor.changeRequestEditor.dateService.parentDoesNotExist,o=this.changeRequestAttributeEditor.changeRequestEditor.registryService;for(let l=this.hierarchyOverTime.types.length-1;l>=0;--l){let _=this.hierarchyOverTime.types[l];if(Object.prototype.hasOwnProperty.call(this.hierarchyEntry.parents,_.code)&&this.hierarchyEntry.parents[_.code].geoObject){let C=this.hierarchyEntry.parents[_.code].geoObject;this.existRangeStale?o.doesGeoObjectExistAtRange(this.startDate,this.endDate,_.code,C.properties.code).then(N=>{C.properties.invalid=N.invalid,C.properties.exists=N.exists,this.conflictMessages.delete(n),this.conflictMessages.delete(t),C.properties.invalid&&(this._isValid=!1,this.conflictMessages.add(n)),C.properties.exists||(this._isValid=!1,this.conflictMessages.add(t))}).catch(N=>{console.log(N)}):(C.properties.invalid&&(this._isValid=!1,this.conflictMessages.add(n)),C.properties.exists||(this._isValid=!1,this.conflictMessages.add(t)))}}this.existRangeStale=!1}return this._isValid}validateUpdateReference(){}setParentValue(n,t){if(null!=this.diff&&"DELETE"===this.diff.action)return;let o=null;if(null!=n&&(o=t[n.code].geoObject),"UpdateAttributeAction"===this.action.actionType){if(null==this.diff)if(null==this.hierarchyEntry)this.diff=new Np,this.diff.oid=G(),this.diff.action="CREATE",this.action.attributeDiff.hierarchyCode=this.hierarchyOverTime.code,this.action.attributeDiff.valuesOverTime.push(this.diff);else{let l=this.getLowestLevelFromHierarchyEntry(this.hierarchyEntry.parents).geoObject,_=null==l?null:l.properties.type+"_~VST~_"+l.properties.code;if(null==l&&null==o||null!=l&&null!=o&&l.properties.code===o.properties.code)return;this.diff=new Np,this.diff.action="UPDATE",this.diff.oid=this.hierarchyEntry.oid,this.diff.oldValue=_,this.diff.oldParents=JSON.parse(JSON.stringify(this.hierarchyEntry.parents)),this.diff.oldStartDate=this.hierarchyEntry.startDate,this.diff.oldEndDate=this.hierarchyEntry.endDate,this.action.attributeDiff.hierarchyCode=this.hierarchyOverTime.code,this.action.attributeDiff.valuesOverTime.push(this.diff)}let a=null;null!=o&&(a=o.properties.type+"_~VST~_"+o.properties.code),a===this.diff.oldValue?delete this.diff.newValue:this.diff.newValue=a,this.diff.parents=t,this.removeEmptyDiff()}else"CreateGeoObjectAction"===this.action.actionType&&(this.hierarchyEntry.parents=t);this.onChange(Fo.VALUE)}getLowestLevelFromHierarchyEntry(n){for(let o=this.hierarchyOverTime.types.length-1;o>=0;--o){let a=this.hierarchyOverTime.types[o];if(Object.prototype.hasOwnProperty.call(n,a.code)&&n[a.code].geoObject)return n[a.code]}return null}set value(n){throw new Error("Invoke setParentValue instead")}get value(){return null!=this.diff&&void 0!==this.diff.parents?this.diff:null!=this.hierarchyEntry?this.hierarchyEntry:null}removeType(n){let t=JSON.parse(JSON.stringify(this.value.parents));t[n.code]={text:"",geoObject:null};let o=this.value;for(let l=this.hierarchyOverTime.types.length-1;l>=0;--l){let _=this.hierarchyOverTime.types[l];if(Object.prototype.hasOwnProperty.call(o.parents,_.code)&&o.parents[_.code].geoObject)return void this.setParentValue(_,t)}this.setParentValue(null,t)}createEmptyHierarchyEntry(){let n=new O0;if(n.loading={},n.oid=G(),n.parents={},this.hierarchyOverTime)for(let t=0;t<this.hierarchyOverTime.types.length;t++)n.parents[this.hierarchyOverTime.types[t].code]={text:"",geoObject:null},n.loading={};return n}remove(){if("UpdateAttributeAction"===this.action.actionType)if(null!=this.diff&&"CREATE"===this.diff.action){let n=this.action;const t=n.attributeDiff.valuesOverTime.findIndex(o=>o.oid===this.diff.oid);t>-1&&n.attributeDiff.valuesOverTime.splice(t,1)}else{if(null!=this.diff)return delete this.diff.newValue,delete this.diff.newStartDate,delete this.diff.newEndDate,this.removeEmptyDiff(),void this.onChange(Fo.REMOVE);if(null!=this.hierarchyEntry&&null==this.diff){let n=this.getLowestLevelFromHierarchyEntry(this.hierarchyEntry.parents).geoObject,t=null==n?null:n.properties.type+"_~VST~_"+n.properties.code;this.diff=new Np,this.diff.action="DELETE",this.diff.oid=this.hierarchyEntry.oid,this.diff.oldValue=t,this.diff.oldStartDate=this.hierarchyEntry.startDate,this.diff.oldEndDate=this.hierarchyEntry.endDate,this.action.attributeDiff.valuesOverTime.push(this.diff),this.action.attributeDiff.hierarchyCode=this.hierarchyOverTime.code}}else if("CreateGeoObjectAction"===this.action.actionType){let n=this.hierarchyOverTime.entries.findIndex(t=>t.oid===this.hierarchyEntry.oid);-1!==n&&this.hierarchyOverTime.entries.splice(n,1)}this.onChange(Fo.REMOVE)}}class r_{constructor(n,t,o){if(this.onChangeSubject=new pn.x,this.value="",this.changeRequestEditor=n,this.attribute=t,this.hierarchy=o,this.getEditAction(),null!=o)for(let a=0;a<this.hierarchy.entries.length;a++){let l=this.hierarchy.entries[a];null==l.parents&&(l.parents={}),null==l.loading&&(l.loading={});for(let _=0;_<this.hierarchy.types.length;_++){let C=this.hierarchy.types[_];null==l.parents[C.code]&&(l.parents[C.code]={text:"",geoObject:null})}}this.editors=this.generateEditors()}getEditAction(){if(null==this.editAction){let n=Km.getActionsForAttribute(this.changeRequestEditor.changeRequest,this.attribute.code,null==this.hierarchy?null:this.hierarchy.code);0===n.length?(this.editAction=new H0(this.attribute.code),"_PARENT_"===this.attribute.code&&(this.editAction.attributeDiff.hierarchyCode=this.hierarchy.code)):this.editAction=n[n.length-1]}return this.editAction}onChange(n){let t=this.hasChanges(),o=this.changeRequestEditor.changeRequest.actions.findIndex(a=>this.editAction===a);-1===o||t?-1===o&&t&&this.changeRequestEditor.changeRequest.actions.push(this.editAction):this.changeRequestEditor.changeRequest.actions.splice(o,1),this.validate(),this.onChangeSubject.next(n),this.changeRequestEditor.onChange(n)}hasChanges(){let n=!0;return this.editAction.actionType===Er.UPDATEATTRIBUTETACTION&&0===this.editAction.attributeDiff.valuesOverTime.length&&(n=!1),n}isValid(){return this._isValid}validate(n=!1){let t=this.validateEditors(),o=this.changeRequestEditor.votService.checkRanges(this.attribute,this.editors),a=!1;if("exists"!==this.attribute.code){let l=_d.getAttribute(this.changeRequestEditor.geoObjectType,"exists"),_=this.changeRequestEditor.getEditorForAttribute(l).getEditors();a=this.changeRequestEditor.votService.checkExistRanges(this.editors,_)}else n||this.changeRequestEditor.validate(!0);return this._isValid=t&&!o&&!a,this._isValid}validateEditors(){let n=!0;return this.editors.forEach(t=>{t.validate()||(n=!1)}),n}findExistingValueOverTimeByOid(n){if(this.changeRequestEditor.geoObject.attributes[this.attribute.code]){let t=this.changeRequestEditor.geoObject.attributes[this.attribute.code].values.findIndex(o=>o.oid===n);if(-1!==t)return this.changeRequestEditor.geoObject.attributes[this.attribute.code].values[t]}return null}getEditor(n){let t=this.editors.filter(o=>o.oid===n);return t.length>0?t[0]:null}getEditors(n=!0){return this.editors.filter(t=>n||null!=t.diff)}generateEditors(){let n=Km.getActionsForAttribute(this.changeRequestEditor.changeRequest,this.attribute.code,null==this.hierarchy?null:this.hierarchy.code),t=[];if("_PARENT_"===this.attribute.code?this.hierarchy.entries.forEach(o=>{let a=new o_(this,this.attribute,this.editAction,o,this.hierarchy);t.push(a)}):this.changeRequestEditor.geoObject.attributes[this.attribute.code]&&this.changeRequestEditor.geoObject.attributes[this.attribute.code].values.forEach(o=>{let a=new i_(this,this.attribute,this.editAction);a.valueOverTime=o,t.push(a)}),"UpdateGeoObject"===this.changeRequestEditor.changeRequest.type){let o=n.length;for(let a=0;a<o;++a)n[a].attributeDiff.valuesOverTime.forEach(_=>{let C=t.findIndex(F=>F.oid===_.oid),N=-1===C?null:t[C];null==N?(N="_PARENT_"===this.attribute.code?new o_(this,this.attribute,this.editAction,null,this.hierarchy):new i_(this,this.attribute,this.editAction),N.diff=_,t.push(N)):(N.diff=_,"_PARENT_"===this.attribute.code&&(N.hierarchyEntry.parents=_.parents))})}return t}createNewVersion(n){let t;if(t="_PARENT_"===this.attribute.code?new o_(this,this.attribute,this.editAction,null,this.hierarchy):new i_(this,this.attribute,this.editAction),"CreateGeoObject"===this.changeRequestEditor.changeRequest.type)if("_PARENT_"===this.attribute.code)t.hierarchyEntry=t.createEmptyHierarchyEntry(),t.hierarchyOverTime.entries.push(t.hierarchyEntry);else{let o=new M0;o.oid=G(),this.editAction.geoObjectJson.attributes[this.attribute.code].values.push(o),t.valueOverTime=o}else t.constructNewDiff("CREATE");if("local"===this.attribute.type)t.value=this.changeRequestEditor.localizationService.create();else if("geometry"===this.attribute.type){let o=this.getEditors(!0);t.value=o.length>0?null!=n?JSON.parse(JSON.stringify(n.value)):JSON.parse(JSON.stringify(o[o.length-1].value)):vo.createEmptyGeometryValue(this.changeRequestEditor.geoObjectType.geometryType)}else if("term"===this.attribute.type){let o=_d.getGeoObjectTypeTermAttributeOptions(this.changeRequestEditor.geoObjectType,this.attribute.code);o&&o.length>0&&(t.value=o[0].code)}else"_PARENT_"===this.attribute.code&&"UpdateGeoObject"===this.changeRequestEditor.changeRequest.type?t.hierarchyEntry=t.createEmptyHierarchyEntry():"_PARENT_"!==this.attribute.code&&(t.value=null);return this.editors.push(t),this.onChange(Fo.ADD),t}remove(n){if(null!=n.diff&&"CREATE"===n.diff.action||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type){let t=this.editors.findIndex(o=>o.oid===n.oid);-1!==t&&this.editors.splice(t,1)}n.remove(),this.validate()}}class K0{constructor(n,t,o){this._isValid=!0,this.attribute=n,this.geoObject=t,this.changeRequest=o,this.initialize()}initialize(){let n=this.changeRequest.actions;"CreateGeoObject"===this.changeRequest.type?n.length>0&&n[0].actionType===Er.CREATEGEOOBJECTACTION&&(this.editAction=n[0]):(n.forEach(o=>{o.actionType===Er.UPDATEATTRIBUTETACTION&&this.attribute.code===o.attributeName&&(this.editAction=o)}),null==this.editAction&&(this.editAction=new Q0(this.attribute.code)));let t=this.changeRequest.actions.length;for(let o=0;o<t;++o){let a=n[o];if(a.actionType===Er.UPDATEATTRIBUTETACTION){let l=a;this.attribute.code===l.attributeName&&(this.diff=l.attributeDiff)}else a.actionType===Er.CREATEGEOOBJECTACTION||console.log("Unexpected action : "+a.actionType,a)}}hasChanges(){return null!=this.diff}isValid(){return this._isValid}validate(){return this._isValid}set value(n){if("CreateGeoObject"===this.changeRequest.type)this.geoObject.attributes[this.attribute.code]=n;else if(null!=this.diff)if(this.areValuesEqual(this.diff.oldValue,n)){delete this.editAction.attributeDiff,this.diff=null;let t=this.changeRequest.actions.findIndex(o=>o===this.editAction);-1!==t&&this.changeRequest.actions.splice(t,1)}else this.diff.newValue=n;else this.diff={oldValue:this.geoObject.attributes[this.attribute.code],newValue:n},this.editAction.attributeDiff=this.diff,this.changeRequest.actions.push(this.editAction)}get value(){return"CreateGeoObject"===this.changeRequest.type?this.geoObject.attributes[this.attribute.code]:null!=this.diff?this.diff.newValue:this.geoObject.attributes[this.attribute.code]}areValuesEqual(n,t){return"boolean"===this.attribute.type?n===t:""===n&&null==t||""===t&&null==n||!n&&!t||!(!n&&t||!t&&n)&&n===t}}class $0{constructor(n,t,o,a,l,_,C,N,F,V,ue){this.onChangeSubject=new pn.x,this.changeRequest=n,this.geoObject=t,this.geoObjectType=o,this.geometryAttributeType=l,this.parentAttributeType=_,this.hierarchies=a,this.localizationService=C,this.dateService=N,this.registryService=F,this.geomService=V,this.votService=ue,this.attributeEditors=this.generateAttributeEditors(),this.validate()}generateAttributeEditors(){let n=["uid","sequence","type","lastUpdateDate","createDate"],t=[],o=this.geoObjectType.attributes.slice();return o=o.filter(a=>-1===n.indexOf(a.code)),o.push(this.geometryAttributeType),o.push(this.parentAttributeType),o.forEach(a=>{if("_PARENT_"!==a.code)if(a.isChangeOverTime){let l=new r_(this,a,null);t.push(l)}else{let l=new K0(a,this.geoObject,this.changeRequest);t.push(l)}else this.hierarchies.forEach(l=>{let _=new r_(this,a,l);t.push(_)})}),t}hasChanges(){let n=!1;return this.attributeEditors.forEach(t=>{t.hasChanges()&&(n=!0)}),n}isValid(){return this._isValid}validate(n=!1){return this._isValid=!0,this.attributeEditors.forEach(t=>{(!n||"exists"!==t.attribute.code)&&(t.validate(!0),t.isValid()||(this._isValid=!1))}),this._isValid}findExistingValueOverTimeByOid(n,t){if(this.geoObject.attributes[t]){let o=this.geoObject.attributes[t].values.findIndex(a=>a.oid===n);if(-1!==o)return this.geoObject.attributes[t].values[o]}return null}findEditorForValueOverTime(n){for(let t=0;t<this.attributeEditors.length;++t){let o=this.attributeEditors[t];if(o instanceof r_&&null!=o.getEditor(n))return o}}getEditorForAttributeByCode(n,t=null){let o=this.attributeEditors.findIndex(a=>(!a.attribute.isChangeOverTime||null==t&&null==a.hierarchy||null!=a.hierarchy&&a.hierarchy.code===t)&&a.attribute.code===n);return-1===o?null:this.attributeEditors[o]}getEditorForAttribute(n,t=null){return this.getEditorForAttributeByCode(n.code,null==t?null:t.code)}getEditors(){return this.attributeEditors}onChange(n){this.onChangeSubject.next(n)}existsAtDate(n){let t=_d.getAttribute(this.geoObjectType,"exists"),o=this.getEditorForAttribute(t).getEditors(),a=o.length;for(let l=0;l<a;++l){let _=o[l];if(null!=_.startDate&&null!=_.endDate&&!_.isDelete()&&!0===_.value&&this.dateService.between(n,_.startDate,_.endDate))return!0}return!1}}class Gy{constructor(n,t){this.objectLayer=null,this.editingLayer=null,this.oldLayer=null,this.component=n,this.editor=t,this.populate(t),this.editor.onChangeSubject.subscribe(()=>{this.populate(this.editor)})}populate(n){if("local"===this.component.attributeType.type&&null!=this._value&&null!=this.editor.value)ru.populate(this._value,this.editor.value);else if("_PARENT_"===this.component.attributeType.code&&null!=this._value&&null!=this.editor.value&&null!=this.editor.value.parents)for(let t=0;t<this.component.hierarchy.types.length;t++){let o=this.component.hierarchy.types[t];this._value.parents[o.code].text=this.editor.value.parents[o.code].text,this._value.parents[o.code].geoObject=this.editor.value.parents[o.code].geoObject}else this._value="_PARENT_"===this.component.attributeType.code?JSON.parse(JSON.stringify(this.editor.value)):this.convertValueForDisplay(null==this.editor.value?null:JSON.parse(JSON.stringify(this.editor.value)));"_PARENT_"===this.component.attributeType.code&&(this._value.loading={}),this.calculateSummaryKey()}set oid(n){this.editor.oid=n}get oid(){return this.editor.oid}get startDate(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?this.editor.oldStartDate:this.editor.startDate}set startDate(n){this.editor.startDate=n,this.calculateSummaryKey()}set oldStartDate(n){this.editor.oldStartDate=n}get oldStartDate(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?null:null!=this.editor.diff&&null!=this.editor.diff.newStartDate&&void 0!==this.editor.oldStartDate?this.convertDateForDisplay(this.editor.oldStartDate):null}get endDate(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?this.editor.oldEndDate:this.editor.endDate}set endDate(n){this.editor.endDate=n,this.calculateSummaryKey()}set oldEndDate(n){this.editor.oldEndDate=n}get oldEndDate(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?null:null!=this.editor.diff&&null!=this.editor.diff.newEndDate&&void 0!==this.editor.oldEndDate?this.convertDateForDisplay(this.editor.oldEndDate):null}get value(){return this._value}set value(n){this.editor.value=n}set oldValue(n){this.editor.oldValue=n}get oldValue(){return null!=this.editor.diff&&"DELETE"===this.editor.diff.action?null:null!=this.editor.diff&&null!=this.editor.diff.newValue&&void 0!==this.editor.oldValue?this.convertOldValueForDisplay(this.editor.oldValue):null}convertDateForDisplay(n){return null==n||0===n.length?null:this.component.dateService.formatDateForDisplay(n)}convertOldValueForDisplay(n){if("date"===this.component.attributeType.type)return this.component.dateService.formatDateForDisplay(new Date(n));if("_PARENT_"===this.component.attributeType.code&&n.includes("_~VST~_"))return n.split("_~VST~_")[1];if("term"===this.component.attributeType.type){let t=n;t instanceof Array&&(t=n[0]);let o=this.component.attributeType.rootTerm.children,a=o.findIndex(l=>l.code===t);return-1!==a?o[a].label.localizedValue:n}return"classification"===this.component.attributeType.type?n.label.localizedValue:n}convertValueForDisplay(n){return n??null}calculateSummaryKey(){if(null==this.editor.diff)return void(this.summaryKey=bs.UNMODIFIED);if("CREATE"===this.editor.diff.action)return void(this.summaryKey=bs.NEW);if("DELETE"===this.editor.diff.action)return void(this.summaryKey=bs.DELETE);let n=null!=this.editor.diff.newStartDate||null!=this.editor.diff.newEndDate,t=Object.prototype.hasOwnProperty.call(this.editor.diff,"newValue");this.summaryKey=n&&t?bs.UPDATE:n?bs.TIME_CHANGE:t?bs.VALUE_CHANGE:bs.UNMODIFIED}set summaryKey(n){this.summaryKeyData=n,this.localizeSummaryKey()}get summaryKey(){return this.summaryKeyData}localizeSummaryKey(){this.summaryKeyLocalized=this.component.lService.decode("changeovertime.manageVersions.summaryKey."+this.summaryKeyData)}conflictMessagesHasSeverity(n){let t=!1;return this.editor.conflictMessages.forEach(o=>{o.severity===n&&(t=!0)}),t}hasError(){return this.editor.conflictMessages&&this.editor.conflictMessages.size>0&&this.conflictMessagesHasSeverity("ERROR")}hasWarning(){return!this.hasError()&&this.editor.conflictMessages&&this.editor.conflictMessages.size>0&&this.conflictMessagesHasSeverity("WARNING")}destroy(n){let t=[];null!=this.editingLayer&&(t.push(this.editingLayer.getId()),this.editingLayer=null),null!=this.oldLayer&&(t.push(this.oldLayer.getId()),this.oldLayer=null),n.geomService.removeLayers(t)}}var zs=v(39160),$m=v(70919),Sn=v(74272),al=v(63807),Xl=v(39723);const W0=["mapDiv"];class Dh{constructor(n,t,o){this.geomService=n,this.registryService=t,this.mapService=o,this._mapHeight=400,this.readOnly=!1}set mapHeight(n){n>400&&(this._mapHeight=n)}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.mapDiv.nativeElement.id=Math.floor(899999*Math.random())+1e5,this.map=new sr.Map({container:this.mapDiv.nativeElement.id,style:"mapbox://styles/mapbox/satellite-v9",zoom:2,center:[110.880453,10.897852]}),this.map.on("load",()=>{this.initMap()})},0)}ngOnDestroy(){this.geomService.destroy()}getIsValid(){return this.geomService.isValid()}initMap(){this.map.on("style.load",()=>{}),this.geomService.initialize(this.map,this.geometryType,!1),this.map.addControl(new sr.NavigationControl),this.zoomToBbox()}zoomToBbox(){this.geomService.zoomToLayersExtent()}error(n){console.log("ERROR",n)}}Dh.\u0275fac=function(n){return new(n||Dh)(e.Y36(vo),e.Y36(Zi),e.Y36(ys))},Dh.\u0275cmp=e.Xpm({type:Dh,selectors:[["geoobject-editor-map","geometryType",""]],viewQuery:function(n,t){if(1&n&&e.Gf(W0,5),2&n){let o;e.iGM(o=e.CRH())&&(t.mapDiv=o.first)}},inputs:{mapHeight:"mapHeight",geometryType:"geometryType",bboxCode:"bboxCode",bboxType:"bboxType",bboxDate:"bboxDate",readOnly:"readOnly"},attrs:["geometryType",""],decls:3,vars:2,consts:[[1,"geoobject-editor-map-wrapper"],[1,"map-view-port-inline","text-left",2,"width","calc(100% - 15px)"],["mapDiv",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"div",1,2),e.qZA()),2&n&&(e.xp6(1),e.Udp("height",t._mapHeight,"px"))}});class Mc{constructor(n,t){this.http=n,this.eventService=t}apply(n,t,o,a){let l=new ot.WM({"Content-Type":"application/json"});const _={classificationCode:n,classification:o,isNew:a};return null!=t&&(_.parentCode=t),this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/classification/apply",JSON.stringify(_),{headers:l}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}remove(n,t){let o=new ot.WM({"Content-Type":"application/json"});const a={classificationCode:n,code:t};return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/classification/remove",JSON.stringify(a),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}move(n,t,o){let a=new ot.WM({"Content-Type":"application/json"});const l={classificationCode:n,code:t,parentCode:o};return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/classification/move",JSON.stringify(l),{headers:a}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getChildren(n,t,o,a){let l=new ot.LE;return l=l.set("classificationCode",n),l=l.set("pageNumber",o.toString()),l=l.set("pageSize",a.toString()),null!=t&&(l=l.set("code",t)),this.http.get(pt.N.apiUrl+"/api/classification/get-children",{params:l}).toPromise()}getAncestorTree(n,t,o,a){let l=new ot.LE;return l=l.set("classificationCode",n),l=l.set("code",o),l=l.set("pageSize",a.toString()),null!=t&&(l=l.set("rootCode",t)),this.http.get(pt.N.apiUrl+"/api/classification/get-ancestor-tree",{params:l}).toPromise()}search(n,t,o){let a=new ot.LE;return a=a.set("classificationCode",n),null!=t&&(a=a.set("rootCode",t)),null!=o&&(a=a.set("text",o)),this.http.get(pt.N.apiUrl+"/api/classification/search",{params:a}).toPromise()}get(n,t){let o=new ot.LE;return o=o.set("classificationCode",n),o=o.set("code",t),this.http.get(pt.N.apiUrl+"/api/classification/get",{params:o}).toPromise()}}Mc.\u0275fac=function(n){return new(n||Mc)(e.LFG(ot.eN),e.LFG(nn.PO))},Mc.\u0275prov=e.Yz7({token:Mc,factory:Mc.\u0275fac});const ex=["nodeMenu"];function tx(i,n){1&i&&e._uU(0," Select ")}var Oc=(()=>{return(i=Oc||(Oc={}))[i.CLASSIFICATION=0]="CLASSIFICATION",i[i.LINK=1]="LINK",Oc;var i})();class Rh{constructor(n,t,o){this.bsModalRef=n,this.contextMenuService=t,this.service=o,this.message=null,this.classificationType=null,this.rootCode=null,this.disabled=!1,this.select=new pn.x,this.nodes=[],this.options={idField:"code",getChildren:a=>this.getChildren(a),actionMapping:{mouse:{click:(a,l,_)=>{this.treeNodeOnClick(l,_)},contextMenu:(a,l,_)=>{this.handleOnMenu(l,_)}}},allowDrag:!1,allowDrop:!1,animateExpand:!0,scrollOnActivate:!0,animateSpeed:2,animateAcceleration:1.01}}init(n,t,o,a,l){return this.classificationType=n,this.rootCode=t,this.disabled=o,null!=a?this.service.getAncestorTree(this.classificationType,this.rootCode,a.code,100).then(_=>{this.nodes=[this.build(null,_)],kh(()=>{this.tree.treeModel.getNodeById(a.code)?.setActiveAndVisible()},100)}):null!=this.rootCode?this.service.get(this.classificationType,this.rootCode).then(_=>{this.nodes=[{code:_.code,name:_.displayLabel.localizedValue,type:Oc.CLASSIFICATION,classification:_,hasChildren:!0}]}):this.getChildren(null).then(_=>{this.nodes=_}),this.select.subscribe(l)}ngOnDestroy(){this.select.unsubscribe()}getChildren(n){const t=null!=n?n.data:null;return this.service.getChildren(this.classificationType,null!=t?t.classification.code:null,1,100).then(a=>{const l=this.createNodes(t,a);return null!=t&&(null==t.children&&(t.children=[]),t.children.concat(l)),l}).catch(a=>[])}build(n,t){const o={code:t.classification.code,name:t.classification.displayLabel.localizedValue,type:Oc.CLASSIFICATION,classification:t.classification,hasChildren:!0};if(null!=t.children){const a=t.children.resultSet.map(_=>this.build(n,_)),l=t.children;l.count>l.pageNumber*l.pageSize&&a.push({code:"...",name:"...",type:Oc.LINK,hasChildren:!1,pageNumber:l.pageNumber+1,parent:n}),o.children=a}return o}createNodes(n,t){const o=t.resultSet.map(a=>({code:a.code,name:a.displayLabel.localizedValue,type:Oc.CLASSIFICATION,classification:a,hasChildren:!0}));return t.count>t.pageNumber*t.pageSize&&o.push({code:"...",name:"...",type:Oc.LINK,hasChildren:!1,pageNumber:t.pageNumber+1,parent:n}),o}handleOnMenu(n,t){this.disabled||(this.contextMenuService.show.next({contextMenu:this.nodeMenuComponent,event:t,item:n}),t.preventDefault(),t.stopPropagation())}treeNodeOnClick(n,t){const o=null!=n?n.data:null;if(null!=o&&o.type===Oc.LINK){if(null!=n.parent){const a=n.parent.data;this.service.getChildren(this.classificationType,a.classification.code,o.pageNumber,100).then(C=>{const N=this.createNodes(a,C);a.children=a.children.filter(F=>"..."!==F.code),a.children=a.children.concat(N),this.tree.treeModel.update()}).catch(C=>{})}}else n.isExpanded?n.collapse():n.expand(),n.setActiveAndVisible()}onSelect(n){const t=null!=n?n.data:null;t.type===Oc.CLASSIFICATION&&(this.select.next(t.classification),this.bsModalRef.hide())}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function nx(i,n){if(1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i){const t=n.item;e.xp6(1),e.AsE("",t.displayLabel.localizedValue," : ",t.code,"")}}Rh.\u0275fac=function(n){return new(n||Rh)(e.Y36(Ln.UZ),e.Y36(P.Lk),e.Y36(Mc))},Rh.\u0275cmp=e.Xpm({type:Rh,selectors:[["classification-field-modal"]],viewQuery:function(n,t){if(1&n&&(e.Gf(S.qr,5),e.Gf(ex,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.tree=o.first),e.iGM(o=e.CRH())&&(t.nodeMenuComponent=o.first)}},decls:15,vars:2,consts:[["menuClass","top-level"],["nodeMenu",""],["contextMenuItem","",3,"execute"],[1,"modal-body"],[1,"modal-form"],["form","ngForm"],[1,"row"],[1,"col-md-12"],[3,"options","nodes"],["tree",""],[1,"row-holder"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.back"]],template:function(n,t){1&n&&(e.TgZ(0,"context-menu",0,1),e.YNc(2,tx,1,0,"ng-template",2),e.NdJ("execute",function(a){return t.onSelect(a.item)}),e.qZA(),e.TgZ(3,"div",3)(4,"form",4,5)(6,"fieldset")(7,"div",6)(8,"div",7),e._UZ(9,"tree-root",8,9),e.qZA()(),e.TgZ(11,"div",10)(12,"div",11)(13,"button",12),e.NdJ("click",function(){return t.onCancel()}),e._UZ(14,"localize",13),e.qZA()()()()()()),2&n&&(e.xp6(9),e.Q6J("options",t.options)("nodes",t.nodes))},dependencies:[y._Y,y.JL,y.F,S.qr,P.GI,P.n5,Sn.l],encapsulation:2});const ix=function(i){return{"inline-loading":i}};class Lp{constructor(n,t){this.modalService=n,this.service=t,this.disabled=!1,this.customStyles="",this.classNames="",this.container=null,this.value=null,this.valueChange=new e.vpe,this.loading=!1,this.text="",this.typeahead=null,this.subscription=null}ngOnInit(){this.typeahead=new Ni.y(n=>{this.service.search(this.classificationType,this.rootCode,this.text).then(t=>{n.next(t)})}),null!=this.value&&(this.text=this.value.label.localizedValue)}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe()}typeaheadOnSelect(n){if(null!=n){const t=n.item;this.text=t.displayLabel.localizedValue,(null==this.value||this.value.code!==t.code)&&this.setValue({code:t.code,label:t.displayLabel})}else null!=this.value&&this.setValue(null)}setValue(n){this.value=n,this.valueChange.emit(this.value)}onViewTree(){const n=this.modalService.show(Rh,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});this.subscription=n.content.init(this.classificationType,this.rootCode,this.disabled,this.value,t=>{this.text=t.displayLabel.localizedValue,this.setValue({code:t.code,label:t.displayLabel})})}onTextChange(){null!=this.value&&(null==this.text||0===this.text.length)&&this.setValue(null)}}Lp.\u0275fac=function(n){return new(n||Lp)(e.Y36(Ln.tT),e.Y36(Mc))},Lp.\u0275cmp=e.Xpm({type:Lp,selectors:[["classification-field"]],inputs:{classificationType:"classificationType",rootCode:"rootCode",name:"name",disabled:"disabled",customStyles:"customStyles",classNames:"classNames",container:"container",value:"value"},outputs:{valueChange:"valueChange"},decls:6,vars:17,consts:[["customItemTemplate",""],[1,"input-group"],["type","text","autocomplete","off",1,"form-control",3,"name","disabled","ngModel","typeaheadAsync","typeahead","ngClass","typeaheadOptionsLimit","typeaheadItemTemplate","typeaheadMinLength","typeaheadWaitMs","container","ngModelChange","change","typeaheadOnSelect","typeaheadLoading"],[1,"input-group-addon","clickable","addon-alert",3,"click"],["aria-hidden","true",1,"fa","fa-ellipsis-v"]],template:function(n,t){if(1&n&&(e.YNc(0,nx,2,2,"ng-template",null,0,e.W1O),e.TgZ(2,"div",1)(3,"input",2),e.NdJ("ngModelChange",function(a){return t.text=a})("change",function(){return t.onTextChange()})("typeaheadOnSelect",function(a){return t.typeaheadOnSelect(a)})("typeaheadLoading",function(a){return t.loading=a}),e.qZA(),e.TgZ(4,"span",3),e.NdJ("click",function(){return t.onViewTree()}),e._UZ(5,"i",4),e.qZA()()),2&n){const o=e.MAs(1);e.xp6(3),e.Akn(t.customStyles),e.Tol(t.classNames),e.Q6J("name",t.name)("disabled",t.disabled)("ngModel",t.text)("typeaheadAsync",!0)("typeahead",t.typeahead)("ngClass",e.VKq(15,ix,t.loading))("typeaheadOptionsLimit",7)("typeaheadItemTemplate",o)("typeaheadMinLength",0)("typeaheadWaitMs",300)("container",t.container)}},dependencies:[T.mk,y.Fj,y.JJ,y.On,A.Bp],encapsulation:2});var ia=v(68736);const ox=["dateFieldComponents"];function rx(i,n){if(1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i){const t=n.item;e.xp6(1),e.AsE("",t.name," : ",t.code,"")}}function ax(i,n){1&i&&(e.TgZ(0,"p",16),e._UZ(1,"localize",17),e.qZA())}function sx(i,n){1&i&&(e.TgZ(0,"div"),e._UZ(1,"localize",18),e.qZA())}function lx(i,n){if(1&i&&(e.TgZ(0,"div",32),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.summaryKeyLocalized," ")}}function cx(i,n){1&i&&(e.TgZ(0,"p",40),e._UZ(1,"localize",41),e.qZA())}function ux(i,n){if(1&i&&(e.TgZ(0,"div")(1,"p",42),e._UZ(2,"localize",43),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit,o=e.oxw(2).$implicit,a=e.oxw(4);e.xp6(3),e.hij(" ",a.getValueAtLocale(o.oldValue,t.locale)," ")}}const zp=function(i){return{"has-changed":i}};function px(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",34)(1,"td",35)(2,"h5"),e._UZ(3,"convert-key-label",36),e.qZA(),e.TgZ(4,"input",37),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)})("ngModelChange",function(){e.CHM(t);const a=e.oxw(2).$implicit;return e.KtG(a.editor.setLocalizedValue(a.value))}),e.qZA(),e.TgZ(5,"div",38),e.YNc(6,cx,2,0,"p",39),e.qZA(),e.YNc(7,ux,4,1,"div",9),e.qZA()()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw(2),l=a.$implicit,_=a.index,C=e.oxw(4);e.xp6(3),e.Q6J("key",t.locale),e.xp6(1),e.Q6J("ngClass",e.VKq(8,zp,C.hasLocalizationChanged(l,t.locale)&&!C.isNew))("disabled",C.readonly||"DELETE"===l.summaryKey)("name","loc-val-"+_+"-"+o)("ngModel",t.value)("required","defaultLocale"===t.locale),e.xp6(2),e.Q6J("ngIf","defaultLocale"===t.locale&&!t.value),e.xp6(1),e.Q6J("ngIf",C.hasLocalizationChanged(l,t.locale)&&!C.isNew)}}function dx(i,n){if(1&i&&(e.ynx(0),e.YNc(1,px,8,10,"tr",33),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.value.localeValues)}}function hx(i,n){if(1&i&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label.localizedValue)}}function fx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"select",45),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e._UZ(2,"option",46),e.YNc(3,hx,2,2,"option",47),e.qZA()()}if(2&i){const t=e.oxw(2),o=t.$implicit,a=t.index,l=e.oxw(4);e.xp6(1),e.MGl("id","mod-",l.attributeType.code,""),e.Q6J("ngClass",e.VKq(6,zp,o.oldValue&&!l.isNew))("name","mod-term-"+a+"-"+l.attributeType.code)("ngModel",o.value)("disabled",l.readonly||"DELETE"===o.summaryKey),e.xp6(2),e.Q6J("ngForOf",l.getGeoObjectTypeTermAttributeOptions(l.attributeType.code))}}function gx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"classification-field",49),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA()()}if(2&i){const t=e.oxw(2),o=t.$implicit,a=t.index,l=e.oxw(4);e.xp6(1),e.Q6J("classificationType",l.attributeType.classificationType)("rootCode",null!=l.attributeType.rootTerm?l.attributeType.rootTerm.code:null)("classNames",o.oldValue&&!l.isNew?"has-changed":"")("name","mod-term-"+a+"-"+l.attributeType.code)("value",o.value)("disabled",l.readonly||"DELETE"===o.summaryKey)}}function _x(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"input",50),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA()()}if(2&i){const t=e.oxw(2),o=t.$implicit,a=t.index,l=e.oxw(4);e.xp6(1),e.Q6J("ngClass",e.VKq(4,zp,o.oldValue&&!l.isNew))("name","char-val-"+a)("ngModel",o.value)("disabled",l.readonly||"DELETE"===o.summaryKey)}}function mx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"date-field",51),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)})("validChange",function(a){e.CHM(t);const l=e.oxw(6);return e.KtG(l.isValid=a)}),e.qZA()()}if(2&i){const t=e.oxw(2),o=t.$implicit,a=t.index,l=e.oxw(4);e.xp6(1),e.Q6J("customStyles",o.oldValue&&!l.isNew?"color: orange;":"")("value",o.value)("inputName","date-val-"+a)("allowInfinity",!1)("allowFutureDates",!0)("required",!0)("placement","right")("valid",l.isValid)("disable",l.readonly)}}function yx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"input",52),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA()()}if(2&i){const t=e.oxw(2),o=t.$implicit,a=t.index,l=e.oxw(4);e.xp6(1),e.Q6J("ngClass",e.VKq(4,zp,o.oldValue&&!l.isNew))("name","int-val-"+a)("ngModel",o.value)("disabled",l.readonly||"DELETE"===o.summaryKey)}}function vx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"label",53)(2,"input",54),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.TgZ(3,"span",55),e._UZ(4,"localize",56),e.qZA()(),e.TgZ(5,"label",57)(6,"input",58),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.TgZ(7,"span",55),e._UZ(8,"localize",59),e.qZA()()()}if(2&i){const t=e.oxw(2),o=t.index,a=t.$implicit,l=e.oxw(4);e.xp6(2),e.MGl("id","mod-",o,"-true")("name","mod-",o,"-true"),e.Q6J("checked",!0===a.value)("value",!0)("ngModel",a.value)("disabled",l.readonly||"DELETE"===a.summaryKey),e.xp6(1),e.Q6J("ngClass",e.VKq(15,zp,a.oldValue&&!l.isNew)),e.xp6(3),e.MGl("id","mod-",o,"-false")("name","mod-",o,"-false"),e.Q6J("ngClass",e.VKq(17,zp,a.oldValue&&!l.isNew))("checked",!1===a.value)("value",!1)("ngModel",a.value)("disabled",l.readonly||"DELETE"===a.summaryKey),e.xp6(1),e.Q6J("ngClass",e.VKq(19,zp,a.oldValue&&!l.isNew))}}function bx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",66),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4).$implicit;return e.KtG(l.editor.removeType(a))}),e._UZ(1,"i",67),e.qZA()}}function xx(i,n){1&i&&e._UZ(0,"span",68)}const Cx=function(i,n){return{"inline-loading":i,"has-changed":n}};function wx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",61),e._uU(1),e.TgZ(2,"div",62)(3,"input",63),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit,C=e.oxw(4).$implicit;return e.KtG(C.value.parents[_.code].text=a)})("typeaheadOnSelect",function(a){const _=e.CHM(t).$implicit,C=e.oxw(4).$implicit,N=e.oxw(4);return e.KtG(N.typeaheadOnSelect(C.editor,a,_,C.value,C.startDate))})("typeaheadLoading",function(a){const _=e.CHM(t).$implicit,C=e.oxw(4).$implicit;return e.KtG(C.value.loading[_.code]=a)}),e.qZA(),e.YNc(4,bx,2,0,"span",64),e.YNc(5,xx,1,0,"span",65),e.qZA()()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw(4),l=a.index,_=a.$implicit,C=e.oxw(4),N=e.MAs(2);e.xp6(1),e.hij(" ",t.label," "),e.xp6(2),e.Q6J("name",t.code+"-"+l)("disabled",C.readonly||"DELETE"===_.summaryKey||null==_.startDate||""===_.startDate)("ngModel",_.value.parents[t.code].text)("typeaheadAsync",!0)("typeahead",C.getTypeAheadObservable(_.editor,_.startDate,_.endDate,t,_.value,o))("ngClass",e.WLB(13,Cx,_.value.loading[t.code],_.oldValue&&!C.isNew))("typeaheadOptionsLimit",7)("typeaheadItemTemplate",N)("typeaheadMinLength",0)("typeaheadWaitMs",300),e.xp6(1),e.Q6J("ngIf",!C.readonly),e.xp6(1),e.Q6J("ngIf",C.readonly)}}function Tx(i,n){if(1&i&&(e.ynx(0),e.YNc(1,wx,6,16,"div",60),e.BQk()),2&i){const t=e.oxw(7);e.xp6(1),e.Q6J("ngForOf",t.hierarchy.types)}}function Mx(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Tx,2,1,"ng-container",9),e.qZA()),2&i){const t=e.oxw(6);e.xp6(1),e.Q6J("ngIf",null!=t.hierarchy&&null!=t.hierarchy.types&&t.hierarchy.types.length>0)}}function Ox(i,n){1&i&&(e.TgZ(0,"span",74),e._UZ(1,"localize",56),e.qZA())}function Sx(i,n){1&i&&(e.TgZ(0,"span",74),e._UZ(1,"localize",59),e.qZA())}function Px(i,n){if(1&i&&(e.TgZ(0,"div")(1,"p",69),e._UZ(2,"localize",43),e.ynx(3,70)(4,71),e.YNc(5,Ox,2,0,"span",72),e.YNc(6,Sx,2,0,"span",72),e.BQk(),e.ynx(7,73),e._uU(8),e.BQk()(),e.qZA()()),2&i){const t=e.oxw(2).$implicit,o=e.oxw(4);e.xp6(5),e.Q6J("ngIf","invalid"===o.attributeType.code?!1===t.oldValue:!0===t.oldValue),e.xp6(1),e.Q6J("ngIf","invalid"===o.attributeType.code?!0===t.oldValue:!1===t.oldValue),e.xp6(2),e.hij(" ",t.oldValue," ")}}function Ex(i,n){1&i&&e._UZ(0,"localize",85)}function Ax(i,n){1&i&&e._UZ(0,"localize",86)}function kx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",82),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3).$implicit,l=e.oxw(4);return e.KtG(l.toggleOldGeometryView(a))}),e.YNc(1,Ex,1,0,"localize",83),e.YNc(2,Ax,1,0,"localize",84),e.qZA()}if(2&i){const t=e.oxw(3).$implicit;e.Q6J("disabled",t.coordinate&&(null!=t.coordinate.longValid&&!t.coordinate.longValid||null!=t.coordinate.latValid&&!t.coordinate.latValid)),e.xp6(1),e.Q6J("ngIf",!t.oldLayer||!t.oldLayer.rendered),e.xp6(1),e.Q6J("ngIf",t.oldLayer&&t.oldLayer.rendered)}}function Ix(i,n){1&i&&e._UZ(0,"localize",87)}function Zx(i,n){1&i&&e._UZ(0,"localize",88)}function Nx(i,n){1&i&&e._UZ(0,"localize",91)}function Lx(i,n){1&i&&e._UZ(0,"localize",92)}function zx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",82),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3).$implicit,l=e.oxw(4);return e.KtG(l.toggleGeometryEditing(a))}),e.YNc(1,Nx,1,0,"localize",89),e.YNc(2,Lx,1,0,"localize",90),e.qZA()}if(2&i){const t=e.oxw(3).$implicit,o=e.oxw(4);e.Q6J("disabled",o.readonly||t.coordinate&&(null!=t.coordinate.longValid&&!t.coordinate.longValid||null!=t.coordinate.latValid&&!t.coordinate.latValid)),e.xp6(1),e.Q6J("ngIf",t.editingLayer&&!t.editingLayer.editing),e.xp6(1),e.Q6J("ngIf",t.editingLayer&&t.editingLayer.editing)}}function Dx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",93),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3).$implicit,l=e.oxw(4);return e.KtG(l.onAddNewVersion(a.editor))}),e.qZA()}}function Rx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",100),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(4).$implicit;return e.KtG(l.value.coordinates[0][1]=a)})("change",function(){e.CHM(t);const a=e.oxw(4).$implicit,l=e.oxw(4);return e.KtG(l.manualCoordinateChange(a))}),e.qZA()}if(2&i){const t=e.oxw(4),o=t.$implicit,a=t.index,l=e.oxw(4);e.Q6J("readonly",l.readonly||!(o.editingLayer&&o.editingLayer.editing)||"DELETE"===o.summaryKey)("name","latitude-"+a)("ngModel",o.value.coordinates[0][1])}}function Fx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",100),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(4).$implicit;return e.KtG(l.newCoordinateY=a)})("change",function(){e.CHM(t);const a=e.oxw(4).$implicit,l=e.oxw(4);return e.KtG(l.manualCoordinateChange(a))}),e.qZA()}if(2&i){const t=e.oxw(4),o=t.$implicit,a=t.index,l=e.oxw(4);e.Q6J("readonly",l.readonly||!(o.editingLayer&&o.editingLayer.editing)||"DELETE"===o.summaryKey)("name","latitude-"+a)("ngModel",o.newCoordinateY)}}function Ux(i,n){1&i&&(e.TgZ(0,"div")(1,"p",40),e._UZ(2,"localize",101),e.qZA()())}function qx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",100),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(4).$implicit;return e.KtG(l.value.coordinates[0][0]=a)})("change",function(){e.CHM(t);const a=e.oxw(4).$implicit,l=e.oxw(4);return e.KtG(l.manualCoordinateChange(a))}),e.qZA()}if(2&i){const t=e.oxw(4),o=t.$implicit,a=t.index,l=e.oxw(4);e.Q6J("readonly",l.readonly||!(o.editingLayer&&o.editingLayer.editing)||"DELETE"===o.summaryKey)("name","longitude-"+a)("ngModel",o.value.coordinates[0][0])}}function Jx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",100),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(4).$implicit;return e.KtG(l.newCoordinateX=a)})("change",function(){e.CHM(t);const a=e.oxw(4).$implicit,l=e.oxw(4);return e.KtG(l.manualCoordinateChange(a))}),e.qZA()}if(2&i){const t=e.oxw(4),o=t.$implicit,a=t.index,l=e.oxw(4);e.Q6J("readonly",l.readonly||!(o.editingLayer&&o.editingLayer.editing)||"DELETE"===o.summaryKey)("name","longitude-"+a)("ngModel",o.newCoordinateX)}}function jx(i,n){1&i&&(e.TgZ(0,"div")(1,"p",40),e._UZ(2,"localize",102),e.qZA()())}function Bx(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",94)(2,"h5"),e._UZ(3,"localize",95),e.qZA(),e.TgZ(4,"div",96),e.YNc(5,Rx,1,3,"input",97),e.YNc(6,Fx,1,3,"input",97),e.qZA(),e.YNc(7,Ux,3,0,"div",9),e.qZA(),e.TgZ(8,"td",98)(9,"h5"),e._UZ(10,"localize",99),e.qZA(),e.TgZ(11,"div",96),e.YNc(12,qx,1,3,"input",97),e.YNc(13,Jx,1,3,"input",97),e.qZA(),e.YNc(14,jx,3,0,"div",9),e.qZA()()),2&i){const t=e.oxw(3).$implicit;e.xp6(5),e.Q6J("ngIf",t.value.coordinates&&t.value.coordinates[0]),e.xp6(1),e.Q6J("ngIf",null==t.value.coordinates||null==t.value.coordinates[0]),e.xp6(1),e.Q6J("ngIf",t.coordinate&&null!=t.coordinate.latValid&&!t.coordinate.latValid),e.xp6(5),e.Q6J("ngIf",t.value.coordinates&&t.value.coordinates[0]),e.xp6(1),e.Q6J("ngIf",null==t.value.coordinates||null==t.value.coordinates[0]),e.xp6(1),e.Q6J("ngIf",t.coordinate&&null!=t.coordinate.longValid&&!t.coordinate.longValid)}}function Gx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"table",75)(1,"tr")(2,"td",76),e.YNc(3,kx,3,3,"button",77),e.TgZ(4,"button",78),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(4);return e.KtG(l.toggleGeometryView(a))}),e.YNc(5,Ix,1,0,"localize",79),e.YNc(6,Zx,1,0,"localize",80),e.qZA(),e.YNc(7,zx,3,3,"button",77),e.YNc(8,Dx,1,0,"i",81),e.qZA()(),e.YNc(9,Bx,15,6,"tr",9),e.qZA()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(4);e.xp6(3),e.Q6J("ngIf",t.oldValue&&t.editingLayer),e.xp6(1),e.Q6J("disabled",t.coordinate&&(null!=t.coordinate.longValid&&!t.coordinate.longValid||null!=t.coordinate.latValid&&!t.coordinate.latValid)),e.xp6(1),e.Q6J("ngIf",!(t.objectLayer&&t.objectLayer.rendered||t.editingLayer&&t.editingLayer.rendered)),e.xp6(1),e.Q6J("ngIf",t.objectLayer&&t.objectLayer.rendered||t.editingLayer&&t.editingLayer.rendered),e.xp6(1),e.Q6J("ngIf",t.editingLayer&&t.editingLayer.rendered&&o.geoObjectType.isGeometryEditable),e.xp6(1),e.Q6J("ngIf",!(o.readonly||o.isRootOfHierarchy||o.isNew&&"exists"===o.attributeType.code||null!=o.filterDate)),e.xp6(1),e.Q6J("ngIf",("POINT"===o.geoObjectType.geometryType||"MULTIPOINT"===o.geoObjectType.geometryType)&&t.value&&t.value.coordinates&&(1==t.value.coordinates.length||0==t.value.coordinates.length))}}function Vx(i,n){if(1&i&&(e.TgZ(0,"tr",34)(1,"td",35),e.YNc(2,fx,4,8,"div",9),e.YNc(3,gx,2,6,"div",9),e.YNc(4,_x,2,6,"div",9),e.YNc(5,mx,2,9,"div",9),e.YNc(6,yx,2,6,"div",9),e.YNc(7,vx,9,21,"div",9),e.YNc(8,Mx,2,1,"div",9),e.YNc(9,Px,9,3,"div",9),e.YNc(10,Gx,10,7,"table",44),e.qZA()()),2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.xp6(2),e.Q6J("ngIf","term"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf","classification"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf","character"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf","date"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf","integer"===o.attributeType.type||"float"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf","boolean"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf","_PARENT_"===o.attributeType.type),e.xp6(1),e.Q6J("ngIf",t.oldValue&&!o.isNew&&"geometry"!==o.attributeType.type),e.xp6(1),e.Q6J("ngIf","geometry"===o.attributeType.type)}}function Yx(i,n){if(1&i&&(e.TgZ(0,"div")(1,"p",69),e._UZ(2,"localize",43),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.oldStartDate," ")}}const Hx=function(i,n){return{"error-message":i,"warning-message":n}};function Qx(i,n){if(1&i&&(e.TgZ(0,"p",55),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngClass",e.WLB(2,Hx,"ERROR"===t.severity,"WARNING"===t.severity)),e.xp6(1),e.hij(" ",t.message," ")}}function Kx(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,Qx,2,5,"p",103),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.editor.conflictMessages)}}function $x(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",104),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.remove(a))}),e.ALo(1,"localize"),e._UZ(2,"i",105),e.qZA()}if(2&i){const t=e.oxw(5);e.Q6J("title",e.lcZ(1,2,t.filterDate?"changeovertime.manageVersions.date.editing.needs.fullview.message":"changeovertime.manageVersions.remove.version")),e.uIk("disabled","exists"===t.attributeType.code||null!=t.filterDate)}}function Wx(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",104),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.remove(a))}),e.ALo(1,"localize"),e._UZ(2,"i",106),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"changeovertime.manageVersions.revert.version"))}const Xx=function(i){return{"geometry-edit-active":i}},e2=function(i,n,t){return{"error-border":i,"warning-border":n,warning:t}};function t2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",20)(1,"td",21),e.YNc(2,lx,2,1,"div",22),e.TgZ(3,"table"),e.YNc(4,dx,2,1,"ng-container",9),e.YNc(5,Vx,11,9,"tr",23),e.TgZ(6,"tr",24)(7,"td")(8,"h5"),e._UZ(9,"localize",25),e.qZA(),e.TgZ(10,"date-field",26,27),e.NdJ("valueChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.startDate=a)})("change",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onDateChange())}),e.ALo(12,"localize"),e.qZA(),e.YNc(13,Yx,4,1,"div",9),e.qZA(),e.TgZ(14,"td")(15,"div",28)(16,"h5"),e._UZ(17,"localize",29),e.qZA(),e.TgZ(18,"date-field",30,27),e.NdJ("valueChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.endDate=a)})("change",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onDateChange())}),e.ALo(20,"localize"),e.qZA()()()(),e.YNc(21,Kx,2,1,"tr",9),e.qZA()(),e.YNc(22,$x,3,4,"td",31),e.YNc(23,Wx,3,3,"td",31),e.qZA()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw(4);e.Q6J("ngClass",e.VKq(30,Xx,t.editingLayer&&t.editingLayer.editing)),e.xp6(1),e.Q6J("ngClass",e.kEZ(32,e2,t.hasError(),t.hasWarning(),t.summaryKey&&"UNMODIFIED"!==t.summaryKey)),e.xp6(1),e.Q6J("ngIf",t.summaryKey&&"UNMODIFIED"!==t.summaryKey),e.xp6(2),e.Q6J("ngIf","local"===a.attributeType.type&&t.value),e.xp6(1),e.Q6J("ngIf","geometry"===a.attributeType.type||"_PARENT_"===a.attributeType.type||"term"===a.attributeType.type||"classification"===a.attributeType.type||"character"===a.attributeType.type||"date"===a.attributeType.type||"integer"===a.attributeType.type||"float"===a.attributeType.type||"boolean"===a.attributeType.type),e.xp6(5),e.Q6J("customStyles",t.oldStartDate&&!a.isNew?"color: orange;":"")("value",t.startDate)("inputName","startDate_"+o)("allowFutureDates",!0)("required",!0)("disable",a.readonly||"DELETE"===t.summaryKey||null!=a.filterDate)("title",e.lcZ(12,26,a.filterDate&&!a.readonly?"changeovertime.manageVersions.date.editing.needs.fullview.message":"")),e.xp6(3),e.Q6J("ngIf",t.oldStartDate&&!a.isNew),e.xp6(5),e.Q6J("customStyles",t.oldEndDate&&!a.isNew?"color: orange;":"")("value",t.endDate)("inputName","endDate_"+o)("allowInfinity","DELETE"!==t.summaryKey&&!a.readonly)("allowFutureDates",!0)("required",!0)("placement","bottom")("oldDate",t.oldEndDate&&!a.isNew?t.oldEndDate:null)("disable",a.readonly||"DELETE"===t.summaryKey||null!=a.filterDate)("title",e.lcZ(20,28,null!=a.filterDate?"changeovertime.manageVersions.date.editing.needs.fullview.message":"")),e.xp6(3),e.Q6J("ngIf",t.editor.conflictMessages&&t.editor.conflictMessages.size>0),e.xp6(1),e.Q6J("ngIf",!(a.readonly||a.isNew&&"exists"===a.attributeType.code||"UNMODIFIED"!==t.summaryKey)),e.xp6(1),e.Q6J("ngIf",!(a.readonly||a.isNew&&"exists"===a.attributeType.code||"UNMODIFIED"===t.summaryKey))}}function n2(i,n){if(1&i&&(e.ynx(0),e.YNc(1,t2,24,36,"tr",19),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.viewModels)}}function i2(i,n){if(1&i&&(e.TgZ(0,"div")(1,"table",13)(2,"tbody",14),e.YNc(3,ax,2,0,"p",15),e.YNc(4,sx,2,0,"div",9),e.YNc(5,n2,2,1,"ng-container",9),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",!t.isRootOfHierarchy&&0===t.viewModels.length),e.xp6(1),e.Q6J("ngIf",t.isRootOfHierarchy),e.xp6(1),e.Q6J("ngIf",!t.isRootOfHierarchy)}}function o2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",107)(1,"i",108),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onAddNewVersion())}),e._UZ(2,"localize",109),e.qZA()()}}const Xm=function(i){return{active:i}};function r2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",110)(1,"button",111),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onApprove())}),e.ALo(2,"localize"),e._UZ(3,"localize",112),e.qZA(),e.TgZ(4,"button",113),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onReject())}),e.ALo(5,"localize"),e._UZ(6,"localize",114),e.qZA(),e.TgZ(7,"button",115),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onPending())}),e.ALo(8,"localize"),e._UZ(9,"localize",116),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled","ACCEPTED"===t.changeRequestAttributeEditor.editAction.approvalStatus)("ngClass",e.VKq(15,Xm,"ACCEPTED"===t.changeRequestAttributeEditor.editAction.approvalStatus))("title",e.lcZ(2,9,"change.request.action.accept.btn.hover")),e.xp6(3),e.Q6J("disabled","REJECTED"===t.changeRequestAttributeEditor.editAction.approvalStatus)("ngClass",e.VKq(17,Xm,"REJECTED"===t.changeRequestAttributeEditor.editAction.approvalStatus))("title",e.lcZ(5,11,"change.request.action.reject.btn.hover")),e.xp6(3),e.Q6J("disabled","PENDING"===t.changeRequestAttributeEditor.editAction.approvalStatus)("ngClass",e.VKq(19,Xm,"PENDING"===t.changeRequestAttributeEditor.editAction.approvalStatus))("title",e.lcZ(8,13,"change.request.action.pending.btn.hover"))}}function a2(i,n){1&i&&(e.TgZ(0,"strong",119),e._UZ(1,"localize",120),e.qZA())}function s2(i,n){1&i&&(e.TgZ(0,"strong",121),e._UZ(1,"localize",122),e.qZA())}function l2(i,n){if(1&i&&(e.TgZ(0,"div",110),e.YNc(1,a2,2,0,"strong",117),e.YNc(2,s2,2,0,"strong",118),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","ACCEPTED"===t.changeRequestAttributeEditor.editAction.approvalStatus),e.xp6(1),e.Q6J("ngIf","REJECTED"===t.changeRequestAttributeEditor.editAction.approvalStatus)}}function c2(i,n){if(1&i&&(e.TgZ(0,"div",6)(1,"ul",7)(2,"li",8),e.YNc(3,i2,6,3,"div",9),e.qZA(),e.YNc(4,o2,3,0,"li",10),e.qZA(),e.YNc(5,r2,10,21,"div",11),e.YNc(6,l2,3,2,"div",12),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.attributeType),e.xp6(1),e.Q6J("ngIf",!(t.readonly||t.isRootOfHierarchy||t.isNew&&"exists"===t.attributeType.code||null!=t.filterDate)),e.xp6(1),e.Q6J("ngIf",!t.changeRequestEditor.changeRequest.isNew&&"CreateGeoObject"!==t.changeRequestEditor.changeRequest.type&&"PENDING"===t.changeRequestEditor.changeRequest.approvalStatus&&t.changeRequestEditor.changeRequest.permissions.includes("WRITE_APPROVAL_STATUS")&&t.changeRequestAttributeEditor.hasChanges()),e.xp6(1),e.Q6J("ngIf",!t.changeRequestEditor.changeRequest.isNew&&"PENDING"!==t.changeRequestEditor.changeRequest.approvalStatus)}}function u2(i,n){if(1&i&&e._UZ(0,"geoobject-editor-map",123,124),2&i){const t=e.oxw();e.Q6J("geometryType",t.geoObjectType.geometryType)("mapHeight",t.mapRowHeight)("readOnly",!t.geoObjectType.isGeometryEditable&&t.readonly)("bboxCode",t.changeRequestEditor.geoObject.attributes.code)("bboxType",t.geoObjectType.code)}}const p2=function(i){return{width:i}};class yd{constructor(n,t,o,a,l,_,C,N,F,V){this.geomService=n,this.cdr=t,this.service=o,this.lService=a,this.changeDetectorRef=l,this.dateService=_,this.authService=C,this.requestService=N,this.modalService=F,this.elementRef=V,this.isNew=!1,this.message=null,this.currentDate=new Date,this.isValid=!0,this.isValidChange=new e.vpe,this.readonly=!1,this.isGeometryInlined=!1,this.hierarchy=null,this.filterDate=null,this.showAllInstances=!0,this.viewModels=[],this.isRootOfHierarchy=!1,this.isInitialized=!1}ngOnInit(){this.changeRequestAttributeEditor=this.changeRequestEditor.getEditorForAttribute(this.attributeType,this.hierarchy),this.calculateViewModels(),this.isRootOfHierarchy="_PARENT_"===this.attributeType.type&&(null==this.hierarchy||null==this.hierarchy.types||0===this.hierarchy.types.length),this.isInitialized=!0,this.layerChangeSub=this.geomService.layersChange.subscribe(n=>{this.viewModels&&this.viewModels.forEach(t=>{this.syncLayerReferences(n,t)})}),this.stateSub=this.geomService.stateChange$.subscribe(n=>this.stateChange(n)),this.stateChange(this.geomService.getState())}ngAfterViewInit(){this.isNew&&"exists"===this.attributeType.code&&0===this.viewModels.length&&this.onAddNewVersion()}ngOnChanges(n){this.isInitialized&&n.showAllInstances&&n.showAllInstances.previousValue!==n.showAllInstances.currentValue&&this.calculateViewModels(),n.readonly&&n.readonly.previousValue!==n.readonly.currentValue&&this.viewModels.forEach(t=>{t.destroy(this),null!=t.objectLayer&&(this.geomService.removeLayer(t.objectLayer.getId()),t.objectLayer=null)})}ngOnDestroy(){this.viewModels.forEach(n=>n.destroy(this)),this.layerChangeSub.unsubscribe(),this.stateSub.unsubscribe()}stateChange(n){this.filterDate!==n.date&&(this.filterDate=n.date,this.calculateViewModels())}checkDateFieldValidity(){let n=this.dateFieldComponentsArray.toArray();for(let t=0;t<n.length;t++)if(!n[t].valid)return!1;return!0}hasLocalizationChanged(n,t){return null!=n.editor.oldValue&&this.getValueAtLocale(n.editor.oldValue,t)!==this.getValueAtLocale(n.editor.value,t)}onDateChange(){setTimeout(()=>{this.isValid=this.changeRequestAttributeEditor.validate()&&this.checkDateFieldValidity(),this.isValidChange.emit(this.isValid)},0)}remove(n){if(this.geomService.isEditing()&&this.geomService.stopEditing(),this.changeRequestAttributeEditor.remove(n.editor),n.summaryKey===bs.NEW||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type){const t=this.viewModels.findIndex(o=>o.editor.oid===n.editor.oid);t>-1&&this.viewModels.splice(t,1)}"geometry"===this.attributeType.type&&this.geomService.reload()}onAddNewVersion(n){let t=this.changeRequestAttributeEditor.createNewVersion(n);if(this.isNew&&this.changeRequestEditor.geoObject.attributes.exists){let o=this.changeRequestEditor.geoObject.attributes.exists.values;if(o&&o.length>0){let a=o[0];t.startDate=a.startDate,t.endDate=a.endDate}}this.viewModels.push(new Gy(this,t))}getValueAtLocale(n,t){return null==n?null:new ru(n.localizedValue,n.localeValues).getValue(t)}getGeoObjectTypeTermAttributeOptions(n){return _d.getGeoObjectTypeTermAttributeOptions(this.geoObjectType,n)}calculateViewModels(){let n=[];this.viewModels.forEach(a=>a.destroy(this));let o,t=this.changeRequestAttributeEditor.getEditors(this.showAllInstances);"geometry"===this.attributeType.code&&(o=this.geomService.getLayers()),t.forEach(a=>{if(null==this.filterDate||this.dateService.between(this.filterDate,a.startDate,a.endDate)){let l=new Gy(this,a);n.push(l),"geometry"===this.attributeType.code&&this.syncLayerReferences(o,l)}}),this.viewModels=n}syncLayerReferences(n,t){let o=n.findIndex(N=>N.dataSource instanceof Zs&&N.dataSource.getCode()===this.changeRequestEditor.geoObject.attributes.code&&N.dataSource.getTypeCode()===this.changeRequestEditor.geoObjectType.code&&this.dateService.between(N.dataSource.getDate(),t.editor.startDate,t.editor.endDate));-1!==o?t.objectLayer=n[o]:delete t.objectLayer;let a=new Cc("NEW",t.editor).getKey(),l=n.findIndex(N=>N.dataSource.getKey()===a);-1!==l?t.editingLayer=n[l]:delete t.editingLayer;let _=new Cc("OLD",t.editor).getKey(),C=n.findIndex(N=>N.dataSource.getKey()===_);-1!==C?t.oldLayer=n[C]:delete t.oldLayer}onApprove(){this.requestService.setActionStatus(this.changeRequestAttributeEditor.editAction.oid,Dr.ACCEPTED).then(n=>{this.changeRequestAttributeEditor.editAction.approvalStatus=Dr.ACCEPTED}).catch(n=>{this.error(n)})}onReject(){this.requestService.setActionStatus(this.changeRequestAttributeEditor.editAction.oid,Dr.REJECTED).then(n=>{this.changeRequestAttributeEditor.editAction.approvalStatus=Dr.REJECTED}).catch(n=>{this.error(n)})}onPending(){this.requestService.setActionStatus(this.changeRequestAttributeEditor.editAction.oid,Dr.PENDING).then(n=>{this.changeRequestAttributeEditor.editAction.approvalStatus=Dr.PENDING}).catch(n=>{this.error(n)})}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}getTypeAheadObservable(n,t,o,a,l,_){let C=a.code,N=null,F=null,V=null;if(_>0){const ce=l.parents[n.changeRequestAttributeEditor.hierarchy.types[_-1].code];null!=ce.geoObject&&null!=ce.geoObject.properties.code&&(V=n.changeRequestAttributeEditor.hierarchy.code,N=ce.geoObject.properties.code,F=ce.geoObject.properties.type)}return new Ni.y(ue=>{if(null==N){let ce=_;for(;null==N&&ce>0;){ce-=1;let Te=l.parents[n.changeRequestAttributeEditor.hierarchy.types[ce].code];null!=Te&&(null!=Te.geoObject&&null!=Te.geoObject.properties.code?(N=Te.geoObject.properties.code,V=n.changeRequestAttributeEditor.hierarchy.code,F=n.changeRequestAttributeEditor.hierarchy.types[ce].code):null!=Te.goCode&&(N=Te.goCode,V=n.changeRequestAttributeEditor.hierarchy.code,F=n.changeRequestAttributeEditor.hierarchy.types[ce].code))}}this.service.getGeoObjectSuggestions(l.parents[a.code].text,C,N,F,V,t,o).then(ce=>{ue.next(ce)})})}typeaheadOnSelect(n,t,o,a,l){a.parents[o.code].text=t.item.name+" : "+t.item.code,a.parents[o.code].goCode=t.item.code;let _=[];for(let C=0;C<n.changeRequestAttributeEditor.hierarchy.types.length;C++){let N=n.changeRequestAttributeEditor.hierarchy.types[C];if(_.push(N.code),N.code===o.code)break}this.service.getParentGeoObjects(t.item.code,o.code,_,!0,l).then(C=>{C.parents=C.parents.filter(N=>N.hierarchyType===n.changeRequestAttributeEditor.hierarchy.code),delete a.parents[o.code].goCode,a.parents[o.code].geoObject=C.geoObject,a.parents[o.code].text=C.geoObject.properties.displayLabel.localizedValue+" : "+C.geoObject.properties.code;for(let N=0;N<n.changeRequestAttributeEditor.hierarchy.types.length;N++){let F=n.changeRequestAttributeEditor.hierarchy.types[N],V=C;for(;null!=V&&V.geoObject.properties.type!==F.code;)V=V.parents.length>0?V.parents[0]:null;null!=V&&(a.parents[F.code].geoObject=V.geoObject,a.parents[F.code].text=V.geoObject.properties.displayLabel.localizedValue+" : "+V.geoObject.properties.code)}n instanceof o_&&n.setParentValue(o,a.parents)})}toggleGeometryEditing(n){this.geomService.setEditing(!n.editingLayer.editing,n.editingLayer),("POINT"===this.geoObjectType.geometryType||"MULTIPOINT"===this.geoObjectType.geometryType)&&(n.coordinate={})}toggleGeometryView(n){if(setTimeout(()=>{this.mapRowHeight=this.elementRef.nativeElement.children[0].getElementsByClassName("attribute-element-wrapper")[0].offsetHeight},0),this.readonly&&!this.isGeometryInlined)if(n.objectLayer)this.geomService.removeLayer(n.objectLayer.getId()),delete n.objectLayer;else{let t=this.changeRequestEditor.geoObject,a=this.changeRequestEditor.geoObjectType.label.localizedValue,l=(t.attributes.displayLabel.values&&t.attributes.displayLabel.values.length>0?t.attributes.displayLabel.values[0].value.localizedValue:t.attributes.code)+" "+this.dateService.formatDateForDisplay(n.editor.startDate)+" ("+a+")",_=new Zs(this.service,t.attributes.code,this.changeRequestEditor.geoObjectType.code,n.editor.startDate);n.objectLayer=_.createLayer(l,!0,bl().hexString()),this.geomService.addOrUpdateLayer(n.objectLayer,0)}else if(n.editingLayer)n.editingLayer.editing&&this.geomService.stopEditing(),this.geomService.removeLayer(n.editingLayer.getId()),this.geomService.unregisterDataSource(Gu),delete n.editingLayer;else{let t=this.changeRequestEditor.geoObject,a=this.changeRequestEditor.geoObjectType.label.localizedValue,l=(t.attributes.displayLabel.values&&t.attributes.displayLabel.values.length>0?t.attributes.displayLabel.values[0].value.localizedValue:t.attributes.code)+"* "+this.dateService.formatDateForDisplay(n.editor.startDate)+" ("+a+")",_=new Cc("NEW",n.editor);n.editingLayer=_.createLayer(l,!0,bl().hexString()),this.geomService.registerDataSource(_),this.geomService.addOrUpdateLayer(n.editingLayer,0)}}toggleOldGeometryView(n){if(null!=n.oldLayer)this.geomService.removeLayer(n.oldLayer.getId()),this.geomService.unregisterDataSource("CROLD"),delete n.oldLayer;else{let t=this.changeRequestEditor.geoObject,a=this.changeRequestEditor.geoObjectType.label.localizedValue,l=(t.attributes.displayLabel.values&&t.attributes.displayLabel.values.length>0?t.attributes.displayLabel.values[0].value.localizedValue:t.attributes.code)+" "+this.dateService.formatDateForDisplay(n.editor.startDate)+" ("+a+")",_=new Cc("OLD",n.editor);n.oldLayer=_.createLayer(l,!0,"#A4A4A4"),this.geomService.registerDataSource(_),this.geomService.addOrUpdateLayer(n.oldLayer,1)}}manualCoordinateChange(n){if(n.newCoordinateX||n.newCoordinateY){let a=n.newCoordinateX;n.value.coordinates&&n.value.coordinates[0]&&(a=n.value.coordinates[0]);let l=n.newCoordinateY;return n.value.coordinates&&n.value.coordinates[0]&&(l=n.value.coordinates[1]),n.value.coordinates=[[a||0,l||0]],delete n.newCoordinateX,void delete n.newCoordinateY}if(n.coordinate.latValid=(a=n.value.coordinates[0][1],isFinite(a)&&Math.abs(a)<=90),n.coordinate.longValid=(a=>isFinite(a)&&Math.abs(a)<=180)(n.value.coordinates[0][0]),!n.coordinate.latValid||!n.coordinate.longValid)return this.isValid=!1,void this.isValidChange.emit(this.isValid);var a;this.geomService.setPointCoordinates(n.value.coordinates[0][1],n.value.coordinates[0][0])}}yd.\u0275fac=function(n){return new(n||yd)(e.Y36(vo),e.Y36(e.sBO),e.Y36(Zi),e.Y36(mo.o),e.Y36(e.sBO),e.Y36(zs.R),e.Y36($m.e),e.Y36($l),e.Y36(Ln.tT),e.Y36(e.SBq))},yd.\u0275cmp=e.Xpm({type:yd,selectors:[["manage-versions"]],viewQuery:function(n,t){if(1&n&&e.Gf(ox,5),2&n){let o;e.iGM(o=e.CRH())&&(t.dateFieldComponentsArray=o)}},hostVars:1,hostBindings:function(n,t){2&n&&e.d8E("@fadeInOut",!0)},inputs:{isNew:"isNew",readonly:"readonly",isGeometryInlined:"isGeometryInlined",changeRequestEditor:"changeRequestEditor",geoObjectType:"geoObjectType",attributeType:"attributeType",hierarchy:"hierarchy",showAllInstances:"showAllInstances"},outputs:{isValidChange:"isValidChange"},features:[e._Bn([],[{provide:y.gN,useExisting:y.F}]),e.TTD],decls:9,vars:5,consts:[["customItemTemplate",""],["name","manage-versions-form","autocomplete","off"],[1,"row"],[1,"col",2,"display","inline-block",3,"ngStyle"],["class","attribute-version-wrapper",4,"ngIf"],["style","width:55%;display:inline-block;vertical-align:top;margin-top:15px;",3,"geometryType","mapHeight","readOnly","bboxCode","bboxType",4,"ngIf"],[1,"attribute-version-wrapper"],[1,"list-group"],[1,"list-group-item",2,"text-align","left","padding","0"],[4,"ngIf"],["class","list-group-item","style","text-align: left;",4,"ngIf"],["style","margin-left: 15px;",4,"ngIf"],["style","margin-left:15px;",4,"ngIf"],[1,"table","table-striped"],[1,"attribute-element-wrapper"],["class","message",4,"ngIf"],[1,"message"],["key","changeovertime.manageVersions.no.versions.message"],["key","changeovertime.manageVersions.rootOfHierarchy.message"],["class","version-row",3,"ngClass",4,"ngFor","ngForOf"],[1,"version-row",3,"ngClass"],[1,"version-column-wrapper",3,"ngClass"],["class","version-column-indicator",4,"ngIf"],["class","attribute-value-row",4,"ngIf"],[1,"attribute-date-input-row"],["key","changeovertime.manageVersions.tableHeader.label.startDate"],["label","",3,"customStyles","value","inputName","allowFutureDates","required","disable","title","valueChange","change"],["dateFieldComponents",""],[1,"version-edit-date-container"],["key","changeovertime.manageVersions.tableHeader.label.endDate"],["label","",3,"customStyles","value","inputName","allowInfinity","allowFutureDates","required","placement","oldDate","disable","title","valueChange","change"],["class","manage-version-button clickable",3,"title","click",4,"ngIf"],[1,"version-column-indicator"],["class","attribute-value-row",4,"ngFor","ngForOf"],[1,"attribute-value-row"],["colspan","2"],[3,"key"],["type","text",1,"form-control",3,"ngClass","disabled","name","ngModel","required","ngModelChange"],[1,"form-input-validation-error-message-wrapper"],["class","error-message",4,"ngIf"],[1,"error-message"],["key","manage.versions.value.required.message"],[1,"warning-text","display-current-value",2,"padding","5px 0","margin-bottom","0"],["key","change.request.changed.value.prefix"],["style","padding:0;",4,"ngIf"],[1,"select-area",3,"ngClass","id","name","ngModel","disabled","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"classificationType","rootCode","classNames","name","value","disabled","valueChange"],["type","text","required","",1,"form-control",3,"ngClass","name","ngModel","disabled","ngModelChange"],["label","",3,"customStyles","value","inputName","allowInfinity","allowFutureDates","required","placement","valid","disable","valueChange","validChange"],["type","number","required","",1,"form-control",3,"ngClass","name","ngModel","disabled","ngModelChange"],[1,"radio","radio-inline",2,"padding-left","0"],["type","radio",1,"inline-radio-input",3,"checked","value","ngModel","id","name","disabled","ngModelChange"],[3,"ngClass"],["key","change.request.boolean.option.true"],[1,"radio","radio-inline"],["type","radio",1,"inline-radio-input",3,"ngClass","checked","value","ngModel","id","name","disabled","ngModelChange"],["key","change.request.boolean.option.false"],["style","float:left;width:100%;",4,"ngFor","ngForOf"],[2,"float","left","width","100%"],[1,"input-group"],["type","text","autocomplete","off",1,"form-control",2,"width","100%",3,"name","disabled","ngModel","typeaheadAsync","typeahead","ngClass","typeaheadOptionsLimit","typeaheadItemTemplate","typeaheadMinLength","typeaheadWaitMs","ngModelChange","typeaheadOnSelect","typeaheadLoading"],["class","input-group-addon clickable addon-alert",3,"click",4,"ngIf"],["class","input-group-addon addon-alert",4,"ngIf"],[1,"input-group-addon","clickable","addon-alert",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"input-group-addon","addon-alert"],[1,"warning-text","display-current-value"],["ng-switch","attributeType.type"],["ng-switch-when","'boolean'"],["style","padding-left:3px;",4,"ngIf"],["ng-switch-default",""],[2,"padding-left","3px"],[2,"padding","0"],["colspan","2",2,"padding-left","0"],["class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","button",1,"btn","btn-primary",2,"margin-left","0",3,"disabled","click"],["key","changeovertime.manageVersions.geometry.view",4,"ngIf"],["key","changeovertime.manageVersions.geometry.hide",4,"ngIf"],["class","fa fa-copy clickable",3,"click",4,"ngIf"],["role","button",1,"btn","btn-primary",3,"disabled","click"],["key","changeovertime.manageVersions.geometry.viewOld",4,"ngIf"],["key","changeovertime.manageVersions.geometry.hideOld",4,"ngIf"],["key","changeovertime.manageVersions.geometry.viewOld"],["key","changeovertime.manageVersions.geometry.hideOld"],["key","changeovertime.manageVersions.geometry.view"],["key","changeovertime.manageVersions.geometry.hide"],["key","changeovertime.manageVersions.geometry.edit",4,"ngIf"],["key","changeovertime.manageVersions.geometry.save",4,"ngIf"],["key","changeovertime.manageVersions.geometry.edit"],["key","changeovertime.manageVersions.geometry.save"],[1,"fa","fa-copy","clickable",3,"click"],[2,"width","50%","padding-left","0","padding-right","5px"],["key","geoobject.editor.geometry.latitude.label"],[1,"text-left"],["type","number","class","form-control","required","",3,"readonly","name","ngModel","ngModelChange","change",4,"ngIf"],[2,"width","50%"],["key","geoobject.editor.geometry.longitude.label"],["type","number","required","",1,"form-control",3,"readonly","name","ngModel","ngModelChange","change"],["key","change.request.geometry.invalidLatitude"],["key","change.request.geometry.invalidLongitude"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"manage-version-button","clickable",3,"title","click"],[1,"fa","fa-times"],[1,"fa","fa-undo"],[1,"list-group-item",2,"text-align","left"],[1,"fa","fa-plus","clickable",3,"click"],["key","changeovertime.manageVersions.newVersion"],[2,"margin-left","15px"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","ngClass","title","click"],["key","change.request.accept.btn"],["type","submit","role","button",1,"btn","btn-danger",3,"disabled","ngClass","title","click"],["key","change.request.reject.btn"],["type","submit","role","button",1,"btn","btn-warning",3,"disabled","ngClass","title","click"],["key","change.request.pending.btn"],["style","color:#6BA542;",4,"ngIf"],["style","color:#6d0400;",4,"ngIf"],[2,"color","#6BA542"],["key","change.request.status.accepted"],[2,"color","#6d0400"],["key","change.request.status.rejected"],[2,"width","55%","display","inline-block","vertical-align","top","margin-top","15px",3,"geometryType","mapHeight","readOnly","bboxCode","bboxType"],["geometryEditor",""]],template:function(n,t){1&n&&(e.TgZ(0,"div"),e.YNc(1,rx,2,2,"ng-template",null,0,e.W1O),e.TgZ(3,"form",1)(4,"fieldset")(5,"div",2)(6,"div",3),e.YNc(7,c2,7,4,"div",4),e.qZA(),e.YNc(8,u2,2,5,"geoobject-editor-map",5),e.qZA()()()()),2&n&&(e.xp6(6),e.Q6J("ngStyle",e.VKq(3,p2,t.isGeometryInlined&&t.geomService.getLayers().length>0?"45%":"100%")),e.xp6(1),e.Q6J("ngIf",t.changeRequestEditor.geoObject),e.xp6(1),e.Q6J("ngIf",t.isGeometryInlined&&t.geomService.getLayers().length>0))},dependencies:[T.mk,T.sg,T.O5,T.PC,y._Y,y.YN,y.Kr,y.Fj,y.wV,y.EJ,y._,y.JJ,y.JL,y.Q7,y.On,y.F,A.Bp,Sn.l,al.j,Xl.Q,Dh,Lp,ia.F],styles:["table[_ngcontent-%COMP%]{border-collapse:separate;padding:15px}.geometry-edit-active[_ngcontent-%COMP%]{background-color:#f4fcef!important;border:solid 1px #6BA542!important}.version-column-wrapper.error-border[_ngcontent-%COMP%]{border-color:#e30000;border-style:solid;border-width:2px}.version-column-wrapper.warning-border[_ngcontent-%COMP%]{border-color:orange;border-style:solid;border-width:2px}p.warning-text.display-current-value[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.version-column-wrapper[_ngcontent-%COMP%]{padding-top:0;padding-left:0;border:solid 1px lightgrey}.version-column-wrapper.warning[_ngcontent-%COMP%]{background-color:inherit;border-color:orange;border-left:solid 5px orange}.version-column-wrapper[_ngcontent-%COMP%]   .version-column-indicator[_ngcontent-%COMP%]{position:relative;background:grey;color:#fff;left:-1px;font-size:14px;font-weight:700;padding:0 6px;width:-moz-fit-content;width:fit-content;top:-1px}.version-column-wrapper.warning[_ngcontent-%COMP%]   .version-column-indicator[_ngcontent-%COMP%]{background-color:orange}.manage-version-button[_ngcontent-%COMP%]{border:solid 1px lightgrey}.has-changed[_ngcontent-%COMP%]{color:orange}.version-row[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{padding-left:10px}.version-row[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:5px}.list-group[_ngcontent-%COMP%]{margin-bottom:0}td[disabled=true][_ngcontent-%COMP%]{background:#f8f8f8;cursor:not-allowed}td[disabled=true][_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#d3d3d3;cursor:not-allowed}"],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)("void => *",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")]),(0,Y.eR)(":leave",(0,Y.jt)("500ms",(0,Y.oB)({opacity:0})))])]]}});class $u{constructor(n){this.service=n}checkRanges(n,t){let o=!1;t.forEach(_=>{_.conflictMessages||(_.conflictMessages=new Set),_.conflictMessages.delete(this.service.overlapMessage),_.conflictMessages.delete(this.service.mergeContiguousMessage),_.conflictMessages.delete(this.service.gapMessage),_.conflictMessages.delete(this.service.startDateLaterEndDate)});const a=t.filter(_=>!_.isDelete());for(let _=0;_<a.length;_++){const C=a[_];if(C.startDate&&C.endDate){let N=this.service.getDateFromDateString(C.startDate),F=this.service.getDateFromDateString(C.endDate);ol.dateEndBeforeStart(N,F)&&(C.conflictMessages.add(this.service.startDateLaterEndDate),o=!0);for(let V=0;V<a.length;V++)if(_!==V){const ue=a[V];if(ue.startDate&&ue.endDate){let ce=this.service.getDateFromDateString(ue.startDate),Te=this.service.getDateFromDateString(ue.endDate);ol.dateRangeOverlaps(N.getTime(),F.getTime(),ce.getTime(),Te.getTime())?(C.conflictMessages.add(this.service.overlapMessage),ce.getTime()===Te.getTime()&&ue.conflictMessages.add(this.service.overlapMessage),o=!0):this.service.addDay(1,C.endDate)===ue.startDate&&ol.areValuesEqual(n,C.value,ue.value)&&(C.conflictMessages.add(this.service.mergeContiguousMessage),ue.conflictMessages.add(this.service.mergeContiguousMessage),o=!0)}else(V===_-1||V===_+1)&&F&&ue.startDate&&this.service.getDateFromDateString(ue.startDate).getTime()<=F&&(C.conflictMessages.add(this.service.overlapMessage),ue.conflictMessages.add(this.service.overlapMessage),o=!0)}}}this.sort(a);let l=null;for(let _=0;_<a.length;_++){let C=a[_];if(_>0&&l.endDate&&C.startDate){let N=new Date(l.endDate),F=new Date(C.startDate);ol.hasGap(N.getTime(),F.getTime())&&(C.conflictMessages.add(this.service.gapMessage),l.conflictMessages.add(this.service.gapMessage))}l=C}return this.sort(t),o}sort(n){n.sort(function(t,o){return null==t.startDate||""===t.startDate?1:null==o.startDate||""===o.startDate?-1:new Date(t.startDate)-new Date(o.startDate)})}checkExistRanges(n,t){let o=!1;n.forEach(_=>{_.conflictMessages||(_.conflictMessages=new Set),_.conflictMessages.delete(this.service.outsideExistsMessage)});const a=n.filter(_=>!_.isDelete()),l=t.filter(_=>!_.isDelete());for(let _=0;_<a.length;_++){const C=a[_];if(C.startDate&&C.endDate){let N=this.service.getDateFromDateString(C.startDate),F=this.service.getDateFromDateString(C.endDate),V=!1;for(let ue=0;ue<l.length;ue++){const ce=l[ue];if(ce.value&&ce.startDate&&ce.endDate){let Te=this.service.getDateFromDateString(ce.startDate),We=this.service.getDateFromDateString(ce.endDate);ol.dateRangeOutside(N.getTime(),F.getTime(),Te.getTime(),We.getTime())||(V=!0)}}V||(C.conflictMessages.add(this.service.outsideExistsMessage),o=!0)}}return o}}function d2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.setActiveTimelineEntry(null))}),e._uU(1,"("),e._UZ(2,"localize",16),e._uU(3,")"),e.qZA()}}function h2(i,n){1&i&&(e.TgZ(0,"div",17),e._UZ(1,"localize",18),e.qZA()),2&i&&e.Q6J("@fadeInOut",void 0)}function f2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.setActiveTimelineEntry(a.forDateEntry))}),e._uU(1,"("),e._UZ(2,"localize",19),e._uU(3,")"),e.qZA()}}function g2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.setActiveTimelineEntry(a.forDateEntry))}),e._uU(1,"("),e._UZ(2,"localize",20),e._uU(3,")"),e.qZA()}}function _2(i,n){1&i&&(e.TgZ(0,"span",21),e._uU(1," ("),e._UZ(2,"localize",22),e._uU(3,") "),e.qZA())}function m2(i,n){if(1&i&&(e.ynx(0),e._uU(1),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE(" ",t.activeEntry.period.startDate," - ",t.dateService.formatDateForDisplay(t.activeEntry.period.endDate)," ")}}function y2(i,n){if(1&i&&(e.ynx(0),e._uU(1),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE(" ",t.dataTimeSpan.displayStartDate," - ",t.dataTimeSpan.displayEndDate," ")}}$u.\u0275fac=function(n){return new(n||$u)(e.LFG(nn.Ru))},$u.\u0275prov=e.Yz7({token:$u,factory:$u.\u0275fac});const v2=function(i,n){return{"active-timeline-entry":i,"not-clickable":n}},b2=function(i,n){return{width:i,left:n}};function x2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",25),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.setActiveTimelineEntry(l))}),e.qZA()}if(2&i){const t=n.$implicit,o=e.oxw(3);e.Q6J("ngClass",e.WLB(2,v2,null==o.activeEntry||null!=o.activeEntry&&t.period.startDate===o.activeEntry.period.startDate,o.periods.length<=1))("ngStyle",e.WLB(5,b2,t.width+"%",t.x+"%"))}}function C2(i,n){if(1&i&&(e.TgZ(0,"div",23),e.YNc(1,x2,1,8,"a",24),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function w2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"span",2),e._UZ(2,"localize",3),e.TgZ(3,"span"),e.YNc(4,d2,4,0,"a",4),e.YNc(5,h2,2,1,"div",5),e.YNc(6,f2,4,0,"a",4),e.YNc(7,g2,4,0,"a",4),e.YNc(8,_2,4,0,"span",6),e.qZA()(),e.TgZ(9,"span",7),e.YNc(10,m2,2,2,"ng-container",8),e.YNc(11,y2,2,2,"ng-container",8),e.qZA(),e.TgZ(12,"div",9),e.YNc(13,C2,2,1,"div",10),e.TgZ(14,"div",11)(15,"a",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.navigateRelative(-1))}),e._UZ(16,"i",13),e.qZA(),e.TgZ(17,"a",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.navigateRelative(1))}),e._UZ(18,"i",14),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.activeEntry),e.xp6(1),e.Q6J("ngIf",t._showHint),e.xp6(1),e.Q6J("ngIf",!t.activeEntry&&t.forDate&&"LIST"===t.context),e.xp6(1),e.Q6J("ngIf",!t.activeEntry&&t.forDate&&"EXPLORER"===t.context),e.xp6(1),e.Q6J("ngIf",!t.activeEntry&&!t.forDate),e.xp6(2),e.Q6J("ngIf",t.activeEntry),e.xp6(1),e.Q6J("ngIf",!t.activeEntry),e.xp6(2),e.Q6J("ngForOf",t.timelines)}}class Fh{constructor(n,t,o){this.dateService=n,this.votService=t,this.geomService=o,this.latestPeriodIsActive=!1,this.periods=[],this.activeEntry=null,this.forDateEntry=null,this.infinityDayPadding=15,this.dataTimeSpan=null,this._showHint=!1}set showHint(n){this._showHint=n,setTimeout(()=>{this.showHint=!1},1e4)}ngOnInit(){this.generate(),this.changeRequestEditor.onChangeSubject.subscribe(n=>{(n===Fo.END_DATE||n===Fo.START_DATE)&&this.generate()}),this.subscription=this.geomService.stateChange$.subscribe(n=>this.handleStateChange(n)),this.calculateActiveTimelineEntry()}ngOnDestroy(){this.subscription.unsubscribe()}handleStateChange(n){this.forDate!==n.date&&(this.forDate=n.date,this.calculateActiveTimelineEntry())}calculateActiveTimelineEntry(){if(null!=this.timelines){let n=this.timelines[0];if(n&&n.length>1){if(null!=this.forDate){let t=n.findIndex(o=>this.dateService.between(this.forDate,o.period.startDate,o.period.endDate));-1!==t&&(this.activeEntry=n[t])}else this.latestPeriodIsActive&&this.setActiveTimelineEntry(n[n.length-1]);if(null!=this.forDate){let t=n.findIndex(o=>this.dateService.between(this.forDate,o.period.startDate,o.period.endDate));-1!==t&&(this.forDateEntry=n[t])}}}}navigateRelative(n){let t=this.timelines[0];if(null==t||0===t.length)return;if(null==this.activeEntry)return void this.setActiveTimelineEntry(t[0]);let o=t.findIndex(a=>a.period.startDate===this.activeEntry.period.startDate);if(-1!==o){let a=o+n;a<0?a=t.length-1:a>=t.length&&(a=0),this.setActiveTimelineEntry(t[a])}}setActiveTimelineEntry(n){this.periods.length<=1&&(n=null),this.activeEntry&&n&&n.period.startDate===this.activeEntry.period.startDate&&(n=null),this.activeEntry=n,this.geomService.setState({date:null==n?null:n.period.startDate},!1)}generate(){this.generatePeriods(),this.generateTimelines()}calculateDataTimeSpan(){let n=null,t=null,o=null,a=null;this.periods.length>0&&(n=this.periods[0].startDate,t=this.periods[this.periods.length-1].endDate,a=this.dateService.getDateFromDateString(n).getTime()/864e5,"5000-12-31"===t?this.periods.length>1?(o=this.dateService.getDateFromDateString(this.periods[this.periods.length-1].startDate).getTime()/864e5,this.infinityDayPadding=.05*(o-a),o=this.infinityDayPadding+o):o=a+this.infinityDayPadding:o=this.dateService.getDateFromDateString(t).getTime()/864e5),this.dataTimeSpan={startDay:a,startDate:n,displayStartDate:this.dateService.formatDateForDisplay(n),endDay:o,endDate:t,displayEndDate:this.dateService.formatDateForDisplay(t),span:o-a}}generateTimelines(){if(this.timelines=[],0===this.periods.length)return;1===this.periods.length&&this.setActiveTimelineEntry(null),this.calculateDataTimeSpan();let n=[];this.timelines.push(n);let t=this.periods.length;for(let o=0;o<t;++o){let a=this.periods[o],l=this.dateService.getDateFromDateString(a.startDate),_=this.dateService.getDateFromDateString(a.endDate),C=l.getTime()/864e5,N=_.getTime()/864e5;"5000-12-31"===a.endDate&&(N=C+this.infinityDayPadding),n.push({width:(N-C)/this.dataTimeSpan.span*100,x:(C-this.dataTimeSpan.startDay)/this.dataTimeSpan.span*100,period:a})}}generatePeriods(){let n=[],t=this.changeRequestEditor.getEditors(),o=t.length;for(let l=0;l<o;++l)if(t[l]instanceof r_){let C=t[l].getEditors(),N=C.length;for(let F=0;F<N;++F){let V=C[F];if(null!=V.startDate&&null!=V.endDate&&!V.isDelete()){let ue=n.findIndex(Te=>V.startDate===Te.date);-1!==ue?n[ue].isStart=!0:n.push({date:V.startDate,isStart:!0,isEnd:!1});let ce=n.findIndex(Te=>V.endDate===Te.date);-1!==ce?n[ce].isEnd=!0:n.push({date:V.endDate,isStart:!1,isEnd:!0})}}}n.sort(function(l,_){return null==l.date||""===l.date?1:null==_.date||""===_.date?-1:new Date(l.date)-new Date(_.date)}),this.periods=[];let a=n.length;for(let l=0;l<a;++l){let _=n[l],C=l+1>a?null:n[l+1];if(_.isStart&&_.isEnd&&this.periods.push({startDate:_.date,endDate:_.date}),_.isEnd&&null!=C&&C.isStart&&this.dateService.addDay(1,_.date)===C.date)continue;let N=_.isEnd?this.dateService.addDay(1,_.date):_.date;if(null!=C&&this.changeRequestEditor.existsAtDate(N)){let F=C.isStart?this.dateService.addDay(-1,C.date):C.date;this.periods.push({startDate:N,endDate:F})}}this.votService.sort(this.periods)}formatDate(n){return this.dateService.formatDateForDisplay(n)}}function T2(i,n){if(1&i&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.view.summaryKeyLocalized," ")}}Fh.\u0275fac=function(n){return new(n||Fh)(e.Y36(zs.R),e.Y36($u),e.Y36(vo))},Fh.\u0275cmp=e.Xpm({type:Fh,selectors:[["stability-period"]],inputs:{changeRequestEditor:"changeRequestEditor",context:"context",latestPeriodIsActive:"latestPeriodIsActive",showHint:"showHint"},decls:1,vars:1,consts:[["style","margin-bottom:10px;",4,"ngIf"],[2,"margin-bottom","10px"],[2,"margin-left","20px"],["key","manage.versions.historyTitle"],["class","view-all",3,"click",4,"ngIf"],["id","time-hint",4,"ngIf"],["class","view-all",4,"ngIf"],[2,"float","right","color","#6ba542","margin-right","20px"],[4,"ngIf"],[2,"padding","0 20px"],["class","timeline",4,"ngFor","ngForOf"],[1,"timeline-nav-btn-wrapper"],[3,"click"],[1,"fa","fa-chevron-left"],[1,"fa","fa-chevron-right"],[1,"view-all",3,"click"],["key","manage.versions.history.viewAll"],["id","time-hint"],["key","changeovertime.manageVersions.time.hint.message"],["key","manage.versions.history.viewListPeriod"],["key","manage.versions.history.viewExplorerPeriod"],[1,"view-all"],["key","manage.versions.history.viewingAll"],[1,"timeline"],["class","timeline-entry",3,"ngClass","ngStyle","click",4,"ngFor","ngForOf"],[1,"timeline-entry",3,"ngClass","ngStyle","click"]],template:function(n,t){1&n&&e.YNc(0,w2,19,8,"div",0),2&n&&e.Q6J("ngIf",t.dataTimeSpan)},dependencies:[T.mk,T.sg,T.O5,T.PC,Sn.l],styles:['.timeline[_ngcontent-%COMP%]{height:50px;width:100%;position:relative;display:inline-block;z-index:99}.timeline[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:first-child{border-top-left-radius:4px;border-bottom-left-radius:4px}.timeline[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:last-child{border-top-right-radius:4px;border-bottom-right-radius:4px}.timeline-entry[_ngcontent-%COMP%]{height:50px;border:1px solid lightgrey;position:absolute;display:inline-block}.timeline-entry.not-clickable[_ngcontent-%COMP%]{cursor:default}.active-timeline-entry[_ngcontent-%COMP%]{background-color:#edf4e8;border-color:#6ba542}.timeline-nav-btn-wrapper[_ngcontent-%COMP%]{top:36px;width:100%;position:absolute;height:20px;right:0;left:0;padding:0 15px;z-index:0}.timeline-nav-btn-wrapper[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:last-child{float:right}.navigation-controls[_ngcontent-%COMP%]{width:100%;text-align:center}.navigation-controls[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.view-all[_ngcontent-%COMP%]{margin-left:5px}#time-hint[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;background:lightgrey;padding:5px;margin-left:70px;position:absolute;margin-top:9px;z-index:999;border-radius:3px}#time-hint[_ngcontent-%COMP%]:before{content:"";display:block;position:absolute;left:15px;top:-10px;border-bottom:10px solid lightgrey;border-left:10px solid transparent;border-right:10px solid transparent}'],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("1000ms")]),(0,Y.eR)(":leave",(0,Y.jt)("1000ms",(0,Y.oB)({opacity:0})))])]]}});const Vy=function(i){return{"has-changed":i}};function M2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div")(2,"label",8)(3,"input",9),e.NdJ("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onValueChange())})("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.changeRequestAttributeEditor.value=a)}),e.qZA(),e.TgZ(4,"span",10),e._UZ(5,"localize",11),e.qZA()(),e.TgZ(6,"label",12)(7,"input",9),e.NdJ("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onValueChange())})("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.changeRequestAttributeEditor.value=a)}),e.qZA(),e.TgZ(8,"span",10),e._UZ(9,"localize",11),e.qZA()()()()}if(2&i){const t=e.oxw(2);e.xp6(3),e.MGl("id","mod-",t.geoObjectType.code,"-true")("name","mod-",t.geoObjectType.code,"-true"),e.Q6J("checked","invalid"===t.view.attributeCode?!1===t.view.value:!0===t.view.value)("value","invalid"!==t.view.attributeCode)("ngModel",t.changeRequestAttributeEditor.value)("disabled",t.readonly),e.xp6(1),e.Q6J("ngClass",e.VKq(16,Vy,t.view.oldValue&&!t.isNew)),e.xp6(1),e.Q6J("key","invalid"===t.view.attributeCode?"change.request.boolean.option.valid":"change.request.boolean.option.true"),e.xp6(2),e.MGl("id","mod-",t.geoObjectType.code,"-false")("name","mod-",t.geoObjectType.code,"-false"),e.Q6J("checked","invalid"===t.view.attributeCode?!0===t.changeRequestAttributeEditor.value:!1===t.changeRequestAttributeEditor.value)("value","invalid"===t.view.attributeCode)("ngModel",t.changeRequestAttributeEditor.value)("disabled",t.readonly),e.xp6(1),e.Q6J("ngClass",e.VKq(18,Vy,t.view.oldValue&&!t.isNew)),e.xp6(1),e.Q6J("key","invalid"===t.view.attributeCode?"change.request.boolean.option.invalid":"change.request.boolean.option.false")}}function O2(i,n){if(1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",11),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("key","invalid"===t.view.attributeCode?"change.request.boolean.option.valid":"change.request.boolean.option.true")}}function S2(i,n){if(1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",11),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("key","invalid"===t.view.attributeCode?"change.request.boolean.option.invalid":"change.request.boolean.option.false")}}function P2(i,n){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,O2,2,1,"span",6),e.YNc(2,S2,2,1,"span",6),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf","invalid"===t.view.attributeCode?!1===t.view.oldValue:!0===t.view.oldValue),e.xp6(1),e.Q6J("ngIf","invalid"===t.view.attributeCode?!0===t.view.oldValue:!1===t.view.oldValue)}}function E2(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.view.oldValue," ")}}function A2(i,n){if(1&i&&(e.TgZ(0,"div")(1,"p",13),e._UZ(2,"localize",14),e._uU(3,"\xa0 "),e.YNc(4,P2,3,2,"span",6),e.YNc(5,E2,2,1,"span",6),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf","boolean"===t.attributeType.type),e.xp6(1),e.Q6J("ngIf","boolean"!==t.attributeType.type)}}const k2=function(i){return{warning:i}};function I2(i,n){if(1&i&&(e.TgZ(0,"div",3),e.YNc(1,T2,2,1,"div",4),e.TgZ(2,"div",5),e.YNc(3,M2,10,20,"div",6),e.YNc(4,A2,6,2,"div",6),e.qZA()()),2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(4,k2,t.view.summaryKey&&"UNMODIFIED"!==t.view.summaryKey)),e.xp6(1),e.Q6J("ngIf",t.view.summaryKey&&"UNMODIFIED"!==t.view.summaryKey),e.xp6(2),e.Q6J("ngIf","boolean"===t.attributeType.type),e.xp6(1),e.Q6J("ngIf",null!=t.view.oldValue&&!t.isNew)}}function Z2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onApprove())}),e.ALo(2,"localize"),e._UZ(3,"localize",17),e.qZA(),e.TgZ(4,"button",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onReject())}),e.ALo(5,"localize"),e._UZ(6,"localize",19),e.qZA(),e.TgZ(7,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onPending())}),e.ALo(8,"localize"),e._UZ(9,"localize",21),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled","ACCEPTED"===t.changeRequestAttributeEditor.editAction.approvalStatus)("title",e.lcZ(2,6,"change.request.action.accept.btn.hover")),e.xp6(3),e.Q6J("disabled","REJECTED"===t.changeRequestAttributeEditor.editAction.approvalStatus)("title",e.lcZ(5,8,"change.request.action.reject.btn.hover")),e.xp6(3),e.Q6J("disabled","PENDING"===t.changeRequestAttributeEditor.editAction.approvalStatus)("title",e.lcZ(8,10,"change.request.action.pending.btn.hover"))}}function N2(i,n){1&i&&(e.TgZ(0,"strong",24),e._UZ(1,"localize",25),e.qZA())}function L2(i,n){1&i&&(e.TgZ(0,"strong",26),e._UZ(1,"localize",27),e.qZA())}function z2(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,N2,2,0,"strong",22),e.YNc(2,L2,2,0,"strong",23),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","ACCEPTED"===t.changeRequestAttributeEditor.editAction.approvalStatus),e.xp6(1),e.Q6J("ngIf","REJECTED"===t.changeRequestAttributeEditor.editAction.approvalStatus)}}function D2(i,n){if(1&i&&(e.TgZ(0,"div",15),e.YNc(1,Z2,10,12,"div",6),e.YNc(2,z2,3,2,"div",6),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","PENDING"===t.changeRequest.approvalStatus&&t.changeRequest.permissions.includes("WRITE_APPROVAL_STATUS")&&t.changeRequestAttributeEditor.editAction&&t.changeRequestAttributeEditor.diff),e.xp6(1),e.Q6J("ngIf","PENDING"!==t.changeRequest.approvalStatus)}}class Uh{constructor(n,t,o,a,l,_,C,N,F){this.cdr=n,this.service=t,this.lService=o,this.changeDetectorRef=a,this.dateService=l,this.authService=_,this.requestService=C,this.modalService=N,this.elementRef=F,this.isNew=!1,this.message=null,this.isValid=!0,this.isValidChange=new e.vpe,this.readonly=!1,this.isNewGeoObject=!1}ngOnInit(){this.changeRequestAttributeEditor=this.changeRequestEditor.getEditorForAttribute(this.attributeType,null),this.calculateView()}ngAfterViewInit(){}calculateView(){let n=this.changeRequestAttributeEditor.diff;if(null!=n){let t=null==n.newValue?null:JSON.parse(JSON.stringify(n.newValue));this.view={value:t,summaryKey:bs.VALUE_CHANGE,summaryKeyLocalized:this.lService.decode("changeovertime.manageVersions.summaryKey."+bs.VALUE_CHANGE),attributeCode:this.changeRequestAttributeEditor.attribute.code},null!=n.oldValue&&(this.view.oldValue=JSON.parse(JSON.stringify(n.oldValue)))}else this.view={value:this.changeRequestAttributeEditor.value,summaryKey:bs.UNMODIFIED,summaryKeyLocalized:this.lService.decode("changeovertime.manageVersions.summaryKey."+bs.UNMODIFIED),attributeCode:this.changeRequestAttributeEditor.attribute.code}}onValueChange(){this.calculateView()}onApprove(){let n=this.changeRequestAttributeEditor.editAction;this.requestService.setActionStatus(n.oid,Dr.ACCEPTED).then(t=>{n.approvalStatus=Dr.ACCEPTED}).catch(t=>{this.error(t)})}onReject(){let n=this.changeRequestAttributeEditor.editAction;this.requestService.setActionStatus(n.oid,Dr.REJECTED).then(t=>{n.approvalStatus=Dr.REJECTED}).catch(t=>{this.error(t)})}onPending(){let n=this.changeRequestAttributeEditor.editAction;this.requestService.setActionStatus(n.oid,Dr.PENDING).then(t=>{n.approvalStatus=Dr.PENDING}).catch(t=>{this.error(t)})}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}Uh.\u0275fac=function(n){return new(n||Uh)(e.Y36(e.sBO),e.Y36(Zi),e.Y36(mo.o),e.Y36(e.sBO),e.Y36(zs.R),e.Y36($m.e),e.Y36($l),e.Y36(Ln.tT),e.Y36(e.SBq))},Uh.\u0275cmp=e.Xpm({type:Uh,selectors:[["standard-attribute-editor"]],hostVars:1,hostBindings:function(n,t){2&n&&e.d8E("@fadeInOut",!0)},inputs:{isNew:"isNew",readonly:"readonly",attributeType:"attributeType",changeRequest:"changeRequest",geoObjectType:"geoObjectType",geoObject:"geoObject",isNewGeoObject:"isNewGeoObject",changeRequestEditor:"changeRequestEditor"},outputs:{isValidChange:"isValidChange"},features:[e._Bn([],[{provide:y.gN,useExisting:y.F}])],decls:4,vars:3,consts:[[1,"value-box"],["class","value-box-wrapper",3,"ngClass",4,"ngIf"],["class","cr-maintainer-options",4,"ngIf"],[1,"value-box-wrapper",3,"ngClass"],["class","value-box-indicator",4,"ngIf"],[1,"inner-value"],[4,"ngIf"],[1,"value-box-indicator"],[1,"radio","radio-inline",2,"padding-left","0"],["type","radio",1,"inline-radio-input",3,"checked","value","ngModel","id","name","disabled","change","ngModelChange"],[3,"ngClass"],[3,"key"],[1,"radio","radio-inline"],[1,"warning-text","display-current-value",2,"color","var(--theme-text-dark)"],["key","change.request.changed.value.prefix"],[1,"cr-maintainer-options"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","title","click"],["key","change.request.accept.btn"],["type","submit","role","button",1,"btn","btn-danger",3,"disabled","title","click"],["key","change.request.reject.btn"],["type","submit","role","button",1,"btn","btn-warning",3,"disabled","title","click"],["key","change.request.pending.btn"],["style","color:#6BA542;",4,"ngIf"],["style","color:#6d0400;",4,"ngIf"],[2,"color","#6BA542"],["key","change.request.status.accepted"],[2,"color","#6d0400"],["key","change.request.status.rejected"]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"div",0),e.YNc(2,I2,5,6,"div",1),e.qZA(),e.YNc(3,D2,3,2,"div",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("@fadeInOut",void 0),e.xp6(1),e.Q6J("ngIf",t.view),e.xp6(1),e.Q6J("ngIf",t.changeRequest&&!t.changeRequest.isNew))},dependencies:[T.mk,T.O5,y.Fj,y._,y.JJ,y.On,Sn.l,ia.F],styles:[".cr-maintainer-options[_ngcontent-%COMP%]{padding-top:15px}p.warning-text.display-current-value[_ngcontent-%COMP%]{font-size:12px;font-weight:700}.value-box-wrapper[_ngcontent-%COMP%]{padding-top:0;padding-left:0;border:solid 1px lightgrey}.value-box-wrapper.warning[_ngcontent-%COMP%]{background-color:inherit;border-color:orange;border-left:solid 5px orange}.value-box[_ngcontent-%COMP%]{background-color:#f9f9f9;margin-top:10px}.value-box[_ngcontent-%COMP%]   .inner-value[_ngcontent-%COMP%]{padding-left:10px}.value-box-wrapper[_ngcontent-%COMP%]   .value-box-indicator[_ngcontent-%COMP%]{position:relative;background:grey;color:#fff;left:-1px;font-size:14px;font-weight:700;padding:0 6px;width:-moz-fit-content;width:fit-content;top:-1px}.value-box-wrapper.warning[_ngcontent-%COMP%]   .value-box-indicator[_ngcontent-%COMP%]{background-color:orange}.value-box-wrapper[_ngcontent-%COMP%]   .manage-version-button[_ngcontent-%COMP%]{border:solid 1px lightgrey}.value-box-wrapper.warning[_ngcontent-%COMP%]   .manage-version-button[_ngcontent-%COMP%]{border-color:orange}.has-changed[_ngcontent-%COMP%]{color:orange}"],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)("void => *",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")]),(0,Y.eR)(":leave",(0,Y.jt)("500ms",(0,Y.oB)({opacity:0})))])]]}});class qh{transform(n,t){return n&&t?n.filter(o=>-1===t.indexOf(o.code)):n}}qh.\u0275fac=function(n){return new(n||qh)},qh.\u0275pipe=e.Yjl({name:"geoObjectAttributeExcludesFilter",type:qh,pure:!0});const R2=["attributeForm"];function F2(i,n){if(1&i&&e._UZ(0,"stability-period",19),2&i){const t=e.oxw();e.Q6J("showHint",!t.readOnly)("changeRequestEditor",t.changeRequestEditor)("context",null==t.datasetId?"EXPLORER":"LIST")("latestPeriodIsActive",null==t.requestedDate&&t.changeRequestEditor.changeRequest.isNew)}}function U2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"boolean-field",20),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.showAllInstances=a)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("value",t.showAllInstances)("disable",!1)}}function q2(i,n){1&i&&e._UZ(0,"span",21)}function J2(i,n){1&i&&e._UZ(0,"span",22)}function j2(i,n){1&i&&e._UZ(0,"span",21)}function B2(i,n){1&i&&e._UZ(0,"span",22)}function G2(i,n){1&i&&e._UZ(0,"span",21)}function V2(i,n){1&i&&e._UZ(0,"span",22)}function Y2(i,n){1&i&&e._UZ(0,"span",21)}function H2(i,n){1&i&&e._UZ(0,"span",22)}function Q2(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",33),e.qZA())}function K2(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",34),e.qZA())}function $2(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.label.localizedValue," ")}}function W2(i,n){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"manage-versions",35),e.qZA()),2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("geoObjectType",o.geoObjectType)("changeRequestEditor",o.changeRequestEditor)("attributeType",t)("readonly",o.readOnly)("isNew",o.isNew)("showAllInstances",o.showAllInstances)}}function X2(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",37),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(3).$implicit,_=e.oxw(3);return e.KtG(_.changeRequestEditor.getEditorForAttribute(l).value=a)}),e.qZA()}if(2&i){const t=e.oxw(3).$implicit,o=e.oxw(3);e.Akn(o.readOnly||"code"===t.code&&!o.isNew?"":"color:#333"),e.MGl("id","mod-",t.code,"")("name","mod-",t.code,""),e.Q6J("ngModel",o.changeRequestEditor.getEditorForAttribute(t).value)("disabled","code"===t.code&&!o.canEditCode()||"code"!==t.code&&o.readOnly)("required",!(o.isNew&&!o.isMaintainer))}}function eC(i,n){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"standard-attribute-editor",38),e.qZA()),2&i){const t=e.oxw(3).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("changeRequestEditor",o.changeRequestEditor)("geoObjectType",o.geoObjectType)("changeRequest",o.changeRequest)("attributeType",t)("geoObject",o.changeRequestEditor.geoObject)("readonly",o.readOnly)("isNew",o.isNew)}}function tC(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,X2,1,7,"input",36),e.YNc(2,eC,2,7,"div",18),e.qZA()),2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",o.changeRequestEditor.geoObject&&"code"===t.code),e.xp6(1),e.Q6J("ngIf","code"!==t.code)}}function nC(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h4",31),e.YNc(3,Q2,2,0,"span",18),e.YNc(4,K2,2,0,"span",18),e.YNc(5,$2,2,1,"span",18),e.qZA()(),e.TgZ(6,"div",32),e.YNc(7,W2,2,6,"div",18),e.YNc(8,tC,3,2,"div",18),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf","code"===t.code),e.xp6(1),e.Q6J("ngIf","displayLabel"===t.code),e.xp6(1),e.Q6J("ngIf","code"!==t.code&&"displayLabel"!==t.code),e.xp6(2),e.Q6J("ngIf","code"!==t.code&&t.isChangeOverTime),e.xp6(1),e.Q6J("ngIf",!t.isChangeOverTime)}}function iC(i,n){if(1&i&&(e.TgZ(0,"li",27),e.YNc(1,nC,9,5,"div",28),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",o.showAllInstances||o.changeRequestEditor.getEditorForAttribute(t).hasChanges())}}function oC(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"span",24),e.TgZ(3,"ul",25),e.YNc(4,iC,2,1,"li",26),e.ALo(5,"geoObjectAttributeExcludesFilter"),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",e.xi3(5,1,t.geoObjectType.attributes,t.geoObjectAttributeExcludes))}}function rC(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h4",31)(3,"span"),e._uU(4),e.qZA()()(),e.TgZ(5,"div",32),e._UZ(6,"manage-versions",39),e.qZA()()),2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(4),e.hij(" ",t.label," "),e.xp6(2),e.Q6J("geoObjectType",o.geoObjectType)("changeRequestEditor",o.changeRequestEditor)("attributeType",o.parentAttributeType)("readonly",o.readOnly)("isNew",o.isNew)("hierarchy",t)("showAllInstances",o.showAllInstances)}}function aC(i,n){if(1&i&&(e.TgZ(0,"li",27),e.YNc(1,rC,7,8,"div",28),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",o.showAllInstances||o.changeRequestEditor.getEditorForAttribute(o.parentAttributeType,t).hasChanges())}}function sC(i,n){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ul",25),e.YNc(3,aC,2,1,"li",26),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.hierarchies)}}function lC(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h4",31)(3,"span"),e._UZ(4,"localize",40),e.qZA()()(),e.TgZ(5,"div",32),e._UZ(6,"manage-versions",41),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(6),e.Q6J("geoObjectType",t.geoObjectType)("changeRequestEditor",t.changeRequestEditor)("attributeType",t.geometryAttributeType)("readonly",t.readOnly)("isNew",t.isNew)("isGeometryInlined",t.isGeometryInlined)("showAllInstances",t.showAllInstances)}}function cC(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,lC,7,7,"div",28),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.showAllInstances||t.changeRequestEditor.getEditorForAttribute(t.geometryAttributeType).hasChanges())}}function uC(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h4",31)(3,"span"),e._uU(4),e.qZA()()(),e.TgZ(5,"div",32),e._UZ(6,"manage-versions",41),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(4),e.Oqu(t.getAttribute("exists").label.localizedValue),e.xp6(2),e.Q6J("geoObjectType",t.geoObjectType)("changeRequestEditor",t.changeRequestEditor)("attributeType",t.getAttribute("exists"))("readonly",t.readOnly)("isNew",t.isNew)("isGeometryInlined",t.isGeometryInlined)("showAllInstances",t.showAllInstances)}}function pC(i,n){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30)(2,"h4",31),e._UZ(3,"localize",42),e.qZA()(),e.TgZ(4,"div",32),e._UZ(5,"standard-attribute-editor",38),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(5),e.Q6J("changeRequestEditor",t.changeRequestEditor)("geoObjectType",t.geoObjectType)("changeRequest",t.changeRequest)("attributeType",t.getAttribute("invalid"))("geoObject",t.changeRequestEditor.geoObject)("readonly",t.readOnly)("isNew",t.isNew)}}function dC(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,uC,7,8,"div",28),e.YNc(2,pC,6,7,"div",28),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.showAllInstances||t.changeRequestEditor.getEditorForAttribute(t.getAttribute("exists")).hasChanges()),e.xp6(1),e.Q6J("ngIf",t.showAllInstances||t.changeRequestEditor.getEditorForAttribute(t.getAttribute("invalid")).hasChanges())}}function hC(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,oC,6,4,"div",23),e.YNc(2,sC,4,1,"div",23),e.YNc(3,cC,2,1,"div",18),e.YNc(4,dC,3,2,"div",18),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0===t.tabIndex),e.xp6(1),e.Q6J("ngIf",1===t.tabIndex),e.xp6(1),e.Q6J("ngIf",2===t.tabIndex),e.xp6(1),e.Q6J("ngIf",3===t.tabIndex)}}const ey=function(i,n){return{active:i,disabled:n}},fC=function(i){return{active:i}};class Dp{constructor(n,t,o,a,l,_){this.lService=n,this.geomService=t,this.authService=o,this.dateService=a,this.registryService=l,this.votService=_,this.postGeoObject=null,this.showAllInstances=!1,this.tabIndex=0,this.attributeExcludes=[],this.readOnly=!1,this.isNew=!1,this.isGeometryInlined=!1,this.modifiedTermOption=null,this.currentTermOption=null,this.requestedDate=null,this.forDate=null,this.datasetId=null,this.geoObjectAttributeExcludes=["uid","sequence","type","lastUpdateDate","createDate","invalid","exists"],this.showStabilityPeriods=!1}ngOnInit(){this.subscription=this.geomService.stateChange$.subscribe(o=>this.handleStateChange(o)),null!=this.attributeExcludes&&(this.geoObjectAttributeExcludes.push.apply(this.geoObjectAttributeExcludes,this.attributeExcludes),this.isGeometryInlined||this.geoObjectAttributeExcludes.push("geometry")),this.geometryAttributeType=this.getAttribute("geometry"),null==this.geometryAttributeType&&(this.geometryAttributeType={code:"geometry",type:"geometry",label:new ru("Geometry",null),description:new ru("Geometry",null),isDefault:!0,required:!1,unique:!1,isChangeOverTime:!0}),this.parentAttributeType={code:"_PARENT_",type:"_PARENT_",label:new ru("Parents",null),description:new ru("Parents",null),isDefault:!0,required:!1,unique:!1,isChangeOverTime:!0},null==this.changeRequest?this.changeRequest=this.createNewChangeRequest():(this.changeRequest.actions||(this.changeRequest.actions=[]),0===this.changeRequest.actions.length&&this.isNew&&(this.changeRequest.actions=this.createNewChangeRequest().actions)),this.changeRequestEditor=new $0(this.changeRequest,this.postGeoObject,this.geoObjectType,this.hierarchies,this.geometryAttributeType,this.parentAttributeType,this.lService,this.dateService,this.registryService,this.geomService,this.votService),this.shouldForceSetExist()&&this.changePage(3),this.isNew&&(this.forDate=null);let n=this.changeRequest.current?this.changeRequest.current.geoObjectType:this.postGeoObject.geoObjectType,t=n.organizationCode;this.changeRequest.isNew&&(this.showStabilityPeriods=this.authService.isSRA()||this.authService.isOrganizationRA(t)||this.authService.isGeoObjectTypeOrSuperRM(n)||this.authService.isGeoObjectTypeOrSuperRC(n)),this.showAllInstances=this.changeRequestEditor.changeRequest.isNew||"CreateGeoObject"===this.changeRequestEditor.changeRequest.type,this.isMaintainer=this.authService.isSRA()||this.authService.isOrganizationRA(n.organizationCode)||this.authService.isGeoObjectTypeOrSuperRM(n)}ngOnDestroy(){this.subscription.unsubscribe()}handleStateChange(n){this.forDate=n.date}getChangeRequestEditor(){return this.changeRequestEditor}canEditCode(){return this.changeRequest&&this.changeRequest.permissions&&this.changeRequest.permissions.includes("WRITE_CODE")?this.isMaintainer||!this.readOnly:!(this.readOnly||!this.isNew)}createNewChangeRequest(){let n=new Km;if(n.oid=G(),n.approvalStatus="PENDING",n.actions=[],this.isNew){n.type="CreateGeoObject";let t=new Y0;t.geoObjectJson=this.postGeoObject,t.parentJson=this.hierarchies,n.actions[0]=t}else n.type="UpdateGeoObject";return n}shouldForceSetExist(){if(!this.readOnly){if(!this.isNew){let n=this.changeRequestEditor.changeRequest.isNew;if(n&&!this.readOnly&&this.postGeoObject.attributes.exists){let t=this.postGeoObject.attributes.exists.values;if(t&&t.length>0){let o=t[0];return null==o.startDate||null==o.endDate||null==o.value}}return n&&!this.readOnly}{let t=this.changeRequestEditor.changeRequest.actions[0].geoObjectJson.attributes.exists.values;if(t&&t.length>0){let o=t[0];return null==o.startDate||null==o.endDate||null==o.value}}}return!this.readOnly}getAttribute(n){if("_PARENT_"===n)return this.parentAttributeType;if("geometry"===n)return this.geometryAttributeType;for(let t=0;t<this.geoObjectType.attributes.length;++t)if(this.geoObjectType.attributes[t].code===n)return this.geoObjectType.attributes[t];return null}changePage(n){this.shouldForceSetExist()&&3!==n||(this.geomService.stopEditing(),this.tabIndex=n)}hasChanges(n){let t=this.changeRequest.actions.length;if(t>0)for(let o=0;o<t;++o){let a=this.changeRequest.actions[o];if(a.actionType===Er.CREATEGEOOBJECTACTION)return!0;if(a.actionType===Er.UPDATEATTRIBUTETACTION){let l=a;if("_PARENT_"===l.attributeName&&1===n)return!0;if("geometry"===l.attributeName&&2===n)return!0;if(("invalid"===l.attributeName||"exists"===l.attributeName)&&3===n)return!0;if(0===n&&"_PARENT_"!==l.attributeName&&"geometry"!==l.attributeName&&"exists"!==l.attributeName&&"invalid"!==l.attributeName)return!0}}return!1}hasErrors(n){let t=this.changeRequestEditor.getEditors();if(0===n){let o=["invalid","exists","_PARENT_","geometry"],a=t.filter(l=>-1===o.indexOf(l.attribute.code));for(let l=0;l<a.length;++l)if(!a[l].isValid())return!0}else if(1===n){for(let o=0;o<this.hierarchies.length;++o)if(!this.changeRequestEditor.getEditorForAttribute(this.parentAttributeType,this.hierarchies[o]).isValid())return!0}else{if(2===n)return!this.changeRequestEditor.getEditorForAttribute(this.geometryAttributeType).isValid();if(3===n){let o=this.getAttribute("invalid"),a=_d.getAttribute(this.changeRequestEditor.geoObjectType,"exists"),l=this.changeRequestEditor.getEditorForAttribute(a);return Object.prototype.hasOwnProperty.call(o,"isValid")&&!o.isValid||!l.isValid()}}return!1}isValid(){let n=!0;return this.geoObjectType.attributes.forEach(t=>{null!=t.isValid&&!t.isValid&&(n=!1)}),null!=this.parentAttributeType.isValid&&!this.parentAttributeType.isValid&&(n=!1),null!=this.geometryAttributeType.isValid&&!this.geometryAttributeType.isValid&&(n=!1),n&&this.changeRequestEditor.validate()}getActions(){return this.changeRequestEditor.changeRequest.actions}}Dp.\u0275fac=function(n){return new(n||Dp)(e.Y36(nn.oQ),e.Y36(vo),e.Y36(nn.e8),e.Y36(zs.R),e.Y36(Zi),e.Y36($u))},Dp.\u0275cmp=e.Xpm({type:Dp,selectors:[["geoobject-shared-attribute-editor"]],viewQuery:function(n,t){if(1&n&&(e.Gf(R2,5),e.Gf(yd,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.attributeForm=o.first),e.iGM(o=e.CRH())&&(t.manageVersions=o)}},inputs:{postGeoObject:"postGeoObject",geoObjectType:"geoObjectType",attributeExcludes:"attributeExcludes",readOnly:"readOnly",isNew:"isNew",isGeometryInlined:"isGeometryInlined",changeRequest:"changeRequest",hierarchies:"hierarchies",requestedDate:"requestedDate",datasetId:"datasetId"},features:[e._Bn([T.uU])],decls:41,vars:26,consts:[[1,"row"],[1,"col-md-12"],[3,"showHint","changeRequestEditor","context","latestPeriodIsActive",4,"ngIf"],["label","Show all instances",3,"value","disable","valueChange",4,"ngIf"],[1,"btn-group","geobject-editor-tab-holder"],[1,"btn","full-width-radio-button",3,"ngClass","click"],[2,"display","inline-block","width","90%"],["key","geoobject.editor.tabZero"],[1,"errorSpan"],["class","tabHasErrors",4,"ngIf"],[1,"changeSpan"],["class","tabHasChanges",4,"ngIf"],["key","geoobject.editor.tabOne"],["key","geoobject.editor.tabTwo"],[1,"btn","full-width-radio-button","settings",3,"ngClass","click"],[1,"fa","fa-cog"],["name","geobject-shared-attribute-editor",1,"modal-form"],["attributeForm","ngForm"],[4,"ngIf"],[3,"showHint","changeRequestEditor","context","latestPeriodIsActive"],["label","Show all instances",3,"value","disable","valueChange"],[1,"tabHasErrors"],[1,"tabHasChanges"],["class","row",4,"ngIf"],[1,"text"],[1,"list-group"],["class","list-group-item","style","text-align:left;border:none;padding:0;",4,"ngFor","ngForOf"],[1,"list-group-item",2,"text-align","left","border","none","padding","0"],["class","panel panel-default",4,"ngIf"],[1,"panel","panel-default"],[1,"panel-heading"],[2,"margin","0"],[1,"panel-body"],["key","geoobject.code.alternate.label"],["key","geoobject.displayLabel.alternate.label"],[3,"geoObjectType","changeRequestEditor","attributeType","readonly","isNew","showAllInstances"],["type","text",3,"ngModel","id","name","disabled","style","required","ngModelChange",4,"ngIf"],["type","text",3,"ngModel","id","name","disabled","required","ngModelChange"],[3,"changeRequestEditor","geoObjectType","changeRequest","attributeType","geoObject","readonly","isNew"],[3,"geoObjectType","changeRequestEditor","attributeType","readonly","isNew","hierarchy","showAllInstances"],["key","shared.attributes.attribute.geometry.label"],[3,"geoObjectType","changeRequestEditor","attributeType","readonly","isNew","isGeometryInlined","showAllInstances"],["key","geoobject.invalid.alternate.label"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,F2,1,4,"stability-period",2),e.qZA()(),e.TgZ(3,"div",0)(4,"div",1),e.YNc(5,U2,1,2,"boolean-field",3),e.qZA()(),e.TgZ(6,"div",0)(7,"div",1)(8,"div",4)(9,"label",5),e.NdJ("click",function(){return t.changePage(0)}),e.TgZ(10,"span",6),e._UZ(11,"localize",7),e.qZA(),e.TgZ(12,"div",8),e.YNc(13,q2,1,0,"span",9),e.qZA(),e.TgZ(14,"span",10),e.YNc(15,J2,1,0,"span",11),e.qZA()(),e.TgZ(16,"label",5),e.NdJ("click",function(){return t.changePage(1)}),e.TgZ(17,"span",6),e._UZ(18,"localize",12),e.qZA(),e.TgZ(19,"div",8),e.YNc(20,j2,1,0,"span",9),e.qZA(),e.TgZ(21,"span",10),e.YNc(22,B2,1,0,"span",11),e.qZA()(),e.TgZ(23,"label",5),e.NdJ("click",function(){return t.changePage(2)}),e.TgZ(24,"span",6),e._UZ(25,"localize",13),e.qZA(),e.TgZ(26,"div",8),e.YNc(27,G2,1,0,"span",9),e.qZA(),e.TgZ(28,"span",10),e.YNc(29,V2,1,0,"span",11),e.qZA()(),e.TgZ(30,"label",14),e.NdJ("click",function(){return t.changePage(3)}),e.TgZ(31,"span",6),e._UZ(32,"i",15),e.qZA(),e.TgZ(33,"div",8),e.YNc(34,Y2,1,0,"span",9),e.qZA(),e.TgZ(35,"span",10),e.YNc(36,H2,1,0,"span",11),e.qZA()()()()(),e.TgZ(37,"form",16,17)(39,"fieldset"),e.YNc(40,hC,5,4,"div",18),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("ngIf",t.showStabilityPeriods),e.xp6(3),e.Q6J("ngIf",t.changeRequestEditor&&!t.changeRequestEditor.changeRequest.isNew&&"CreateGeoObject"!==t.changeRequestEditor.changeRequest.type),e.xp6(4),e.Q6J("ngClass",e.WLB(15,ey,0===t.tabIndex,t.shouldForceSetExist())),e.xp6(4),e.Q6J("ngIf",t.hasErrors(0)),e.xp6(2),e.Q6J("ngIf",t.hasChanges(0)),e.xp6(1),e.Q6J("ngClass",e.WLB(18,ey,1===t.tabIndex,t.shouldForceSetExist())),e.xp6(4),e.Q6J("ngIf",t.hasErrors(1)),e.xp6(2),e.Q6J("ngIf",t.hasChanges(1)),e.xp6(1),e.Q6J("ngClass",e.WLB(21,ey,2===t.tabIndex,t.shouldForceSetExist())),e.xp6(4),e.Q6J("ngIf",t.hasErrors(2)),e.xp6(2),e.Q6J("ngIf",t.hasChanges(2)),e.xp6(1),e.Q6J("ngClass",e.VKq(24,fC,3===t.tabIndex)),e.xp6(4),e.Q6J("ngIf",t.hasErrors(3)),e.xp6(2),e.Q6J("ngIf",t.hasChanges(3)),e.xp6(4),e.Q6J("ngIf",t.changeRequestEditor&&t.changeRequestEditor.geoObject))},dependencies:[T.mk,T.sg,T.O5,y._Y,y.Fj,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,rl.M,Fh,yd,Uh,qh],styles:['.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{background:#f5f5f5}.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:disabled{background:#eee}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}li.list-group-item[_ngcontent-%COMP%]{font-size:18px}.warning-text[_ngcontent-%COMP%]{color:orange}form.modal-form[_ngcontent-%COMP%]{overflow:visible}fieldset[_ngcontent-%COMP%]{width:100%!important}.panel[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]{margin:0}.panel[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]{padding:5px 0}.panel-heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0}.input-group[_ngcontent-%COMP%]{width:100%}.radio-group[_ngcontent-%COMP%]{border:solid 1px #ccc;border-radius:5px 0 0 5px;line-height:40px}  .input-group input[type=text], .input-group[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:5px 0 0 5px;width:100%}.input-group[_ngcontent-%COMP%]   input[type=text].input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type=number].input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type=date].input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   select.input-group-read-only[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   .radio-group.input-group-read-only[_ngcontent-%COMP%]{border-radius:5px}.geoobject-panel-header[_ngcontent-%COMP%]{height:50px;width:100%;background:grey}'],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")]),(0,Y.eR)(":leave",(0,Y.jt)("500ms",(0,Y.oB)({opacity:0})))]),(0,Y.X$)("slide",[(0,Y.SB)("left",(0,Y.oB)({left:0})),(0,Y.SB)("right",(0,Y.oB)({left:"100%"})),(0,Y.eR)("* => *",(0,Y.jt)(200))])]]}});const gC=function(i,n,t){return{complete:i,stuck:n,working:t}};function _C(i,n){if(1&i&&(e.TgZ(0,"li",4),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngClass",e.kEZ(2,gC,"COMPLETE"===t.status,"STUCK"===t.status,"WORKING"===t.status)),e.xp6(1),e.hij(" ",t.label," ")}}function mC(i,n){if(1&i&&(e.TgZ(0,"ul",2),e.YNc(1,_C,2,6,"li",3),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t._stepConfig.steps)}}class Rp{constructor(){this._stepConfig={steps:[]}}set steps(n){this._stepConfig=n}ngOnInit(){}ngOnDestroy(){}}function yC(i,n){if(1&i&&(e.TgZ(0,"option",16),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.label," ")}}function vC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"fieldset")(1,"div",6)(2,"div",7)(3,"label"),e._UZ(4,"localize",8),e.qZA(),e.TgZ(5,"select",9),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.type=a)}),e._UZ(6,"option"),e.YNc(7,yC,2,2,"option",10),e.qZA()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",11)(11,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.bsModalRef.hide())}),e.TgZ(12,"span"),e._UZ(13,"localize",13),e.qZA()(),e.TgZ(14,"button",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.confirm())}),e.TgZ(15,"span"),e._UZ(16,"localize",15),e.qZA()()()()()()}if(2&i){const t=e.oxw(),o=e.MAs(5);e.xp6(5),e.Q6J("ngModel",t.type),e.xp6(2),e.Q6J("ngForOf",t.version.subtypes),e.xp6(7),e.Q6J("disabled",o.invalid)}}Rp.\u0275fac=function(n){return new(n||Rp)},Rp.\u0275cmp=e.Xpm({type:Rp,selectors:[["step-indicator"]],inputs:{steps:"steps"},decls:2,vars:1,consts:[[1,"step-indicator"],["class","nav nav-justified",4,"ngIf"],[1,"nav","nav-justified"],["class","nav-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"nav-item",3,"ngClass"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,mC,2,1,"ul",1),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",t._stepConfig&&t._stepConfig.steps&&t._stepConfig.steps.length>0))},dependencies:[T.mk,T.sg,T.O5],styles:[".step-indicator[_ngcontent-%COMP%]{margin-top:5px}.step-indicator[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{background-color:#fff;text-align:center;vertical-align:middle;border-collapse:separate;border-spacing:0;color:#000}.step-indicator[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(:first-child):not(:last-child){border-left:solid 2px white}.step-indicator[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:first-child{-moz-border-radius-topleft:10px;-moz-border-radius-bottomleft:10px;-webkit-border-top-left-radius:10px;-webkit-border-bottom-left-radius:10px;border-top-left-radius:10px;border-bottom-left-radius:10px}.step-indicator[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:last-child{-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:10px}.step-indicator[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{font-weight:700}.step-indicator[_ngcontent-%COMP%]   .nav-item.complete[_ngcontent-%COMP%]{background-color:#b7a2d5}.step-indicator[_ngcontent-%COMP%]   .nav-item.stuck[_ngcontent-%COMP%]{background-color:#f05d5d}.step-indicator[_ngcontent-%COMP%]   .nav-item.working[_ngcontent-%COMP%]{background-color:#ffbc58}"]});class Jh{constructor(n){this.bsModalRef=n}ngOnInit(){this.onCreate=new pn.x}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe(),this.onCreate.unsubscribe()}init(n,t){this.version=n,this.subscription=this.onCreate.subscribe(t)}confirm(){this.bsModalRef.hide(),this.onCreate.next(this.type)}}Jh.\u0275fac=function(n){return new(n||Jh)(e.Y36(Ln.UZ))},Jh.\u0275cmp=e.Xpm({type:Jh,selectors:[["select-type-modal"]],decls:7,vars:1,consts:[["tabindex","-1","role","dialog",1,"modal-body"],[1,"heading","text-center"],["key","dropdown.select.geoobjecttype.option.label"],["name","export-form",1,"modal-form"],["form","ngForm"],[4,"ngIf"],[1,"row"],[1,"col-md-12"],["key","io.geoObjectType"],["id","type","name","type","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1"),e._UZ(3,"localize",2),e.qZA()(),e.TgZ(4,"form",3,4),e.YNc(6,vC,17,3,"fieldset",5),e.qZA()()),2&n&&(e.xp6(6),e.Q6J("ngIf",null!=t.version))},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l],encapsulation:2});var ec=v(10835);class Wu{constructor(n,t,o,a,l,_,C){this.route=n,this.router=t,this.cacheService=o,this.geomService=a,this.dateService=l,this.registryService=_,this.listTypeService=C,this.cacheService.getTypeCache()}selectListRecord(n,t,o,a={}){if(a.version=n.oid,a.uid=t,a.text=null,null!=o&&"GEO_OBJECT"===o.recordType){let l=this.geoObjectFromRecord(o),_=this.addLayerForGeoObject(l,null,a);this.geomService.zoomOnReady(_.getId()),this.addLayerForList(n,null,a),a.type=l.properties.type,a.code=l.properties.code,a.objectType="GEOOBJECT"}else{let l;if(null!=o){let _;if(null!=o.displayLabel&&null!=o.displayLabel.localizedValue)_=o.displayLabel.localizedValue;else{if(null==o.data||null==o.data.displayLabelDefaultLocale)throw new Error("Unexpected 'record' object.");_=o.data.displayLabelDefaultLocale}this.addLayerForList(n,null,a),l=this.addLayerForList(n,{label:_,uid:t},a),a.date=o.forDate}else l=this.addLayerForList(n,null,a);this.geomService.zoomOnReady(l.getId())}return a}clearListRecord(n={}){return n.version=null,n.uid=null,n.text=null,n}geoObjectFromRecord(n){return{properties:{type:n.typeCode,uid:n.uid,code:n.code,displayLabel:n.displayLabel}}}addLayerForList(n,t=null,o={}){let C,a=null==o.layers?[]:this.geomService.deserializeLayers(o.layers),l=new xc(this.listTypeService,n.oid),_=n.displayLabel;null!=t&&(_=t.label+" ("+_+")"),C=null==t?bl().hexString():yc;let N=l.createLayer(_,!0,C);return null!=t&&N.setObjectFilter(t.uid),a=a.filter(F=>!(F.dataSource instanceof xc)||F.getKey()===N.getKey()||null==F.getObjectFilter()&&F.dataSource.getVersionId()===n.oid||F.getPinned()),a=a.filter(F=>F.getPinned()||!(F.dataSource instanceof za)&&!(F.dataSource instanceof na)),-1===a.findIndex(F=>F.getKey()===N.getKey())&&a.splice(0,0,N),o.layers=this.geomService.serializeLayers(a),N}addLayerForGeoObject(n,t=null,o={}){let a=null==o.layers?[]:this.geomService.deserializeLayers(o.layers);const l=this.cacheService.getTypeCache().getTypeByCode(n.properties.type);let _=new Zs(this.registryService,n.properties.code,n.properties.type,t),C=n.properties.displayLabel.localizedValue,N=l.label.localizedValue,F=null==t?"":" "+this.dateService.formatDateForDisplay(t),ue=_.createLayer(C+" "+F+"("+N+")",!0,bl().hexString());return a=a.filter(ce=>!(ce.dataSource instanceof Zs)||ce.getKey()===ue.getKey()||ce.getPinned()),a=a.filter(ce=>ce.getPinned()||!(ce.dataSource instanceof za)&&!(ce.dataSource instanceof na)),-1===a.findIndex(ce=>ce.getKey()===ue.getKey())&&a.splice(0,0,ue),o.layers=this.geomService.serializeLayers(a),ue}}Wu.\u0275fac=function(n){return new(n||Wu)(e.LFG(w.gz),e.LFG(w.F0),e.LFG(Ml),e.LFG(vo),e.LFG(nn.Ru),e.LFG(Zi),e.LFG(Uo))},Wu.\u0275prov=e.Yz7({token:Wu,factory:Wu.\u0275fac});class Fp{constructor(n,t){this.http=n,this.eventService=t}get(n,t){let o=new ot.LE;return o=o.append("businessTypeCode",n),o=o.append("code",t),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/business-object/get",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getTypeAndObject(n,t){let o=new ot.LE;return o=o.append("businessTypeCode",n),o=o.append("code",t),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/business-object/get-type-and-object",{params:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}}Fp.\u0275fac=function(n){return new(n||Fp)(e.LFG(ot.eN),e.LFG(nn.PO))},Fp.\u0275prov=e.Yz7({token:Fp,factory:Fp.\u0275fac});const bC=["simpleEditControl"],xC=["FeaturePanel"];function CC(i,n){if(1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",20),e._uU(2),e.qZA()),2&i){const t=e.oxw().item;e.xp6(2),e.hij(" ",t.layer.versionNumber," ")}}function wC(i,n){1&i&&e._UZ(0,"localize",21)}function TC(i,n){if(1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA(),e.TgZ(2,"h6"),e._uU(3),e.YNc(4,CC,3,1,"span",9),e.YNc(5,wC,1,0,"localize",19),e._uU(6," ) "),e.qZA()),2&i){const t=n.item;e.xp6(1),e.AsE("",t.name," : ",t.code,""),e.xp6(2),e.AsE(" ",t.layer.label," - ",t.layer.forDate," ( "),e.xp6(1),e.Q6J("ngIf",0!==t.layer.versionNumber),e.xp6(1),e.Q6J("ngIf",0===t.layer.versionNumber)}}function MC(i,n){if(1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i){const t=n.item;e.xp6(1),e.AsE("",t.name," : ",t.code,"")}}const OC=function(i){return{detached:i}};function SC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"article",22),e.ynx(2),e.TgZ(3,"div",8)(4,"div",23),e._UZ(5,"ngx-spinner",24),e.TgZ(6,"date-field",25),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.dateFieldValue=a)}),e.qZA(),e.TgZ(7,"input",26),e.NdJ("keyup.enter",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.search())})("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.searchFieldText=a)})("typeaheadOnSelect",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.typeaheadOnSelect(a))}),e.ALo(8,"localize"),e.qZA(),e.TgZ(9,"span",27)(10,"button",28),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.search())}),e._UZ(11,"span",29),e.qZA()()()(),e.BQk(),e.qZA()()}if(2&i){const t=e.oxw(),o=e.MAs(3);e.xp6(1),e.Q6J("ngClass",e.VKq(19,OC,0===t.data.length&&null==t.current)),e.xp6(4),e.Q6J("fullScreen",!1)("name",t.CONSTANTS.SEARCH_OVERLAY),e.xp6(1),e.Q6J("value",t.dateFieldValue)("inputName","date")("allowInfinity",!1)("allowFutureDates",!1)("required",!1)("customContainerClasses","bs-datepicker-container-custom-left"),e.xp6(1),e.Q6J("placeholder",e.lcZ(8,17,"explorer.search.placeholder"))("ngModel",t.searchFieldText)("typeaheadAsync",!0)("typeahead",t.typeahead)("typeaheadItemTemplate",o)("typeaheadMinLength",2)("typeaheadWaitMs",300),e.xp6(3),e.Q6J("disabled",t.isEdit)}}function PC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",34)(1,"div",35),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.selectGeoObject(l))}),e.TgZ(2,"div",36)(3,"h4",37),e._uU(4),e.qZA()(),e.TgZ(5,"div",38),e._uU(6),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(4),e.AsE(" ",t.properties.code," - ",t.properties.displayLabel.localizedValue," "),e.xp6(2),e.Oqu(t.properties.type)}}const EC=function(i){return{"full-height-sidebar":i}};function AC(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"div",7)(2,"div",30)(3,"div",31)(4,"div",32),e.YNc(5,PC,7,3,"div",33),e.qZA()()()(),e.BQk()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngClass",e.VKq(2,EC,t.data.length>0)),e.xp6(3),e.Q6J("ngForOf",t.data)}}function kC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"feature-panel",41,42),e.NdJ("forDateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.featurePanelForDateChange(a))})("modeChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onModeChange(a))})("panelCancel",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.clearRecord())})("panelSubmit",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onPanelSubmit(a))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("type",t.typeCache.getTypeByCode(t.state.type))("code",t.current.code)("forDate",t.current.forDate)("readOnly",!1)}}function IC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"business-object-panel",43),e.NdJ("close",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.mode=a.MODE.VIEW)}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("type",t.current.businessType)("object",t.current.businessObject)}}const ZC=function(i,n){return{"full-height-sidebar":i,"max-height":n}};function NC(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"div",7)(2,"div",30),e.YNc(3,kC,2,4,"feature-panel",39),e.YNc(4,IC,1,2,"business-object-panel",40),e.qZA()(),e.BQk()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngClass",e.WLB(3,ZC,null!=t.current,!t.searchEnabled)),e.xp6(1),e.Q6J("ngIf","GEOOBJECT"===t.current.objectType&&t.typeCache.ready()),e.xp6(1),e.Q6J("ngIf","BUSINESS"===t.current.objectType)}}const LC=function(i,n){return{"fa-angle-double-left":i,"fa-angle-double-right":n}};function zC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(!a.isEdit&&a.togglePanel())}),e.TgZ(1,"div",45),e._UZ(2,"span",46),e.ALo(3,"localize"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("title",e.lcZ(3,2,t.state.attrPanelOpen?"explorer.resize.closeAttributePanel":"explorer.resize.openAttributePanel"))("ngClass",e.WLB(4,LC,t.state.attrPanelOpen,!t.state.attrPanelOpen))}}function DC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",47)(1,"i",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.toggleGraphPanel())}),e.ALo(2,"localize"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("title",e.lcZ(2,1,t.state.graphPanelOpen?"explorer.resize.closeGraphViz":"explorer.resize.openGraphViz"))}}function RC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",49)(1,"div",50)(2,"relationship-visualizer",51),e.NdJ("nodeSelect",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onGraphNodeSelect(a))}),e.qZA()()()}}function FC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"list-panel",58),e.NdJ("close",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onListPanelClose())})("error",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.error(a))})("onRowSelect",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onRowSelect(a))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("oid",t.list.versionId)}}function UC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"list-row",59),e.NdJ("close",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onListPanelClose())})("error",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.error(a))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("oid",t.list.versionId)("uid",t.list.uid)}}const qC=function(i){return{"col-md-4":i}},JC=function(i,n){return{"col-md-12":i,"col-md-8":n}};function jC(i,n){if(1&i&&(e.TgZ(0,"article",52)(1,"div",53),e._UZ(2,"div",54),e.TgZ(3,"div",55),e.YNc(4,FC,1,1,"list-panel",56),e.YNc(5,UC,1,2,"list-row",57),e.qZA()()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngClass",e.VKq(4,qC,t.isAttributePanelOpen())),e.xp6(1),e.Q6J("ngClass",e.WLB(6,JC,!t.isAttributePanelOpen(),t.isAttributePanelOpen())),e.xp6(1),e.Q6J("ngIf",null==t.list.uid),e.xp6(1),e.Q6J("ngIf",null!=t.list.uid)}}const BC=function(i,n){return{"col-md-6":i,"col-md-8":n}},GC=function(i){return{"second-map-button":i}},VC=function(i,n){return{"max-width":i,"padding-left":n}};class vd{constructor(n,t,o,a,l,_,C,N,F,V,ue,ce,Te){this.configuration=n,this.router=t,this.modalService=o,this.spinner=a,this.cacheService=l,this.listService=_,this.mapService=C,this.geomService=N,this.lService=F,this.authService=V,this.locationManagerService=ue,this.businessObjectService=ce,this.location=Te,this.pageMode="",this.coordinate={longitude:null,latitude:null},this.MODE={SEARCH:0,VIEW:1},this.CONSTANTS={SEARCH_OVERLAY:"search-panel"},this.data=[],this.state={attrPanelOpen:!0},this.isEdit=!1,this.mode=this.MODE.SEARCH,this.showPanel=!0,this.baseLayers=[{name:"Satellite",label:"Satellite",id:"satellite-v9",sprite:"mapbox://sprites/mapbox/satellite-v9",url:"mapbox://mapbox.satellite",selected:!0}],this.preventSingleClick=!1,this.ready=!1,this.searchEnabled=!0,this.graphVisualizerEnabled=!1,this.typeahead=null,this.layersPanelSize=0,this.list=null,this.recordContext="MAP",this.location=Te}ngOnInit(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.subscription=this.geomService.stateChange$.subscribe(n=>this.handleStateChange(n)),this.searchEnabled=this.configuration.isSearchEnabled()&&(this.authService.isRC(!1)||this.authService.isRM()||this.authService.isRA()),this.graphVisualizerEnabled=this.configuration.isGraphVisualizerEnabled()||!1,this.typeCache=this.cacheService.getTypeCache(),this.geomService.dumpLayers(),this.typeahead=new Ni.y(n=>{this.mapService.labels(this.searchFieldText,this.dateFieldValue,!1).then(t=>{n.next(t)})})}ngOnDestroy(){this.geomService.destroy(),this.subscription.unsubscribe()}ngAfterViewInit(){this.initializeMap()}resizeWindow(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight}initializeMap(){const n=this.baseLayers[0],t={container:"map",style:{version:8,name:n.name,metadata:{"mapbox:autocomposite":!0},sources:{mapbox:{type:"raster",url:n.url,tileSize:256}},sprite:n.sprite,glyphs:window.location.protocol+"//"+window.location.host+Xc.Z.getApiUrl()+"/glyphs/{fontstack}/{range}.pbf",layers:[{id:n.id,type:"raster",source:"mapbox"}]},attributionControl:!1,bounds:this.configuration.getDefaultMapBounds()};null!=this.state.bounds&&this.state.bounds.length>0&&(t.bounds=new sr.LngLatBounds(JSON.parse(this.state.bounds))),t.logoPosition="bottom-right",this.map=new sr.Map(t),this.map.on("load",()=>{this.geomService.initialize(this.map,null,!0),this.ready=!0,this.initMap()}),this.simpleEditControl&&this.map.addControl(this.simpleEditControl)}updateState(n,t=!1){this.geomService.setState(n,t)}onGraphNodeSelect(n){this.closeEditSessionSafeguard().then(()=>{n.selectAnimation(()=>{if("GEOOBJECT"===n.objectType){let t={properties:{type:n.typeCode,uid:n.id,code:n.code,displayLabel:new ru(n.label,[])}};this.selectGeoObject(t)}else"BUSINESS"===n.objectType&&this.updateState({type:n.typeCode,code:n.code,objectType:n.objectType,uid:null,version:null,text:null},!0)})})}handleStateChange(n){n=JSON.parse(JSON.stringify(n));let t=JSON.parse(JSON.stringify(this.state));if(this.ready){this.state=n;let o=this.MODE.SEARCH,a=n.attrPanelOpen||void 0===n.attrPanelOpen;if(null!=n&&(n.date!==t.date&&(this.dateFieldValue=n.date),null!=n.text&&((n.text!==t.text||n.date!==t.date)&&(this.searchFieldText=n.text,this.loadSearchFromState()),a=!0),(null==n.objectType||"GEOOBJECT"===n.objectType)&&null!=n.type&&null!=n.code&&((t.type!==n.type||t.code!==n.code||t.date!==n.date)&&this.loadGeoObjectFromState(),a=!0,o=this.MODE.VIEW),null!=n.objectType&&"BUSINESS"===n.objectType&&n.type&&n.code&&((null==this.current||null==this.current.businessObject||this.current.businessObject.code!==n.code||this.current.businessType.code!==n.type)&&this.loadBusinessObjectFromState(),a=!0,o=this.MODE.VIEW),null!=n.version&&null!=n.uid&&(null==this.current||this.current.versionId!==n.version||this.current.recordUid!==n.uid)&&this.loadListRecordFromState(),n.pageContext&&(this.pageMode=n.pageContext),this.layersPanelSize=n.layersPanelSize?Number.parseInt(n.layersPanelSize):"EXPLORER"===this.pageMode?2:this.layersPanelSize,null!=n.attrPanelOpen&&(a=n.attrPanelOpen)),this.changeMode(o),t.attrPanelOpen!==a&&this.setPanel(a),null!=n.bounds&&n.bounds.length>0&&!this.geomService.isMapZooming()){const l=JSON.parse(n.bounds);this.mapBounds=this.convertMapBounds(new sr.LngLatBounds(l)),this.convertMapBounds(this.map.getBounds()).toString()!==this.mapBounds.toString()&&this.map.fitBounds(this.mapBounds,{animate:!1})}}}loadBusinessObjectFromState(){this.businessObjectService.getTypeAndObject(this.state.type,this.state.code).then(n=>{this.current={objectType:"BUSINESS",code:this.state.code,businessObject:n.object,businessType:n.type},this.mode=this.MODE.VIEW}).catch(n=>{this.error(n)}).finally(()=>{this.spinner.hide("feature-panel")})}setPanel(n){this.state.attrPanelOpen!==n&&(this.updateState({attrPanelOpen:n},!1),kh(()=>{this.map.resize()},1))}togglePanel(){this.setPanel(!this.state.attrPanelOpen)}changeMode(n){n!==this.mode&&(this.mode=n,this.isEdit&&this.geomService.stopEditing(),this.mode===this.MODE.SEARCH&&(this.isEdit=!1,this.current=null))}onModeChange(n){this.isEdit=n}initMap(){this.map.addControl(new sr.AttributionControl({compact:!0}),"bottom-right"),this.map.addControl(new sr.NavigationControl({visualizePitch:!0}),"bottom-right"),this.map.on("click",n=>{this.handleMapClickEvent(n)}),this.map.on("moveend",n=>{const t=this.convertMapBounds(this.map.getBounds());if(null==this.mapBounds||this.mapBounds.toString()!==t.toString()){const o=t.toArray();this.updateState({bounds:JSON.stringify(o)})}}),this.handleStateChange(this.geomService.getState())}onCreate(n){"LISTVECT"===n.dataSource.dataSourceType&&this.closeEditSessionSafeguard().then(()=>{this.listService.getVersion(n.dataSource.versionId).then(t=>{t.isAbstract?(this.bsModalRef=this.modalService.show(Jh,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(t,o=>{this.select({properties:{type:o,code:"__NEW__"}},null)})):this.select({properties:{type:t.typeCode,code:"__NEW__"}},null)})})}closeEditSessionSafeguard(){if(!this.isEdit)return new Promise((a,l)=>{a()});let n=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});n.content.message=this.lService.decode("explorer.edit.loseAllChanges"),n.content.data={},n.content.submitText=this.lService.decode("modal.button.ok"),n.content.type=ec.Qi.danger;let t=(a,l,_)=>{this.cancelEditingSession(),l(_),a.unsubscribe()};return new Promise((a,l)=>{let _=n.content.onConfirm.subscribe(C=>{t(_,a,C)},C=>{((a,l,_)=>{l(_),a.unsubscribe()})(_,l,C)})})}handleMapClickEvent(n){const t=this.map.queryRenderedFeatures(n.point);if(null!=t&&t.length>0){const o=t[0];null!=o.properties.uid&&this.closeEditSessionSafeguard().then(()=>{if(o.layer){let a=this.geomService.getLayerFromMapboxLayer(o.layer);if(a)if(a.dataSource.getDataSourceType()===Tp){if(null==this.current||null==o.properties||this.state.code!==o.properties.code||this.state.type!==o.properties.type){let l=JSON.parse(JSON.stringify(o));l.properties.displayLabel=null!=o.properties.displayLabel?JSON.parse(o.properties.displayLabel):null,this.selectGeoObject(l)}}else if(a.dataSource.getDataSourceType()===vs){this.recordContext="MAP";const l=a.dataSource.getVersionId();this.listService.getVersion(l).then(_=>{this.selectListRecord(_,o.properties.uid)})}else if(a.dataSource.getDataSourceType()===il){let l=JSON.parse(JSON.stringify(o));l.properties.displayLabel=null!=o.properties.displayLabel?JSON.parse(o.properties.displayLabel):null,this.selectGeoObject(l)}else if(a.dataSource.getDataSourceType()===$i){let l=JSON.parse(JSON.stringify(o));l.properties.displayLabel=null!=o.properties.displayLabel?JSON.parse(o.properties.displayLabel):null,this.selectGeoObject(l)}}})}}onPanelCancel(){this.clearRecord()}onPanelSubmit(n){this.geomService.saveEdits(),n.isChangeRequest?null!=this.backReference&&this.backReference.length>=2&&"CR"===this.backReference.substring(0,2)?(this.bsModalRef=this.modalService.show(Zt.lM,{backdrop:!0,class:"error-white-space-pre"}),this.bsModalRef.content.message=this.lService.decode("geoobject-editor.changerequest.submitted"),this.bsModalRef.content.submitText=this.lService.decode("geoobject-editor.changerequest.view"),this.bsModalRef.content.onConfirm.subscribe(()=>{this.router.navigate(["/registry/change-requests",n.changeRequestId])})):(this.bsModalRef=this.modalService.show(Zt.z5,{backdrop:!0,class:"error-white-space-pre"}),this.bsModalRef.content.message=this.lService.decode("geoobject-editor.changerequest.submitted"),this.bsModalRef.content.submitText=this.lService.decode("geoobject-editor.changerequest.view"),this.bsModalRef.content.cancelText=this.lService.decode("geoobject-editor.cancel.returnExplorer"),this.bsModalRef.content.onConfirm.subscribe(()=>{this.router.navigate(["/registry/change-requests",n.changeRequestId])}),this.bsModalRef.content.onCancel.subscribe(()=>{this.clearRecord()})):(this.bsModalRef=this.modalService.show(Zt.lM,{backdrop:!0,class:"error-white-space-pre"}),this.bsModalRef.content.message=this.lService.decode("geoobject-editor.edit.submitted"),this.bsModalRef.content.submitText=this.lService.decode("geoobject-editor.cancel.returnExplorer"),this.bsModalRef.content.onConfirm.subscribe(()=>{this.onPanelCancel()}))}handleBasemapStyle(n){this.baseLayers.forEach(t=>{t.selected=!1}),n.selected=!0,this.map.setStyle({version:8,name:n.name,metadata:{"mapbox:autocomposite":!0},sources:{mapbox:{type:"raster",url:n.url,tileSize:256}},sprite:n.sprite,glyphs:window.location.protocol+"//"+window.location.host+Xc.Z.getApiUrl()+"/glyphs/{fontstack}/{range}.pbf",layers:[{id:n.id,type:"raster",source:"mapbox"}]})}getGeoObjectTypeLabel(n){const t=this.typeCache.getTypeByCode(n.properties.type);return null==t?"":t.label.localizedValue}search(){if(!(null!=this.searchFieldText&&""!==this.searchFieldText||""!==this.state.text&&null!==this.state.text))return;let n=this.geomService.getLayers(),t=n.findIndex(o=>o.dataSource instanceof za);if(-1!==t){let a=n[t].dataSource;if(a.getText()===this.searchFieldText&&a.getDate()===this.dateFieldValue)return}if(n=n.filter(o=>o.getPinned()||!(o.dataSource instanceof za)&&!(o.dataSource instanceof na)||o.dataSource instanceof za&&o.dataSource.getText()===this.searchFieldText&&o.dataSource.getDate()===this.dateFieldValue),this.geomService.unregisterDataSource(vc),null!=this.searchFieldText&&""!==this.searchFieldText){let o=new za(this.mapService,this.searchFieldText,this.dateFieldValue);o.getLayerData().then(a=>{if(this.geomService.registerDataSource(o),null!=a&&a.features.length>0){let C=o.createLayer(this.lService.decode("explorer.search.layer")+" ("+this.searchFieldText+")",!0,bl().hexString());n.splice(0,0,C),this.geomService.zoomOnReady(C.getId()),n=n.filter(N=>N.getPinned()||!(N.dataSource instanceof Cc)&&!(N.dataSource instanceof Zs)&&!(N.dataSource instanceof na))}else this.data=[],this.modalService.show(Zt.yY,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}).content.message=this.lService.decode("explorer.search.no.results");let _={text:this.searchFieldText,date:this.dateFieldValue,type:null,code:null,version:null,uid:null,layers:this.geomService.serializeLayers(n)};this.updateState(_,!0)})}else this.data=[]}loadSearchFromState(){if(null==this.searchFieldText||""===this.searchFieldText)return;this.geomService.stopEditing(),this.spinner.show(this.CONSTANTS.SEARCH_OVERLAY);const n=this.geomService.getRegisteredDataSource(vc);let t=new za(this.mapService,this.state.text,this.state.date);null!=n&&n.getKey()===t.getKey()&&(t=n),t.getLayerData().then(o=>{this.spinner.hide(this.CONSTANTS.SEARCH_OVERLAY),this.data=o.features}).catch(()=>{this.spinner.hide(this.CONSTANTS.SEARCH_OVERLAY),this.state.text="",this.state.date=""})}loadListRecordFromState(){null==this.state.code&&(this.current={objectType:"LIST",recordUid:this.state.uid,versionId:this.state.version},this.list={versionId:this.state.version,uid:this.state.uid})}selectListRecord(n,t){this.closeEditSessionSafeguard().then(()=>{this.listService.record(n.oid,t,!1).then(o=>{this.typeCache.waitOnTypes().then(()=>{let a=this.locationManagerService.selectListRecord(n,t,o,this.geomService.getState());this.updateState(a,!0)})}).catch(o=>{this.error(o)})})}cancelEditingSession(){this.isEdit&&this.geomService.stopEditing(),this.isEdit=!1,this.featurePanel.setEditMode(!1)}clearRecord(){this.updateState({type:null,code:null,version:null,uid:null},!1)}featurePanelForDateChange(n){this.geomService.stopEditing(),this.updateState({date:n},!1)}select(n,t){this.isEdit||this.updateState({type:n.properties.type,code:n.properties.code,objectType:"GEOOBJECT",uid:n.properties.uid,version:null},!1)}selectGeoObject(n,t=null){n.properties.uid===this.state.uid&&(null==t||t===this.state.date)||this.typeCache.waitOnTypes().then(()=>{this.closeEditSessionSafeguard().then(()=>{let o={type:n.properties.type,code:n.properties.code,objectType:"GEOOBJECT",uid:n.properties.uid,version:null,text:null},a=this.locationManagerService.addLayerForGeoObject(n,t,o);this.geomService.zoomOnReady(a.getId()),null!=t&&(o.date=t),this.updateState(o,!0)})})}loadGeoObjectFromState(){this.typeCache.waitOnTypes().then(()=>{const n=this.typeCache.getTypeByCode(this.state.type);this.geomService.stopEditing(),this.geomService.setGeometryType(null),this.geomService.setGeometryType(n.geometryType),this.current={objectType:"GEOOBJECT",code:this.state.code,forDate:""===this.state.date?null:this.state.date}})}onFeatureSelect(n){if(!this.isEdit){this.state.text=n.item.name;const t=n.item.feature;null!=t.properties.uid&&this.listService.getBounds(t.version,t.properties.uid).then(o=>{if(o&&Array.isArray(o)){let a=new sr.LngLatBounds([o[0],o[1]],[o[2],o[3]]);this.map.fitBounds(a,{padding:50,animate:!0,maxZoom:20})}}).catch(o=>{this.error(o)}),null!=t.properties.uid&&this.updateState({type:null,code:null,version:t.version,uid:t.properties.uid},!1)}}toggleGraphPanel(){this.updateState({graphPanelOpen:!this.state.graphPanelOpen},!1)}convertMapBounds(n){const t=n.getNorthEast(),o=n.getSouthWest();return sr.LngLatBounds.convert([[parseFloat(o.lng.toFixed(10)),parseFloat(o.lat.toFixed(10))],[parseFloat(t.lng.toFixed(10)),parseFloat(t.lat.toFixed(10))]])}onViewList(n){let t=this.locationManagerService.clearListRecord(this.geomService.getState());this.updateState(t,!0),this.list={versionId:n}}onRowSelect(n){this.recordContext="ROW",this.selectListRecord(n.version,n.uid)}onListPanelClose(){let n=this.locationManagerService.clearListRecord(this.geomService.getState());this.updateState(n,!0),this.list=null}isAttributePanelOpen(){return this.state.attrPanelOpen&&(this.mode===this.MODE.VIEW&&null!=this.current||this.mode===this.MODE.SEARCH&&this.searchEnabled&&this.data.length>0)}typeaheadOnSelect(n){null!=n&&(this.searchFieldText=n.item.name,this.search())}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}vd.\u0275fac=function(n){return new(n||vd)(e.Y36(Wc.e),e.Y36(w.F0),e.Y36(Ln.tT),e.Y36(Nn),e.Y36(Ml),e.Y36(Uo),e.Y36(ys),e.Y36(vo),e.Y36(nn.oQ),e.Y36(nn.e8),e.Y36(Wu),e.Y36(Fp),e.Y36(T.Ye))},vd.\u0275cmp=e.Xpm({type:vd,selectors:[["location-manager"]],viewQuery:function(n,t){if(1&n&&(e.Gf(bC,5),e.Gf(xC,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.simpleEditControl=o.first),e.iGM(o=e.CRH())&&(t.featurePanel=o.first)}},hostBindings:function(n,t){1&n&&e.NdJ("resize",function(a){return t.resizeWindow(a)},!1,e.Jf7)},features:[e._Bn([T.Ye])],decls:27,vars:20,consts:[["customItemTemplate",""],["searchTemplate",""],["id","app-container",1,"container-fluid"],[2,"position","absolute","top","0","bottom","0","left","10px","right","10px","height","100%"],[1,"row",2,"margin-top","50px"],[1,"col-md-4",2,"z-index","999",3,"hidden"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-12"],[4,"ngIf"],[2,"z-index","4","padding-top","10px",3,"ngClass"],[2,"z-index","999","padding-top","10px","overflow-y","auto","position","absolute","top","0","overflow","visible"],["class","map-button clickable","style","padding-bottom: 5px;",3,"click",4,"ngIf"],["class","map-button visualize-mode-toggle",4,"ngIf"],["id","graph-container","style","height: calc(100vh - 74px);padding-left: 58px;",4,"ngIf"],["id","navigator-layer-panel",1,"base-layer-panel",3,"ngClass","ngStyle"],[3,"panelSize","create","viewList"],["id","navigator-list-panel","class","list-panel","style","position: absolute; right: 5px; bottom: 0px; z-index: 500; width: 100%; pointer-events: none;",4,"ngIf"],["id","map",1,"map-view-port"],["key","list.type.working.version",4,"ngIf"],["key","list.type.version"],["key","list.type.working.version"],[1,"panel-toggle",3,"ngClass"],[1,"input-group"],["type","ball-clip-rotate-multiple","size","medium",3,"fullScreen","name"],["label","",2,"display","table-cell","vertical-align","middle","width","175px",3,"value","inputName","allowInfinity","allowFutureDates","required","customContainerClasses","valueChange"],["type","text","name","text",1,"form-control",3,"placeholder","ngModel","typeaheadAsync","typeahead","typeaheadItemTemplate","typeaheadMinLength","typeaheadWaitMs","keyup.enter","ngModelChange","typeaheadOnSelect"],[1,"input-group-btn"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"glyphicon","glyphicon-search"],[1,"col-md-12",3,"ngClass"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"card","card-default",3,"click"],[1,"card-body"],["title","View Geo-Object details",1,"clickable",2,"word-break","break-all"],[1,"card-footer"],[3,"type","code","forDate","readOnly","forDateChange","modeChange","panelCancel","panelSubmit",4,"ngIf"],[3,"type","object","close",4,"ngIf"],[3,"type","code","forDate","readOnly","forDateChange","modeChange","panelCancel","panelSubmit"],["FeaturePanel",""],[3,"type","object","close"],[1,"map-button","clickable",2,"padding-bottom","5px",3,"click"],[1,"map-button-icon"],["aria-hidden","true",1,"fa","clickable",2,"font-size","35px",3,"title","ngClass"],[1,"map-button","visualize-mode-toggle"],["aria-hidden","true",1,"visualize-mode-hierarchy","clickable","fa","fa-share-alt",2,"margin-right","initial",3,"title","click"],["id","graph-container",2,"height","calc(100vh - 74px)","padding-left","58px"],[2,"background-color","white","opacity","100%","width","100%","height","100%"],[3,"nodeSelect"],["id","navigator-list-panel",1,"list-panel",2,"position","absolute","right","5px","bottom","0px","z-index","500","width","100%","pointer-events","none"],[1,"row",2,"margin-left","5px"],[3,"ngClass"],[2,"pointer-events","all",3,"ngClass"],[3,"oid","close","error","onRowSelect",4,"ngIf"],[3,"oid","uid","close","error",4,"ngIf"],[3,"oid","close","error","onRowSelect"],[3,"oid","uid","close","error"]],template:function(n,t){1&n&&(e.YNc(0,TC,7,6,"ng-template",null,0,e.W1O),e.YNc(2,MC,2,2,"ng-template",null,1,e.W1O),e._UZ(4,"cgr-header")(5,"loading-bar"),e.TgZ(6,"div",2)(7,"div",3)(8,"div",4)(9,"div",5),e.YNc(10,SC,12,21,"div",6),e.TgZ(11,"div",7)(12,"div",8),e.YNc(13,AC,6,4,"ng-container",9),e.YNc(14,NC,5,6,"ng-container",9),e.qZA()()(),e.TgZ(15,"div",10)(16,"div",11),e.YNc(17,zC,4,7,"div",12),e.YNc(18,DC,3,3,"span",13),e.qZA(),e.YNc(19,RC,3,0,"div",14),e.qZA()()(),e.TgZ(20,"div",7)(21,"div",8)(22,"div",7)(23,"article",15)(24,"layer-panel",16),e.NdJ("create",function(a){return t.onCreate(a)})("viewList",function(a){return t.onViewList(a)}),e.qZA()(),e.YNc(25,jC,6,9,"article",17),e._UZ(26,"div",18),e.qZA()()()()),2&n&&(e.xp6(9),e.Q6J("hidden",!t.state.attrPanelOpen),e.xp6(1),e.Q6J("ngIf",t.searchEnabled),e.xp6(3),e.Q6J("ngIf",t.mode===t.MODE.SEARCH&&t.searchEnabled),e.xp6(1),e.Q6J("ngIf",t.mode===t.MODE.VIEW&&null!=t.current),e.xp6(1),e.Q6J("ngClass",e.WLB(12,BC,!t.state.attrPanelOpen,t.state.attrPanelOpen)),e.xp6(2),e.Q6J("ngIf",t.searchEnabled||null!=t.current),e.xp6(1),e.Q6J("ngIf",null!=t.current&&t.graphVisualizerEnabled),e.xp6(1),e.Q6J("ngIf",t.state.graphPanelOpen&&t.graphVisualizerEnabled&&t.state.type&&t.state.code),e.xp6(4),e.Q6J("ngClass",e.VKq(15,GC,t.searchEnabled&&!t.state.attrPanelOpen))("ngStyle",e.WLB(17,VC,2===t.layersPanelSize?"50%":"unset",2===t.layersPanelSize?"10px":"unset")),e.xp6(1),e.Q6J("panelSize",t.layersPanelSize),e.xp6(1),e.Q6J("ngIf",null!=t.list&&!t.state.graphPanelOpen))},styles:[".map-button.visualize-mode-toggle[_ngcontent-%COMP%]{padding:14px 7px 5px 5px}.visualize-mode-toggle.map[_ngcontent-%COMP%], .visualize-mode-toggle.hierarchy[_ngcontent-%COMP%]{right:50px}.visualize-mode-hierarchy[_ngcontent-%COMP%]{color:#000}.visualize-mode-toggle[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:25px}.map-view-port[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.base-layer-panel[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;z-index:3;padding:5px}.map-button[_ngcontent-%COMP%]{background-color:#fff;margin:0 0 20px;padding:0;z-index:1001;border-radius:4px;width:46px;width:-moz-fit-content;width:fit-content}.map-button-icon[_ngcontent-%COMP%]{font-size:12px;text-align:center;width:38px;height:30px;vertical-align:middle}.map-button-icon[_ngcontent-%COMP%] > span.glyphicon[_ngcontent-%COMP%]{line-height:30px}.site-explorer-list[_ngcontent-%COMP%]{padding:20px;height:calc(100vh - 106px);overflow-y:auto;overflow-x:hidden}.location-management-widget-section[_ngcontent-%COMP%]{margin:5px 0}.location-management-widget-section[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{float:none!important}.list-group-item[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #ddd;margin-bottom:0}.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.breadcrumb[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;margin:0}.layer-toggle[_ngcontent-%COMP%]{background:#fff;padding:5px;border-radius:4px;width:-moz-fit-content;width:fit-content;max-height:calc(100vh - 175px);overflow-y:auto;overflow-x:clip}.layer-toggle[_ngcontent-%COMP%]   .fa-bars[_ngcontent-%COMP%]{cursor:pointer}.layer-toggle[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:27px;height:27px}.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:5px}.arrow[_ngcontent-%COMP%]{border:solid black;border-width:0 1px 1px 0;display:inline-block;padding:5px}.arrow-right[_ngcontent-%COMP%]{transform:rotate(-45deg);-webkit-transform:rotate(-45deg)}.arrow-down[_ngcontent-%COMP%]{transform:rotate(45deg);-webkit-transform:rotate(45deg)}.fa.fa-arrow-left[_ngcontent-%COMP%]:before{margin-right:5px}.panel-toggle[_ngcontent-%COMP%]{position:absolute;padding:15px 0;background-color:#fff;z-index:9;width:100%;border-color:#6ba542;border-color:var(--theme-input-text-border-active);outline:0;box-shadow:inset 0 1px 1px #00000014,0 0 8px #6ba54299}[_nghost-%COMP%]  .panel-toggle input.date-input-element{border-radius:5px 0 0 5px;border:1px solid #ccc}.panel-toggle.detached[_ngcontent-%COMP%]{border-radius:3px;margin:10px 0 10px 10px;padding:5px}.panel-toggle.detached[_ngcontent-%COMP%] > .col-md-12[_ngcontent-%COMP%]{padding-right:0;padding-left:0}.layer-toggle-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;margin:3px 0;padding-left:20px}.label-wrapper[_ngcontent-%COMP%]{margin-left:5px;display:inline-block}.label-wrapper[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{vertical-align:middle}.label-wrapper[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]:hover{color:#6ba542;color:var(--theme-submit-button-color);cursor:pointer}.full-height-sidebar[_ngcontent-%COMP%]{height:calc(100vh - 120px);overflow:auto;top:70px;background:white}.full-height-sidebar.max-height[_ngcontent-%COMP%]{height:calc(100vh - 50px);top:0}.collapse-sidebar[_ngcontent-%COMP%], .collapse-sidebar[_ngcontent-%COMP%]   [class*=col-][_ngcontent-%COMP%]{width:10px;overflow:visible;padding:0}.collapse-sidebar[_ngcontent-%COMP%]   .panel-toggle[_ngcontent-%COMP%]{display:none}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.custom-placeholder[_ngcontent-%COMP%]{background:#ccc;border:dotted 3px #999;min-height:40px;transition:transform .25s cubic-bezier(0,0,.2,1)}.col-fixed-50[_ngcontent-%COMP%]{width:50px;position:fixed;height:100%}"]});var Fr=v(85327);function YC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().versionOrLayer,l=e.oxw();return e.KtG(l.onViewList(a.oid))}),e._UZ(1,"localize",14),e._uU(2),e.qZA()}if(2&i){const t=e.oxw().versionOrLayer;e.xp6(2),e.hij(" ",t.versionNumber," ")}}function HC(i,n){1&i&&e._UZ(0,"localize",16)}function QC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().versionOrLayer,l=e.oxw();return e.KtG(l.onViewList(a.oid))}),e.YNc(1,HC,1,0,"localize",15),e.qZA()}if(2&i){const t=e.oxw().versionOrLayer;e.xp6(1),e.Q6J("ngIf",0===t.versionNumber)}}function KC(i,n){if(1&i&&(e._uU(0," ( "),e.YNc(1,YC,3,1,"a",12),e.YNc(2,QC,2,1,"a",12),e._uU(3," )\n")),2&i){const t=n.versionOrLayer;e.xp6(1),e.Q6J("ngIf",0!==t.versionNumber),e.xp6(1),e.Q6J("ngIf",0===t.versionNumber)}}function $C(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"boolean-field",30),e.NdJ("change",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3).list,_=e.oxw();return e.KtG(_.clickToggleVersionRendered(a,l))}),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.Q6J("value",o.versionIsRendered(t))("disable",!1)}}function WC(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onViewList(a.oid))}),e._UZ(1,"localize",14),e._uU(2),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.versionNumber," ")}}function XC(i,n){1&i&&e._UZ(0,"localize",16)}function ew(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onViewList(a.oid))}),e.YNc(1,XC,1,0,"localize",15),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",0===t.versionNumber)}}const Yy=function(i){return{"background-color":i}};function tw(i,n){if(1&i&&e._UZ(0,"div",31),2&i){const t=e.oxw().$implicit;e.Q6J("ngStyle",e.VKq(1,Yy,t.color))}}const nw=function(i,n){return{"fa-minus":i,"fa-plus":n}};function iw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",24)(2,"a",25),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(3).list,C=e.oxw();return e.KtG(C.toggleVersionLayer(l,_))}),e.ALo(3,"localize"),e.qZA(),e.YNc(4,$C,1,2,"boolean-field",26),e.TgZ(5,"div",27),e._UZ(6,"date-text",28),e._uU(7," ( "),e.YNc(8,WC,3,1,"a",12),e.YNc(9,ew,2,1,"a",12),e._uU(10," ) "),e.YNc(11,tw,1,3,"div",29),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Q6J("ngClass",e.WLB(9,nw,null!=t.layers&&t.layers.length>0,null==t.layers||0==t.layers.length))("title",e.lcZ(3,7,t.layers?"explorer.layerPanel.removeFromLegend":"explorer.layerPanel.addToLegend")),e.xp6(2),e.Q6J("ngIf",t.layers&&t.layers.length>0),e.xp6(2),e.Q6J("date",t.forDate),e.xp6(2),e.Q6J("ngIf",0!==t.versionNumber),e.xp6(1),e.Q6J("ngIf",0===t.versionNumber),e.xp6(2),e.Q6J("ngIf",null!=t.color)}}function ow(i,n){if(1&i&&(e.TgZ(0,"div",22),e.YNc(1,iw,12,12,"div",23),e.qZA()),2&i){const t=e.oxw(2).list;e.xp6(1),e.Q6J("ngForOf",t.versions)}}const rw=function(i,n){return{"fa-chevron-down":i,"fa-chevron-right":n}};function aw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"h4")(2,"a",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().list;return e.KtG(a.open=!a.open)}),e._UZ(3,"i",20),e._uU(4),e.qZA()(),e.YNc(5,ow,2,1,"div",21),e.qZA()}if(2&i){const t=e.oxw().list;e.xp6(3),e.Q6J("ngClass",e.WLB(3,rw,t.open,!t.open)),e.xp6(1),e.Oqu(t.label),e.xp6(1),e.Q6J("ngIf",t.open)}}function sw(i,n){1&i&&e.YNc(0,aw,6,6,"div",17),2&i&&e.Q6J("ngIf",n.list.versions.length>0)}const lw=function(i,n){return{"fa-compress":i,"fa-expand":n}};function cw(i,n){if(1&i){const t=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"i",32),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.setPanelSize(2===a.panelSize?1:2))}),e.ALo(1,"localize"),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.WLB(4,lw,2===t.panelSize,1===t.panelSize))("title",e.lcZ(1,2,2===t.panelSize?"explorer.resize.collapseLayerPanel":"explorer.resize.expandLayerPanel"))}}function uw(i,n){1&i&&e._UZ(0,"div",45)}function pw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",46),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.togglePinned(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"explorer.layerPanel.unpin"))}function dw(i,n){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.hij("- ",o.versionMap[t.getId()].forDate,"")}}function hw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(3);return e.KtG(l.onViewList(a.dataSource.getVersionId()))}),e._UZ(1,"localize",14),e._uU(2),e.qZA()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(2),e.hij(" ",o.versionMap[t.getId()].versionNumber," ")}}function fw(i,n){1&i&&e._UZ(0,"localize",16)}function gw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(3);return e.KtG(l.onViewList(a.dataSource.getVersionId()))}),e.YNc(1,fw,1,0,"localize",15),e.qZA()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",0===o.versionMap[t.getId()].versionNumber)}}function _w(i,n){if(1&i&&(e.ynx(0),e._uU(1," ( "),e.YNc(2,hw,3,1,"a",12),e.YNc(3,gw,2,1,"a",12),e._uU(4," ) "),e.BQk()),2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.Q6J("ngIf",0!==o.versionMap[t.getId()].versionNumber),e.xp6(1),e.Q6J("ngIf",0===o.versionMap[t.getId()].versionNumber)}}function mw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",47),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.togglePinned(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"explorer.layerPanel.pin"))}function yw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.onCreate(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"explorer.layerPanel.addNewGeoObject"))}function vw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",37)(1,"div",38),e.YNc(2,uw,1,0,"div",39),e.TgZ(3,"boolean-field",30),e.NdJ("change",function(){const l=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.toggleLayerRendered(l))}),e.qZA(),e.YNc(4,pw,2,3,"i",40),e.TgZ(5,"div",27),e._uU(6),e.YNc(7,dw,2,1,"span",10),e.YNc(8,_w,5,2,"ng-container",10),e._UZ(9,"div",31),e.TgZ(10,"i",41),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.onGotoBounds(l))}),e.ALo(11,"localize"),e.qZA(),e.YNc(12,mw,2,3,"i",42),e.YNc(13,yw,2,3,"i",43),e.TgZ(14,"i",44),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.removeLayer(l))}),e.ALo(15,"localize"),e.qZA()()()()}if(2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(3),e.Q6J("value",t.rendered)("disable",!1),e.xp6(1),e.Q6J("ngIf",t.dataSource.getDataSourceType()!==o.CONSTANTS.LIST_VECTOR_SOURCE_TYPE&&t.getPinned()),e.xp6(2),e.hij(" ",t.legendLabel," "),e.xp6(1),e.Q6J("ngIf",o.versionMap[t.getId()]),e.xp6(1),e.Q6J("ngIf",null!=o.versionMap[t.getId()]),e.xp6(1),e.Q6J("ngStyle",e.VKq(15,Yy,t.color)),e.xp6(1),e.Q6J("title",e.lcZ(11,11,"explorer.layerPanel.zoomToFeature")),e.xp6(2),e.Q6J("ngIf",t.dataSource.getDataSourceType()!==o.CONSTANTS.LIST_VECTOR_SOURCE_TYPE&&!t.getPinned()),e.xp6(1),e.Q6J("ngIf",o.versionMap[t.getId()]&&0===o.versionMap[t.getId()].versionNumber),e.xp6(1),e.Q6J("title",e.lcZ(15,13,"explorer.layerPanel.removeLayer"))}}function bw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"label",34),e._uU(2),e.qZA(),e.TgZ(3,"div",35),e.NdJ("cdkDropListDropped",function(a){const _=e.CHM(t).$implicit,C=e.oxw(2);return e.KtG(C.drop(a,_))}),e.YNc(4,vw,16,17,"div",36),e.qZA()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Oqu(t.getLabel()),e.xp6(2),e.Q6J("ngForOf",t.getLayers())}}function xw(i,n){if(1&i&&(e.O4$(),e.kcU(),e.TgZ(0,"div")(1,"div",33),e.YNc(2,bw,5,2,"div",23),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.layerGroups)}}function Cw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",66)(1,"input",67),e.NdJ("change",function(){const l=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.toggleBaseLayer(l))}),e.qZA(),e.TgZ(2,"label",68),e._UZ(3,"localize",69),e.qZA()()}if(2&i){const t=n.$implicit;e.xp6(1),e.Q6J("value",t.id)("checked",t.selected),e.xp6(2),e.Q6J("key",t.label)}}function ww(i,n){if(1&i&&(e.TgZ(0,"div",33)(1,"h4"),e._UZ(2,"localize",64),e.qZA(),e.YNc(3,Cw,4,3,"div",65),e.qZA()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.baseLayers)}}function Tw(i,n){1&i&&(e.TgZ(0,"p",70),e._UZ(1,"localize",71),e.qZA())}const Hy=function(i){return{list:i}};function Mw(i,n){if(1&i&&e.GkF(0,72),2&i){const t=e.oxw(2),o=e.MAs(3);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,Hy,t.graphList))}}function Ow(i,n){if(1&i&&e.GkF(0,72),2&i){const t=e.oxw().$implicit;e.oxw(6);const o=e.MAs(3);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,Hy,t))}}function Sw(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Ow,1,4,"ng-container",63),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t)}}function Pw(i,n){if(1&i&&(e.TgZ(0,"div",74)(1,"h4"),e._uU(2),e.qZA(),e.YNc(3,Sw,2,1,"div",23),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.typeLabel.localizedValue),e.xp6(1),e.Q6J("ngForOf",t.lists)}}function Ew(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Pw,4,2,"div",73),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.lists.length>0)}}function Aw(i,n){if(1&i&&(e.TgZ(0,"div",74)(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,Ew,2,1,"div",23),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.orgLabel.localizedValue),e.xp6(1),e.Q6J("ngForOf",t.types)}}function kw(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Aw,4,2,"div",73),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.types.length>0)}}function Iw(i,n){if(1&i){const t=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"div",49),e.YNc(1,ww,4,1,"div",50),e.TgZ(2,"form",51)(3,"fieldset",52)(4,"div",2)(5,"div",53)(6,"label"),e._UZ(7,"localize",54),e.qZA()(),e.TgZ(8,"div",55)(9,"label"),e._UZ(10,"localize",56),e.qZA()()(),e.TgZ(11,"div",2)(12,"div",53)(13,"date-field",57),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.form.startDate=a)}),e.qZA()(),e.TgZ(14,"div",55)(15,"date-field",58),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.form.endDate=a)}),e.qZA()(),e.TgZ(16,"div",59)(17,"button",60),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSearch())}),e.TgZ(18,"span"),e._UZ(19,"localize",61),e.qZA()()()(),e.TgZ(20,"div",2)(21,"div",3),e.YNc(22,Tw,2,0,"p",62),e.TgZ(23,"div",22),e.YNc(24,Mw,1,4,"ng-container",63),e.YNc(25,kw,2,1,"div",23),e.qZA()()()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.baseLayers.length>1),e.xp6(12),e.Q6J("value",t.form.startDate)("classNames","form-control")("allowFutureDates",!1),e.xp6(2),e.Q6J("value",t.form.endDate)("classNames","form-control")("allowFutureDates",!1),e.xp6(7),e.Q6J("ngIf",t.listOrgGroups.length<1),e.xp6(2),e.Q6J("ngIf",t.graphList),e.xp6(1),e.Q6J("ngForOf",t.listOrgGroups)}}class jh{constructor(n,t,o,a,l,_,C,N,F){this.route=n,this.router=t,this.spinner=o,this.service=a,this.geomService=l,this.registryService=_,this.vizService=C,this.localService=N,this.listService=F,this.draggable={data:"myDragData",effectAllowed:"all",disable:!1,handle:!1},this.CONSTANTS={OVERLAY:"layer-panel",SEARCH_DATASOURCE_TYPE:Tp,GEO_OBJECT_DATA_SOURCE_TYPE:il,RELATIONSHIP_VISUALIZER_DATASOURCE_TYPE:$i,LIST_VECTOR_SOURCE_TYPE:vs},this.filter=[],this.includeSearchLayer=!1,this.viewList=new e.vpe,this.baseLayerChange=new e.vpe,this.create=new e.vpe,this.panelSize=0,this.panelSizeChange=new e.vpe,this.listOrgGroups=[],this.layers=[],this.layerGroups=[],this.versionMap={},this.graphList=null,this.form={startDate:"",currentStartDate:"",endDate:"",currentEndDate:""},this.baseLayers=[{name:"Satellite",label:"baselayer.satellite",id:"satellite-v9",sprite:"mapbox://sprites/mapbox/satellite-v9",url:"mapbox://mapbox.satellite",selected:!0}],this.params=null}ngOnInit(){this.subscription=this.geomService.layersChange.subscribe(n=>{this.layersChange(n)})}ngOnDestroy(){this.subscription.unsubscribe()}setPanelSize(n){this.panelSize=n,0===this.layers.length&&1===this.panelSize&&(this.panelSize=2),this.panelSize>2&&(this.panelSize=0),this.panelSizeChange.emit(this.panelSize),this.router.navigate([],{relativeTo:this.route,queryParams:{layersPanelSize:this.panelSize},queryParamsHandling:"merge",replaceUrl:!0})}togglePanelOpen(){this.setPanelSize(0===this.panelSize?1:0)}layersChange(n){this.layers=this.geomService.getLayers(),this.layerGroups=new _c(this.localService).getLayerGroups(n);let t=this.layers.filter(o=>null==this.versionMap[o.getId()]&&o.dataSource.getDataSourceType()===vs).map(o=>o.dataSource.getVersionId());t.length>0&&this.service.fetchVersionsAsListVersion(t).then(o=>{o.forEach(a=>{let l=this.layers.filter(_=>_.dataSource.getDataSourceType()===vs&&_.dataSource.getVersionId()===a.oid);a.layers=l,l.forEach(_=>{this.versionMap[_.getId()]=a})})}),this.refreshListLayerReferences()}handleSearch(){return this.spinner.show(this.CONSTANTS.OVERLAY),this.service.getGeospatialVersions(this.form.startDate,this.form.endDate).then(n=>(this.form.currentStartDate=this.form.startDate,this.form.currentEndDate=this.form.endDate,this.listOrgGroups=n,this.refreshListLayerReferences(),n)).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)})}refreshListLayerReferences(){this.listOrgGroups.forEach(n=>{n.types.forEach(t=>{t.lists.forEach(o=>{o.versions=o.versions.filter(a=>-1===this.filter.indexOf(a.oid));for(let a=0;a<o.versions.length;++a){let l=o.versions[a],_=this.layers.filter(C=>C.dataSource.getDataSourceType()===vs&&C.dataSource.getVersionId()===l.oid);l.layers=_,_.forEach(C=>{this.versionMap[C.getId()]=l})}})})});for(const[,n]of Object.entries(this.versionMap)){let t=n,o=this.layers.filter(a=>a.dataSource.getDataSourceType()===vs&&a.dataSource.getVersionId()===t.oid);t.layers=o}}clickToggleVersionRendered(n,t){let o=!this.versionIsRendered(n);null!=n.layers&&n.layers.forEach(a=>{a.rendered!==o&&this.toggleLayerRendered(a)})}toggleLayerRendered(n){n.rendered=!n.rendered,this.geomService.addOrUpdateLayer(n)}onGotoBounds(n){let t=this.geomService.getLayers().filter(o=>o.getId()===n.getId());t.length>0&&this.geomService.zoomToLayer(t[0])}togglePinned(n){let t=this.geomService.getLayers(),o=this.geomService.getLayers().findIndex(a=>a.getId()===n.getId());if(-1!==o){let a=t[o];a.setPinned(!a.getPinned()),this.geomService.setLayers(t)}}onCreate(n){this.create.emit(n)}toggleVersionLayer(n,t){if(n.layers&&0!=n.layers.length)n.layers.forEach(o=>{this.geomService.removeLayer(o.getId()),delete this.versionMap[o.getId()]}),delete n.layers;else{let o=new xc(this.listService,n.oid);n.layers=[o.createLayer(t.label,!0,bl().hexString())],this.versionMap[n.layers[0].getId()]=n,this.geomService.addOrUpdateLayer(n.layers[0])}}removeLayer(n){this.geomService.removeLayer(n.getId());let t=this.versionMap[n.getId()];t&&(delete this.versionMap[n.getId()],t.layers=t.layers.filter(o=>o.getId()!==n.getId()))}versionIsRendered(n){if(!n.layers||0==n.layers.length)return!1;let t=!1;for(let o=0;o<n.layers.length;++o)t=t||n.layers[o].rendered;return t}toggleBaseLayer(n){this.baseLayers.forEach(t=>{t.selected=!1}),n.selected=!0,this.baseLayerChange.emit(n)}drop(n,t){At(t.getLayers(),n.previousIndex,n.currentIndex);let o=[];this.layerGroups.forEach(a=>a.getLayers().forEach(l=>o.push(l))),this.geomService.setLayers(o)}onViewList(n){this.viewList.emit(n)}}jh.\u0275fac=function(n){return new(n||jh)(e.Y36(w.gz),e.Y36(w.F0),e.Y36(Nn),e.Y36(Uo),e.Y36(vo),e.Y36(Zi),e.Y36(Xa),e.Y36(mo.o),e.Y36(Uo))},jh.\u0275cmp=e.Xpm({type:jh,selectors:[["layer-panel"]],inputs:{filter:"filter",includeSearchLayer:"includeSearchLayer",visualizeMode:"visualizeMode",panelSize:"panelSize"},outputs:{viewList:"viewList",baseLayerChange:"baseLayerChange",create:"create",panelSizeChange:"panelSizeChange"},decls:18,vars:8,consts:[["versionDetail",""],["listView",""],[1,"row"],[1,"col-md-12"],[1,"layer-toggle"],["type","ball-clip-rotate-multiple","size","medium",3,"fullScreen","name"],[1,"clickable",2,"width","27px","height","27px","float","right","margin","5px",3,"title","click"],["version","1.1","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","viewBox","0 0 122.88 105.02",0,"xml","space","preserve",2,"enable-background","new 0 0 122.88 105.02"],["d","M97.25,40.58l23.85,10.28c1.48,0.64,2.17,2.36,1.53,3.85c-0.32,0.75-0.93,1.3-1.63,1.57l-23.19,9.39l23.29,10.04 c1.48,0.64,2.17,2.36,1.53,3.84c-0.32,0.75-0.93,1.3-1.63,1.57l-58.52,23.69c-0.73,0.3-1.52,0.27-2.2,0L1.83,81.05 c-1.5-0.61-2.22-2.31-1.61-3.81c0.33-0.82,0.99-1.4,1.76-1.67l22.97-9.96l-23.12-9.4c-1.5-0.61-2.22-2.31-1.61-3.81 c0.33-0.82,0.99-1.4,1.76-1.67l23.53-10.21L1.83,30.9c-1.5-0.61-2.22-2.31-1.61-3.81c0.33-0.82,0.99-1.4,1.76-1.67L60.02,0.24 c0.77-0.33,1.6-0.31,2.31,0l0-0.01l58.77,25.32c1.48,0.64,2.17,2.36,1.53,3.84c-0.32,0.75-0.93,1.3-1.63,1.57L97.25,40.58 L97.25,40.58z M112.36,53.47l-22.73-9.79L62.49,54.66c-0.73,0.3-1.52,0.27-2.2,0L33.08,43.6L10.47,53.4L61.39,74.1L112.36,53.47 L112.36,53.47z M90.19,68.75l-27.7,11.21c-0.73,0.3-1.52,0.27-2.2,0L32.52,68.68l-22.05,9.56l50.92,20.69l50.97-20.63L90.19,68.75 L90.19,68.75z M61.17,6.1l-50.7,21.99l50.92,20.69l50.97-20.63L61.17,6.1L61.17,6.1z"],["class","clickable fa","style","width:30px;height:30px;margin-right:5px;font-size:25px;padding:5px;",3,"ngClass","title","click",4,"ngIf"],[4,"ngIf"],["style","margin-top: 10px;",4,"ngIf"],["routerLinkActive","active",3,"click",4,"ngIf"],["routerLinkActive","active",3,"click"],["key","list.type.version"],["key","list.type.working.version",4,"ngIf"],["key","list.type.working.version"],["class","list-group-item","style","border: none; padding-top:0; padding-bottom:0;",4,"ngIf"],[1,"list-group-item",2,"border","none","padding-top","0","padding-bottom","0"],[3,"click"],[1,"fa","fa-chevron-right",2,"font-size","14px",3,"ngClass"],["class","list-group",4,"ngIf"],[1,"list-group"],[4,"ngFor","ngForOf"],[1,"layer-toggle-wrapper"],[1,"fa",2,"padding-right","10px",3,"ngClass","title","click"],["label","","style","line-height:0;",3,"value","disable","change",4,"ngIf"],[1,"label-wrapper"],[3,"date"],["class","layer-legend-square","style","width:15px;height:15px;display:inline-block;vertical-align:middle;",3,"ngStyle",4,"ngIf"],["label","",2,"line-height","0",3,"value","disable","change"],[1,"layer-legend-square",2,"width","15px","height","15px","display","inline-block","vertical-align","middle",3,"ngStyle"],[1,"clickable","fa",2,"width","30px","height","30px","margin-right","5px","font-size","25px","padding","5px",3,"ngClass","title","click"],[2,"margin-bottom","10px"],[2,"font-weight","bold"],["cdkDropList","",1,"list-group",3,"cdkDropListDropped"],["class","list-group-item","style","padding:5px;","cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag","",1,"list-group-item",2,"padding","5px"],[1,"layer-toggle-wrapper",2,"cursor","move"],["class","custom-placeholder",4,"cdkDragPlaceholder"],["class","fa fa-thumb-tack","aria-hidden","true","style","cursor: pointer;",3,"title","click",4,"ngIf"],["aria-hidden","true",1,"fa","fa-eye",3,"title","click"],["class","fa fa-thumb-tack","aria-hidden","true",3,"title","click",4,"ngIf"],["class","fa fa-plus","aria-hidden","true",3,"title","click",4,"ngIf"],["aria-hidden","true",1,"fa","fa-times",3,"title","click"],[1,"custom-placeholder"],["aria-hidden","true",1,"fa","fa-thumb-tack",2,"cursor","pointer",3,"title","click"],["aria-hidden","true",1,"fa","fa-thumb-tack",3,"title","click"],["aria-hidden","true",1,"fa","fa-plus",3,"title","click"],[2,"margin-top","10px"],["style","margin-bottom: 10px;",4,"ngIf"],["name","export-form",1,"modal-form",2,"overflow","visible"],[2,"padding","10px"],[1,"col-md-4",2,"padding-left","10px","padding-right","0"],["key","io.startDate"],[1,"col-md-4",2,"padding-left","5px","padding-right","0"],["key","io.endDate"],["label","","inputName","startDate","name","startDate",3,"value","classNames","allowFutureDates","valueChange"],["label","","inputName","endDate","name","endDate",3,"value","classNames","allowFutureDates","valueChange"],[1,"col-md-4",2,"text-align","center","padding-left","5px"],["type","button","role","button",1,"btn","btn-primary",2,"width","100%",3,"click"],["key","explorer.find.layers.by.date.range.button"],["style","font-style: italic; color: grey;",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["key","explorer.base.layers.label"],["class","row-form",4,"ngFor","ngForOf"],[1,"row-form"],["type","radio","name","baselayers",1,"layer-toggle-input",3,"value","checked","change"],[1,"layer-toggle-label"],[3,"key"],[2,"font-style","italic","color","grey"],["key","explorer.find.layers.no.layers.found.message"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","list-group-item","style","border: none;",4,"ngIf"],[1,"list-group-item",2,"border","none"]],template:function(n,t){1&n&&(e.YNc(0,KC,4,2,"ng-template",null,0,e.W1O),e.YNc(2,sw,1,1,"ng-template",null,1,e.W1O),e.TgZ(4,"div",2)(5,"div",3)(6,"div",4),e._UZ(7,"ngx-spinner",5),e.TgZ(8,"div",2)(9,"div",3)(10,"span",6),e.NdJ("click",function(){return t.togglePanelOpen()}),e.ALo(11,"localize"),e.O4$(),e.TgZ(12,"svg",7)(13,"g"),e._UZ(14,"path",8),e.qZA()()(),e.YNc(15,cw,2,7,"i",9),e.qZA()(),e.YNc(16,xw,3,1,"div",10),e.YNc(17,Iw,26,10,"div",11),e.qZA()()()),2&n&&(e.xp6(7),e.Q6J("fullScreen",!1)("name",t.CONSTANTS.OVERLAY),e.xp6(3),e.Q6J("title",e.lcZ(11,6,0===t.panelSize?"explorer.resize.openLayerPanel":"explorer.resize.closeLayerPanel")),e.xp6(5),e.Q6J("ngIf",2===t.panelSize&&t.layers.length>0||1===t.panelSize),e.xp6(1),e.Q6J("ngIf",0!==t.panelSize&&t.layers.length>0),e.xp6(1),e.Q6J("ngIf",2===t.panelSize))},dependencies:[T.mk,T.sg,T.O5,T.tP,T.PC,w.Od,y._Y,y.JL,y.F,Sn.l,rl.M,Xl.Q,Fr.u,Ta,Jr,Bo,Wi,ia.F],styles:[".map-button.visualize-mode-toggle[_ngcontent-%COMP%]{padding:14px 7px 5px 5px}.visualize-mode-toggle.map[_ngcontent-%COMP%], .visualize-mode-toggle.hierarchy[_ngcontent-%COMP%]{right:50px}.visualize-mode-hierarchy[_ngcontent-%COMP%]{color:#000}.visualize-mode-toggle[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:25px}.map-view-port[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.base-layer-panel[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;z-index:3;padding:5px}.map-button[_ngcontent-%COMP%]{background-color:#fff;margin:0 0 20px;padding:0;z-index:1001;border-radius:4px;width:46px;width:-moz-fit-content;width:fit-content}.map-button-icon[_ngcontent-%COMP%]{font-size:12px;text-align:center;width:38px;height:30px;vertical-align:middle}.map-button-icon[_ngcontent-%COMP%] > span.glyphicon[_ngcontent-%COMP%]{line-height:30px}.site-explorer-list[_ngcontent-%COMP%]{padding:20px;height:calc(100vh - 106px);overflow-y:auto;overflow-x:hidden}.location-management-widget-section[_ngcontent-%COMP%]{margin:5px 0}.location-management-widget-section[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{float:none!important}.list-group-item[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #ddd;margin-bottom:0}.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.breadcrumb[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;margin:0}.layer-toggle[_ngcontent-%COMP%]{background:#fff;padding:5px;border-radius:4px;width:-moz-fit-content;width:fit-content;max-height:calc(100vh - 175px);overflow-y:auto;overflow-x:clip}.layer-toggle[_ngcontent-%COMP%]   .fa-bars[_ngcontent-%COMP%]{cursor:pointer}.layer-toggle[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:27px;height:27px}.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:5px}.arrow[_ngcontent-%COMP%]{border:solid black;border-width:0 1px 1px 0;display:inline-block;padding:5px}.arrow-right[_ngcontent-%COMP%]{transform:rotate(-45deg);-webkit-transform:rotate(-45deg)}.arrow-down[_ngcontent-%COMP%]{transform:rotate(45deg);-webkit-transform:rotate(45deg)}.fa.fa-arrow-left[_ngcontent-%COMP%]:before{margin-right:5px}.panel-toggle[_ngcontent-%COMP%]{position:absolute;padding:15px 0;background-color:#fff;z-index:9;width:100%;border-color:#6ba542;border-color:var(--theme-input-text-border-active);outline:0;box-shadow:inset 0 1px 1px #00000014,0 0 8px #6ba54299}[_nghost-%COMP%]  .panel-toggle input.date-input-element{border-radius:5px 0 0 5px;border:1px solid #ccc}.panel-toggle.detached[_ngcontent-%COMP%]{border-radius:3px;margin:10px 0 10px 10px;padding:5px}.panel-toggle.detached[_ngcontent-%COMP%] > .col-md-12[_ngcontent-%COMP%]{padding-right:0;padding-left:0}.layer-toggle-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:left;align-items:center;margin:3px 0;padding-left:20px}.label-wrapper[_ngcontent-%COMP%]{margin-left:5px;display:inline-block}.label-wrapper[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{vertical-align:middle}.label-wrapper[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]:hover{color:#6ba542;color:var(--theme-submit-button-color);cursor:pointer}.full-height-sidebar[_ngcontent-%COMP%]{height:calc(100vh - 120px);overflow:auto;top:70px;background:white}.full-height-sidebar.max-height[_ngcontent-%COMP%]{height:calc(100vh - 50px);top:0}.collapse-sidebar[_ngcontent-%COMP%], .collapse-sidebar[_ngcontent-%COMP%]   [class*=col-][_ngcontent-%COMP%]{width:10px;overflow:visible;padding:0}.collapse-sidebar[_ngcontent-%COMP%]   .panel-toggle[_ngcontent-%COMP%]{display:none}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.custom-placeholder[_ngcontent-%COMP%]{background:#ccc;border:dotted 3px #999;min-height:40px;transition:transform .25s cubic-bezier(0,0,.2,1)}.col-fixed-50[_ngcontent-%COMP%]{width:50px;position:fixed;height:100%}",".layer-toggle-wrapper[_ngcontent-%COMP%]{padding-left:0}"]});const Zw=["attributeEditor"];function Nw(i,n){if(1&i&&e._UZ(0,"geoobject-shared-attribute-editor",10,11),2&i){const t=e.oxw(3);e.Q6J("geoObjectType",t.type)("postGeoObject",t.postGeoObject)("isNew",t.isNew)("isGeometryInlined",!1)("hierarchies",t.hierarchies)("readOnly",!t.isEdit)("requestedDate",t.forDate)("datasetId",t.datasetId)}}function Lw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"label"),e._UZ(2,"localize",13),e.qZA(),e.TgZ(3,"textarea",14),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.reason=a)}),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(3),e.Q6J("ngModel",t.reason)}}function zw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onEditAttributes())}),e._UZ(1,"localize",16),e.qZA()}}function Dw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onCancelInternal())}),e._UZ(1,"localize",18),e.qZA()}}function Rw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onSubmit())}),e._UZ(1,"localize",20),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("disabled",!t.canSubmit()),e.xp6(1),e.Q6J("key",t.isMaintainer?"modal.button.submit":"change.request.page.title")}}function Fw(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Nw,2,8,"geoobject-shared-attribute-editor",4),e.YNc(2,Lw,4,1,"div",5),e.TgZ(3,"div",6),e.YNc(4,zw,2,0,"button",7),e.YNc(5,Dw,2,0,"button",8),e.YNc(6,Rw,2,2,"button",9),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.hierarchies&&t.postGeoObject),e.xp6(1),e.Q6J("ngIf",t.isEdit&&!t.isMaintainer),e.xp6(2),e.Q6J("ngIf",!t.readOnly&&!t.isEdit),e.xp6(1),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",t.isEdit)}}function Uw(i,n){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"ngx-spinner",1),e.TgZ(2,"div",2)(3,"div",3)(4,"h3"),e._uU(5),e.qZA()()(),e.YNc(6,Fw,7,5,"div",0),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("fullScreen",!1)("name",t.CONSTANTS.OVERLAY),e.xp6(4),e.Oqu(t.type.label.localizedValue),e.xp6(1),e.Q6J("ngIf",t.mode==t.MODE.ATTRIBUTES&&null!=t.postGeoObject)}}class bd{constructor(n,t,o,a,l){this.service=n,this.spinner=t,this.modalService=o,this.authService=a,this.geometryService=l,this.MODE={VERSIONS:"VERSIONS",ATTRIBUTES:"ATTRIBUTES",HIERARCHY:"HIERARCHY",GEOMETRY:"GEOMETRY"},this.CONSTANTS={OVERLAY:"feature-panel"},this.forDateChange=new e.vpe,this.readOnly=!1,this.featureChange=new e.vpe,this.modeChange=new e.vpe,this.panelCancel=new e.vpe,this.panelSubmit=new e.vpe,this._isValid=!0,this.mode=null,this.attribute=null,this.isNew=!1,this.isEdit=!1,this.hierarchy=null,this.reason=""}ngOnInit(){this.isMaintainer=this.authService.isSRA()||this.authService.isOrganizationRA(this.type.organizationCode)||this.authService.isGeoObjectTypeOrSuperRM(this.type),this.mode="ATTRIBUTES"}ngOnChanges(n){(null!=n.type||null!=n.code)&&this.refresh()}setValid(n){this._isValid=n}isValid(){return this._isValid&&this.attributeEditor&&this.attributeEditor.isValid()}updateCode(n){this.code=n}refresh(){this.postGeoObject=null,this.preGeoObject=null,this.hierarchies=null,null!=this.code&&null!=this.type&&("__NEW__"!==this.code?(this.isNew=!1,this.spinner.show(this.CONSTANTS.OVERLAY),this.service.getGeoObjectOverTime(this.code,this.type.code).then(n=>{this.preGeoObject=new kp(this.type,JSON.parse(JSON.stringify(n)).attributes),this.postGeoObject=new kp(this.type,JSON.parse(JSON.stringify(this.preGeoObject)).attributes)}).catch(n=>{this.error(n)}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)}),this.spinner.show(this.CONSTANTS.OVERLAY),this.service.getHierarchiesForGeoObject(this.code,this.type.code,!1).then(n=>{this.hierarchies=n}).catch(n=>{this.error(n)}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)})):(this.isNew=!0,this.spinner.show(this.CONSTANTS.OVERLAY),this.service.newGeoObjectOverTime(this.type.code,!1).then(n=>{this.preGeoObject=new kp(this.type,n.geoObject.attributes),this.postGeoObject=new kp(this.type,JSON.parse(JSON.stringify(this.preGeoObject)).attributes),this.hierarchies=n.hierarchies,this.setEditMode(!0)}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)})))}editorForDateChange(n){this.forDateChange.emit(n)}onCancelInternal(){this.panelCancel.emit()}canSubmit(){return this.isValid()&&(this.isMaintainer||this.reason&&this.reason.trim().length>0)&&(this.isNew||this.attributeEditor&&this.attributeEditor.getChangeRequestEditor().hasChanges())}onSubmit(){if(this.isNew){const n=this.attributeEditor.getActions()[0];this.spinner.show(this.CONSTANTS.OVERLAY),this.service.applyGeoObjectCreate(n.parentJson,n.geoObjectJson,this.isNew,this.datasetId,this.reason,!1).then(t=>{t.isChangeRequest||this.featureChange.emit(this.postGeoObject),this.panelSubmit.emit(t)}).catch(t=>{this.error(t)}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)})}else this.spinner.show(this.CONSTANTS.OVERLAY),this.service.applyGeoObjectEdit(this.postGeoObject.attributes.code,this.type.code,this.attributeEditor.getActions(),this.datasetId,this.reason,!1).then(n=>{n.isChangeRequest||this.featureChange.emit(this.postGeoObject),this.panelSubmit.emit(n)}).catch(n=>{this.error(n)}).finally(()=>{this.spinner.hide(this.CONSTANTS.OVERLAY)});this.geometryService.stopEditing()}onManageAttributeVersion(n){this.attribute=n,this.mode=this.MODE.VERSIONS}onManageHiearchyVersion(n){this.hierarchy=n,this.mode=this.MODE.HIERARCHY}onEditAttributes(){this.setEditMode(!this.isEdit)}setEditMode(n){this.isEdit=n,this.reason=null,this.modeChange.emit(this.isEdit)}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}bd.\u0275fac=function(n){return new(n||bd)(e.Y36(Zi),e.Y36(Nn),e.Y36(Ln.tT),e.Y36(nn.e8),e.Y36(vo))},bd.\u0275cmp=e.Xpm({type:bd,selectors:[["feature-panel"]],viewQuery:function(n,t){if(1&n&&e.Gf(Zw,5),2&n){let o;e.iGM(o=e.CRH())&&(t.attributeEditor=o.first)}},inputs:{datasetId:"datasetId",type:"type",forDate:"forDate",readOnly:"readOnly",code:"code"},outputs:{forDateChange:"forDateChange",featureChange:"featureChange",modeChange:"modeChange",panelCancel:"panelCancel",panelSubmit:"panelSubmit"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],["type","ball-clip-rotate-multiple","size","medium",3,"fullScreen","name"],[1,"row"],[1,"col-md-12"],[3,"geoObjectType","postGeoObject","isNew","isGeometryInlined","hierarchies","readOnly","requestedDate","datasetId",4,"ngIf"],["class","form-group","style","z-index: 0;",4,"ngIf"],[1,"button-holder","text-right",2,"margin-bottom","20px"],["type","submit","class","btn btn-primary","style","width:100%;","role","button",3,"click",4,"ngIf"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],[3,"geoObjectType","postGeoObject","isNew","isGeometryInlined","hierarchies","readOnly","requestedDate","datasetId"],["attributeEditor",""],[1,"form-group",2,"z-index","0"],["key","change.request.reason.label"],["rows","4","cols","50","name","reason-input","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","role","button",1,"btn","btn-primary",2,"width","100%",3,"click"],["key","changeovertime.manageVersions.button.label"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],[3,"key"]],template:function(n,t){1&n&&e.YNc(0,Uw,7,4,"div",0),2&n&&e.Q6J("ngIf",t.type)},styles:["#hierarchy-tree-container[_ngcontent-%COMP%]{height:calc(100vh - 429px);overflow-y:auto}.location-management-widget-section[_ngcontent-%COMP%]{margin:5px 0}.location-management-widget-section[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{float:none!important}.list-group-item[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #ddd;margin-bottom:0}.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.breadcrumb[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;margin:0}.layer-toggle[_ngcontent-%COMP%]{cursor:pointer;background:#fff;padding:8px;border-radius:4px;width:-moz-fit-content;width:fit-content}.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:5px}#attributes-header[_ngcontent-%COMP%]{background:#adadad;padding:2px 15px;margin:10px 0;color:#fff;border-radius:3px}"]});class Bh{transform(n){return n&&new Date(n).getTime()}}Bh.\u0275fac=function(n){return new(n||Bh)},Bh.\u0275pipe=e.Yjl({name:"toEpochDateTime",type:Bh,pure:!0});class su{constructor(n,t){this.http=n,this.eventService=t}getPage(n,t,o){let a=new ot.LE;return a=a.set("pageSize",n.toString()),a=a.set("pageNumber",t.toString()),a=a.set("attrConditions",JSON.stringify(o)),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/transition-event/page",{params:a}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getDetails(n){let t=new ot.LE;return t=t.set("oid",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/transition-event/get-details",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}apply(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/transition-event/apply",JSON.stringify({event:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}delete(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/transition-event/delete",JSON.stringify({eventId:n.oid}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getHistoricalReport(n,t,o,a,l){let _=new ot.LE;return _=_.set("typeCode",n.toString()),_=_.set("startDate",t.toString()),_=_.set("endDate",o.toString()),_=_.set("pageSize",a.toString()),_=_.set("pageNumber",l.toString()),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/transition-event/historical-report",{params:_}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}}su.\u0275fac=function(n){return new(n||su)(e.LFG(ot.eN),e.LFG(nn.PO))},su.\u0275prov=e.Yz7({token:su,factory:su.\u0275fac});class tc{constructor(n,t){this.http=n,this.eventService=t}getByOrganization(){let n=new ot.LE;return this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/business-type/get-by-org",{params:n}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}getAll(){let n=new ot.LE;return this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/business-type/get-all",{params:n}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}get(n){let t=new ot.LE;return t=t.append("oid",n),this.eventService.start(),this.http.get(pt.N.apiUrl+"/api/business-type/get",{params:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}apply(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/apply",JSON.stringify({type:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}remove(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/remove",JSON.stringify({oid:n.oid}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}edit(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/edit",JSON.stringify({oid:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}unlock(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/unlock",JSON.stringify({oid:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}addAttributeType(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/add-attribute",JSON.stringify({typeCode:n,attributeType:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}updateAttributeType(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/update-attribute",JSON.stringify({typeCode:n,attributeType:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}deleteAttributeType(n,t){let o=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/business-type/remove-attribute",JSON.stringify({typeCode:n,attributeName:t}),{headers:o}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}page(n,t){let o=new ot.LE;return o=o.set("criteria",JSON.stringify(n)),o=o.set("typeCode",t.typeCode),this.http.get(pt.N.apiUrl+"/api/business-type/data",{params:o}).toPromise()}}tc.\u0275fac=function(n){return new(n||tc)(e.LFG(ot.eN),e.LFG(nn.PO))},tc.\u0275prov=e.Yz7({token:tc,factory:tc.\u0275fac});var qw=v(71884);const Jw=function(i,n){return{row:i,"row-holder":n}},jw=function(i){return{"col-md-12":i}},Bw=function(i){return{"label-holder":i}},Gw=function(i){return{holder:i}};function Vw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",1)(2,"div",1)(3,"div",2)(4,"div",1)(5,"label"),e._UZ(6,"localize",3),e.TgZ(7,"span",4),e._uU(8,"\xa0("),e._UZ(9,"convert-key-label",3),e._uU(10,")"),e.qZA()()(),e.TgZ(11,"div",1)(12,"span",5)(13,"textarea",6),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()()()()()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(9,Jw,o.inlinelayout,!o.inlinelayout)),e.xp6(1),e.Q6J("ngClass",e.VKq(12,jw,o.inlinelayout)),e.xp6(2),e.Q6J("ngClass",e.VKq(14,Bw,!o.inlinelayout)),e.xp6(2),e.Q6J("key",o.key),e.xp6(3),e.Q6J("key",t.locale),e.xp6(2),e.Q6J("ngClass",e.VKq(16,Gw,!o.inlinelayout)),e.xp6(2),e.Q6J("ngModel",t.value)("disabled",o.disabled)("name","description-"+t.locale)}}class lu{constructor(){this.key="",this.disabled=!1,this.inlinelayout=!1,this.valueChange=new e.vpe}}function Yw(i,n){if(1&i&&(e.TgZ(0,"div",40),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function Hw(i,n){1&i&&e._UZ(0,"localize",41)}function Qw(i,n){1&i&&e._UZ(0,"localize",42)}function Kw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"label",43),e._UZ(2,"localize",44),e.TgZ(3,"span",45),e._uU(4,"\xa0("),e._UZ(5,"convert-key-label",46),e._uU(6,")"),e.qZA()(),e.TgZ(7,"input",47),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(5),e.Q6J("key",t.locale),e.xp6(2),e.Q6J("disabled",o.readOnly)("ngModel",t.value)("name","label-"+t.locale)}}function $w(i,n){if(1&i&&(e.TgZ(0,"option",50),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label.localizedValue)}}function Ww(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",48),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.hierarchyType.organizationCode=a)}),e._UZ(1,"option"),e.YNc(2,$w,2,2,"option",49),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.edit||t.readOnly)("ngModel",t.hierarchyType.organizationCode),e.xp6(2),e.Q6J("ngForOf",t.organizations)}}function Xw(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",51)(1,"input",52),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.organizationLabel=a)}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.organizationLabel)}}function eT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",51)(1,"input",52),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.organizationLabel=a)}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.organizationLabel)}}function tT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleOnSubmit())}),e._UZ(1,"localize",54),e.qZA()}if(2&i){const t=e.oxw(),o=e.MAs(3);e.Q6J("disabled",t.hierarchyType.code.length<1||o.invalid)}}lu.\u0275fac=function(n){return new(n||lu)},lu.\u0275cmp=e.Xpm({type:lu,selectors:[["localized-text"]],inputs:{key:"key",value:"value",disabled:"disabled",inlinelayout:"inlinelayout"},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"form-group"],[3,"key"],[2,"color","#BABABA"],[1,"text"],[3,"ngModel","disabled","name","ngModelChange"]],template:function(n,t){1&n&&e.YNc(0,Vw,14,18,"div",0),2&n&&e.Q6J("ngForOf",t.value.localeValues)},dependencies:[T.mk,T.sg,y.Fj,y.JJ,y.On,Sn.l,al.j],styles:["textarea[_ngcontent-%COMP%]{width:100%;border-radius:5px;min-height:70px}"]});class xd{constructor(n,t,o,a,l){this.lService=n,this.auth=t,this.registryService=o,this.hierarchyService=a,this.bsModalRef=l,this.organizations=[],this.message=null,this.edit=!1,this.readOnly=!1}ngOnInit(){this.onHierarchytTypeCreate=new pn.x,this.hierarchyType={code:"",label:this.lService.create(),description:this.lService.create(),rootGeoObjectTypes:[],organizationCode:""},this.registryService.getOrganizations().then(n=>{if(this.readOnly)this.organizations=n;else{this.organizations=[];for(var t=0;t<n.length;++t)this.auth.isOrganizationRA(n[t].code)&&this.organizations.push(n[t])}this.edit||1!==this.organizations.length?(this.edit||this.readOnly)&&(this.organizationLabel=this.getOrganizationLabelFromCode(this.hierarchyType.organizationCode)):(this.hierarchyType.organizationCode=this.organizations[0].code,this.organizationLabel=this.organizations[0].label.localizedValue)}).catch(n=>{this.error(n)})}getOrganizationLabelFromCode(n){for(var t=0;t<this.organizations.length;++t)if(this.organizations[t].code===n)return this.organizations[t].label.localizedValue;return console.log("Did not find org with code ["+n+"]"),n}handleOnSubmit(){this.message=null,this.readOnly?this.bsModalRef.hide():this.edit?this.hierarchyService.updateHierarchyType(this.hierarchyType).then(n=>{this.onHierarchytTypeCreate.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)}):this.hierarchyService.createHierarchyType(this.hierarchyType).then(n=>{this.onHierarchytTypeCreate.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function nT(i,n){if(1&i&&(e.TgZ(0,"div",44),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function iT(i,n){1&i&&e._UZ(0,"localize",45)}function oT(i,n){1&i&&e._UZ(0,"localize",46)}function rT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"label"),e._UZ(2,"localize",47),e.TgZ(3,"span",48),e._uU(4,"\xa0("),e._UZ(5,"convert-key-label",49),e._uU(6,")"),e.qZA()(),e.TgZ(7,"input",50),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()}if(2&i){const t=n.$implicit;e.xp6(5),e.Q6J("key",t.locale),e.xp6(2),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("required","defaultLocale"===t.locale)}}function aT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",16)(2,"div",9)(3,"label",17),e._UZ(4,"localize",51),e.qZA(),e.TgZ(5,"div",19)(6,"boolean-field",20),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.geoObjectType.isAbstract=a)}),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("disable",!0)("value",t.geoObjectType.isAbstract)("localizeLabelKey","attribute.isAbstract.label")}}xd.\u0275fac=function(n){return new(n||xd)(e.Y36(nn.oQ),e.Y36(nn.e8),e.Y36(Zi),e.Y36(Wl),e.Y36(Ln.UZ))},xd.\u0275cmp=e.Xpm({type:xd,selectors:[["create-hierarchy-type-modal"]],decls:63,vars:29,consts:[[1,"modal-body"],[1,"modal-form"],["form","ngForm"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","hierarchy.management.create.hierarchy.title",4,"ngIf"],["key","hierarchy.management.update.hierarchy.title",4,"ngIf"],[1,"form-group"],["for","codeInput"],["key","data.property.label.code"],["name","code","type","input","id","codeInput","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["key","data.property.label.description",3,"value","inlinelayout","disabled","valueChange"],["for","organization"],["key","attribute.organization.label"],["class","select-area","name","organization","required","",3,"disabled","ngModel","ngModelChange",4,"ngIf"],["class","text",4,"ngIf"],["key","data.property.label.progress"],["name","progress",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.acknowledgement"],["name","acknowledgement",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.disclaimer"],["name","disclaimer","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.accessConstraints"],["name","accessConstraints","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.useConstraints"],["name","useConstraints","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.contact"],["key","data.property.label.contact"],["name","contact","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.phoneNumber"],["name","phoneNumber","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","data.property.label.email"],["name","email","type","email",1,"form-control",3,"ngModel","disabled","ngModelChange"],[1,"row"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],["key","modal.button.cancel"],["type","submit","class","btn btn-primary","style","padding: 4px 18px;",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["key","hierarchy.management.create.hierarchy.title"],["key","hierarchy.management.update.hierarchy.title"],["for","labelInput"],["key","data.property.label.label"],[2,"color","#BABABA"],[3,"key"],["type","input","required","",1,"form-control",3,"disabled","ngModel","name","ngModelChange"],["name","organization","required","",1,"select-area",3,"disabled","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary",2,"padding","4px 18px",3,"disabled","click"],["key","modal.button.ok"]],template:function(n,t){1&n&&(e.TgZ(0,"form")(1,"div",0)(2,"form",1,2),e.YNc(4,Yw,2,1,"div",3),e.TgZ(5,"div",4)(6,"h1"),e.YNc(7,Hw,1,0,"localize",5),e.YNc(8,Qw,1,0,"localize",6),e.qZA()(),e.TgZ(9,"div",7)(10,"label",8),e._UZ(11,"localize",9),e.qZA(),e.TgZ(12,"input",10),e.NdJ("ngModelChange",function(a){return t.hierarchyType.code=a}),e.qZA()(),e.YNc(13,Kw,8,4,"div",11),e.TgZ(14,"localized-text",12),e.NdJ("valueChange",function(a){return t.hierarchyType.description=a}),e.qZA(),e.TgZ(15,"div",7)(16,"label",13),e._UZ(17,"localize",14),e.qZA(),e.YNc(18,Ww,3,3,"select",15),e.YNc(19,Xw,2,1,"span",16),e.YNc(20,eT,2,1,"span",16),e.qZA(),e.TgZ(21,"div",7)(22,"label"),e._UZ(23,"localize",17),e.qZA(),e.TgZ(24,"textarea",18),e.NdJ("ngModelChange",function(a){return t.hierarchyType.progress=a}),e.qZA()(),e.TgZ(25,"div",7)(26,"label"),e._UZ(27,"localize",19),e.qZA(),e.TgZ(28,"textarea",20),e.NdJ("ngModelChange",function(a){return t.hierarchyType.acknowledgement=a}),e.qZA()(),e.TgZ(29,"div",7)(30,"label"),e._UZ(31,"localize",21),e.qZA(),e.TgZ(32,"textarea",22),e.NdJ("ngModelChange",function(a){return t.hierarchyType.disclaimer=a}),e.qZA()(),e.TgZ(33,"div",7)(34,"label"),e._UZ(35,"localize",23),e.qZA(),e.TgZ(36,"textarea",24),e.NdJ("ngModelChange",function(a){return t.hierarchyType.accessConstraints=a}),e.qZA()(),e.TgZ(37,"div",7)(38,"label"),e._UZ(39,"localize",25),e.qZA(),e.TgZ(40,"textarea",26),e.NdJ("ngModelChange",function(a){return t.hierarchyType.useConstraints=a}),e.qZA()(),e._UZ(41,"hr"),e.TgZ(42,"div",7)(43,"h4"),e._UZ(44,"localize",27),e.qZA()(),e.TgZ(45,"div",7)(46,"label"),e._UZ(47,"localize",28),e.qZA(),e.TgZ(48,"input",29),e.NdJ("ngModelChange",function(a){return t.hierarchyType.contact=a}),e.qZA()(),e.TgZ(49,"div",7)(50,"label"),e._UZ(51,"localize",30),e.qZA(),e.TgZ(52,"input",31),e.NdJ("ngModelChange",function(a){return t.hierarchyType.phoneNumber=a}),e.qZA()(),e.TgZ(53,"div",7)(54,"label"),e._UZ(55,"localize",32),e.qZA(),e.TgZ(56,"input",33),e.NdJ("ngModelChange",function(a){return t.hierarchyType.email=a}),e.qZA()(),e.TgZ(57,"div",34)(58,"div",35)(59,"div",36)(60,"button",37),e.NdJ("click",function(){return t.bsModalRef.hide()}),e._UZ(61,"localize",38),e.qZA(),e.YNc(62,tT,2,1,"button",39),e.qZA()()()()()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(3),e.Q6J("ngIf",!t.edit),e.xp6(1),e.Q6J("ngIf",t.edit),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.code)("disabled",t.edit||t.readOnly),e.xp6(1),e.Q6J("ngForOf",t.hierarchyType.label.localeValues),e.xp6(1),e.Q6J("value",t.hierarchyType.description)("inlinelayout",!0)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngIf",!t.edit&&t.organizations.length>1),e.xp6(1),e.Q6J("ngIf",!t.edit&&1==t.organizations.length),e.xp6(1),e.Q6J("ngIf",t.edit),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.progress)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.acknowledgement)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.disclaimer)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.accessConstraints)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.useConstraints)("disabled",t.readOnly),e.xp6(8),e.Q6J("ngModel",t.hierarchyType.contact)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.phoneNumber)("disabled",t.readOnly),e.xp6(4),e.Q6J("ngModel",t.hierarchyType.email)("disabled",t.readOnly),e.xp6(6),e.Q6J("ngIf",!t.readOnly))},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j,lu],encapsulation:2});const sT=function(i){return{"chk-checked":i}};class Gh{constructor(n,t,o,a){this.lService=n,this.auth=t,this.registryService=o,this.bsModalRef=a,this.organization=null,this.message=null}ngOnInit(){this.onGeoObjTypeCreate=new pn.x,this.geoObjectType={code:"",label:this.lService.create(),description:this.lService.create(),geometryType:"MULTIPOINT",isLeaf:!1,isGeometryEditable:!0,organizationCode:"",attributes:[]}}init(n,t,o,a){this.geoObjectType.isAbstract=a||!1,o&&(this.geoObjectType.superTypeCode=o.code,this.geoObjectType.geometryType=o.geometryType,this.geoObjectType.isPrivate=o.isPrivate),this.parents=t.filter(l=>l.isAbstract),this.organization=n,this.geoObjectType.organizationCode=this.organization.code,this.organizationLabel=this.organization.label.localizedValue}handleOnSubmit(){this.message=null,this.registryService.createGeoObjectType(this.geoObjectType).then(n=>{this.onGeoObjTypeCreate.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}toggleIsLeaf(){this.geoObjectType.isLeaf=!this.geoObjectType.isLeaf}toggleIsGeometryEditable(){this.geoObjectType.isGeometryEditable=!this.geoObjectType.isGeometryEditable}toggleIsAbstract(){this.geoObjectType.isAbstract=!this.geoObjectType.isAbstract}error(n){this.message=Zt.qL.getMessageFromError(n)}}Gh.\u0275fac=function(n){return new(n||Gh)(e.Y36(nn.oQ),e.Y36(nn.e8),e.Y36(Zi),e.Y36(Ln.UZ))},Gh.\u0275cmp=e.Xpm({type:Gh,selectors:[["create-geoobjtype-modal"]],decls:66,vars:18,consts:[[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","hierarchy.management.create.geoobjecttype.group.title",4,"ngIf"],["key","hierarchy.management.create.geoobjecttype.title",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"form-group"],["for","codeInput"],["key","data.property.label.code"],["name","code","type","text","id","codeInput","required","",1,"form-control",3,"ngModel","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["key","data.property.label.description",3,"value","inlinelayout","valueChange"],["class","row",4,"ngIf"],[1,"col-md-12",2,"margin-bottom","15px"],[2,"display","block"],["key","geoObjectType.attr.visibility.label"],[1,"check-block"],[3,"disable","value","localizeLabelKey","valueChange"],["for","geometryType"],["key","data.property.label.geometryType"],["name","geometryType","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","MULTIPOINT"],["key","georegistry.geometry.point"],["value","MULTILINE"],["key","georegistry.geometry.line"],["value","MULTIPOLYGON"],["key","georegistry.geometry.polygon"],["value","MIXED"],["key","georegistry.geometry.mixed"],[1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],[1,"checkbox-label"],["key","hierarchy.management.option.label.isGeometryEditable"],["for","organization"],["key","attribute.organization.label"],[1,"text"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.ok"],["role","alert",1,"alert","alert-danger"],["key","hierarchy.management.create.geoobjecttype.group.title"],["key","hierarchy.management.create.geoobjecttype.title"],["key","data.property.label.label"],[2,"color","#BABABA"],[3,"key"],["type","input",1,"form-control",3,"ngModel","name","required","ngModelChange"],["key","attribute.group.label"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(1);return e.KtG(l.valid&&t.handleOnSubmit())}),e.TgZ(2,"div",2),e.YNc(3,nT,2,1,"div",3),e.TgZ(4,"div",4)(5,"h1"),e.YNc(6,iT,1,0,"localize",5),e.YNc(7,oT,1,0,"localize",6),e.qZA()(),e.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"div")(12,"label",10),e._UZ(13,"localize",11),e.qZA(),e.TgZ(14,"input",12),e.NdJ("ngModelChange",function(l){return t.geoObjectType.code=l}),e.qZA()()()()(),e.TgZ(15,"div",7)(16,"div",8),e.YNc(17,rT,8,4,"div",13),e.qZA()(),e.TgZ(18,"div",7)(19,"div",8)(20,"localized-text",14),e.NdJ("valueChange",function(l){return t.geoObjectType.description=l}),e.qZA()()(),e.YNc(21,aT,7,3,"div",15),e.TgZ(22,"div",7)(23,"div",16)(24,"div",9)(25,"label",17),e._UZ(26,"localize",18),e.qZA(),e.TgZ(27,"div",19)(28,"boolean-field",20),e.NdJ("valueChange",function(l){return t.geoObjectType.isPrivate=l}),e.qZA()()()()(),e.TgZ(29,"div",7)(30,"div",8)(31,"div",9)(32,"label",21),e._UZ(33,"localize",22),e.qZA(),e.TgZ(34,"select",23),e.NdJ("ngModelChange",function(l){return t.geoObjectType.geometryType=l}),e._UZ(35,"option"),e.TgZ(36,"option",24),e._UZ(37,"localize",25),e.qZA(),e.TgZ(38,"option",26),e._UZ(39,"localize",27),e.qZA(),e.TgZ(40,"option",28),e._UZ(41,"localize",29),e.qZA(),e.TgZ(42,"option",30),e._UZ(43,"localize",31),e.qZA()()()()(),e.TgZ(44,"div",7)(45,"div",16)(46,"div",9)(47,"div",19)(48,"div",32),e.NdJ("click",function(){return t.toggleIsGeometryEditable()}),e._UZ(49,"span"),e.qZA(),e.TgZ(50,"label",33),e._UZ(51,"localize",34),e.qZA()()()()(),e.TgZ(52,"div",7)(53,"div",8)(54,"div",9)(55,"label",35),e._UZ(56,"localize",36),e.qZA(),e.TgZ(57,"span",37)(58,"input",38),e.NdJ("ngModelChange",function(l){return t.organizationLabel=l}),e.qZA()()()()(),e.TgZ(59,"div",7)(60,"div",8)(61,"div",39)(62,"button",40),e.NdJ("click",function(){return t.bsModalRef.hide()}),e._UZ(63,"localize",41),e.qZA(),e.TgZ(64,"button",42),e._UZ(65,"localize",43),e.qZA()()()()()()}if(2&n){const o=e.MAs(1);e.xp6(3),e.Q6J("ngIf",null!=t.message),e.xp6(3),e.Q6J("ngIf",t.geoObjectType.isAbstract),e.xp6(1),e.Q6J("ngIf",!t.geoObjectType.isAbstract),e.xp6(7),e.Q6J("ngModel",t.geoObjectType.code),e.xp6(3),e.Q6J("ngForOf",t.geoObjectType.label.localeValues),e.xp6(3),e.Q6J("value",t.geoObjectType.description)("inlinelayout",!0),e.xp6(1),e.Q6J("ngIf",!t.geoObjectType.superTypeCode),e.xp6(7),e.Q6J("disable",null!=t.geoObjectType.superTypeCode)("value",t.geoObjectType.isPrivate)("localizeLabelKey","geoObjectType.attr.isPrivate"),e.xp6(6),e.Q6J("ngModel",t.geoObjectType.geometryType)("disabled",null!=t.geoObjectType.superTypeCode&&""!=t.geoObjectType.superTypeCode),e.xp6(14),e.Q6J("ngClass",e.VKq(16,sT,t.geoObjectType.isGeometryEditable)),e.xp6(10),e.Q6J("ngModel",t.organizationLabel),e.xp6(6),e.Q6J("disabled",o.invalid)}},dependencies:[T.mk,T.sg,T.O5,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j,rl.M,lu],encapsulation:2});var lT=v(54230);class cu{constructor(n,t){this.http=n,this.eventService=t}apply(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/classification-type/apply",JSON.stringify({classificationType:n}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}remove(n){let t=new ot.WM({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(pt.N.apiUrl+"/api/classification-type/remove",JSON.stringify({oid:n.oid}),{headers:t}).pipe((0,Bt.x)(()=>{this.eventService.complete()})).toPromise()}page(n){let t=new ot.LE;return t=t.set("criteria",JSON.stringify(n)),this.http.get(pt.N.apiUrl+"/api/classification-type/page",{params:t}).toPromise()}get(n){let t=new ot.LE;return t=t.set("classificationCode",n),this.http.get(pt.N.apiUrl+"/api/classification-type/get",{params:t}).toPromise()}}cu.\u0275fac=function(n){return new(n||cu)(e.LFG(ot.eN),e.LFG(nn.PO))},cu.\u0275prov=e.Yz7({token:cu,factory:cu.\u0275fac});class Cd{constructor(){this.validator=i=>{if(i.value)return-1===i.value.indexOf(" ")?null:{geoObjectAttributeCode:{valid:!1}}}}validate(n){return this.validator(n)}}function uT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"label"),e._UZ(3,"localize",3),e.TgZ(4,"span",4),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",3),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",5)(9,"span",6)(10,"input",7),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(3),e.Q6J("key",o.key),e.xp6(3),e.Q6J("key",t.locale),e.xp6(4),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("disabled",o.disabled)("required","defaultLocale"===t.locale)}}Cd.\u0275fac=function(n){return new(n||Cd)},Cd.\u0275dir=e.lG2({type:Cd,selectors:[["","geoObjectAttributeCode","","ngModel",""]],features:[e._Bn([{provide:y.Cf,useExisting:Cd,multi:!0}])]});class Xu{constructor(){this.key="",this.disabled=!1,this.valueChange=new e.vpe}}function pT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"localized-text",10),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.attribute.description=a)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("value",t.attribute.description)}}function dT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"label"),e._UZ(3,"localize",11),e.qZA()(),e.TgZ(4,"div",3)(5,"span",4)(6,"input",12),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.attribute.precision=a)}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.attribute.precision)}}function hT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"label"),e._UZ(3,"localize",13),e.qZA()(),e.TgZ(4,"div",3)(5,"span",4)(6,"input",14),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.attribute.scale=a)}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.attribute.scale)}}function fT(i,n){if(1&i&&(e.TgZ(0,"option",19),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.displayLabel.localizedValue," ")}}function gT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",1)(2,"label"),e._uU(3," Root Term "),e.qZA()(),e.TgZ(4,"div",3)(5,"classification-field",21),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.attribute.rootTerm=a)}),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("classificationType",t.attribute.classificationType)("value",t.attribute.rootTerm)("disabled",!t.isNew)}}function _T(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",0)(2,"div",1)(3,"label"),e._UZ(4,"localize",15),e.qZA()(),e.TgZ(5,"div",3)(6,"select",16),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.attribute.classificationType=a)}),e._UZ(7,"option"),e.YNc(8,fT,2,2,"option",17),e.qZA()()(),e.YNc(9,gT,6,3,"div",18),e.BQk()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.attribute.classificationType)("disabled",!t.isNew),e.xp6(2),e.Q6J("ngForOf",t.classifications),e.xp6(1),e.Q6J("ngIf",null!=t.attribute.classificationType&&t.attribute.classificationType.length>0)}}Xu.\u0275fac=function(n){return new(n||Xu)},Xu.\u0275cmp=e.Xpm({type:Xu,selectors:[["localized-input"]],inputs:{key:"key",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[["class","row-holder",4,"ngFor","ngForOf"],[1,"row-holder"],[1,"label-holder"],[3,"key"],[2,"color","#BABABA"],[1,"holder"],[1,"text"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"]],template:function(n,t){1&n&&e.YNc(0,uT,11,6,"div",0),2&n&&e.Q6J("ngForOf",t.value.localeValues)},dependencies:[T.sg,y.Fj,y.JJ,y.Q7,y.On,Sn.l,al.j],encapsulation:2});class ep{constructor(n,t){this.service=n,this.cdr=t,this.isNew=!1,this.excludeDescription=!1,this.type=null,this.attributeChange=new e.vpe,this.message=null,this.state="none",this.classifications=[]}ngOnInit(){}ngAfterViewInit(){this.state="show",this.cdr.detectChanges()}ngOnChanges(n){null!=n.type&&"classification"===this.attribute.type&&this.service.page({}).then(t=>{this.classifications=t.resultSet})}ngOnDestroy(){}handleOnSubmit(){}toggleIsUnique(){this.attribute.unique=!this.attribute.unique}animate(){this.state="none"}onAnimationDone(n){this.state="show"}isValid(){return!!this.attribute.code&&!(-1!==this.attribute.code.indexOf(" ")||0===this.attribute.label.localeValues[0].value.length||"float"===this.type&&(null==this.attribute.precision||""===this.attribute.precision.toString())||"float"===this.type&&(null==this.attribute.scale||""===this.attribute.scale.toString())||"classification"===this.type&&(null==this.attribute.classificationType||0===this.attribute.classificationType.length))}}function mT(i,n){if(1&i&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}ep.\u0275fac=function(n){return new(n||ep)(e.Y36(cu),e.Y36(e.sBO))},ep.\u0275cmp=e.Xpm({type:ep,selectors:[["attribute-input"]],inputs:{isNew:"isNew",excludeDescription:"excludeDescription",type:"type",geoObjectType:"geoObjectType",attribute:"attribute"},outputs:{attributeChange:"attributeChange"},features:[e.TTD],decls:13,vars:7,consts:[[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["autofocus","","type","text","name","code","required","","geoObjectAttributeCode","",3,"disabled","ngModel","ngModelChange"],["key","data.property.label.label",3,"value","valueChange"],["key","data.property.label.description",3,"value","valueChange",4,"ngIf"],["class","row-holder",4,"ngIf"],[4,"ngIf"],["key","data.property.label.description",3,"value","valueChange"],["key","data.property.label.length"],["type","number","step","1","name","precision","required","",3,"ngModel","ngModelChange"],["key","data.property.label.decimal"],["type","number","step","1","name","scale","required","",3,"ngModel","ngModelChange"],["key","data.type.label.classification"],["name","classificationType","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","row-holder","style","overflow: initial;",4,"ngIf"],[3,"value"],[1,"row-holder",2,"overflow","initial"],["name","classification-root","container","body",3,"classificationType","value","disabled","valueChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"label"),e._UZ(4,"localize",2),e.qZA()(),e.TgZ(5,"div",3)(6,"span",4)(7,"input",5),e.NdJ("ngModelChange",function(a){return t.attribute.code=a}),e.qZA()()()(),e.TgZ(8,"localized-input",6),e.NdJ("valueChange",function(a){return t.attribute.label=a}),e.qZA(),e.YNc(9,pT,1,1,"localized-text",7),e.YNc(10,dT,7,1,"div",8),e.YNc(11,hT,7,1,"div",8),e.YNc(12,_T,10,4,"ng-container",9),e.qZA()),2&n&&(e.xp6(7),e.Q6J("disabled",!t.isNew)("ngModel",t.attribute.code),e.xp6(1),e.Q6J("value",t.attribute.label),e.xp6(1),e.Q6J("ngIf",!t.excludeDescription),e.xp6(1),e.Q6J("ngIf","float"===t.type),e.xp6(1),e.Q6J("ngIf","float"===t.type),e.xp6(1),e.Q6J("ngIf","classification"===t.type))},dependencies:[T.sg,T.O5,y.YN,y.Kr,y.Fj,y.wV,y.EJ,y.JJ,y.Q7,y.On,Sn.l,Cd,Xu,lu,Lp],styles:["input[type=text][_ngcontent-%COMP%]{margin:2px 0!important;float:none!important}button[_ngcontent-%COMP%]{margin-top:5px;float:right}label[_ngcontent-%COMP%]{color:#999;font-weight:700}"],data:{animation:[(0,Y.X$)("toggleInputs",[(0,Y.SB)("none, void",(0,Y.oB)({opacity:0})),(0,Y.SB)("show",(0,Y.oB)({opacity:1})),(0,Y.eR)("none => show",(0,Y.jt)("300ms"))])]}});const tp=function(i){return{active:i}};class wd{constructor(n,t,o){this.bsModalRef=n,this.modalStepIndicatorService=t,this.localizeService=o,this.stateChange=new e.vpe,this.geoObjectTypeChange=new e.vpe,this.message=null,this.newAttribute=null,this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.create.attribute"),active:!0,enabled:!0}]},this.modalState={state:ko.defineAttribute,attribute:"",termOption:""}}ngOnInit(){this.setAttribute("character"),this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)}ngAfterViewInit(){this.attributeInputComponent&&this.attributeInputComponent.animate()}handleOnSubmit(){this.service.addAttributeType(this.geoObjectType.code,this.newAttribute).then(n=>{this.geoObjectType.attributes.push(n),this.stateChange.emit({state:ko.manageGeoObjectType,attribute:"",termOption:""}),this.geoObjectTypeChange.emit(this.geoObjectType)}).catch(n=>{this.error(n)})}setAttribute(n){this.newAttribute={code:"",type:n,label:this.localizeService.create(),description:this.localizeService.create(),isDefault:!1,required:!1,unique:!1,isChangeOverTime:!0},"term"===n?(this.newAttribute.rootTerm={code:null,label:null,description:null},this.newAttribute.termOptions=[]):"float"===n&&(this.newAttribute.precision=32,this.newAttribute.scale=8)}isFormValid(){let n=!1;return this.attributeInputComponent&&(n=this.attributeInputComponent.isValid()),!!n}cancel(){this.stateChange.emit({state:ko.manageGeoObjectType,attribute:"",termOption:""})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function yT(i,n){if(1&i&&(e.TgZ(0,"li",10),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Oqu(t.label.localizedValue)}}wd.\u0275fac=function(n){return new(n||wd)(e.Y36(Ln.UZ),e.Y36(nn.hr),e.Y36(nn.oQ))},wd.\u0275cmp=e.Xpm({type:wd,selectors:[["define-attribute-modal-content"]],viewQuery:function(n,t){if(1&n&&e.Gf(ep,5),2&n){let o;e.iGM(o=e.CRH())&&(t.attributeInputComponent=o.first)}},inputs:{geoObjectType:"geoObjectType",service:"service"},outputs:{stateChange:"stateChange",geoObjectTypeChange:"geoObjectTypeChange"},decls:37,vars:30,consts:[[1,"modal-body"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,""],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["key","hierarchy.management.define.attribute.title"],[1,"row"],[1,"col-md-12",2,"margin-bottom","20px"],[1,"btn-group","define-attribute-btns"],[1,"btn","full-width-radio-button",3,"ngClass","click"],["key","data.type.label.text"],["key","data.type.label.localtext"],["key","data.type.label.integer"],["key","data.type.label.float"],["key","data.type.label.date"],["key","data.type.label.boolean"],["key","data.type.label.term"],["key","data.type.label.classification"],[3,"isNew","excludeDescription","type","attribute","attributeChange"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.submit"],["role","alert",1,"alert","alert-danger"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"form",1,2),e.NdJ("ngSubmit",function(){return t.handleOnSubmit()}),e.TgZ(3,"div",3)(4,"div",3),e.YNc(5,mT,2,1,"div",4),e.TgZ(6,"div",5)(7,"h1"),e._UZ(8,"localize",6),e.qZA()(),e.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"label",10),e.NdJ("click",function(){return t.setAttribute("character")}),e._UZ(13,"localize",11),e.qZA(),e.TgZ(14,"label",10),e.NdJ("click",function(){return t.setAttribute("local")}),e._UZ(15,"localize",12),e.qZA(),e.TgZ(16,"label",10),e.NdJ("click",function(){return t.setAttribute("integer")}),e._UZ(17,"localize",13),e.qZA(),e.TgZ(18,"label",10),e.NdJ("click",function(){return t.setAttribute("float")}),e._UZ(19,"localize",14),e.qZA(),e.TgZ(20,"label",10),e.NdJ("click",function(){return t.setAttribute("date")}),e._UZ(21,"localize",15),e.qZA(),e.TgZ(22,"label",10),e.NdJ("click",function(){return t.setAttribute("boolean")}),e._UZ(23,"localize",16),e.qZA(),e.TgZ(24,"label",10),e.NdJ("click",function(){return t.setAttribute("term")}),e._UZ(25,"localize",17),e.qZA(),e.TgZ(26,"label",10),e.NdJ("click",function(){return t.setAttribute("classification")}),e._UZ(27,"localize",18),e.qZA()()()(),e.TgZ(28,"fieldset")(29,"attribute-input",19),e.NdJ("attributeChange",function(a){return t.newAttribute=a}),e.qZA(),e.TgZ(30,"div",7)(31,"div",20)(32,"div",21)(33,"button",22),e.NdJ("click",function(){return t.cancel()}),e._UZ(34,"localize",23),e.qZA(),e.TgZ(35,"button",24),e._UZ(36,"localize",25),e.qZA()()()()()()()()()),2&n&&(e.xp6(5),e.Q6J("ngIf",null!=t.message),e.xp6(7),e.Q6J("ngClass",e.VKq(14,tp,"character"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(16,tp,"local"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(18,tp,"integer"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(20,tp,"float"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(22,tp,"date"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(24,tp,"boolean"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(26,tp,"term"===t.newAttribute.type)),e.xp6(2),e.Q6J("ngClass",e.VKq(28,tp,"classification"===t.newAttribute.type)),e.xp6(3),e.Q6J("isNew",!0)("excludeDescription",!1)("type",t.newAttribute.type)("attribute",t.newAttribute),e.xp6(6),e.Q6J("disabled",!t.isFormValid()))},dependencies:[T.mk,T.O5,y._Y,y.JL,y.F,Sn.l,ep],styles:[".btn-group.define-attribute-btns[_ngcontent-%COMP%]{margin:0 auto;display:block}"]});class Vh{constructor(n,t){this.bsModalRef=n,this.cdr=t,this.attribute=null,this.stateChange=new e.vpe,this.message=null,this.state="none"}ngOnInit(){}ngAfterViewInit(){this.state="show",this.cdr.detectChanges()}ngOnDestroy(){}handleOnSubmit(){}animate(){this.state="none"}onAnimationDone(n){this.state="show"}openAddTermOptionForm(){this.stateChange.emit({state:ko.manageTermOption,attribute:this.attribute,termOption:""})}}function vT(i,n){if(1&i&&(e.TgZ(0,"div",17),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function bT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",20),e.qZA())}function xT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",21),e.qZA())}function CT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",22),e.qZA())}function wT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",23),e.qZA())}function TT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",24),e.qZA())}function MT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",25),e.qZA())}function OT(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",26),e.qZA())}function ST(i,n){1&i&&(e.TgZ(0,"h4",18),e._UZ(1,"localize",19),e._uU(2,": "),e._UZ(3,"localize",27),e.qZA())}function PT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"term-option-widget",28),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("attribute",t.attribute)}}Vh.\u0275fac=function(n){return new(n||Vh)(e.Y36(Ln.UZ),e.Y36(e.sBO))},Vh.\u0275cmp=e.Xpm({type:Vh,selectors:[["term-option-widget"]],inputs:{attribute:"attribute"},outputs:{stateChange:"stateChange"},decls:12,vars:2,consts:[[1,"row-holder"],[1,"label-holder"],["key","hierarchy.management.manage.attributes.label.displayTerms"],[1,"holder"],[1,"panel","panel-default"],[1,"panel-body"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","full-width",3,"click"],["key","modal.button.manageTermOptions"],[1,"list-group-item"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.NdJ("@toggleInputs.done",function(a){return t.onAnimationDone(a)}),e.TgZ(1,"div")(2,"div",1)(3,"label"),e._UZ(4,"localize",2),e.qZA()(),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"ul",6),e.YNc(9,yT,2,1,"li",7),e.qZA(),e.TgZ(10,"button",8),e.NdJ("click",function(){return t.openAddTermOptionForm()}),e._UZ(11,"localize",9),e.qZA()()()()()()),2&n&&(e.Q6J("@toggleInputs",t.state),e.xp6(9),e.Q6J("ngForOf",t.attribute.rootTerm.children))},dependencies:[T.sg,Sn.l],styles:["input[type=text][_ngcontent-%COMP%]{margin:2px 0!important;float:none!important}button[_ngcontent-%COMP%]{margin-top:5px;float:right}.btn.btn-primary.full-width[_ngcontent-%COMP%]{margin:0 auto;display:block;width:100%}label[_ngcontent-%COMP%]{color:#999;font-weight:700}li.list-group-item[_ngcontent-%COMP%]{font-size:inherit;color:gray}li.list-group-item[_ngcontent-%COMP%]:hover{cursor:default;background:white}"],data:{animation:[(0,Y.X$)("toggleInputs",[(0,Y.SB)("none, void",(0,Y.oB)({opacity:0})),(0,Y.SB)("show",(0,Y.oB)({opacity:1})),(0,Y.eR)("none => show",(0,Y.jt)("300ms")),(0,Y.eR)("show => none",(0,Y.jt)("100ms"))]),(0,Y.X$)("openClose",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms",(0,Y.oB)({opacity:1}))]),(0,Y.eR)(":leave",[(0,Y.oB)({opacity:1}),(0,Y.jt)("0ms",(0,Y.oB)({opacity:0}))])])]}});class Td{constructor(n,t,o){this.bsModalRef=n,this.modalStepIndicatorService=t,this.localizeService=o,this.attribute=null,this.geoObjectTypeChange=new e.vpe,this.stateChange=new e.vpe,this.message=null,this.modalState={state:ko.editAttribute,attribute:this.attribute,termOption:""},this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.attribute"),active:!0,enabled:!0}]}}ngOnInit(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)}ngAfterViewInit(){}ngOnDestroy(){}handleOnSubmit(){this.service.updateAttributeType(this.geoObjectType.code,this.attribute).then(n=>{for(let t=0;t<this.geoObjectType.attributes.length;t++){let o=this.geoObjectType.attributes[t];if(o.code===n.code){Object.assign(o,n);break}}this.stateChange.emit({state:ko.manageGeoObjectType,attribute:"",termOption:""}),this.geoObjectTypeChange.emit(this.geoObjectType)}).catch(n=>{this.error(n)})}onModalStateChange(n){this.stateChange.emit(n)}isFormValid(){return!0}cancel(){this.stateChange.emit({state:ko.manageGeoObjectType,attribute:"",termOption:""})}back(){this.stateChange.emit({state:ko.manageGeoObjectType,attribute:"",termOption:""})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function ET(i,n){if(1&i&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}Td.\u0275fac=function(n){return new(n||Td)(e.Y36(Ln.UZ),e.Y36(nn.hr),e.Y36(nn.oQ))},Td.\u0275cmp=e.Xpm({type:Td,selectors:[["edit-attribute-modal-content"]],viewQuery:function(n,t){if(1&n&&e.Gf(ep,5),2&n){let o;e.iGM(o=e.CRH())&&(t.attributeInputComponent=o.first)}},inputs:{geoObjectType:"geoObjectType",attribute:"attribute",service:"service"},outputs:{geoObjectTypeChange:"geoObjectTypeChange",stateChange:"stateChange"},decls:28,vars:16,consts:[[1,"modal-body"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,""],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["key","hierarchy.management.edit.attribute.title"],["class","sub-title",4,"ngIf"],[3,"isNew","excludeDescription","type","attribute","attributeChange"],[3,"attribute","stateChange",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.submit"],["role","alert",1,"alert","alert-danger"],[1,"sub-title"],["key","hierarchy.management.edit.attribute.subtitle"],["key","data.type.label.text"],["key","data.type.label.integer"],["key","data.type.label.float"],["key","data.type.label.boolean"],["key","data.type.label.date"],["key","data.type.label.term"],["key","data.type.label.classification"],["key","data.type.label.localtext"],[3,"attribute","stateChange"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",0)(1,"form",1,2),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(2);return e.KtG(l.valid&&t.handleOnSubmit())}),e.TgZ(3,"div",3)(4,"div",3),e.YNc(5,vT,2,1,"div",4),e.TgZ(6,"div",5)(7,"h1"),e._UZ(8,"localize",6),e._uU(9),e.qZA(),e.YNc(10,bT,4,0,"h4",7),e.YNc(11,xT,4,0,"h4",7),e.YNc(12,CT,4,0,"h4",7),e.YNc(13,wT,4,0,"h4",7),e.YNc(14,TT,4,0,"h4",7),e.YNc(15,MT,4,0,"h4",7),e.YNc(16,OT,4,0,"h4",7),e.YNc(17,ST,4,0,"h4",7),e.qZA(),e.TgZ(18,"fieldset")(19,"attribute-input",8),e.NdJ("attributeChange",function(l){return t.attribute=l}),e.qZA(),e.YNc(20,PT,1,1,"term-option-widget",9),e.TgZ(21,"div",10)(22,"div",11)(23,"div",12)(24,"button",13),e.NdJ("click",function(){return t.cancel()}),e._UZ(25,"localize",14),e.qZA(),e.TgZ(26,"button",15),e._UZ(27,"localize",16),e.qZA()()()()()()()()()}2&n&&(e.xp6(5),e.Q6J("ngIf",null!=t.message),e.xp6(4),e.hij(": ",t.attribute.label.localizedValue," "),e.xp6(1),e.Q6J("ngIf","character"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","integer"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","float"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","boolean"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","date"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","term"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","classification"===t.attribute.type),e.xp6(1),e.Q6J("ngIf","local"===t.attribute.type),e.xp6(2),e.Q6J("isNew",!1)("excludeDescription","term"===t.attribute.type)("type",t.attribute.type)("attribute",t.attribute),e.xp6(1),e.Q6J("ngIf","term"===t.attribute.type&&t.isFormValid()),e.xp6(6),e.Q6J("disabled",!t.isFormValid()))},dependencies:[T.O5,y._Y,y.JL,y.F,Sn.l,Vh,ep],styles:["input[type=text][_ngcontent-%COMP%]{margin:2px 0!important;float:none!important}label[_ngcontent-%COMP%]{color:#999;font-weight:700}.sub-title[_ngcontent-%COMP%]{color:gray}.btn-group.define-attribute-btns[_ngcontent-%COMP%]{margin:0 auto;display:block}"],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)("void => *",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")])])]]}});class Md{constructor(n,t,o,a){this.bsModalRef=n,this.modalStepIndicatorService=t,this.localizeService=o,this.registryService=a,this.attribute=null,this.stateChange=new e.vpe,this.message=null,this.modalState={state:ko.editAttribute,attribute:this.attribute,termOption:""},this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.attribute"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.term.options"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.term.option"),active:!0,enabled:!0}]}}ngOnInit(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig)}ngAfterViewInit(){}ngOnDestroy(){}handleOnSubmit(){this.registryService.updateAttributeTermTypeOption(this.attribute.rootTerm.code,this.termOption).then(n=>{const t=this.attribute.rootTerm.children.findIndex(o=>o.code===n.code);-1!==t&&(this.attribute.rootTerm.children[t]=n),this.stateChange.emit({state:ko.manageTermOption,attribute:this.attribute,termOption:null})}).catch(n=>{this.error(n)})}isFormValid(){return!0}cancel(){this.stateChange.emit({state:ko.manageTermOption,attribute:this.attribute,termOption:null})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function AT(i,n){if(1&i&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function kT(i,n){if(1&i&&(e.TgZ(0,"div",8)(1,"div",9),e._UZ(2,"localize",44),e.qZA(),e.TgZ(3,"div",11)(4,"span",12),e._uU(5),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(5),e.hij(" ",t.geoObjectType.superTypeCode," ")}}function IT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",48),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw(2);return e.KtG(_.editAttribute(l,a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"modal.button.edit"))}function ZT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",49),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw(2);return e.KtG(_.removeAttributeType(l,a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"modal.button.remove"))}function NT(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",45),e.YNc(4,IT,2,3,"a",46),e.YNc(5,ZT,2,3,"a",47),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.Oqu(t.label.localizedValue),e.xp6(2),e.Q6J("ngIf",!t.isDefault&&"keyName"!==t.code),e.xp6(1),e.Q6J("ngIf",!t.isDefault&&"keyName"!==t.code)}}function LT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",50),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.defineAttributeModal())}),e._UZ(1,"localize",51),e.qZA()}}function zT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.update())}),e._UZ(1,"localize",53),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("disabled",!t.isValid())}}function DT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"form",4,5),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.MAs(1);return e.KtG(a.valid)}),e.TgZ(2,"div",6)(3,"h1"),e._UZ(4,"localize",7),e._uU(5),e.qZA()(),e.TgZ(6,"fieldset")(7,"div",8)(8,"div",9)(9,"label"),e._UZ(10,"localize",10),e.qZA()(),e.TgZ(11,"div",11)(12,"span",12)(13,"input",13),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.editGeoObjectType.code=a)}),e.qZA()()()(),e.TgZ(14,"localized-input",14),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.editGeoObjectType.label=a)}),e.qZA(),e.TgZ(15,"localized-text",15),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.editGeoObjectType.description=a)}),e.qZA(),e.TgZ(16,"div",8)(17,"div",9)(18,"label"),e._UZ(19,"localize",16),e.qZA()(),e.TgZ(20,"div",11)(21,"boolean-field",17),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.geoObjectType.isAbstract=a)}),e.qZA()()(),e.TgZ(22,"div",8)(23,"div",9)(24,"label"),e._UZ(25,"localize",18),e.qZA()(),e.TgZ(26,"div",11)(27,"boolean-field",17),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.editGeoObjectType.isPrivate=a)}),e.qZA()()(),e.YNc(28,kT,6,1,"div",19),e.TgZ(29,"div",8)(30,"div",9)(31,"label"),e._UZ(32,"localize",20),e.qZA()(),e.TgZ(33,"div",11)(34,"select",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.editGeoObjectType.geometryType=a)}),e._UZ(35,"option"),e.TgZ(36,"option",22),e._UZ(37,"localize",23),e.qZA(),e.TgZ(38,"option",24),e._UZ(39,"localize",25),e.qZA(),e.TgZ(40,"option",26),e._UZ(41,"localize",27),e.qZA(),e.TgZ(42,"option",28),e._UZ(43,"localize",29),e.qZA()()()(),e.TgZ(44,"div",8)(45,"div",9)(46,"label"),e._UZ(47,"localize",30),e.qZA()(),e.TgZ(48,"div",11)(49,"boolean-field",17),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.editGeoObjectType.isGeometryEditable=a)}),e.qZA()()(),e.TgZ(50,"div",8)(51,"div",9)(52,"label"),e._UZ(53,"localize",31),e.qZA()(),e.TgZ(54,"div",11)(55,"span",12)(56,"input",32),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.organizationLabel=a)}),e.qZA()()()(),e.TgZ(57,"div",8)(58,"div",9)(59,"label"),e._UZ(60,"localize",33),e.qZA()(),e.TgZ(61,"div",11)(62,"div",34)(63,"div",35)(64,"div",36)(65,"table",37)(66,"tbody"),e.YNc(67,NT,6,3,"tr",38),e.qZA()()(),e.YNc(68,LT,2,0,"i",39),e.qZA()()()(),e.TgZ(69,"div",8)(70,"div",40)(71,"button",41),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close())}),e._UZ(72,"localize",42),e.qZA(),e.YNc(73,zT,2,1,"button",43),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(5),e.hij(" : ",t.editGeoObjectType.label.localizedValue," "),e.xp6(8),e.Q6J("ngModel",t.editGeoObjectType.code),e.xp6(1),e.Q6J("disabled",t.readOnly)("value",t.editGeoObjectType.label),e.xp6(1),e.Q6J("disabled",t.readOnly)("value",t.editGeoObjectType.description),e.xp6(6),e.Q6J("disable",!0)("value",t.geoObjectType.isAbstract)("localizeLabelKey","attribute.isAbstract.label"),e.xp6(6),e.Q6J("disable",t.readOnly||null!=t.geoObjectType.superTypeCode)("value",t.editGeoObjectType.isPrivate)("localizeLabelKey","geoObjectType.attr.isPrivate"),e.xp6(1),e.Q6J("ngIf",!t.geoObjectType.isAbstract&&t.geoObjectType.superTypeCode),e.xp6(6),e.Q6J("ngModel",t.editGeoObjectType.geometryType),e.xp6(15),e.Q6J("disable",t.readOnly)("value",t.editGeoObjectType.isGeometryEditable)("localizeLabelKey","hierarchy.management.option.label.isGeometryEditable"),e.xp6(7),e.Q6J("ngModel",t.organizationLabel),e.xp6(11),e.Q6J("ngForOf",t.geoObjectType.attributes),e.xp6(1),e.Q6J("ngIf",!t.readOnly),e.xp6(5),e.Q6J("ngIf",!t.readOnly)}}Md.\u0275fac=function(n){return new(n||Md)(e.Y36(Ln.UZ),e.Y36(nn.hr),e.Y36(nn.oQ),e.Y36(Zi))},Md.\u0275cmp=e.Xpm({type:Md,selectors:[["edit-term-option-input"]],inputs:{attribute:"attribute",termOption:"termOption"},outputs:{stateChange:"stateChange"},decls:26,vars:5,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"modal-form",3,"ngSubmit"],["tForm","ngForm"],[1,""],[1,"heading"],["key","hierarchy.management.edit.term.option.title"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["type","text","name","code",3,"disabled","ngModel","ngModelChange"],["key","data.property.label.label",3,"value","valueChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.submit"],["role","alert",1,"alert","alert-danger"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",0),e.YNc(1,ET,2,1,"div",1),e.TgZ(2,"form",2,3),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(3);return e.KtG(!l.invalid&&t.handleOnSubmit())}),e.TgZ(4,"div",4)(5,"div",4)(6,"div",5)(7,"h1"),e._UZ(8,"localize",6),e.qZA()(),e.TgZ(9,"fieldset")(10,"div",7)(11,"div",8)(12,"label"),e._UZ(13,"localize",9),e.qZA()(),e.TgZ(14,"div",10)(15,"span",11)(16,"input",12),e.NdJ("ngModelChange",function(l){return t.termOption.code=l}),e.qZA()()()(),e.TgZ(17,"localized-input",13),e.NdJ("valueChange",function(l){return t.termOption.label=l}),e.qZA(),e.TgZ(18,"div",7),e._UZ(19,"div",8),e.TgZ(20,"div",10)(21,"div",14)(22,"button",15),e.NdJ("click",function(){return t.cancel()}),e._UZ(23,"localize",16),e.qZA(),e.TgZ(24,"button",17),e._UZ(25,"localize",18),e.qZA()()()()()()()()()}if(2&n){const o=e.MAs(3);e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(15),e.Q6J("disabled",!0)("ngModel",t.termOption.code),e.xp6(1),e.Q6J("value",t.termOption.label),e.xp6(7),e.Q6J("disabled",o.invalid)}},dependencies:[T.O5,y._Y,y.Fj,y.JJ,y.JL,y.On,y.F,Sn.l,Xu],encapsulation:2,data:{animation:[(0,Y.X$)("openClose",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms",(0,Y.oB)({opacity:1}))]),(0,Y.eR)(":leave",[(0,Y.oB)({opacity:1}),(0,Y.jt)("0ms",(0,Y.oB)({opacity:0}))])])]}});class Yh{constructor(n,t,o,a,l,_){this.bsModalRef=n,this.confirmBsModalRef=t,this.modalService=o,this.modalStepIndicatorService=a,this.localizationService=l,this.registryService=_,this.readOnly=!1,this.geoObjectTypeChange=new e.vpe,this.stateChange=new e.vpe,this.message=null,this.modalStepConfig={steps:[{label:this.localizationService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!0}]}}set in(n){n&&(this.editGeoObjectType=JSON.parse(JSON.stringify(n)))}ngOnInit(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig),this.fetchOrganizationLabel()}defineAttributeModal(){this.stateChange.emit({state:ko.defineAttribute,attribute:"",termOption:""})}fetchOrganizationLabel(){this.registryService.getOrganizations().then(n=>{for(let t=0;t<n.length;++t)n[t].code===this.editGeoObjectType.organizationCode&&(this.organizationLabel=n[t].label.localizedValue)}).catch(n=>{this.error(n)})}manageAttributes(){this.stateChange.emit({state:ko.manageAttributes,attribute:"",termOption:""})}update(){this.registryService.updateGeoObjectType(this.editGeoObjectType).then(n=>{this.geoObjectTypeChange.emit(n),this.close()}).catch(n=>{this.error(n)})}close(){this.bsModalRef.hide()}isValid(){return!0}editAttribute(n,t){this.stateChange.emit({state:ko.editAttribute,attribute:n,termOption:""})}removeAttributeType(n,t){this.confirmBsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.confirmBsModalRef.content.message=this.localizationService.decode("confirm.modal.verify.delete")+"["+n.label.localizedValue+"]",this.confirmBsModalRef.content.data={attributeType:n,geoObjectType:this.geoObjectType},this.confirmBsModalRef.content.submitText=this.localizationService.decode("modal.button.delete"),this.confirmBsModalRef.content.type=ec.Qi.danger,this.confirmBsModalRef.content.onConfirm.subscribe(o=>{this.deleteAttributeType(o.geoObjectType.code,o.attributeType)})}deleteAttributeType(n,t){this.registryService.deleteAttributeType(n,t.code).then(o=>{this.geoObjectType.attributes.splice(this.geoObjectType.attributes.indexOf(t),1),this.geoObjectTypeChange.emit(this.geoObjectType)}).catch(o=>{this.error(o)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function RT(i,n){if(1&i&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function FT(i,n){if(1&i&&(e.TgZ(0,"th"),e._UZ(1,"localize",25),e._uU(2," ("),e._UZ(3,"convert-key-label",26),e._uU(4,") "),e.qZA()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("key",t.locale)}}function UT(i,n){if(1&i&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Oqu(t.value)}}function qT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.YNc(3,UT,2,1,"td",14),e.TgZ(4,"td",18)(5,"a",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.editTermOption(l))}),e.qZA(),e.TgZ(6,"a",28),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.removeTermOption(l))}),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Oqu(t.code),e.xp6(1),e.Q6J("ngForOf",t.label.localeValues)}}function JT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"input",29),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngModel",t.value)("name","termOptionLabel-"+t.locale)("required",!!o.termOption.code||null)}}Yh.\u0275fac=function(n){return new(n||Yh)(e.Y36(Ln.UZ),e.Y36(Ln.UZ),e.Y36(Ln.tT),e.Y36(nn.hr),e.Y36(nn.oQ),e.Y36(Zi))},Yh.\u0275cmp=e.Xpm({type:Yh,selectors:[["geoobjecttype-input"]],inputs:{readOnly:"readOnly",geoObjectType:"geoObjectType",in:["setGeoObjectType","in"]},outputs:{geoObjectTypeChange:"geoObjectTypeChange",stateChange:"stateChange"},decls:3,vars:2,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","modal-form",3,"ngSubmit",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"heading","text-center"],["key","hierarchy.management.edit.geoobjecttype.title"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["type","text","name","code","disabled","","required","",3,"ngModel","ngModelChange"],["key","data.property.label.label",3,"disabled","value","valueChange"],["key","data.property.label.description",3,"disabled","value","valueChange"],["key","attribute.group.label"],[3,"disable","value","localizeLabelKey","valueChange"],["key","geoObjectType.attr.visibility.label"],["class","row-holder",4,"ngIf"],["key","data.property.label.geometryType"],["name","geometryType","disabled","",3,"ngModel","ngModelChange"],["value","MULTIPOINT"],["key","georegistry.geometry.point"],["value","MULTILINE"],["key","georegistry.geometry.line"],["value","MULTIPOLYGON"],["key","georegistry.geometry.polygon"],["value","MIXED"],["key","georegistry.geometry.mixed"],["key","hierarchy.management.option.label.geometryEditable"],["key","attribute.organization.label"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],["key","hierarchy.management.manage.attributes.label.displayAttributes"],[1,"panel","panel-default"],[1,"panel-body"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],["class","fa fa-plus clickable","style","font-size:20px;margin:10px 0 10px 0;","aria-hidden","true",3,"click",4,"ngIf"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],["key","attribute.parentType.label"],[1,"button-column",2,"width","60px"],["class","fa fa-pencil ico-edit",3,"routerLink","title","click",4,"ngIf"],["class","fa fa-trash-o ico-remove",3,"routerLink","title","click",4,"ngIf"],[1,"fa","fa-pencil","ico-edit",3,"routerLink","title","click"],[1,"fa","fa-trash-o","ico-remove",3,"routerLink","title","click"],["aria-hidden","true",1,"fa","fa-plus","clickable",2,"font-size","20px","margin","10px 0 10px 0",3,"click"],["key","modal.button.add"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,AT,2,1,"div",1),e.YNc(2,DT,74,21,"form",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",t.editGeoObjectType))},dependencies:[T.sg,T.O5,w.rH,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,rl.M,Xu,lu,ia.F],styles:[".btn.btn-primary.full-width[_ngcontent-%COMP%]{margin:0 auto;display:block;width:100%}li.list-group-item[_ngcontent-%COMP%]{font-size:inherit;color:gray}li.list-group-item[_ngcontent-%COMP%]:hover{cursor:default;background:white}"],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)("void => *",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")]),(0,Y.eR)(":leave",(0,Y.jt)("500ms",(0,Y.oB)({opacity:0})))])]]}});class Od{constructor(n,t,o,a,l,_){this.bsModalRef=n,this.cdr=t,this.modalService=o,this.localizeService=a,this.modalStepIndicatorService=l,this.registryService=_,this.attributeChange=new e.vpe,this.stateChange=new e.vpe,this.message=null,this.state="none",this.enableTermOptionForm=!1,this.modalStepConfig={steps:[{label:this.localizeService.decode("modal.step.indicator.manage.geoobjecttype"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.attributes"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.edit.attribute"),active:!0,enabled:!1},{label:this.localizeService.decode("modal.step.indicator.manage.term.options"),active:!0,enabled:!0}]}}ngOnInit(){this.modalStepIndicatorService.setStepConfig(this.modalStepConfig),this.termOption={code:"",label:this.localizeService.create(),description:this.localizeService.create()}}ngAfterViewInit(){this.state="show",this.cdr.detectChanges()}ngOnDestroy(){}handleOnSubmit(){}animate(){this.state="none"}onAnimationDone(n){this.state="show"}isValid(){if(this.termOption.code&&this.termOption.code.length>0){if(-1!==this.termOption.code.indexOf(" "))return!1;for(let n=0;n<this.termOption.label.localeValues.length;n++)if(0===this.termOption.label.localeValues[n].value.replace(/\s/g,"").length)return!1;return!0}return this.termOption.code&&this.termOption.code.indexOf(" "),!1}addTermOption(){this.registryService.addAttributeTermTypeOption(this.attribute.rootTerm.code,this.termOption).then(n=>{this.attribute.rootTerm.children.push(n),this.attributeChange.emit(this.attribute),this.clearTermOption(),this.enableTermOptionForm=!1}).catch(n=>{this.error(n)})}deleteTermOption(n){this.registryService.deleteAttributeTermTypeOption(this.attribute.rootTerm.code,n.code).then(t=>{-1!==this.attribute.rootTerm.children.indexOf(n)&&this.attribute.rootTerm.children.splice(this.attribute.rootTerm.children.indexOf(n),1),this.attributeChange.emit(this.attribute),this.clearTermOption()}).catch(t=>{this.error(t)})}removeTermOption(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+"["+n.label+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(t=>{this.deleteTermOption(n)})}editTermOption(n){const t={state:ko.editTermOption,attribute:this.attribute,termOption:JSON.parse(JSON.stringify(n))};this.stateChange.emit(t)}clearTermOption(){this.termOption.code="",this.termOption.label=this.localizeService.create(),this.termOption.description=this.localizeService.create()}cancelTermOption(){this.clearTermOption(),this.enableTermOptionForm=!1}openAddTermOptionForm(){this.enableTermOptionForm=!0}close(){this.stateChange.emit({state:ko.editAttribute,attribute:this.attribute,termOption:""})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function jT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"geoobjecttype-input",5),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))})("geoObjectTypeChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onGeoObjectTypeChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("readOnly",t.readOnly)("geoObjectType",t.geoObjectType)("setGeoObjectType",t.geoObjectType)}}function BT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"define-attribute-modal-content",6),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))})("geoObjectTypeChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onGeoObjectTypeChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("geoObjectType",t.geoObjectType)("service",t.service)}}function GT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"edit-attribute-modal-content",7),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))})("geoObjectTypeChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onGeoObjectTypeChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("geoObjectType",t.geoObjectType)("attribute",t.modalState.attribute)("service",t.service)}}function VT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"manage-term-options",8),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("attribute",t.modalState.attribute)}}function YT(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"edit-term-option-input",9),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("attribute",t.modalState.attribute)("termOption",t.modalState.termOption)}}Od.\u0275fac=function(n){return new(n||Od)(e.Y36(Ln.UZ),e.Y36(e.sBO),e.Y36(Ln.tT),e.Y36(nn.oQ),e.Y36(nn.hr),e.Y36(Zi))},Od.\u0275cmp=e.Xpm({type:Od,selectors:[["manage-term-options"]],inputs:{attribute:"attribute"},outputs:{attributeChange:"attributeChange",stateChange:"stateChange"},decls:40,vars:10,consts:[[1,"modal-body"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["key","hierarchy.management.edit.term.options.title"],[1,"row-holder"],[1,"label-holder"],["key","term.option.input.label.existingTypes"],[1,"holder"],[1,"text"],[1,"table-responsive"],[1,"table"],["key","data.property.label.code"],[4,"ngFor","ngForOf"],[1,"button-column-header"],["key","data.property.label.actions"],["type","text","name","termOptionCode",3,"ngModel","required","ngModelChange"],[1,"button-column"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.add"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.done"],["role","alert",1,"alert","alert-danger"],["key","data.property.label.label"],[3,"key"],[1,"fa","fa-pencil","ico-edit",3,"routerLink","click"],[1,"fa","fa-trash-o","ico-remove",3,"routerLink","click"],["type","text",3,"ngModel","name","required","ngModelChange"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",0)(1,"form",1,2),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(2);return e.KtG(l.valid)}),e.TgZ(3,"fieldset"),e.YNc(4,RT,2,1,"div",3),e.TgZ(5,"div",4)(6,"h1")(7,"localize",5),e._uU(8),e.qZA()()(),e.TgZ(9,"div",6),e.NdJ("@toggleInputs.done",function(l){return t.onAnimationDone(l)}),e.TgZ(10,"div")(11,"div",7)(12,"label"),e._UZ(13,"localize",8),e.qZA()(),e.TgZ(14,"div",9)(15,"span",10)(16,"div",11)(17,"table",12)(18,"thead")(19,"tr")(20,"th"),e._UZ(21,"localize",13),e.qZA(),e.YNc(22,FT,5,1,"th",14),e.TgZ(23,"th",15),e._UZ(24,"localize",16),e.qZA()()(),e.TgZ(25,"tbody"),e.YNc(26,qT,7,2,"tr",14),e.TgZ(27,"tr")(28,"td")(29,"input",17),e.NdJ("ngModelChange",function(l){return t.termOption.code=l}),e.qZA()(),e.YNc(30,JT,2,3,"td",14),e.TgZ(31,"td",18)(32,"button",19),e.NdJ("click",function(){return t.addTermOption()}),e._UZ(33,"localize",20),e.qZA()()()()()()()()()(),e.TgZ(34,"div",6),e._UZ(35,"div",7),e.TgZ(36,"div",9)(37,"div",21)(38,"button",22),e.NdJ("click",function(){return t.close()}),e._UZ(39,"localize",23),e.qZA()()()()()()()}2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(4),e.hij(": ",t.attribute.label.localizedValue,""),e.xp6(1),e.Q6J("@toggleInputs",t.state),e.xp6(1),e.Q6J("@openClose",void 0),e.xp6(12),e.Q6J("ngForOf",t.termOption.label.localeValues),e.xp6(4),e.Q6J("ngForOf",t.attribute.rootTerm.children),e.xp6(3),e.Q6J("ngModel",t.termOption.code)("required",!!t.termOption.label||null),e.xp6(1),e.Q6J("ngForOf",t.termOption.label.localeValues),e.xp6(2),e.Q6J("disabled",!t.isValid()))},dependencies:[T.sg,T.O5,w.rH,y._Y,y.Fj,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j],styles:[".button-column[_ngcontent-%COMP%]{text-align:right}.button-column[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{font-size:25px;color:#bababa}.button-column[_ngcontent-%COMP%]   .fa.ico-remove[_ngcontent-%COMP%]:hover{color:red}.button-column[_ngcontent-%COMP%]   .fa.ico-edit[_ngcontent-%COMP%]:hover{color:#00bfff}.button-column[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:inherit;height:38px}th.button-column-header[_ngcontent-%COMP%]{text-align:right}"],data:{animation:[(0,Y.X$)("toggleInputs",[(0,Y.SB)("none, void",(0,Y.oB)({opacity:0})),(0,Y.SB)("show",(0,Y.oB)({opacity:1})),(0,Y.eR)("none => show",(0,Y.jt)("300ms")),(0,Y.eR)("show => none",(0,Y.jt)("100ms"))]),(0,Y.X$)("openClose",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms",(0,Y.oB)({opacity:1}))]),(0,Y.eR)(":leave",[(0,Y.oB)({opacity:1}),(0,Y.jt)("0ms",(0,Y.oB)({opacity:0}))])])]}});class Hh{constructor(n,t,o){this.service=n,this.bsModalRef=t,this.confirmBsModalRef=o,this.modalState={state:ko.manageGeoObjectType,attribute:"",termOption:""},this.message=null,this.readOnly=!1}ngOnInit(){this.onGeoObjectTypeSubmitted=new pn.x}onModalStateChange(n){this.modalState=n}onGeoObjectTypeChange(n){this.onGeoObjectTypeSubmitted.next(n)}update(){}close(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}Hh.\u0275fac=function(n){return new(n||Hh)(e.Y36(Zi),e.Y36(Ln.UZ),e.Y36(Ln.UZ))},Hh.\u0275cmp=e.Xpm({type:Hh,selectors:[["manage-geoobjecttype-modal"]],decls:7,vars:5,consts:[[3,"readOnly","geoObjectType","setGeoObjectType","stateChange","geoObjectTypeChange",4,"ngIf"],[3,"geoObjectType","service","stateChange","geoObjectTypeChange",4,"ngIf"],[3,"geoObjectType","attribute","service","stateChange","geoObjectTypeChange",4,"ngIf"],[3,"attribute","stateChange",4,"ngIf"],[3,"attribute","termOption","stateChange",4,"ngIf"],[3,"readOnly","geoObjectType","setGeoObjectType","stateChange","geoObjectTypeChange"],[3,"geoObjectType","service","stateChange","geoObjectTypeChange"],[3,"geoObjectType","attribute","service","stateChange","geoObjectTypeChange"],[3,"attribute","stateChange"],[3,"attribute","termOption","stateChange"]],template:function(n,t){1&n&&(e.TgZ(0,"form"),e._UZ(1,"modal-step-indicator"),e.YNc(2,jT,1,3,"geoobjecttype-input",0),e.YNc(3,BT,1,2,"define-attribute-modal-content",1),e.YNc(4,GT,1,3,"edit-attribute-modal-content",2),e.YNc(5,VT,1,1,"manage-term-options",3),e.YNc(6,YT,1,2,"edit-term-option-input",4),e.qZA()),2&n&&(e.xp6(2),e.Q6J("ngIf","MANAGE-GEO-OBJECT-TYPE"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","DEFINE-ATTRIBUTE"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","EDIT-ATTRIBUTE"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","MANAGE-TERM-OPTION"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","EDIT-TERM-OPTION"===t.modalState.state))},dependencies:[T.O5,y._Y,y.JL,y.F,lT.R,wd,Td,Md,Yh,Od],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)("void => *",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")]),(0,Y.eR)(":leave",(0,Y.jt)("500ms",(0,Y.oB)({opacity:0})))])]]}});class HT{constructor(n,t,o,a,l,_,C){this.localizeService=l,this.modalService=_,this.authService=C,this.hierarchyComponent=n,this.svgHierarchyType=t,this.geoObjectType=o,this.treeNode=a}getCode(){return this.geoObjectType.code}setPos(n,t,o){let a=this.getBbox();ln('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]').classed("dragging",o).attr("x",n).attr("y",t),ln('.g-hierarchy[data-primary=true] .svg-got-header-rect[data-gotCode="'+this.getCode()+'"]').classed("dragging",o).attr("x",n).attr("y",t-qt.gotRectH/2+2),ln('.g-hierarchy[data-primary=true] .svg-got-label-text[data-gotCode="'+this.getCode()+'"]').classed("dragging",o).attr("x",n+5).attr("y",t+1),ln('.g-hierarchy[data-primary=true] .svg-got-relatedhiers-button[data-gotCode="'+this.getCode()+'"]').classed("dragging",o).attr("x",n+a.width-20).attr("y",t+17);let l=ln('.g-hierarchy[data-primary=true] .hierarchy-inherit-button[data-gotCode="'+this.getCode()+'"]').node();if(null!=l){const C=n+a.width-60,N=t+a.height-24;let F=l.getBBox();ln('.g-hierarchy[data-primary=true] .hierarchy-inherit-button[data-gotCode="'+this.getCode()+'"]').classed("dragging",o).attr("transform","translate("+(C-F.x)+" "+(N-F.y)+")")}let _=ln('.g-hierarchy[data-primary=true] .hierarchy-uninherit-button[data-gotCode="'+this.getCode()+'"]').node();if(null!=_){const C=n+a.width-71,N=t+a.height-24;let F=_.getBBox();ln('.g-hierarchy[data-primary=true] .hierarchy-uninherit-button[data-gotCode="'+this.getCode()+'"]').classed("dragging",o).attr("transform","translate("+(C-F.x)+" "+(N-F.y)+")")}}getPos(){let n=ln('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]');return{x:parseInt(n.attr("x")),y:parseInt(n.attr("y"))}}getBbox(){let n=ln('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]');return{x:parseInt(n.attr("x")),y:parseInt(n.attr("y"))-3,width:parseInt(n.attr("width")),height:parseInt(n.attr("height"))+3}}getTreeNode(){return this.treeNode}hideRelatedHierarchy(){let n=ln('.g-hierarchy[data-primary="false"]');if(null!=n.node())return n.remove(),this.hierarchyComponent.calculateSvgViewBox(),n.attr("data-code")}renderRelatedHierarchiesMenu(){let n=this,t=ln(".g-context-menu");if(null==t.node()){let a=ln("#svg").append("g").classed("g-context-menu",!0),l=this.svgHierarchyType.getRelatedHierarchies(this.getCode());const _=this.authService.isSRA()||this.authService.isOrganizationRA(this.svgHierarchyType.hierarchyType.organizationCode);let C=this.getBbox(),N=C.x+C.width-5,F=C.y+C.height/2-8;const V=20,ue=8,ce=10,Te="#aaaaaa",We="#e4e4e4",it="sans-serif",He=9,et=this.hierarchyComponent.localize("hierarchy.content.relatedHierarchies"),xt=this.hierarchyComponent.localize("hierarchy.content.actionsTitle"),bt=this.hierarchyComponent.localize("hierarchy.content.removeFromHierarchy"),vt=this.hierarchyComponent.localize("hierarchy.content.noRelatedHierarchies"),Vt=this.hierarchyComponent.localize("hierarchy.content.hideRelatedHierarchy"),Dn=this.hierarchyComponent.localize("hierarchy.content.uninherit"),ei=this.hierarchyComponent.localize("hierarchy.content.inherit");let Yn=null!=ln('.g-hierarchy[data-primary="false"]').node(),Hn=_?Yn?2:1:0,Rn=wl(et,He),hi=wl(bt,ue);if(Rn=hi>Rn?hi:Rn,Yn){let fi=wl(Vt,ue);Rn=fi>Rn?fi:Rn}if(null!=this.treeNode.parent&&null!=this.treeNode.parent.data.inheritedHierarchyCode&&""!=this.treeNode.parent.data.inheritedHierarchyCode){let fi=wl(Dn,ue);Rn=fi>Rn?fi:Rn,Hn++}else{let fi=ln('.g-hierarchy[data-primary="false"]');if(null!=fi.node()){let dt=fi.attr("data-code"),fn=this.hierarchyComponent.findHierarchyByCode(dt),kn=null!=new qt(this.hierarchyComponent,ln("#svg"),fn,!0,this.localizeService,this.modalService,this.authService).getNodeByCode(this.getCode()).getTreeNode().parent;if(null==this.treeNode.parent&&kn){let Qn=wl(ei,ue);Rn=Qn>Rn?Qn:Rn,Hn++}}}if(l.length>0)l.forEach(fi=>{let dt=this.hierarchyComponent.findHierarchyByCode(fi),fn=dt.label.localizedValue;null!=this.treeNode.parent&&this.treeNode.parent.data.inheritedHierarchyCode===dt.code&&(fn=fn+" ("+this.hierarchyComponent.localize("hierarchy.content.inherited")+")");let Pt=wl(fn,ue);Pt>Rn&&(Rn=Pt)});else{let fi=wl(vt,ue);Rn=fi>Rn?fi:Rn}Rn+=ce;let qo=l.length>0?Hn+2:Hn+3;if(a.append("rect").classed("contextmenu-relatedhiers-background",!0).attr("x",N).attr("y",F).attr("rx",5).attr("width",Rn).attr("height",V*(l.length+qo)).attr("fill","white").attr("stroke-width",.5).attr("stroke",Te),a.append("text").classed("contextmenu-relatedhiers-title",!0).attr("x",N+ce/2).attr("y",F+V/2+He/2).attr("font-size",He).attr("font-family",it).attr("font-weight","bold").text(et),F+=V,a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",N).attr("y1",F).attr("x2",N+Rn).attr("y2",F).attr("stroke",Te).attr("stroke-width",.5),l.length>0)for(let fi=0;fi<l.length;++fi){let dt=l[fi],fn=this.hierarchyComponent.findHierarchyByCode(dt),Pt=fn.label.localizedValue;null!=this.treeNode.parent&&this.treeNode.parent.data.inheritedHierarchyCode===fn.code&&(Pt=Pt+" ("+this.hierarchyComponent.localize("hierarchy.content.inherited")+")"),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("data-hierCode",dt).attr("x",N+ce/2).attr("y",F+V/2+ue/2).attr("font-size",ue).attr("font-family",it).text(Pt).style("cursor","pointer").on("click",function(kn,Qn){n.renderSecondaryHierarchy(fn)}),F+=V,fi<l.length&&a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("data-hierCode",dt).attr("x1",N+5).attr("y1",F).attr("x2",N+Rn-5).attr("y2",F).attr("stroke",We).attr("stroke-width",.5)}else a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",N+ce/2).attr("y",F+V/2+ue/2).attr("font-size",ue).attr("font-family",it).text(vt),F+=V,a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",N+5).attr("y1",F).attr("x2",N+Rn-5).attr("y2",F).attr("stroke",We).attr("stroke-width",.5);if(_)if(a.append("text").classed("contextmenu-relatedhiers-title",!0).attr("x",N+ce/2).attr("y",F+V/2+He/2).attr("font-size",He).attr("font-family",it).attr("font-weight","bold").text(xt),F+=V,a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",N).attr("y1",F).attr("x2",N+Rn).attr("y2",F).attr("stroke",Te).attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("data-remove","REPLACE---gotCode").attr("x",N+ce/2).attr("y",F+V/2+ue/2).attr("font-size",ue).attr("font-family",it).text(bt).style("cursor","pointer").on("click",function(fi,dt){n.removeGotFromHierarchy()}),F+=V,null!=this.treeNode.parent&&null!=this.treeNode.parent.data.inheritedHierarchyCode&&""!=this.treeNode.parent.data.inheritedHierarchyCode)a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",N).attr("y1",F).attr("x2",N+Rn).attr("y2",F).attr("stroke",Te).attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",N+ce/2).attr("y",F+V/2+ue/2).attr("font-size",ue).attr("font-family",it).text(Dn).style("cursor","pointer").on("click",function(fi,dt){n.onClickUninheritHierarchy()}),F+=V;else{let fi=ln('.g-hierarchy[data-primary="false"]');if(null!=fi.node()){let dt=fi.attr("data-code"),fn=this.hierarchyComponent.findHierarchyByCode(dt),kn=null!=new qt(this.hierarchyComponent,ln("#svg"),fn,!0,this.localizeService,this.modalService,this.authService).getNodeByCode(this.getCode()).getTreeNode().parent;null==this.treeNode.parent&&kn&&(a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",N).attr("y1",F).attr("x2",N+Rn).attr("y2",F).attr("stroke",Te).attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",N+ce/2).attr("y",F+V/2+ue/2).attr("font-size",ue).attr("font-family",it).text(ei).style("cursor","pointer").on("click",function(Qn,Vn){n.onClickInheritHierarchy(fn)}),F+=V)}}Yn&&(a.append("line").classed("contextmenu-relatedhiers-divider",!0).attr("x1",N).attr("y1",F).attr("x2",N+Rn).attr("y2",F).attr("stroke",Te).attr("stroke-width",.5),a.append("text").classed("contextmenu-relatedhiers-text",!0).attr("x",N+ce/2).attr("y",F+V/2+ue/2).attr("font-size",ue).attr("font-family",it).text(Vt).style("cursor","pointer").on("click",function(fi,dt){n.hideRelatedHierarchy();let fn=ln(".g-context-menu");null!=fn.node()&&fn.remove(),ln(".g-hierarchy-got-connector").remove()})),this.hierarchyComponent.calculateSvgViewBox()}else t.remove()}removeGotFromHierarchy(){let n=this.hierarchyComponent.primarySvgHierarchy.getNodeByCode(this.geoObjectType.code),t=this.hierarchyComponent.findGeoObjectTypeByCode(n.getCode());this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});let o=this.localizeService.decode("confirm.modal.verify.remove.hierarchy");o=o.replace("{label}",t.label.localizedValue),this.bsModalRef.content.message=o,this.bsModalRef.content.data=t.code,this.bsModalRef.content.onConfirm.subscribe(a=>{let l=n.getTreeNode(),_=null;_=null==l.parent||null!=l.parent.data.inheritedHierarchyCode?"ROOT":l.parent.data.geoObjectType,this.hierarchyComponent.removeFromHierarchy(_,n.getCode(),C=>{console.log(C)})})}renderSecondaryHierarchy(n){ln(".g-context-menu").remove(),ln(".g-hierarchy-got-connector").remove();let t=this.getBbox(),o=ln("#svg");if(this.hideRelatedHierarchy()===n.code)return;let a=ln(".g-hierarchy[data-primary=true]").node().getBBox();new qt(this.hierarchyComponent,o,n,!1,this.localizeService,this.modalService,this.authService).render();let _=ln('.g-hierarchy[data-primary="false"]'),N=ln('.g-hierarchy[data-primary="false"]').node().getBBox(),F=a.width+40+(a.x-N.x);_.attr("transform","translate("+F+" 0)");let V=ln('.g-hierarchy[data-primary=false] .svg-got-body-rect[data-gotCode="'+this.getCode()+'"]'),ue={x:parseInt(V.attr("x")),y:parseInt(V.attr("y"))-3,width:parseInt(V.attr("width")),height:parseInt(V.attr("height"))+3};ue.x=ue.x+F,ln(".g-hierarchy-got-connector").remove();let ce=ln("#svg").append("g").classed("g-hierarchy-got-connector",!0);ce.append("path").classed("hierarchy-got-connector",!0).attr("fill","none").attr("stroke","#555").attr("stroke-opacity",.4).attr("stroke-dasharray","5,5").attr("stroke-width",1.5).attr("d","M"+(t.x+t.width)+","+(t.y+t.height/2)+"H"+((ue.x-(t.x+t.width))/2+t.x+t.width)+"V"+(ue.y+ue.height/2)+"H"+ue.x);let We=ce.append("g").classed("g-hierarchy-got-connector-arrow",!0);We.append("rect").classed("hierarchy-got-connector-arrow-rect",!0).attr("x",t.x+t.width-3.5).attr("y",t.y+t.height/2-5).attr("width",7).attr("height",10).attr("fill",ny),We.append("path").classed("hierarchy-got-connector-arrow-path",!0).attr("fill","none").attr("stroke","white").attr("stroke-width",1.5).attr("d","M"+(t.x+t.width-3.5+14/3)+","+(t.y+t.height/2-5+20/3)+"L"+(t.x+t.width+3.5-14/3)+","+(t.y+t.height/2)+"L"+(t.x+t.width-3.5+14/3)+","+(t.y+t.height/2-5+10/3)),this.hierarchyComponent.calculateSvgViewBox()}onClickInheritHierarchy(n){this.hierarchyComponent.handleInheritHierarchy(this.svgHierarchyType.getCode(),n.code,this.getCode())}onClickUninheritHierarchy(){this.hierarchyComponent.handleUninheritHierarchy(this.svgHierarchyType.getCode(),this.getCode())}}class qt{constructor(n,t,o,a,l,_,C){this.localizationService=l,this.modalService=_,this.authService=C;const N=o;this.hierarchyComponent=n,this.hierarchyType=N,this.svgEl=t,this.d3Hierarchy=Zh(N.rootGeoObjectTypes[0]),this.isPrimary=a,this.d3Tree=Ry().nodeSize([qt.gotRectW*$y,(qt.gotRectH+qt.gotHeaderH)*Wy]).separation((F,V)=>.8)(this.d3Hierarchy)}getD3Tree(){return this.d3Tree}getCode(){return this.hierarchyType.code}getNodeByCode(n){let t=this.getD3Tree().find(o=>o.data.geoObjectType===n);return null==t?null:new HT(this.hierarchyComponent,this,this.hierarchyComponent.findGeoObjectTypeByCode(n),t,this.localizationService,this.modalService,this.authService)}renderHierarchyHeader(n,t){let o=n.node().getBBox(),a=n.append("g").classed("g-hierarchy-header",!0),l=n.append("g").classed("g-hierarchy-header",!0);let F=wl(this.hierarchyType.label.localizedValue,10),V=20,ue=o.y+16;F>200&&(F=200,V=30,ue=o.y+10);let ce=o.width,Te=F+20;Te>ce&&(ce=Te),l.append("text").classed("hierarchy-header-icon",!0).attr("x",o.x).attr("y",o.y).style("font-family","FontAwesome").attr("fill","grey").attr("font-size",12).text("\uf0e8"),a.append("foreignObject").classed("hierarchy-header-label",!0).attr("font-size",10).attr("stroke-linejoin","round").attr("stroke-width",3).attr("x",o.x+20).attr("y",ue).attr("width",F).attr("height",V).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("text-anchor","start").attr("text-align","left").style("vertical-align","middle").style("display","table-cell").style("color","gray").style("height",qt.gotRectH-4+"px").html(it=>this.hierarchyType.label.localizedValue),l.append("line").classed("hierarchy-header-line",!0).attr("x1",o.x).attr("y1",o.y+10).attr("x2",o.x+ce).attr("y2",o.y+10).attr("stroke","grey").attr("stroke-width",.5);let We=l.node().getBBox();return l.attr("transform","translate(0 -"+We.height+")"),a.append("text").classed("hierarchy-header-label",!0).attr("font-size",12).attr("font-weight","bold").attr("stroke-linejoin","round").attr("stroke-width",3).attr("fill","grey").attr("x",o.x).attr("y",o.y).text(t),a.attr("transform","translate(0 -"+2.5*We.height+")"),l}getRelatedHierarchies(n){let t=this.hierarchyComponent.findGeoObjectTypeByCode(n);null==t.relatedHierarchies&&(t.relatedHierarchies=this.hierarchyComponent.calculateRelatedHierarchies(t));let o=t.relatedHierarchies,a=null;for(let l=0;l<o.length;++l)o[l]===this.getCode()&&(a=l);return null!=a&&o.splice(a,1),o}nodeMouseover(n,t,o){ln("#NodeTooltip").style("opacity",1)}nodeMousemove(n,t,o){ln("#hierarchyLabel").html(this.hierarchyType.label.localizedValue),ln("#hierarchyCodeLabel").html(this.hierarchyType.code),ln("#geoObjectTypeLabel").html(o.data.label),ln("#geoObjectTypeCodeLabel").html(o.data.geoObjectType),ln("#hierarchyOrganizationLabel").html(this.hierarchyComponent.findOrganizationByCode(this.hierarchyType.organizationCode).label.localizedValue),ln("#geoObjectTypeOrganizationLabel").html(this.hierarchyComponent.findOrganizationByCode(this.hierarchyComponent.findGeoObjectTypeByCode(o.data.geoObjectType).organizationCode).label.localizedValue);let l=ln("#NodeTooltip").node().getBoundingClientRect(),_={x:n.pageX,y:n.pageY};n.pageY+l.height+50>document.documentElement.scrollHeight&&(_.y=n.pageY-l.height-50),n.pageX+l.width+0>document.documentElement.scrollWidth&&(_.x=n.pageX-l.width-0),ln("#NodeTooltip").style("left",_.x+"px").style("top",_.y+"px")}nodeMouseleave(n,t,o){ln("#NodeTooltip").style("opacity",0).style("left","-10000px").style("top","-10000px")}render(){let n=this,t=this.d3Tree.descendants();ln('.g-hierarchy[data-primary="false"]').remove(),this.isPrimary&&ln('.g-hierarchy[data-primary="true"]').remove();let o=this.svgEl.insert("g",".g-hierarchy").classed("g-hierarchy",!0).attr("data-code",this.hierarchyType.code).attr("data-primary",this.isPrimary);o.attr("font-family","sans-serif");let a=o.append("g").classed("g-hierarchy-tree",!0).attr("data-code",this.hierarchyType.code);a.append("g").classed("g-got-edge",!0).attr("fill","none").attr("stroke","#555").attr("stroke-opacity",.4).attr("stroke-width",1.5).selectAll("path").data(this.d3Tree.links()).join("path").attr("d",(F,V)=>"M"+F.source.x+","+F.source.y+"V"+(F.source.y+F.target.y)/2+"H"+F.target.x+"V"+F.target.y);let l=a.append("g").classed("g-got-header",!0);l.selectAll("rect").data(t).join("rect").filter(function(F){return"GhostNode"!==F.data.geoObjectType}).classed("svg-got-header-rect",!0).attr("x",F=>F.x-qt.gotRectW/2).attr("y",F=>F.y-qt.gotRectH/2-qt.gotHeaderH+4).attr("fill",F=>this.isPrimary?null!=F.data.inheritedHierarchyCode?ty:Xy:ny).attr("width",qt.gotHeaderW).attr("height",qt.gotHeaderH).attr("cursor",F=>this.isPrimary?null!=F.data.inheritedHierarchyCode?null:"grab":null).attr("rx",3).attr("data-gotCode",F=>F.data.geoObjectType).attr("data-inherited",F=>null!=F.data.inheritedHierarchyCode).on(qt.MOUSE_HOVER_EVENT_ENTER,function(F,V){n.nodeMouseover(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_MOVE,function(F,V){n.nodeMousemove(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_EXIT,function(F,V){n.nodeMouseleave(F,this,V)}),l.selectAll("foreignObject").data(t).join("foreignObject").filter(function(F){return"GhostNode"!==F.data.geoObjectType}).classed("svg-got-header-rect",!0).attr("x",F=>F.x-qt.gotHeaderW/2).attr("y",F=>F.y-qt.gotRectH/2-qt.gotHeaderH+4).attr("font-size",qt.gotHeaderFontSize+"px").attr("cursor",F=>this.isPrimary?null!=F.data.inheritedHierarchyCode?null:"grab":null).attr("data-gotCode",F=>F.data.geoObjectType).attr("data-inherited",F=>null!=F.data.inheritedHierarchyCode).attr("font-family","sans-serif").attr("font-weight","bold").attr("font-size",qt.gotHeaderFontSize).attr("stroke-linejoin","round").attr("stroke-width",3).attr("width",qt.gotHeaderW).attr("height",qt.gotHeaderH-4).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("fill","white").attr("height",qt.gotHeaderH-4).style("text-align","center").style("vertical-align","middle").style("display","table-cell").style("color","white").style("height",qt.gotHeaderH-4+"px").style("width",qt.gotHeaderW+"px").html(function(F){let V=null!=F.data.inheritedHierarchyCode?n.hierarchyComponent.findHierarchyByCode(F.data.inheritedHierarchyCode).label.localizedValue:n.hierarchyType.label.localizedValue;return wl(V,qt.gotHeaderFontSize)>qt.gotHeaderW-5&&(V=V.substring(0,34)+"..."),V}).on(qt.MOUSE_HOVER_EVENT_ENTER,function(F,V){n.nodeMouseover(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_MOVE,function(F,V){n.nodeMousemove(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_EXIT,function(F,V){n.nodeMouseleave(F,this,V)}),a.append("g").classed("g-got",!0).selectAll("rect").data(t).join("rect").filter(function(F){return"GhostNode"!==F.data.geoObjectType}).classed("svg-got-body-rect",!0).attr("x",F=>F.x-qt.gotRectW/2).attr("y",F=>F.y-qt.gotRectH/2).attr("fill",F=>null!=F.data.inheritedHierarchyCode?EM:PM).attr("width",qt.gotRectW).attr("height",qt.gotRectH).attr("rx",3).attr("cursor",F=>this.isPrimary?null!=F.data.inheritedHierarchyCode?null:"grab":null).attr("data-gotCode",F=>F.data.geoObjectType).attr("data-inherited",F=>null!=F.data.inheritedHierarchyCode).each(function(F){"GhostNode"!==F.data.geoObjectType&&(F.data.dropZoneBbox=F.data.activeDropZones?{x:F.x-qt.gotRectW/2,y:F.y-2*qt.gotRectH,width:2*qt.gotRectW+100,height:4*qt.gotRectH}:{x:F.x-qt.gotRectW/2,y:F.y-qt.gotRectH/2,width:qt.gotRectW,height:qt.gotRectH})}).on(qt.MOUSE_HOVER_EVENT_ENTER,function(F,V){n.nodeMouseover(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_MOVE,function(F,V){n.nodeMousemove(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_EXIT,function(F,V){n.nodeMouseleave(F,this,V)});let N,C=a.append("g").classed("g-got-connector-arrow",!0);C.selectAll("rect").data(this.d3Tree.links()).join("rect").classed("got-connector-arrow-rect",!0).attr("x",F=>F.source.x-5).attr("y",F=>F.source.y+qt.gotRectH/2-3.5).attr("width",10).attr("height",7).attr("fill",F=>this.isPrimary?null!=F.source.data.inheritedHierarchyCode?ty:Xy:ny),C.selectAll("path").data(this.d3Tree.links()).join("path").classed("got-connector-arrow-path",!0).attr("fill","none").attr("stroke","white").attr("stroke-width",1.5).attr("d",F=>"M"+(F.source.x-5+20/3)+","+(F.source.y+qt.gotRectH/2-3.5+14/3)+"L"+F.source.x+","+(F.source.y+qt.gotRectH/2-3.5+7/3)+"L"+(F.source.x-5+10/3)+","+(F.source.y+qt.gotRectH/2+3.5-7/3)),a.append("g").classed("g-sibling-ghost-backer",!0).selectAll("rect").data(t).join("rect").filter(function(F){return"GhostNode"===F.data.geoObjectType}).classed("svg-sibling-ghost-backer-dz",!0).attr("x",F=>F.x-qt.gotRectW/2).attr("y",F=>F.y-qt.gotRectH/2).attr("width",qt.gotRectW).attr("height",qt.gotRectH).attr("fill","white"),a.append("g").classed("g-sibling-ghost-body",!0).selectAll("rect").data(t).join("rect").filter(function(F){return"GhostNode"===F.data.geoObjectType}).classed("svg-sibling-ghost-body-dz",!0).attr("x",F=>F.x-qt.gotRectW/2).attr("y",F=>F.y-qt.gotRectH/2).attr("width",qt.gotRectW).attr("height",qt.gotRectH).attr("fill","none").attr("stroke","#6BA542").attr("stroke-width","1").attr("stroke-dasharray","5,5").attr("data-gotCode",F=>F.data.geoObjectType),a.append("g").classed("g-got-codelabel",!0).attr("font-family","sans-serif").attr("font-size",qt.gotBodyFontSize).attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("foreignObject").data(t).join("foreignObject").classed("svg-got-label-text",!0).attr("x",F=>F.x-qt.gotRectW/2+5).attr("y",F=>F.y-qt.gotRectH/2+2).attr("width",qt.gotRectW-32+5).attr("height",qt.gotRectH-4).attr("cursor",F=>this.isPrimary?null!=F.data.inheritedHierarchyCode?null:"grab":null).attr("data-gotCode",F=>F.data.geoObjectType).attr("data-inherited",F=>null!=F.data.inheritedHierarchyCode).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("text-anchor","start").attr("text-align","left").style("vertical-align","middle").style("display","table-cell").style("width",qt.gotRectW-32+5+"px").style("height",qt.gotRectH-4+"px").html(F=>F.data.label).on(qt.MOUSE_HOVER_EVENT_ENTER,function(F,V){n.nodeMouseover(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_MOVE,function(F,V){n.nodeMousemove(F,this,V)}).on(qt.MOUSE_HOVER_EVENT_EXIT,function(F,V){n.nodeMouseleave(F,this,V)}),this.isPrimary?(a.append("g").classed("g-got-relatedhiers-button",!0).selectAll("text").data(t).join("text").filter(function(F){return"GhostNode"!==F.data.geoObjectType&&null==F.data.inheritedHierarchyCode}).classed("svg-got-relatedhiers-button",!0).attr("data-gotCode",F=>F.data.geoObjectType).attr("x",F=>F.x+qt.gotRectW/2-qt.gotOptionsButtonFontSize-3).attr("y",F=>F.y+.8*qt.gotOptionsButtonFontSize-qt.gotOptionsButtonFontSize/2).style("font-family","FontAwesome").style("cursor","pointer").style("fill","#767676").style("font-size",qt.gotOptionsButtonFontSize+"px").text("\uf013").on("click",function(F,V){n.getNodeByCode(V.data.geoObjectType).renderRelatedHierarchiesMenu()}),N=this.renderHierarchyHeader(o,"Selected Hierarchy")):N=this.renderHierarchyHeader(o,"Related Hierarchy")}}qt.gotRectW=150,qt.gotRectH=25,qt.gotBodyFontSize=8,qt.gotOptionsButtonFontSize=12,qt.gotHeaderW=150,qt.gotHeaderH=14,qt.gotHeaderFontSize=8,qt.MOUSE_HOVER_EVENT_ENTER="mouseenter",qt.MOUSE_HOVER_EVENT_MOVE="mousemove",qt.MOUSE_HOVER_EVENT_EXIT="mouseleave";const QT=["myFile"];function KT(i,n){if(1&i&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function $T(i,n){if(1&i&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.code),e.xp6(1),e.Oqu(t.label.localizedValue)}}class Qh{constructor(n,t,o){this.eventService=n,this.localizationService=t,this.bsModalRef=o,this.organizations=[],this.message=null}ngOnInit(){this.onNodeChange=new pn.x}init(n){this.organizations=n,this.uploader=new I.bA({queueLimit:1,removeAfterUpload:!0,url:pt.N.apiUrl+"/api/cgr/import-types"}),this.uploader.onBuildItemForm=(o,a)=>{a.append("orgCode",this.orgCode)},this.uploader.onBeforeUploadItem=o=>{this.eventService.start()},this.uploader.onCompleteItem=(o,a,l,_)=>{this.fileRef.nativeElement.value="",this.eventService.complete()},this.uploader.onSuccessItem=(o,a,l,_)=>{this.onNodeChange.next(!0),this.bsModalRef.hide()},this.uploader.onErrorItem=(o,a,l,_)=>{const C=JSON.parse(a);this.error({error:C})}}onSelect(n){this.orgCode=n.target.value}onClick(){null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizationService.decode("io.missing.file"),error:{}})}error(n){this.message=Zt.qL.getMessageFromError(n)}}Qh.\u0275fac=function(n){return new(n||Qh)(e.Y36(nn.PO),e.Y36(nn.oQ),e.Y36(Ln.UZ))},Qh.\u0275cmp=e.Xpm({type:Qh,selectors:[["import-types-modal"]],viewQuery:function(n,t){if(1&n&&e.Gf(QT,5),2&n){let o;e.iGM(o=e.CRH())&&(t.fileRef=o.first)}},decls:33,vars:3,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","hierarchy.sidebar.importTypes"],["autocomplete","off",1,"modal-form"],["form","ngForm"],[1,"row-holder"],[1,"label-holder"],["key","attribute.organization.label"],[1,"holder"],[3,"change"],[3,"value",4,"ngFor","ngForOf"],["key","hierarchy.sidebar.xmlFile"],["name","file","type","file","ng2FileSelect","","accept",".xml","required","",1,"ghost-input",3,"uploader"],["myFile",""],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit","role","button","aria-disabled","false",1,"btn","btn-primary",3,"click"],["key","modal.button.ok"],["role","alert",1,"alert","alert-danger"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,KT,2,1,"div",1),e.TgZ(2,"div",2)(3,"h1"),e._UZ(4,"localize",3),e.qZA()(),e.TgZ(5,"form",4,5)(7,"fieldset")(8,"div",6)(9,"div",7)(10,"label"),e._UZ(11,"localize",8),e.qZA()(),e.TgZ(12,"div",9)(13,"select",10),e.NdJ("change",function(a){return t.onSelect(a)}),e._UZ(14,"option"),e.YNc(15,$T,2,2,"option",11),e.qZA()()(),e.TgZ(16,"div",6)(17,"div",7)(18,"label"),e._UZ(19,"localize",12),e.qZA()(),e.TgZ(20,"div",9),e._UZ(21,"input",13,14),e.qZA()(),e.TgZ(23,"div",6),e._UZ(24,"div",7),e.TgZ(25,"div",9)(26,"div",15)(27,"button",16),e.NdJ("click",function(){return t.bsModalRef.hide()}),e.TgZ(28,"span"),e._UZ(29,"localize",17),e.qZA()(),e.TgZ(30,"button",18),e.NdJ("click",function(){return t.onClick()}),e.TgZ(31,"span"),e._UZ(32,"localize",19),e.qZA()()()()()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(14),e.Q6J("ngForOf",t.organizations),e.xp6(6),e.Q6J("uploader",t.uploader))},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.JL,y.F,I.C6,Sn.l],encapsulation:2});var Da=v(82698),ba=v(82883),WT=v(94559);const XT=["*"],eM=function(i){return{"text-muted":i}};function tM(i,n){if(1&i&&(e.TgZ(0,"button",7),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,eM,t.isDisabled)),e.xp6(1),e.hij(" ",t.heading," ")}}const nM=[[["","accordion-heading",""]],"*"],iM=["[accordion-heading]","*"];let Qy=(()=>{class i{constructor(){this.closeOthers=!1,this.isAnimated=!1}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),Ky=(()=>{class i{constructor(t){this.isAnimated=!1,this.groups=[],Object.assign(this,t)}closeOtherPanels(t){!this.closeOthers||this.groups.forEach(o=>{o!==t&&(o.isOpen=!1)})}addGroup(t){t.isAnimated=this.isAnimated,this.groups.push(t)}removeGroup(t){const o=this.groups.indexOf(t);-1!==o&&this.groups.splice(o,1)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Qy))},i.\u0275cmp=e.Xpm({type:i,selectors:[["accordion"]],hostAttrs:["role","tablist",1,"panel-group",2,"display","block"],hostVars:1,hostBindings:function(t,o){2&t&&e.uIk("aria-multiselectable",o.closeOthers)},inputs:{isAnimated:"isAnimated",closeOthers:"closeOthers"},ngContentSelectors:XT,decls:1,vars:0,template:function(t,o){1&t&&(e.F$t(),e.Hsn(0))},encapsulation:2}),i})(),oM=(()=>{class i{constructor(t){this.isAnimated=!1,this.isOpenChange=new e.vpe,this._isOpen=!1,this.accordion=t}get isOpen(){return this._isOpen}set isOpen(t){t!==this.isOpen&&(t&&this.accordion.closeOtherPanels(this),this._isOpen=t,Promise.resolve(null).then(()=>{this.isOpenChange.emit(t)}).catch(o=>{console.log(o)}))}get isBs3(){return(0,WT.XA)()}ngOnInit(){this.panelClass=this.panelClass||"panel-default",this.accordion.addGroup(this)}ngOnDestroy(){this.accordion.removeGroup(this)}toggleOpen(){this.isDisabled||(this.isOpen=!this.isOpen)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Ky))},i.\u0275cmp=e.Xpm({type:i,selectors:[["accordion-group"],["accordion-panel"]],hostAttrs:[1,"panel",2,"display","block"],hostVars:2,hostBindings:function(t,o){2&t&&e.ekj("panel-open",o.isOpen)},inputs:{isOpen:"isOpen",panelClass:"panelClass",heading:"heading",isDisabled:"isDisabled"},outputs:{isOpenChange:"isOpenChange"},ngContentSelectors:iM,decls:9,vars:6,consts:[[1,"panel","card",3,"ngClass"],["role","tab",1,"panel-heading","card-header",3,"ngClass","click"],[1,"panel-title"],["role","button",1,"accordion-toggle"],["class","btn btn-link","type","button",3,"ngClass",4,"ngIf"],["role","tabpanel",1,"panel-collapse","collapse",3,"collapse","isAnimated"],[1,"panel-body","card-block","card-body"],["type","button",1,"btn","btn-link",3,"ngClass"]],template:function(t,o){1&t&&(e.F$t(nM),e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return o.toggleOpen()}),e.TgZ(2,"div",2)(3,"div",3),e.YNc(4,tM,2,4,"button",4),e.Hsn(5),e.qZA()()(),e.TgZ(6,"div",5)(7,"div",6),e.Hsn(8,1),e.qZA()()()),2&t&&(e.Q6J("ngClass",o.panelClass),e.xp6(1),e.Q6J("ngClass",o.isDisabled?"panel-disabled":"panel-enabled"),e.xp6(2),e.uIk("aria-expanded",o.isOpen),e.xp6(1),e.Q6J("ngIf",o.heading),e.xp6(2),e.Q6J("collapse",!o.isOpen)("isAnimated",o.isAnimated))},dependencies:[T.mk,T.O5,W.Y],styles:["[_nghost-%COMP%]   .card-header.panel-enabled[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .card-header.panel-disabled[_ngcontent-%COMP%]   .btn.btn-link[_ngcontent-%COMP%]{cursor:default;text-decoration:none}"]}),i})(),rM=(()=>{class i{static forRoot(){return{ngModule:i,providers:[Qy]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[T.ez,W.f]}),i})();const aM=["searchInput"],sM=["nodeMenu"],lM=["leafMenu"];function cM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",42)(1,"button",43),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.createGeoObjectType(null,!1,a.org))}),e._UZ(2,"localize",44),e.qZA(),e.TgZ(3,"button",45),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.createGeoObjectType(null,!0,a.org))}),e._UZ(4,"localize",46),e.qZA()()}}function uM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",53),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(2);return e.KtG(l.deleteGeoObjectType(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"button.delete.helptext"))}function pM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",54),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw().$implicit,_=e.oxw();return e.KtG(_.createGeoObjectType(a,!1,l.org))}),e.qZA()}}function dM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",49),e.YNc(1,uM,2,3,"i",50),e.TgZ(2,"i",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.manageGeoObjectType(a,!1))}),e.ALo(3,"localize"),e.qZA(),e.YNc(4,pM,1,0,"i",52),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!o.excludeGeoObjectTypeDeletes(t)),e.xp6(1),e.Q6J("title",e.lcZ(3,3,"button.edit.helptext")),e.xp6(2),e.Q6J("ngIf",t.isAbstract)}}function hM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",49)(1,"i",55),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.manageGeoObjectType(a,!0))}),e.ALo(2,"localize"),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("title",e.lcZ(2,1,"button.view.helptext")))}const fM=function(i,n){return{"got-group-parent":i,"got-group-child":n}};function gM(i,n){if(1&i&&(e.TgZ(0,"li",47),e._uU(1),e.YNc(2,dM,5,5,"span",48),e.YNc(3,hM,3,3,"span",48),e.qZA()),2&i){const t=n.$implicit;e.Q6J("id",t.code)("ngClass",e.WLB(7,fM,t.isAbstract,t.superTypeCode&&t.superTypeCode.length>0)),e.uIk("data-superTypeCode",t.superTypeCode&&t.superTypeCode.length>0?t.superTypeCode:null)("data-canDrag",t.canDrag),e.xp6(1),e.hij(" ",t.label.localizedValue," "),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("WRITE")),e.xp6(1),e.Q6J("ngIf",!t.permissions.includes("WRITE")&&t.permissions.includes("READ"))}}function _M(i,n){if(1&i&&(e.TgZ(0,"ul",39)(1,"div")(2,"div",40)(3,"label"),e._uU(4),e.qZA()(),e.YNc(5,cM,5,0,"div",18),e.YNc(6,gM,4,10,"li",41),e.qZA()()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(4),e.Oqu(t.org.label.localizedValue),e.xp6(1),e.Q6J("ngIf",o.isSRA||t.org.code===o.userOrganization),e.xp6(1),e.Q6J("ngForOf",t.types)}}function mM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",42)(1,"button",43),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.createHierarchy())}),e._UZ(2,"localize",57),e.qZA()()}}function yM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",53),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(2);return e.KtG(l.deleteHierarchyType(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"button.delete.helptext"))}function vM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",60),e.YNc(1,yM,2,3,"i",50),e.TgZ(2,"i",61),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.editHierarchyType(a,!1))}),e.ALo(3,"localize"),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!o.excludeHierarchyTypeDeletes(t)),e.xp6(1),e.Q6J("title",e.lcZ(3,2,"button.edit.helptext"))}}function bM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",60)(1,"i",62),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.editHierarchyType(a,!0))}),e.ALo(2,"localize"),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("title",e.lcZ(2,1,"button.view.helptext")))}const xM=function(i,n){return{primary:i,active:n}};function CM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",58),e.NdJ("click",function(a){const _=e.CHM(t).$implicit,C=e.oxw(2);return e.KtG(C.hierarchyOnClick(a,_))}),e._UZ(1,"i",16),e._uU(2),e.YNc(3,vM,4,4,"span",59),e.YNc(4,bM,3,3,"span",59),e.qZA()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.Q6J("id",t.code)("ngClass",e.WLB(5,xM,null!=o.currentHierarchy&&t.code===o.currentHierarchy.code,o.isActive(t))),e.xp6(2),e.hij(" ",t.label.localizedValue," "),e.xp6(1),e.Q6J("ngIf",o.isOrganizationRA(t.organizationCode)),e.xp6(1),e.Q6J("ngIf",!o.isOrganizationRA(t.organizationCode))}}function wM(i,n){if(1&i&&(e.TgZ(0,"ul",39)(1,"div")(2,"div",40)(3,"label"),e._uU(4),e.qZA()(),e.YNc(5,mM,3,0,"div",18),e.YNc(6,CM,5,8,"li",56),e.qZA()()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(4),e.Oqu(t.org.label.localizedValue),e.xp6(1),e.Q6J("ngIf",o.isSRA||t.org.code===o.userOrganization),e.xp6(1),e.Q6J("ngForOf",t.hierarchies)}}function TM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",42)(1,"button",43),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.importTypes())}),e._UZ(2,"localize",63),e.qZA()()}}function MM(i,n){1&i&&(e.TgZ(0,"div",65)(1,"div",66)(2,"div",67)(3,"p",68),e._UZ(4,"localize",69),e.qZA()()()())}function OM(i,n){1&i&&(e.TgZ(0,"div")(1,"p",68),e._UZ(2,"localize",70),e.qZA()())}function SM(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,MM,5,0,"div",64),e.YNc(2,OM,3,0,"div",21),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isOrganizationRA(t.currentHierarchy.organizationCode,!0)),e.xp6(1),e.Q6J("ngIf",!t.isOrganizationRA(t.currentHierarchy.organizationCode,!0))}}const $y=1.8,Wy=1.8,PM="#e6e6e6",Xy="#A29BAB",EM="#d4d4d4",ty="#a0a0a0",ny=ty;class AM{}class Sd{constructor(n,t,o,a,l,_){this.modalService=t,this.contextMenuService=o,this.registryService=l,this.authService=_,this.userOrganization=null,this.currentHierarchy=null,this.instance=new AM,this.geoObjectTypes=[],this.hierarchiesByOrg=[],this.typesByOrg=[],this.filter="",this.filteredHierarchiesByOrg=[],this.filteredTypesByOrg=[],this.hierarchyTypeDeleteExclusions=["AllowedIn","IsARelationship"],this.geoObjectTypeDeleteExclusions=["ROOT"],this._opened=!1,this.isSRA=!1,this.options={displayField:"label",actionMapping:{mouse:{click:(C,N,F)=>{this.treeNodeOnClick(N,F)},contextMenu:(C,N,F)=>{this.handleOnMenu(N,F)}}},mouse:{}},this.isSRA=_.isSRA(),this.hierarchyService=n,this.localizeService=a}ngOnInit(){this.refreshAll(null),(0,Gf.R)(this.searchInput.nativeElement,"keyup").pipe((0,B.h)(Boolean),(0,Xd.b)(500),(0,qw.x)(),(0,ra.b)(()=>{this.onFilterChange()})).subscribe()}localize(n){return this.localizeService.decode(n)}renderTree(){if(null==this.currentHierarchy||null==this.currentHierarchy.rootGeoObjectTypes||0==this.currentHierarchy.rootGeoObjectTypes.length){ln("#svg").remove();let _=!1;return null!=this.currentHierarchy&&(_=this.authService.isSRA()||this.authService.isOrganizationRA(this.currentHierarchy.organizationCode)),void this.geoObjectTypes.forEach(C=>{C.canDrag=_})}ln(".g-context-menu").remove(),ln(".hierarchy-inherit-button").remove(),ln(".g-hierarchy-got-connector").remove();let n=ln("#overflow-div").node(),t=n.scrollLeft,o=n.scrollRight,a=ln("#svg");null==a.node()&&(a=ln("#svgHolder").append("svg"),a.attr("id","svg")),this.primarySvgHierarchy=new qt(this,a,this.currentHierarchy,!0,this.localizeService,this.modalService,this.authService),this.primarySvgHierarchy.render(),this.calculateSvgViewBox();let l=ln("#overflow-div").node();l.scrollLeft=t,l.scrollRight=o,this.geoObjectTypes.forEach(_=>{_.canDrag=this.calculateCanDrag(_)})}calculateSvgViewBox(){let n=ln("#svg"),t=n.node(),{x:o,y:a,width:l,height:_}=t.getBBox();n.attr("viewBox",o-30+" "+(a-40)+" "+(l+60)+" "+(_+80)),l=(l+60)*$y,_=(_+80)*Wy,ln("#svgHolder").style("width",l+"px")}calculateCanDrag(n){let t=this;if(null==this.primarySvgHierarchy)return!1;if(!this.authService.isSRA()&&!this.authService.isOrganizationRA(this.currentHierarchy.organizationCode)||null!=this.primarySvgHierarchy.getNodeByCode(n.code))return!1;if(n.isAbstract){let o=!1;if(this.geoObjectTypes.forEach(a=>{a.superTypeCode===n.code&&null!=t.primarySvgHierarchy.getNodeByCode(a.code)&&(o=!0)}),o)return!1}else if(null!=n.superTypeCode&&null!=t.primarySvgHierarchy.getNodeByCode(n.superTypeCode))return!1;return!0}calculateRelatedHierarchies(n){let t=[];for(let o=0;o<this.hierarchies.length;++o){let a=this.hierarchies[o];null!=a.rootGeoObjectTypes&&a.rootGeoObjectTypes.length>0&&Zh(a.rootGeoObjectTypes[0]).descendants().find(C=>C.data.geoObjectType===n.code&&null==C.data.inheritedHierarchyCode)&&t.push(a.code)}return t}registerDragHandlers(){let o,a,l,n=this,t=[];t.push({dropSelector:".drop-box-container",onDrag:function(C,N){if(null!=this.dropEl&&(this.dropEl.style("border-color",null),this.dropEl=null),null!=N){let F=N.closest(".drop-box-container");null!=F&&(this.dropEl=ln(F).style("border-color","#6BA542"))}},onDrop:function(C){null!=this.dropEl&&(this.dropEl.style("border-color",null),n.addChild(n.currentHierarchy.code,"ROOT",ln(C).attr("id")),this.dropEl=null)}}),t.push({dropSelector:".svg-got-body-rect",onDrag:function(C,N,F){this.clearDropZones();let V=this.dropEl;if(null==ln("#svg").node())return;let ce=jm(F.sourceEvent.pageX,F.sourceEvent.pageY);if(n.primarySvgHierarchy.getD3Tree().descendants().forEach(Te=>{"GhostNode"!==Te.data.geoObjectType&&Tl(ce,Te.data.dropZoneBbox)?(this.dropEl=ln('.g-hierarchy[data-primary=true] .svg-got-body-rect[data-gotCode="'+Te.data.geoObjectType+'"]'),Te.data.activeDropZones=!0,null==Te.parent&&(Te.data.dropZoneBbox={x:Te.x-qt.gotRectW/2,y:Te.y-2*qt.gotRectH,width:qt.gotRectW,height:4*qt.gotRectH})):(Te.data.activeDropZones=!1,null==Te.parent&&(Te.data.dropZoneBbox={x:Te.x-qt.gotRectW/2,y:Te.y-qt.gotRectH/2,width:qt.gotRectW,height:qt.gotRectH}))}),(null==this.dropEl||null!=V&&null!=this.dropEl&&V.attr("data-gotCode")!=this.dropEl.attr("data-gotCode"))&&this.clearGhostNodes(!0),null!=this.dropEl){let Te=ln(C).classed("got-group-parent");const We=this.dropEl.attr("data-gotCode");let it=n.primarySvgHierarchy.getD3Tree().find(Hn=>Hn.data.geoObjectType===We),He=n.findGeoObjectTypeByCode(We).isAbstract;this.dropEl.attr("stroke","blue");const et=parseInt(this.dropEl.attr("x")),xt=parseInt(this.dropEl.attr("y")),bt=qt.gotRectW,vt=qt.gotRectH;let Vt=ln("#svg").append("g").classed("svg-dropZone-g",!0),Dn=!(null==it.children||0==it.children.length),ei=!(He||Te&&Dn);if(ei){this.childDzBacker=Vt.append("rect").classed("svg-got-child-dz-backer",!0).attr("x",et+qt.gotRectW/2-bt/2).attr("y",xt+qt.gotRectH+10).attr("width",bt).attr("height",vt).attr("fill","white"),this.childDz=Vt.append("rect").classed("svg-got-child-dz",!0).attr("x",et+qt.gotRectW/2-bt/2).attr("y",xt+qt.gotRectH+10).attr("width",bt).attr("height",vt).attr("fill","none").attr("stroke","black").attr("stroke-width","1").attr("stroke-dasharray","5,5");let Hn=n.localizeService.decode(Dn?"hierarchy.content.intersectChild":"hierarchy.content.addChild");this.childDzText=Vt.append("text").classed("svg-got-child-dz-text",!0).attr("font-family","sans-serif").attr("font-size",10).attr("fill","black").attr("x",et+qt.gotRectW/2-wl(Hn,10)/2).attr("y",xt+qt.gotRectH+10+vt/2+2).text(Hn)}if(!Te){this.parentDzBacker=Vt.append("rect").classed("svg-got-parent-dz-backer",!0).attr("x",et+qt.gotRectW/2-bt/2).attr("y",xt-qt.gotHeaderH-vt).attr("width",bt).attr("height",vt).attr("fill","white"),this.parentDz=Vt.append("rect").classed("svg-got-parent-dz",!0).attr("x",et+qt.gotRectW/2-bt/2).attr("y",xt-qt.gotHeaderH-vt).attr("width",bt).attr("height",vt).attr("fill","none").attr("stroke","black").attr("stroke-width","1").attr("stroke-dasharray","5,5"),ln(".svg-got-parent-dz-text").remove();let Hn=n.localizeService.decode(null==it.parent?"hierarchy.content.addParent":"hierarchy.content.intersectParent");this.parentDzText=Vt.append("text").classed("svg-got-parent-dz-text",!0).attr("font-family","sans-serif").attr("font-size",10).attr("fill","black").attr("x",et+qt.gotRectW/2-wl(Hn,10)/2).attr("y",xt-qt.gotHeaderH-vt/2+2).text(Hn)}if(this.ghostCode!=We&&(null!=this.ghostCode&&this.clearGhostNodes(null==it.parent),null!=it.parent)){let Hn=null;for(let hi=0;hi<it.parent.data.children.length;++hi)it.parent.data.children[hi].geoObjectType===We&&(Hn=hi+1);let Rn=n.localizeService.decode("hierarchy.content.addChild");it.parent.data.children.splice(Hn,0,{ghostingCode:We,geoObjectType:"GhostNode",label:Rn,children:[]}),n.renderTree(),this.ghostCode=We}let Yn=ln(".svg-sibling-ghost-body-dz");!Te&&Tl(ce,Bm(this.parentDz))?(this.parentDz.attr("stroke","blue"),this.parentDzText.attr("fill","blue"),ei&&this.childDz.attr("stroke","black"),ei&&this.childDzText.attr("fill","black"),Yn.attr("stroke","black"),this.activeDz=this.parentDz):ei&&Tl(ce,Bm(this.childDz))?(!Te&&this.parentDz.attr("stroke","black"),!Te&&this.parentDzText.attr("fill","black"),this.childDz.attr("stroke","blue"),this.childDzText.attr("fill","blue"),Yn.attr("stroke","black"),this.activeDz=this.childDz):null!=Yn.node()&&Tl(ce,Bm(Yn))&&(!Te&&this.parentDz.attr("stroke","black"),!Te&&this.parentDzText.attr("fill","black"),ei&&this.childDz.attr("stroke","black"),ei&&this.childDzText.attr("fill","black"),Yn.attr("stroke","blue"),this.activeDz="sibling")}},onDrop:function(C){if(null!=this.dropEl&&null!=this.activeDz){let N=this.dropEl.attr("data-gotCode"),F=n.primarySvgHierarchy.getD3Tree().find(ue=>ue.data.geoObjectType===N),V=ln(C).attr("id");if(this.activeDz===this.childDz)if(0==F.data.children.length)n.addChild(n.currentHierarchy.code,N,V);else{let ue="";for(let ce=0;ce<F.data.children.length;++ce)ue+=F.data.children[ce].geoObjectType,ce<F.data.children.length-1&&(ue+=",");n.insertBetweenTypes(n.currentHierarchy.code,N,V,ue)}else this.activeDz===this.parentDz?n.insertBetweenTypes(n.currentHierarchy.code,null==F.parent?"ROOT":F.parent.data.geoObjectType,V,N):"sibling"===this.activeDz&&n.addChild(n.currentHierarchy.code,F.parent.data.geoObjectType,ln(C).attr("id"))}this.clearDropZones(),this.clearGhostNodes(!0)},clearDropZones:function(){null!=this.dropEl&&this.dropEl.attr("stroke",null),this.dropEl=null,this.activeDz=null,this.childDz=null,this.parentDz=null,ln(".svg-dropZone-g").remove()},clearGhostNodes:function(C){if(null!=this.ghostCode){let N=n.primarySvgHierarchy.getD3Tree().find(F=>F.data.ghostingCode===this.ghostCode);if(null!=N){let F=null;for(let V=0;V<N.parent.data.children.length;++V)N.parent.data.children[V].ghostingCode===this.ghostCode&&(F=V);null!=F&&(N.parent.data.children.splice(F,1),C&&n.renderTree())}this.ghostCode=null}}}),Dy().on("start",function(C){if("false"===ln(this).attr("data-candrag"))return;let F=this.getBoundingClientRect();o=F.left-C.sourceEvent.pageX,a=F.top-C.sourceEvent.pageY,l=F.width}).on("drag",function(C){if("false"===ln(this).attr("data-candrag"))return;ln(".g-context-menu").remove();let F=ln(this);F.style("display","none");let V=document.elementFromPoint(C.sourceEvent.pageX,C.sourceEvent.pageY);F.style("display",null);for(let ue=0;ue<t.length;++ue)t[ue].onDrag(this,V,C);if(F.classed("dragging",!0).style("left",C.sourceEvent.pageX+o+"px").style("top",C.sourceEvent.pageY+a+"px").style("width",l+"px"),F.classed("got-group-parent")){let ue=1;Qu('.got-group-child[data-superTypeCode="'+F.attr("id")+'"]').each(function(){ln(this).classed("dragging",!0).style("left",C.sourceEvent.pageX+o+"px").style("top",C.sourceEvent.pageY+a+(this.getBoundingClientRect().height+2)*ue+"px").style("width",l+"px"),ue++})}}).on("end",function(C){let N=ln(this).classed("dragging",!1).style("left",null).style("top",null).style("width",null);N.classed("got-group-parent")&&Qu('.got-group-child[data-superTypeCode="'+N.attr("id")+'"]').each(function(){ln(this).classed("dragging",!1).style("left",null).style("top",null).style("width",null)});for(let F=0;F<t.length;++F)t[F].onDrop(this,C)})(Qu(".sidebar-section-content ul.list-group li.got-li-item"))}registerSvgHandlers(){let t,o,l,_,n=this;Dy().on("start",function(N){let F=jm(N.sourceEvent.pageX,N.sourceEvent.pageY);_=n.primarySvgHierarchy.getNodeByCode(ln(this).attr("data-gotCode")),l=_.getPos(),t=l.x-F.x,o=l.y-F.y}).on("drag",function(N){ln(".g-context-menu").remove();let F=jm(N.sourceEvent.pageX,N.sourceEvent.pageY);_=n.primarySvgHierarchy.getNodeByCode(ln(this).attr("data-gotCode")),_.setPos(F.x+t,F.y+o,!0)}).on("end",function(N){ln("#svg").attr("viewBox").split(" "),_.setPos(l.x,l.y,!1)})(Qu(".svg-got-body-rect[data-inherited=false],.svg-got-label-text[data-inherited=false],.svg-got-header-rect[data-inherited=false]"))}findGeoObjectTypeByCode(n){for(let t=0;t<this.geoObjectTypes.length;++t){let o=this.geoObjectTypes[t];if(o.code===n)return o}}findHierarchyByCode(n){for(let t=0;t<this.hierarchies.length;++t){let o=this.hierarchies[t];if(o.code===n)return o}}findOrganizationByCode(n){for(let t=0;t<this.organizations.length;++t){let o=this.organizations[t];if(o.code===n)return o}}addChild(n,t,o){this.hierarchyService.addChildToHierarchy(n,t,o).then(a=>{let l=this.findGeoObjectTypeByCode(o),_=null;for(let C=0;C<l.relatedHierarchies.length;++C)if(l.relatedHierarchies[C]===n){_=C;break}null==_&&l.relatedHierarchies.push(n),this.refreshPrimaryHierarchy(a)}).catch(a=>{this.error(a)})}insertBetweenTypes(n,t,o,a){this.hierarchyService.insertBetweenTypes(n,t,o,a).then(l=>{this.refreshPrimaryHierarchy(l)}).catch(l=>{this.error(l)})}ngAfterViewInit(){}isRA(){return this.authService.isRA()}isOrganizationRA(n,t=!1){return this.isSRA||this.authService.isOrganizationRA(n)}getTypesByOrg(n){let t=[];for(let o=0;o<this.geoObjectTypes.length;++o){let a=this.geoObjectTypes[o];a.organizationCode===n.code&&t.push(a)}return t}getHierarchiesByOrg(n){let t=[];for(let o=0;o<this.hierarchies.length;++o){let a=this.hierarchies[o];a.organizationCode===n.code&&t.push(a)}return t}refreshAll(n){this.geoObjectTypes=[],this.registryService.init().then(t=>{if(this.localizeService.setLocales(t.locales),this.setGeoObjectTypes(t.types),this.organizations=t.organizations,this.organizations.forEach(a=>{this.isOrganizationRA(a.code)&&(this.userOrganization=a.code)}),!this.authService.isSRA()){let a=this.authService.getMyOrganizations(),l=t.organizations.findIndex(_=>_.code===a[0]);l>=0&&ol.arrayMove(t.organizations,l,0)}let o=this.getGeoObjectTypePosition("ROOT");o&&this.geoObjectTypes.splice(o,1),this.setHierarchies(t.hierarchies),this.setNodesOnInit(n),this.updateViewDatastructures()}).catch(t=>{this.error(t)})}setGeoObjectTypes(n){this.setAbstractTypes(n),n.forEach(t=>{t.isAbstract||t.superTypeCode||this.geoObjectTypes.push(t)}),this.geoObjectTypes.sort((t,o)=>t.label.localizedValue.toLowerCase()<o.label.localizedValue.toLowerCase()?-1:t.label.localizedValue.toLowerCase()>o.label.localizedValue.toLowerCase()?1:0),n.forEach(t=>{if(!t.isAbstract&&t.superTypeCode&&t.superTypeCode.length>0)for(let o=0;o<this.geoObjectTypes.length;o++)t.superTypeCode===this.geoObjectTypes[o].code&&this.geoObjectTypes.splice(o+1,0,t)})}setAbstractTypes(n){n.forEach(t=>{t.isAbstract&&this.geoObjectTypes.push(t)})}updateViewDatastructures(){this.hierarchiesByOrg=[],this.typesByOrg=[];for(let n=0;n<this.organizations.length;++n){let t=this.organizations[n];this.hierarchiesByOrg.push({org:t,hierarchies:this.getHierarchiesByOrg(t)}),this.typesByOrg.push({org:t,types:this.getTypesByOrg(t)})}this.geoObjectTypes.forEach(n=>{n.canDrag=this.calculateCanDrag(n),n.relatedHierarchies=this.calculateRelatedHierarchies(n)}),this.onFilterChange()}excludeHierarchyTypeDeletes(n){return-1!==this.hierarchyTypeDeleteExclusions.indexOf(n.code)}excludeGeoObjectTypeDeletes(n){return-1!==this.geoObjectTypeDeleteExclusions.indexOf(n.code)}setNodesOnInit(n){let t=-1;null!=n?t=this.hierarchies.findIndex(o=>o.code===n.code):this.hierarchies.length>0&&(t=0),t>-1&&(this.setCurrentHierarchy(this.hierarchies[t]),this.renderTree())}getHierarchy(n){let t=null;return this.hierarchies.forEach(o=>{n===o.code&&(t=o)}),t}setHierarchies(n){let t=[];n.forEach((o,a)=>{o.rootGeoObjectTypes.length>0&&o.rootGeoObjectTypes.forEach(l=>{this.processHierarchyNodes(l)}),t.push(o)}),this.hierarchies=t,this.hierarchies.sort((o,a)=>o.label.localizedValue.toLowerCase()<a.label.localizedValue.toLowerCase()?-1:o.label.localizedValue.toLowerCase()>a.label.localizedValue.toLowerCase()?1:0)}processHierarchyNodes(n){null!=n&&(n.label=this.getHierarchyLabel(n.geoObjectType),n.children.forEach(t=>{this.processHierarchyNodes(t)}))}getHierarchyLabel(n){let t=null;return this.geoObjectTypes.forEach(function(o){o.code===n&&(t=o.label.localizedValue)}),t}handleOnMenu(n,t){this.isOrganizationRA(this.currentHierarchy.organizationCode)?(this.contextMenuService.show.next({contextMenu:null!==n.data.childType?this.nodeMenuComponent:this.leafMenuComponent,event:t,item:n}),t.preventDefault(),t.stopPropagation()):(t.preventDefault(),t.stopPropagation())}treeNodeOnClick(n,t){n.treeModel.setFocusedNode(n),n.treeModel.isExpanded(n)?n.collapse():n.treeModel.expandAll()}hierarchyOnClick(n,t){this.setCurrentHierarchy(t),this.renderTree()}createHierarchy(){this.bsModalRef=this.modalService.show(xd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.onHierarchytTypeCreate.subscribe(n=>{this.hierarchies.push(n),this.hierarchies.sort((t,o)=>{let a=t.label.localizedValue.toUpperCase(),l=o.label.localizedValue.toUpperCase();return a<l?-1:a>l?1:0}),this.updateViewDatastructures()})}deleteHierarchyType(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+n.label.localizedValue+"]",this.bsModalRef.content.data=n.code,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.onConfirm.subscribe(t=>{this.removeHierarchyType(t)})}editHierarchyType(n,t){this.bsModalRef=this.modalService.show(xd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.edit=!0,this.bsModalRef.content.readOnly=t,this.bsModalRef.content.hierarchyType=n,this.bsModalRef.content.onHierarchytTypeCreate.subscribe(o=>{let a=this.getHierarchyTypePosition(o.code);this.hierarchies[a].label=o.label,this.hierarchies[a].description=o.description,this.hierarchies[a].progress=o.progress,this.hierarchies[a].acknowledgement=o.acknowledgement,this.hierarchies[a].disclaimer=o.disclaimer,this.hierarchies[a].useConstraints=o.useConstraints,this.hierarchies[a].accessConstraints=o.accessConstraints,this.hierarchies[a].contact=o.contact,this.hierarchies[a].phoneNumber=o.phoneNumber,this.hierarchies[a].email=o.email,this.updateViewDatastructures(),this.currentHierarchy.code===o.code&&(this.setCurrentHierarchy(this.hierarchies[a]),this.renderTree())})}setCurrentHierarchy(n){this.currentHierarchy=n}isPrimaryHierarchy(n){return n.code===this.currentHierarchy.code}removeHierarchyType(n){this.hierarchyService.deleteHierarchyType(n).then(t=>{let o=this.getHierarchyTypePosition(n);this.hierarchies.splice(o,1),this.updateViewDatastructures(),this.hierarchies.length>0?this.setCurrentHierarchy(this.hierarchies[0]):this.currentHierarchy=null,this.renderTree()}).catch(t=>{this.error(t)})}createGeoObjectType(n,t,o){this.bsModalRef=this.modalService.show(Gh,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(o,this.geoObjectTypes,n,t),this.bsModalRef.content.onGeoObjTypeCreate.subscribe(a=>{a.relatedHierarchies=this.calculateRelatedHierarchies(a),this.refreshAll(this.currentHierarchy)})}deleteGeoObjectType(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+n.label.localizedValue+"]",this.bsModalRef.content.data=n.code,this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(t=>{this.removeGeoObjectType(t)})}removeGeoObjectType(n,t=null){this.registryService.deleteGeoObjectType(n).then(o=>{let a=this.getGeoObjectTypePosition(n);this.geoObjectTypes.splice(a,1),this.refreshAll(this.currentHierarchy)}).catch(o=>{t?.(o),this.error(o)})}manageGeoObjectType(n,t){this.bsModalRef=this.modalService.show(Hh,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"manage-geoobjecttype-modal"}),n.attributes.sort((o,a)=>o.label.localizedValue<a.label.localizedValue?-1:o.label.localizedValue>a.label.localizedValue?1:0),this.bsModalRef.content.geoObjectType=n,this.bsModalRef.content.readOnly=t,this.bsModalRef.content.onGeoObjectTypeSubmitted.subscribe(o=>{if(o.isAbstract)this.refreshAll(this.currentHierarchy);else{const a=this.getGeoObjectTypePosition(o.code);-1!==a&&(this.geoObjectTypes[a]=o),this.updateViewDatastructures(),this.hierarchies.forEach(l=>{this.processHierarchyNodes(l.rootGeoObjectTypes[0])}),null!=this.currentHierarchy&&this.processHierarchyNodes(this.currentHierarchy.rootGeoObjectTypes[0]),this.renderTree()}})}getHierarchyTypePosition(n){for(let t=0;t<this.hierarchies.length;t++)if(this.hierarchies[t].code===n)return t}getGeoObjectTypePosition(n){for(let t=0;t<this.geoObjectTypes.length;t++)if(this.geoObjectTypes[t].code===n)return t;return null}refreshPrimaryHierarchy(n){this.processHierarchyNodes(n.rootGeoObjectTypes[0]);for(let t=0;t<this.hierarchies.length;++t)this.hierarchies[t].code===n.code&&(this.hierarchies[t]=n,this.setCurrentHierarchy(n));this.updateViewDatastructures(),this.renderTree()}removeFromHierarchy(n,t,o=null){const a=this;this.hierarchyService.removeFromHierarchy(this.currentHierarchy.code,n,t).then(l=>{let _=a.findGeoObjectTypeByCode(t),C=null;for(let N=0;N<_.relatedHierarchies.length;++N)if(_.relatedHierarchies[N]===l.code){C=N;break}null!=C&&_.relatedHierarchies.splice(C,1),a.refreshPrimaryHierarchy(l)}).catch(l=>{o?.(l),this.error(l)})}isActive(n){return this.currentHierarchy===n}onFilterChange(){const n=this.filter.toLowerCase();this.filteredHierarchiesByOrg=[],this.filteredTypesByOrg=[],this.hierarchiesByOrg.forEach(t=>{const o=t.hierarchies.filter(a=>-1!==a.label.localizedValue.toLowerCase().indexOf(n));this.filteredHierarchiesByOrg.push({org:t.org,hierarchies:o})}),this.typesByOrg.forEach(t=>{const o=t.types.filter(a=>-1!==a.label.localizedValue.toLowerCase().indexOf(n));this.filteredTypesByOrg.push({org:t.org,types:o})}),setTimeout(()=>{this.registerDragHandlers()},500)}handleInheritHierarchy(n,t,o){this.hierarchyService.setInheritedHierarchy(n,t,o).then(a=>{this.refreshPrimaryHierarchy(a)}).catch(a=>{this.error(a)})}handleUninheritHierarchy(n,t){this.hierarchyService.removeInheritedHierarchy(n,t).then(o=>{this.refreshPrimaryHierarchy(o)}).catch(o=>{this.error(o)})}importTypes(){this.bsModalRef=this.modalService.show(Qh,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(this.organizations),this.bsModalRef.content.onNodeChange.subscribe(n=>{this.refreshAll(null)})}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}Sd.\u0275fac=function(n){return new(n||Sd)(e.Y36(Wl),e.Y36(Ln.tT),e.Y36(P.Lk),e.Y36(nn.oQ),e.Y36(Zi),e.Y36(nn.e8))},Sd.\u0275cmp=e.Xpm({type:Sd,selectors:[["hierarchies"]],viewQuery:function(n,t){if(1&n&&(e.Gf(aM,7),e.Gf(sM,5),e.Gf(lM,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.searchInput=o.first),e.iGM(o=e.CRH())&&(t.nodeMenuComponent=o.first),e.iGM(o=e.CRH())&&(t.leafMenuComponent=o.first)}},decls:64,vars:13,consts:[[1,"new-admin-design-main",2,"overflow-y","hidden"],["id","app-container",1,"container-fluid"],[1,"row"],[1,"col-md-3","hierarchy-sidebar"],[1,"row",2,"padding","5px 5px"],[1,"col-md-12"],["type","text",1,"form-control",3,"placeholder","ngModel","ngModelChange"],["searchInput",""],[3,"isAnimated","closeOthers"],[2,"border-radius","0",3,"panelClass"],["accordion-heading","",2,"padding","10px 15px"],[1,"fa","fa-circle",2,"margin-right","10px"],["key","hierarchy.sidebar.geoObjectTypes"],[1,"sidebar-section-content"],["class","list-group",4,"ngFor","ngForOf"],[1,"sidebar-section",2,"border-radius","0",3,"isOpen","panelClass"],[1,"fa","fa-sitemap"],["key","hierarchy.sidebar.hierarchies"],["style","text-align: center;padding: 10px 0;",4,"ngIf"],[1,"col-md-9","hierarchy-content"],["id","overflow-div"],[4,"ngIf"],["id","svgHolder"],["id","NodeTooltip",1,"modal-dialog"],[1,"modal-content"],[1,"modal-form"],[1,"row-holder"],[1,"label-holder"],["key","hierarchy.nodeTooltip.geoObjectTypeCode"],[1,"holder"],["id","geoObjectTypeCodeLabel"],["key","hierarchy.nodeTooltip.geoObjectTypeOrganization"],["id","geoObjectTypeOrganizationLabel"],["key","hierarchy.nodeTooltip.hierarchy"],["id","hierarchyLabel"],["key","hierarchy.nodeTooltip.hierarchyCode"],["id","hierarchyCodeLabel"],["key","hierarchy.nodeTooltip.hierarchyOrganization"],["id","hierarchyOrganizationLabel"],[1,"list-group"],[1,"got-org-label-wrapper"],["class","list-group-item got-li-item",3,"id","ngClass",4,"ngFor","ngForOf"],[2,"text-align","center","padding","10px 0"],["type","button",1,"btn","btn-primary",2,"margin-bottom","20px","min-width","45%",3,"click"],["key","hierarchy.sidebar.newGeoObjectType"],["type","button",1,"btn","btn-primary",2,"margin-bottom","20px","margin-left","10px","min-width","45%",3,"click"],["key","hierarchies.add.group.button.label"],[1,"list-group-item","got-li-item",3,"id","ngClass"],["style","position:absolute;right:10px;background:rgba(255,255,255,.7);top:50%;transform:translateY(-50%);",4,"ngIf"],[2,"position","absolute","right","10px","background","rgba(255,255,255,.7)","top","50%","transform","translateY(-50%)"],["class","fa fa-times delete-btn clickable pull-right",3,"title","click",4,"ngIf"],[1,"fa","fa-pencil","clickable","pull-right",3,"title","click"],["class","fa fa-plus clickable pull-right","title","add",3,"click",4,"ngIf"],[1,"fa","fa-times","delete-btn","clickable","pull-right",3,"title","click"],["title","add",1,"fa","fa-plus","clickable","pull-right",3,"click"],[1,"fa","fa-eye","clickable","pull-right",3,"title","click"],["class","list-group-item hier-li-item clickable",3,"id","ngClass","click",4,"ngFor","ngForOf"],["key","hierarchy.sidebar.newHierarchy"],[1,"list-group-item","hier-li-item","clickable",3,"id","ngClass","click"],["style","position:absolute;right:10px;background:inherit;top:50%;transform:translateY(-50%);",4,"ngIf"],[2,"position","absolute","right","10px","background","inherit","top","50%","transform","translateY(-50%)"],[1,"fa","fa-pencil","pull-right","clickable",3,"title","click"],[1,"fa","fa-eye","pull-right","clickable",3,"title","click"],["key","hierarchy.sidebar.importTypes"],["id","emptyHierarchyDropzone","class","drop-box-container",4,"ngIf"],["id","emptyHierarchyDropzone",1,"drop-box-container"],[1,"hierarchy-drop-box"],[1,"inner-drop-box"],[1,"upload-text"],["key","hierarchy.content.dragGotToHierarchy"],["key","hierarchy.content.emptyHierarchy"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2)(5,"nav",3)(6,"div",4)(7,"div",5)(8,"input",6,7),e.NdJ("ngModelChange",function(a){return t.filter=a}),e.ALo(10,"localize"),e.qZA()()(),e.TgZ(11,"accordion",8)(12,"accordion-group",9)(13,"div",10)(14,"span"),e._UZ(15,"i",11),e.qZA(),e._UZ(16,"localize",12),e.qZA(),e.TgZ(17,"div",13),e.YNc(18,_M,7,3,"ul",14),e.qZA()(),e.TgZ(19,"accordion-group",15)(20,"div",10)(21,"span"),e._UZ(22,"i",16),e.qZA(),e._UZ(23,"localize",17),e.qZA(),e.TgZ(24,"div",13),e.YNc(25,wM,7,3,"ul",14),e.qZA()()(),e.YNc(26,TM,3,0,"div",18),e.qZA(),e.TgZ(27,"div",19)(28,"div",20),e.YNc(29,SM,3,2,"div",21),e._UZ(30,"div",22),e.TgZ(31,"div",23)(32,"div",24)(33,"div",25)(34,"div",26)(35,"div",27)(36,"label"),e._UZ(37,"localize",28),e.qZA()(),e.TgZ(38,"div",29),e._UZ(39,"label",30),e.qZA()(),e.TgZ(40,"div",26)(41,"div",27)(42,"label"),e._UZ(43,"localize",31),e.qZA()(),e.TgZ(44,"div",29),e._UZ(45,"label",32),e.qZA()(),e.TgZ(46,"div",26)(47,"div",27)(48,"label"),e._UZ(49,"localize",33),e.qZA()(),e.TgZ(50,"div",29),e._UZ(51,"label",34),e.qZA()(),e.TgZ(52,"div",26)(53,"div",27)(54,"label"),e._UZ(55,"localize",35),e.qZA()(),e.TgZ(56,"div",29),e._UZ(57,"label",36),e.qZA()(),e.TgZ(58,"div",26)(59,"div",27)(60,"label"),e._UZ(61,"localize",37),e.qZA()(),e.TgZ(62,"div",29),e._UZ(63,"label",38),e.qZA()()()()()()()()()()),2&n&&(e.xp6(8),e.Q6J("placeholder",e.lcZ(10,11,"hierarchy.sidebar.searchAll"))("ngModel",t.filter),e.xp6(3),e.Q6J("isAnimated",!0)("closeOthers",!1),e.xp6(1),e.Q6J("panelClass","hierarchy-sidebar-content"),e.xp6(6),e.Q6J("ngForOf",t.filteredTypesByOrg),e.xp6(1),e.Q6J("isOpen",!0)("panelClass","hierarchy-sidebar-content"),e.xp6(6),e.Q6J("ngForOf",t.filteredHierarchiesByOrg),e.xp6(1),e.Q6J("ngIf",t.isSRA),e.xp6(3),e.Q6J("ngIf",null!=t.currentHierarchy&&(null==t.currentHierarchy.rootGeoObjectTypes||0==t.currentHierarchy.rootGeoObjectTypes.length)))},dependencies:[T.mk,T.sg,T.O5,y.Fj,y.JJ,y.On,Sn.l,Da.N,ba.C,Ky,oM,ia.F],styles:['li.list-group-item[_ngcontent-%COMP%]{font-size:14px;border:none}li.list-group-item.active[_ngcontent-%COMP%]{background-color:#dbd7a5}li.list-group-item.got-li-item[_ngcontent-%COMP%]{border-top:15px solid #a0a0a0;border-radius:5px}li.list-group-item.got-li-item.got-group-child[_ngcontent-%COMP%]{margin-left:40px}li.list-group-item.got-li-item.got-group-child[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-8px;border-left:3px solid white;height:44px;width:1px;top:-10px}li.list-group-item.hier-li-item[_ngcontent-%COMP%]{background:#6e6775;border:2px solid #3E2A5A;color:#fff}li.list-group-item.hier-li-item[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{color:#fff}li.list-group-item.hier-li-item.primary[_ngcontent-%COMP%]{background:#3E2A5A}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child:before{top:6px}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child:before{height:6px}.got-org-label-wrapper[_ngcontent-%COMP%]{padding:7px 0}.got-org-label-wrapper[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{border-bottom:solid 1px;width:100%}.sidebar-section-content[_ngcontent-%COMP%]{overflow-y:auto}.hierarchy-sidebar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.hierarchy-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;padding:0;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.hierarchy-content[_ngcontent-%COMP%]{height:calc(100vh - 50px);overflow:auto}#overflow-div[_ngcontent-%COMP%]{top:0}.upload-text[_ngcontent-%COMP%]{position:relative;top:40%}.sidebar-section[_ngcontent-%COMP%]{text-align:left}.hierarchy-sidebar-content[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{background-color:#f1f1f1;max-height:500px;overflow:auto}.sidebar-section-header[_ngcontent-%COMP%]{margin-left:20px;cursor:pointer}li.list-group-item[_ngcontent-%COMP%]{background-color:#fff;margin-bottom:5px}.drop-box-container[_ngcontent-%COMP%]{width:80%;border:3px grey dashed;border-radius:5px;margin:50px auto 0}.hierarchy-drop-box[_ngcontent-%COMP%]{position:relative;height:100%;cursor:default}li.got-li-item.dragging[_ngcontent-%COMP%]{position:fixed;cursor:grabbing!important;z-index:99999999}[data-candrag=true][_ngcontent-%COMP%]{cursor:pointer}[data-candrag=false][_ngcontent-%COMP%]{cursor:not-allowed}#NodeTooltip[_ngcontent-%COMP%]{opacity:0;left:-10000;top:-10000;position:fixed;width:400px;min-width:400px}#NodeTooltip[_ngcontent-%COMP%]   .modal-form[_ngcontent-%COMP%]{padding-top:10px}#NodeTooltip[_ngcontent-%COMP%]   .modal-form[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]{padding-bottom:0}#NodeTooltip[_ngcontent-%COMP%]   .label-holder[_ngcontent-%COMP%]{width:40%}#NodeTooltip[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]{width:60%}#NodeTooltip[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:2.8}[_nghost-%COMP%]  .panel .panel-heading .accordion-toggle:after{font-family:Glyphicons Halflings;content:"\\e080";float:right;margin-top:-30px}[_nghost-%COMP%]  .panel.panel-open .panel-heading .accordion-toggle:after{content:"\\e114"}']});const kM=["attributeEditor"],IM=["geometryEditor"];function ZM(i,n){if(1&i&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.Oqu(t.label.localizedValue)}}const NM=function(){return["/registry/location-manager"]},LM=function(i,n){return{type:i,code:n,pageContext:"DATA"}};function zM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNewChangeRequest())}),e.TgZ(1,"button",19),e._UZ(2,"localize",20),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("routerLink",e.DdM(2,NM))("queryParams",e.WLB(3,LM,t.geoObject.attributes.type,t.geoObject.attributes.code))}}function DM(i,n){1&i&&(e.TgZ(0,"button",21),e._UZ(1,"localize",20),e.qZA())}const RM=function(i){return{"inline-loading":i}};class Pd{constructor(n,t,o,a,l,_,C,N,F){this.modalService=n,this.registryService=t,this.geomService=o,this.changeRequestService=a,this.localizeService=l,this.authService=_,this.router=C,this.dateService=N,this.cacheService=F,this.geoObjectTypes=[],this.geoObjectId="",this.reason="",this.dateStr=null,this.forDate=null,this.geoObject=null,this.isValid=!1,this.loading=!1,this.geoObjectAttributeExcludes=["uid","sequence","type","lastUpdateDate","createDate","status"],this.dataSource=Ni.y.create(V=>{this.registryService.getGeoObjectSuggestionsTypeAhead(this.geoObjectId,this.geoObjectType.code).then(ue=>{V.next(ue)})})}ngOnInit(){this.cacheService.getTypeCache().waitOnTypes().then(n=>{let t=[];for(let a=0;a<n.length;++a){const l=n[a];this.authService.isGeoObjectTypeRC(l.organizationCode,null!=l.superTypeCode&&""!==l.superTypeCode?l.superTypeCode:l.code)&&t.push(n[a])}this.geoObjectTypes=t,this.geoObjectTypes.sort((a,l)=>a.label.localizedValue.toLowerCase()<l.label.localizedValue.toLowerCase()?-1:a.label.localizedValue.toLowerCase()>l.label.localizedValue.toLowerCase()?1:0);let o=this.getGeoObjectTypePosition("ROOT");o&&this.geoObjectTypes.splice(o,1)}).catch(n=>{this.error(n)})}handleDateChange(){this.forDate=null!=this.dateStr?new Date(Date.parse(this.dateStr)):null}onValidChange(n){this.isValid=!(null==this.geoObject||null!=this.geometryEditor&&!this.geometryEditor.getIsValid()||null!=this.attributeEditor&&!this.attributeEditor.getIsValid())}getGeoObjectTypePosition(n){for(let t=0;t<this.geoObjectTypes.length;t++)if(this.geoObjectTypes[t].code===n)return t;return null}changeTypeaheadLoading(n){this.loading=n}typeaheadOnSelect(n){this.registryService.getGeoObjectOverTime(n.item.code,this.geoObjectType.code).then(t=>{this.geoObject=t}).catch(t=>{this.error(t)})}onNewChangeRequest(){let n=new Zs(this.registryService,this.geoObject.attributes.code,this.geoObject.attributes.type,this.dateStr),t=this.geoObject.attributes.displayLabel.values&&this.geoObject.attributes.displayLabel.values.length>0?this.geoObject.attributes.displayLabel.values[0].value.localizedValue:this.geoObject.attributes.code,o=this.geoObjectType.label.localizedValue,a=null==this.dateStr?"":" "+this.dateService.formatDateForDisplay(this.dateStr),_=n.createLayer(t+" "+a+"("+o+")",!0,bl().hexString());this.geomService.zoomOnReady(_.getId());let C=this.geomService.getDataSourceFactory().serializeLayers([_]);const N={layers:JSON.stringify(C),attrPanelOpen:!0,objectType:"GEOOBJECT"};N.type=this.geoObjectType.code,N.code=this.geoObject.attributes.code,N.date=this.dateStr,this.router.navigate(["/registry/location-manager"],{queryParams:N})}cancel(){this.isValid=!1,this.geoObject=null,this.geoObjectId=null,this.geoObjectType=null,this.reason=null}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}function FM(i,n){if(1&i&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function UM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",16)(3,"label",17),e._uU(4),e.qZA()(),e.TgZ(5,"div",18)(6,"select",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.target=a)}),e._UZ(7,"option"),e.YNc(8,FM,2,2,"option",20),e.qZA()()()()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(4),e.Oqu(t.label.localizedValue),e.xp6(2),e.Q6J("name",t.code+(null!=t.locale?t.locale:""))("ngModel",t.target)("required","invalid"!==t.code&&t.required),e.xp6(2),e.Q6J("ngForOf",o.configuration.sheet.attributes[t.baseType])}}Pd.\u0275fac=function(n){return new(n||Pd)(e.Y36(Ln.tT),e.Y36(Zi),e.Y36(vo),e.Y36($l),e.Y36(nn.oQ),e.Y36(nn.e8),e.Y36(w.F0),e.Y36(nn.Ru),e.Y36(Ml))},Pd.\u0275cmp=e.Xpm({type:Pd,selectors:[["submit-change-request"]],viewQuery:function(n,t){if(1&n&&(e.Gf(kM,5),e.Gf(IM,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.attributeEditor=o.first),e.iGM(o=e.CRH())&&(t.geometryEditor=o.first)}},decls:22,vars:22,consts:[[1,"row"],[1,"col-md-12"],[2,"margin-top","50px","margin-bottom","50px","background","#f7f7f7","width","100%","padding","10px"],[2,"margin-bottom","20px"],["key","change.request.search.for.geoobject.header"],[1,"col-md-3"],["key","dropdown.select.geoobjecttype.option.label"],["id","geoObjectTypeSelect","name","geoObjectTypeSelect","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["key","changeOverTime.forDate"],["label","","customStyles","width:100%",3,"value","inputName","disable","allowInfinity","allowFutureDates","required","placement","valueChange","change"],[1,"col-md-4"],["key","change.request.search.for.geoobject.search.label"],["type","text","name","geoObjectId","typeaheadOptionField","name","autocomplete","off",1,"form-control",3,"ngClass","ngModel","disabled","typeaheadAsync","typeahead","typeaheadOptionsLimit","placeholder","ngModelChange","typeaheadOnSelect","typeaheadLoading"],[1,"col-md-2"],[3,"routerLink","queryParams","click",4,"ngIf"],["disabled","true","class","btn btn-primary","style","width:100%;",4,"ngIf"],[3,"ngValue"],[3,"routerLink","queryParams","click"],[1,"btn","btn-primary",2,"width","100%"],["key","change.request.open.geoobject.in.editor.link.btn"],["disabled","true",1,"btn","btn-primary",2,"width","100%"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e._UZ(4,"localize",4),e.qZA(),e.TgZ(5,"div",0)(6,"div",5),e._UZ(7,"localize",6),e.TgZ(8,"select",7),e.NdJ("ngModelChange",function(a){return t.geoObjectType=a}),e._UZ(9,"option"),e.YNc(10,ZM,2,2,"option",8),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"localize",9),e.TgZ(13,"date-field",10),e.NdJ("valueChange",function(a){return t.dateStr=a})("change",function(){return t.handleDateChange()}),e.qZA()(),e.TgZ(14,"div",11),e._UZ(15,"localize",12),e.TgZ(16,"input",13),e.NdJ("ngModelChange",function(a){return t.geoObjectId=a})("typeaheadOnSelect",function(a){return t.typeaheadOnSelect(a)})("typeaheadLoading",function(a){return t.changeTypeaheadLoading(a)}),e.ALo(17,"localize"),e.qZA()(),e.TgZ(18,"div",14),e._UZ(19,"label"),e.YNc(20,zM,3,6,"a",15),e.YNc(21,DM,2,0,"button",16),e.qZA()()()()()),2&n&&(e.xp6(8),e.Q6J("ngModel",t.geoObjectType),e.xp6(2),e.Q6J("ngForOf",t.geoObjectTypes),e.xp6(3),e.Q6J("value",t.dateStr)("inputName","dateStr")("disable",!t.geoObjectType)("allowInfinity",!1)("allowFutureDates",!1)("required",!1)("placement","right"),e.xp6(3),e.Q6J("ngClass",e.VKq(20,RM,t.loading))("ngModel",t.geoObjectId)("disabled",!t.geoObjectType)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",7)("placeholder",e.lcZ(17,18,"masterlist.search")+"..."),e.xp6(4),e.Q6J("ngIf",t.geoObject),e.xp6(1),e.Q6J("ngIf",!t.geoObject))},dependencies:[T.mk,T.sg,T.O5,w.rH,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.Q7,y.On,A.Bp,Sn.l,Xl.Q,ia.F],styles:["input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]{height:40px;padding:6px 10px;font-size:14px;line-height:18px;color:#333;border:1px solid;border-color:#767676;border-color:var(--theme-input-text-border);border-radius:5px;background:white;background-color:#fff;outline:none;box-shadow:none}"]});const qM=function(i){return{"chk-checked":i}};function JM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",16)(3,"label",17),e._UZ(4,"localize",22),e.qZA()(),e.TgZ(5,"div",23)(6,"div",24)(7,"div",25),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.configuration.postalCode=!a.configuration.postalCode)}),e._UZ(8,"span"),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngClass",e.VKq(1,qM,t.configuration.postalCode))}}function jM(i,n){if(1&i&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function BM(i,n){if(1&i&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function GM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",16)(2,"label",17),e._UZ(3,"localize",29),e.qZA()(),e.TgZ(4,"div",18)(5,"select",30),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.configuration.revealGeometryColumn=a)}),e._UZ(6,"option"),e.YNc(7,BM,2,2,"option",20),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("ngModel",t.configuration.revealGeometryColumn)("required",!1),e.xp6(2),e.Q6J("ngForOf",t.configuration.sheet.attributes.text)}}function VM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",16)(3,"label",17),e._UZ(4,"localize",26),e.qZA()(),e.TgZ(5,"div",18)(6,"select",27),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.configuration.externalIdAttributeTarget=a)}),e._UZ(7,"option"),e.YNc(8,jM,2,2,"option",20),e.qZA()()(),e.YNc(9,GM,8,3,"div",28),e.qZA()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.configuration.externalIdAttributeTarget)("required",!0),e.xp6(2),e.Q6J("ngForOf",t.configuration.sheet.attributes.text),e.xp6(1),e.Q6J("ngIf","RevealExternalSystem"===t.configuration.externalSystem.type&&"EXCEL"===t.configuration.formatType)}}function YM(i,n){1&i&&e._UZ(0,"localize",31)}function HM(i,n){1&i&&e._UZ(0,"localize",32)}class Ed{constructor(){this.configurationChange=new e.vpe,this.stateChange=new e.vpe}onNext(){this.configurationChange.emit(this.configuration),this.stateChange.emit("NEXT")}onCancel(){this.stateChange.emit("CANCEL")}}function QM(i,n){if(1&i&&(e.TgZ(0,"option",35),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function KM(i,n){1&i&&(e.TgZ(0,"option",36),e._UZ(1,"localize",37),e.qZA())}function $M(i,n){1&i&&(e.TgZ(0,"option",38),e._UZ(1,"localize",39),e.qZA())}function WM(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",9)(2,"div",18)(3,"div",19)(4,"label"),e._uU(5),e.qZA()(),e.TgZ(6,"div",20)(7,"div",21)(8,"label"),e._UZ(9,"localize",22),e.qZA()(),e.TgZ(10,"div",23)(11,"select",24),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.target=a)}),e._UZ(12,"option",25),e.YNc(13,QM,2,2,"option",26),e.qZA()(),e.TgZ(14,"div",21)(15,"label"),e._UZ(16,"localize",27),e.qZA()(),e.TgZ(17,"div",23)(18,"select",28),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.matchStrategy=a)}),e._UZ(19,"option"),e.TgZ(20,"option",29),e._UZ(21,"localize",30),e.qZA(),e.TgZ(22,"option",31),e._UZ(23,"localize",32),e.qZA(),e.YNc(24,KM,2,0,"option",33),e.YNc(25,$M,2,0,"option",34),e.qZA()()()()()()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw();e.xp6(5),e.hij(" ",t.label," "),e.xp6(6),e.Q6J("ngModel",t.target)("name",o+"-location"),e.xp6(2),e.Q6J("ngForOf",a.configuration.sheet.attributes.text),e.xp6(5),e.Q6J("name",o+"-matchStrategy")("ngModel",t.matchStrategy)("required",null!=t.target&&""!==t.target),e.xp6(6),e.Q6J("ngIf",a.configuration.isExternal),e.xp6(1),e.Q6J("ngIf",a.configuration.isExternal&&"DHIS2ExternalSystem"===a.configuration.externalSystem.type)}}Ed.\u0275fac=function(n){return new(n||Ed)},Ed.\u0275cmp=e.Xpm({type:Ed,selectors:[["attributes-page"]],inputs:{configuration:"configuration"},outputs:{configurationChange:"configurationChange",stateChange:"stateChange"},decls:20,vars:6,consts:[[1,"text-center"],["key","io.attributes.title"],[1,"lead"],["key","io.attributes.description"],[1,"modal-form"],["form","ngForm"],["class","form-group",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[1,"form-group"],[1,"row-holder"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.next",4,"ngIf"],["key","io.ok",4,"ngIf"],[1,"label-holder"],[1,""],[1,"holder"],[1,"select-area",3,"name","ngModel","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["key","io.modal.postalCode"],[1,"form-check"],[1,"check-block"],["name","postalCode",1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],["key","io.modal.external"],["name","externalId",1,"select-area",3,"ngModel","required","ngModelChange"],["class","row-holder",4,"ngIf"],["key","io.import.revealGeometryAttribute"],["name","revealGeometryColumn",1,"select-area",3,"ngModel","required","ngModelChange"],["key","io.next"],["key","io.ok"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div")(1,"div",0)(2,"h2"),e._UZ(3,"localize",1),e.qZA(),e.TgZ(4,"p",2),e._UZ(5,"localize",3),e.qZA()(),e.TgZ(6,"form",4,5),e.YNc(8,UM,9,5,"div",6),e._UZ(9,"hr"),e.YNc(10,JM,9,3,"div",7),e.YNc(11,VM,10,4,"div",7),e.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"button",11),e.NdJ("click",function(){return t.onCancel()}),e._UZ(16,"localize",12),e.qZA(),e.TgZ(17,"button",13),e.NdJ("click",function(){return t.onNext()}),e.YNc(18,YM,1,0,"localize",14),e.YNc(19,HM,1,0,"localize",15),e.qZA()()()()()()),2&n){const o=e.MAs(7);e.xp6(8),e.Q6J("ngForOf",t.configuration.type.attributes),e.xp6(2),e.Q6J("ngIf",t.configuration.hasPostalCode),e.xp6(1),e.Q6J("ngIf",t.configuration.isExternal),e.xp6(6),e.Q6J("disabled",o.invalid),e.xp6(1),e.Q6J("ngIf",!t.configuration.postalCode),e.xp6(1),e.Q6J("ngIf",t.configuration.postalCode)}},dependencies:[T.mk,T.sg,T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l],encapsulation:2});class Ad{constructor(n){this.service=n,this.property="type",this.includeChild=!1,this.configurationChange=new e.vpe,this.stateChange=new e.vpe}ngOnInit(){this.service.getTypeAncestors(this.configuration[this.property].code,this.configuration.hierarchy,!0,this.includeChild).then(n=>{this.configuration.locations=n})}onNext(){this.configurationChange.emit(this.configuration),this.stateChange.emit("NEXT")}onBack(){this.stateChange.emit("BACK")}onCancel(){this.stateChange.emit("CANCEL")}}function XM(i,n){if(1&i&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.AsE("",t.label," (",t.type,")")}}function eO(i,n){if(1&i&&(e.TgZ(0,"ol"),e.YNc(1,XM,2,2,"li",5),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.problem.context)}}Ad.\u0275fac=function(n){return new(n||Ad)(e.Y36(pr))},Ad.\u0275cmp=e.Xpm({type:Ad,selectors:[["location-page"]],inputs:{configuration:"configuration",property:"property",includeChild:"includeChild"},outputs:{configurationChange:"configurationChange",stateChange:"stateChange"},decls:19,vars:2,consts:[[1,"modal-form"],[1,"text-center"],["key","io.location.title"],[1,"lead"],["key","io.location.description"],[1,"col-md-12","order-md-1"],["form","ngForm"],["class","form-group",4,"ngFor","ngForOf"],[1,"form-group","row"],[1,"row-holder"],[1,"button-holder"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","io.back"],["type","btn","role","button",1,"btn","btn-default",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"],[1,"form-group"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"label-holder"],["key","io.import.modal.parent.source"],[1,"holder"],[1,"select-area",3,"ngModel","name","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["key","io.import.modal.parent.matchStrategy"],[1,"select-area",3,"name","ngModel","required","ngModelChange"],["value","ALL"],["key","io.modal.all"],["value","CODE"],["key","io.modal.code"],["value","EXTERNAL",4,"ngIf"],["value","DHIS2_PATH",4,"ngIf"],[3,"value"],["value","EXTERNAL"],["key","io.modal.external"],["value","DHIS2_PATH"],["key","io.modal.dhis2path"]],template:function(n,t){if(1&n&&(e.TgZ(0,"form",0)(1,"div",1)(2,"h2"),e._UZ(3,"localize",2),e.qZA(),e.TgZ(4,"p",3),e._UZ(5,"localize",4),e.qZA()(),e.TgZ(6,"div",5)(7,"form",null,6),e.YNc(9,WM,26,9,"div",7),e.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"button",11),e.NdJ("click",function(){return t.onBack()}),e._UZ(14,"localize",12),e.qZA(),e.TgZ(15,"button",13),e.NdJ("click",function(){return t.onCancel()}),e._UZ(16,"localize",14),e.qZA(),e.TgZ(17,"button",15),e.NdJ("click",function(){return t.onNext()}),e._UZ(18,"localize",16),e.qZA()()()()()()()),2&n){const o=e.MAs(8);e.xp6(9),e.Q6J("ngForOf",t.configuration.locations),e.xp6(8),e.Q6J("disabled",o.invalid)}},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l],encapsulation:2});const tO=function(i){return{disabled:i}};function nO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",2)(2,"input",6),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.entityLabel=a)})("typeaheadOnSelect",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.typeaheadOnSelect(a))}),e.qZA()(),e.TgZ(3,"div",7)(4,"i",8),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.createSynonym())}),e.ALo(5,"localize"),e.qZA(),e.TgZ(6,"i",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.ignoreDataAtLocation())}),e.ALo(7,"localize"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("name",t.index+"-name")("ngModel",t.entityLabel)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",7),e.xp6(2),e.Q6J("ngClass",e.VKq(12,tO,!t.hasSynonym))("title",e.lcZ(5,8,"dataUploader.createSynonymFromLocationTooltip")),e.xp6(2),e.Q6J("title",e.lcZ(7,10,"dataUploader.ignoreAtLocationTooltip"))}}function iO(i,n){if(1&i&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Oqu(t.label)}}function oO(i,n){if(1&i&&(e.TgZ(0,"div",2)(1,"a"),e._UZ(2,"i",12)(3,"i",13)(4,"localize",14),e._uU(5),e.qZA(),e.TgZ(6,"span")(7,"ul"),e._UZ(8,"localize",15),e.YNc(9,iO,2,1,"li",5),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(5),e.hij(" [",t.problem.action.label,"] "),e.xp6(4),e.Q6J("ngForOf",t.problem.action.ancestors)}}function rO(i,n){if(1&i&&(e.TgZ(0,"div",2),e._UZ(1,"localize",16),e._uU(2),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" [",t.problem.action.label,"] ")}}function aO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,oO,10,2,"div",10),e.YNc(2,rO,3,1,"div",10),e.TgZ(3,"div",7)(4,"i",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.undoAction())}),e.ALo(5,"localize"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","SYNONYM"==t.problem.action.name),e.xp6(1),e.Q6J("ngIf","IGNOREATLOCATION"==t.problem.action.name),e.xp6(2),e.Q6J("title",e.lcZ(5,3,"dataUploader.undoFixedLocationTooltip"))}}class Kh{constructor(n){this.service=n,this.onError=new e.vpe,this.dataSource=Ni.y.create(t=>{this.service.getGeoObjectSuggestions(this.entityLabel,this.problem.type,this.problem.parent,this.configuration.hierarchy).then(o=>{t.next(o)})})}ngOnInit(){this.entityLabel=null,this.entityId=null,this.hasSynonym=!1}typeaheadOnSelect(n){this.entityId=n.item.id,this.hasSynonym=null!=this.entityId}createSynonym(){this.hasSynonym&&(this.onError.emit(null),this.service.createGeoObjectSynonym(this.entityId,this.problem.label).then(n=>{this.problem.resolved=!0,this.problem.action={name:"SYNONYM",synonymId:n.synonymId,vOid:n.vOid,label:n.label}}).catch(n=>{this.onError.emit(n.error)}))}ignoreDataAtLocation(){let n=this.problem.label;this.problem.resolved=!0,this.problem.action={name:"IGNOREATLOCATION",label:n}}undoAction(){if(this.problem.resolved){let o=this.problem.action;"IGNOREATLOCATION"==o.name?(this.problem.resolved=!1,this.problem.action=null):"SYNONYM"==o.name&&(this.onError.emit(null),this.service.deleteGeoObjectSynonym(o.synonymId,o.vOid).then(a=>{this.problem.resolved=!1,this.problem.action=null,this.entityLabel=null,this.hasSynonym=null!=this.entityLabel}).catch(a=>{this.onError.emit(a.error)}))}}}function sO(i,n){1&i&&(e.TgZ(0,"div",6)(1,"div",20),e._UZ(2,"localize",21),e.qZA()())}function lO(i,n){if(1&i&&(e.TgZ(0,"div",6)(1,"div",20),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.message)}}function cO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"location-problem",22),e.NdJ("onError",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.handleError(a))}),e.qZA()()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw();e.xp6(1),e.Q6J("problem",t)("configuration",a.configuration)("index",o)}}function uO(i,n){1&i&&e._UZ(0,"localize",23)}function pO(i,n){1&i&&e._UZ(0,"localize",24)}Kh.\u0275fac=function(n){return new(n||Kh)(e.Y36(pr))},Kh.\u0275cmp=e.Xpm({type:Kh,selectors:[["location-problem"]],inputs:{configuration:"configuration",problem:"problem",index:"index"},outputs:{onError:"onError"},decls:9,vars:5,consts:[[1,"row",2,"padding-bottom","10px"],["problemForm","ngForm"],[1,"col-sm-4"],[4,"ngIf"],[1,"col-sm-2","error-message"],[4,"ngFor","ngForOf"],["typeaheadOptionField","name",1,"form-control",3,"name","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","ngModelChange","typeaheadOnSelect"],[1,"col-sm-2"],[1,"fa","fa-2x","fa-compress","clickable",3,"ngClass","title","click"],[1,"fa","fa-2x","fa-times-circle","clickable",3,"title","click"],["class","col-sm-4",4,"ngIf"],[1,"fa","fa-2x","fa-undo","clickable",3,"title","click"],["aria-hidden","true",1,"fa","fa-caret-right","clickable"],["aria-hidden","true",1,"fa","fa-caret-down",2,"display","none"],["key","dataUploader.resolvedSynonym"],["key","dataUploader.locatedWithin"],["key","dataUploader.resolvedIgnoreAtLocation"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"form",null,1)(3,"div",2),e.YNc(4,eO,2,1,"ol",3),e.qZA(),e.TgZ(5,"div",4),e._uU(6),e.qZA(),e.YNc(7,nO,8,14,"div",3),e.YNc(8,aO,6,5,"div",3),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("ngIf",t.problem.context.length>0),e.xp6(2),e.AsE("",t.problem.label," (",t.problem.typeLabel,")"),e.xp6(1),e.Q6J("ngIf",!t.problem.resolved),e.xp6(1),e.Q6J("ngIf",t.problem.resolved))},dependencies:[T.mk,T.sg,T.O5,y._Y,y.Fj,y.JJ,y.JL,y.On,y.F,A.Bp,Sn.l,ia.F],encapsulation:2});class kd{constructor(){this.stateChange=new e.vpe,this.message=null}ngOnInit(){}hasProblems(){for(let n=0;n<this.configuration.locationProblems.length;n++)if(!this.configuration.locationProblems[n].resolved)return!0;return!1}handleError(n){this.message=Zt.qL.getMessageFromError(n)}onNext(){null==this.configuration.exclusions&&(this.configuration.exclusions=[]);for(let n=0;n<this.configuration.locationProblems.length;n++){const t=this.configuration.locationProblems[n];t.resolved&&"IGNOREATLOCATION"==t.action.name&&this.configuration.exclusions.push({code:"##PARENT##",value:null!=t.parent?t.parent+"-"+t.label:t.label})}this.stateChange.emit("NEXT")}onCancel(){this.stateChange.emit("CANCEL")}}kd.\u0275fac=function(n){return new(n||kd)},kd.\u0275cmp=e.Xpm({type:kd,selectors:[["location-problem-page"]],inputs:{configuration:"configuration"},outputs:{stateChange:"stateChange"},decls:34,vars:6,consts:[[1,"text-center"],["key","io.locationProblem.title"],[1,"lead"],["key","io.locationProblem.description"],["class","row",4,"ngIf"],["form","ngForm"],[1,"row"],[1,"col-sm-4"],["key","dataUploader.locationContext"],[1,"col-sm-2"],["key","dataUploader.unknownLocation"],["key","dataUploader.synonymn"],["key","dataUploader.actions"],[4,"ngFor","ngForOf"],[1,"col-sm-12","text-right",2,"margin-top","20px"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.next",4,"ngIf"],["key","io.ok",4,"ngIf"],[1,"alert","alert-danger"],["key","dataUploader.existingProblems"],[3,"problem","configuration","index","onError"],["key","io.next"],["key","io.ok"]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"div",0)(2,"h2"),e._UZ(3,"localize",1),e.qZA(),e.TgZ(4,"p",2),e._UZ(5,"localize",3),e.qZA()(),e.TgZ(6,"div"),e.YNc(7,sO,3,0,"div",4),e.YNc(8,lO,3,1,"div",4),e.TgZ(9,"form",null,5)(11,"div",6)(12,"div",7)(13,"label"),e._UZ(14,"localize",8),e.qZA()(),e.TgZ(15,"div",9)(16,"label"),e._UZ(17,"localize",10),e.qZA()(),e.TgZ(18,"div",7)(19,"label"),e._UZ(20,"localize",11),e.qZA()(),e.TgZ(21,"div",9)(22,"label"),e._UZ(23,"localize",12),e.qZA()()(),e.YNc(24,cO,2,3,"div",13),e.TgZ(25,"div",6)(26,"div",14)(27,"button",15),e.NdJ("click",function(){return t.onCancel()}),e.TgZ(28,"span"),e._UZ(29,"localize",16),e.qZA()(),e.TgZ(30,"button",17),e.NdJ("click",function(){return t.onNext()}),e.TgZ(31,"span"),e.YNc(32,uO,1,0,"localize",18),e.YNc(33,pO,1,0,"localize",19),e.qZA()()()()()()()),2&n&&(e.xp6(7),e.Q6J("ngIf",t.hasProblems()),e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(16),e.Q6J("ngForOf",t.configuration.locationProblems),e.xp6(6),e.Q6J("disabled",t.hasProblems()),e.xp6(2),e.Q6J("ngIf",null!=t.configuration.termProblems),e.xp6(1),e.Q6J("ngIf",null==t.configuration.termProblems))},dependencies:[T.sg,T.O5,y._Y,y.JL,y.F,Sn.l,Kh],encapsulation:2});const dO=function(i){return{disabled:i}};function hO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",2)(2,"input",5),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.termLabel=a)})("typeaheadOnSelect",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.typeaheadOnSelect(a))}),e.qZA()(),e.TgZ(3,"div",6)(4,"i",7),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.createSynonym())}),e.ALo(5,"localize"),e.qZA(),e.TgZ(6,"i",8),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.createOption())}),e.ALo(7,"localize"),e.qZA(),e.TgZ(8,"i",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.ignoreValue())}),e.ALo(9,"localize"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("name",t.index+"-name")("ngModel",t.termLabel)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",7),e.xp6(2),e.Q6J("ngClass",e.VKq(15,dO,!t.hasSynonym))("title",e.lcZ(5,9,"dataUploader.createSynonymCategoryTooltip")),e.xp6(2),e.Q6J("title",e.lcZ(7,11,"dataUploader.createNewOptionTooltip")),e.xp6(2),e.Q6J("title",e.lcZ(9,13,"dataUploader.ignoreCategoryTooltip"))}}function fO(i,n){1&i&&(e.TgZ(0,"div",2),e._UZ(1,"localize",12),e.qZA())}function gO(i,n){if(1&i&&(e.TgZ(0,"div",2),e._UZ(1,"localize",13),e._uU(2),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" [",t.problem.action.label,"] ")}}function _O(i,n){if(1&i&&(e.TgZ(0,"div",2),e._UZ(1,"localize",14),e._uU(2),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" [",t.problem.label,"] ")}}function mO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,fO,2,0,"div",10),e.YNc(2,gO,3,1,"div",10),e.YNc(3,_O,3,1,"div",10),e.TgZ(4,"div",6)(5,"i",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.undoAction())}),e.ALo(6,"localize"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","OPTION"==t.problem.action.name),e.xp6(1),e.Q6J("ngIf","SYNONYM"==t.problem.action.name),e.xp6(1),e.Q6J("ngIf","IGNORE"==t.problem.action.name),e.xp6(2),e.Q6J("title",e.lcZ(6,4,"dataUploader.undoFixedCategoryTooltip"))}}class $h{constructor(n){this.service=n,this.onError=new e.vpe,this.dataSource=Ni.y.create(t=>{this.service.getTermSuggestions(this.problem.mdAttributeId,this.termLabel,"20").then(o=>{t.next(o)})})}ngOnInit(){this.termLabel=null,this.termId=null,this.hasSynonym=!1}typeaheadOnSelect(n){this.termId=n.item.value,this.hasSynonym=null!=this.termId}createSynonym(){this.hasSynonym&&(this.onError.emit(null),this.service.createTermSynonym(this.termId,this.problem.label).then(n=>{this.problem.resolved=!0,this.problem.action={name:"SYNONYM",synonymId:n.synonymId,label:n.label}}).catch(n=>{this.onError.emit(n.error)}))}createOption(){this.onError.emit(null),this.service.createTerm(this.problem.label,G(),this.problem.parentCode).then(n=>{this.problem.resolved=!0,this.problem.action={name:"OPTION",term:n}}).catch(n=>{this.onError.emit(n.error)})}ignoreValue(){this.problem.resolved=!0,this.problem.action={name:"IGNORE"}}undoAction(){if(this.problem.resolved){let n=this.problem.action;"IGNORE"==n.name?(this.problem.resolved=!1,this.problem.action=null):"SYNONYM"==n.name?(this.onError.emit(null),this.service.deleteTermSynonym(n.synonymId).then(t=>{this.problem.resolved=!1,this.problem.action=null}).catch(t=>{this.onError.emit(t.error)})):"OPTION"==n.name&&(this.onError.emit(null),this.service.removeTerm(this.problem.parentCode,n.term.code).then(t=>{this.problem.resolved=!1,this.problem.action=null}).catch(t=>{this.onError.emit(t.error)}))}}}function yO(i,n){1&i&&(e.TgZ(0,"div",7)(1,"div",20),e._UZ(2,"localize",21),e.qZA()())}function vO(i,n){if(1&i&&(e.TgZ(0,"div",7)(1,"div",20),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.message)}}function bO(i,n){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"term-problem",22),e.qZA()),2&i){const t=n.$implicit,o=n.index,a=e.oxw();e.xp6(1),e.Q6J("problem",t)("configuration",a.configuration)("index",o)}}$h.\u0275fac=function(n){return new(n||$h)(e.Y36(pr))},$h.\u0275cmp=e.Xpm({type:$h,selectors:[["term-problem"]],inputs:{configuration:"configuration",problem:"problem",index:"index"},outputs:{onError:"onError"},decls:9,vars:4,consts:[[1,"row"],["problemForm","ngForm"],[1,"col-sm-4"],[1,"col-sm-2","error-message"],[4,"ngIf"],["typeaheadOptionField","label",1,"form-control",3,"name","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","ngModelChange","typeaheadOnSelect"],[1,"col-sm-2"],[1,"fa","fa-2x","fa-compress","clickable",3,"ngClass","title","click"],[1,"fa","fa-2x","fa-plus","clickable",3,"title","click"],[1,"fa","fa-2x","fa-times-circle","clickable",3,"title","click"],["class","col-sm-4",4,"ngIf"],[1,"fa","fa-2x","fa-undo","clickable",3,"title","click"],["key","dataUploader.resolvedCategoryOption"],["key","dataUploader.resolvedSynonym"],["key","dataUploader.resolvedIgnoreCategory"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"form",null,1)(3,"div",2),e._uU(4),e.qZA(),e.TgZ(5,"div",3),e._uU(6),e.qZA(),e.YNc(7,hO,10,17,"div",4),e.YNc(8,mO,7,6,"div",4),e.qZA()()),2&n&&(e.xp6(4),e.Oqu(t.problem.attributeLabel),e.xp6(2),e.Oqu(t.problem.label),e.xp6(1),e.Q6J("ngIf",!t.problem.resolved),e.xp6(1),e.Q6J("ngIf",t.problem.resolved))},dependencies:[T.mk,T.O5,y._Y,y.Fj,y.JJ,y.JL,y.On,y.F,A.Bp,Sn.l,ia.F],encapsulation:2});class Id{constructor(){this.stateChange=new e.vpe,this.message=null}ngOnInit(){}hasProblems(){for(let n=0;n<this.configuration.termProblems.length;n++)if(!this.configuration.termProblems[n].resolved)return!0;return!1}onNext(){null==this.configuration.exclusions&&(this.configuration.exclusions=[]);for(let n=0;n<this.configuration.termProblems.length;n++){const t=this.configuration.termProblems[n];t.resolved&&"IGNORE"==t.action.name&&this.configuration.exclusions.push({code:t.attributeCode,value:t.label})}this.stateChange.emit("NEXT")}onCancel(){this.stateChange.emit("CANCEL")}}function xO(i,n){if(1&i&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function CO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"attributes-page",4),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function wO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"location-page",5),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)("property",t.property)("includeChild",t.includeChild)}}function TO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"location-problem-page",4),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function MO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"term-problem-page",4),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function OO(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,CO,2,1,"div",2),e.YNc(2,wO,2,3,"div",2),e.YNc(3,TO,2,1,"div",2),e.YNc(4,MO,2,1,"div",2),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","MAP"===t.state),e.xp6(1),e.Q6J("ngIf","LOCATION"===t.state),e.xp6(1),e.Q6J("ngIf","LOCATION-PROBLEM"===t.state),e.xp6(1),e.Q6J("ngIf","TERM-PROBLEM"===t.state)}}Id.\u0275fac=function(n){return new(n||Id)},Id.\u0275cmp=e.Xpm({type:Id,selectors:[["term-problem-page"]],inputs:{configuration:"configuration"},outputs:{stateChange:"stateChange"},decls:33,vars:4,consts:[[1,"text-center"],["key","io.termProblem.title"],[1,"lead"],["key","io.termProblem.description"],[1,"col-md-12","order-md-1"],["class","row",4,"ngIf"],["form","ngForm"],[1,"row"],[1,"col-sm-4"],["key","dataUploader.categoryAttribute"],[1,"col-sm-2"],["key","dataUploader.unknownCategory"],["key","dataUploader.synonymn"],["key","dataUploader.actions"],[4,"ngFor","ngForOf"],[1,"col-sm-12","text-right"],["type","button","role","button",1,"btn",3,"click"],["key","io.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.ok"],[1,"alert","alert-danger"],["key","dataUploader.existingProblems"],[3,"problem","configuration","index"]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"div",0)(2,"h2"),e._UZ(3,"localize",1),e.qZA(),e.TgZ(4,"p",2),e._UZ(5,"localize",3),e.qZA()(),e.TgZ(6,"div",4),e.YNc(7,yO,3,0,"div",5),e.YNc(8,vO,3,1,"div",5),e.TgZ(9,"form",null,6)(11,"div",7)(12,"div",8)(13,"label"),e._UZ(14,"localize",9),e.qZA()(),e.TgZ(15,"div",10)(16,"label"),e._UZ(17,"localize",11),e.qZA()(),e.TgZ(18,"div",8)(19,"label"),e._UZ(20,"localize",12),e.qZA()(),e.TgZ(21,"div",10)(22,"label"),e._UZ(23,"localize",13),e.qZA()()(),e.YNc(24,bO,2,3,"div",14),e.TgZ(25,"div",7)(26,"div",15)(27,"button",16),e.NdJ("click",function(){return t.onCancel()}),e.TgZ(28,"span"),e._UZ(29,"localize",17),e.qZA()(),e.TgZ(30,"button",18),e.NdJ("click",function(){return t.onNext()}),e.TgZ(31,"span"),e._UZ(32,"localize",19),e.qZA()()()()()()()),2&n&&(e.xp6(7),e.Q6J("ngIf",t.hasProblems()),e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(16),e.Q6J("ngForOf",t.configuration.termProblems),e.xp6(6),e.Q6J("disabled",t.hasProblems()))},dependencies:[T.sg,T.O5,y._Y,y.JL,y.F,Sn.l,$h],encapsulation:2});class Zd{constructor(n,t,o,a,l){this.service=n,this.bsModalRef=t,this.modalService=o,this.localizeService=a,this.router=l,this.message=null,this.state="MAP"}init(n,t="type",o=!1){this.configuration=n,this.property=t,this.includeChild=o}onStateChange(n){"BACK"===n?this.handleBack():"NEXT"===n?this.handleNext():"CANCEL"===n&&this.handleCancel()}handleBack(){"LOCATION"===this.state&&(this.state="MAP")}handleNext(){"MAP"===this.state?this.configuration.postalCode?this.handleSubmit():this.state="LOCATION":"LOCATION"===this.state?this.handleSubmit():"LOCATION-PROBLEM"===this.state?null!=this.configuration.termProblems?this.state="TERM-PROBLEM":this.handleSubmit():"TERM-PROBLEM"===this.state&&this.handleSubmit()}handleSubmit(){this.service.importSpreadsheet(this.configuration).then(n=>{null!=n.locationProblems?(this.state="LOCATION-PROBLEM",this.configuration=n):null!=n.termProblems?(this.state="TERM-PROBLEM",this.configuration=n):(this.bsModalRef.hide(),this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("data.import.go.to.scheduled.jobs.confirm.message"),this.bsModalRef.content.submitText=this.localizeService.decode("data.import.go.to.scheduled.jobs.button"),this.bsModalRef.content.onConfirm.subscribe(t=>{this.router.navigate(["/registry/scheduled-jobs"])}))}).catch(n=>{this.error(n)})}handleCancel(){this.service.cancelImport(this.configuration).then(n=>{this.bsModalRef.hide()}).catch(n=>{this.error(n)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function SO(i,n){if(1&i&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function PO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"attributes-page",4),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function EO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"location-page",5),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function AO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"location-problem-page",4),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function kO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"term-problem-page",4),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onStateChange(a))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("configuration",t.configuration)}}function IO(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,PO,2,1,"div",2),e.YNc(2,EO,2,1,"div",2),e.YNc(3,AO,2,1,"div",2),e.YNc(4,kO,2,1,"div",2),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","MAP"===t.state),e.xp6(1),e.Q6J("ngIf","LOCATION"===t.state),e.xp6(1),e.Q6J("ngIf","LOCATION-PROBLEM"===t.state),e.xp6(1),e.Q6J("ngIf","TERM-PROBLEM"===t.state)}}Zd.\u0275fac=function(n){return new(n||Zd)(e.Y36(pr),e.Y36(Ln.UZ),e.Y36(Ln.tT),e.Y36(nn.oQ),e.Y36(w.F0))},Zd.\u0275cmp=e.Xpm({type:Zd,selectors:[["spreadsheet-modal"]],decls:3,vars:2,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[3,"configuration","stateChange"],[3,"configuration","property","includeChild","stateChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,xO,2,1,"div",1),e.YNc(2,OO,5,4,"div",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",null!=t.configuration&&t.configuration))},dependencies:[T.O5,Ed,Ad,kd,Id],encapsulation:2});class Wh{constructor(n,t,o,a,l){this.service=n,this.bsModalRef=t,this.modalService=o,this.localizeService=a,this.router=l,this.message=null,this.state="MAP"}ngOnInit(){}onStateChange(n){"BACK"===n?this.handleBack():"NEXT"===n?this.handleNext():"CANCEL"===n&&this.handleCancel()}handleBack(){"LOCATION"===this.state&&(this.state="MAP")}handleNext(){"MAP"===this.state?this.configuration.postalCode?this.handleSubmit():this.state="LOCATION":"LOCATION"===this.state?this.handleSubmit():"LOCATION-PROBLEM"===this.state?null!=this.configuration.termProblems?this.state="TERM-PROBLEM":this.handleSubmit():"TERM-PROBLEM"===this.state&&this.handleSubmit()}handleSubmit(){this.message=null,this.service.importShapefile(this.configuration).then(n=>{null!=n.locationProblems?(this.state="LOCATION-PROBLEM",this.configuration=n):null!=n.termProblems?(this.state="TERM-PROBLEM",this.configuration=n):(this.bsModalRef.hide(),this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("data.import.go.to.scheduled.jobs.confirm.message"),this.bsModalRef.content.submitText=this.localizeService.decode("data.import.go.to.scheduled.jobs.button"),this.bsModalRef.content.cancelText=this.localizeService.decode("modal.button.close"),this.bsModalRef.content.onConfirm.subscribe(t=>{this.router.navigate(["/registry/scheduled-jobs"])}))}).catch(n=>{this.error(n)})}handleCancel(){this.message=null,this.service.cancelImport(this.configuration).then(n=>{this.bsModalRef.hide()}).catch(n=>{this.error(n)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}Wh.\u0275fac=function(n){return new(n||Wh)(e.Y36(pr),e.Y36(Ln.UZ),e.Y36(Ln.tT),e.Y36(nn.oQ),e.Y36(w.F0))},Wh.\u0275cmp=e.Xpm({type:Wh,selectors:[["shapefile-modal"]],decls:3,vars:2,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[3,"configuration","stateChange"],["property","type",3,"configuration","stateChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,SO,2,1,"div",1),e.YNc(2,IO,5,4,"div",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",null!=t.configuration&&t.configuration))},dependencies:[T.O5,Ed,Ad,kd,Id],encapsulation:2});const ZO=["myFile"],NO=["dateFieldComponents"],ev=function(i){return{active:i}};function LO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div")(2,"div",1),e._UZ(3,"div",2),e.TgZ(4,"div",3)(5,"label",4)(6,"input",5),e.NdJ("change",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.setImportSource(a,"FILE"))}),e.qZA(),e.TgZ(7,"span",6),e._UZ(8,"localize",7),e.qZA(),e.TgZ(9,"p",8),e._UZ(10,"localize",9),e.qZA()(),e.TgZ(11,"label",4)(12,"input",5),e.NdJ("change",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.setImportSource(a,"EXTERNAL"))}),e.qZA(),e.TgZ(13,"span",6),e._UZ(14,"localize",10),e.qZA(),e.TgZ(15,"p",8),e._UZ(16,"localize",11),e.qZA()(),e.TgZ(17,"div",12)(18,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNext())}),e._UZ(19,"localize",14),e.qZA()()(),e._UZ(20,"div",15),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("value",!0)("checked",!t.isExternal),e.xp6(1),e.Q6J("ngClass",e.VKq(6,ev,!t.isExternal)),e.xp6(5),e.Q6J("value",!1)("checked",t.isExternal),e.xp6(1),e.Q6J("ngClass",e.VKq(8,ev,t.isExternal))}}function zO(i,n){if(1&i&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.oid),e.xp6(1),e.Oqu(t.label.localizedValue)}}function DO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",45),e._UZ(2,"localize",46),e.qZA(),e.TgZ(3,"div",23)(4,"select",47),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.externalSystemId=a)}),e.YNc(5,zO,2,2,"option",25),e.qZA()(),e._UZ(6,"div",26),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.externalSystemId),e.xp6(1),e.Q6J("ngForOf",t.externalSystems)}}function RO(i,n){if(1&i&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.code),e.xp6(1),e.Oqu(t.label)}}function FO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",49),e._UZ(2,"localize",50),e.qZA(),e.TgZ(3,"div",23)(4,"select",51),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.hierarchyCode=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSelectHierarchy())}),e._UZ(5,"option"),e.YNc(6,RO,2,2,"option",25),e.qZA()(),e._UZ(7,"div",26),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.hierarchyCode),e.xp6(2),e.Q6J("ngForOf",t.filteredHierarchyViews)}}function UO(i,n){if(1&i&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.code),e.xp6(1),e.Oqu(t.super?t.super.label+" : "+t.label:t.label)}}function qO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",52),e._UZ(2,"localize",53),e.qZA(),e.TgZ(3,"div",23)(4,"select",54),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.typeCode=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSelectType())}),e._UZ(5,"option"),e.YNc(6,UO,2,2,"option",25),e.qZA()(),e._UZ(7,"div",26),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.typeCode),e.xp6(2),e.Q6J("ngForOf",t.filteredTypeViews)}}function JO(i,n){1&i&&e._UZ(0,"localize",55)}function jO(i,n){1&i&&e._UZ(0,"localize",56)}function BO(i,n){if(1&i&&(e.TgZ(0,"option",48),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.strategy),e.xp6(1),e.Oqu(t.label)}}function GO(i,n){1&i&&e._UZ(0,"localize",57)}function VO(i,n){1&i&&e._UZ(0,"localize",58)}function YO(i,n){if(1&i&&e._UZ(0,"input",59,60),2&i){const t=e.oxw(2);e.Q6J("uploader",t.uploader)}}function HO(i,n){if(1&i&&e._UZ(0,"input",61,60),2&i){const t=e.oxw(2);e.Q6J("uploader",t.uploader)}}function QO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div")(2,"form",16,17),e.YNc(4,DO,7,2,"div",18),e.YNc(5,FO,8,2,"div",18),e.YNc(6,qO,8,2,"div",18),e.TgZ(7,"div",19)(8,"label",20),e.YNc(9,JO,1,0,"localize",21),e.YNc(10,jO,1,0,"localize",22),e.qZA(),e.TgZ(11,"div",23)(12,"select",24),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.importStrategy=a)})("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.checkDates())}),e.YNc(13,BO,2,2,"option",25),e.qZA()(),e._UZ(14,"div",26),e.qZA(),e.TgZ(15,"div",19)(16,"label",27),e._UZ(17,"localize",28),e.qZA(),e.TgZ(18,"div",23)(19,"date-field",29,30),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.startDate=a)})("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.checkDates())}),e.qZA()(),e._UZ(21,"div",26),e.qZA(),e.TgZ(22,"div",19)(23,"label",31),e._UZ(24,"localize",32),e.qZA(),e.TgZ(25,"div",23)(26,"date-field",33,30),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.endDate=a)})("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.checkDates())}),e.qZA()(),e._UZ(28,"div",26),e.qZA(),e.TgZ(29,"div",19)(30,"label",34),e._UZ(31,"localize",35),e.qZA(),e.TgZ(32,"div",23)(33,"boolean-field",36),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.copyBlank=a)}),e.qZA()(),e._UZ(34,"div",26),e.qZA(),e.TgZ(35,"div",19)(36,"label",37),e.YNc(37,GO,1,0,"localize",38),e.YNc(38,VO,1,0,"localize",39),e.qZA(),e.TgZ(39,"div",23),e.YNc(40,YO,2,1,"input",40),e.YNc(41,HO,2,1,"input",41),e.qZA(),e._UZ(42,"div",26),e.qZA(),e.TgZ(43,"div",19),e._UZ(44,"div",26),e.TgZ(45,"div",42)(46,"button",43),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onClick())}),e._UZ(47,"localize",44),e.qZA()(),e._UZ(48,"div",26),e.qZA()()()()}if(2&i){const t=e.MAs(3),o=e.oxw();e.xp6(4),e.Q6J("ngIf",o.isExternal),e.xp6(1),e.Q6J("ngIf",o.filteredHierarchyViews),e.xp6(1),e.Q6J("ngIf",o.filteredTypeViews),e.xp6(3),e.Q6J("ngIf","EXCEL"===o.format),e.xp6(1),e.Q6J("ngIf","SHAPEFILE"===o.format),e.xp6(2),e.Q6J("ngModel",o.importStrategy),e.xp6(1),e.Q6J("ngForOf",o.importStrategies),e.xp6(6),e.Q6J("value",o.startDate)("inputName","startDate")("allowFutureDates",!0),e.xp6(7),e.Q6J("value",o.endDate)("inputName","endDate")("allowInfinity",!0)("allowFutureDates",!0)("required",!0),e.xp6(7),e.Q6J("value",o.copyBlank),e.xp6(4),e.Q6J("ngIf","EXCEL"===o.format),e.xp6(1),e.Q6J("ngIf","SHAPEFILE"===o.format),e.xp6(2),e.Q6J("ngIf","EXCEL"===o.format),e.xp6(1),e.Q6J("ngIf","SHAPEFILE"===o.format),e.xp6(5),e.Q6J("disabled",!o.isValid||t.invalid)}}class Xh{constructor(n,t,o,a,l,_,C,N){this.service=n,this.eventService=t,this.modalService=o,this.localizationService=a,this.authService=l,this.sysService=_,this.hierarchyService=C,this.changeDetectorRef=N,this.currentDate=new Date,this.showImportConfig=!1,this.isValid=!1,this.importStrategies=[{strategy:$a.NEW_AND_UPDATE,label:this.localizationService.decode("etl.import.ImportStrategy.NEW_AND_UPDATE")},{strategy:$a.NEW_ONLY,label:this.localizationService.decode("etl.import.ImportStrategy.NEW_ONLY")},{strategy:$a.UPDATE_ONLY,label:this.localizationService.decode("etl.import.ImportStrategy.UPDATE_ONLY")}],this.typeCode=null,this.hierarchyCode=null,this.startDate=null,this.endDate=null,this.isExternal=!1,this.isLoading=!0,this.copyBlank=!0}ngOnInit(){this.sysService.getExternalSystems(1,100).then(o=>{this.externalSystems=o.resultSet,0===this.externalSystems.length&&(this.isExternal=!1,this.showImportConfig=!0),this.isLoading=!1}).catch(o=>{this.error(o)}),this.hierarchyService.getHierarchyGroupedTypes().then(o=>{this.allHierarchyViews=o,this.allTypeViews=[];let a=this.allHierarchyViews.length;for(let _=0;_<a;++_){let C=this.allHierarchyViews[_],N=C.types.length;for(let F=0;F<N;++F){let V=C.types[F],ue=this.allHierarchyViews.length;for(let ce=0;ce<ue;++ce){let Te=this.allHierarchyViews[ce],We=Te.types.findIndex(it=>V.code===it.code);-1!==We&&(Te.types[We]=V)}}}let l=this.allHierarchyViews.length;for(let _=0;_<l;++_){let C=this.allHierarchyViews[_],N=C.types.length;for(let F=0;F<N;++F){let V=C.types[F],ue=this.allTypeViews.findIndex(ce=>ce.code===V.code);if(-1!==ue){let ce=this.allTypeViews[ue];-1===ce.hierarchies.findIndex(We=>We.code===C.code)&&ce.hierarchies.push(C)}else null==V.hierarchies&&(V.hierarchies=[]),V.hierarchies.push(C),this.allTypeViews.push(V)}}this.filteredHierarchyViews=this.allHierarchyViews,this.filteredTypeViews=this.allTypeViews}).catch(o=>{this.error(o)});let n=pt.N.apiUrl+"/api/excel/get-configuration";"SHAPEFILE"===this.format&&(n=pt.N.apiUrl+"/api/shapefile/get-shapefile-configuration"),this.uploader=new I.bA({queueLimit:1,removeAfterUpload:!0,url:n}),this.uploader.onBuildItemForm=(o,a)=>{a.append("type",this.typeCode),a.append("copyBlank",this.copyBlank),null!=this.startDate&&a.append("startDate",this.startDate),null!=this.endDate&&a.append("endDate",this.endDate),this.importStrategy&&a.append("strategy",this.importStrategy)},this.uploader.onBeforeUploadItem=o=>{this.eventService.start()},this.uploader.onCompleteItem=(o,a,l,_)=>{this.fileRef.nativeElement.value="",this.eventService.complete()},this.uploader.onSuccessItem=(o,a,l,_)=>{const C=JSON.parse(a);C.isExternal=this.isExternal,C.hierarchy=this.hierarchyCode;let N=null;for(let F=0;F<this.externalSystems.length;++F){let V=this.externalSystems[F];V.oid===this.externalSystemId&&(N=V)}C.externalSystemId=this.externalSystemId,C.externalSystem=N,"SHAPEFILE"===this.format?(this.bsModalRef=this.modalService.show(Wh,{backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.configuration=C):(this.bsModalRef=this.modalService.show(Zd,{backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(C))},this.uploader.onErrorItem=(o,a,l,_)=>{const C=JSON.parse(a);this.error({error:C})}}onSelectHierarchy(){let n=null,t=this.allHierarchyViews.length;for(let o=0;o<t;++o)if(this.allHierarchyViews[o].code===this.hierarchyCode){n=this.allHierarchyViews[o];break}this.filteredTypeViews=null!=n?n.types:this.allTypeViews}onSelectType(){let n=null,t=this.allTypeViews.length;for(let o=0;o<t;++o)if(this.allTypeViews[o].code===this.typeCode){n=this.allTypeViews[o];break}this.filteredHierarchyViews=null!=n?n.hierarchies:this.allHierarchyViews,this.checkDates()}onClick(){null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizationService.decode("io.missing.file"),error:{}})}setImportSource(n,t){this.isExternal="EXTERNAL"===t}onNext(){this.showImportConfig=!0}onBack(){this.showImportConfig=!1}checkDates(){setTimeout(()=>{this.isValid=this.checkDateFieldValidity()},0)}checkDateFieldValidity(){let t,n=this.dateFieldComponentsArray.toArray();for(let o=0;o<n.length;o++){let a=n[o];if("startDate"===a.inputName&&(t=a),!a.valid)return!1}return this.startDate>this.endDate&&(t.setInvalid(this.localizationService.decode("date.input.startdate.after.enddate.error.message")),this.changeDetectorRef.detectChanges()),!0}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}Xh.\u0275fac=function(n){return new(n||Xh)(e.Y36(pr),e.Y36(nn.PO),e.Y36(Ln.tT),e.Y36(nn.oQ),e.Y36(nn.e8),e.Y36(nn.iu),e.Y36(Wl),e.Y36(e.sBO))},Xh.\u0275cmp=e.Xpm({type:Xh,selectors:[["dataimporter"]],viewQuery:function(n,t){if(1&n&&(e.Gf(ZO,5),e.Gf(NO,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.fileRef=o.first),e.iGM(o=e.CRH())&&(t.dateFieldComponentsArray=o)}},inputs:{format:"format"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],[1,"col-xs-1"],[1,"col-xs-9","radio-btn-wrapper"],[1,"radio"],["type","checkbox","name","import-source",3,"value","checked","change"],[3,"ngClass"],["key","importer.import.from-file.label"],[1,"radio-label-description"],["key","importer.import.from-file.description"],["key","importer.import.from-external.label"],["key","importer.import.from-external.description"],[1,"button-holder"],["type","submit",1,"btn","btn-primary",3,"click"],["key","io.next"],[1,"col-xs-2"],["autocomplete","off"],["form","ngForm"],["class","form-group row",4,"ngIf"],[1,"form-group","row"],["for","strategy",1,"col-md-2","text-right"],["key","spreadsheet.import.import.strategy",4,"ngIf"],["key","shapefile.import.import.strategy",4,"ngIf"],[1,"col-md-8"],["id","strategy","name","strategy","required","",1,"select-area",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["for","startDate",1,"col-md-2","text-right"],["key","io.startDate"],["label","",3,"value","inputName","allowFutureDates","valueChange","change"],["dateFieldComponents",""],["for","endDate",1,"col-md-2","text-right"],["key","io.endDate"],["label","",3,"value","inputName","allowInfinity","allowFutureDates","required","valueChange","change"],["for","copyBlank",1,"col-md-2","text-right"],["key","dataimporter.importblankcells"],["label","",3,"value","valueChange"],["for","file",1,"col-md-2","text-right"],["key","io.spreadsheet",4,"ngIf"],["key","io.shapefile",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".xls, .xlsx","required","",3,"uploader",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".zip","required","",3,"uploader",4,"ngIf"],[1,"button-holder","col-md-8","text-right"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"],["for","externalSystem",1,"col-md-2","text-right"],["key","io.import.externalSystems"],["id","externalSystem","name","externalSystem","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"value"],["for","hierarchyCode",1,"col-md-2","text-right"],["key","io.modal.hierarchy"],["id","hierarchyCode","name","hierarchyCode","required","",1,"select-area",3,"ngModel","ngModelChange","change"],["for","code",1,"col-md-2","text-right"],["key","io.geoObjectType"],["id","code","name","code","required","",1,"select-area",3,"ngModel","ngModelChange","change"],["key","spreadsheet.import.import.strategy"],["key","shapefile.import.import.strategy"],["key","io.spreadsheet"],["key","io.shapefile"],["name","file","type","file","ng2FileSelect","","accept",".xls, .xlsx","required","",1,"ghost-input",3,"uploader"],["myFile",""],["name","file","type","file","ng2FileSelect","","accept",".zip","required","",1,"ghost-input",3,"uploader"]],template:function(n,t){1&n&&(e.YNc(0,LO,21,10,"div",0),e.YNc(1,QO,49,21,"div",0)),2&n&&(e.Q6J("ngIf",!t.isLoading&&!t.showImportConfig&&t.externalSystems.length>0),e.xp6(1),e.Q6J("ngIf",!t.isLoading&&null!==t.isExternal&&t.showImportConfig))},dependencies:[T.mk,T.sg,T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,I.C6,Sn.l,rl.M,Xl.Q],styles:[".radio-btn-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px;font-weight:400}.radio-btn-wrapper[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#6ba542;font-weight:700}.radio-btn-wrapper[_ngcontent-%COMP%]   p.radio-label-description[_ngcontent-%COMP%]{color:#a3a0a0;margin-left:30px}"]});const tv=function(i){return{active:i}};function KO(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.renderContent("SPREADSHEET"))}),e._UZ(1,"localize",10),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,tv,"SPREADSHEET"===t.content))}}function $O(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.renderContent("SHAPEFILE"))}),e._UZ(1,"localize",11),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,tv,"SHAPEFILE"===t.content))}}function WO(i,n){1&i&&e._UZ(0,"dataimporter",12),2&i&&e.Q6J("format","EXCEL")}function XO(i,n){1&i&&e._UZ(0,"dataimporter",12),2&i&&e.Q6J("format","SHAPEFILE")}class ef{constructor(n,t,o){this.localizationService=n,this.modalService=t,this.service=o,this.content="SPREADSHEET",this.isAdmin=o.isAdmin(),this.isMaintainer=this.isAdmin||o.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||o.isContributer(),this.renderContent(this.isMaintainer?"SPREADSHEET":"EXPORT")}ngOnInit(){}renderContent(n){this.content=n,"SPREADSHEET"===n?this.pageTitle=this.localizationService.decode("spreadsheet.title"):"SHAPEFILE"===n?this.pageTitle=this.localizationService.decode("shapefile.title"):"EXPORT"===n&&(this.pageTitle=this.localizationService.decode("io.export.title"))}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}ef.\u0275fac=function(n){return new(n||ef)(e.Y36(nn.oQ),e.Y36(Ln.tT),e.Y36(nn.e8))},ef.\u0275cmp=e.Xpm({type:ef,selectors:[["data-page"]],decls:17,vars:5,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[1,"row"],[1,"col-md-1"],[1,"col-md-10",2,"padding-top","30px"],[1,"heading"],["style","margin-right:10px;font-size:20px;",3,"routerLink","ngClass","click",4,"ngIf"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[3,"format",4,"ngIf"],[2,"margin-right","10px","font-size","20px",3,"routerLink","ngClass","click"],["key","import-spreadsheet-localization-manager.menu"],["key","import-shapefile-localization-manager.menu"],[3,"format"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2),e._UZ(5,"div",3),e.TgZ(6,"div",4)(7,"div",5)(8,"h2"),e._uU(9),e.qZA()(),e.TgZ(10,"div"),e.YNc(11,KO,2,3,"a",6),e.YNc(12,$O,2,3,"a",6),e.qZA(),e.TgZ(13,"div",7),e.YNc(14,WO,1,1,"dataimporter",8),e.YNc(15,XO,1,1,"dataimporter",8),e.qZA()(),e._UZ(16,"div",3),e.qZA()()()),2&n&&(e.xp6(9),e.hij(" ",t.pageTitle," "),e.xp6(2),e.Q6J("ngIf",t.isMaintainer),e.xp6(1),e.Q6J("ngIf",t.isMaintainer),e.xp6(2),e.Q6J("ngIf","SPREADSHEET"===t.content),e.xp6(1),e.Q6J("ngIf","SHAPEFILE"===t.content))},dependencies:[T.mk,T.O5,w.rH,Sn.l,Da.N,ba.C,Xh],styles:["a.active[_ngcontent-%COMP%]{border-bottom:solid 2px #6BA542}"]});const e6=["myFile"],t6=["attributeEditor"];function n6(i,n){if(1&i&&e._UZ(0,"i",25),2&i){const t=e.oxw();e.Q6J("ngClass",t.isAscending("createdBy")?"fa-arrow-down":"fa-arrow-up")}}function i6(i,n){if(1&i&&e._UZ(0,"i",25),2&i){const t=e.oxw();e.Q6J("ngClass",t.isAscending("geoObjectTypeLabel")?"fa-arrow-down":"fa-arrow-up")}}function o6(i,n){if(1&i&&e._UZ(0,"i",25),2&i){const t=e.oxw();e.Q6J("ngClass",t.isAscending("geoObjectLabel")?"fa-arrow-down":"fa-arrow-up")}}function r6(i,n){if(1&i&&e._UZ(0,"i",25),2&i){const t=e.oxw();e.Q6J("ngClass",t.isAscending("createDate")?"fa-arrow-down":"fa-arrow-up")}}function a6(i,n){if(1&i&&e._UZ(0,"i",25),2&i){const t=e.oxw();e.Q6J("ngClass",t.isAscending("approvalStatus")?"fa-arrow-down":"fa-arrow-up")}}function s6(i,n){if(1&i&&e._UZ(0,"i",25),2&i){const t=e.oxw();e.Q6J("ngClass",t.isAscending("oid")?"fa-arrow-down":"fa-arrow-up")}}function l6(i,n){1&i&&(e.TgZ(0,"h4",40),e._UZ(1,"localize",49),e.qZA())}function c6(i,n){1&i&&(e.TgZ(0,"h4",40),e._UZ(1,"localize",50),e.qZA())}function u6(i,n){1&i&&(e.TgZ(0,"div",51),e._UZ(1,"localize",52),e.qZA())}function p6(i,n){1&i&&(e.TgZ(0,"div",51),e._UZ(1,"localize",53),e.qZA())}function d6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",54)(1,"label",55),e._UZ(2,"localize",56),e.qZA(),e.TgZ(3,"textarea",57),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.contributorNotes=a)}),e.qZA()()}if(2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.MGl("for","contribNotesInput-",t.oid,""),e.xp6(2),e.MGl("id","contribNotesInput-",t.oid,""),e.Q6J("ngModel",t.contributorNotes)("disabled",!t.permissions.includes("WRITE_DETAILS"))}}function h6(i,n){if(1&i&&e._UZ(0,"geoobject-shared-attribute-editor",70,71),2&i){const t=e.oxw(3).$implicit,o=e.oxw();e.Q6J("readOnly",!o.canEdit(t))("geoObjectType",t.current.geoObjectType)("postGeoObject","UpdateGeoObject"==t.type?t.current.geoObject:t.actions[0].geoObjectJson)("changeRequest",t)("hierarchies","UpdateGeoObject"==t.type?t.current.hierarchies:t.actions[0].parentJson)("isGeometryInlined",!0)("isNew","CreateGeoObject"===t.type)}}function f6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",72)(1,"label",55),e._UZ(2,"localize",73),e.qZA(),e.TgZ(3,"textarea",74),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(3).$implicit;return e.KtG(l.maintainerNotes=a)}),e.qZA()()}if(2&i){const t=e.oxw(3).$implicit;e.xp6(1),e.MGl("for","maintainerNotesInput-",t.oid,""),e.xp6(2),e.MGl("id","maintainerNotesInput-",t.oid,""),e.Q6J("ngModel",t.maintainerNotes)("disabled",!t.permissions.includes("WRITE_MAINTAINER_NOTES"))}}function g6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",72)(1,"label",55),e._UZ(2,"localize",75),e.qZA(),e.TgZ(3,"input",76),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(3).$implicit;return e.KtG(l.additionalNotes=a)}),e.qZA()()}if(2&i){const t=e.oxw(3).$implicit;e.xp6(1),e.MGl("for","additionalNotes-",t.oid,""),e.xp6(2),e.MGl("id","additionalNotes-",t.oid,""),e.Q6J("ngModel",t.additionalNotes)("disabled",!t.permissions.includes("WRITE_MAINTAINER_NOTES"))}}function _6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",80)(1,"a",14),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(4).$implicit,C=e.oxw();return e.KtG(C.onDownloadFile(_,l.oid))}),e._uU(2),e.qZA(),e.TgZ(3,"i",81),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(4).$implicit,C=e.oxw();return e.KtG(C.onDeleteFile(_,l.oid))}),e.qZA()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Oqu(t.fileName)}}function m6(i,n){if(1&i&&(e.TgZ(0,"div",77)(1,"ul",78),e.YNc(2,_6,4,1,"li",79),e.qZA()()),2&i){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.documents)}}function y6(i,n){1&i&&(e.TgZ(0,"p",82),e._UZ(1,"localize",83),e.qZA())}function v6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",84),e._UZ(1,"input",85,86),e.TgZ(3,"button",87),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3).$implicit,l=e.oxw();return e.KtG(l.onUpload(a))}),e.ALo(4,"localize"),e._UZ(5,"localize",88),e.qZA()()}if(2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("uploader",t.uploader),e.xp6(2),e.Q6J("title",e.lcZ(4,2,"change.request.upload.document.btn.hover"))}}function b6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",94),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(5).$implicit,l=e.oxw();return e.KtG(l.onReject(a))}),e.ALo(1,"localize"),e._UZ(2,"localize",95),e.qZA()}if(2&i){const t=e.oxw(5).$implicit;e.Q6J("disabled","PENDING"!==t.approvalStatus)("title",e.lcZ(1,2,"change.request.reject.all.btn.hover"))}}function x6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span")(1,"button",91),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(4).$implicit,l=e.oxw();return e.KtG(l.onExecute(a))}),e.ALo(2,"localize"),e._UZ(3,"localize",92),e.qZA(),e.YNc(4,b6,3,4,"button",93),e.qZA()}if(2&i){const t=e.oxw(4).$implicit,o=e.oxw();e.xp6(1),e.Q6J("disabled","PENDING"!==t.approvalStatus||null!=o.attributeEditor&&o.isStringEmpty(o.attributeEditor.getChangeRequestEditor().getEditorForAttributeByCode("code").value))("title",e.lcZ(2,4,"change.request.implement.decisions.btn.hover")),e.xp6(2),e.Q6J("key","UpdateGeoObject"===t.type?"change.request.accept.changes.btn":"change.request.accept.newGeoObject.btn"),e.xp6(1),e.Q6J("ngIf","CreateGeoObject"===t.type)}}function C6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",100),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(6);return e.KtG(a.onEditAttributes())}),e._UZ(1,"localize",101),e.qZA()}}function w6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",102),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(6);return e.KtG(a.onEditAttributes())}),e._UZ(1,"localize",103),e.qZA()}}function T6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",104),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(5).$implicit,l=e.oxw();return e.KtG(l.onUpdate(a))}),e.ALo(1,"localize"),e._UZ(2,"localize",105),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"modal.button.update"))}function M6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",106),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(5).$implicit,l=e.oxw();return e.KtG(l.onDelete(a))}),e.ALo(1,"localize"),e._UZ(2,"localize",107),e.qZA()}if(2&i){const t=e.oxw(6);e.Q6J("disabled",!t.isEditing)("title",e.lcZ(1,2,"change.request.delete.request.hover"))}}function O6(i,n){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,C6,2,0,"button",96),e.YNc(2,w6,2,0,"button",97),e.YNc(3,T6,3,3,"button",98),e.YNc(4,M6,3,4,"button",99),e.qZA()),2&i){const t=e.oxw(4).$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",!o.isEditing),e.xp6(1),e.Q6J("ngIf",o.isEditing),e.xp6(1),e.Q6J("ngIf",o.isEditing),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("DELETE")&&t.createdBy===o.getUsername())}}function S6(i,n){if(1&i&&(e.TgZ(0,"div",89),e.YNc(1,x6,5,6,"span",90),e.YNc(2,O6,5,4,"span",90),e.qZA()),2&i){const t=e.oxw(3).$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",t.permissions.includes("WRITE_APPROVAL_STATUS")),e.xp6(1),e.Q6J("ngIf",o.isValid&&t.permissions.includes("WRITE_DETAILS")&&t.createdBy===o.getUsername())}}function P6(i,n){if(1&i&&(e.TgZ(0,"div",58)(1,"div",59)(2,"div",60)(3,"div",1),e.YNc(4,h6,2,7,"geoobject-shared-attribute-editor",61),e.qZA()(),e.TgZ(5,"div",62)(6,"div",63),e.YNc(7,f6,4,4,"div",64),e.YNc(8,g6,4,4,"div",64),e.qZA(),e.TgZ(9,"div",63)(10,"div")(11,"label"),e._UZ(12,"localize",65),e.qZA(),e.YNc(13,m6,3,1,"div",66),e.YNc(14,y6,2,0,"p",67),e.YNc(15,v6,6,4,"div",68),e.qZA()()()(),e.YNc(16,S6,3,2,"div",69),e.qZA()),2&i){const t=e.oxw(2).$implicit,o=e.oxw();e.xp6(4),e.Q6J("ngIf",t),e.xp6(3),e.Q6J("ngIf",t.permissions.includes("READ_MAINTAINER_NOTES")),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("READ_MAINTAINER_NOTES")),e.xp6(5),e.Q6J("ngIf",t.documents.length>0),e.xp6(1),e.Q6J("ngIf",0===t.documents.length),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("WRITE_DOCUMENTS")&&o.isEditing),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("WRITE_APPROVAL_STATUS")||t.permissions.includes("DELETE"))}}const E6=function(i,n,t,o){return{"status-pending-container":i,"status-accepted-container":n,"status-partial-container":t,"status-rejected-container":o}};function A6(i,n){if(1&i&&(e.TgZ(0,"tr",36)(1,"td",37)(2,"div",38)(3,"div")(4,"h3",39),e._uU(5),e.qZA(),e.TgZ(6,"h4",40),e._uU(7),e.qZA(),e.YNc(8,l6,2,0,"h4",41),e.YNc(9,c6,2,0,"h4",41),e.qZA()(),e.TgZ(10,"div",42)(11,"div",1),e.YNc(12,u6,2,0,"div",43),e.YNc(13,p6,2,0,"div",43),e.YNc(14,d6,4,4,"div",44),e.TgZ(15,"div")(16,"p"),e._UZ(17,"localize",45),e._uU(18,"\xa0"),e.TgZ(19,"strong"),e._uU(20),e.qZA()(),e.TgZ(21,"p"),e._UZ(22,"localize",46),e._uU(23,"\xa0"),e.TgZ(24,"strong"),e._uU(25),e.qZA()(),e.TgZ(26,"p"),e._UZ(27,"localize",47),e._uU(28,"\xa0"),e.TgZ(29,"strong"),e._uU(30),e.qZA()()(),e.YNc(31,P6,17,7,"div",48),e.qZA()()()()),2&i){const t=e.oxw().$implicit,o=e.oxw();e.Q6J("@fadeInOut",void 0)("ngClass",e.l5B(13,E6,"PENDING"===t.approvalStatus,"ACCEPTED"===t.approvalStatus,"PARTIAL"===t.approvalStatus,"REJECTED"===t.approvalStatus)),e.xp6(5),e.Oqu(t.geoObject.label),e.xp6(2),e.Oqu(t.geoObject.code),e.xp6(1),e.Q6J("ngIf","UpdateGeoObject"===t.type),e.xp6(1),e.Q6J("ngIf","CreateGeoObject"===t.type),e.xp6(3),e.Q6J("ngIf",!o.isRequestTooOld(t)&&"INVALID"===t.approvalStatus),e.xp6(1),e.Q6J("ngIf",o.isRequestTooOld(t)),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("READ_CONTRIBUTOR_NOTES")),e.xp6(6),e.Oqu(t.createdBy),e.xp6(5),e.Oqu(t.email),e.xp6(5),e.Oqu(t.phoneNumber),e.xp6(1),e.Q6J("ngIf","INVALID"!==t.approvalStatus&&!o.isRequestTooOld(t))}}const k6=function(i){return{"row-active":i}},I6=function(i,n,t,o){return{"status-pending":i,"status-accepted":n,"status-partial":t,"status-rejected":o}};function Z6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",26),e.NdJ("click",function(a){const _=e.CHM(t).$implicit,C=e.oxw();return e.KtG(C.toggle(a,_.oid))}),e.TgZ(1,"td",27)(2,"h5")(3,"strong"),e._uU(4),e.qZA()()(),e.TgZ(5,"td",28)(6,"h5")(7,"strong"),e._uU(8),e.qZA()()(),e.TgZ(9,"td",28)(10,"h5")(11,"strong"),e._uU(12),e.qZA()()(),e.TgZ(13,"td",29)(14,"span",30),e._UZ(15,"date-text",31),e.qZA()(),e.TgZ(16,"td",27)(17,"h5",32)(18,"strong"),e._uU(19),e.qZA()()(),e.TgZ(20,"td",28)(21,"h5")(22,"strong"),e._uU(23),e.qZA()()(),e.TgZ(24,"td",33),e._UZ(25,"i",34),e.qZA()(),e.YNc(26,A6,32,18,"tr",35)}if(2&i){const t=n.$implicit,o=e.oxw();e.Q6J("ngClass",e.VKq(9,k6,o.toggleId===t.oid)),e.xp6(4),e.Oqu(t.createdBy),e.xp6(4),e.Oqu(t.geoObjectType.label),e.xp6(4),e.Oqu(t.geoObject.label),e.xp6(3),e.Q6J("date",t.createDate),e.xp6(2),e.Q6J("ngClass",e.l5B(11,I6,"PENDING"===t.approvalStatus,"ACCEPTED"===t.approvalStatus,"PARTIAL"===t.approvalStatus,"REJECTED"===t.approvalStatus)),e.xp6(2),e.Oqu(t.statusLabel),e.xp6(4),e.Oqu(t.oid),e.xp6(3),e.Q6J("ngIf",o.toggleId===t.oid)}}function N6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",23)(1,"pagination-controls",108),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.pageChange(a))}),e.qZA()()}}const L6=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};class tf{constructor(n,t,o,a,l,_,C,N,F,V){this.service=n,this.geomService=t,this.modalService=o,this.authService=a,this.localizationService=l,this.eventService=_,this.route=C,this.router=N,this.dateService=F,this.location=V,this.objectKeys=Object.keys,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.requests=[],this.columns=[],this.filterCriteria="ALL",this.sort=[{attribute:"createDate",ascending:!1}],this.hasBaseDropZoneOver=!1,this.oid=null,this.isValid=!0,this.isEditing=!1,this.columns=[{name:l.decode("change.request.user"),prop:"createdBy",sortable:!1},{name:l.decode("change.request.createDate"),prop:"createDate",sortable:!1,width:195},{name:l.decode("change.request.status"),prop:"approvalStatus",sortable:!1}]}ngOnInit(){this.oid=this.route.snapshot.paramMap.get("oid"),this.route.paramMap.subscribe(o=>{this.oid=o.get("oid"),this.refresh()}),null!=this.oid&&(this.toggleId=this.oid),this.uploader=new I.bA({queueLimit:1,removeAfterUpload:!0,url:pt.N.apiUrl+"/api/changerequest/upload-file-cr"}),this.uploader.onBuildItemForm=(o,a)=>{a.append("requestId",this.uploadRequest.oid)},this.uploader.onBeforeUploadItem=o=>{this.eventService.start()},this.uploader.onCompleteItem=(o,a,l,_)=>{this.fileRef.nativeElement.value="",this.eventService.complete()},this.uploader.onSuccessItem=(o,a,l,_)=>{const C=JSON.parse(a),N=this.requests.findIndex(F=>F.oid===C.requestId);-1!==N&&this.requests[N].documents.push(C)},this.uploader.onErrorItem=(o,a,l,_)=>{const C=JSON.parse(a);this.error({error:C})},this.refresh()}isSorting(n){return this.sort.length>0&&this.sort[0].attribute===n}isAscending(n){return this.sort.length>0&&this.sort[0].ascending}onSort(n){let t=this.sort.findIndex(o=>o.attribute===n);if(-1!==t){let o=this.sort[t];o.ascending=!o.ascending}else this.sort=[{attribute:n,ascending:!0}];this.refresh()}getGOTLabel(n){return n.geoObjectJson&&n.geoObjectJson.attributes&&n.geoObjectJson.attributes.displayLabel&&n.geoObjectJson.attributes.displayLabel.values&&n.geoObjectJson.attributes.displayLabel.values[0]&&n.geoObjectJson.attributes.displayLabel.values[0].value&&n.geoObjectJson.attributes.displayLabel.values[0].value.localeValues&&n.geoObjectJson.attributes.displayLabel.values[0].value.localeValues[0]&&n.geoObjectJson.attributes.displayLabel.values[0].value.localeValues[0].value?n.geoObjectJson.attributes.displayLabel.values[0].value.localeValues[0].value:n.geoObjectJson&&n.geoObjectJson.attributes&&n.geoObjectJson.attributes.code?n.geoObjectJson.attributes.code:this.localizationService.decode("geoObject.label")}setValid(n){this.isValid=n}onUpload(n){this.uploadRequest=n,null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizationService.decode("io.missing.file"),error:{}})}isStringEmpty(n){return null==n||0===n.length}onDownloadFile(n,t){window.location.href=pt.N.apiUrl+"/api/changerequest/download-file-cr?requestId="+n.oid+"&fileId="+t}onDeleteFile(n,t){this.service.deleteFile(n.oid,t).then(()=>{const o=n.documents.findIndex(a=>a.oid===t);-1!==o&&n.documents.splice(o,1)}).catch(o=>{this.error(o)})}fileOverBase(n){this.hasBaseDropZoneOver=n}pageChange(n=1){this.oid=null,this.refresh(n)}refresh(n=1){this.geomService.destroy(),this.service.getAllRequests(this.page.pageSize,n,this.filterCriteria,this.sort,this.oid).then(t=>{this.page=t,this.requests=t.resultSet,this.requests.forEach(o=>{if(!o.current.geoObject)for(let a=0;a<o.actions.length;a++)o.actions[0].actionType===Er.CREATEGEOOBJECTACTION&&(o.current.geoObject=JSON.parse(JSON.stringify(o.actions[0].geoObjectJson)))})}).catch(t=>{this.error(t)})}onSelect(n){this.geomService.destroy(),this.service.getAllRequests(this.page.pageSize,1,"ALL",this.sort,this.oid).then(t=>{this.requests=t.resultSet}).catch(t=>{this.error(t)})}onExecute(n){null!=n&&this.service.implementDecisions(n,this.attributeEditor.getChangeRequestEditor().getEditorForAttributeByCode("code").value).then(t=>{n=t,this.refresh();const o=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});o.content.submitText=this.localizationService.decode("change.requests.more.geoobject.updates.submit.btn"),o.content.cancelText=this.localizationService.decode("change.requests.more.geoobject.updates.cancel.btn"),o.content.message=this.localizationService.decode("change.requests.more.geoobject.updates.message"),o.content.onConfirm.subscribe(()=>{const a=this.getFirstGeoObjectInActions(t);if(null!=a)this.router.navigate(["/registry/location-manager"],{queryParams:{text:a.attributes.code,type:a.geoObjectType.code,code:a.attributes.code,uid:a.attributes.uid,pageContext:"DATA"}});else{let l=t.current.geoObject,_=t.current.geoObjectType;null!=l&&null!=_&&this.router.navigate(["/registry/location-manager"],{queryParams:{text:l.attributes.code,type:_.code,code:l.attributes.code,uid:l.attributes.uid,pageContext:"DATA"}})}})}).catch(t=>{this.error(t)})}onReject(n){this.service.rejectChangeRequest(n).then(()=>{this.refresh()}).catch(t=>{this.error(t)})}getFirstGeoObjectInActions(n){for(let t=0;t<n.actions.length;t++){let o=n.actions[t];if(o.hasOwnProperty("geoObjectJson"))return o.geoObjectJson}return null}onDelete(n){if(null!=n){const t=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.type="danger",t.content.submitText=this.localizationService.decode("change.request.delete.request.confirm.btn"),t.content.message=this.localizationService.decode("change.request.delete.request.message"),t.content.onConfirm.subscribe(o=>{this.service.delete(n.oid).then(a=>{let l=-1;for(let _=0;_<this.requests.length;_++)if(this.requests[_].oid===a){l=_;break}l>-1&&this.requests.splice(l,1),this.refresh()}).catch(a=>{this.error(a)})})}}onUpdate(n){null!=n&&this.service.update(n).then(t=>{this.refresh(),this.isEditing=!1}).catch(t=>{this.error(t)})}applyActionStatusProperties(n){this.service.setActionStatus(n.oid,n.approvalStatus).then(t=>{n.decisionMaker="PENDING"!==n.approvalStatus?this.authService.getUsername():""}).catch(t=>{this.error(t)})}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}requestTrackBy(n,t){return t.oid}toggle(n,t){this.location.replaceState("/registry/change-requests/"+t),!n.target.parentElement.className.includes("btn")&&!n.target.className.includes("btn")&&(this.toggleId===t?this.toggleId=null:(this.toggleId=t,this.requests.forEach(o=>{o.oid===t&&(this.actions=o.actions)})))}filter(n){this.filterCriteria=n,this.refresh(1)}setActionStatus(n,t){this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}).content.onConfirm.subscribe(a=>{n.approvalStatus=t,this.applyActionStatusProperties(n)})}getActiveDetailComponent(n){return n.actionType.endsWith("CreateGeoObjectAction")||n.actionType.endsWith("UpdateGeoObjectAction"),n}getUsername(){return this.authService.getUsername()}isRequestTooOld(n){if(n.actions&&n.actions.length>0){let t=n.actions[0];return t.actionType===Er.UPDATEGEOOBJECTACTION||t.actionType===Er.CREATEGEOOBJECTACTION&&!t.geoObjectJson.attributes.exists}return!0}onEditAttributes(){this.isEditing=!this.isEditing}canEdit(n){return n.permissions.includes("WRITE_DETAILS")&&this.isEditing}}function z6(i,n){1&i&&e._UZ(0,"submit-change-request")}tf.\u0275fac=function(n){return new(n||tf)(e.Y36($l),e.Y36(vo),e.Y36(Ln.tT),e.Y36(nn.e8),e.Y36(nn.oQ),e.Y36(nn.PO),e.Y36(w.gz),e.Y36(w.F0),e.Y36(zs.R),e.Y36(T.Ye))},tf.\u0275cmp=e.Xpm({type:tf,selectors:[["request-table"]],viewQuery:function(n,t){if(1&n&&(e.Gf(e6,5),e.Gf(t6,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.fileRef=o.first),e.iGM(o=e.CRH())&&(t.attributeEditor=o.first)}},inputs:{toggleId:"toggleId"},decls:49,vars:21,consts:[[1,"row"],[1,"col-md-12"],[1,"form-group","button-row"],[2,"border-bottom","1px solid",3,"routerLink","ngClass","click"],["key","change.request.all.filter.link"],[2,"margin-left","5px","border-bottom","1px solid",3,"routerLink","ngClass","click"],["key","change.request.pending.filter.link"],["key","change.request.accepted.filter.link"],["key","change.request.partial.filter.link"],["key","change.request.rejected.filter.link"],[2,"border-top","solid 3px #6BA542"],[1,"table"],[2,"height","50px","color","grey"],[2,"vertical-align","middle"],[3,"click"],["key","change.request.contributor.label"],["class","fa cr-sort-arrow",3,"ngClass",4,"ngIf"],["key","geoObjectType.label"],["key","geoObject.label"],["key","change.request.date.contributed.label"],["key","change.request.status.label"],["key","change.request.id.label"],["ngFor","",3,"ngForOf","ngForTrackBy"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[1,"fa","cr-sort-arrow",3,"ngClass"],[1,"clickable",2,"height","50px",3,"ngClass","click"],[1,"col-md-1"],[1,"col-md-2"],[1,"col-md-1",2,"vertical-align","middle","color","grey"],[1,"date-string-display"],[3,"date"],[3,"ngClass"],[1,"col-md-1",2,"vertical-align","middle","text-align","right","padding-right","25px"],["aria-hidden","true",1,"arrow","arrow-right"],["style","background-color:#f7f7f7;",3,"ngClass",4,"ngIf"],[2,"background-color","#f7f7f7",3,"ngClass"],["colspan","7"],[1,"geoobject-panel-header"],[2,"margin-top","10px"],[2,"font-style","italic"],["style","font-style: italic;",4,"ngIf"],[1,"row",2,"margin","0","background","white"],["class","cr-details-invalid error-message",4,"ngIf"],["class","form-group","style","margin-top:20px;",4,"ngIf"],["key","change.request.contributor.prefix.label"],["key","change.request.contributor.email.prefix.label"],["key","change.request.contributor.phone.prefix.label"],["class","cr-details",4,"ngIf"],["key","change.request.type.update.geoobject.label"],["key","change.request.type.create.geoobject.label"],[1,"cr-details-invalid","error-message"],["key","change.request.invalid"],["key","change.request.tooOld"],[1,"form-group",2,"margin-top","20px"],[3,"for"],["key","change.request.contributor.notes.label"],[1,"form-control",2,"height","90px","max-width","100%",3,"id","ngModel","disabled","ngModelChange"],[1,"cr-details"],[1,"action-card",2,"margin-bottom","10px","background-color","white"],[1,"row",2,"background","white"],[3,"readOnly","geoObjectType","postGeoObject","changeRequest","hierarchies","isGeometryInlined","isNew",4,"ngIf"],[1,"row",2,"border-top","1px grey solid","margin","0","padding","10px 0"],[1,"col-md-6"],["class","form-group",4,"ngIf"],["key","change.request.reference.documents.label"],["style","border:1px solid #ccc;border-radius: 4px;",4,"ngIf"],["style","color:grey;font-style:italic;",4,"ngIf"],["style","padding:10px 0;",4,"ngIf"],["class","button-holder","style","margin-bottom:20px;min-height:40px;",4,"ngIf"],[3,"readOnly","geoObjectType","postGeoObject","changeRequest","hierarchies","isGeometryInlined","isNew"],["attributeEditor",""],[1,"form-group"],["key","change.request.maintainer.notes.label"],[1,"form-control",2,"height","90px","max-width","100%","margin","0",3,"id","ngModel","disabled","ngModelChange"],["key","change.request.action.detail.additionalNotes"],["type","text",1,"form-control",2,"width","100%",3,"id","ngModel","disabled","ngModelChange"],[2,"border","1px solid #ccc","border-radius","4px"],[2,"padding","10px","margin","0"],["class","list-group-item","style","padding:0;font-size:inherit;",4,"ngFor","ngForOf"],[1,"list-group-item",2,"padding","0","font-size","inherit"],["aria-hidden","true",1,"fa","fa-times","ico-remove",2,"margin-left","10px",3,"click"],[2,"color","grey","font-style","italic"],["key","change.request.no.documents.label"],[2,"padding","10px 0"],["name","file","type","file","ng2FileSelect","","required","",1,"ghost-input",2,"display","inline-block","padding","0","height","auto","border-radius","0","margin-top","10px",3,"uploader"],["myFile",""],[1,"btn","btn-primary","pull-right",2,"margin","0",3,"title","click"],["key","change.request.reference.document.upload"],[1,"button-holder",2,"margin-bottom","20px","min-height","40px"],[4,"ngIf"],["type","submit","role","button",1,"btn","btn-primary",2,"margin","0",3,"disabled","title","click"],[3,"key"],["type","submit","class","btn btn-danger","style","margin:0 10px;","role","button",3,"disabled","title","click",4,"ngIf"],["type","submit","role","button",1,"btn","btn-danger",2,"margin","0 10px",3,"disabled","title","click"],["key","change.request.reject.all.btn"],["type","submit","class","btn btn-primary","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-default","role","button",3,"click",4,"ngIf"],["type","submit","role","button","class","btn btn-primary",3,"title","click",4,"ngIf"],["type","submit","role","button","class","btn btn-danger pull-right",3,"disabled","title","click",4,"ngIf"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","changeovertime.manageVersions.button.label"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit","role","button",1,"btn","btn-primary",3,"title","click"],["key","modal.button.update"],["type","submit","role","button",1,"btn","btn-danger","pull-right",3,"disabled","title","click"],["key","change.request.delete.request.btn"],[3,"pageChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),e.NdJ("click",function(){return t.filter("ALL")}),e._UZ(4,"localize",4),e.qZA(),e.TgZ(5,"a",5),e.NdJ("click",function(){return t.filter("PENDING")}),e._UZ(6,"localize",6),e.qZA(),e.TgZ(7,"a",5),e.NdJ("click",function(){return t.filter("ACCEPTED")}),e._UZ(8,"localize",7),e.qZA(),e.TgZ(9,"a",5),e.NdJ("click",function(){return t.filter("PARTIAL")}),e._UZ(10,"localize",8),e.qZA(),e.TgZ(11,"a",5),e.NdJ("click",function(){return t.filter("REJECTED")}),e._UZ(12,"localize",9),e.qZA()(),e._UZ(13,"hr",10),e.qZA()(),e.TgZ(14,"div",0)(15,"div",1)(16,"table",11)(17,"thead")(18,"tr",12)(19,"th",13)(20,"a",14),e.NdJ("click",function(){return t.onSort("createdBy")}),e._UZ(21,"localize",15),e.qZA(),e.YNc(22,n6,1,1,"i",16),e.qZA(),e.TgZ(23,"th",13)(24,"a",14),e.NdJ("click",function(){return t.onSort("geoObjectTypeLabel")}),e._UZ(25,"localize",17),e.qZA(),e.YNc(26,i6,1,1,"i",16),e.qZA(),e.TgZ(27,"th",13)(28,"a",14),e.NdJ("click",function(){return t.onSort("geoObjectLabel")}),e._UZ(29,"localize",18),e.qZA(),e.YNc(30,o6,1,1,"i",16),e.qZA(),e.TgZ(31,"th",13)(32,"a",14),e.NdJ("click",function(){return t.onSort("createDate")}),e._UZ(33,"localize",19),e.qZA(),e.YNc(34,r6,1,1,"i",16),e.qZA(),e.TgZ(35,"th",13)(36,"a",14),e.NdJ("click",function(){return t.onSort("approvalStatus")}),e._UZ(37,"localize",20),e.qZA(),e.YNc(38,a6,1,1,"i",16),e.qZA(),e.TgZ(39,"th",13)(40,"a",14),e.NdJ("click",function(){return t.onSort("oid")}),e._UZ(41,"localize",21),e.qZA(),e.YNc(42,s6,1,1,"i",16),e.qZA(),e._UZ(43,"th"),e.qZA()(),e.TgZ(44,"tbody"),e.YNc(45,Z6,27,16,"ng-template",22),e.ALo(46,"paginate"),e.qZA()(),e.TgZ(47,"div",23),e.YNc(48,N6,2,0,"div",24),e.qZA()()()),2&n&&(e.xp6(3),e.Q6J("ngClass","ALL"===t.filterCriteria?"cr-filter-link-active":""),e.xp6(2),e.Q6J("ngClass","PENDING"===t.filterCriteria?"cr-filter-link-active":""),e.xp6(2),e.Q6J("ngClass","ACCEPTED"===t.filterCriteria?"cr-filter-link-active":""),e.xp6(2),e.Q6J("ngClass","PARTIAL"===t.filterCriteria?"cr-filter-link-active":""),e.xp6(2),e.Q6J("ngClass","REJECTED"===t.filterCriteria?"cr-filter-link-active":""),e.xp6(11),e.Q6J("ngIf",t.isSorting("createdBy")),e.xp6(4),e.Q6J("ngIf",t.isSorting("geoObjectTypeLabel")),e.xp6(4),e.Q6J("ngIf",t.isSorting("geoObjectLabel")),e.xp6(4),e.Q6J("ngIf",t.isSorting("createDate")),e.xp6(4),e.Q6J("ngIf",t.isSorting("approvalStatus")),e.xp6(4),e.Q6J("ngIf",t.isSorting("oid")),e.xp6(3),e.Q6J("ngForOf",e.xi3(46,14,t.requests,e.kEZ(17,L6,t.page.pageSize,t.page.pageNumber,t.page.count)))("ngForTrackBy",t.requestTrackBy),e.xp6(3),e.Q6J("ngIf",t.page.resultSet.length>0))},dependencies:[T.mk,T.sg,T.O5,w.rH,y.Fj,y.JJ,y.On,I.C6,U.LS,Sn.l,Fr.u,Dp,U._s,ia.F],styles:[".vertical-center{position:relative;top:50%;transform:translateY(-50%)}.status-pending{color:orange}.status-accepted,.status-partial{color:#6ba542}.status-rejected{color:#d43f3a}.status-pending-container{border:solid 2px orange}.status-accepted-container,.status-partial-container{border:solid 2px #6BA542}.status-rejected-container{border:solid 2px #d43f3a}.cr-sort-arrow{font-size:14px}.cr-filter-link-active,.cr-filter-link-active:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active:hover,.cr-filter-link-active:focus{color:#fff}tr.row-active{background-color:#f7f7f7}.arrow{border:solid black;border-width:0 1px 1px 0;display:inline-block;padding:5px}.arrow-right{transform:rotate(-45deg);-webkit-transform:rotate(-45deg)}.arrow-down{transform:rotate(45deg);-webkit-transform:rotate(45deg)}.form-group textarea:focus{border-color:#edf4e8;box-shadow:inset 0 1px 1px #00000013,0 0 8px #6ba54299}textarea[readonly]:focus{box-shadow:none;border:1px solid #ccc;cursor:not-allowed}.geoobject-panel-header{width:100%;background:grey;color:#fff;padding:10px}\n"],encapsulation:2,data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("300ms")]),(0,Y.eR)(":leave",(0,Y.jt)("100ms",(0,Y.oB)({opacity:0})))]),(0,Y.X$)("fadeIn",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")])])]]}});class Nd{constructor(n,t,o,a){this.localizationService=n,this.modalService=t,this.service=o,this.route=a,this.isAdmin=o.isAdmin(),this.isMaintainer=this.isAdmin||o.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||o.isContributer(),this.isContributorOnly=o.isContributerOnly()}ngOnInit(){this.urlSubscriber=this.route.params.subscribe(n=>{this.highlightOid=n.oid})}ngOnDestroy(){this.urlSubscriber.unsubscribe()}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}function D6(i,n){if(1&i&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function R6(i,n){1&i&&e._UZ(0,"localize",37)}function F6(i,n){1&i&&e._UZ(0,"localize",38)}function U6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw();return e.KtG(l.onCancelScheduledJob(a.historyId,a))}),e._UZ(1,"localize",40),e.qZA()}}function q6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw();return e.KtG(l.onResolveScheduledJob(a.historyId,a))}),e._UZ(1,"localize",42),e.qZA()}}function J6(i,n){if(1&i&&(e.TgZ(0,"td",29)(1,"div",30)(2,"a",31)(3,"button",32),e.YNc(4,R6,1,0,"localize",33),e.YNc(5,F6,1,0,"localize",34),e.qZA()(),e.YNc(6,U6,2,0,"button",35),e.YNc(7,q6,2,0,"button",36),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("routerLink","/registry/job/"+t.historyId),e.xp6(2),e.Q6J("ngIf","IMPORT_RESOLVE"===t.stage||"VALIDATION_RESOLVE"===t.stage),e.xp6(1),e.Q6J("ngIf","IMPORT_RESOLVE"!=t.stage&&"VALIDATION_RESOLVE"!=t.stage),e.xp6(1),e.Q6J("ngIf","VALIDATION_RESOLVE"===t.stage),e.xp6(1),e.Q6J("ngIf","IMPORT_RESOLVE"===t.stage)}}function j6(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",11)(2,"div",21),e._UZ(3,"i",22),e.TgZ(4,"p",23)(5,"span",24),e._uU(6),e.qZA(),e.TgZ(7,"span",24)(8,"span",25),e._UZ(9,"date-text",26),e.qZA()(),e.TgZ(10,"span",24),e._uU(11),e.qZA()(),e._UZ(12,"step-indicator",27),e.qZA()(),e.YNc(13,J6,8,5,"td",28),e.qZA()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(6),e.hij(" ",t.fileName," "),e.xp6(3),e.Q6J("date",t.createDate),e.xp6(2),e.hij(" ",o.formatJobStatus(t)," "),e.xp6(1),e.Q6J("steps",t.stepConfig),e.xp6(1),e.Q6J("ngIf",o.isAdmin||o.isMaintainer)}}function B6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",43)(1,"pagination-controls",44),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onActiveJobsPageChange(a))}),e.qZA()()}}function G6(i,n){1&i&&(e.TgZ(0,"th",45),e._UZ(1,"localize",46),e.qZA())}function V6(i,n){1&i&&(e.TgZ(0,"th",45),e._UZ(1,"localize",47),e.qZA())}function Y6(i,n){1&i&&(e.TgZ(0,"th",45),e._UZ(1,"localize",48),e.qZA())}function H6(i,n){1&i&&(e.TgZ(0,"th",45),e._UZ(1,"localize",49),e.qZA())}function Q6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"th",50)(1,"button",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onViewAllCompleteJobs())}),e._UZ(2,"localize",52),e.qZA()()}}function K6(i,n){1&i&&e._UZ(0,"th",53)}function $6(i,n){1&i&&e._UZ(0,"td",60)}function W6(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",54)(2,"div",21),e._UZ(3,"i",55),e.TgZ(4,"p",56),e._uU(5),e.qZA()()(),e.TgZ(6,"td",57)(7,"p",58),e._uU(8),e.qZA()(),e.TgZ(9,"td",57)(10,"p",58),e._uU(11),e.qZA()(),e.TgZ(12,"td",57)(13,"span",25),e._UZ(14,"date-text",26),e.qZA()(),e.TgZ(15,"td",57)(16,"span",25),e._UZ(17,"date-text",26),e.qZA()(),e.YNc(18,$6,1,0,"td",59),e.qZA()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(5),e.Oqu(t.fileName),e.xp6(3),e.Oqu(o.formatJobStatus(t)),e.xp6(3),e.Oqu(t.importedRecords),e.xp6(3),e.Q6J("date",t.createDate),e.xp6(3),e.Q6J("date",t.lastUpdateDate),e.xp6(1),e.Q6J("ngIf",o.isAdmin||o.isMaintainer)}}function X6(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",43)(1,"pagination-controls",61),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onCompleteJobsPageChange(a))}),e.qZA()()}}Nd.\u0275fac=function(n){return new(n||Nd)(e.Y36(nn.oQ),e.Y36(Ln.tT),e.Y36(nn.e8),e.Y36(w.gz))},Nd.\u0275cmp=e.Xpm({type:Nd,selectors:[["change-request-page"]],decls:13,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid",2,"height","100%"],[1,"row"],[1,"col-md-12"],[1,"heading"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[3,"toggleId"],[4,"ngIf"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div")(7,"div",4)(8,"h2"),e._uU(9),e.qZA()(),e.TgZ(10,"div",5),e._UZ(11,"request-table",6),e.YNc(12,z6,1,0,"submit-change-request",7),e.qZA()()()()()()),2&n&&(e.xp6(9),e.Oqu(t.pageTitle),e.xp6(2),e.Q6J("toggleId",t.highlightOid),e.xp6(1),e.Q6J("ngIf",t.isContributorOnly))},dependencies:[T.O5,Da.N,ba.C,tf,Pd],styles:["a.active[_ngcontent-%COMP%]{border-bottom:solid 2px #6BA542}"]});const e3=function(i,n,t){return{id:"activeJobs",itemsPerPage:i,currentPage:n,totalItems:t}},t3=function(i,n,t){return{id:"completeJobs",itemsPerPage:i,currentPage:n,totalItems:t}};class nf{constructor(n,t,o,a,l,_){this.service=n,this.modalService=t,this.router=o,this.localizeService=a,this.ioService=l,this.message=null,this.activeJobsPage={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.completeJobsPage={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.activeTimeCounter=0,this.completeTimeCounter=0,this.isViewAllOpen=!1,this.isAdmin=_.isAdmin(),this.isMaintainer=this.isAdmin||_.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||_.isContributer()}ngOnInit(){this.onActiveJobsPageChange(1),this.pollingData=Di(1e3).subscribe(()=>{this.activeTimeCounter++,this.completeTimeCounter++,this.isViewAllOpen?(this.activeTimeCounter>=4&&(this.onActiveJobsPageChange(this.activeJobsPage.pageNumber),this.activeTimeCounter=0),this.completeTimeCounter>=7&&(this.onCompleteJobsPageChange(this.completeJobsPage.pageNumber),this.completeTimeCounter=0)):this.activeTimeCounter>=2&&(this.onActiveJobsPageChange(this.activeJobsPage.pageNumber),this.activeTimeCounter=0)})}ngOnDestroy(){this.pollingData.unsubscribe()}formatJobStatus(n){return this.localizeService.decode("FEEDBACK"===n.status?"etl.JobStatus.FEEDBACK":"RUNNING"===n.status||"NEW"===n.status?"etl.JobStatus.RUNNING":"QUEUED"===n.status?"etl.JobStatus.QUEUED":"SUCCESS"===n.status?"etl.JobStatus.SUCCESS":"CANCELED"===n.status?"etl.JobStatus.CANCELED":"FAILURE"===n.status?"etl.JobStatus.FAILURE":"etl.JobStatus.RUNNING")}formatStepConfig(n){n.resultSet.forEach(t=>{let o={steps:[{label:this.localizeService.decode("scheduler.step.fileImport"),status:"COMPLETE"},{label:this.localizeService.decode("scheduler.step.staging"),status:"NEW"===t.stage?this.getJobStatus(t):this.getCompletedStatus(t.stage,"NEW")},{label:this.localizeService.decode("scheduler.step.validation"),status:"VALIDATE"===t.stage||"VALIDATION_RESOLVE"===t.stage?this.getJobStatus(t):this.getCompletedStatus(t.stage,"VALIDATE")},{label:this.localizeService.decode("scheduler.step.databaseImport"),status:"IMPORT"===t.stage||"IMPORT_RESOLVE"===t.stage||"RESUME_IMPORT"===t.stage?this.getJobStatus(t):""}]};t.stepConfig=o})}getCompletedStatus(n,t){let o=["NEW","VALIDATE","VALIDATION_RESOLVE","IMPORT","IMPORT_RESOLVE","RESUME_IMPORT"],a=o.indexOf(n);return o.indexOf(t)<a?"COMPLETE":""}getJobStatus(n){return"QUEUED"===n.status||"RUNNING"===n.status?"WORKING":"FEEDBACK"===n.status?"STUCK":""}onViewAllCompleteJobs(){this.onCompleteJobsPageChange(1),this.isViewAllOpen=!0}onView(n){this.router.navigate(["/registry/master-list-history/",n])}onActiveJobsPageChange(n){this.message=null,this.service.getScheduledJobs(this.activeJobsPage.pageSize,n,"createDate",!1).then(t=>{this.activeJobsPage=t,this.formatStepConfig(this.activeJobsPage)}).catch(t=>{this.error(t)})}onCompleteJobsPageChange(n){this.message=null,this.service.getCompletedScheduledJobs(this.completeJobsPage.pageSize,n,"createDate",!1).then(t=>{this.completeJobsPage=t,this.formatStepConfig(this.completeJobsPage)}).catch(t=>{this.error(t)})}onCancelScheduledJob(n,t){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("etl.import.cancel.modal.description"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.cancel.modal.button"),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(o=>{this.ioService.cancelImport(t.configuration).then(a=>{this.bsModalRef.hide();for(let l=0;l<this.activeJobsPage.resultSet.length;++l)if(this.activeJobsPage.resultSet[l].jobId===t.jobId){this.activeJobsPage.resultSet.splice(l,1);break}this.onViewAllCompleteJobs()}).catch(a=>{this.error(a)})})}onResolveScheduledJob(n,t){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("etl.import.resume.modal.importDescription"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.resume.modal.importButton"),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(o=>{this.service.resolveScheduledJob(n).then(a=>{this.bsModalRef.hide();for(let l=0;l<this.activeJobsPage.resultSet.length;++l)if(this.activeJobsPage.resultSet[l].jobId===t.jobId){this.activeJobsPage.resultSet.splice(l,1);break}this.onViewAllCompleteJobs()}).catch(a=>{this.error(a)})})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function n3(i,n){if(1&i&&(e.TgZ(0,"div",31),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function i3(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",32)(2,"div",33),e._UZ(3,"i",34),e.TgZ(4,"p",35)(5,"span",36)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"span",36),e._UZ(9,"localize",37),e._uU(10),e.qZA(),e.TgZ(11,"span",36),e._UZ(12,"localize",38),e._uU(13,": "),e.TgZ(14,"span",39),e._UZ(15,"date-text",40),e.qZA()()()()(),e._UZ(16,"div",32),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Oqu(t.job.fileName),e.xp6(3),e.hij(": ",t.job.author," "),e.xp6(5),e.Q6J("date",t.job.createDate)}}function o3(i,n){1&i&&(e.TgZ(0,"div",18)(1,"label")(2,"span",19),e._UZ(3,"localize",41),e.qZA()()())}function r3(i,n){if(1&i&&(e.TgZ(0,"ol")(1,"li"),e._uU(2),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.AsE("",t.label," (",t.type,")")}}function a3(i,n){if(1&i&&(e.TgZ(0,"div",42),e.YNc(1,r3,3,2,"ol",43),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.problem.context)}}nf.\u0275fac=function(n){return new(n||nf)(e.Y36(Zi),e.Y36(Ln.tT),e.Y36(w.F0),e.Y36(nn.oQ),e.Y36(pr),e.Y36(nn.e8))},nf.\u0275cmp=e.Xpm({type:nf,selectors:[["scheduled-jobs"]],decls:37,vars:25,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","scheduledjobs.title"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"solid-table-wrapper"],[1,"table","table-striped"],[2,"height","56px"],[2,"vertical-align","middle"],["key","scheduledjobs.jobs.table.header"],[4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],[2,"width","40%","border-bottom","none"],["key","scheduledjobs.completedjobs.table.header",2,"line-height","40px"],["style","width:15%;border-bottom: none;",4,"ngIf"],["style","border-bottom: none; width:15%",4,"ngIf"],["style","border-bottom: none; width:0%",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","40px"],[2,"padding-left","60px"],[2,"display","block"],[1,"date-string-display"],[3,"date"],[3,"steps"],["style","text-align: right;vertical-align: middle;",4,"ngIf"],[2,"text-align","right","vertical-align","middle"],[1,"button-holder",2,"float","right"],["routerLinkActive","active",3,"routerLink"],["role","button",1,"btn","btn-primary"],["key","scheduledjobs.fix.problems.button",4,"ngIf"],["key","scheduledjobs.detail.button",4,"ngIf"],["type","button","class","btn btn-danger","role","button",3,"click",4,"ngIf"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],["key","scheduledjobs.fix.problems.button"],["key","scheduledjobs.detail.button"],["type","button","role","button",1,"btn","btn-danger",3,"click"],["key","etl.import.cancel.openModal"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","scheduledjobs.complete.import.button"],[1,"solid-table-footer"],["id","activeJobs",3,"pageChange"],[2,"width","15%","border-bottom","none"],["key","scheduledjobs.status",2,"line-height","40px"],["key","scheduledjobs.importedRecords",2,"line-height","40px"],["key","scheduledjobs.importStartDate",2,"line-height","40px"],["key","scheduledjobs.importEndDate",2,"line-height","40px"],[2,"border-bottom","none","width","15%"],["type","submit","role","button",1,"btn","btn-default","pull-right",3,"click"],["key","scheduledjobs.view.completed.jobs.button"],[2,"border-bottom","none","width","0%"],[2,"width","40%","vertical-align","middle"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute"],[2,"padding-left","30px","margin","0"],[2,"width","15%","vertical-align","middle"],[2,"padding-left","0px","margin","0"],["style","width:15%;text-align: right;vertical-align: middle;",4,"ngIf"],[2,"width","15%","text-align","right","vertical-align","middle"],["id","completeJobs",3,"pageChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,D6,2,1,"div",2),e.TgZ(5,"div",3)(6,"h2"),e._UZ(7,"localize",4),e.qZA()(),e.TgZ(8,"div",5)(9,"div",6)(10,"ul",7)(11,"div",8)(12,"table",9)(13,"thead")(14,"tr",10)(15,"th",11),e._UZ(16,"localize",12),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,j6,14,5,"tr",13),e.ALo(19,"paginate"),e.qZA()(),e.YNc(20,B6,2,0,"div",14),e.qZA(),e.TgZ(21,"div",8)(22,"table",9)(23,"thead")(24,"tr")(25,"th",15),e._UZ(26,"localize",16),e.qZA(),e.YNc(27,G6,2,0,"th",17),e.YNc(28,V6,2,0,"th",17),e.YNc(29,Y6,2,0,"th",17),e.YNc(30,H6,2,0,"th",17),e.YNc(31,Q6,3,0,"th",18),e.YNc(32,K6,1,0,"th",19),e.qZA()(),e.TgZ(33,"tbody"),e.YNc(34,W6,19,6,"tr",13),e.ALo(35,"paginate"),e.qZA()(),e.YNc(36,X6,2,0,"div",14),e.qZA()()()()()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(14),e.Q6J("ngForOf",e.xi3(19,11,t.activeJobsPage.resultSet,e.kEZ(17,e3,t.activeJobsPage.pageSize,t.activeJobsPage.pageNumber,t.activeJobsPage.count))),e.xp6(2),e.Q6J("ngIf",t.activeJobsPage.resultSet.length>0),e.xp6(7),e.Q6J("ngIf",t.completeJobsPage.resultSet.length>0),e.xp6(1),e.Q6J("ngIf",t.completeJobsPage.resultSet.length>0),e.xp6(1),e.Q6J("ngIf",t.completeJobsPage.resultSet.length>0),e.xp6(1),e.Q6J("ngIf",t.completeJobsPage.resultSet.length>0),e.xp6(1),e.Q6J("ngIf",t.completeJobsPage.resultSet.length<1),e.xp6(1),e.Q6J("ngIf",t.completeJobsPage.resultSet.length>0),e.xp6(2),e.Q6J("ngForOf",e.xi3(35,14,t.completeJobsPage.resultSet,e.kEZ(21,t3,t.completeJobsPage.pageSize,t.completeJobsPage.pageNumber,t.completeJobsPage.count))),e.xp6(2),e.Q6J("ngIf",t.completeJobsPage.resultSet.length>0))},dependencies:[T.sg,T.O5,w.rH,w.Od,U.LS,Sn.l,Da.N,ba.C,Fr.u,Rp,U._s],styles:[".solid-table-wrapper[_ngcontent-%COMP%]{background:#F4F4F4;border-radius:15px;margin-bottom:20px}.solid-table-footer[_ngcontent-%COMP%]{border-radius:0 0 15px 15px;padding:0 0 10px 10px}.wrapper[_ngcontent-%COMP%]{padding:10px}"]});class of{constructor(n,t,o,a,l,_){this.service=n,this.iService=t,this.dateService=o,this.lService=a,this.bsModalRef=l,this.modalService=_,this.message=null,this.onProblemResolved=new e.vpe,this.readonly=!1,this.edit=!1}ngOnInit(){this.problem.parent=null,this.searchLabel=""}getString(n){return JSON.stringify(n)}getValidationProblemDisplayLabel(n){return n.type}getTypeAheadObservable(n,t){let a=this.job.configuration.hierarchy;return new Ni.y(l=>{this.service.getGeoObjectSuggestions(this.searchLabel,n,null,null,a,this.job.startDate,this.job.endDate).then(_=>{l.next(_)})})}typeaheadOnSelect(n,t){this.service.getParentGeoObjects(n.item.code,t.typeCode,[],!1,this.job.startDate).then(o=>{t.parent=o.geoObject,this.searchLabel=o.geoObject.properties.displayLabel.localizedValue}).catch(o=>{this.error(o)})}onIgnore(){this.service.submitValidationResolve({resolution:"IGNORE",validationProblemId:this.problem.id}).then(t=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()}).catch(t=>{this.error(t)})}onCreateSynonym(){this.service.submitValidationResolve({validationProblemId:this.problem.id,resolution:"SYNONYM",code:this.problem.parent.properties.code,typeCode:this.problem.parent.properties.type,label:this.problem.label}).then(t=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()}).catch(t=>{this.error(t)})}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function s3(i,n){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function l3(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",7)(2,"div",8),e._UZ(3,"i",9),e.TgZ(4,"p",10)(5,"span",11)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"span",11),e._UZ(9,"localize",12),e._uU(10),e.qZA(),e.TgZ(11,"span",11),e._UZ(12,"localize",13),e._uU(13,": "),e.TgZ(14,"span",14),e._UZ(15,"date-text",15),e.qZA()()()()(),e._UZ(16,"div",7),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Oqu(t.job.fileName),e.xp6(3),e.hij(": ",t.job.author," "),e.xp6(5),e.Q6J("date",t.job.createDate)}}function c3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",17)(2,"h4")(3,"strong"),e._UZ(4,"localize",18),e.qZA()(),e.TgZ(5,"p",19),e._uU(6),e.qZA(),e.TgZ(7,"h4")(8,"strong"),e._UZ(9,"localize",20),e.qZA()(),e.TgZ(10,"p",19),e._UZ(11,"localize",21),e.qZA(),e.TgZ(12,"h4")(13,"strong"),e._UZ(14,"localize",22),e.qZA()(),e.TgZ(15,"p"),e._UZ(16,"localize",23),e.qZA()(),e.TgZ(17,"div",24)(18,"div",25)(19,"div",26)(20,"label")(21,"span",27),e._UZ(22,"localize",28),e.qZA()()(),e.TgZ(23,"div",29)(24,"span",30),e._uU(25),e.qZA()()(),e.TgZ(26,"div",25)(27,"div",26)(28,"label")(29,"span",27),e._UZ(30,"localize",31),e.qZA()()(),e.TgZ(31,"div",29)(32,"span",30),e._uU(33),e.qZA()()(),e.TgZ(34,"div",32)(35,"div",26)(36,"label")(37,"span",27),e._UZ(38,"localize",33),e.qZA()()(),e.TgZ(39,"div",29)(40,"input",34),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.searchLabel=a)})("typeaheadOnSelect",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.typeaheadOnSelect(a))}),e.qZA()()(),e.TgZ(41,"div",25)(42,"div",26)(43,"label")(44,"span",27),e._UZ(45,"localize",35),e.qZA()()(),e.TgZ(46,"div",29)(47,"button",36),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCreateSynonym())}),e._UZ(48,"localize",37),e.qZA(),e.TgZ(49,"button",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onIgnore())}),e._UZ(50,"localize",39),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Oqu(t.getValidationProblemDisplayLabel(t.problem)),e.xp6(19),e.Oqu(t.problem.attributeLabel),e.xp6(8),e.Oqu(t.problem.label),e.xp6(7),e.Q6J("ngModel",t.searchLabel)("typeaheadAsync",!0)("typeahead",t.getTypeAheadObservable(t.problem))("typeaheadOptionsLimit",7)("typeaheadMinLength",0)("typeaheadWaitMs",300),e.xp6(7),e.Q6J("disabled",null==t.termId)}}of.\u0275fac=function(n){return new(n||of)(e.Y36(Zi),e.Y36(pr),e.Y36(zs.R),e.Y36(mo.o),e.Y36(Ln.UZ),e.Y36(Ln.tT))},of.\u0275cmp=e.Xpm({type:of,selectors:[["parent-reference-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:52,vars:13,consts:[[1,"container"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],[1,"row",2,"display","flex","display","-webkit-flex","flex-wrap","wrap"],[1,"col-md-6",2,"background","white","border-radius","10px","border-right","#F4F4F4 2px solid"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],["key","etl.parentProblem.message"],["key","etl.problem.header.toResolve"],["key","etl.parentProblem.toResolve"],[1,"col-md-6",2,"background","white","border-radius","10px","border-left","#F4F4F4 2px solid"],[1,"row-holder"],["class","label-holder","style","width:100px;",4,"ngIf"],[1,"holder",2,"width","300px"],["style","margin-top:10px;",4,"ngIf"],[1,"label-holder",2,"width","100px"],[1,"text"],["key","etl.problem.parent.label"],[1,"holder",2,"width","300px","padding-top","9px"],[1,"text",2,"margin-top","10px"],[1,"row-holder",2,"overflow","visible"],["key","etl.problem.parent.synonym"],["type","text","autocomplete","off","name","parentSearch","typeaheadOptionField","name",1,"form-control",2,"width","150px",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadWaitMs","ngModelChange","typeaheadOnSelect"],["key","etl.problem.parent.actions"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","etl.problem.reference.createSynonym"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","etl.problem.reference.ignore"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display"],[3,"date"],["key","etl.problem.parent.context"],[2,"margin-top","10px"],[4,"ngFor","ngForOf"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,n3,2,1,"div",1),e.YNc(2,i3,17,3,"div",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h4")(8,"strong"),e._UZ(9,"localize",7),e.qZA()(),e.TgZ(10,"p",8),e._uU(11),e.qZA(),e.TgZ(12,"h4")(13,"strong"),e._UZ(14,"localize",9),e.qZA()(),e.TgZ(15,"p",8),e._UZ(16,"localize",10),e.qZA(),e.TgZ(17,"h4")(18,"strong"),e._UZ(19,"localize",11),e.qZA()(),e.TgZ(20,"p"),e._UZ(21,"localize",12),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14),e.YNc(24,o3,4,0,"div",15),e.TgZ(25,"div",16),e.YNc(26,a3,2,1,"div",17),e.qZA()(),e.TgZ(27,"div",14)(28,"div",18)(29,"label")(30,"span",19),e._UZ(31,"localize",20),e.qZA()()(),e.TgZ(32,"div",21)(33,"span",22),e._uU(34),e.qZA()()(),e.TgZ(35,"div",23)(36,"div",18)(37,"label")(38,"span",19),e._UZ(39,"localize",24),e.qZA()()(),e.TgZ(40,"div",16)(41,"input",25),e.NdJ("ngModelChange",function(a){return t.searchLabel=a})("typeaheadOnSelect",function(a){return t.typeaheadOnSelect(a,t.problem)}),e.qZA()()(),e.TgZ(42,"div",14)(43,"div",18)(44,"label")(45,"span",19),e._UZ(46,"localize",26),e.qZA()()(),e.TgZ(47,"div",16)(48,"button",27),e.NdJ("click",function(){return t.onCreateSynonym()}),e._UZ(49,"localize",28),e.qZA(),e.TgZ(50,"button",29),e.NdJ("click",function(){return t.onIgnore()}),e._UZ(51,"localize",30),e.qZA()()()()()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",t.problem&&t.job),e.xp6(9),e.Oqu(t.getValidationProblemDisplayLabel(t.problem)),e.xp6(13),e.Q6J("ngIf",t.problem.context.length>0),e.xp6(2),e.Q6J("ngIf",t.problem.context.length>0),e.xp6(8),e.Oqu(t.problem.label),e.xp6(7),e.Q6J("ngModel",t.searchLabel)("typeaheadAsync",!0)("typeahead",t.getTypeAheadObservable(t.problem.typeCode,t.problem))("typeaheadOptionsLimit",7)("typeaheadMinLength",0)("typeaheadWaitMs",300),e.xp6(7),e.Q6J("disabled",null==t.problem.parent))},dependencies:[T.sg,T.O5,y.Fj,y.JJ,y.On,A.Bp,Sn.l,Fr.u],encapsulation:2});class rf{constructor(n,t,o,a,l,_){this.service=n,this.iService=t,this.dateService=o,this.lService=a,this.bsModalRef=l,this.modalService=_,this.message=null,this.onProblemResolved=new e.vpe,this.termId=null,this.readonly=!1,this.edit=!1}ngOnInit(){this.problem.parent=null,this.searchLabel=""}getValidationProblemDisplayLabel(n){return n.type}getTypeAheadObservable(n){return Ni.y.create(t=>{this.iService.getTermSuggestions(n.mdAttributeId,this.searchLabel,"20").then(o=>{t.next(o)})})}typeaheadOnSelect(n){this.termId=n.item.value}onIgnore(){this.service.submitValidationResolve({resolution:"IGNORE",validationProblemId:this.problem.id}).then(t=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()}).catch(t=>{this.error(t)})}onCreateSynonym(){this.service.submitValidationResolve({validationProblemId:this.problem.id,resolution:"SYNONYM",classifierId:this.termId,label:this.problem.label}).then(t=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()}).catch(t=>{this.error(t)})}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function u3(i,n){if(1&i&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function p3(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",21)(2,"div",22),e._UZ(3,"i",23),e.TgZ(4,"p",24)(5,"span",25)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"span",25),e._UZ(9,"localize",26),e._uU(10),e.qZA(),e.TgZ(11,"span",25),e._UZ(12,"localize",27),e._uU(13,": "),e.TgZ(14,"span",28),e._UZ(15,"date-text",29),e.qZA()()()()(),e._UZ(16,"div",21),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Oqu(t.job.fileName),e.xp6(3),e.hij(": ",t.job.author," "),e.xp6(5),e.Q6J("date",t.job.createDate)}}rf.\u0275fac=function(n){return new(n||rf)(e.Y36(Zi),e.Y36(pr),e.Y36(zs.R),e.Y36(mo.o),e.Y36(Ln.UZ),e.Y36(Ln.tT))},rf.\u0275cmp=e.Xpm({type:rf,selectors:[["term-reference-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:6,vars:3,consts:[[1,"container"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display",2,"margin-left","5px"],[3,"date"],[1,"row"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","margin-right","7px"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],["key","etl.problem.termReference.message"],["key","etl.problem.header.toResolve"],["key","etl.problem.termReference.toResolve"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","float","left","height","250px"],[1,"row-holder"],[1,"label-holder",2,"width","100px"],[1,"text"],["key","etl.problem.termReference.attributeLabel"],[1,"holder",2,"width","300px"],[1,"text",2,"margin-top","10px"],["key","etl.problem.termReference.label"],[1,"row-holder",2,"overflow","visible"],["key","etl.problem.termReference.synonym"],["type","text","autocomplete","off","name","termSearch","typeaheadOptionField","label",1,"form-control",2,"width","150px",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadWaitMs","ngModelChange","typeaheadOnSelect"],["key","etl.problem.termReference.actions"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","etl.problem.reference.createSynonym"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","etl.problem.reference.ignore"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,s3,2,1,"div",1),e.YNc(2,l3,17,3,"div",2),e.TgZ(3,"div",3)(4,"div",4),e.YNc(5,c3,51,10,"div",5),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",t.problem&&t.job),e.xp6(3),e.Q6J("ngIf",t.problem))},dependencies:[T.O5,y.Fj,y.JJ,y.On,A.Bp,Sn.l,Fr.u],encapsulation:2});class af{constructor(n,t,o,a,l){this.service=n,this.iService=t,this.dateService=o,this.lService=a,this.bsModalRef=l,this.message=null,this.onProblemResolved=new e.vpe,this.readonly=!1,this.edit=!1}ngOnInit(){this.problem.parent=null,this.searchLabel=""}getString(n){return JSON.stringify(n)}getValidationProblemDisplayLabel(n){return n.type}getTypeAheadObservable(n,t){let a=this.job.configuration.hierarchy;return new Ni.y(l=>{this.service.getGeoObjectSuggestions(this.searchLabel,n,null,null,a,this.job.startDate,this.job.endDate).then(_=>{l.next(_)})})}typeaheadOnSelect(n,t){this.service.getParentGeoObjects(n.item.code,t.typeCode,[],!1,this.job.startDate).then(o=>{t.parent=o.geoObject,this.searchLabel=o.geoObject.properties.displayLabel.localizedValue}).catch(o=>{this.error(o)})}onIgnore(){this.service.submitValidationResolve({resolution:"IGNORE",validationProblemId:this.problem.id}).then(t=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()}).catch(t=>{this.error(t)})}formatAffectedRows(n){return n.replace(/,/g,", ")}onCreateSynonym(){this.service.submitValidationResolve({validationProblemId:this.problem.id,resolution:"SYNONYM",code:this.problem.parent.properties.code,typeCode:this.problem.parent.properties.type,label:this.problem.label}).then(t=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()}).catch(t=>{this.error(t)})}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}af.\u0275fac=function(n){return new(n||af)(e.Y36(Zi),e.Y36(pr),e.Y36(zs.R),e.Y36(mo.o),e.Y36(Ln.UZ))},af.\u0275cmp=e.Xpm({type:af,selectors:[["row-validation-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:39,vars:5,consts:[[1,"container"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],[1,"row"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","margin-right","7px"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],["key","etl.problem.rowValidation.message"],["key","etl.problem.header.toResolve"],["key","etl.problem.rowValidation.toResolve"],[1,"col-md-6",2,"background","white","border-radius","10px","width","41%","float","left","height","250px"],[1,"row-holder"],[1,"label-holder",2,"width","100px"],[1,"text"],["key","scheduledjobs.validation.table.affected.rows.header"],[1,"holder",2,"width","300px"],[1,"text",2,"margin-top","10px"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display",2,"margin-left","5px"],[3,"date"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,u3,2,1,"div",1),e.YNc(2,p3,17,3,"div",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h4")(8,"strong"),e._UZ(9,"localize",7),e.qZA()(),e.TgZ(10,"p",8),e._uU(11),e.qZA(),e.TgZ(12,"h4")(13,"strong"),e._UZ(14,"localize",9),e.qZA()(),e.TgZ(15,"p",8),e._UZ(16,"localize",10),e.qZA(),e.TgZ(17,"h4")(18,"strong"),e._UZ(19,"localize",11),e.qZA()(),e.TgZ(20,"p"),e._UZ(21,"localize",12),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14)(24,"div",15)(25,"label")(26,"span",16),e._UZ(27,"localize",17),e.qZA()()(),e.TgZ(28,"div",18)(29,"span",19),e._uU(30),e.qZA()()(),e.TgZ(31,"div",14)(32,"div",15)(33,"label")(34,"span",16),e._UZ(35,"localize",10),e.qZA()()(),e.TgZ(36,"div",18)(37,"span",19),e._uU(38),e.qZA()()()()()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",t.problem&&t.job),e.xp6(9),e.Oqu(t.getValidationProblemDisplayLabel(t.problem)),e.xp6(19),e.Oqu(t.formatAffectedRows(t.problem.affectedRows)),e.xp6(8),e.Oqu(t.problem.exception.message))},dependencies:[T.O5,Sn.l,Fr.u],encapsulation:2});const h3=["attributeEditor"];function f3(i,n){if(1&i&&e._UZ(0,"geoobject-shared-attribute-editor",10,11),2&i){const t=e.oxw();e.Q6J("geoObjectType",t.geoObjectType)("postGeoObject",t.geoObject)("isNew",t.isNewGeoObject)("isGeometryInlined",!0)("hierarchies",t.hierarchies)("readOnly",!1)}}class Ld{constructor(n,t,o,a,l){this.modalService=n,this.bsModalRef=t,this.registryService=o,this.localizeService=a,this.tabIndex=0,this.isNewGeoObject=!1,this.submitFunction=null,this.isAdmin=l.isAdmin(),this.isMaintainer=this.isAdmin||l.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||l.isContributer()}ngOnInit(){}findVotWithStartDate(n,t){for(let o=0;o<n.length;++o)if(n[o].startDate===t)return n[o];return null}setMasterListId(n){this.masterListId=n}setOnSuccessCallback(n){this.onSuccessCallback=n}configureAsNew(n,t,o){this.isNewGeoObject=!0,this.isGeometryEditable=o,this.fetchGeoObjectType(n),this.fetchLocales(),this.registryService.newGeoObjectOverTime(n).then(a=>{this.geoObject=new kp(this.geoObjectType,a.geoObject.attributes),this.hierarchies=a.hierarchies})}configureFromImportError(n,t,o,a){let l=n.object.geoObject.attributes.type;this.isNewGeoObject=n.object.isNew,this.isGeometryEditable=a,this.fetchGeoObjectType(l),this.fetchLocales(),null!=n.object&&null!=n.object.parents&&n.object.parents.length>0?this.hierarchies=n.object.parents:this.registryService.newGeoObjectOverTime(l).then(_=>{this.hierarchies=_.hierarchies}),this.geoObject=new kp(this.geoObjectType,n.object.geoObject.attributes),this.submitFunction=(_,C,N)=>{this.registryService.submitErrorResolve({historyId:t,importErrorId:n.id,resolution:"APPLY_GEO_OBJECT",parentTreeNode:C,geoObject:_,isNew:n.object.isNew}).then(()=>{null!=this.onSuccessCallback&&this.onSuccessCallback()}).catch(V=>{this.error(V)})}}configureAsExisting(n,t,o,a){this.isNewGeoObject=!1,this.isGeometryEditable=a,this.fetchGeoObject(n,t),this.fetchGeoObjectType(t),this.fetchHierarchies(n,t),this.fetchLocales()}fetchGeoObject(n,t){this.registryService.getGeoObjectOverTime(n,t).then(o=>{this.geoObject=new kp(this.geoObjectType,JSON.parse(JSON.stringify(o)).attributes)}).catch(o=>{this.error(o)})}fetchLocales(){this.registryService.getLocales().then(n=>{this.localizeService.setLocales(n)}).catch(n=>{this.error(n)})}fetchGeoObjectType(n){this.registryService.getGeoObjectTypes([n]).then(t=>{this.geoObjectType=t[0],null!=this.geoObject&&(this.geoObject.geoObjectType=this.geoObjectType)}).catch(t=>{console.log(t)})}fetchHierarchies(n,t){this.registryService.getHierarchiesForGeoObject(n,t).then(o=>{this.hierarchies=o}).catch(o=>{this.error(o)})}getTypeAheadObservable(n,t){return Ni.y.create(o=>{this.registryService.getGeoObjectSuggestionsTypeAhead(n,t).then(a=>{o.next(a)})})}typeaheadOnSelect(n,t){this.registryService.getGeoObjectByCode(n.item.code,t.geoObject.properties.type).then(o=>{t.geoObject=o}).catch(o=>{this.error(o)})}canSubmit(){return this.attributeEditor&&this.attributeEditor.isValid()&&(this.isNewGeoObject||this.attributeEditor&&this.attributeEditor.getChangeRequestEditor().hasChanges())}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}cancel(){this.bsModalRef.hide()}submit(){this.bsModalRef.hide(),null==this.submitFunction||this.submitFunction(this.geoObject,this.hierarchies,this.attributeEditor)}}function g3(i,n){if(1&i&&(e.TgZ(0,"div",13),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function _3(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",14)(2,"div",15),e._UZ(3,"i",16),e.TgZ(4,"p",17)(5,"span",18)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"span",18),e._UZ(9,"localize",19),e._uU(10),e.qZA(),e.TgZ(11,"span",18),e._UZ(12,"localize",20),e._uU(13,": "),e.TgZ(14,"span",21),e._UZ(15,"date-text",22),e.qZA()()()()(),e._UZ(16,"div",14),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Oqu(t.job.fileName),e.xp6(3),e.hij(": ",t.job.author," "),e.xp6(5),e.Q6J("date",t.job.createDate)}}function m3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",23)(1,"button",24),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onEditGeoObject())}),e._UZ(2,"localize",25),e.qZA()()}}Ld.\u0275fac=function(n){return new(n||Ld)(e.Y36(Ln.tT),e.Y36(Ln.UZ),e.Y36(Zi),e.Y36(nn.oQ),e.Y36(nn.e8))},Ld.\u0275cmp=e.Xpm({type:Ld,selectors:[["geoobject-editor"]],viewQuery:function(n,t){if(1&n&&e.Gf(h3,5),2&n){let o;e.iGM(o=e.CRH())&&(t.attributeEditor=o.first)}},inputs:{geoObjectType:"geoObjectType",onSuccessCallback:"onSuccessCallback"},features:[e._Bn([T.uU])],decls:10,vars:3,consts:[[1,"modal-body"],[1,"modal-form",2,"overflow","visible"],[3,"geoObjectType","postGeoObject","isNew","isGeometryInlined","hierarchies","readOnly",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"button-holder","text-left"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[3,"key"],[3,"geoObjectType","postGeoObject","isNew","isGeometryInlined","hierarchies","readOnly"],["attributeEditor",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"form",1),e.YNc(2,f3,2,6,"geoobject-shared-attribute-editor",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),e.NdJ("click",function(){return t.cancel()}),e._UZ(7,"localize",7),e.qZA(),e.TgZ(8,"button",8),e.NdJ("click",function(){return t.submit()}),e._UZ(9,"localize",9),e.qZA()()()()()()),2&n&&(e.xp6(2),e.Q6J("ngIf",t.geoObjectType&&t.geoObject&&t.hierarchies),e.xp6(6),e.Q6J("disabled",!t.canSubmit()),e.xp6(1),e.Q6J("key",t.isMaintainer?"modal.button.submit":"change.request.page.title"))},dependencies:[T.O5,y._Y,y.JL,y.F,Sn.l,Dp],styles:[".modal-content[_ngcontent-%COMP%]{overflow-y:visible!important}.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:disabled{background:#eee}li.list-group-item[_ngcontent-%COMP%]{font-size:18px}.warning-text[_ngcontent-%COMP%]{color:orange}"]});class sf{constructor(n,t,o,a,l){this.service=n,this.dateService=t,this.lService=o,this.bsModalRef=a,this.modalService=l,this.message=null,this.onProblemResolved=new e.vpe,this.readonly=!1,this.edit=!1}ngOnInit(){}onEditGeoObject(){let n=this.modalService.show(Ld,{backdrop:!0,ignoreBackdropClick:!0});n.content.configureFromImportError(this.problem,this.job.historyId,this.job.configuration.startDate,!0),n.content.setMasterListId(null),n.content.setOnSuccessCallback(()=>{this.onProblemResolved.emit(this.problem),this.bsModalRef.hide()})}getFriendlyProblemType(n){return"net.geoprism.registry.io.ParentCodeException"===n?this.lService.decode("scheduledjobs.job.problem.type.parent.lookup"):"net.geoprism.registry.io.PostalCodeLocationException"===n?this.lService.decode("scheduledjobs.job.problem.type.postal.code.lookup"):"net.geoprism.registry.io.AmbiguousParentException"===n?this.lService.decode("scheduledjobs.job.problem.type.multi.parent.lookup"):"net.geoprism.registry.io.InvalidGeometryException"===n?this.lService.decode("scheduledjobs.job.problem.type.invalid.geom.lookup"):"net.geoprism.registry.DataNotFoundException"===n?this.lService.decode("scheduledjobs.job.problem.type.datanotfound"):"net.geoprism.registry.roles.CreateGeoObjectPermissionException"===n||"net.geoprism.registry.roles.WriteGeoObjectPermissionException"===n||"net.geoprism.registry.roles.DeleteGeoObjectPermissionException"===n||"net.geoprism.registry.roles.ReadGeoObjectPermissionException"===n?this.lService.decode("scheduledjobs.job.problem.type.permission"):"com.runwaysdk.dataaccess.DuplicateDataException"===n||"net.geoprism.registry.DuplicateGeoObjectException"===n||"net.geoprism.registry.DuplicateGeoObjectCodeException"===n?this.lService.decode("scheduledjobs.job.problem.type.duplicate.data.lookup"):n}onSubmit(){}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function y3(i,n){if(1&i&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function v3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"import-problem-widget",13),e.NdJ("onProblemResolved",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onProblemResolvedListener(a.problem))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("problem",t.problem)("job",t.job)}}function b3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"parent-reference-problem-widget",13),e.NdJ("onProblemResolved",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onProblemResolvedListener(a.problem))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("problem",t.problem)("job",t.job)}}function x3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"term-reference-problem-widget",13),e.NdJ("onProblemResolved",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onProblemResolvedListener(a.problem))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("problem",t.problem)("job",t.job)}}function C3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"row-validation-problem-widget",13),e.NdJ("onProblemResolved",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onProblemResolvedListener(a.problem))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("problem",t.problem)("job",t.job)}}function w3(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,b3,1,2,"parent-reference-problem-widget",14),e.YNc(2,x3,1,2,"term-reference-problem-widget",14),e.YNc(3,C3,1,2,"row-validation-problem-widget",14),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf","ParentReferenceProblem"===t.problem.type),e.xp6(1),e.Q6J("ngIf","TermReferenceProblem"===t.problem.type),e.xp6(1),e.Q6J("ngIf","RowValidationProblem"===t.problem.type)}}sf.\u0275fac=function(n){return new(n||sf)(e.Y36(Zi),e.Y36(zs.R),e.Y36(mo.o),e.Y36(Ln.UZ),e.Y36(Ln.tT))},sf.\u0275cmp=e.Xpm({type:sf,selectors:[["import-problem-widget"]],inputs:{problem:"problem",job:"job"},outputs:{onProblemResolved:"onProblemResolved"},decls:20,vars:5,consts:[[1,""],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row","style","background: #F4F4F4;\n                                        border-radius: 10px;\n                                        margin-bottom: 20px;\n                                        margin-top: 20px;\n                                        padding: 10px;",4,"ngIf"],[1,"row",2,"background","#F4F4F4","border-radius","10px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-12"],[1,"row","equal",2,"display","flex","display","-webkit-flex","flex-wrap","wrap"],[1,"col-md-6",2,"padding-right","5px"],[2,"background","white","border-radius","10px","padding","10px","height","100%"],["key","etl.problem.header.problem"],[2,"font-style","italic"],["key","etl.problem.header.message"],[1,"col-md-6",2,"padding-left","5px"],["style","background: white;border-radius: 10px;padding: 10px;height: 100%;text-align: center;",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","importproblem.uploaded.by.label"],["key","importproblem.started.date.label"],[1,"date-string-display",2,"margin-left","5px"],[3,"date"],[2,"background","white","border-radius","10px","padding","10px","height","100%","text-align","center"],["type","submit","role","button",1,"btn","btn-primary",2,"width","90%",3,"click"],["key","scheduledjobs.editGeoObject"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,g3,2,1,"div",1),e.YNc(2,_3,17,3,"div",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h4")(9,"strong"),e._UZ(10,"localize",8),e.qZA()(),e.TgZ(11,"p",9),e._uU(12),e.qZA(),e.TgZ(13,"h4")(14,"strong"),e._UZ(15,"localize",10),e.qZA()(),e.TgZ(16,"p",9),e._uU(17),e.qZA()()(),e.TgZ(18,"div",11),e.YNc(19,m3,3,0,"div",12),e.qZA()()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",t.problem&&t.job),e.xp6(10),e.Oqu(t.getFriendlyProblemType(t.problem.exception.type)),e.xp6(5),e.Oqu(t.problem.exception.message),e.xp6(2),e.Q6J("ngIf",null!=t.problem.object&&null!=t.problem.object.geoObject))},dependencies:[T.O5,Sn.l,Fr.u],encapsulation:2});class lf{constructor(n){this.bsModalRef=n,this.message=null,this.readonly=!1,this.edit=!1,this.onConflictAction=new pn.x}ngOnInit(){}onProblemResolvedListener(n){this.onConflictAction.next({action:"RESOLVED",data:n})}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}lf.\u0275fac=function(n){return new(n||lf)(e.Y36(Ln.UZ))},lf.\u0275cmp=e.Xpm({type:lf,selectors:[["job-conflict-modal"]],decls:15,vars:3,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"text-center"],["key","scheduledjobs.problemdetail.modal.title"],[1,"modal-form"],["form","ngForm"],[4,"ngIf"],[1,"row-holder"],[1,""],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["key","io.back"],["role","alert",1,"alert","alert-danger"],[3,"problem","job","onProblemResolved"],[3,"problem","job","onProblemResolved",4,"ngIf"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,y3,2,1,"div",1),e.TgZ(2,"div",2)(3,"h2"),e._UZ(4,"localize",3),e.qZA()(),e.TgZ(5,"form",4,5)(7,"fieldset"),e.YNc(8,v3,2,2,"div",6),e.YNc(9,w3,4,3,"div",6),e.TgZ(10,"div",7)(11,"div",8)(12,"div",9)(13,"button",10),e.NdJ("click",function(){return t.onCancel()}),e._UZ(14,"localize",11),e.qZA()()()()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(7),e.Q6J("ngIf",t.problem&&t.job&&"IMPORT_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf",t.problem&&t.job&&"VALIDATION_RESOLVE"===t.job.stage))},dependencies:[T.O5,y._Y,y.JL,y.F,Sn.l,of,rf,af,sf],encapsulation:2});const T3=["myFile"];function M3(i,n){if(1&i&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.errorMessage)}}function O3(i,n){1&i&&e._UZ(0,"localize",18)}function S3(i,n){1&i&&e._UZ(0,"localize",19)}function P3(i,n){if(1&i&&e._UZ(0,"input",20,21),2&i){const t=e.oxw(2);e.Q6J("uploader",t.uploader)}}function E3(i,n){if(1&i&&e._UZ(0,"input",22,21),2&i){const t=e.oxw(2);e.Q6J("uploader",t.uploader)}}function A3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"form",5,6)(2,"div",7)(3,"label",8),e.YNc(4,O3,1,0,"localize",9),e.YNc(5,S3,1,0,"localize",10),e.qZA(),e.TgZ(6,"div",11),e.YNc(7,P3,2,1,"input",12),e.YNc(8,E3,2,1,"input",13),e.qZA()(),e.TgZ(9,"div",14)(10,"div",15)(11,"button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.bsModalRef.hide())}),e.TgZ(12,"span"),e._uU(13),e.qZA()(),e.TgZ(14,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.confirm())}),e.TgZ(15,"span"),e._uU(16),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("ngIf","SHAPEFILE"===t.job.configuration.formatType),e.xp6(1),e.Q6J("ngIf","EXCEL"===t.job.configuration.formatType),e.xp6(2),e.Q6J("ngIf","SHAPEFILE"===t.job.configuration.formatType),e.xp6(1),e.Q6J("ngIf","EXCEL"===t.job.configuration.formatType),e.xp6(5),e.Oqu(t.cancelText),e.xp6(1),e.Q6J("ngClass","DANGER"===t.type.toUpperCase()?"btn-danger":"btn-primary"),e.xp6(2),e.Oqu(t.submitText)}}class cf{constructor(n,t,o){this.bsModalRef=n,this.localizeService=t,this.eventService=o,this.title=this.localizeService.decode("reuploadmodal.title"),this.message=this.localizeService.decode("reuploadmodal.message"),this.submitText=this.localizeService.decode("reuploadmodal.import"),this.cancelText=this.localizeService.decode("modal.button.cancel"),this.type=ec.Qi.warning}ngOnInit(){this.onConfirm=new pn.x,this.uploader=new I.bA({queueLimit:1,removeAfterUpload:!0,url:pt.N.apiUrl+"/api/etl/reimport"}),this.uploader.onBuildItemForm=(t,o)=>{o.append("config",JSON.stringify(this.job.configuration))},this.uploader.onBeforeUploadItem=t=>{this.eventService.start()},this.uploader.onCompleteItem=(t,o,a,l)=>{this.fileRef.nativeElement.value="",this.eventService.complete()},this.uploader.onSuccessItem=(t,o,a,l)=>{this.onConfirm.next(this.data),this.bsModalRef.hide()},this.uploader.onErrorItem=(t,o,a,l)=>{this.error(JSON.parse(o))}}toString(n){return JSON.stringify(n)}confirm(){null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizeService.decode("io.missing.file"),error:{}})}error(n){this.errorMessage=Zt.qL.getMessageFromError(n)}}function k3(i,n){if(1&i&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function I3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",27)(1,"span",28),e._UZ(2,"localize",29),e.qZA(),e.TgZ(3,"button",30),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onResolveScheduledJob(a.job.historyId))}),e._UZ(4,"localize",31),e.qZA()()}}function Z3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",27)(1,"span",28),e._UZ(2,"localize",32),e.qZA(),e.TgZ(3,"button",30),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onResolveScheduledJob(a.job.historyId))}),e._UZ(4,"localize",33),e.qZA()()}}function N3(i,n){1&i&&e._UZ(0,"localize",37)}function L3(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",33),e.qZA())}function z3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",34)(1,"button",30),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onResolveScheduledJob(a.job.historyId))}),e.YNc(2,N3,1,0,"localize",35),e.YNc(3,L3,2,0,"span",36),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.job&&"VALIDATION_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf",t.job&&"IMPORT_RESOLVE"===t.job.stage)}}function D3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",38)(1,"button",30),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onReuploadAndResume(a.job.historyId))}),e.TgZ(2,"span"),e._UZ(3,"localize",39),e.qZA()()()}}function R3(i,n){if(1&i&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e._UZ(3,"i",11),e.TgZ(4,"p",12)(5,"span",13)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"span",13),e._UZ(9,"localize",14),e._uU(10),e.qZA(),e.TgZ(11,"span",13),e._UZ(12,"localize",15),e.TgZ(13,"span",16),e._UZ(14,"date-text",17),e.qZA()()()()(),e.TgZ(15,"div",18)(16,"div")(17,"h5")(18,"b"),e._uU(19),e._UZ(20,"localize",19),e._uU(21),e._UZ(22,"localize",20),e.qZA()(),e.TgZ(23,"h5"),e._uU(24),e._UZ(25,"localize",21),e.qZA()()(),e.TgZ(26,"div",22),e.YNc(27,I3,5,0,"div",23),e.YNc(28,Z3,5,0,"div",24),e.YNc(29,z3,4,2,"div",25),e.YNc(30,D3,4,0,"div",26),e.qZA()()),2&i){const t=e.oxw();e.xp6(7),e.Oqu(t.job.fileName),e.xp6(3),e.hij(" ",t.job.author," "),e.xp6(4),e.Q6J("date",t.job.createDate),e.xp6(5),e.hij("",t.job.importedRecords," "),e.xp6(2),e.hij(" ",t.job.workTotal," "),e.xp6(3),e.hij("",t.job.workTotal-t.job.importedRecords," "),e.xp6(3),e.Q6J("ngIf",0==t.page.resultSet.length&&t.job&&"VALIDATION_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf",0==t.page.resultSet.length&&t.job&&"IMPORT_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf",t.page&&null!=t.page.resultSet&&t.page.resultSet.length>0&&!t.hasRowValidationProblem),e.xp6(1),e.Q6J("ngIf",t.hasRowValidationProblem)}}function F3(i,n){1&i&&(e.TgZ(0,"thead")(1,"tr")(2,"th",47),e._UZ(3,"localize",48),e.qZA(),e.TgZ(4,"th",47),e._UZ(5,"localize",49),e.qZA(),e.TgZ(6,"th",47),e._UZ(7,"localize",50),e.qZA(),e._UZ(8,"th",47),e.qZA()())}function U3(i,n){1&i&&(e.TgZ(0,"thead")(1,"tr")(2,"th",47),e._UZ(3,"localize",51),e.qZA(),e.TgZ(4,"th",47),e._UZ(5,"localize",52),e.qZA(),e.TgZ(6,"th",47),e._UZ(7,"localize",53),e.qZA(),e._UZ(8,"th",47),e.qZA()())}function q3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",57)(1,"button",58),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onEdit(a))}),e._UZ(2,"localize",59),e.qZA()()}}function J3(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",55)(2,"p"),e._uU(3),e.qZA()(),e.TgZ(4,"td",55)(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"td",55)(8,"p"),e._uU(9),e.qZA()(),e.YNc(10,q3,3,0,"td",56),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(4);e.xp6(3),e.Oqu(o.getFriendlyProblemType(t.exception.type)),e.xp6(3),e.Oqu(t.exception.message),e.xp6(3),e.Oqu(t.rowNum),e.xp6(1),e.Q6J("ngIf",o.isAdmin||o.isMaintainer)}}cf.\u0275fac=function(n){return new(n||cf)(e.Y36(Ln.UZ),e.Y36(nn.oQ),e.Y36(nn.PO))},cf.\u0275cmp=e.Xpm({type:cf,selectors:[["reupload-modal"]],viewQuery:function(n,t){if(1&n&&e.Gf(T3,5),2&n){let o;e.iGM(o=e.CRH())&&(t.fileRef=o.first)}},inputs:{title:"title",message:"message",data:"data",submitText:"submitText",cancelText:"cancelText",type:"type",job:"job"},decls:8,vars:4,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading"],["style","margin-top: 30px;",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[2,"margin-top","30px"],["form","ngForm"],[1,"form-group","row"],["for","file",1,"col-md-3","text-right"],["key","io.shapefile",4,"ngIf"],["key","io.spreadsheet",4,"ngIf"],[1,"col-md-9"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".zip","required","",3,"uploader",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".xlsx,.zip","required","",3,"uploader",4,"ngIf"],[1,"modal-footer"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],["type","button","role","button","aria-disabled","false",1,"btn",2,"padding","4px 18px",3,"ngClass","click"],["key","io.shapefile"],["key","io.spreadsheet"],["name","file","type","file","ng2FileSelect","","accept",".zip","required","",1,"ghost-input",3,"uploader"],["myFile",""],["name","file","type","file","ng2FileSelect","","accept",".xlsx,.zip","required","",1,"ghost-input",3,"uploader"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,M3,2,1,"div",1),e.TgZ(2,"div",2)(3,"h3"),e._uU(4),e.qZA()(),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.YNc(7,A3,17,7,"form",3),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",t.errorMessage),e.xp6(3),e.Oqu(t.title),e.xp6(2),e.Oqu(t.message),e.xp6(1),e.Q6J("ngIf",t.job))},dependencies:[T.mk,T.O5,y._Y,y.JL,y.F,I.C6,Sn.l],encapsulation:2});const nv=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};function j3(i,n){if(1&i&&(e.TgZ(0,"tbody"),e.YNc(1,J3,11,4,"tr",54),e.ALo(2,"paginate"),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,t.page.resultSet,e.kEZ(4,nv,t.page.pageSize,t.page.pageNumber,t.page.count)))}}function B3(i,n){if(1&i&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.exception.message)}}function G3(i,n){if(1&i&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.label)}}function V3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",57)(1,"button",58),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onEdit(a))}),e._UZ(2,"localize",59),e.qZA()()}}function Y3(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",55)(2,"p"),e._uU(3),e.qZA()(),e.TgZ(4,"td",55),e.YNc(5,B3,2,1,"p",36),e.YNc(6,G3,2,1,"p",36),e.qZA(),e.TgZ(7,"td",55)(8,"p"),e._uU(9),e.qZA()(),e.YNc(10,V3,3,0,"td",56),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(4);e.xp6(3),e.Oqu(t.type),e.xp6(2),e.Q6J("ngIf","RowValidationProblem"===t.type),e.xp6(1),e.Q6J("ngIf","ParentReferenceProblem"===t.type||"TermReferenceProblem"===t.type),e.xp6(3),e.Oqu(o.formatAffectedRows(t.affectedRows)),e.xp6(1),e.Q6J("ngIf",o.isAdmin||o.isMaintainer)}}function H3(i,n){if(1&i&&(e.TgZ(0,"tbody"),e.YNc(1,Y3,11,5,"tr",54),e.ALo(2,"paginate"),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,t.page.resultSet,e.kEZ(4,nv,t.page.pageSize,t.page.pageNumber,t.page.count)))}}function Q3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",45)(1,"pagination-controls",60),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.onPageChange(a))}),e.qZA()()}}function K3(i,n){if(1&i&&(e.TgZ(0,"div",42)(1,"ul",43)(2,"table",44),e.YNc(3,F3,9,0,"thead",36),e.YNc(4,U3,9,0,"thead",36),e.YNc(5,j3,3,8,"tbody",36),e.YNc(6,H3,3,8,"tbody",36),e.qZA(),e.TgZ(7,"div",45),e.YNc(8,Q3,2,0,"div",46),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf","IMPORT_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf","VALIDATION_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf","IMPORT_RESOLVE"===t.job.stage),e.xp6(1),e.Q6J("ngIf","VALIDATION_RESOLVE"===t.job.stage),e.xp6(2),e.Q6J("ngIf",t.page.resultSet.length>0)}}function $3(i,n){if(1&i&&(e.TgZ(0,"div",40),e.YNc(1,K3,9,5,"div",41),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.job)}}class uf{constructor(n,t,o,a,l,_,C,N){this.service=n,this.modalService=t,this.router=o,this.route=a,this.dateService=l,this.localizeService=_,this.ioService=N,this.message=null,this.allSelected=!1,this.historyId="",this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.timeCounter=0,this.isPolling=!1,this.hasRowValidationProblem=!1,this.subscription=null,this.isAdmin=C.isAdmin(),this.isMaintainer=this.isAdmin||C.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||C.isContributer()}ngOnInit(){this.historyId=this.route.snapshot.params.oid,this.onPageChange(1);let n=md.buildBaseUrl();this.notifier=Ip(n+"/websocket/notify"),this.subscription=this.notifier.subscribe(t=>{"IMPORT_JOB_CHANGE"===t.type&&this.onPageChange(this.page.pageNumber)})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe(),this.notifier.complete()}formatAffectedRows(n){return n.replace(/,/g,", ")}formatValidationResolve(n){return JSON.stringify(n)}onProblemResolved(n){for(let t=0;t<this.page.resultSet.length;++t)this.page.resultSet[t].id===n.id&&this.page.resultSet.splice(t,1)}getFriendlyProblemType(n){return"net.geoprism.registry.io.ParentCodeException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.parent.lookup"):"net.geoprism.registry.io.PostalCodeLocationException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.postal.code.lookup"):"net.geoprism.registry.io.AmbiguousParentException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.multi.parent.lookup"):"net.geoprism.registry.io.InvalidGeometryException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.invalid.geom.lookup"):"net.geoprism.registry.DataNotFoundException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.datanotfound"):"net.geoprism.registry.geoobject.ImportOutOfRangeException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.importOutOfRange"):"net.geoprism.registry.roles.CreateGeoObjectPermissionException"===n||"net.geoprism.registry.roles.WriteGeoObjectPermissionException"===n||"net.geoprism.registry.roles.DeleteGeoObjectPermissionException"===n||"net.geoprism.registry.roles.ReadGeoObjectPermissionException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.permission"):"com.runwaysdk.dataaccess.DuplicateDataException"===n||"net.geoprism.registry.DuplicateGeoObjectException"===n||"net.geoprism.registry.DuplicateGeoObjectCodeException"===n?this.localizeService.decode("scheduledjobs.job.problem.type.duplicate.data.lookup"):n}onEdit(n){this.bsModalRef=this.modalService.show(lf,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.problem=n,this.bsModalRef.content.job=this.job,this.bsModalRef.content.onConflictAction.subscribe(t=>{"RESOLVED"===t.action&&this.onProblemResolved(t.data)})}onPageChange(n){this.message=null,this.service.getScheduledJob(this.historyId,this.page.pageSize,n,!0).then(t=>{if(this.job=t,"IMPORT_RESOLVE"===this.job.stage)this.page=this.job.importErrors;else if("VALIDATION_RESOLVE"===this.job.stage){this.page=this.job.problems;for(let o=0;o<this.page.resultSet.length;++o)"RowValidationProblem"===this.page.resultSet[o].type&&(this.hasRowValidationProblem=!0)}t.exception&&this.error(t.exception)}).catch(t=>{this.error(t)})}onViewAllActiveJobs(){}onViewAllCompleteJobs(){}toggleAll(){this.allSelected=!this.allSelected,this.job.importErrors.resultSet.forEach(n=>{n.selected=this.allSelected})}onReuploadAndResume(n){this.bsModalRef=this.modalService.show(cf,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.job=this.job,this.bsModalRef.content.onConfirm.subscribe(t=>{this.router.navigate(["/registry/scheduled-jobs"])})}onResolveScheduledJob(n){0===this.page.resultSet.length?this.service.resolveScheduledJob(n).then(t=>{this.router.navigate(["/registry/scheduled-jobs"])}).catch(t=>{this.error(t)}):(this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),"VALIDATION_RESOLVE"===this.job.stage?(this.bsModalRef.content.message=this.localizeService.decode("etl.import.resume.modal.validationDescription"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.resume.modal.validationButton")):(this.bsModalRef.content.message=this.localizeService.decode("etl.import.resume.modal.importDescription"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.resume.modal.importButton")),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(t=>{this.service.resolveScheduledJob(n).then(o=>{this.router.navigate(["/registry/scheduled-jobs"])}).catch(o=>{this.error(o)})}))}onCancelScheduledJob(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("etl.import.cancel.modal.description"),this.bsModalRef.content.submitText=this.localizeService.decode("etl.import.cancel.modal.button"),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(t=>{this.ioService.cancelImport(this.job.configuration).then(o=>{this.router.navigate(["/registry/scheduled-jobs"])}).catch(o=>{this.error(o)})})}error(n){this.message=Zt.qL.getMessageFromError(n)}}uf.\u0275fac=function(n){return new(n||uf)(e.Y36(Zi),e.Y36(Ln.tT),e.Y36(w.F0),e.Y36(w.gz),e.Y36(zs.R),e.Y36(nn.oQ),e.Y36(nn.e8),e.Y36(pr))},uf.\u0275cmp=e.Xpm({type:uf,selectors:[["job"]],decls:10,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","scheduledjobs.details.title"],["class","row","style","background: #F4F4F4;\n                                border-radius: 15px;\n                                margin-bottom: 20px;\n                                margin-top: 20px;\n                                padding: 10px;",4,"ngIf"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"background","#F4F4F4","border-radius","15px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-4","order-md-1"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","scheduledjobs.job.uploaded.by.label"],["key","scheduledjobs.job.started.label"],[1,"date-string-display"],[3,"date"],[1,"col-md-3","order-md-1"],["key","scheduledjobs.job.imported.out.of.label"],["key","scheduledjobs.job.imported.total.label"],["key","scheduledjobs.job.remaining.label"],[1,"col-md-5","order-md-1"],["style","display:block; margin: 10px;text-align: right;",4,"ngIf"],["style","display:block; margin:10px;text-align: right;",4,"ngIf"],["class","button-holder","style","display:block; margin:10px;text-align: right;",4,"ngIf"],["class","button-holder","style","display:block; margin:10px;",4,"ngIf"],[2,"display","block","margin","10px","text-align","right"],[2,"display","block","margin-bottom","10px"],["key","scheduledjobs.validation.problems.complete.msg"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","scheduledjobs.reimport.button"],["key","scheduledjobs.import.problems.complete.msg"],["key","scheduledjobs.complete.import.button"],[1,"button-holder",2,"display","block","margin","10px","text-align","right"],["key","etl.import.resume.openModal",4,"ngIf"],[4,"ngIf"],["key","etl.import.resume.openModal"],[1,"button-holder",2,"display","block","margin","10px"],["key","scheduledjobs.reupload.resume.button"],[1,"row"],["class","col-md-12 order-md-1",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"list-table","table","table-bordered","table-striped"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[1,"label-column"],["key","scheduledjobs.import.table.problem.type.header"],["key","scheduledjobs.import.table.message.header"],["key","scheduledjobs.import.table.row.number.header"],["key","scheduledjobs.validation.table.problem.type.header"],["key","scheduledjobs.validation.table.label.header"],["key","scheduledjobs.validation.table.affected.rows.header"],[4,"ngFor","ngForOf"],[1,"label-column",2,"vertical-align","middle"],["class","label-column","style","text-align: right;",4,"ngIf"],[1,"label-column",2,"text-align","right"],["type","submit","role","button",1,"btn","btn-link",3,"click"],["key","scheduledjobs.fix.problem.button"],[3,"pageChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,k3,2,1,"div",2),e.TgZ(5,"div",3)(6,"h2"),e._UZ(7,"localize",4),e.qZA()(),e.YNc(8,R3,31,10,"div",5),e.YNc(9,$3,2,1,"div",6),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(4),e.Q6J("ngIf",t.job),e.xp6(1),e.Q6J("ngIf",t.page&&t.page.resultSet.length>0))},dependencies:[T.sg,T.O5,U.LS,Sn.l,Da.N,ba.C,Fr.u,U._s],styles:[".solid-table-wrapper[_ngcontent-%COMP%]{background:#F4F4F4;border-radius:15px;margin-bottom:20px}.solid-table-footer[_ngcontent-%COMP%]{border-radius:0 0 15px 15px;padding:0 0 10px 10px}.wrapper[_ngcontent-%COMP%]{padding:10px}"]});var W3=v(3967);function X3(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"h4"),e._uU(3),e.qZA()(),e.TgZ(4,"div",17)(5,"div",4)(6,"div",5)(7,"p",18),e._uU(8),e.qZA(),e.TgZ(9,"label",19),e._UZ(10,"localize",20),e.qZA(),e.TgZ(11,"span",21),e._UZ(12,"date-text",22),e.qZA()(),e.TgZ(13,"div",23)(14,"label",24),e._UZ(15,"input",25),e.TgZ(16,"span"),e._UZ(17,"localize",26),e.qZA()(),e.TgZ(18,"label",24)(19,"input",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.onCompleteTask(l))}),e.qZA(),e.TgZ(20,"span"),e._UZ(21,"localize",28),e.qZA()()()()()()}if(2&i){const t=n.$implicit;e.xp6(3),e.Oqu(t.title),e.xp6(5),e.Oqu(t.msg),e.xp6(4),e.Q6J("date",t.createDate),e.xp6(3),e.MGl("id","",t.id,"-inProgress")("name","",t.id,"-inProgress"),e.xp6(4),e.MGl("id","",t.id,"-completed")("name","",t.id,"-completed")}}function eS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",29)(1,"pagination-controls",30),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onInProgressTasksPageChange(a))}),e.qZA()()}}const tS=function(i,n,t){return{id:"inProgressTasks",itemsPerPage:i,currentPage:n,totalItems:t}};function nS(i,n){if(1&i&&(e.TgZ(0,"div",4)(1,"div",10)(2,"div",12),e.YNc(3,X3,22,7,"div",13),e.ALo(4,"paginate"),e.YNc(5,eS,2,0,"div",14),e.qZA()()()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",e.xi3(4,2,t.inProgressTasks.resultSet,e.kEZ(5,tS,t.inProgressTasks.pageSize,t.inProgressTasks.pageNumber,t.inProgressTasks.count))),e.xp6(2),e.Q6J("ngIf",t.inProgressTasks.resultSet.length>0)}}function iS(i,n){1&i&&e._UZ(0,"localize",31)}function oS(i,n){1&i&&e._UZ(0,"localize",32)}function rS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"h4"),e._uU(3),e.qZA()(),e.TgZ(4,"div",17)(5,"div",4)(6,"div",5)(7,"p",18),e._uU(8),e.qZA(),e.TgZ(9,"label",19),e._UZ(10,"localize",20),e.qZA(),e.TgZ(11,"span",33),e._UZ(12,"date-text",22),e.qZA(),e.TgZ(13,"label",19),e._UZ(14,"localize",34),e.qZA(),e.TgZ(15,"span",21),e._UZ(16,"date-text",22),e.qZA()(),e.TgZ(17,"div",23)(18,"label",24)(19,"input",35),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.onMoveTaskToInProgress(l))}),e.qZA(),e.TgZ(20,"span"),e._UZ(21,"localize",26),e.qZA()(),e.TgZ(22,"label",24),e._UZ(23,"input",36),e.TgZ(24,"span"),e._UZ(25,"localize",28),e.qZA()()()()()()}if(2&i){const t=n.$implicit;e.xp6(3),e.Oqu(t.title),e.xp6(5),e.Oqu(t.msg),e.xp6(4),e.Q6J("date",t.createDate),e.xp6(4),e.Q6J("date",t.completedDate),e.xp6(3),e.Q6J("id",t.id+"-inProgress")("name",t.id+"-inProgress"),e.xp6(4),e.Q6J("id",t.id+"-completed")("name",t.id+"-completed")}}function aS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",29)(1,"pagination-controls",37),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onCompletedTasksPageChange(a))}),e.qZA()()}}const sS=function(i,n,t){return{id:"completedTasks",itemsPerPage:i,currentPage:n,totalItems:t}};function lS(i,n){if(1&i&&(e.TgZ(0,"div",12),e.YNc(1,rS,26,8,"div",13),e.ALo(2,"paginate"),e.YNc(3,aS,2,0,"div",14),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,2,t.completedTasks.resultSet,e.kEZ(5,sS,t.completedTasks.pageSize,t.completedTasks.pageNumber,t.completedTasks.count))),e.xp6(2),e.Q6J("ngIf",t.completedTasks.resultSet.length>0)}}function cS(i,n){1&i&&(e.TgZ(0,"div",12)(1,"p",38),e._UZ(2,"localize",39),e.qZA()())}class pf{constructor(n,t,o){this.taskService=n,this.localizeService=t,this.dateService=o,this.inProgressTasks={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.completedTasks={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.isViewAllOpen=!1,this.activeTimeCounter=0,this.completeTimeCounter=0}ngOnInit(){this.onInProgressTasksPageChange(1)}onInProgressTasksPageChange(n){this.taskService.getMyTasks(n,this.inProgressTasks.pageSize,"UNRESOLVED").then(t=>{this.inProgressTasks=t})}onCompletedTasksPageChange(n){this.taskService.getMyTasks(n,this.completedTasks.pageSize,"RESOLVED").then(t=>{this.completedTasks=t})}onCompleteTask(n){this.taskService.completeTask(n.id).then(()=>{const t=this.inProgressTasks.resultSet.findIndex(o=>o.id===n.id);-1!==t&&this.inProgressTasks.resultSet.splice(t,1),this.isViewAllOpen&&this.onCompletedTasksPageChange(this.completedTasks.pageNumber)})}onMoveTaskToInProgress(n){this.isViewAllOpen=!0,this.taskService.setTaskStatus(n.id,"UNRESOLVED").then(()=>{const t=this.completedTasks.resultSet.findIndex(o=>o.id===n.id);-1!==t&&this.completedTasks.resultSet.splice(t,1),this.completedTasks.resultSet.splice(t,1),this.inProgressTasks.resultSet.push(n)})}onToggleCompletedTasks(){this.isViewAllOpen=!this.isViewAllOpen,this.isViewAllOpen&&this.onCompletedTasksPageChange(1)}}function uS(i,n){if(1&i&&(e.TgZ(0,"option",26),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.oid),e.xp6(1),e.Oqu(t.label)}}function pS(i,n){if(1&i&&(e.TgZ(0,"option",26),e._uU(1),e._UZ(2,"localize",27),e._uU(3),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.oid),e.xp6(1),e.hij(" ",t.forDate," ("),e.xp6(2),e.hij(" ",t.versionNumber,") ")}}function dS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.versionId=a)}),e._UZ(1,"option"),e.YNc(2,pS,4,3,"option",19),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw();e.Q6J("ngModel",t.versionId)("name","version"+t.level),e.xp6(2),e.Q6J("ngForOf",o.versions[t.masterListId])}}function hS(i,n){if(1&i&&(e.TgZ(0,"option",26),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.className),e.xp6(1),e.Oqu(t.label)}}function fS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",6)(2,"label",15),e._UZ(3,"localize",16),e._uU(4),e.qZA()(),e.TgZ(5,"td",17)(6,"select",18),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.masterListId=a)})("change",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onSelectMasterList(l))}),e._UZ(7,"option"),e.YNc(8,uS,2,2,"option",19),e.qZA()(),e.TgZ(9,"td",17),e.YNc(10,dS,3,3,"select",20),e.qZA(),e.TgZ(11,"td",17)(12,"select",21),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.implementation=a)}),e._UZ(13,"option"),e.YNc(14,hS,2,2,"option",19),e.qZA()(),e.TgZ(15,"td",17)(16,"div")(17,"a",22),e.NdJ("click",function(){const l=e.CHM(t).index,_=e.oxw();return e.KtG(_.removeLevel(l))}),e.ALo(18,"localize"),e._UZ(19,"i",23),e.TgZ(20,"label",24),e._UZ(21,"localize",25),e.qZA()()()()()}if(2&i){const t=n.$implicit,o=e.oxw();e.Udp("background-color","#F7F7F7"),e.xp6(4),e.hij(" ",t.level+1," "),e.xp6(2),e.Q6J("ngModel",t.masterListId)("name","masterList"+t.level),e.xp6(2),e.Q6J("ngForOf",o.lists),e.xp6(2),e.Q6J("ngIf",null!=o.versions[t.masterListId]),e.xp6(2),e.Q6J("ngModel",t.implementation)("name","implementation"+t.level),e.xp6(2),e.Q6J("ngForOf",o.implementations),e.xp6(3),e.Q6J("title",e.lcZ(18,11,"button.delete.helptext"))}}pf.\u0275fac=function(n){return new(n||pf)(e.Y36(Ku),e.Y36(mo.o),e.Y36(zs.R))},pf.\u0275cmp=e.Xpm({type:pf,selectors:[["task-viewer"]],inputs:{geoObjectType:"geoObjectType"},features:[e._Bn([T.uU])],decls:19,vars:5,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container"],["key","tasks.openTasksTitle"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-9"],["key","tasks.completedTasksTitle"],["type","submit","role","button",1,"btn","btn-default","pull-right",2,"margin-top","20px",3,"click"],["key","tasks.viewCompletedTasksButton",4,"ngIf"],["key","tasks.hideCompletedTasksButton",4,"ngIf"],[1,"col-md-12"],["class","content-wrapper",4,"ngIf"],[1,"content-wrapper"],["class","panel panel-default",4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[2,"margin-bottom","20px"],[2,"margin-right","20px"],["key","tasks.createDateLabel"],[1,"date-string-display"],[3,"date"],[1,"col-md-3",2,"min-height","90px","display","flex","align-items","center"],[1,"radio-inline","radio"],["type","radio","checked","","value","true",1,"inline-radio-input",2,"height","auto",3,"id","name"],["key","tasks.open"],["type","radio","value","false",1,"inline-radio-input",2,"margin-left","15px","height","auto",3,"id","name","click"],["key","tasks.complete"],[1,"solid-table-footer"],["id","inProgressTasks",3,"pageChange"],["key","tasks.viewCompletedTasksButton"],["key","tasks.hideCompletedTasksButton"],[1,"date-string-display",2,"margin-right","30px"],["key","tasks.completeDateLabel"],["type","radio","value","true",1,"inline-radio-input",2,"height","auto",3,"id","name","click"],["checked","","type","radio","value","false",1,"inline-radio-input",2,"margin-left","15px","height","auto",3,"id","name"],["id","completedTasks",3,"pageChange"],[2,"font-style","italic","color","grey"],["key","tasks.no.completed.tasks.message"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header"),e.TgZ(2,"div",1),e._UZ(3,"message"),e.TgZ(4,"h2"),e._UZ(5,"localize",2),e.qZA(),e._UZ(6,"hr"),e.YNc(7,nS,6,9,"div",3),e.TgZ(8,"div",4)(9,"h2",5),e._UZ(10,"localize",6),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return t.onToggleCompletedTasks()}),e.YNc(12,iS,1,0,"localize",8),e.YNc(13,oS,1,0,"localize",9),e.qZA()(),e._UZ(14,"hr"),e.TgZ(15,"div",4)(16,"div",10),e.YNc(17,lS,4,9,"div",11),e.YNc(18,cS,3,0,"div",11),e.qZA()()()()),2&n&&(e.xp6(7),e.Q6J("ngIf",t.inProgressTasks.resultSet.length>0),e.xp6(5),e.Q6J("ngIf",!t.isViewAllOpen),e.xp6(1),e.Q6J("ngIf",t.isViewAllOpen),e.xp6(4),e.Q6J("ngIf",t.isViewAllOpen&&t.completedTasks.resultSet.length>0),e.xp6(1),e.Q6J("ngIf",0===t.completedTasks.resultSet.length&&t.isViewAllOpen))},dependencies:[T.sg,T.O5,U.LS,Sn.l,W3.q,ba.C,Fr.u,U._s],styles:[".modal-content[_ngcontent-%COMP%]{overflow-y:visible!important}.modal-form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:disabled{background:#eee}li.list-group-item[_ngcontent-%COMP%]{font-size:18px}.warning-text[_ngcontent-%COMP%]{color:orange}"]});class df{constructor(n,t){this.service=n,this.rService=t,this.message=null,this.onError=new e.vpe,this.subscription=null,this.versions={},this.implementations=[],this.lists=[]}ngOnInit(){this.reset(),this.subscription=this.fieldChange.subscribe(n=>{("organization"===n||"system"===n)&&this.reset()}),this.service.getFhirExportImplementations().then(n=>{this.implementations=n})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe()}reset(){if(null==this.config.configuration&&(this.config.configuration={levels:[],hierarchy:null}),null!=this.config.configuration.levels)for(let n=0;n<this.config.configuration.levels.length;++n)this.onSelectMasterList(this.config.configuration.levels[n]);else this.config.configuration.levels=[];this.rService.getAllLists().then(n=>{this.lists=n})}onSelectMasterList(n){null!=n.masterListId&&n.masterListId.length>0?this.rService.getPublicVersions(n.masterListId).then(t=>{this.versions[n.masterListId]=t}):this.versions[n.masterListId]=null}addLevel(){this.config.configuration.levels.push({masterListId:null,versionId:null,level:this.config.configuration.levels.length})}removeLevel(n){if(this.config.configuration.levels.splice(n,1),null!=this.config.configuration&&null!=this.config.configuration.levels)for(n=0;n<this.config.configuration.levels.length;++n)this.config.configuration.levels[n].level=n}error(n){this.onError.emit(n)}}function gS(i,n){if(1&i&&(e.TgZ(0,"option",6),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.className),e.xp6(1),e.hij(" ",t.label," ")}}df.\u0275fac=function(n){return new(n||df)(e.Y36(Ls),e.Y36(Uo))},df.\u0275cmp=e.Xpm({type:df,selectors:[["fhir-export-synchronization-config"]],inputs:{config:"config",fieldChange:"fieldChange"},outputs:{onError:"onError"},decls:23,vars:4,consts:[[1,"row-holder"],[1,"label-holder"],["key","synchronization.config.units"],[1,"holder"],[1,"list-table-wrapper"],["id","manage-systems-table",1,"list-table","table","table-bordered"],[2,"width","3%"],["key","settings.external.synchronization.level.label"],[2,"width","25%"],["key","masterlist.field"],["key","masterlist.forDate"],["key","synchronization.config.implementation"],[3,"background-color",4,"ngFor","ngForOf"],[1,"button-column"],[1,"fa","fa-plus",3,"title","click"],[2,"padding","10px 0","margin","0"],["key","sync.level.label"],[2,"width","20%"],["required","",3,"ngModel","name","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["required","",3,"ngModel","name","ngModelChange",4,"ngIf"],["required","",3,"ngModel","name","ngModelChange"],[2,"padding","10px",3,"title","click"],[1,"fa","fa-trash-o","ico-remove"],[2,"cursor","pointer","margin-left","9px"],["key","sync.level.delete"],[3,"value"],["key","list.type.version"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label"),e._UZ(3,"localize",2),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"table",5)(7,"thead")(8,"tr")(9,"th",6),e._UZ(10,"localize",7),e.qZA(),e.TgZ(11,"th",8),e._UZ(12,"localize",9),e.qZA(),e.TgZ(13,"th",8),e._UZ(14,"localize",10),e.qZA(),e.TgZ(15,"th",8),e._UZ(16,"localize",11),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,fS,22,13,"tr",12),e.TgZ(19,"tr")(20,"td",13)(21,"a",14),e.NdJ("click",function(){return t.addLevel()}),e.ALo(22,"localize"),e.qZA()()()()()()()()),2&n&&(e.xp6(18),e.Q6J("ngForOf",t.config.configuration.levels),e.xp6(3),e.Q6J("title",e.lcZ(22,2,"sync.levels.add.tooltip")))},dependencies:[T.sg,T.O5,y.YN,y.Kr,y.EJ,y.JJ,y.Q7,y.On,Sn.l,ia.F],encapsulation:2});class hf{constructor(n){this.service=n,this.message=null,this.onError=new e.vpe,this.subscription=null,this.implementations=[]}ngOnInit(){this.reset(),this.subscription=this.fieldChange.subscribe(n=>{("organization"===n||"system"===n)&&this.reset()}),this.service.getFhirImportImplementations().then(n=>{this.implementations=n})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe()}reset(){null==this.config.configuration&&(this.config.configuration={implementation:null})}error(n){this.onError.emit(n)}}function _S(i,n){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label)}}function mS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"label"),e._UZ(3,"localize",10),e.qZA()(),e.TgZ(4,"div",11)(5,"span",12)(6,"select",13),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.config.configuration.hierarchyCode=a)})("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onChangeHierarchy())}),e._UZ(7,"option"),e.YNc(8,_S,2,2,"option",9),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.config.configuration.hierarchyCode)("disabled",null!=t.config.oid),e.xp6(2),e.Q6J("ngForOf",t.cOrg.hierarchies)}}function yS(i,n){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.toString),e.xp6(1),e.Oqu(t.label.localizedValue)}}function vS(i,n){if(1&i&&(e.TgZ(0,"td",18)(1,"label",34),e._UZ(2,"localize",35),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.levelNum+1,"")}}function bS(i,n){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label.localizedValue)}}function xS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",20)(1,"select",36),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.level.geoObjectType=a)})("change",function(){e.CHM(t);const a=e.oxw(),l=a.$implicit,_=a.index,C=e.oxw(2);return e.KtG(C.onSelectGeoObjectType(l.level.geoObjectType,_))}),e._UZ(2,"option"),e.YNc(3,bS,2,2,"option",9),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.level.geoObjectType)("name","geoObjectType"+t.levelNum),e.xp6(2),e.Q6J("ngForOf",o.types)}}function CS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",20)(1,"select",37),e.NdJ("change",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.onSelectLevelType(a))})("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.level.type=a)}),e._UZ(2,"option"),e.TgZ(3,"option",38),e._UZ(4,"localize",15),e.qZA(),e.TgZ(5,"option",39),e._UZ(6,"localize",40),e.qZA(),e.TgZ(7,"option",41),e._UZ(8,"localize",42),e.qZA(),e.TgZ(9,"option",43),e._UZ(10,"localize",44),e.qZA()()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngModel",t.level.type)("name","type"+t.levelNum)}}function wS(i,n){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function TS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",23)(1,"select",45),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.level.orgUnitGroupId=a)}),e._UZ(2,"option"),e.YNc(3,wS,2,2,"option",9),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.level.orgUnitGroupId)("name","group"+t.levelNum),e.xp6(2),e.Q6J("ngForOf",o.orgUnitGroups)}}function MS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",46),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(2);return e.KtG(l.configureAttributes(a))}),e.ALo(1,"localize"),e._UZ(2,"i",51),e.TgZ(3,"label",52),e._UZ(4,"localize",53),e.qZA()()}2&i&&e.Q6J("title",e.lcZ(1,1,"sync.attr.configureAttributes.helptext"))}function OS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",20)(1,"div")(2,"a",46),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(),l=a.$implicit,_=a.index,C=e.oxw(2);return e.KtG(C.removeLevel(l.levelNum,_))}),e.ALo(3,"localize"),e._UZ(4,"i",47),e.TgZ(5,"label",48),e._UZ(6,"localize",49),e.qZA()()(),e.TgZ(7,"div"),e.YNc(8,MS,5,3,"a",50),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("title",e.lcZ(3,2,"button.delete.helptext")),e.xp6(6),e.Q6J("ngIf",t.level.geoObjectType&&("ORG_UNITS"===t.level.type||"ALL"===t.level.type))}}function SS(i,n){1&i&&(e.TgZ(0,"label"),e._UZ(1,"localize",76),e.qZA())}function PS(i,n){1&i&&e._UZ(0,"localize",78)}function ES(i,n){if(1&i&&(e.TgZ(0,"label"),e.YNc(1,PS,1,0,"localize",77),e.qZA()),2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.xp6(1),e.Q6J("ngIf",!o.strategyHasTerms(t))}}function AS(i,n){if(1&i&&(e.TgZ(0,"option",69)(1,"label",79),e._uU(2),e.qZA()()),2&i){const t=n.$implicit;e.Q6J("ngValue",t.cgrAttr.name),e.xp6(2),e.Oqu(t.cgrAttr.label)}}function kS(i,n){if(1&i&&(e.TgZ(0,"label",79),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.info.cgrAttr.typeLabel)}}function IS(i,n){if(1&i&&(e.TgZ(0,"option",69),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngValue",t.type),e.xp6(1),e.hij(" ",t.label," ")}}function ZS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",68),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.attributeMappingStrategy=a)})("change",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onChangeMappingStrategy(a))}),e.YNc(1,IS,2,2,"option",70),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2).index;e.Q6J("ngModel",t.attributeMappingStrategy)("name","mappingStrategy"+o+t.info.cgrAttr.name),e.xp6(1),e.Q6J("ngForOf",t.info.attributeMappingStrategies)}}function NS(i,n){if(1&i&&(e.TgZ(0,"option",69),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngValue",t.type),e.xp6(1),e.hij(" ",t.label," ")}}function LS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",80)(1,"select",68),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.attributeMappingStrategy=a)})("change",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(4);return e.KtG(l.onChangeMappingStrategy(a))}),e.YNc(2,NS,2,2,"option",70),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2).index;e.xp6(1),e.Q6J("ngModel",t.attributeMappingStrategy)("name","mappingStrategy"+o+t.info.cgrAttr.name),e.xp6(1),e.Q6J("ngForOf",t.info.attributeMappingStrategies)}}function zS(i,n){1&i&&(e.TgZ(0,"td",81)(1,"label",79),e._UZ(2,"localize",82),e.qZA()())}function DS(i,n){if(1&i&&(e.TgZ(0,"option",69),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngValue",t.dhis2Id),e.xp6(1),e.hij(" ",t.name," ")}}hf.\u0275fac=function(n){return new(n||hf)(e.Y36(Ls))},hf.\u0275cmp=e.Xpm({type:hf,selectors:[["fhir-import-synchronization-config"]],inputs:{config:"config",fieldChange:"fieldChange"},outputs:{onError:"onError"},decls:8,vars:2,consts:[[1,"row-holder"],[1,"label-holder"],["key","synchronization.config.implementation"],[1,"holder"],["name","implementation","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label"),e._UZ(3,"localize",2),e.qZA()(),e.TgZ(4,"div",3)(5,"select",4),e.NdJ("ngModelChange",function(a){return t.config.configuration.implementation=a}),e._UZ(6,"option"),e.YNc(7,gS,2,2,"option",5),e.qZA()()()),2&n&&(e.xp6(5),e.Q6J("ngModel",t.config.configuration.implementation),e.xp6(2),e.Q6J("ngForOf",t.implementations))},dependencies:[T.sg,y.YN,y.Kr,y.EJ,y.JJ,y.Q7,y.On,Sn.l],encapsulation:2});const iy=function(){return{standalone:!0}};function RS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",84),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.dhis2Id=a)})("change",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(4);return e.KtG(l.onChangeDHIS2Attr(a))}),e.TgZ(1,"option",69),e._UZ(2,"localize",85),e.qZA(),e.YNc(3,DS,2,2,"option",70),e.qZA()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(4);e.Q6J("ngModel",t.dhis2Id)("ngModelOptions",e.DdM(4,iy)),e.xp6(1),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",o.getMappingStrategy(t).dhis2Attrs)}}function FS(i,n){1&i&&(e.TgZ(0,"label",79),e._UZ(1,"localize",86),e.qZA())}function US(i,n){if(1&i&&(e.TgZ(0,"td",63),e.YNc(1,RS,4,5,"select",83),e.YNc(2,FS,2,0,"label",71),e.qZA()),2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.xp6(1),e.Q6J("ngIf",o.getMappingStrategy(t).dhis2Attrs.length>0&&!o.strategyHasTerms(t)),e.xp6(1),e.Q6J("ngIf",0==o.getMappingStrategy(t).dhis2Attrs.length&&!o.strategyHasTerms(t))}}function qS(i,n){1&i&&e._UZ(0,"localize",95)}function JS(i,n){1&i&&e._UZ(0,"localize",96)}function jS(i,n){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.name," ")}}function BS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",97),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw(2).$implicit;return e.KtG(_.terms[l.code]=a)}),e.TgZ(1,"option",69),e._UZ(2,"localize",85),e.qZA(),e.YNc(3,jS,2,2,"option",9),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2).$implicit,a=e.oxw(4);e.Q6J("ngModel",o.terms[t.code])("ngModelOptions",e.DdM(4,iy)),e.xp6(1),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",a.getTermOptions(o.info,o.externalId))}}function GS(i,n){if(1&i&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function VS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",98),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw(2).$implicit;return e.KtG(_.terms[l.code]=a)}),e.TgZ(1,"option",69),e._UZ(2,"localize",85),e.qZA(),e.YNc(3,GS,2,2,"option",9),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2).$implicit,a=e.oxw(4);e.Q6J("ngModel",o.terms[t.code])("ngModelOptions",e.DdM(4,iy)),e.xp6(1),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",a.orgUnitGroups)}}function YS(i,n){if(1&i&&(e.TgZ(0,"table",88)(1,"thead")(2,"tr"),e._UZ(3,"th",20),e.TgZ(4,"th",20)(5,"label"),e._UZ(6,"localize",89),e.qZA()(),e._UZ(7,"th",20),e.TgZ(8,"th",20)(9,"label"),e.YNc(10,qS,1,0,"localize",90),e.YNc(11,JS,1,0,"localize",91),e.qZA()()()(),e.TgZ(12,"tbody")(13,"tr"),e._UZ(14,"td"),e.TgZ(15,"td")(16,"label",79),e._uU(17),e.qZA()(),e.TgZ(18,"td",92)(19,"label",79),e._UZ(20,"localize",82),e.qZA()(),e.TgZ(21,"td"),e.YNc(22,BS,4,5,"select",93),e.YNc(23,VS,4,5,"select",94),e.qZA()()()()),2&i){const t=n.$implicit,o=e.oxw(2).$implicit,a=e.oxw(4);e.xp6(10),e.Q6J("ngIf","net.geoprism.registry.etl.DHIS2OrgUnitAttributeMapping"!==a.getMappingStrategy(o).type),e.xp6(1),e.Q6J("ngIf","net.geoprism.registry.etl.DHIS2OrgUnitAttributeMapping"===a.getMappingStrategy(o).type),e.xp6(6),e.Oqu(t.label),e.xp6(5),e.Q6J("ngIf","net.geoprism.registry.etl.DHIS2OrgUnitAttributeMapping"!==a.getMappingStrategy(o).type),e.xp6(1),e.Q6J("ngIf","net.geoprism.registry.etl.DHIS2OrgUnitAttributeMapping"===a.getMappingStrategy(o).type)}}function HS(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,YS,24,5,"table",87),e.qZA()),2&i){const t=e.oxw().$implicit,o=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",o.getMappingStrategy(t).terms)}}function QS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",60)(2,"table",61)(3,"thead")(4,"tr"),e._UZ(5,"th",62),e.TgZ(6,"th",63)(7,"label"),e._UZ(8,"localize",64),e.qZA()(),e.TgZ(9,"th",63)(10,"label"),e._UZ(11,"localize",65),e.qZA()(),e.TgZ(12,"th",63),e.YNc(13,SS,2,0,"label",66),e.qZA(),e.TgZ(14,"th",63),e.YNc(15,ES,2,1,"label",66),e.qZA()()(),e.TgZ(16,"tbody")(17,"tr")(18,"td",62)(19,"i",67),e.NdJ("click",function(){const l=e.CHM(t).index,_=e.oxw(2).$implicit,C=e.oxw(2);return e.KtG(C.deleteMapping(_,l))}),e.qZA()(),e.TgZ(20,"td",63)(21,"select",68),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.cgrAttrName=a)})("change",function(a){const _=e.CHM(t).$implicit,C=e.oxw(2).$implicit,N=e.oxw(2);return e.KtG(N.mapCgrAttrEvent(a,C,_))}),e._UZ(22,"option",69),e.YNc(23,AS,3,2,"option",70),e.qZA()(),e.TgZ(24,"td",63),e.YNc(25,kS,2,1,"label",71),e.YNc(26,ZS,2,3,"select",72),e.qZA(),e.YNc(27,LS,3,3,"td",73),e.YNc(28,zS,3,0,"td",74),e.YNc(29,US,3,2,"td",75),e.qZA()()(),e.YNc(30,HS,2,1,"div",66),e.qZA()()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw(2),l=a.index,_=a.$implicit,C=e.oxw(2);e.xp6(13),e.Q6J("ngIf",t.info&&"term"===t.info.cgrAttr.type&&t.info.attributeMappingStrategies.length>1),e.xp6(2),e.Q6J("ngIf",t.info),e.xp6(6),e.Q6J("ngModel",t.cgrAttrName)("name","sourceAttrSelect"+l+"-"+o+(t.cgrAttrName?t.cgrAttrName:"")),e.xp6(1),e.Q6J("ngValue",null),e.xp6(1),e.Q6J("ngForOf",_.attrCfg.attrConfigInfos),e.xp6(2),e.Q6J("ngIf",t.info&&("term"===t.info.cgrAttr.type||t.info.attributeMappingStrategies.length<=1)),e.xp6(1),e.Q6J("ngIf",t.info&&"term"!==t.info.cgrAttr.type&&t.info.attributeMappingStrategies.length>1),e.xp6(1),e.Q6J("ngIf",t.info&&"term"===t.info.cgrAttr.type&&t.info.attributeMappingStrategies.length>1),e.xp6(1),e.Q6J("ngIf",t.info&&(t.info.attributeMappingStrategies.length<=1||"term"!==t.info.cgrAttr.type)&&t.info.cgrAttr.name),e.xp6(1),e.Q6J("ngIf",C.getMappingStrategy(t)),e.xp6(1),e.Q6J("ngIf",C.strategyHasTerms(t))}}function KS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",54)(1,"h4"),e._UZ(2,"localize",55),e.qZA(),e.TgZ(3,"table",56)(4,"colgroup"),e._UZ(5,"col",57)(6,"col",58),e.qZA(),e.TgZ(7,"tbody"),e.YNc(8,QS,31,12,"tr",59),e.TgZ(9,"tr")(10,"td",28)(11,"a",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.addNewMapping(a))}),e.ALo(12,"localize"),e.qZA()()()()()()}if(2&i){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.attrCfg.mappings),e.xp6(3),e.Q6J("title",e.lcZ(12,2,"sync.attr.attributes.add.tooltip"))}}function $S(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,vS,4,1,"td",30),e.YNc(2,xS,4,3,"td",31),e.YNc(3,CS,11,2,"td",31),e.YNc(4,TS,4,3,"td",32),e.YNc(5,OS,9,4,"td",31),e.YNc(6,KS,13,4,"td",33),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(2);e.Udp("background-color",!1===t.isAttributeEditor?"#F7F7F7":""),e.xp6(1),e.Q6J("ngIf",!1===t.isAttributeEditor),e.xp6(1),e.Q6J("ngIf",!1===t.isAttributeEditor),e.xp6(1),e.Q6J("ngIf",!1===t.isAttributeEditor),e.xp6(1),e.Q6J("ngIf",!1===t.isAttributeEditor&&o.orgUnitGroups.length>0),e.xp6(1),e.Q6J("ngIf",!1===t.isAttributeEditor),e.xp6(1),e.Q6J("ngIf",!0===t.isAttributeEditor)}}function WS(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"label"),e._UZ(3,"localize",15),e.qZA()(),e.TgZ(4,"div",11)(5,"div",16)(6,"table",17)(7,"thead")(8,"tr")(9,"th",18),e._UZ(10,"localize",19),e.qZA(),e.TgZ(11,"th",20),e._UZ(12,"localize",21),e.qZA(),e.TgZ(13,"th",20),e._UZ(14,"localize",22),e.qZA(),e.TgZ(15,"th",23),e._UZ(16,"localize",24),e.qZA(),e.TgZ(17,"th",25),e._UZ(18,"localize",26),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,$S,7,8,"tr",27),e.TgZ(21,"tr")(22,"td",28)(23,"a",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addLevel())}),e.ALo(24,"localize"),e.qZA()()()()()()()()}if(2&i){const t=e.oxw();e.xp6(20),e.Q6J("ngForOf",t.levelRows),e.xp6(3),e.Q6J("title",e.lcZ(24,2,"sync.levels.add.tooltip"))}}let a_="net.geoprism.registry.etl.DHIS2AttributeMapping";class ff{constructor(n,t){this.service=n,this.localizationService=t,this.message=null,this.cOrg=null,this.onError=new e.vpe,this.organizations=[],this.types=[],this.levelRows=[],this.orgUnitGroups=[]}ngOnInit(){if(null==this.config.configuration&&(this.config.configuration={levels:[],hierarchyCode:null,syncNonExistent:!1,preferredLocale:"defaultLocale"}),this.levelRows=[],null!=this.config.configuration.levels)for(let n=0;n<this.config.configuration.levels.length;++n)this.levelRows.push({level:this.config.configuration.levels[n],levelNum:n,isAttributeEditor:!1});else this.config.configuration.levels=[];null==this.config.configuration.preferredLocale&&(this.config.configuration.preferredLocale="defaultLocale"),null!=this.config.configuration.hierarchyCode&&this.service.getConfigForES(this.config.system,this.config.configuration.hierarchyCode).then(n=>{this.types=n.types,this.orgUnitGroups=n.orgUnitGroups}).catch(n=>{this.error(n)}),this.fieldChange.subscribe(()=>{this.clearMappingData()})}ngOnDestroy(){this.fieldChange.unsubscribe()}onChangeHierarchy(){this.clearMappingData()}stringify(n){return null==n?"null":JSON.stringify(n)}buildDefaultMappings(){return[{attributeMappingStrategy:a_,cgrAttrName:"displayLabel",externalId:null,dhis2Id:"name",dhis2AttrName:"name"},{attributeMappingStrategy:a_,cgrAttrName:"displayLabel",externalId:null,dhis2Id:"shortName",dhis2AttrName:"shortName"},{attributeMappingStrategy:a_,cgrAttrName:"code",dhis2Id:"code",externalId:null,dhis2AttrName:"code"},{attributeMappingStrategy:"net.geoprism.registry.etl.DHIS2StartDateAttributeMapping",cgrAttrName:"exists",externalId:null,dhis2Id:"openingDate",dhis2AttrName:"openingDate"},{attributeMappingStrategy:"net.geoprism.registry.etl.DHIS2EndDateAttributeMapping",cgrAttrName:"exists",externalId:null,dhis2Id:"closedDate",dhis2AttrName:"closedDate"}]}clearMappingData(){this.types=[],this.levelRows=[],this.config.configuration.levels=[],null!=this.config.configuration.hierarchyCode&&this.service.getConfigForES(this.config.system,this.config.configuration.hierarchyCode).then(t=>{this.types=t.types,this.orgUnitGroups=t.orgUnitGroups}).catch(t=>{this.error(t)});let n={type:null,geoObjectType:null,level:0,mappings:[],orgUnitGroupId:null};this.config.configuration.levels=[n],this.levelRows.push({level:n,levelNum:0,isAttributeEditor:!1})}onSelectLevelType(n){if("RELATIONSHIPS"===n.level.type){n.attrCfg&&(n.attrCfg.mappings=[]),n.level.mappings=[];let t=this.getEditorIndex();-1!==t&&this.levelRows.splice(t,1)}else if(n.attrCfg&&0===n.attrCfg.mappings.length){n.attrCfg.mappings=this.buildDefaultMappings(),n.level.mappings=n.attrCfg.mappings;let t=n.level.mappings.length;for(let o=0;o<t;++o){let a=n.level.mappings[o];n.attrCfg.attrConfigInfos.forEach(l=>{l.cgrAttr.name===a.cgrAttrName&&(a.info=l)})}}}deleteMapping(n,t){n.attrCfg.mappings.splice(t,1)}addNewMapping(n){n.attrCfg.mappings.push({attributeMappingStrategy:a_,cgrAttrName:null,dhis2AttrName:null,externalId:null,dhis2Id:null,terms:[]})}addLevel(){let n={type:null,geoObjectType:null,level:this.config.configuration.levels.length,mappings:[],orgUnitGroupId:null},t=this.config.configuration.levels.push(n);this.levelRows.push({level:n,levelNum:t-1,isAttributeEditor:!1})}removeLevel(n,t){if(n<this.config.configuration.levels.length){let o=this.getEditorIndex();o===t+1&&this.levelRows.splice(o,1),this.levelRows.splice(t,1);let a=0;for(let l=0;l<this.levelRows.length;++l){let _=this.levelRows[l];_.levelNum=a,_.isAttributeEditor||(a+=1)}this.config.configuration.levels.splice(n,1)}}getEditorIndex(){for(let n=0;n<this.levelRows.length;++n)if(this.levelRows[n].isAttributeEditor)return n;return-1}configureAttributes(n){let t=this.getEditorIndex();-1!==t&&(this.levelRows.splice(t,1),t===n.levelNum+1)||this.onSelectGeoObjectType(n.level.geoObjectType,n.levelNum,!1)}getTermOptions(n,t){let o=n.attributeMappingStrategies[0];for(let a=0;a<o.dhis2Attrs.length;++a){let l=o.dhis2Attrs[a];if(l.dhis2Id===t)return l.options}}onChangeDHIS2Attr(n){if(null==n.dhis2Id||""===n.dhis2Id)return null!=n.terms&&(n.terms={}),void(n.dhis2AttrName=null);n.terms={};let t=this.getMappingStrategy(n),o=t.dhis2Attrs.length;for(let a=0;a<o;++a)t.dhis2Attrs[a].dhis2Id===n.dhis2Id&&(n.externalId=t.dhis2Attrs[a].dhis2Id!==t.dhis2Attrs[a].name?t.dhis2Attrs[a].dhis2Id:null,n.dhis2AttrName=t.dhis2Attrs[a].name)}onSelectGeoObjectType(n,t,o=!0){if(""===n||null==n){let l=this.levelRows[t];l.attrCfg=null,l.level.mappings=[];let _=this.getEditorIndex();return void(-1!==_&&_===t+1&&this.levelRows.splice(_,1))}let a=this.levelRows[t].attrCfg;if(null!=a&&a.geoObjectTypeCode===n){let l=this.getEditorIndex();-1!==l&&l!==t+1&&(this.levelRows.splice(l,1),l<t&&(t-=1)),this.levelRows.splice(t+1,0,{isAttributeEditor:!0,attrCfg:a})}else this.service.getCustomAttrCfg(n,this.config.system).then(l=>{let _=this.getEditorIndex(),C=this.levelRows[t],N=C.level;null==N.mappings&&(N.mappings=[]),(0===N.mappings.length||o)&&(N.mappings=this.buildDefaultMappings());let F=N.mappings.length;for(let V=0;V<F;++V){let ue=N.mappings[V];l.forEach(ce=>{ce.cgrAttr.name===ue.cgrAttrName&&(ue.info=ce)}),N.mappings.forEach(ce=>{ce.dhis2AttrName&&ce.dhis2AttrName===ue.dhis2AttrName&&(ce.externalId?ue.dhis2Id=ce.externalId:ce.dhis2AttrName&&(ue.dhis2Id=ce.dhis2AttrName))})}C.attrCfg={geoObjectTypeCode:n,mappings:N.mappings,attrConfigInfos:l},-1!==_&&(_===t+1||l.length>0)&&(this.levelRows.splice(_,1),_<t&&(t-=1)),o||this.levelRows.splice(t+1,0,{isAttributeEditor:!0,attrCfg:C.attrCfg,level:C.level,levelNum:C.levelNum})}).catch(l=>{this.error(l)})}strategyHasTerms(n){let t=this.getMappingStrategy(n);if(null!=t)return null!=t.terms}getMappingStrategy(n){if(null==n.info)return null;if(1===n.info.attributeMappingStrategies.length)return n.info.attributeMappingStrategies[0];for(let t=0;t<n.info.attributeMappingStrategies.length;++t){let o=n.info.attributeMappingStrategies[t];if(o.type===n.attributeMappingStrategy)return o}return null}mapCgrAttrEvent(n,t,o){const a=n.target;this.mapCgrAttr(0==a.selectedIndex?null:t.attrCfg.attrConfigInfos[a.selectedIndex-1],o)}mapCgrAttr(n,t){if(null==n)return t.cgrAttrName=null,t.info=null,t.dhis2AttrName=null,t.externalId=null,t.terms=null,void(t.attributeMappingStrategy=null);t.cgrAttrName=n.cgrAttr.name,t.info=n,t.dhis2AttrName=null,t.externalId=null,t.dhis2Id=null,t.terms={},t.info.attributeMappingStrategies.length>0&&(t.attributeMappingStrategy=t.info.attributeMappingStrategies[0].type)}onChangeMappingStrategy(n){n.externalId=null;for(const t in n.terms)Object.prototype.hasOwnProperty.call(n.terms,t)&&(n.terms[t]=null)}error(n){this.onError.emit(n)}}function tP(i,n){if(1&i&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function nP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"label"),e._UZ(3,"localize",20),e._uU(4," ("),e._UZ(5,"convert-key-label",21),e._uU(6,") "),e.qZA()(),e.TgZ(7,"div",10)(8,"input",22),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(5),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("required","defaultLocale"===t.locale)}}function iP(i,n){if(1&i&&(e.TgZ(0,"option",23),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label)}}function oP(i,n){if(1&i&&(e.TgZ(0,"option",23),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.oid),e.xp6(1),e.Oqu(t.label)}}function rP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"label"),e._UZ(3,"localize",24),e.qZA()(),e.TgZ(4,"div",10)(5,"span",11)(6,"select",25),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.config.system=a)})("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onChangeExternalSystem())}),e._UZ(7,"option"),e.YNc(8,oP,2,2,"option",13),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.config.system)("disabled",null!=t.config.oid),e.xp6(2),e.Q6J("ngForOf",t.cOrg.systems)}}function aP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"dhis2-synchronization-config",26),e.NdJ("onError",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.error(a))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("config",t.config)("cOrg",t.cOrg)("fieldChange",t.fieldChange)}}function sP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"fhir-export-synchronization-config",31),e.NdJ("onError",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.error(a))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("config",t.config)("fieldChange",t.fieldChange)}}function lP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"fhir-import-synchronization-config",31),e.NdJ("onError",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.error(a))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("config",t.config)("fieldChange",t.fieldChange)}}function cP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",7)(2,"div",8)(3,"label"),e._uU(4,"Synchronization Type"),e.qZA()(),e.TgZ(5,"div",10)(6,"div",27)(7,"label",28)(8,"input",29),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.config.isImport=a)}),e.qZA(),e.TgZ(9,"span"),e._uU(10,"Export"),e.qZA()(),e.TgZ(11,"label",28)(12,"input",29),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.config.isImport=a)}),e.qZA(),e.TgZ(13,"span"),e._uU(14,"Import"),e.qZA()()()()(),e.YNc(15,sP,1,2,"fhir-export-synchronization-config",30),e.YNc(16,lP,1,2,"fhir-import-synchronization-config",30),e.qZA()}if(2&i){const t=e.oxw();e.xp6(8),e.Q6J("ngModel",t.config.isImport)("checked",!t.config.isImport)("value",!1),e.xp6(4),e.Q6J("ngModel",t.config.isImport)("checked",t.config.isImport)("value",!0),e.xp6(3),e.Q6J("ngIf",!0!==t.config.isImport),e.xp6(1),e.Q6J("ngIf",!0===t.config.isImport)}}ff.\u0275fac=function(n){return new(n||ff)(e.Y36(Ls),e.Y36(mo.o))},ff.\u0275cmp=e.Xpm({type:ff,selectors:[["dhis2-synchronization-config"]],inputs:{config:"config",cOrg:"cOrg",fieldChange:"fieldChange"},outputs:{onError:"onError"},decls:17,vars:8,consts:[["class","row-holder",4,"ngIf"],[1,"row-holder"],[1,"label-holder"],["key","sync.nonExistent"],[1,"holder",2,"margin-top","9px"],[3,"value","valueChange"],[1,"label-holder",3,"title"],["key","sync.preferredLocale"],["type","text","name","preferredLocale","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["key","synchronization.config.hierarchy"],[1,"holder"],[1,"select"],["type","text","name","hierarchy","required","",3,"ngModel","disabled","ngModelChange","change"],[3,"value"],["key","synchronization.config.units"],[1,"list-table-wrapper"],["id","manage-systems-table",1,"list-table","table","table-bordered"],[2,"width","3%"],["key","settings.external.synchronization.level.label"],[2,"width","25%"],["key","settings.external.synchronization.geoobjecttype.label"],["key","settings.external.synchronization.dhis2.synch.type.label"],[2,"width","17%"],["key","synchronization.config.orgUnitGroup"],[2,"width","25%","text-align","center"],["key","settings.external.synchronization.actions.label"],[3,"background-color",4,"ngFor","ngForOf"],[1,"button-column"],[1,"fa","fa-plus",3,"title","click"],["style","width:3%",4,"ngIf"],["style","width:25%",4,"ngIf"],["style","width:17%",4,"ngIf"],["colspan","5",4,"ngIf"],[2,"padding","10px 0","margin","0"],["key","sync.level.label"],["type","text","required","",3,"ngModel","name","ngModelChange","change"],["type","text","required","",3,"ngModel","name","change","ngModelChange"],["value","ORG_UNITS"],["value","RELATIONSHIPS"],["key","synchronization.config.relationships"],["value","ALL"],["key","synchronization.config.all"],["value","NONE"],["key","synchronization.config.none"],["type","text",3,"ngModel","name","ngModelChange"],[2,"padding","10px",3,"title","click"],[1,"fa","fa-trash-o","ico-remove"],[2,"cursor","pointer","margin-left","9px"],["key","sync.level.delete"],["style","padding: 10px;",3,"title","click",4,"ngIf"],[1,"fa","fa-edit"],[2,"cursor","pointer","margin-left","3px"],["key","sync.attr.attributes.editButton"],["colspan","5"],["key","sync.attr.attributes.title"],[1,"table","table-bordered","table-striped",2,"margin-left","80px","width","calc(100% - 80px)"],["width","5%"],["width","95%"],[4,"ngFor","ngForOf"],["colspan","2",1,"row-holder"],[2,"width","80%","margin-top","15px","margin-bottom","10px"],[2,"width","5%"],[2,"width","23%"],["key","sync.attr.sourceAttribute"],["key","sync.attr.type"],[4,"ngIf"],[1,"fa","fa-times",3,"click"],[2,"width","95%",3,"ngModel","name","ngModelChange","change"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["style","color:#999;",4,"ngIf"],["style","width:95%",3,"ngModel","name","ngModelChange","change",4,"ngIf"],["style","margin-right:20px; width:23%",4,"ngIf"],["style","float:right; margin-right:20px; width:23%",4,"ngIf"],["style","width:23%",4,"ngIf"],["key","sync.attr.targetTypeHeader"],["key","sync.attr.targetAttribute",4,"ngIf"],["key","sync.attr.targetAttribute"],[2,"color","#999"],[2,"margin-right","20px","width","23%"],[2,"float","right","margin-right","20px","width","23%"],["key","sync.attr.to"],[3,"ngModel","ngModelOptions","ngModelChange","change",4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange","change"],["key","sync.notMapped"],["key","sync.noValid"],["class","row","style","width:80%; margin-left:80px;",4,"ngFor","ngForOf"],[1,"row",2,"width","80%","margin-left","80px"],["key","sync.attr.term.cgrTerm"],["key","sync.attr.term.dhis2Option",4,"ngIf"],["key","sync.attr.term.targetOrgUnitGroup",4,"ngIf"],[2,"float","right","margin-right","20px"],[3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["type","text",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["key","sync.attr.term.dhis2Option"],["key","sync.attr.term.targetOrgUnitGroup"],[3,"ngModel","ngModelOptions","ngModelChange"],["type","text",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div"),e.YNc(1,mS,9,3,"div",0),e.TgZ(2,"div",1)(3,"div",2)(4,"label"),e._UZ(5,"localize",3),e.qZA()(),e.TgZ(6,"div",4)(7,"boolean-field",5),e.NdJ("valueChange",function(a){return t.config.configuration.syncNonExistent=a}),e.qZA()()(),e.TgZ(8,"div",1)(9,"div",6),e.ALo(10,"localize"),e.TgZ(11,"label"),e._UZ(12,"localize",7),e.qZA()(),e.TgZ(13,"div",4)(14,"select",8),e.NdJ("ngModelChange",function(a){return t.config.configuration.preferredLocale=a}),e.YNc(15,yS,2,2,"option",9),e.qZA()()(),e.YNc(16,WS,25,4,"div",0),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.cOrg),e.xp6(6),e.Q6J("value",t.config.configuration.syncNonExistent),e.xp6(2),e.Q6J("title",e.lcZ(10,6,"sync.preferredLocale.tooltip")),e.xp6(5),e.Q6J("ngModel",t.config.configuration.preferredLocale),e.xp6(1),e.Q6J("ngForOf",t.localizationService.getLocales()),e.xp6(1),e.Q6J("ngIf",null!=t.config.configuration.hierarchyCode))},dependencies:[T.sg,T.O5,y.YN,y.Kr,y.EJ,y.JJ,y.Q7,y.On,Sn.l,rl.M,ia.F],encapsulation:2});class zd{constructor(n,t,o){this.service=n,this.lService=t,this.bsModalRef=o,this.message=null,this.config={organization:null,system:null,hierarchy:null,isImport:!1,label:this.lService.create(),configuration:{}},this.organizations=[],this.cOrg=null,this.cSystem=null}ngOnInit(){this.onSuccess=new pn.x,this.fieldChange=new pn.x}ngOnDestroy(){this.onSuccess.unsubscribe(),this.fieldChange.unsubscribe()}init(n,t){if(this.organizations=t,null!=n){this.config=n;let o=this.organizations.findIndex(l=>l.code===this.config.organization);-1!==o&&(this.cOrg=this.organizations[o]);let a=this.cOrg.systems.findIndex(l=>l.oid===this.config.system);-1!==a&&(this.cSystem=this.cOrg.systems[a])}}handleFieldChange(n){this.fieldChange.next(n)}onOrganizationSelected(){let n=this.organizations.findIndex(t=>t.code===this.config.organization);this.cOrg=-1!==n?this.organizations[n]:null,this.cSystem=null,this.handleFieldChange("organization")}onChangeExternalSystem(){let n=this.cOrg.systems.findIndex(t=>t.oid===this.config.system);this.cSystem=-1!==n?this.cOrg.systems[n]:null,this.handleFieldChange("system")}onSubmit(){this.service.apply(this.config).then(n=>{this.onSuccess.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}cancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function uP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",15)(1,"td",16)(2,"a",17),e._uU(3),e.qZA()(),e.TgZ(4,"td",18)(5,"button",13),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onView(l))}),e._UZ(6,"localize",19),e.qZA(),e.TgZ(7,"button",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onEdit(l))}),e._UZ(8,"localize",21),e.qZA(),e.TgZ(9,"button",22),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onRemove(l))}),e._UZ(10,"localize",23),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Q6J("routerLink","/registry/synchronization-config/"+t.oid),e.xp6(1),e.hij(" ",t.label.localizedValue," ")}}zd.\u0275fac=function(n){return new(n||zd)(e.Y36(Ls),e.Y36(mo.o),e.Y36(Ln.UZ))},zd.\u0275cmp=e.Xpm({type:zd,selectors:[["synchronization-config-modal"]],decls:29,vars:15,consts:[[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"text-center"],["key","synchronization.config.title"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],["class","row-holder",4,"ngFor","ngForOf"],[1,"row-holder"],[1,"label-holder"],["key","synchronization.config.organization"],[1,"holder"],[1,"select"],["type","text","name","organization","required","",3,"ngModel","disabled","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["class","row-holder",4,"ngIf"],[4,"ngIf"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"value","click"],["type","submit",1,"btn","btn-primary",3,"value","disabled"],["role","alert",1,"alert","alert-danger"],["key","synchronization.config.label"],[3,"key"],["type","text",1,"form-control",3,"ngModel","name","required","ngModelChange"],[3,"value"],["key","synchronization.config.system"],["type","text","name","system","required","",3,"ngModel","disabled","ngModelChange","change"],[3,"config","cOrg","fieldChange","onError"],[1,"col-md-3",2,"display","flex","align-items","center"],[1,"radio-inline","radio"],["type","radio","name","isImport",1,"inline-radio-input",2,"height","auto",3,"ngModel","checked","value","ngModelChange"],[3,"config","fieldChange","onError",4,"ngIf"],[3,"config","fieldChange","onError"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",0),e.YNc(1,tP,2,1,"div",1),e.TgZ(2,"div",2)(3,"h2"),e._UZ(4,"localize",3),e.qZA()(),e.TgZ(5,"form",4,5),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(6);return e.KtG(l.valid&&t.onSubmit())}),e.TgZ(7,"fieldset"),e.YNc(8,nP,9,4,"div",6),e.TgZ(9,"div",7)(10,"div",8)(11,"label"),e._UZ(12,"localize",9),e.qZA()(),e.TgZ(13,"div",10)(14,"span",11)(15,"select",12),e.NdJ("ngModelChange",function(l){return t.config.organization=l})("change",function(){return t.onOrganizationSelected()}),e._UZ(16,"option"),e.YNc(17,iP,2,2,"option",13),e.qZA()()()(),e.YNc(18,rP,9,3,"div",14),e.YNc(19,aP,2,3,"div",15),e.YNc(20,cP,17,8,"div",15),e.TgZ(21,"div",7),e._UZ(22,"div",8),e.TgZ(23,"div",10)(24,"div",16)(25,"input",17),e.NdJ("click",function(){return t.cancel()}),e.ALo(26,"localize"),e.qZA(),e._UZ(27,"input",18),e.ALo(28,"localize"),e.qZA()()()()()()}if(2&n){const o=e.MAs(6);e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(7),e.Q6J("ngForOf",t.config.label.localeValues),e.xp6(7),e.Q6J("ngModel",t.config.organization)("disabled",null!=t.config.oid),e.xp6(2),e.Q6J("ngForOf",t.organizations),e.xp6(1),e.Q6J("ngIf",null!=t.cOrg),e.xp6(1),e.Q6J("ngIf",null!=t.cSystem&&"DHIS2ExternalSystem"===t.cSystem.type),e.xp6(1),e.Q6J("ngIf",null!=t.cSystem&&"FhirExternalSystem"===t.cSystem.type),e.xp6(5),e.Q6J("value",e.lcZ(26,11,"dataset.cancel")),e.xp6(2),e.Q6J("value",e.lcZ(28,13,"dataset.submit"))("disabled",!o.valid)}},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y._,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j,df,hf,ff,ia.F],encapsulation:2});const pP=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};class gf{constructor(n,t,o,a){this.service=n,this.lService=t,this.router=o,this.modalService=a,this.message=null,this.page={resultSet:[],count:0,pageNumber:1,pageSize:20}}ngOnInit(){this.onPageChange(1)}onPageChange(n){this.service.getPage(n,this.page.pageSize).then(t=>{this.page=t}).catch(t=>{this.error(t)})}create(){this.service.edit(null).then(n=>{let t=this.modalService.show(zd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.init(null,n.orgs),t.content.onSuccess.subscribe(()=>{this.onPageChange(this.page.pageNumber)})})}onEdit(n){this.service.edit(n.oid).then(t=>{let o=this.modalService.show(zd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});o.content.init(t.config,t.orgs),o.content.onSuccess.subscribe(()=>{this.onPageChange(this.page.pageNumber)})})}onRemove(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.lService.decode("confirm.modal.verify.delete")+" ["+n.label.localizedValue+"]",this.bsModalRef.content.submitText=this.lService.decode("modal.button.delete"),this.bsModalRef.content.type=ec.Qi.danger,this.bsModalRef.content.onConfirm.subscribe(()=>{this.service.remove(n.oid).then(()=>{this.onPageChange(this.page.pageNumber)}).catch(t=>{this.error(t)})})}onView(n){this.router.navigate(["/registry/synchronization-config/",n.oid])}error(n){this.message=Zt.qL.getMessageFromError(n)}}gf.\u0275fac=function(n){return new(n||gf)(e.Y36(Ls),e.Y36(mo.o),e.Y36(w.F0),e.Y36(Ln.tT))},gf.\u0275cmp=e.Xpm({type:gf,selectors:[["synchronization-config-manager"]],decls:22,vars:8,consts:[[1,"new-admin-design-main"],[1,"container-fluid"],[1,"heading"],["key","synchronization.config.manager"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"table"],[2,"width","70%"],["key","synchronization.config.label"],["class","clickable",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"row",2,"margin-top","30px","margin-bottom","30px"],[1,"col-md-6"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","hierarchy.management.button.create"],[1,"clickable"],[2,"width","70%","vertical-align","middle"],["routerLinkActive","active",3,"routerLink"],[2,"width","30%","text-align","right"],["key","modal.button.view"],["type","submit","role","button",1,"btn","btn-default",2,"margin-left","5px",3,"click"],["key","modal.button.edit"],["type","submit","role","button",1,"btn","btn-danger",2,"margin-left","5px",3,"click"],["key","modal.button.delete"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2)(5,"h2"),e._UZ(6,"localize",3),e.qZA()(),e.TgZ(7,"div",4)(8,"div",5)(9,"table",6)(10,"thead")(11,"tr")(12,"th",7),e._UZ(13,"localize",8),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,uP,11,2,"tr",9),e.ALo(16,"paginate"),e.qZA()(),e.TgZ(17,"pagination-controls",10),e.NdJ("pageChange",function(a){return t.onPageChange(a)}),e.qZA(),e.TgZ(18,"div",11)(19,"div",12)(20,"button",13),e.NdJ("click",function(){return t.create()}),e._UZ(21,"localize",14),e.qZA()()()()()()()),2&n&&(e.xp6(15),e.Q6J("ngForOf",e.xi3(16,1,t.page.resultSet,e.kEZ(4,pP,t.page.pageSize,t.page.pageNumber,t.page.count))))},dependencies:[T.sg,w.rH,w.Od,U.LS,Sn.l,Da.N,ba.C,U._s],encapsulation:2});var dP=v(98012);function hP(i,n){if(1&i&&(e.TgZ(0,"div",5),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function fP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onGenerateFile())}),e.ALo(1,"localize"),e._UZ(2,"localize",26),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"synchronization.config.run"))}function gP(i,n){1&i&&e._UZ(0,"localize",27)}function _P(i,n){1&i&&e._UZ(0,"localize",37)}function mP(i,n){1&i&&e._UZ(0,"localize",38)}function yP(i,n){1&i&&e._UZ(0,"localize",39)}function vP(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",9),e._UZ(2,"localize",29),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",31),e.YNc(7,gP,1,0,"localize",33),e.YNc(8,_P,1,0,"localize",34),e.YNc(9,mP,1,0,"localize",35),e.YNc(10,yP,1,0,"localize",36),e.qZA()()),2&i){const t=n.$implicit,o=n.index;e.xp6(3),e.hij(" ",o+1," "),e.xp6(2),e.hij(" ",t.geoObjectType," "),e.xp6(2),e.Q6J("ngIf","ORG_UNITS"===t.type),e.xp6(1),e.Q6J("ngIf","RELATIONSHIPS"===t.type),e.xp6(1),e.Q6J("ngIf","ALL"===t.type),e.xp6(1),e.Q6J("ngIf","NONE"===t.type)}}function bP(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",6)(2,"h4"),e._UZ(3,"localize",27),e.qZA(),e.TgZ(4,"table",28)(5,"thead")(6,"tr")(7,"th"),e._UZ(8,"localize",29),e.qZA(),e.TgZ(9,"th"),e._UZ(10,"localize",30),e.qZA(),e.TgZ(11,"th",31),e._UZ(12,"localize",32),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,vP,11,6,"tr",23),e.qZA()()()()),2&i){const t=e.oxw(2);e.xp6(14),e.Q6J("ngForOf",t.config.configuration.levels)}}function xP(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",9),e._UZ(2,"localize",29),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",31),e._uU(7),e.qZA()()),2&i){const t=n.$implicit,o=n.index;e.xp6(3),e.hij(" ",o+1," "),e.xp6(2),e.hij(" ",t.typeLabel," "),e.xp6(2),e.hij(" ",t.forDate," ")}}function CP(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",6)(2,"h4"),e._UZ(3,"localize",27),e.qZA(),e.TgZ(4,"table",28)(5,"thead")(6,"tr")(7,"th"),e._UZ(8,"localize",29),e.qZA(),e.TgZ(9,"th"),e._UZ(10,"localize",40),e.qZA(),e.TgZ(11,"th",31),e._UZ(12,"localize",41),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,xP,8,3,"tr",23),e.qZA()()()()),2&i){const t=e.oxw(2);e.xp6(14),e.Q6J("ngForOf",t.config.configuration.levels)}}function wP(i,n){if(1&i&&(e.TgZ(0,"span",45),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.exception.message," ")}}function TP(i,n){1&i&&e._UZ(0,"localize",55)}function MP(i,n){1&i&&e._UZ(0,"localize",56)}function OP(i,n){if(1&i&&(e.TgZ(0,"span",45),e.YNc(1,TP,1,0,"localize",53),e.YNc(2,MP,1,0,"localize",54),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","FAILURE"===t.status),e.xp6(1),e.Q6J("ngIf","WARNING"===t.status)}}function SP(i,n){if(1&i&&e._UZ(0,"step-indicator",57),2&i){const t=e.oxw().$implicit;e.Q6J("steps",t.stepConfig)}}function PP(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",9)(2,"div",42),e._UZ(3,"i",43),e.TgZ(4,"p",44)(5,"span",45),e._uU(6),e.qZA(),e.TgZ(7,"span",45),e._uU(8),e.qZA(),e.TgZ(9,"span",45),e._uU(10),e.qZA(),e.YNc(11,wP,2,1,"span",46),e.YNc(12,OP,3,2,"span",46),e.qZA(),e.YNc(13,SP,1,1,"step-indicator",47),e.qZA()(),e.TgZ(14,"td",48)(15,"div",49)(16,"a",50)(17,"button",51),e._UZ(18,"localize",52),e.qZA()()()()()),2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.hij(" ",t.fileName," "),e.xp6(2),e.hij(" ",t.createDate," "),e.xp6(2),e.hij(" ",o.formatJobStatus(t)," "),e.xp6(1),e.Q6J("ngIf",null!=t.exception&&""!=t.exception.message&&"java.lang.RuntimeException"!=t.exception.type),e.xp6(1),e.Q6J("ngIf",null==t.exception||""==t.exception.message),e.xp6(1),e.Q6J("ngIf","SUCCESS"!==t.status&&"FAILURE"!==t.status&&"CANCELED"!==t.status&&"WARNING"!==t.status),e.xp6(3),e.Q6J("routerLink","/registry/sync/details/"+o.config.oid+"/"+t.historyId)}}function EP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",58)(1,"pagination-controls",59),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onPageChange(a))}),e.qZA()()}}const AP=function(i,n){return{"fa-long-arrow-right":i,"fa-long-arrow-left":n}},kP=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};function IP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",3)(2,"div",6)(3,"h3"),e._uU(4),e.qZA()()(),e.TgZ(5,"div",7)(6,"div",3)(7,"div",8)(8,"label",9),e._uU(9,"CGR"),e.qZA(),e._UZ(10,"i",10),e.TgZ(11,"label",9),e._uU(12),e.qZA()(),e.TgZ(13,"div",11)(14,"div",12)(15,"form")(16,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onRun())}),e.ALo(17,"localize"),e._UZ(18,"localize",14),e.qZA(),e.YNc(19,fP,3,3,"button",15),e.qZA()()()(),e.YNc(20,bP,15,1,"div",16),e.YNc(21,CP,15,1,"div",16),e.TgZ(22,"div",3)(23,"div",17)(24,"ul",18)(25,"div",19)(26,"table",20)(27,"thead")(28,"tr",21)(29,"th",9),e._UZ(30,"localize",22),e.qZA()()(),e.TgZ(31,"tbody"),e.YNc(32,PP,19,7,"tr",23),e.ALo(33,"paginate"),e.qZA()(),e.YNc(34,EP,2,0,"div",24),e.qZA()()()()()()}if(2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.config.label.localizedValue),e.xp6(6),e.Q6J("ngClass",e.WLB(14,AP,!t.config.isImport,t.config.isImport)),e.xp6(2),e.Oqu(t.config.systemLabel),e.xp6(4),e.Q6J("title",e.lcZ(17,9,"synchronization.config.run")),e.xp6(3),e.Q6J("ngIf",null!=t.config&&"FhirExternalSystem"===t.config.type&&!t.config.isImport),e.xp6(1),e.Q6J("ngIf",null!=t.config&&"DHIS2ExternalSystem"===t.config.type),e.xp6(1),e.Q6J("ngIf",null!=t.config&&"FhirExternalSystem"===t.config.type&&!t.config.isImport),e.xp6(11),e.Q6J("ngForOf",e.xi3(33,11,t.page.resultSet,e.kEZ(17,kP,t.page.pageSize,t.page.pageNumber,t.page.count))),e.xp6(2),e.Q6J("ngIf",t.page.resultSet.length>0)}}class _f{constructor(n,t,o){this.service=n,this.lService=t,this.route=o,this.message=null,this.config=null,this.page={pageSize:10,pageNumber:1,count:1,resultSet:[]},this.subscription=null}ngOnInit(){const n=this.route.snapshot.paramMap.get("oid");this.service.get(n).then(o=>{this.config=o,this.onPageChange(1)});let t=md.buildBaseUrl();this.notifier=Ip(t+"/websocket/notify"),this.subscription=this.notifier.subscribe(o=>{"DATA_EXPORT_JOB_CHANGE"===o.type&&this.onPageChange(this.page.pageNumber)})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe(),null!=this.notifier&&this.notifier.complete()}onRun(){this.message=null,this.service.run(this.config.oid).then(()=>{this.onPageChange(this.page.pageNumber)}).catch(n=>{this.error(n)})}onGenerateFile(){window.open(pt.N.apiUrl+"/api/synchronization-config/generate-file?oid="+encodeURIComponent(this.config.oid))}onPageChange(n){null!=this.config&&(this.message=null,this.service.getJobs(this.config.oid,n,this.page.pageSize).then(t=>{this.formatStepConfig(t),this.page=t}).catch(t=>{this.error(t)}))}formatJobStatus(n){return this.lService.decode("FEEDBACK"===n.status?"etl.JobStatus.FEEDBACK":"RUNNING"===n.status||"NEW"===n.status?"etl.JobStatus.RUNNING":"QUEUED"===n.status?"etl.JobStatus.QUEUED":"SUCCESS"===n.status?"etl.JobStatus.SUCCESS":"CANCELED"===n.status?"etl.JobStatus.CANCELED":"FAILURE"===n.status?"etl.JobStatus.ERROR":"WARNING"===n.status?"etl.JobStatus.WARNING":"etl.JobStatus.RUNNING")}formatStepConfig(n){n.resultSet.forEach(t=>{const o=[{label:this.lService.decode("synchronization.step.Queued"),status:"NEW"===t.stage?this.getJobStatus(t):this.getCompletedStatus(t.stage,"NEW")},{label:this.lService.decode("synchronization.step.Connecting"),status:"CONNECTING"===t.stage||"CONNECTION_FAILED"===t.stage?this.getJobStatus(t):this.getCompletedStatus(t.stage,"CONNECTION_FAILED")}],a=this.config.isImport?"Importing":this.lService.decode("synchronization.step.DatabaseExport");o.push({label:a,status:"EXPORT"===t.stage||"EXPORT_RESOLVE"===t.stage||"RESUME_EXPORT"===t.stage?this.getJobStatus(t):""}),t.stepConfig={steps:o}})}getCompletedStatus(n,t){let o=["CONNECTING","CONNECTION_FAILED","EXPORT","EXPORT_RESOLVE","RESUME_EXPORT"],a=o.indexOf(n);return o.indexOf(t)<a?"COMPLETE":""}getJobStatus(n){return"QUEUED"===n.status||"RUNNING"===n.status?"WORKING":"FEEDBACK"===n.status||"FAILURE"===n.status?"STUCK":""}error(n){this.message=dP.q.getMessageFromError(n)}}function ZP(i,n){if(1&i&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function NP(i,n){if(1&i&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e._UZ(3,"i",11),e.TgZ(4,"p",12)(5,"span",13),e._UZ(6,"localize",14),e._uU(7),e.qZA(),e.TgZ(8,"span",13),e._UZ(9,"localize",15),e._uU(10),e.qZA()()()(),e.TgZ(11,"div",16)(12,"div")(13,"h5")(14,"b"),e._uU(15),e._UZ(16,"localize",17),e._uU(17),e._UZ(18,"localize",18),e.qZA()(),e.TgZ(19,"h5"),e._uU(20),e._UZ(21,"localize",19),e.qZA()()()()),2&i){const t=e.oxw();e.xp6(7),e.hij(" ",t.job.author," "),e.xp6(3),e.hij(" ",t.job.createDate," "),e.xp6(5),e.hij("",t.job.exportedRecords," "),e.xp6(2),e.hij(" ",t.job.workTotal," "),e.xp6(3),e.hij("",t.job.workTotal-t.job.exportedRecords," ")}}function LP(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",32),e._uU(2,"\xa0"),e._UZ(3,"localize",33),e.qZA())}function zP(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1,"Resource"),e.qZA())}function DP(i,n){1&i&&(e.TgZ(0,"th",25),e._UZ(1,"localize",34),e.qZA())}function RP(i,n){1&i&&(e.TgZ(0,"th",25),e._UZ(1,"localize",35),e.qZA())}function FP(i,n){if(1&i&&(e.TgZ(0,"td",36)(1,"p"),e._uU(2),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.rowNum)}}function UP(i,n){1&i&&e._UZ(0,"localize",40)}function qP(i,n){1&i&&e._UZ(0,"localize",41)}function JP(i,n){if(1&i&&(e.TgZ(0,"td",36)(1,"p"),e.YNc(2,UP,1,0,"localize",38),e.YNc(3,qP,1,0,"localize",39),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngIf","ERROR"===t.type),e.xp6(1),e.Q6J("ngIf","WARNING"===t.type)}}function jP(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",36)(2,"p"),e._uU(3),e.qZA()(),e.TgZ(4,"td",36)(5,"p"),e._uU(6),e.qZA()(),e.YNc(7,FP,3,1,"td",37),e.YNc(8,JP,4,2,"td",37),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(3),e.Oqu(t.code),e.xp6(3),e.Oqu(t.message),e.xp6(1),e.Q6J("ngIf",null==o.config||!o.config.isImport),e.xp6(1),e.Q6J("ngIf",null==o.config||!o.config.isImport)}}function BP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",30)(1,"pagination-controls",42),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.onPageChange(a))}),e.qZA()()}}_f.\u0275fac=function(n){return new(n||_f)(e.Y36(Ls),e.Y36(mo.o),e.Y36(w.gz))},_f.\u0275cmp=e.Xpm({type:_f,selectors:[["synchronization-config"]],decls:7,vars:2,consts:[[1,"new-admin-design-main"],[1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"row"],["class","col-md-12",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-12"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[1,"col-md-8"],[2,"vertical-align","middle"],["aria-hidden","true",1,"fa",2,"font-size","23px","padding","0 7px","vertical-align","middle","color","#bdbdbd","margin-bottom","4px",3,"ngClass"],[1,"col-md-4"],[1,"form-group","text-right",2,"margin","0"],["type","submit","role","button",1,"btn","btn-primary",2,"margin-left","15px",3,"title","click"],["key","synchronization.config.run"],["type","submit","style","margin-left: 15px;","class","btn btn-secondary","role","button",3,"title","click",4,"ngIf"],["class","row",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"solid-table-wrapper"],[1,"table","table-striped"],[2,"height","56px"],["key","masterlist.jobs"],[4,"ngFor","ngForOf"],["class","solid-table-footer",4,"ngIf"],["type","submit","role","button",1,"btn","btn-secondary",2,"margin-left","15px",3,"title","click"],["key","synchronization.config.generateBundle"],["key","synchronization.config.units"],[1,"table"],["key","settings.external.synchronization.level.label"],["key","settings.external.synchronization.geoobjecttype.label"],[2,"text-align","right"],["key","settings.external.synchronization.dhis2.synch.type.label"],["key","synchronization.config.units",4,"ngIf"],["key","synchronization.config.relationships",4,"ngIf"],["key","synchronization.config.all",4,"ngIf"],["key","synchronization.config.none",4,"ngIf"],["key","synchronization.config.relationships"],["key","synchronization.config.all"],["key","synchronization.config.none"],["key","masterlist.field"],["key","masterlist.forDate"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","40px"],[2,"padding-left","60px"],[2,"display","block"],["style","display: block;",4,"ngIf"],[3,"steps",4,"ngIf"],[2,"text-align","right","vertical-align","middle"],[1,"button-holder",2,"float","right"],["routerLinkActive","active",3,"routerLink"],["role","button",1,"btn","btn-primary"],["key","scheduledjobs.detail.button"],["key","etl.JobStatus.ERROR.description",4,"ngIf"],["key","etl.JobStatus.WARNING.description",4,"ngIf"],["key","etl.JobStatus.ERROR.description"],["key","etl.JobStatus.WARNING.description"],[3,"steps"],[1,"solid-table-footer"],[3,"pageChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,hP,2,1,"div",2),e.TgZ(5,"div",3),e.YNc(6,IP,35,21,"div",4),e.qZA()()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(2),e.Q6J("ngIf",null!=t.config))},dependencies:[T.mk,T.sg,T.O5,w.rH,w.Od,y._Y,y.JL,y.F,U.LS,Sn.l,Da.N,ba.C,Rp,U._s,ia.F],encapsulation:2});const GP=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};function VP(i,n){if(1&i&&(e.TgZ(0,"div",22)(1,"ul",23)(2,"table",24)(3,"thead")(4,"tr")(5,"th",25),e.YNc(6,LP,4,0,"span",26),e.YNc(7,zP,2,0,"span",26),e.qZA(),e.TgZ(8,"th",25),e._UZ(9,"localize",27),e.qZA(),e.YNc(10,DP,2,0,"th",28),e.YNc(11,RP,2,0,"th",28),e.qZA()(),e.TgZ(12,"tbody"),e.YNc(13,jP,9,4,"tr",29),e.ALo(14,"paginate"),e.qZA()(),e.TgZ(15,"div",30),e.YNc(16,BP,2,0,"div",31),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(6),e.Q6J("ngIf",null==t.config||!t.config.isImport),e.xp6(1),e.Q6J("ngIf",null!=t.config&&t.config.isImport),e.xp6(3),e.Q6J("ngIf",null==t.config||!t.config.isImport),e.xp6(1),e.Q6J("ngIf",null==t.config||!t.config.isImport),e.xp6(2),e.Q6J("ngForOf",e.xi3(14,6,t.page.resultSet,e.kEZ(9,GP,t.page.pageSize,t.page.pageNumber,t.page.count))),e.xp6(3),e.Q6J("ngIf",t.page.resultSet.length>0)}}function YP(i,n){if(1&i&&(e.TgZ(0,"div",20),e.YNc(1,VP,17,13,"div",21),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.job)}}class mf{constructor(n,t,o,a){this.configService=n,this.service=t,this.route=o,this.ioService=a,this.message=null,this.historyId="",this.config=null,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]}}ngOnInit(){this.historyId=this.route.snapshot.params.oid;const n=this.route.snapshot.paramMap.get("config");this.configService.get(n).then(t=>{this.config=t,this.onPageChange(1)})}ngOnDestroy(){}formatAffectedRows(n){return n.replace(/,/g,", ")}formatValidationResolve(n){return JSON.stringify(n)}onPageChange(n){this.message=null,this.service.getExportDetails(this.historyId,this.page.pageSize,n).then(t=>{this.job=t,this.page=this.job.exportErrors,t.exception&&t.exception.type&&-1===t.exception.type.indexOf("ExportJobHasErrors")&&this.error(t.exception)}).catch(t=>{this.error(t)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}mf.\u0275fac=function(n){return new(n||mf)(e.Y36(Ls),e.Y36(Zi),e.Y36(w.gz),e.Y36(pr))},mf.\u0275cmp=e.Xpm({type:mf,selectors:[["sync-details"]],decls:10,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","scheduledjobs.details.title"],["class","row","style","background: #F4F4F4;\n                                border-radius: 15px;\n                                margin-bottom: 20px;\n                                margin-top: 20px;\n                                padding: 10px;",4,"ngIf"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"background","#F4F4F4","border-radius","15px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-4","order-md-1"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","scheduledjobs.job.uploaded.by.label"],["key","scheduledjobs.job.started.label"],[1,"col-md-3","order-md-1"],["key","scheduledjobs.job.imported.out.of.label"],["key","scheduledjobs.job.imported.total.label"],["key","scheduledjobs.job.remaining.label"],[1,"row"],["class","col-md-12 order-md-1",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"list-table","table","table-bordered","table-striped"],[1,"label-column"],[4,"ngIf"],["key","scheduledjobs.import.table.message.header"],["class","label-column",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],["key","geoObject.label"],["key","geoObjectType.attr.code"],["key","scheduledjobs.import.table.row.number.header"],["key","etl.feedback.severity.title"],[1,"label-column",2,"vertical-align","middle"],["class","label-column","style","vertical-align: middle;",4,"ngIf"],["key","etl.feedback.severity.error",4,"ngIf"],["key","etl.feedback.severity.warning",4,"ngIf"],["key","etl.feedback.severity.error"],["key","etl.feedback.severity.warning"],[3,"pageChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,ZP,2,1,"div",2),e.TgZ(5,"div",3)(6,"h2"),e._UZ(7,"localize",4),e.qZA()(),e.YNc(8,NP,22,5,"div",5),e.YNc(9,YP,2,1,"div",6),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(4),e.Q6J("ngIf",t.job),e.xp6(1),e.Q6J("ngIf",t.page&&t.page.resultSet.length>0))},dependencies:[T.sg,T.O5,U.LS,Sn.l,Da.N,ba.C,U._s],styles:[".solid-table-wrapper[_ngcontent-%COMP%]{background:#F4F4F4;border-radius:15px;margin-bottom:20px}.solid-table-footer[_ngcontent-%COMP%]{border-radius:0 0 15px 15px;padding:0 0 10px 10px}.wrapper[_ngcontent-%COMP%]{padding:10px}"]});var Ar=v(57766);function HP(i,n){if(1&i&&(e.TgZ(0,"div",23),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function QP(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"label"),e._UZ(2,"localize",24),e.TgZ(3,"span",25),e._uU(4,"\xa0("),e._UZ(5,"convert-key-label",26),e._uU(6,")"),e.qZA()(),e.TgZ(7,"input",27),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()}if(2&i){const t=n.$implicit;e.xp6(5),e.Q6J("key",t.locale),e.xp6(2),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("required","defaultLocale"===t.locale)}}class yf{constructor(n,t,o){this.service=n,this.lService=t,this.bsModalRef=o,this.organization=null,this.message=null,this.onBusinessTypeChange=new pn.x}ngOnInit(){this.type={code:"",organization:"",displayLabel:this.lService.create(),description:this.lService.create(),attributes:[],labelAttribute:""}}init(n){this.organization=n,this.type.organization=this.organization.code,this.type.organizationLabel=this.organization.label}handleOnSubmit(){this.message=null,this.service.apply(this.type).then(n=>{this.onBusinessTypeChange.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function KP(i,n){if(1&i&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message)}}function $P(i,n){1&i&&e._UZ(0,"localize",36)}function WP(i,n){1&i&&e._UZ(0,"localize",37)}function XP(i,n){if(1&i&&(e.TgZ(0,"option",38),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.label.localizedValue," ")}}function eE(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",40),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw(3);return e.KtG(_.editAttribute(l,a))}),e.ALo(2,"localize"),e.qZA(),e.TgZ(3,"a",41),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw(3);return e.KtG(_.removeAttributeType(l,a))}),e.ALo(4,"localize"),e.qZA(),e.BQk()}2&i&&(e.xp6(1),e.Q6J("title",e.lcZ(2,2,"modal.button.edit")),e.xp6(2),e.Q6J("title",e.lcZ(4,4,"modal.button.remove")))}function tE(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",39),e.YNc(4,eE,5,6,"ng-container",0),e.qZA()()),2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(2),e.Oqu(t.label.localizedValue),e.xp6(2),e.Q6J("ngIf",!o.readOnly&&!t.isDefault)}}function nE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",42),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.createAttribute())}),e._UZ(1,"localize",43),e.qZA()}}function iE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.update())}),e._UZ(1,"localize",45),e.qZA()}if(2&i){e.oxw();const t=e.MAs(1);e.Q6J("disabled",t.invalid)}}function oE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"form",8,9),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.MAs(1);return e.KtG(a.valid)}),e.TgZ(2,"div",10)(3,"h1"),e.YNc(4,$P,1,0,"localize",11),e.YNc(5,WP,1,0,"localize",12),e._uU(6),e.qZA()(),e.TgZ(7,"fieldset")(8,"div",13)(9,"div",14)(10,"label"),e._UZ(11,"localize",15),e.qZA()(),e.TgZ(12,"div",16)(13,"span",17)(14,"input",18),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.type.code=a)}),e.qZA()()()(),e.TgZ(15,"localized-input",19),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.type.displayLabel=a)}),e.qZA(),e.TgZ(16,"div",13)(17,"div",14)(18,"label"),e._UZ(19,"localize",20),e.qZA()(),e.TgZ(20,"div",16)(21,"span",17)(22,"input",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.type.organizationLabel=a)}),e.qZA()()()(),e.TgZ(23,"div",13)(24,"div",14)(25,"label"),e._UZ(26,"localize",22),e.qZA()(),e.TgZ(27,"div",16)(28,"select",23),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.type.labelAttribute=a)}),e.YNc(29,XP,2,2,"option",24),e.qZA()()(),e.TgZ(30,"div",13)(31,"div",14)(32,"label"),e._UZ(33,"localize",25),e.qZA()(),e.TgZ(34,"div",16)(35,"div",26)(36,"div",27)(37,"div",28)(38,"table",29)(39,"tbody"),e.YNc(40,tE,5,2,"tr",30),e.qZA()()(),e.YNc(41,nE,2,0,"i",31),e.qZA()()()(),e.TgZ(42,"div",13)(43,"div",32)(44,"button",33),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.close())}),e._UZ(45,"localize",34),e.qZA(),e.YNc(46,iE,2,1,"button",35),e.qZA()()()()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",t.readOnly),e.xp6(1),e.Q6J("ngIf",!t.readOnly),e.xp6(1),e.hij(" : ",t.type.displayLabel.localizedValue," "),e.xp6(8),e.Q6J("ngModel",t.type.code),e.xp6(1),e.Q6J("disabled",t.readOnly)("value",t.type.displayLabel),e.xp6(7),e.Q6J("ngModel",t.type.organizationLabel),e.xp6(6),e.Q6J("ngModel",t.type.labelAttribute)("disabled",t.readOnly),e.xp6(1),e.Q6J("ngForOf",t.type.attributes),e.xp6(11),e.Q6J("ngForOf",t.type.attributes),e.xp6(1),e.Q6J("ngIf",!t.readOnly),e.xp6(5),e.Q6J("ngIf",!t.readOnly)}}function rE(i,n){if(1&i&&(e.ynx(0),e.YNc(1,KP,2,1,"div",5),e.YNc(2,oE,47,13,"form",6),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngIf",t.type)}}function aE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"define-attribute-modal-content",46),e.NdJ("geoObjectTypeChange",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onTypeChange())})("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("geoObjectType",t.type)("service",t.service)}}function sE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"edit-attribute-modal-content",47),e.NdJ("geoObjectTypeChange",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onTypeChange())})("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("geoObjectType",t.type)("attribute",t.modalState.attribute)("service",t.service)}}function lE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"manage-term-options",48),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("attribute",t.modalState.attribute)}}function cE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"edit-term-option-input",49),e.NdJ("stateChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onModalStateChange(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("attribute",t.modalState.attribute)("termOption",t.modalState.termOption)}}yf.\u0275fac=function(n){return new(n||yf)(e.Y36(tc),e.Y36(mo.o),e.Y36(Ln.UZ))},yf.\u0275cmp=e.Xpm({type:yf,selectors:[["create-business-type-modal"]],decls:34,vars:7,consts:[[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"modal-body"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["key","business.data.type"],[1,"row"],[1,"col-md-12"],[1,"form-group"],["for","codeInput"],["key","data.property.label.code"],["name","code","type","text","id","codeInput","required","",1,"form-control",3,"ngModel","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["key","data.property.label.description",3,"value","inlinelayout","valueChange"],["for","organization"],["key","attribute.organization.label"],[1,"text"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["key","modal.button.ok"],["role","alert",1,"alert","alert-danger"],["key","data.property.label.label"],[2,"color","#BABABA"],[3,"key"],["type","input",1,"form-control",3,"ngModel","name","required","ngModelChange"]],template:function(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){e.CHM(o);const l=e.MAs(1);return e.KtG(l.valid&&t.handleOnSubmit())}),e.TgZ(2,"div",2),e.YNc(3,HP,2,1,"div",3),e.TgZ(4,"div",4)(5,"h1"),e._UZ(6,"localize",5),e.qZA()(),e.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"div")(11,"label",9),e._UZ(12,"localize",10),e.qZA(),e.TgZ(13,"input",11),e.NdJ("ngModelChange",function(l){return t.type.code=l}),e.qZA()()()()(),e.TgZ(14,"div",6)(15,"div",7),e.YNc(16,QP,8,4,"div",12),e.qZA()(),e.TgZ(17,"div",6)(18,"div",7)(19,"localized-text",13),e.NdJ("valueChange",function(l){return t.type.description=l}),e.qZA()()(),e.TgZ(20,"div",6)(21,"div",7)(22,"div",8)(23,"label",14),e._UZ(24,"localize",15),e.qZA(),e.TgZ(25,"span",16)(26,"input",17),e.NdJ("ngModelChange",function(l){return t.type.organizationLabel=l}),e.qZA()()()()(),e.TgZ(27,"div",6)(28,"div",7)(29,"div",18)(30,"button",19),e.NdJ("click",function(){return t.bsModalRef.hide()}),e._UZ(31,"localize",20),e.qZA(),e.TgZ(32,"button",21),e._UZ(33,"localize",22),e.qZA()()()()()()}if(2&n){const o=e.MAs(1);e.xp6(3),e.Q6J("ngIf",null!=t.message),e.xp6(10),e.Q6J("ngModel",t.type.code),e.xp6(3),e.Q6J("ngForOf",t.type.displayLabel.localeValues),e.xp6(3),e.Q6J("value",t.type.description)("inlinelayout",!0),e.xp6(7),e.Q6J("ngModel",t.type.organizationLabel),e.xp6(6),e.Q6J("disabled",o.invalid)}},dependencies:[T.sg,T.O5,y._Y,y.Fj,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j,lu],encapsulation:2});class Dd{constructor(n,t,o,a){this.service=n,this.localizationService=t,this.modalService=o,this.bsModalRef=a,this.modalState={state:ko.manageGeoObjectType,attribute:"",termOption:""},this.message=null,this.readOnly=!1}ngOnInit(){this.onBusinessTypeChange=new pn.x}init(n,t){this.type=n,this.readOnly=t}createAttribute(){this.onModalStateChange({state:ko.defineAttribute,attribute:"",termOption:""})}editAttribute(n,t){this.onModalStateChange({state:ko.editAttribute,attribute:n,termOption:""})}removeAttributeType(n,t){let o=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});o.content.message=this.localizationService.decode("confirm.modal.verify.delete")+"["+n.label.localizedValue+"]",o.content.data={attributeType:n,geoObjectType:this.type},o.content.submitText=this.localizationService.decode("modal.button.delete"),o.content.type=ec.Qi.danger,o.content.onConfirm.subscribe(a=>{this.service.deleteAttributeType(this.type.code,n.code).then(()=>{this.type.attributes.splice(this.type.attributes.indexOf(n),1),this.onBusinessTypeChange.next(this.type)}).catch(l=>{this.error(l)})})}onModalStateChange(n){this.modalState=n}onTypeChange(){this.onBusinessTypeChange.next(this.type)}update(){this.service.apply(this.type).then(n=>{this.onBusinessTypeChange.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}close(){null!=this.type.oid?this.service.unlock(this.type.oid).then(()=>{this.bsModalRef.hide()}).catch(n=>{this.error(n)}):this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function uE(i,n){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function pE(i,n){1&i&&(e.TgZ(0,"div",7)(1,"div",10)(2,"div",11)(3,"p",17),e._UZ(4,"localize",18),e.qZA()()()())}function dE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",24)(1,"td",25)(2,"a",26),e._uU(3),e.qZA()(),e.TgZ(4,"td",27)(5,"button",28),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.onView(l))}),e._UZ(6,"localize",29),e.qZA(),e.TgZ(7,"button",30),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2).$implicit,C=e.oxw();return e.KtG(C.onEdit(_,l))}),e._UZ(8,"localize",31),e.qZA(),e.TgZ(9,"button",32),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2).$implicit,C=e.oxw();return e.KtG(C.onDelete(_,l))}),e._UZ(10,"localize",33),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Q6J("routerLink","/registry/business-type/"+t.oid),e.xp6(1),e.hij(" ",t.displayLabel.localizedValue," ")}}function hE(i,n){if(1&i&&(e.TgZ(0,"ul",19)(1,"table",20)(2,"thead")(3,"tr")(4,"th",21),e._UZ(5,"localize",22),e.qZA(),e._UZ(6,"th"),e.qZA()(),e.TgZ(7,"tbody"),e.YNc(8,dE,11,2,"tr",23),e.qZA()()()),2&i){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.types)}}function fE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"button",28),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.onCreate(a))}),e._UZ(2,"localize",34),e.qZA()()}}function gE(i,n){if(1&i&&(e.TgZ(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"h3"),e._uU(6),e.qZA()()()(),e.YNc(7,pE,5,0,"div",12),e.YNc(8,hE,9,1,"ul",13),e.TgZ(9,"div",14)(10,"div",15),e.YNc(11,fE,3,0,"div",16),e.qZA()()()()),2&i){const t=n.$implicit;e.xp6(6),e.Oqu(t.label),e.xp6(1),e.Q6J("ngIf",t.types&&0===t.types.length),e.xp6(1),e.Q6J("ngIf",t.types&&t.types.length>0),e.xp6(3),e.Q6J("ngIf",t.write)}}Dd.\u0275fac=function(n){return new(n||Dd)(e.Y36(tc),e.Y36(mo.o),e.Y36(Ln.tT),e.Y36(Ln.UZ))},Dd.\u0275cmp=e.Xpm({type:Dd,selectors:[["manage-business-type-modal"]],decls:6,vars:5,consts:[[4,"ngIf"],[3,"geoObjectType","service","geoObjectTypeChange","stateChange",4,"ngIf"],[3,"geoObjectType","attribute","service","geoObjectTypeChange","stateChange",4,"ngIf"],[3,"attribute","stateChange",4,"ngIf"],[3,"attribute","termOption","stateChange",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","modal-form",3,"ngSubmit",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"modal-form",3,"ngSubmit"],["form","ngForm"],[1,"heading","text-center"],["key","business.data.view.type",4,"ngIf"],["key","business.data.edit.type",4,"ngIf"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],[1,"text"],["type","text","name","code","disabled","","required","",3,"ngModel","ngModelChange"],["key","data.property.label.label",3,"disabled","value","valueChange"],["key","attribute.organization.label"],["type","text","name","organization","disabled","","required","",3,"ngModel","ngModelChange"],["key","attribute.labelAttribute.label"],["name","labelAttribute",1,"select-area",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["key","hierarchy.management.manage.attributes.label.displayAttributes"],[1,"panel","panel-default"],[1,"panel-body"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],["class","fa fa-plus clickable","style","font-size:20px;margin:10px 0 10px 0;","aria-hidden","true",3,"click",4,"ngIf"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],["key","business.data.view.type"],["key","business.data.edit.type"],[3,"value"],[1,"button-column",2,"width","60px"],[1,"fa","fa-pencil","ico-edit",3,"routerLink","title","click"],[1,"fa","fa-trash-o","ico-remove",3,"routerLink","title","click"],["aria-hidden","true",1,"fa","fa-plus","clickable",2,"font-size","20px","margin","10px 0 10px 0",3,"click"],["key","modal.button.add"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"],[3,"geoObjectType","service","geoObjectTypeChange","stateChange"],[3,"geoObjectType","attribute","service","geoObjectTypeChange","stateChange"],[3,"attribute","stateChange"],[3,"attribute","termOption","stateChange"]],template:function(n,t){1&n&&(e.TgZ(0,"div"),e.YNc(1,rE,3,2,"ng-container",0),e.YNc(2,aE,1,2,"define-attribute-modal-content",1),e.YNc(3,sE,1,3,"edit-attribute-modal-content",2),e.YNc(4,lE,1,1,"manage-term-options",3),e.YNc(5,cE,1,2,"edit-term-option-input",4),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf","MANAGE-GEO-OBJECT-TYPE"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","DEFINE-ATTRIBUTE"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","EDIT-ATTRIBUTE"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","MANAGE-TERM-OPTION"===t.modalState.state),e.xp6(1),e.Q6J("ngIf","EDIT-TERM-OPTION"===t.modalState.state))},dependencies:[T.sg,T.O5,w.rH,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,wd,Td,Md,Od,Xu,ia.F],data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)("void => *",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")]),(0,Y.eR)(":leave",(0,Y.jt)("500ms",(0,Y.oB)({opacity:0})))])]]}});class vf{constructor(n,t,o,a){this.service=n,this.modalService=t,this.router=o,this.localizeService=a,this.message=null}ngOnInit(){this.service.getByOrganization().then(n=>{this.orgs=n}).catch(n=>{this.error(n)})}onCreate(n){this.bsModalRef=this.modalService.show(yf,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(n),this.bsModalRef.content.onBusinessTypeChange.subscribe(t=>{n.types.push(t)})}onView(n){this.service.get(n.oid).then(t=>{this.bsModalRef=this.modalService.show(Dd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(t,!0)}).catch(t=>{this.error(t)})}onEdit(n,t){this.service.edit(t.oid).then(o=>{this.bsModalRef=this.modalService.show(Dd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(o,!1),this.bsModalRef.content.onBusinessTypeChange.subscribe(a=>{const l=n.types.findIndex(_=>t.code===_.code);-1!==l&&(n.types[l]=a)})}).catch(o=>{this.error(o)})}onDelete(n,t){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+t.displayLabel.localizedValue+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe(o=>{this.service.remove(t).then(()=>{n.types=n.types.filter(a=>a.code!==t.code)}).catch(a=>{this.error(a)})})}error(n){this.message=Zt.qL.getMessageFromError(n)}}vf.\u0275fac=function(n){return new(n||vf)(e.Y36(tc),e.Y36(Ln.tT),e.Y36(w.F0),e.Y36(mo.o))},vf.\u0275cmp=e.Xpm({type:vf,selectors:[["business-type-manager"]],decls:9,vars:2,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[1,"heading"],["key","settings.organizations.heading"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","row",4,"ngFor","ngForOf"],["role","alert",1,"alert","alert-danger"],[1,"row"],[1,"col-md-12","order-md-1"],[1,"row",2,"margin-top","30px"],[1,"col-md-12"],[1,"py-5"],["class","row",4,"ngIf"],["class","type-group","style","border-bottom: 2px solid lightgrey; margin-top: 30px;",4,"ngIf"],[1,"row",2,"margin-top","30px","margin-bottom","30px"],[1,"col-md-6"],[4,"ngIf"],[1,"inline-message"],["key","business.data.noTypes"],[1,"type-group",2,"border-bottom","2px solid lightgrey","margin-top","30px"],[1,"table"],[2,"width","70%"],["key","business.data.types"],["class","clickable",4,"ngFor","ngForOf"],[1,"clickable"],[2,"width","70%","vertical-align","middle"],["routerLinkActive","active",3,"routerLink"],[2,"width","30%","text-align","right"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","modal.button.view"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","modal.button.edit"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","modal.button.delete"],["key","hierarchy.management.button.create"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2)(5,"h2"),e._UZ(6,"localize",3),e.qZA()(),e.YNc(7,uE,2,1,"div",4),e.YNc(8,gE,12,4,"div",5),e.qZA()()),2&n&&(e.xp6(7),e.Q6J("ngIf",null!=t.message),e.xp6(1),e.Q6J("ngForOf",t.orgs))},dependencies:[T.sg,T.O5,w.rH,w.Od,Sn.l,Da.N,ba.C],styles:['li.list-group-item[_ngcontent-%COMP%]{font-size:14px;border:none}li.list-group-item.active[_ngcontent-%COMP%]{background-color:#dbd7a5}li.list-group-item.got-li-item[_ngcontent-%COMP%]{border-top:15px solid #a0a0a0;border-radius:5px}li.list-group-item.got-li-item.got-group-child[_ngcontent-%COMP%]{margin-left:40px}li.list-group-item.got-li-item.got-group-child[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-8px;border-left:3px solid white;height:44px;width:1px;top:-10px}li.list-group-item.hier-li-item[_ngcontent-%COMP%]{background:#6e6775;border:2px solid #3E2A5A;color:#fff}li.list-group-item.hier-li-item[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{color:#fff}li.list-group-item.hier-li-item.primary[_ngcontent-%COMP%]{background:#3E2A5A}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child:before{top:6px}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child:before{height:6px}.got-org-label-wrapper[_ngcontent-%COMP%]{padding:7px 0}.got-org-label-wrapper[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{border-bottom:solid 1px;width:100%}.sidebar-section-content[_ngcontent-%COMP%]{overflow-y:auto}.hierarchy-sidebar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.hierarchy-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;padding:0;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.hierarchy-content[_ngcontent-%COMP%]{height:calc(100vh - 50px);overflow:auto}#overflow-div[_ngcontent-%COMP%]{top:0}.upload-text[_ngcontent-%COMP%]{position:relative;top:40%}.sidebar-section[_ngcontent-%COMP%]{text-align:left}.hierarchy-sidebar-content[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{background-color:#f1f1f1;max-height:500px;overflow:auto}.sidebar-section-header[_ngcontent-%COMP%]{margin-left:20px;cursor:pointer}li.list-group-item[_ngcontent-%COMP%]{background-color:#fff;margin-bottom:5px}.drop-box-container[_ngcontent-%COMP%]{width:80%;border:3px grey dashed;border-radius:5px;margin:50px auto 0}.hierarchy-drop-box[_ngcontent-%COMP%]{position:relative;height:100%;cursor:default}li.got-li-item.dragging[_ngcontent-%COMP%]{position:fixed;cursor:grabbing!important;z-index:99999999}[data-candrag=true][_ngcontent-%COMP%]{cursor:pointer}[data-candrag=false][_ngcontent-%COMP%]{cursor:not-allowed}#NodeTooltip[_ngcontent-%COMP%]{opacity:0;left:-10000;top:-10000;position:fixed;width:400px;min-width:400px}#NodeTooltip[_ngcontent-%COMP%]   .modal-form[_ngcontent-%COMP%]{padding-top:10px}#NodeTooltip[_ngcontent-%COMP%]   .modal-form[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]{padding-bottom:0}#NodeTooltip[_ngcontent-%COMP%]   .label-holder[_ngcontent-%COMP%]{width:40%}#NodeTooltip[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]{width:60%}#NodeTooltip[_ngcontent-%COMP%]   .holder[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:2.8}[_nghost-%COMP%]  .panel .panel-heading .accordion-toggle:after{font-family:Glyphicons Halflings;content:"\\e080";float:right;margin-top:-30px}[_nghost-%COMP%]  .panel.panel-open .panel-heading .accordion-toggle:after{content:"\\e114"}']});const _E=["myFile"];function mE(i,n){if(1&i&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.code),e.xp6(1),e.hij("",t.displayLabel.localizedValue," ")}}function yE(i,n){if(1&i&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.code),e.xp6(1),e.hij(" ",t.label,"")}}function vE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"label",35),e._UZ(2,"localize",36),e.qZA(),e.TgZ(3,"div",14)(4,"select",37),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.hierarchyCode=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSelectHierarchy())}),e._UZ(5,"option"),e.YNc(6,yE,2,2,"option",16),e.qZA()(),e._UZ(7,"div",17),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.hierarchyCode),e.xp6(2),e.Q6J("ngForOf",t.filteredHierarchyViews)}}function bE(i,n){if(1&i&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.code),e.xp6(1),e.hij(" ",t.super?t.super.label+" : "+t.label:t.label," ")}}function xE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"label",38),e._UZ(2,"localize",39),e.qZA(),e.TgZ(3,"div",14)(4,"select",40),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.typeCode=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSelectType())}),e._UZ(5,"option"),e.YNc(6,bE,2,2,"option",16),e.qZA()(),e._UZ(7,"div",17),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.typeCode),e.xp6(2),e.Q6J("ngForOf",t.filteredTypeViews)}}function CE(i,n){1&i&&e._UZ(0,"localize",41)}function wE(i,n){if(1&i&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.s9C("value",t.strategy),e.xp6(1),e.Oqu(t.label)}}function TE(i,n){1&i&&e._UZ(0,"localize",42)}function ME(i,n){if(1&i&&e._UZ(0,"input",43,44),2&i){const t=e.oxw(2);e.Q6J("uploader",t.uploader)}}function OE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div")(2,"form",9,10)(4,"div",11)(5,"label",12),e._UZ(6,"localize",13),e.qZA(),e.TgZ(7,"div",14)(8,"select",15),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.businessTypeCode=a)}),e._UZ(9,"option"),e.YNc(10,mE,2,2,"option",16),e.qZA()(),e._UZ(11,"div",17),e.qZA(),e.YNc(12,vE,8,2,"div",18),e.YNc(13,xE,8,2,"div",18),e.TgZ(14,"div",11)(15,"label",19),e.YNc(16,CE,1,0,"localize",20),e.qZA(),e.TgZ(17,"div",14)(18,"select",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.importStrategy=a)}),e.YNc(19,wE,2,2,"option",16),e.qZA()(),e._UZ(20,"div",17),e.qZA(),e.TgZ(21,"div",11)(22,"label",22),e._uU(23,"Date"),e.qZA(),e.TgZ(24,"div",14)(25,"date-field",23,24),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.date=a)}),e.qZA()(),e._UZ(27,"div",17),e.qZA(),e.TgZ(28,"div",11)(29,"label",25),e._UZ(30,"localize",26),e.qZA(),e.TgZ(31,"div",14)(32,"boolean-field",27),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.copyBlank=a)}),e.qZA()(),e._UZ(33,"div",17),e.qZA(),e.TgZ(34,"div",11)(35,"label",28),e.YNc(36,TE,1,0,"localize",29),e.qZA(),e.TgZ(37,"div",14),e.YNc(38,ME,2,1,"input",30),e.qZA(),e._UZ(39,"div",17),e.qZA(),e.TgZ(40,"div",11),e._UZ(41,"div",17),e.TgZ(42,"div",31)(43,"button",32),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onClick())}),e._UZ(44,"localize",33),e.qZA()(),e._UZ(45,"div",17),e.qZA()()()()}if(2&i){const t=e.MAs(3),o=e.oxw();e.xp6(8),e.Q6J("ngModel",o.businessTypeCode),e.xp6(2),e.Q6J("ngForOf",o.businessTypes),e.xp6(2),e.Q6J("ngIf",o.filteredHierarchyViews),e.xp6(1),e.Q6J("ngIf",o.filteredTypeViews),e.xp6(3),e.Q6J("ngIf","EXCEL"===o.format),e.xp6(2),e.Q6J("ngModel",o.importStrategy),e.xp6(1),e.Q6J("ngForOf",o.importStrategies),e.xp6(6),e.Q6J("value",o.date)("inputName","date")("allowFutureDates",!1),e.xp6(7),e.Q6J("value",o.copyBlank),e.xp6(4),e.Q6J("ngIf","EXCEL"===o.format),e.xp6(2),e.Q6J("ngIf","EXCEL"===o.format),e.xp6(5),e.Q6J("disabled",t.invalid)}}class bf{constructor(n,t,o,a,l){this.eventService=n,this.modalService=t,this.localizationService=o,this.hierarchyService=a,this.businessService=l,this.currentDate=new Date,this.showImportConfig=!0,this.isValid=!1,this.businessTypes=[],this.businessTypeCode=null,this.importStrategies=[{strategy:$a.NEW_AND_UPDATE,label:this.localizationService.decode("etl.import.ImportStrategy.NEW_AND_UPDATE")},{strategy:$a.NEW_ONLY,label:this.localizationService.decode("etl.import.ImportStrategy.NEW_ONLY")},{strategy:$a.UPDATE_ONLY,label:this.localizationService.decode("etl.import.ImportStrategy.UPDATE_ONLY")}],this.typeCode=null,this.hierarchyCode=null,this.date=null,this.format="EXCEL",this.copyBlank=!0}ngOnInit(){this.businessService.getAll().then(o=>{this.businessTypes=o}),this.hierarchyService.getHierarchyGroupedTypes().then(o=>{this.allHierarchyViews=o,this.allTypeViews=[];let a=this.allHierarchyViews.length;for(let _=0;_<a;++_){let C=this.allHierarchyViews[_],N=C.types.length;for(let F=0;F<N;++F){let V=C.types[F],ue=this.allHierarchyViews.length;for(let ce=0;ce<ue;++ce){let Te=this.allHierarchyViews[ce],We=Te.types.findIndex(it=>V.code===it.code);-1!==We&&(Te.types[We]=V)}}}let l=this.allHierarchyViews.length;for(let _=0;_<l;++_){let C=this.allHierarchyViews[_],N=C.types.length;for(let F=0;F<N;++F){let V=C.types[F],ue=this.allTypeViews.findIndex(ce=>ce.code===V.code);if(-1!==ue){let ce=this.allTypeViews[ue];-1===ce.hierarchies.findIndex(We=>We.code===C.code)&&ce.hierarchies.push(C)}else null==V.hierarchies&&(V.hierarchies=[]),V.hierarchies.push(C),this.allTypeViews.push(V)}}this.filteredHierarchyViews=this.allHierarchyViews,this.filteredTypeViews=this.allTypeViews}).catch(o=>{this.error(o)}),this.uploader=new I.bA({queueLimit:1,removeAfterUpload:!0,url:pt.N.apiUrl+"/api/excel/get-business-config"}),this.uploader.onBuildItemForm=(o,a)=>{a.append("type",this.businessTypeCode),a.append("copyBlank",this.copyBlank),null!=this.date&&a.append("date",this.date),this.importStrategy&&a.append("strategy",this.importStrategy)},this.uploader.onBeforeUploadItem=o=>{this.eventService.start()},this.uploader.onCompleteItem=(o,a,l,_)=>{this.fileRef.nativeElement.value="",this.eventService.complete()},this.uploader.onSuccessItem=(o,a,l,_)=>{const C=JSON.parse(a);C.hierarchy=this.hierarchyCode,C.geoObjectType={code:this.typeCode},this.bsModalRef=this.modalService.show(Zd,{backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(C,"geoObjectType",!0)},this.uploader.onErrorItem=(o,a,l,_)=>{const C=JSON.parse(a);this.error({error:C})}}onSelectHierarchy(){let n=null,t=this.allHierarchyViews.length;for(let o=0;o<t;++o)if(this.allHierarchyViews[o].code===this.hierarchyCode){n=this.allHierarchyViews[o];break}this.filteredTypeViews=null!=n?n.types:this.allTypeViews}onSelectType(){let n=null,t=this.allTypeViews.length;for(let o=0;o<t;++o)if(this.allTypeViews[o].code===this.typeCode){n=this.allTypeViews[o];break}this.filteredHierarchyViews=null!=n?n.hierarchies:this.allHierarchyViews}onClick(){null!=this.uploader.queue&&this.uploader.queue.length>0?this.uploader.uploadAll():this.error({message:this.localizationService.decode("io.missing.file"),error:{}})}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}bf.\u0275fac=function(n){return new(n||bf)(e.Y36(nn.PO),e.Y36(Ln.tT),e.Y36(nn.oQ),e.Y36(Wl),e.Y36(tc))},bf.\u0275cmp=e.Xpm({type:bf,selectors:[["business-importer"]],viewQuery:function(n,t){if(1&n&&e.Gf(_E,5),2&n){let o;e.iGM(o=e.CRH())&&(t.fileRef=o.first)}},inputs:{format:"format"},decls:13,vars:1,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[1,"row"],[1,"col-md-1"],[1,"col-md-10",2,"padding-top","30px"],[1,"heading"],["key","business.data.import"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[4,"ngIf"],["autocomplete","off"],["form","ngForm"],[1,"form-group","row"],["for","businessTypeCode",1,"col-md-2","text-right"],["key","business.data.type"],[1,"col-md-8"],["id","businessTypeCode","name","businessTypeCode","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["class","form-group row",4,"ngIf"],["for","strategy",1,"col-md-2","text-right"],["key","spreadsheet.import.import.strategy",4,"ngIf"],["id","strategy","name","strategy","required","",1,"select-area",3,"ngModel","ngModelChange"],["for","date",1,"col-md-2","text-right"],["label","",3,"value","inputName","allowFutureDates","valueChange"],["dateFieldComponents",""],["for","copyBlank",1,"col-md-2","text-right"],["key","dataimporter.importblankcells"],["label","",3,"value","valueChange"],["for","file",1,"col-md-2","text-right"],["key","io.spreadsheet",4,"ngIf"],["class","ghost-input","name","file","type","file","ng2FileSelect","","accept",".xls, .xlsx","required","",3,"uploader",4,"ngIf"],[1,"button-holder","col-md-8","text-right"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"],[3,"value"],["for","hierarchyCode",1,"col-md-2","text-right"],["key","io.modal.hierarchy"],["id","hierarchyCode","name","hierarchyCode","required","",1,"select-area",3,"ngModel","ngModelChange","change"],["for","code",1,"col-md-2","text-right"],["key","io.geoObjectType"],["id","code","name","code","required","",1,"select-area",3,"ngModel","ngModelChange","change"],["key","spreadsheet.import.import.strategy"],["key","io.spreadsheet"],["name","file","type","file","ng2FileSelect","","accept",".xls, .xlsx","required","",1,"ghost-input",3,"uploader"],["myFile",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2),e._UZ(5,"div",3),e.TgZ(6,"div",4)(7,"div",5)(8,"h2"),e._UZ(9,"localize",6),e.qZA()(),e.TgZ(10,"div",7),e.YNc(11,OE,46,14,"div",8),e.qZA()(),e._UZ(12,"div",3),e.qZA()()()),2&n&&(e.xp6(11),e.Q6J("ngIf",t.showImportConfig))},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,I.C6,Sn.l,rl.M,Da.N,ba.C,Xl.Q],styles:[".radio-btn-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px;font-weight:400}.radio-btn-wrapper[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{color:#6ba542;font-weight:700}.radio-btn-wrapper[_ngcontent-%COMP%]   p.radio-label-description[_ngcontent-%COMP%]{color:#a3a0a0;margin-left:30px}"]});const SE=["typeaheadParent"];function PE(i,n){if(1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i){const t=n.item;e.xp6(1),e.AsE("",t.name," : ",t.code,"")}}function EE(i,n){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function AE(i,n){if(1&i&&(e.TgZ(0,"span",29),e._UZ(1,"date-text",30),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("date",t.event.eventDate)}}function kE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"date-field",31),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.event.eventDate=a)})("validChange",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.validChange())}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("value",t.event.eventDate)("classNames","form-control")("inputName","eventDate")("allowFutureDates",!1)("required",!0)("disable",t.readonly||t.event.transitions.length>0)}}function IE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"label"),e._UZ(3,"localize",32),e.TgZ(4,"span",33),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",11)(9,"input",34),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("disabled",o.readonly)("required",!1)}}function ZE(i,n){if(1&i&&(e.TgZ(0,"option",37),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label)}}function NE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"select",35),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.event.beforeTypeCode=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onChange())}),e._UZ(2,"option"),e.YNc(3,ZE,2,2,"option",36),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.event.beforeTypeCode)("disabled",t.event.transitions.length>0),e.xp6(2),e.Q6J("ngForOf",t.beforeTypes)}}function LE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"input",38),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.event.beforeTypeLabel=a)}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.event.beforeTypeLabel)}}function zE(i,n){if(1&i&&(e.TgZ(0,"option",37),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label)}}function DE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"select",39),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.event.afterTypeCode=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onChange())}),e._UZ(2,"option"),e.YNc(3,zE,2,2,"option",36),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.event.afterTypeCode)("disabled",t.event.transitions.length>0),e.xp6(2),e.Q6J("ngForOf",t.afterTypes)}}function RE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"input",40),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.event.afterTypeLabel=a)}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.event.afterTypeLabel)}}function FE(i,n){1&i&&e._UZ(0,"th")}function UE(i,n){1&i&&e._UZ(0,"th",47)}function qE(i,n){1&i&&(e.TgZ(0,"tr",53),e._UZ(1,"td",54),e.qZA())}function JE(i,n){1&i&&(e.TgZ(0,"td",66),e._UZ(1,"a",67),e.qZA())}function jE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",68),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.clear(a,"sourceText"))}),e._UZ(1,"i",69),e.qZA()}}function BE(i,n){1&i&&e._UZ(0,"span",70)}function GE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",68),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.clear(a,"targetText"))}),e._UZ(1,"i",69),e.qZA()}}function VE(i,n){1&i&&e._UZ(0,"span",70)}function YE(i,n){if(1&i&&(e.TgZ(0,"label"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Oqu(o.localizeTransitionType(t.transitionType))}}function HE(i,n){if(1&i&&(e.TgZ(0,"label",72),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Oqu(o.localizeTransitionType(t.typePart))}}function QE(i,n){if(1&i&&(e.TgZ(0,"td",63),e.YNc(1,YE,2,1,"label",5),e.YNc(2,HE,2,1,"label",71),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!t.typeUpdown),e.xp6(1),e.Q6J("ngIf",t.typePart)}}function KE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"select",74),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.typeUpdown=a)})("change",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(3);return e.KtG(l.onChangeTypeUpdown(a))}),e.TgZ(1,"option",75),e._UZ(2,"localize",76),e.qZA(),e.TgZ(3,"option",77),e._UZ(4,"localize",78),e.qZA()()}if(2&i){const t=e.oxw(2),o=t.$implicit,a=t.index,l=e.oxw(3);e.Q6J("name","transition.transitionType-updown-"+o.oid+"-"+a)("ngModel",o.typeUpdown)("disabled",l.readonly)}}function $E(i,n){if(1&i&&(e.TgZ(0,"td"),e.YNc(1,KE,5,3,"select",73),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.typeUpdown)}}function WE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",63)(1,"span",79),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().index,l=e.oxw(3);return e.KtG(l.remove(a))}),e._UZ(2,"a",80),e.qZA()()}}function XE(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",55),e.NdJ("dndStart",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.readonly?null:l.onDragStart(a))})("dndCopied",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.readonly?null:l.onDraggableCopied(a))})("dndLinked",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.readonly?null:l.onDraggableLinked(a))})("dndMoved",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.readonly?null:l.onDraggableMoved(a))})("dndCanceled",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.readonly?null:l.onDragCanceled(a))})("dndEnd",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.readonly?null:l.onDragEnd(a))}),e.YNc(1,JE,2,0,"td",56),e.TgZ(2,"td")(3,"div",57)(4,"input",58),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.sourceText=a)})("typeaheadOnSelect",function(a){const _=e.CHM(t).$implicit,C=e.oxw(3);return e.KtG(C.typeaheadOnSelect(a,_,"sourceText"))}),e.qZA(),e.TgZ(5,"div",59),e._UZ(6,"div",60),e.qZA(),e.YNc(7,jE,2,0,"span",61),e.YNc(8,BE,1,0,"span",62),e.qZA()(),e.TgZ(9,"td",63)(10,"label"),e._uU(11),e.qZA()(),e.TgZ(12,"td")(13,"div",57)(14,"input",58),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.targetText=a)})("typeaheadOnSelect",function(a){const _=e.CHM(t).$implicit,C=e.oxw(3);return e.KtG(C.typeaheadOnSelect(a,_,"targetText"))}),e.qZA(),e.TgZ(15,"div",59),e._UZ(16,"div",60),e.qZA(),e.YNc(17,GE,2,0,"span",61),e.YNc(18,VE,1,0,"span",62),e.qZA()(),e.YNc(19,QE,3,2,"td",64),e.YNc(20,$E,2,1,"td",5),e.YNc(21,WE,3,0,"td",65),e.qZA()}if(2&i){const t=n.$implicit,o=n.index,a=e.oxw(3),l=e.MAs(1);e.Q6J("dndDraggable",t)("dndDisableIf",a.readonly)("dndEffectAllowed",a.draggable.effectAllowed),e.uIk("data-transOid",t.oid),e.xp6(1),e.Q6J("ngIf",!a.readonly),e.xp6(3),e.Q6J("name","transition.source-"+t.oid+"-"+o)("disabled",a.readonly)("ngModel",t.sourceText)("typeaheadAsync",!0)("typeahead",a.getTypeAheadObservable(!0,t,a.event.beforeTypeCode,"sourceText"))("typeaheadOptionsLimit",7)("typeaheadItemTemplate",l)("typeaheadMinLength",0)("typeaheadWaitMs",300)("container","#typeaheadParentS-"+o),e.xp6(2),e.Q6J("id","typeaheadParentS-"+o),e.xp6(1),e.Q6J("ngIf",!a.readonly),e.xp6(1),e.Q6J("ngIf",a.readonly),e.xp6(3),e.Oqu(a.localizeTransitionImpact(t.impact)),e.xp6(3),e.Q6J("name","transition.target-"+t.oid+"-"+o)("disabled",a.readonly)("ngModel",t.targetText)("typeaheadAsync",!0)("typeahead",a.getTypeAheadObservable(!1,t,a.event.afterTypeCode,"targetText"))("typeaheadOptionsLimit",7)("typeaheadItemTemplate",l)("typeaheadMinLength",0)("typeaheadWaitMs",300)("container","#typeaheadParentT-"+o),e.xp6(2),e.Q6J("id","typeaheadParentT-"+o),e.xp6(1),e.Q6J("ngIf",!a.readonly),e.xp6(1),e.Q6J("ngIf",a.readonly),e.xp6(1),e.Q6J("ngIf",t.typePart||!t.typeUpdown),e.xp6(1),e.Q6J("ngIf",t.typeUpdown),e.xp6(1),e.Q6J("ngIf",!a.readonly)}}function eA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",81)(1,"div",7)(2,"i",82),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onCreate())}),e._UZ(3,"localize",83),e.qZA()()()}}function tA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"table",41)(2,"thead")(3,"tr",42),e.YNc(4,FE,1,0,"th",5),e.TgZ(5,"th",43),e._UZ(6,"localize",21),e.qZA(),e.TgZ(7,"th",44),e._UZ(8,"localize",45),e.qZA(),e.TgZ(9,"th",43),e._UZ(10,"localize",22),e.qZA(),e.TgZ(11,"th",44),e._UZ(12,"localize",46),e.qZA(),e._UZ(13,"th",47),e.YNc(14,UE,1,0,"th",48),e.qZA()(),e.TgZ(15,"tbody",49),e.NdJ("dndDrop",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onDrop(a))}),e.YNc(16,qE,2,0,"tr",50),e.YNc(17,XE,22,35,"tr",51),e.qZA()(),e.YNc(18,eA,4,0,"div",52),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",!t.readonly),e.xp6(10),e.Q6J("ngIf",!t.readonly),e.xp6(1),e.Q6J("dndDisableIf",t.readonly)("dndEffectAllowed","copyMove"),e.xp6(1),e.Q6J("ngIf",!t.readonly),e.xp6(1),e.Q6J("ngForOf",t.event.transitions),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}function nA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",84),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSubmit())}),e._UZ(1,"localize",85),e.qZA()}if(2&i){const t=e.oxw(2),o=e.MAs(5);e.Q6J("disabled",o.invalid||!t.valid)}}function iA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"fieldset")(1,"div",7)(2,"div",8)(3,"div",9)(4,"label"),e._UZ(5,"localize",10),e.qZA()(),e.TgZ(6,"div",11),e.YNc(7,AE,2,1,"span",12),e.YNc(8,kE,1,6,"date-field",13),e.qZA()(),e.YNc(9,IE,10,5,"div",14),e.TgZ(10,"div",8)(11,"div",9)(12,"label",15),e._UZ(13,"localize",16),e.qZA()(),e.YNc(14,NE,4,3,"div",17),e.YNc(15,LE,2,1,"div",17),e.qZA(),e.TgZ(16,"div",8)(17,"div",9)(18,"label",18),e._UZ(19,"localize",19),e.qZA()(),e.YNc(20,DE,4,3,"div",17),e.YNc(21,RE,2,1,"div",17),e.qZA()(),e.TgZ(22,"div",7)(23,"div",20)(24,"label",7),e._UZ(25,"localize",21),e.qZA(),e.TgZ(26,"label",7),e._UZ(27,"localize",22),e.qZA()(),e._UZ(28,"div",23),e.qZA(),e.YNc(29,tA,19,7,"div",24),e.TgZ(30,"div",8),e._UZ(31,"div",9),e.TgZ(32,"div",11)(33,"div",25)(34,"button",26),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCancel())}),e._UZ(35,"localize",27),e.qZA(),e.YNc(36,nA,2,1,"button",28),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.readonly),e.xp6(1),e.Q6J("ngIf",!t.readonly),e.xp6(1),e.Q6J("ngForOf",t.event.description.localeValues),e.xp6(5),e.Q6J("ngIf",!t.readonly&&null!=t.beforeTypes),e.xp6(1),e.Q6J("ngIf",t.readonly),e.xp6(5),e.Q6J("ngIf",!t.readonly&&null!=t.afterTypes),e.xp6(1),e.Q6J("ngIf",t.readonly),e.xp6(8),e.Q6J("ngIf",null!=t.event.beforeTypeCode&&""!==t.event.beforeTypeCode&&null!=t.event.afterTypeCode&&""!==t.event.afterTypeCode&&null!=t.event.eventDate&&""!==t.event.eventDate),e.xp6(6),e.Q6J("key",t.readonly?"io.back":"io.cancel"),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}const oy="#6BA542";class Rd{constructor(n,t,o,a,l,_,C,N){this.service=n,this.changeDetector=t,this.rService=o,this.iService=a,this.lService=l,this.bsModalRef=_,this.authService=C,this.dateService=N,this.message=null,this.event=null,this.activeTransition=null,this.afterTypes=[],this.beforeTypes=[],this.readonly=!1,this.valid=!1,this.draggable={data:"myDragData",effectAllowed:"all",disable:!1,handle:!0}}ngOnInit(){this.onEventChange=new pn.x,this.iService.listGeoObjectTypes(!1).then(n=>{let t=this.authService.getMyOrganizations(),o=[],a=[],l=this.authService.isSRA();for(let _=0;_<n.length;++_){const C=n[_].orgCode,N=null!=n[_].superTypeCode?n[_].superTypeCode:n[_].code;(-1!==t.indexOf(C)||l)&&(a.push(n[_]),this.authService.isGeoObjectTypeRM(C,N)&&o.push(n[_]))}this.beforeTypes=o,this.afterTypes=a,this.readonly=this.readonly||-1===this.event.permissions.indexOf("WRITE")}).catch(n=>{this.error(n)})}ngOnDestroy(){this.onEventChange.unsubscribe()}init(n,t){this.readonly=n,this.event=null!=t?t:{beforeTypeCode:"",afterTypeCode:"",eventDate:"",permissions:["WRITE","READ","DELETE","CREATE"],description:this.lService.create(),transitions:[]},setTimeout(()=>{this.onChange()},0)}setActiveTransition(n){let t=(o,a)=>{Qu('#svgHolder p[data-goCode="'+a.sourceCode+'"][data-depth="1"],p[data-goCode="'+a.targetCode+'"][data-depth="2"]').style("color",o?oy:"black"),Qu('#svgHolder circle[data-goCode="'+a.sourceCode+'"][data-depth="1"],circle[data-goCode="'+a.targetCode+'"][data-depth="2"]').attr("fill",o?oy:"#999"),Qu('#svgHolder path[data-transOid="'+a.oid+'"]').attr("stroke",o?oy:"#999")};null!=this.activeTransition&&t(!1,this.activeTransition),this.activeTransition=n,null!=n&&t(!0,n)}onCreate(){this.event.transitions.push({oid:G(),isNew:!0,sourceCode:"",sourceType:"",targetCode:"",targetType:"",transitionType:"",impact:"",order:this.event.transitions.length})}onChange(){this.calculateDerivedAttributes(),this.renderVisual();let n=this;setTimeout(()=>{Qu(".transition").on("mouseover",function(t){let a=this.getAttribute("data-transOid"),l=n.event.transitions.findIndex(_=>_.oid===a);n.setActiveTransition(n.event.transitions[l])}),ln("#transition-container").on("mouseleave",function(t){n.setActiveTransition(null)})},0),this.validChange()}getTypeAheadObservable(n,t,o,a){let l=n?this.dateService.addDay(-1,this.event.eventDate):this.event.eventDate;return new Ni.y(_=>{this.rService.getGeoObjectSuggestions(t[a],o,null,null,null,l,l).then(C=>{let N=C.filter(F=>{let V_sourceCode=n?F.code:t.sourceCode,V_targetCode=n?t.targetCode:F.code;for(let ue=0;ue<this.event.transitions.length;++ue){let ce=this.event.transitions[ue];if(ce.sourceCode===V_sourceCode&&ce.targetCode===V_targetCode)return!1}return!0});_.next(N)})})}typeaheadOnSelect(n,t,o){"targetText"===o?(t.targetCode=n.item.code,t.targetType=n.item.typeCode,t.targetText=n.item.name+" ("+n.item.code+")"):(t.sourceCode=n.item.code,t.sourceType=n.item.typeCode,t.sourceText=n.item.name+" ("+n.item.code+")"),this.onChange()}clear(n,t){"targetText"===t?(n.targetCode="",n.targetType="",n.targetText=""):(n.sourceCode="",n.sourceType="",n.sourceText=""),this.onChange()}localizeTransitionImpact(n){return this.lService.decode("transition.event."+n.toLowerCase())}localizeTransitionType(n){return null==n?null:this.lService.decode("transition.event.type."+n.toLowerCase())}validChange(){setTimeout(()=>{this.valid=null!=this.event.eventDate&&this.event.eventDate.length>0&&this.event.transitions.length>0&&null!=this.event.afterTypeCode&&null!=this.event.beforeTypeCode},0)}remove(n){this.event.transitions.splice(n,1),this.onChange()}onSubmit(){this.service.apply(this.event).then(n=>{this.onEventChange.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}calculateDerivedAttributes(){let n={};this.event.transitions.forEach(t=>{null!=t.sourceCode&&""!==t.sourceCode&&null!=t.targetCode&&""!==t.targetCode&&(null==n[t.sourceCode]?n[t.sourceCode]={source:1,target:0}:n[t.sourceCode].source++,null==n[t.targetCode]?n[t.targetCode]={source:0,target:1}:n[t.targetCode].target++)}),this.event.transitions.forEach(t=>{if(null!=t.sourceCode&&""!==t.sourceCode&&null!=t.targetCode&&""!==t.targetCode){let o=n[t.sourceCode],a=n[t.targetCode],l="UPGRADE";null!=t.transitionType&&-1!==t.transitionType.indexOf("DOWNGRADE")&&(l="DOWNGRADE"),1===o.source&&1===a.target?(t.transitionType="REASSIGN",t.impact="FULL"):o.source>1?(t.impact="PARTIAL",t.transitionType=a.target>1?"MERGE":"SPLIT"):a.target>1&&(t.impact="FULL",t.transitionType="MERGE"),t.sourceType!==t.targetType?"REASSIGN"===t.transitionType?(t.typeUpdown=l,delete t.typePart,t.transitionType=t.typeUpdown):(t.typeUpdown=l,t.typePart=t.transitionType,t.transitionType=t.typeUpdown+"_"+t.typePart):delete t.typePart}})}onChangeTypeUpdown(n){n.transitionType=n.typePart?n.typeUpdown+"_"+n.typePart:n.typeUpdown}onDragStart(n){}onDragEnd(n){}onDragged(n,t){}onDraggableCopied(n){}onDraggableLinked(n){}onDraggableMoved(n){}onDragCanceled(n){}onDragover(n){}onDrop(n){let t=n.data,o=n.index;this.event.transitions.splice(t.order,1),this.event.transitions.splice(o>t.order?o-1:o,0,t);for(let l=0;l<this.event.transitions.length;++l)this.event.transitions[l].order=l;window.setTimeout(()=>{this.onChange()},0)}renderVisual(){if(null==this.event.transitions||0===this.event.transitions.length)return void ln("#svg").remove();ln("#svg").remove();let n=ln("#svg");null==n.node()&&(n=ln("#svgHolder").append("svg"),n.attr("id","svg"));let t=this.generateAppData(),o=this.generateRenderingData(t);(()=>{const l=o.d3;let _=n.append("g").attr("fill","none").attr("stroke","#999").attr("stroke-opacity",.4).attr("stroke-width",.4);_.selectAll("path").data(l.links()).join("path").style("display",function(C){return 0===C.source.depth?"none":null}).attr("d",C=>`\n                      M${C.target.y},${C.target.x}\n                       ${C.source.y},${C.source.x}\n                    `).attr("data-transOid",C=>"root"===C.source.data.name?null:t.linkDataMappings[C.source.data.code+":"+C.target.data.code]),n.append("g").selectAll("circle").data(l.descendants()).join("circle").style("display",function(C){return 0===C.depth?"none":null}).attr("cx",C=>C.y).attr("cy",C=>C.x).attr("fill",C=>"#999").attr("r",.9).attr("data-goCode",C=>C.data.code).attr("data-depth",C=>C.depth),n.append("g").attr("font-family","sans-serif").attr("font-size",2).attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("foreignObject").data(l.descendants()).join("foreignObject").style("display",function(C){return 0===C.depth?"none":null}).attr("x",C=>C.y+(1===C.depth?-13:1)).attr("y",C=>C.x+(1===C.depth?-2:-3)).attr("font-size","0.7em").attr("font-family","sans-serif").attr("font-weight","bold").attr("width",12).attr("height",8).append("xhtml:p").attr("xmlns","http://www.w3.org/1999/xhtml").attr("data-goCode",C=>C.data.code).attr("data-depth",C=>C.depth).style("margin","0.5px").style("vertical-align","middle").style("line-height",1.5).style("color","black").style("padding-left","0.4px").style("padding-top","0.2px").html(C=>C.data.name).filter(C=>1===C.depth).style("text-align","right"),o.multipleParentLinks.forEach(function(C){_.append("path").attr("d",()=>`\n                      M${C.parent.y},${C.parent.x}\n                       ${C.child.y},${C.child.x}\n                    `).attr("data-transOid",()=>C.oid)})})(),this.calculateSvgViewBox()}generateRenderingData(n){const o=Zh(n.d3Data).sort((_,C)=>function es(i,n){return i<n?-1:i>n?1:i>=n?0:NaN}(_.data.order,C.data.order));o.dx=5,o.dy=100/(o.height+1);let a=Ry().nodeSize([o.dx,o.dy]).separation(()=>1.5)(o),l=[];return n.multipleParentLinks.forEach(function(_){let C=o.find(F=>F.data.isSource&&F.data.code===_.parent.code),N=o.find(F=>!F.data.isSource&&F.data.code===_.child.code);null!=C&&null!=N&&l.push({parent:C,child:N,oid:_.oid})}),{d3:a,multipleParentLinks:l}}generateAppData(){let n=[],t=[],o={};return this.event.transitions.forEach(l=>{if(null!=l.sourceCode&&""!==l.sourceCode&&null!=l.targetCode&&""!==l.targetCode){let _=n.findIndex(F=>F.code===l.sourceCode);o[l.sourceCode+":"+l.targetCode]=l.oid;let C=(l=>{for(let _=0;_<n.length;++_){let C=n[_];if(C.children)for(let N=0;N<C.children.length;++N)if(C.children[N].code===l)return!0}return!1})(l.targetCode),N=null;if(C?t.push({oid:l.oid,child:{code:l.targetCode,text:l.targetText,type:l.targetType},parent:{code:l.sourceCode,text:l.sourceText,type:l.sourceType}}):N={name:l.targetText,code:l.targetCode,isSource:!1,children:[]},-1!==_){let F=n[_];null!=F.children.findIndex(ue=>ue.code===l.targetCode)&&null!=N&&F.children.push(N)}else{let F={name:l.sourceText,code:l.sourceCode,children:[],isSource:!0};null!=N&&F.children.push(N),n.push(F)}}}),{d3Data:{name:"root",children:n},multipleParentLinks:t,linkDataMappings:o}}calculateSvgViewBox(){let n=ln("#svg"),t=n.node(),{x:o,y:a,width:l,height:_}=t.getBBox();n.attr("viewBox",o-0+" "+(a-2)+" "+1*(l+0)+" "+1*(_+4))}}function aA(i,n){if(1&i&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&i){const t=n.item;e.xp6(1),e.AsE("",t.name," : ",t.code,"")}}function sA(i,n){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.Oqu(t.label)}}function lA(i,n){1&i&&(e.TgZ(0,"span",29),e._UZ(1,"localize",30),e.qZA())}Rd.\u0275fac=function(n){return new(n||Rd)(e.Y36(su),e.Y36(e.sBO),e.Y36(Zi),e.Y36(pr),e.Y36(nn.oQ),e.Y36(Ln.UZ),e.Y36(nn.e8),e.Y36(zs.R))},Rd.\u0275cmp=e.Xpm({type:Rd,selectors:[["transition-event-modal"]],viewQuery:function(n,t){if(1&n&&e.Gf(SE,5),2&n){let o;e.iGM(o=e.CRH())&&(t.typeaheadParent=o.first)}},decls:7,vars:2,consts:[["customItemTemplate",""],[1,"modal-body","row"],["class","alert alert-danger","role","alert",4,"ngIf"],["autocomplete","off",1,"modal-form"],["form","ngForm"],[4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-6"],[1,"row-holder"],[1,"label-holder"],["key","transition.event.date"],[1,"holder"],["style","line-height: 40px;","class","date-string-display",4,"ngIf"],["label","","name","eventDate",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange","validChange",4,"ngIf"],["class","row-holder",4,"ngFor","ngForOf"],["for","beforeTypeCode"],["key","transition.event.beforeType"],["class","holder",4,"ngIf"],["for","afterTypeCode"],["key","transition.event.afterType"],[1,"row",2,"text-align","center"],["key","transition.event.before"],["key","transition.event.after"],["id","svgHolder",2,"margin-top","10px"],["class","row-holder",4,"ngIf"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],[3,"key"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],[1,"date-string-display",2,"line-height","40px"],[3,"date"],["label","","name","eventDate",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange","validChange"],["key","transition.event.description",2,"display","block"],[2,"color","#BABABA"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],["id","beforeTypeCode","name","beforeTypeCode","required","",1,"select-area",3,"ngModel","disabled","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","beforeType","type","text","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["id","afterTypeCode","name","afterTypeCode","required","",1,"select-area",3,"ngModel","disabled","ngModelChange","change"],["name","afterType","type","text","disabled","",1,"form-control",3,"ngModel","ngModelChange"],[1,"table",2,"border-collapse","separate"],[2,"height","50px","color","grey"],[2,"width","35%","vertical-align","middle"],[2,"width","10%","vertical-align","middle"],["key","transition.event.impact"],["key","transition.event.type"],[2,"width","5%","vertical-align","middle"],["style","width: 5%; vertical-align: middle;",4,"ngIf"],["id","transition-container","dndDropzone","",1,"dndList",3,"dndDisableIf","dndEffectAllowed","dndDrop"],["class","dndPlaceholder","dndPlaceholderRef","",4,"ngIf"],["class","transition","style","height: 50px;",3,"dndDraggable","dndDisableIf","dndEffectAllowed","dndStart","dndCopied","dndLinked","dndMoved","dndCanceled","dndEnd",4,"ngFor","ngForOf"],["style","margin-left: 6px; margin-top: 30px; margin-bottom: 30px;","class","row",4,"ngIf"],["dndPlaceholderRef","",1,"dndPlaceholder"],["colspan","7"],[1,"transition",2,"height","50px",3,"dndDraggable","dndDisableIf","dndEffectAllowed","dndStart","dndCopied","dndLinked","dndMoved","dndCanceled","dndEnd"],["style","vertical-align: middle; text-align: center;",4,"ngIf"],[1,"input-group"],["type","text","autocomplete","off","required","",1,"form-control",3,"name","disabled","ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","typeaheadMinLength","typeaheadWaitMs","container","ngModelChange","typeaheadOnSelect"],[2,"position","absolute"],[2,"position","fixed","z-index","10",3,"id"],["class","input-group-addon clickable addon-alert",3,"click",4,"ngIf"],["class","input-group-addon addon-alert",4,"ngIf"],[2,"vertical-align","middle"],["style","vertical-align:middle;",4,"ngIf"],["style","vertical-align: middle;",4,"ngIf"],[2,"vertical-align","middle","text-align","center"],[1,"fa","fa-bars",2,"font-size","25px","color","#969696","cursor","move"],[1,"input-group-addon","clickable","addon-alert",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"input-group-addon","addon-alert"],["style","min-width:80px;",4,"ngIf"],[2,"min-width","80px"],["style","min-width:80px;","class","select-area","required","",3,"name","ngModel","disabled","ngModelChange","change",4,"ngIf"],["required","",1,"select-area",2,"min-width","80px",3,"name","ngModel","disabled","ngModelChange","change"],["value","UPGRADE"],["key","transition.event.type.upgrade"],["value","DOWNGRADE"],["key","transition.event.type.downgrade"],[1,"clickable",3,"click"],["aria-hidden","true",1,"fa","fa-trash",2,"font-size","30px"],[1,"row",2,"margin-left","6px","margin-top","30px","margin-bottom","30px"],[1,"fa","fa-plus","clickable",3,"click"],["key","changeovertime.manageVersions.newVersion"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"]],template:function(n,t){1&n&&(e.YNc(0,PE,2,2,"ng-template",null,0,e.W1O),e.TgZ(2,"div",1),e.YNc(3,EE,2,1,"div",2),e.TgZ(4,"form",3,4),e.YNc(6,iA,37,10,"fieldset",5),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("ngIf",null!=t.message),e.xp6(3),e.Q6J("ngIf",null!=t.event))},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,A.Bp,Sn.l,al.j,Xl.Q,Fr.u,Pn,at,st],styles:[".dndList[_ngcontent-%COMP%]{transition:all .3s ease}.dndPlaceholder[_ngcontent-%COMP%]{height:50px;background-color:#0000001a}.dndPlaceholder[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px dashed green}"]});const cA=function(i,n){return{"fa-pencil":i,"fa-eye":n}};function uA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.onView(a))}),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.Q6J("ngClass",e.WLB(1,cA,-1!==t.permissions.indexOf("WRITE"),-1===t.permissions.indexOf("WRITE")))}}function pA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",39),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw().$implicit,_=e.oxw();return e.KtG(_.deleteEvent(a,l))}),e.qZA()}}function dA(i,n){if(1&i&&(e.TgZ(0,"tr",31)(1,"td",32),e.YNc(2,uA,1,4,"a",33),e.YNc(3,pA,1,0,"a",34),e.qZA(),e.TgZ(4,"td",35)(5,"h5")(6,"strong"),e._UZ(7,"date-text",36),e.qZA()()(),e.TgZ(8,"td",2)(9,"h5")(10,"strong"),e._uU(11),e.qZA()()(),e.TgZ(12,"td",37)(13,"h5")(14,"strong"),e._uU(15),e.qZA()()(),e.TgZ(16,"td",37)(17,"h5")(18,"strong"),e._uU(19),e.qZA()()(),e.TgZ(20,"td",37)(21,"h5")(22,"strong"),e._uU(23),e.qZA()()()()),2&i){const t=n.$implicit;e.xp6(2),e.Q6J("ngIf",t.permissions.includes("READ")),e.xp6(1),e.Q6J("ngIf",t.permissions.includes("DELETE")),e.xp6(4),e.Q6J("date",t.eventDate),e.xp6(4),e.Oqu(t.description.localizedValue),e.xp6(4),e.Oqu(t.beforeTypeLabel),e.xp6(4),e.Oqu(t.afterTypeLabel),e.xp6(4),e.Oqu(t.eventId)}}function hA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",40)(1,"div",41)(2,"button",42),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCreate())}),e._UZ(3,"localize",43),e.qZA()()()}}function fA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",26)(1,"pagination-controls",44),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.refresh(a))}),e.qZA()()}}const gA=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};class xf{constructor(n,t,o,a,l,_){this.service=n,this.modalService=t,this.iService=o,this.dateService=a,this.authService=l,this.localizeService=_,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.attrConditions=[],this.dateCondition={attribute:"eventDate",startDate:"",endDate:""},this.beforeTypeCondition={attribute:"beforeTypeCode",value:""},this.types=[],this.readOnly=!0}ngOnInit(){this.readOnly=!this.authService.isSRA()&&!this.authService.isRA()&&!this.authService.isRM(),this.refresh(),this.attrConditions.push(this.dateCondition),this.attrConditions.push(this.beforeTypeCondition),this.iService.listGeoObjectTypes(!1).then(n=>{this.types=this.filterTypesBasedOnMyOrg(n)}).catch(n=>{this.error(n)})}filterTypesBasedOnMyOrg(n){let t=this.authService.isSRA(),o=[],a=this.authService.getMyOrganizations();for(let l=0;l<n.length;++l){const _=n[l];(-1!==a.indexOf(_.orgCode)||t)&&o.push(_)}return o}refresh(n=1){this.service.getPage(this.page.pageSize,n,this.attrConditions).then(t=>{this.page=t}).catch(t=>{this.error(t)})}filterChange(){this.refresh(this.page.pageNumber)}onCreate(){this.bsModalRef=this.modalService.show(Rd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(!1),this.bsModalRef.content.onEventChange.subscribe(n=>{this.refresh(this.page.pageNumber)})}deleteEvent(n,t){n.stopPropagation(),this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+t.eventId+"]",this.bsModalRef.content.data=t,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.onConfirm.subscribe(o=>{this.service.delete(t).then(a=>{this.refresh(this.page.pageNumber)}).catch(a=>{this.error(a)})})}onView(n){this.service.getDetails(n.oid).then(t=>{this.bsModalRef=this.modalService.show(Rd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(!1,t),this.bsModalRef.content.onEventChange.subscribe(o=>{this.refresh(this.page.pageNumber)})}).catch(t=>{this.error(t)})}error(n){this.bsModalRef=Zt.qL.showErrorAsDialog(n,this.modalService)}}function _A(i,n){if(1&i&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.super?t.super.label+" : "+t.label:t.label," ")}}function mA(i,n){1&i&&(e.TgZ(0,"span",41),e._UZ(1,"localize",42),e.qZA())}function yA(i,n){if(1&i&&(e.TgZ(0,"tr",43)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"date-text",44),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA()()),2&i){const t=n.$implicit;e.xp6(2),e.hij(" ",t.eventId," "),e.xp6(2),e.Q6J("date",t.eventDate),e.xp6(2),e.hij(" ",t.eventType," "),e.xp6(2),e.hij(" ",t.description.localizedValue," "),e.xp6(2),e.hij(" ",t.beforeType," "),e.xp6(2),e.hij(" ",t.beforeCode," "),e.xp6(2),e.hij(" ",t.beforeLabel.localizedValue," "),e.xp6(2),e.hij(" ",t.afterType," "),e.xp6(2),e.hij(" ",t.afterCode," "),e.xp6(2),e.hij(" ",t.afterLabel.localizedValue," ")}}function vA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",38)(1,"pagination-controls",45),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.refresh(a))}),e.qZA()()}}xf.\u0275fac=function(n){return new(n||xf)(e.Y36(su),e.Y36(Ln.tT),e.Y36(pr),e.Y36(nn.Ru),e.Y36(nn.e8),e.Y36(nn.oQ))},xf.\u0275cmp=e.Xpm({type:xf,selectors:[["transition-event-table"]],decls:44,vars:23,consts:[["customItemTemplate",""],[1,"row",2,"padding-top","10px","padding-bottom","10px"],[1,"col-md-4"],["for","beforeTypeFilter"],["key","transition.event.beforeType"],["id","beforeTypeFilter","name","beforeTypeFilter",1,"select-area",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["for","startDateFilter"],["key","changeovertime.manageVersions.tableHeader.label.startDate"],["label","","name","startDateFilter","customStyles","width:100%; height:40px;",3,"value","classNames","inputName","allowFutureDates","required","valueChange","change"],["for","endDateFilter"],["key","changeovertime.manageVersions.tableHeader.label.endDate"],["label","","name","endDateFilter","customStyles","width:100%; height:40px;",3,"value","classNames","inputName","allowFutureDates","required","valueChange","change"],[1,"row"],["class","col-md-8 error-message","style","text-align:center;",4,"ngIf"],[1,"col-md-12"],[1,"table"],[2,"height","50px","color","grey"],[2,"vertical-align","middle"],["key","transition.event.actions"],["key","transition.event.date"],["key","transition.event.description"],["key","transition.event.afterType"],["key","transition.event.id"],["ngFor","",3,"ngForOf"],["style","margin-top: 30px; margin-bottom: 30px;","class","row",4,"ngIf"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[3,"value"],[1,"col-md-8","error-message",2,"text-align","center"],["key","manage.versions.startdate.later.enddate.message"],[2,"height","50px"],[1,"col-md-1",2,"vertical-align","middle","text-align","left"],["class","fa","aria-hidden","true",3,"ngClass","click",4,"ngIf"],["class","fa fa-trash","aria-hidden","true",3,"click",4,"ngIf"],[1,"col-md-1"],[3,"date"],[1,"col-md-2"],["aria-hidden","true",1,"fa",3,"ngClass","click"],["aria-hidden","true",1,"fa","fa-trash",3,"click"],[1,"row",2,"margin-top","30px","margin-bottom","30px"],[1,"col-md-6"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","hierarchy.management.button.create"],[3,"pageChange"]],template:function(n,t){1&n&&(e.YNc(0,aA,2,2,"ng-template",null,0,e.W1O),e.TgZ(2,"div")(3,"div",1)(4,"span",2)(5,"label",3),e._UZ(6,"localize",4),e.qZA(),e.TgZ(7,"select",5),e.NdJ("ngModelChange",function(a){return t.beforeTypeCondition.value=a})("change",function(){return t.filterChange()}),e._UZ(8,"option"),e.YNc(9,sA,2,2,"option",6),e.qZA()(),e.TgZ(10,"span",2)(11,"label",7),e._UZ(12,"localize",8),e.qZA(),e.TgZ(13,"date-field",9),e.NdJ("valueChange",function(a){return t.dateCondition.startDate=a})("change",function(){return t.filterChange()}),e.qZA()(),e.TgZ(14,"span",2)(15,"label",10),e._UZ(16,"localize",11),e.qZA(),e.TgZ(17,"date-field",12),e.NdJ("valueChange",function(a){return t.dateCondition.endDate=a})("change",function(){return t.filterChange()}),e.qZA()()(),e.TgZ(18,"div",13),e._UZ(19,"span",2),e.YNc(20,lA,2,0,"span",14),e.qZA(),e.TgZ(21,"div",13)(22,"div",15)(23,"table",16)(24,"thead")(25,"tr",17)(26,"th",18),e._UZ(27,"localize",19),e.qZA(),e.TgZ(28,"th",18),e._UZ(29,"localize",20),e.qZA(),e.TgZ(30,"th",18),e._UZ(31,"localize",21),e.qZA(),e.TgZ(32,"th",18),e._UZ(33,"localize",4),e.qZA(),e.TgZ(34,"th",18),e._UZ(35,"localize",22),e.qZA(),e.TgZ(36,"th",18),e._UZ(37,"localize",23),e.qZA()()(),e.TgZ(38,"tbody"),e.YNc(39,dA,24,7,"ng-template",24),e.ALo(40,"paginate"),e.qZA()(),e.YNc(41,hA,4,0,"div",25),e.TgZ(42,"div",26),e.YNc(43,fA,2,0,"div",27),e.qZA()()()()),2&n&&(e.xp6(7),e.Q6J("ngModel",t.beforeTypeCondition.value),e.xp6(2),e.Q6J("ngForOf",t.types),e.xp6(4),e.Q6J("value",t.dateCondition.startDate)("classNames","form-control")("inputName","startDateFilter")("allowFutureDates",!1)("required",!1),e.xp6(4),e.Q6J("value",t.dateCondition.endDate)("classNames","form-control")("inputName","endDateFilter")("allowFutureDates",!1)("required",!1),e.xp6(3),e.Q6J("ngIf",t.dateService.after(t.dateCondition.startDate,t.dateCondition.endDate)),e.xp6(19),e.Q6J("ngForOf",e.xi3(40,16,t.page.resultSet,e.kEZ(19,gA,t.page.pageSize,t.page.pageNumber,t.page.count))),e.xp6(2),e.Q6J("ngIf",!t.readOnly),e.xp6(2),e.Q6J("ngIf",t.page.resultSet.length>0))},dependencies:[T.mk,T.sg,T.O5,y.YN,y.Kr,y.EJ,y.JJ,y.On,U.LS,Sn.l,Xl.Q,Fr.u,U._s],styles:[".vertical-center{position:relative;top:50%;transform:translateY(-50%)}.fa.fa-pencil{margin-right:10px}.status-pending{color:orange}.status-accepted,.status-partial{color:#6ba542}.status-rejected{color:#d43f3a}.status-pending-container{border:solid 2px orange}.status-accepted-container,.status-partial-container{border:solid 2px #6BA542}.status-rejected-container{border:solid 2px #d43f3a}.cr-filter-link-active,.cr-filter-link-active:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active:hover,.cr-filter-link-active:focus{color:#fff}tr.row-active{background-color:#f7f7f7}.arrow{border:solid black;border-width:0 1px 1px 0;display:inline-block;padding:5px}.arrow-right{transform:rotate(-45deg);-webkit-transform:rotate(-45deg)}.arrow-down{transform:rotate(45deg);-webkit-transform:rotate(45deg)}.form-group textarea:focus{border-color:#edf4e8;box-shadow:inset 0 1px 1px #00000013,0 0 8px #6ba54299}textarea[readonly]:focus{box-shadow:none;border:1px solid #ccc;cursor:not-allowed}.geoobject-panel-header{width:100%;background:grey;color:#fff;padding:10px}\n"],encapsulation:2,data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("300ms")]),(0,Y.eR)(":leave",(0,Y.jt)("100ms",(0,Y.oB)({opacity:0})))]),(0,Y.X$)("fadeIn",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")])])]]}});const bA=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};class Cf{constructor(n,t,o,a){this.service=n,this.iService=t,this.authService=o,this.dateService=a,this.message=null,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.data={type:"",startDate:"",endDate:""},this.types=[],this.isValid=!1}ngOnInit(){this.iService.listGeoObjectTypes(!0).then(n=>{this.types=n}).catch(n=>{this.error(n)})}refresh(n=1){this.service.getHistoricalReport(this.data.type,this.data.startDate,this.data.endDate,this.page.pageSize,n).then(t=>{this.page=t}).catch(t=>{this.error(t)})}exportToExcel(){let n=new ot.LE;n=n.set("typeCode",this.data.type.toString()),n=n.set("startDate",this.data.startDate.toString()),n=n.set("endDate",this.data.endDate.toString()),window.location.href=pt.N.apiUrl+"/api/transition-event/export-excel?"+n.toString()}checkDates(){setTimeout(()=>{this.isValid=null!=this.data.startDate&&null!=this.data.endDate&&!this.dateService.after(this.data.startDate,this.data.endDate)},0)}error(n){this.message=Zt.qL.getMessageFromError(n)}}function xA(i,n){1&i&&e._UZ(0,"localize",10)}function CA(i,n){1&i&&e._UZ(0,"localize",11)}function wA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"div",12)(3,"a",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleTab("HISTORICAL-EVENT"))}),e._UZ(4,"localize",10),e.qZA(),e.TgZ(5,"a",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleTab("HISTORICAL-REPORT"))}),e._UZ(6,"localize",11),e.qZA()(),e._UZ(7,"hr",15),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngClass","HISTORICAL-EVENT"===t.tab?"cr-filter-link-active":""),e.xp6(2),e.Q6J("ngClass","HISTORICAL-REPORT"===t.tab?"cr-filter-link-active":"")}}function TA(i,n){1&i&&e._UZ(0,"transition-event-table")}function MA(i,n){1&i&&e._UZ(0,"historical-report")}Cf.\u0275fac=function(n){return new(n||Cf)(e.Y36(su),e.Y36(pr),e.Y36(nn.e8),e.Y36(nn.Ru))},Cf.\u0275cmp=e.Xpm({type:Cf,selectors:[["historical-report"]],decls:62,vars:23,consts:[["autocomplete","off"],["form","ngForm"],[1,"form-group","row"],["for","code",1,"col-md-2","text-right"],["key","io.geoObjectType"],[1,"col-md-8"],["id","code","name","code","required","",1,"select-area",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-2"],["for","startDate",1,"col-md-2","text-right"],["key","io.startDate"],["label","",3,"value","inputName","allowFutureDates","required","valueChange","change"],["dateFieldComponents",""],["class","col-md-8 error-message","style","text-align:center;",4,"ngIf"],["for","endDate",1,"col-md-2","text-right"],["key","io.endDate"],[1,"col-md-4"],["label","",3,"value","inputName","allowInfinity","allowFutureDates","required","valueChange","change"],[1,"button-holder","col-md-8","text-right"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"],["key","io.export"],[1,"row"],[1,"col-md-12"],[1,"table"],[2,"height","50px","color","grey"],[2,"vertical-align","middle"],["key","historical.row.eventId"],["key","historical.row.eventDate"],["key","historical.row.eventType"],["key","historical.row.description"],["key","historical.row.beforeType"],["key","historical.row.beforeCode"],["key","historical.row.beforeLabel"],["key","historical.row.afterType"],["key","historical.row.afterCode"],["key","historical.row.afterLabel"],["ngFor","",3,"ngForOf"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[3,"value"],[1,"col-md-8","error-message",2,"text-align","center"],["key","manage.versions.startdate.later.enddate.message"],[2,"height","50px"],[3,"date"],[3,"pageChange"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div")(1,"form",0,1)(3,"div",2)(4,"label",3),e._UZ(5,"localize",4),e.qZA(),e.TgZ(6,"div",5)(7,"select",6),e.NdJ("ngModelChange",function(a){return t.data.type=a}),e._UZ(8,"option"),e.YNc(9,_A,2,2,"option",7),e.qZA()(),e._UZ(10,"div",8),e.qZA(),e.TgZ(11,"div",2)(12,"label",9),e._UZ(13,"localize",10),e.qZA(),e.TgZ(14,"div",8)(15,"date-field",11,12),e.NdJ("valueChange",function(a){return t.data.startDate=a})("change",function(){return t.checkDates()}),e.qZA(),e.YNc(17,mA,2,0,"span",13),e.qZA(),e.TgZ(18,"label",14),e._UZ(19,"localize",15),e.qZA(),e.TgZ(20,"div",16)(21,"date-field",17,12),e.NdJ("valueChange",function(a){return t.data.endDate=a})("change",function(){return t.checkDates()}),e.qZA()()(),e.TgZ(23,"div",2),e._UZ(24,"div",8),e.TgZ(25,"div",18)(26,"button",19),e.NdJ("click",function(){return t.refresh()}),e._UZ(27,"localize",20),e.qZA(),e.TgZ(28,"button",19),e.NdJ("click",function(){return t.exportToExcel()}),e._UZ(29,"localize",21),e.qZA()(),e._UZ(30,"div",8),e.qZA()(),e.TgZ(31,"div",22)(32,"div",23)(33,"table",24)(34,"thead")(35,"tr",25)(36,"th",26),e._UZ(37,"localize",27),e.qZA(),e.TgZ(38,"th",26),e._UZ(39,"localize",28),e.qZA(),e.TgZ(40,"th",26),e._UZ(41,"localize",29),e.qZA(),e.TgZ(42,"th",26),e._UZ(43,"localize",30),e.qZA(),e.TgZ(44,"th",26),e._UZ(45,"localize",31),e.qZA(),e.TgZ(46,"th",26),e._UZ(47,"localize",32),e.qZA(),e.TgZ(48,"th",26),e._UZ(49,"localize",33),e.qZA(),e.TgZ(50,"th",26),e._UZ(51,"localize",34),e.qZA(),e.TgZ(52,"th",26),e._UZ(53,"localize",35),e.qZA(),e.TgZ(54,"th",26),e._UZ(55,"localize",36),e.qZA(),e._UZ(56,"th"),e.qZA()(),e.TgZ(57,"tbody"),e.YNc(58,yA,21,10,"ng-template",37),e.ALo(59,"paginate"),e.qZA()(),e.TgZ(60,"div",38),e.YNc(61,vA,2,0,"div",39),e.qZA()()()()),2&n){const o=e.MAs(2);e.xp6(7),e.Q6J("ngModel",t.data.type),e.xp6(2),e.Q6J("ngForOf",t.types),e.xp6(6),e.Q6J("value",t.data.startDate)("inputName","startDate")("allowFutureDates",!1)("required",!0),e.xp6(2),e.Q6J("ngIf",t.dateService.after(t.data.startDate,t.data.endDate)),e.xp6(4),e.Q6J("value",t.data.endDate)("inputName","endDate")("allowInfinity",!0)("allowFutureDates",!0)("required",!0),e.xp6(5),e.Q6J("disabled",!t.isValid||o.invalid),e.xp6(2),e.Q6J("disabled",!t.isValid||o.invalid),e.xp6(30),e.Q6J("ngForOf",e.xi3(59,16,t.page.resultSet,e.kEZ(19,bA,t.page.pageSize,t.page.pageNumber,t.page.count))),e.xp6(3),e.Q6J("ngIf",t.page.resultSet.length>0)}},dependencies:[T.sg,T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,U.LS,Sn.l,Xl.Q,Fr.u,U._s],encapsulation:2,data:{animation:[[(0,Y.X$)("fadeInOut",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("300ms")]),(0,Y.eR)(":leave",(0,Y.jt)("100ms",(0,Y.oB)({opacity:0})))]),(0,Y.X$)("fadeIn",[(0,Y.eR)(":enter",[(0,Y.oB)({opacity:0}),(0,Y.jt)("500ms")])])]]}});class wf{constructor(n){this.authService=n,this.tab="HISTORICAL-EVENT",this.readOnly=!1}ngOnInit(){this.readOnly=this.authService.isRC(!0),this.tab=this.readOnly?"HISTORICAL-REPORT":"HISTORICAL-EVENT"}handleTab(n){this.tab=n}}wf.\u0275fac=function(n){return new(n||wf)(e.Y36(nn.e8))},wf.\u0275cmp=e.Xpm({type:wf,selectors:[["historical-event-module"]],decls:17,vars:5,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid",2,"height","100%"],[1,"row"],[1,"col-md-12"],[1,"heading"],["key","transition.event.events",4,"ngIf"],["key","historical.row.report",4,"ngIf"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],["class","row",4,"ngIf"],[4,"ngIf"],["key","transition.event.events"],["key","historical.row.report"],[1,"form-group","button-row"],[2,"border-bottom","1px solid",3,"routerLink","ngClass","click"],[2,"margin-left","5px","border-bottom","1px solid",3,"routerLink","ngClass","click"],[2,"border-top","solid 3px #6BA542"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div")(7,"div",4)(8,"h2"),e.YNc(9,xA,1,0,"localize",5),e.YNc(10,CA,1,0,"localize",6),e.qZA()(),e.TgZ(11,"div",7),e.YNc(12,wA,8,2,"div",8),e.TgZ(13,"div",2)(14,"div",3),e.YNc(15,TA,1,0,"transition-event-table",9),e.YNc(16,MA,1,0,"historical-report",9),e.qZA()()()()()()()()),2&n&&(e.xp6(9),e.Q6J("ngIf","HISTORICAL-EVENT"===t.tab),e.xp6(1),e.Q6J("ngIf","HISTORICAL-REPORT"===t.tab),e.xp6(2),e.Q6J("ngIf",!t.readOnly),e.xp6(3),e.Q6J("ngIf","HISTORICAL-EVENT"===t.tab),e.xp6(1),e.Q6J("ngIf","HISTORICAL-REPORT"===t.tab))},dependencies:[T.mk,T.O5,w.rH,Sn.l,Da.N,ba.C,xf,Cf],encapsulation:2});var OA=v(49276);function SA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",16),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"input",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","metadata-displayLabel-"+t.locale)("disabled",o.readonly)("required",!1)}}function PA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",20),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"textarea",21),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function EA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",22),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"textarea",23),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function AA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",24),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"input",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","progress-"+t.locale)("disabled",o.readonly)("required",!1)}}function kA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",25),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"input",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","accessConstraints-"+t.locale)("disabled",o.readonly)("required",!1)}}function IA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",26),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"input",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","useConstraints-"+t.locale)("disabled",o.readonly)("required",!1)}}function ZA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",27),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"textarea",28),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function NA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",29),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"textarea",30),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function LA(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"label"),e._UZ(4,"localize",31),e.qZA()(),e.TgZ(5,"div",7)(6,"input",32),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.topicCategories=a)}),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"label"),e._UZ(10,"localize",33),e.qZA()(),e.TgZ(11,"div",7)(12,"input",34),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.placeKeywords=a)}),e.qZA()()(),e.TgZ(13,"div",4)(14,"div",5)(15,"label"),e._UZ(16,"localize",35),e.qZA()(),e.TgZ(17,"div",7)(18,"input",36),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.updateFrequency=a)}),e.qZA()()(),e.TgZ(19,"div",4)(20,"div",5)(21,"label"),e._UZ(22,"localize",37),e.qZA()(),e.TgZ(23,"div",7)(24,"input",38),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.lineage=a)}),e.qZA()()(),e.TgZ(25,"div",4)(26,"div",5)(27,"label"),e._UZ(28,"localize",39),e.qZA()(),e.TgZ(29,"div",7)(30,"input",40),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.languages=a)}),e.qZA()()(),e.TgZ(31,"div",4)(32,"div",5)(33,"label"),e._UZ(34,"localize",41),e.qZA()(),e.TgZ(35,"div",7)(36,"input",42),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.scaleResolution=a)}),e.qZA()()(),e.TgZ(37,"div",4)(38,"div",5)(39,"label"),e._UZ(40,"localize",43),e.qZA()(),e.TgZ(41,"div",7)(42,"select",44),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.spatialRepresentation=a)}),e.TgZ(43,"option",45),e._UZ(44,"localize",46),e.qZA()()()(),e.TgZ(45,"div",4)(46,"div",5)(47,"label"),e._UZ(48,"localize",47),e.qZA()(),e.TgZ(49,"div",7)(50,"select",48),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.referenceSystem=a)}),e.TgZ(51,"option",49),e._UZ(52,"localize",50),e.qZA()()()(),e.TgZ(53,"div",4)(54,"div",5)(55,"label"),e._UZ(56,"localize",51),e.qZA()(),e.TgZ(57,"div",7)(58,"input",52),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.reportSpecification=a)}),e.qZA()()(),e.TgZ(59,"div",4)(60,"div",5)(61,"label"),e._UZ(62,"localize",53),e.qZA()(),e.TgZ(63,"div",7)(64,"select",54),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.distributionFormat=a)}),e._UZ(65,"option"),e.TgZ(66,"option",55),e._UZ(67,"localize",56),e.qZA()()()(),e.BQk()}if(2&i){const t=e.oxw().metadata,o=e.oxw();e.xp6(6),e.Q6J("ngModel",t.topicCategories)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.placeKeywords)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.updateFrequency)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.lineage)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.languages)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.scaleResolution)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.spatialRepresentation)("disabled",!0),e.xp6(8),e.Q6J("ngModel",t.referenceSystem)("disabled",!0),e.xp6(8),e.Q6J("ngModel",t.reportSpecification)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.distributionFormat)("disabled",!0)}}function zA(i,n){if(1&i){const t=e.EpF();e.YNc(0,SA,10,5,"div",3),e.TgZ(1,"div",4)(2,"div",5)(3,"label"),e._UZ(4,"localize",6),e.qZA()(),e.TgZ(5,"div",7)(6,"input",8),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.originator=a)}),e.qZA()()(),e.YNc(7,PA,10,4,"div",3),e.YNc(8,EA,10,4,"div",3),e.YNc(9,AA,10,5,"div",3),e.YNc(10,kA,10,5,"div",3),e.YNc(11,IA,10,5,"div",3),e.YNc(12,ZA,10,4,"div",3),e.YNc(13,NA,10,4,"div",3),e.YNc(14,LA,68,20,"ng-container",2),e.TgZ(15,"div",4),e._UZ(16,"div",5),e.TgZ(17,"div",7),e._UZ(18,"localize",9),e.qZA()(),e.TgZ(19,"div",4)(20,"div",5)(21,"label"),e._UZ(22,"localize",10),e.qZA()(),e.TgZ(23,"div",7)(24,"input",11),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.contactName=a)}),e.qZA()()(),e.TgZ(25,"div",4)(26,"div",5)(27,"label"),e._UZ(28,"localize",12),e.qZA()(),e.TgZ(29,"div",7)(30,"input",13),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.telephoneNumber=a)}),e.qZA()()(),e.TgZ(31,"div",4)(32,"div",5)(33,"label"),e._UZ(34,"localize",14),e.qZA()(),e.TgZ(35,"div",7)(36,"input",15),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.email=a)}),e.qZA()()()}if(2&i){const t=n.metadata,o=n.type,a=e.oxw();e.Q6J("ngForOf",t.label.localeValues),e.xp6(6),e.Q6J("ngModel",t.originator)("disabled",a.readonly),e.xp6(1),e.Q6J("ngForOf",t.description.localeValues),e.xp6(1),e.Q6J("ngForOf",t.process.localeValues),e.xp6(1),e.Q6J("ngForOf",t.progress.localeValues),e.xp6(1),e.Q6J("ngForOf",t.accessConstraints.localeValues),e.xp6(1),e.Q6J("ngForOf",t.useConstraints.localeValues),e.xp6(1),e.Q6J("ngForOf",t.acknowledgements.localeValues),e.xp6(1),e.Q6J("ngForOf",t.disclaimer.localeValues),e.xp6(1),e.Q6J("ngIf","geospatial"===o),e.xp6(10),e.Q6J("ngModel",t.contactName)("disabled",a.readonly),e.xp6(6),e.Q6J("ngModel",t.telephoneNumber)("disabled",a.readonly),e.xp6(6),e.Q6J("ngModel",t.email)("disabled",a.readonly)}}function DA(i,n){if(1&i&&(e.TgZ(0,"div",83),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message)}}function RA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",16),e.TgZ(4,"span",17),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",7)(9,"input",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("disabled",o.readonly)("required","defaultLocale"===t.locale)}}function FA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label"),e._UZ(3,"localize",20),e.TgZ(4,"span",17),e._uU(5," \xa0("),e._UZ(6,"convert-key-label",18),e._uU(7,") "),e.qZA()()(),e.TgZ(8,"div",7)(9,"input",19),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","description-"+t.locale)("disabled",o.readonly)("required","defaultLocale"===t.locale)}}function UA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label",72),e._UZ(3,"localize",84),e.qZA()(),e.TgZ(4,"div",7)(5,"boolean-field",85),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.list.includeLatLong=a)}),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("value",t.list.includeLatLong)("disable",t.readonly||!t.isNew)}}const av=function(i,n){return{"chk-checked":i,disabled:n}};function qA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",87)(1,"div",88)(2,"div",89),e.NdJ("click",function(a){const _=e.CHM(t).$implicit,C=e.oxw(4);return e.KtG(C.getIsDisabled(a)?null:_.selected=!_.selected)}),e._UZ(3,"span"),e.qZA(),e.TgZ(4,"label",90),e._uU(5),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(4);e.xp6(2),e.Q6J("ngClass",e.WLB(2,av,t.selected,o.readonly||!o.isNew)),e.xp6(3),e.Oqu(t.label)}}function JA(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"label"),e._uU(4),e.qZA()(),e.TgZ(5,"div",7),e.YNc(6,qA,6,5,"div",86),e.qZA()(),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.label," "),e.xp6(2),e.Q6J("ngForOf",t.parents)}}function jA(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,JA,7,2,"ng-container",2),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.parents.length>0)}}function BA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",87)(1,"div",88)(2,"div",89),e.NdJ("click",function(a){const _=e.CHM(t).$implicit,C=e.oxw(3);return e.KtG(C.getIsDisabled(a)?null:_.selected=!_.selected)}),e._UZ(3,"span"),e.qZA(),e.TgZ(4,"label",90),e._uU(5),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(2),e.Q6J("ngClass",e.WLB(2,av,t.selected,o.readonly||!o.isNew)),e.xp6(3),e.Oqu(t.label)}}function GA(i,n){if(1&i&&(e.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"label"),e._UZ(4,"localize",91),e.qZA()(),e.TgZ(5,"div",7),e.YNc(6,BA,6,5,"div",86),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.list.subtypeHierarchies)}}function VA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"label",92),e._UZ(3,"localize",93),e.qZA()(),e.TgZ(4,"div",7)(5,"date-field",94),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.list.validOn=a)})("valueChange",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handleDateChange())}),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("value",t.list.validOn)("classNames","form-control")("inputName","validOn")("allowFutureDates",!1)("required",!0)("disable",t.readonly||!t.isNew)}}function YA(i,n){1&i&&(e.TgZ(0,"div",110)(1,"p",111),e._UZ(2,"localize",112),e.qZA()())}function HA(i,n){if(1&i&&(e.TgZ(0,"span",113),e._UZ(1,"date-text",114),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("date",t.list.publishingStartDate)}}function QA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"date-field",115),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.list.publishingStartDate=a)})("valueChange",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handleDateChange())}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("value",t.list.publishingStartDate)("classNames","form-control")("inputName","publishingStartDate")("allowFutureDates",!1)("required",!0)("disable",t.readonly||!t.isNew)}}function KA(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"label"),e._UZ(4,"localize",95),e.qZA()(),e.TgZ(5,"div",7)(6,"select",96,97),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.list.frequency=a)}),e._UZ(8,"option"),e.TgZ(9,"option",98),e._UZ(10,"localize",99),e.qZA(),e.TgZ(11,"option",100),e._UZ(12,"localize",101),e.qZA(),e.TgZ(13,"option",102),e._UZ(14,"localize",103),e.qZA(),e.TgZ(15,"option",104),e._UZ(16,"localize",105),e.qZA()(),e.YNc(17,YA,3,0,"div",106),e.qZA()(),e.TgZ(18,"div",4)(19,"div",5)(20,"label"),e._UZ(21,"localize",107),e.qZA()(),e.TgZ(22,"div",7),e.YNc(23,HA,2,1,"span",108),e.YNc(24,QA,1,6,"date-field",109),e.qZA()(),e.BQk()}if(2&i){const t=e.MAs(7),o=e.oxw(2);e.xp6(6),e.Q6J("ngModel",o.list.frequency)("disabled",o.readonly||!o.isNew),e.xp6(11),e.Q6J("ngIf",!o.list.frequency&&t.dirty),e.xp6(6),e.Q6J("ngIf",o.readonly),e.xp6(1),e.Q6J("ngIf",!o.readonly)}}function $A(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",125),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().index,l=e.oxw(3);return e.KtG(l.removeInterval(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"button.delete.helptext"))}function WA(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",87)(2,"div",118)(3,"label"),e._UZ(4,"localize",119),e.qZA()(),e.TgZ(5,"div",118)(6,"label"),e._UZ(7,"localize",120),e.qZA()(),e._UZ(8,"div",121),e.qZA(),e.TgZ(9,"div",87)(10,"div",118)(11,"date-field",122),e.NdJ("valueChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.startDate=a)})("valueChange",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handleDateChange())}),e.qZA()(),e.TgZ(12,"div",118)(13,"date-field",123),e.NdJ("valueChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.endDate=a)})("valueChange",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handleDateChange())}),e.qZA()(),e.TgZ(14,"div",121),e.YNc(15,$A,2,3,"i",124),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(11),e.Q6J("value",t.startDate)("classNames","form-control")("inputName","startDate-"+t.oid)("allowFutureDates",!1)("required",!0)("disable",o.readonly||!o.isNew&&null!=t.readonly),e.xp6(2),e.Q6J("value",t.endDate)("classNames","form-control")("inputName","endDate-"+t.oid)("allowInfinity",!0)("required",!0)("disable",o.readonly||!o.isNew&&"BOTH"==t.readonly),e.xp6(2),e.Q6J("ngIf",o.isNew||null==t.readonly)}}function XA(i,n){1&i&&(e.TgZ(0,"div",131),e._UZ(1,"localize",132),e.qZA())}function e5(i,n){1&i&&(e.TgZ(0,"div",133),e._UZ(1,"localize",134),e.qZA())}function t5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",87)(1,"div",126)(2,"button",127),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onNewInterval())}),e._UZ(3,"localize",128),e.qZA(),e.YNc(4,XA,2,0,"div",129),e.YNc(5,e5,2,0,"div",130),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(4),e.Q6J("ngIf",!t.valid),e.xp6(1),e.Q6J("ngIf",t.gap)}}function n5(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"label"),e._UZ(4,"localize",116),e.qZA()(),e.TgZ(5,"div",7),e.YNc(6,WA,16,13,"div",78),e.YNc(7,t5,6,2,"div",117),e.qZA()(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.list.intervalJson),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}function i5(i,n){if(1&i&&(e.TgZ(0,"option",139),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij(" ",t.label.localizedValue," ")}}function o5(i,n){if(1&i&&(e.ynx(0),e.YNc(1,i5,2,2,"option",138),e.BQk()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.isChangeOverTime&&"local"!==t.type)}}function r5(i,n){1&i&&(e.TgZ(0,"option",147),e._UZ(1,"localize",148),e.qZA())}function a5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"classification-field",149),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw().ngIf,o=e.oxw().$implicit,a=e.oxw(3);e.xp6(1),e.Q6J("classificationType",t.classificationType)("name","filter-value"+o.id)("value",o.value)("disabled",!a.isNew)}}function s5(i,n){if(1&i&&(e.TgZ(0,"option",139),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t.code),e.xp6(1),e.hij("",t.label.localizedValue," ")}}function l5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",150),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e._UZ(2,"option",151),e.YNc(3,s5,2,2,"option",152),e.qZA(),e.BQk()}if(2&i){const t=e.oxw().ngIf,o=e.oxw().$implicit,a=e.oxw(3);e.xp6(1),e.Q6J("name","filter-value"+o.id)("ngModel",o.value)("disabled",!a.isNew),e.xp6(2),e.Q6J("ngForOf",a.getGeoObjectTypeTermAttributeOptions(t.code))}}function c5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"boolean-field",153),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("disable",!o.isNew)("value",t.value)}}function u5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"date-field",154),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("value",t.value)("classNames","form-control")("inputName","filter-value"+t.id)("disable",!o.isNew)}}function p5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",155),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.value)("name","filter-value"+t.id)("disabled",!o.isNew)("required",!1)}}function d5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",19),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.value=a)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.value)("name","filter-value"+t.id)("disabled",!o.isNew)("required",!1)}}function h5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",136)(2,"select",137),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.operation=a)}),e.TgZ(3,"option",140),e._UZ(4,"localize",141),e.qZA(),e.YNc(5,r5,2,0,"option",142),e.qZA()(),e.TgZ(6,"div",143),e.ynx(7,144),e.YNc(8,a5,2,4,"ng-container",145),e.YNc(9,l5,4,4,"ng-container",145),e.YNc(10,c5,2,2,"ng-container",145),e.YNc(11,u5,2,4,"ng-container",145),e.YNc(12,p5,2,4,"ng-container",145),e.YNc(13,d5,2,4,"ng-container",146),e.BQk(),e.qZA(),e.BQk()}if(2&i){const t=n.ngIf,o=e.oxw().$implicit,a=e.oxw(3);e.xp6(2),e.Q6J("name","filter-operation"+o.id)("ngModel",o.operation)("disabled",a.readonly||!a.isNew),e.xp6(3),e.Q6J("ngIf","classification"===t.type),e.xp6(2),e.Q6J("ngSwitch",t.type),e.xp6(1),e.Q6J("ngSwitchCase","classification"),e.xp6(1),e.Q6J("ngSwitchCase","term"),e.xp6(1),e.Q6J("ngSwitchCase","boolean"),e.xp6(1),e.Q6J("ngSwitchCase","date"),e.xp6(1),e.Q6J("ngSwitchCase","float")}}function f5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"i",125),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().index,l=e.oxw(3);return e.KtG(l.removeFilter(a))}),e.ALo(1,"localize"),e.qZA()}2&i&&e.Q6J("title",e.lcZ(1,1,"button.delete.helptext"))}function g5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",87)(2,"div",136)(3,"select",137),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.attribute=a)}),e._UZ(4,"option"),e.YNc(5,o5,2,1,"ng-container",78),e.qZA()(),e.YNc(6,h5,14,10,"ng-container",2),e.TgZ(7,"div",121),e.YNc(8,f5,2,3,"i",124),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(3),e.Q6J("name","filter"+t.id)("ngModel",t.attribute)("disabled",o.readonly||!o.isNew),e.xp6(2),e.Q6J("ngForOf",o.geoObjectType.attributes),e.xp6(1),e.Q6J("ngIf",o.getAttributeForFilter(t)),e.xp6(2),e.Q6J("ngIf",o.isNew)}}function _5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",87)(1,"div",126)(2,"button",127),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onNewFilter())}),e._UZ(3,"localize",128),e.qZA()()()}}function m5(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"label"),e._UZ(4,"localize",135),e.qZA()(),e.TgZ(5,"div",7),e.YNc(6,g5,9,6,"div",78),e.YNc(7,_5,4,0,"div",117),e.qZA()(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.list.filter),e.xp6(1),e.Q6J("ngIf",t.isNew&&!t.readonly)}}const y5=function(i){return{metadata:i,type:"list"}};function v5(i,n){if(1&i&&e.GkF(0,166),2&i){const t=e.oxw(3),o=e.MAs(1);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,y5,t.list.listMetadata))}}const b5=function(i){return{metadata:i,type:"geospatial"}};function x5(i,n){if(1&i&&e.GkF(0,166),2&i){const t=e.oxw(3),o=e.MAs(1);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,b5,t.list.geospatialMetadata))}}function C5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",156)(1,"div",87)(2,"div",126)(3,"div",58)(4,"h2"),e._UZ(5,"localize",157),e.qZA(),e._UZ(6,"hr"),e.qZA(),e._UZ(7,"div",5),e.TgZ(8,"div",7)(9,"div",158)(10,"div",159)(11,"label",160),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handleTab("LIST"))}),e.TgZ(12,"span",161),e._UZ(13,"localize",162),e.qZA()(),e.TgZ(14,"label",160),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handleTab("GEOSPATIAL"))}),e.TgZ(15,"span",161),e._UZ(16,"localize",163),e.qZA()()()()(),e._UZ(17,"hr",164),e.qZA()(),e.TgZ(18,"div",87)(19,"div",126),e.YNc(20,v5,1,4,"ng-container",165),e.YNc(21,x5,1,4,"ng-container",165),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(11),e.Q6J("ngClass","LIST"===t.tab?"active":""),e.xp6(3),e.Q6J("ngClass","GEOSPATIAL"===t.tab?"active":""),e.xp6(6),e.Q6J("ngIf","LIST"===t.tab),e.xp6(1),e.Q6J("ngIf","GEOSPATIAL"===t.tab)}}function w5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",167),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSubmit())}),e._UZ(1,"localize",168),e.qZA()}if(2&i){e.oxw();const t=e.MAs(7),o=e.oxw();e.Q6J("disabled",t.invalid||!o.valid)}}function T5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,DA,2,1,"div",57),e.TgZ(2,"div",58)(3,"h2"),e._UZ(4,"localize",59),e.qZA(),e._UZ(5,"hr"),e.qZA(),e.TgZ(6,"form",60,61)(8,"fieldset")(9,"div",62)(10,"label",63)(11,"input",64),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.list.listType=a)}),e.qZA(),e.TgZ(12,"span"),e._UZ(13,"localize",65),e.qZA()(),e.TgZ(14,"label",63)(15,"input",66),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.list.listType=a)}),e.qZA(),e.TgZ(16,"span"),e._UZ(17,"localize",67),e.qZA()(),e.TgZ(18,"label",63)(19,"input",68),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.list.listType=a)}),e.qZA(),e.TgZ(20,"span"),e._UZ(21,"localize",69),e.qZA()()(),e.TgZ(22,"div",4)(23,"div",5)(24,"label"),e._UZ(25,"localize",70),e.qZA()(),e.TgZ(26,"div",7)(27,"input",71),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.list.code=a)}),e.qZA()()(),e.YNc(28,RA,10,5,"div",3),e.YNc(29,FA,10,5,"div",3),e.TgZ(30,"div",4)(31,"div",5)(32,"label",72),e._UZ(33,"localize",73),e.qZA()(),e.TgZ(34,"div",7)(35,"input",74),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.list.typeLabel=a)}),e.qZA()()(),e.TgZ(36,"div",4)(37,"div",5)(38,"label",72),e._UZ(39,"localize",75),e.qZA()(),e.TgZ(40,"div",7)(41,"input",76),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.list.typeCode=a)}),e.qZA()()(),e.YNc(42,UA,6,2,"div",77),e.YNc(43,jA,2,1,"div",78),e.YNc(44,GA,7,1,"div",2),e.YNc(45,VA,6,6,"div",77),e.YNc(46,KA,25,5,"ng-container",2),e.YNc(47,n5,8,2,"ng-container",2),e.YNc(48,m5,8,2,"ng-container",2),e.YNc(49,C5,22,4,"div",79),e.TgZ(50,"div",4),e._UZ(51,"div",5),e.TgZ(52,"div")(53,"div",80)(54,"button",81),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCancel())}),e._UZ(55,"localize",18),e.qZA(),e.YNc(56,w5,2,1,"button",82),e.qZA()()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(10),e.Q6J("checked","single"===t.list.listType)("value","single")("ngModel",t.list.listType)("disabled",t.readonly||!t.isNew),e.xp6(4),e.Q6J("checked","incremental"===t.list.listType)("value","incremental")("ngModel",t.list.listType)("disabled",t.readonly||!t.isNew),e.xp6(4),e.Q6J("checked","interval"===t.list.listType)("value","interval")("ngModel",t.list.listType)("disabled",t.readonly||!t.isNew),e.xp6(8),e.Q6J("ngModel",t.list.code)("disabled",t.readonly||!t.isNew),e.xp6(1),e.Q6J("ngForOf",t.list.displayLabel.localeValues),e.xp6(1),e.Q6J("ngForOf",t.list.description.localeValues),e.xp6(6),e.Q6J("ngModel",t.list.typeLabel),e.xp6(6),e.Q6J("ngModel",t.list.typeCode),e.xp6(1),e.Q6J("ngIf",void 0!==t.list.includeLatLong),e.xp6(1),e.Q6J("ngForOf",t.list.hierarchies),e.xp6(1),e.Q6J("ngIf",t.list.subtypeHierarchies.length>0),e.xp6(1),e.Q6J("ngIf","single"===t.list.listType),e.xp6(1),e.Q6J("ngIf","incremental"===t.list.listType),e.xp6(1),e.Q6J("ngIf","interval"===t.list.listType),e.xp6(1),e.Q6J("ngIf",null!=t.geoObjectType&&(t.isNew||null!=t.list.filter&&t.list.filter.length>0)),e.xp6(1),e.Q6J("ngIf",t.isNew),e.xp6(6),e.Q6J("key",t.readonly?"io.back":"io.cancel"),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}class Up{constructor(n,t,o,a,l,_){this.service=n,this.iService=t,this.lService=o,this.cacheService=a,this.bsModalRef=l,this.dateService=_,this.currentDate=new Date,this.message=null,this.onListTypeChange=null,this.list=null,this.geoObjectType=null,this.tab="LIST",this.readonly=!1,this.isNew=!1,this.valid=!0,this.gap=!1}ngOnInit(){}init(n,t,o){this.onListTypeChange=t,this.readonly=!n.write;const a=this.cacheService.getTypeCache();a.waitOnTypes().then(l=>{this.geoObjectType=a.getTypeByCode(n.typeCode)}),null==o?(this.isNew=!0,this.list={oid:null,listType:"single",organization:"",typeCode:"",typeLabel:"",displayLabel:this.lService.create(),description:this.lService.create(),code:n.typeCode+"_"+Math.floor(999999*Math.random()),hierarchies:[],subtypeHierarchies:[],listMetadata:{label:this.lService.create(),description:this.lService.create(),originator:"",collectionDate:"",process:this.lService.create(),progress:this.lService.create(),accessConstraints:this.lService.create(),useConstraints:this.lService.create(),acknowledgements:this.lService.create(),disclaimer:this.lService.create(),contactName:"",organization:"",telephoneNumber:"",email:""},geospatialMetadata:{label:this.lService.create(),description:this.lService.create(),originator:"",collectionDate:"",process:this.lService.create(),progress:this.lService.create(),accessConstraints:this.lService.create(),useConstraints:this.lService.create(),acknowledgements:this.lService.create(),disclaimer:this.lService.create(),contactName:"",organization:"",telephoneNumber:"",email:"",topicCategories:"",placeKeywords:"",updateFrequency:"",lineage:"",languages:"",scaleResolution:"",spatialRepresentation:"vector",referenceSystem:"EPSG4326",reportSpecification:"",distributionFormat:"SHAPEFILE"}},this.list.typeCode=n.typeCode,this.list.typeLabel=n.typeLabel,this.list.organization=n.orgCode,("MULTIPOINT"===n.geometryType||"POINT"===n.geometryType)&&(this.list.includeLatLong=!0),this.iService.getHierarchiesForType(this.list.typeCode,!0).then(l=>{this.list.hierarchies=l}).catch(l=>{this.error(l)}),this.iService.getHierarchiesForSubtypes(this.list.typeCode,!1).then(l=>{this.list.subtypeHierarchies=l}).catch(l=>{this.error(l)})):(this.list=o,this.isNew=!1,"interval"===this.list.listType&&this.list.intervalJson.forEach(l=>{l.readonly=l.endDate!==OA.b?"BOTH":"START",l.oid=G()}))}getIsDisabled(n){let t=n.target.classList;for(let o=0;o<t.length;o++)if("disabled"===t[o])return!0;return!1}onSubmit(){this.service.apply(this.list).then(n=>{null!=this.onListTypeChange&&this.onListTypeChange.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}getAttributeForFilter(n){return null!=n.attribute&&""!==n.attribute?this.geoObjectType.attributes.find(o=>o.code===n.attribute):null}onNewFilter(){null==this.list.filter&&(this.list.filter=[]),this.list.filter.push({attribute:"",operation:"EQ",value:null,id:G()})}removeFilter(n){this.list.filter.splice(n,1)}onNewInterval(){null==this.list.intervalJson&&(this.list.intervalJson=[]),this.list.intervalJson.push({startDate:"",endDate:"",oid:G()})}removeInterval(n){this.list.intervalJson.splice(n,1),this.handleDateChange()}handleDateChange(){"single"===this.list.listType?this.valid=null!=this.list.validOn&&this.list.validOn.length>0:"incremental"===this.list.listType?this.valid=null!=this.list.publishingStartDate&&this.list.publishingStartDate.length>0:"interval"===this.list.listType?(this.valid=this.list.intervalJson.map(n=>null!=n.startDate&&n.startDate.length>0&&null!=n.endDate&&n.endDate.length>0&&!this.dateService.after(n.startDate,n.endDate)).reduce((n,t)=>n&&t),this.list.intervalJson=this.list.intervalJson.sort((n,t)=>new Date(n.startDate)<new Date(t.startDate)?1:-1),this.list.intervalJson.forEach((n,t)=>{if(t>0){const o=this.list.intervalJson[t-1];if(o.startDate&&o.endDate&&n.startDate&&n.endDate){let a=new Date(o.startDate),l=new Date(o.endDate),_=new Date(n.startDate),C=new Date(n.endDate);ol.dateRangeOverlaps(a.getTime(),l.getTime(),_.getTime(),C.getTime())&&(this.valid=!1)}}}),this.valid&&(this.gap=!1,this.list.intervalJson.forEach((n,t)=>{if(t>0){const o=this.list.intervalJson[t-1];if(o.startDate&&n.endDate){let a=new Date(n.endDate),l=new Date(o.startDate);ol.hasGap(a.getTime(),l.getTime())&&(this.gap=!0)}}}))):this.valid=!0}getGeoObjectTypeTermAttributeOptions(n){return _d.getGeoObjectTypeTermAttributeOptions(this.geoObjectType,n)}onCancel(){this.bsModalRef.hide()}handleTab(n){this.tab=n}error(n){this.message=Zt.qL.getMessageFromError(n)}}function M5(i,n){1&i&&e._UZ(0,"i",23)}function O5(i,n){1&i&&(e.TgZ(0,"span",24),e._UZ(1,"i",25)(2,"i",26),e.qZA())}function S5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.onDelete(a))}),e._UZ(1,"localize",28),e.qZA()}}function P5(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",9)(2,"ul",29)(3,"li"),e._UZ(4,"localize",30),e._uU(5,": "),e._UZ(6,"date-text",31),e.qZA()()()()),2&i){const t=e.oxw().$implicit;e.xp6(6),e.Q6J("date",t.validOn)}}function E5(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",9)(2,"ul",29)(3,"li"),e._UZ(4,"localize",32),e._uU(5,": "),e._UZ(6,"date-text",31),e.qZA(),e.TgZ(7,"li"),e._UZ(8,"localize",33),e._uU(9),e.qZA()()()()),2&i){const t=e.oxw().$implicit;e.xp6(6),e.Q6J("date",t.publishingStartDate),e.xp6(3),e.hij(": ",t.frequency," ")}}function A5(i,n){if(1&i&&(e.TgZ(0,"li"),e._UZ(1,"date-text",31),e._uU(2," - "),e._UZ(3,"date-text",31),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("date",t.startDate),e.xp6(2),e.Q6J("date",t.endDate)}}function k5(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",9),e._UZ(2,"localize",30),e._uU(3,": "),e.TgZ(4,"ul",29),e.YNc(5,A5,4,2,"li",34),e.qZA()()()),2&i){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.intervalJson)}}Up.\u0275fac=function(n){return new(n||Up)(e.Y36(Uo),e.Y36(pr),e.Y36(mo.o),e.Y36(Ml),e.Y36(Ln.UZ),e.Y36(zs.R))},Up.\u0275cmp=e.Xpm({type:Up,selectors:[["list-type-publish-modal"]],decls:4,vars:1,consts:[["metadataDetail",""],[1,"modal-body"],[4,"ngIf"],["class","row-holder",4,"ngFor","ngForOf"],[1,"row-holder"],[1,"label-holder"],["key","list.type.originator"],[1,"holder"],["name","originator","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.contact"],["key","masterlist.contactName"],["name","contactName","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.telephoneNumber"],["name","telephoneNumber","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.email"],["name","email","type","email",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.metadata.title"],[2,"color","#BABABA"],[3,"key"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],["key","masterlist.listAbstract"],["name","'description-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","masterlist.process"],["name","'process-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","masterlist.progress"],["key","masterlist.accessConstraints"],["key","masterlist.useConstraints"],["key","masterlist.acknowledgements"],["name","'acknowledgements-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","masterlist.disclaimer"],["name","'disclaimer-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","list.type.topicCategories"],["name","topicCategories",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.placeKeywords"],["name","placeKeywords",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.updateFrequency"],["name","updateFrequency",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.lineage"],["name","lineage",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.languages"],["name","languages",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.scaleResolution"],["name","scaleResolution",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.spatialRepresentation"],["name","spatialRepresentation",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","vector"],["key","list.type.vector"],["key","list.type.referenceSystem"],["name","referenceSystem",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","EPSG4326"],["key","list.type.epsg4326"],["key","list.type.reportSpecification"],["name","reportSpecification","type","reportSpecification",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.distributionFormat"],["name","distributionFormat",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","SHAPEFILE"],["key","io.shapefile"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"text-center"],["key","type.publish.configuration.header"],["autocomplete","off",1,"modal-form"],["form","ngForm"],[1,"row-holder",2,"text-align","center"],[1,"radio","radio-inline",2,"padding-left","0"],["type","radio","name","single",1,"inline-radio-input",3,"checked","value","ngModel","disabled","ngModelChange"],["key","list.type.single.date"],["type","radio","name","incremental",1,"inline-radio-input",3,"checked","value","ngModel","disabled","ngModelChange"],["key","list.type.incremental.series"],["type","radio","name","interval",1,"inline-radio-input",3,"checked","value","ngModel","disabled","ngModelChange"],["key","list.type.interval.series"],["key","masterlist.code"],["name","code","type","text","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","typeCode"],["key","io.geoObjectType"],["name","typeLabel","type","text","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["key","hierarchy.nodeTooltip.geoObjectTypeCode"],["name","typeCode","type","text","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["class","row-holder",4,"ngIf"],[4,"ngFor","ngForOf"],["class","inner-col-content-wrapper","style","padding-top: 30px; margin-top: 10px;",4,"ngIf"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["key","list.type.includeLatLong"],["label","",3,"value","disable","valueChange"],["class","row",4,"ngFor","ngForOf"],[1,"row"],[1,"check-block",2,"margin","10px"],["name","unique",1,"jcf-unselectable","chk-area",2,"margin","0",3,"ngClass","click"],[2,"margin","3px 10px"],["key","masterlist.subtypeHierarchies"],["for","validOn"],["key","list.type.valid.on"],["label","","name","listValidOn",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange"],["key","data.property.label.frequency"],["name","frequency","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],["frequency","ngModel"],["value","ANNUAL"],["key","georegistry.frequency.annual"],["value","BIANNUAL"],["key","georegistry.frequency.biannual"],["value","QUARTER"],["key","georegistry.frequency.quarter"],["value","MONTHLY"],["key","georegistry.frequency.monthly"],["class","form-input-validation-error-message-wrapper",4,"ngIf"],["key","data.property.label.publishingStartDate"],["style","line-height: 40px;","class","date-string-display",4,"ngIf"],["label","","name","listPublishingStartDate",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange",4,"ngIf"],[1,"form-input-validation-error-message-wrapper"],[1,"error-message"],["key","list.change.frequency"],[1,"date-string-display",2,"line-height","40px"],[3,"date"],["label","","name","listPublishingStartDate",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange"],["key","list.type.intervals"],["class","row",4,"ngIf"],[1,"col-md-5"],["key","io.startDate"],["key","io.endDate"],[1,"col-md-2"],["label","",3,"value","classNames","inputName","allowFutureDates","required","disable","valueChange"],["label","",3,"value","classNames","inputName","allowInfinity","required","disable","valueChange"],["class","fa fa-times delete-btn clickable",3,"title","click",4,"ngIf"],[1,"fa","fa-times","delete-btn","clickable",3,"title","click"],[1,"col-md-12"],["type","button","role","button",1,"btn","btn-primary",2,"margin","15px 0",3,"click"],["key","changeovertime.manageVersions.summaryKey.NEW"],["style","float:none;","class","error-message",4,"ngIf"],["style","float:none;","class","warning-text",4,"ngIf"],[1,"error-message",2,"float","none"],["key","list.type.bad.interval.dates"],[1,"warning-text",2,"float","none"],["key","manage.versions.gap.message"],["key","button.filter.helptext"],[1,"col-md-3"],["required","",1,"select-area",3,"name","ngModel","disabled","ngModelChange"],[3,"value",4,"ngIf"],[3,"value"],["value","EQ"],["key","list.type.equals"],["value","EXACT",4,"ngIf"],[1,"col-md-4"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["value","EXACT"],["key","list.type.exact"],["container","body",3,"classificationType","name","value","disabled","valueChange"],[1,"select-area",3,"name","ngModel","disabled","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["localizeLabelKey","change.request.boolean.option.true",3,"disable","value","valueChange"],["label","",3,"value","classNames","inputName","disable","valueChange"],["type","number",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],["key","type.publish.metadata.header"],[1,"form-group",2,"text-align","center"],[1,"btn-group","geobject-editor-tab-holder"],[1,"btn","full-width-radio-button",2,"width","50%",3,"ngClass","click"],[2,"display","inline-block","width","90%"],["key","list.type.list"],["key","list.type.geospatial"],[2,"border-top","solid 3px #6BA542"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"]],template:function(n,t){1&n&&(e.YNc(0,zA,37,17,"ng-template",null,0,e.W1O),e.TgZ(2,"div",1),e.YNc(3,T5,57,29,"ng-container",2),e.qZA()),2&n&&(e.xp6(3),e.Q6J("ngIf",null!=t.list))},dependencies:[T.mk,T.sg,T.O5,T.tP,T.RF,T.n9,T.ED,y._Y,y.YN,y.Kr,y.Fj,y.wV,y.EJ,y._,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j,rl.M,Xl.Q,Fr.u,Lp,ia.F],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-type-content[_ngcontent-%COMP%]{overflow-y:auto;height:calc(100vh - 50px)}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.got-group-child[_ngcontent-%COMP%]{margin-left:10px}.got-group-child[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding-left:5px;border-left:1px solid}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}.warning-text[_ngcontent-%COMP%]{color:orange}']});const I5=function(i,n){return{typeCode:i,listId:n}};function Z5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"div",13),e.YNc(6,M5,1,0,"i",14),e.YNc(7,O5,3,0,"span",15),e.TgZ(8,"a",16),e._uU(9),e.qZA()(),e.TgZ(10,"div",17)(11,"button",18),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.onEdit(l))}),e._UZ(12,"localize",19),e.qZA(),e.YNc(13,S5,2,0,"button",20),e.qZA()(),e.YNc(14,P5,7,1,"div",21),e.YNc(15,E5,10,2,"div",21),e.YNc(16,k5,6,1,"div",21),e.TgZ(17,"div",12)(18,"div",9)(19,"p",22),e._uU(20),e.qZA()()()()()()()}if(2&i){const t=n.$implicit,o=e.oxw().listByType;e.xp6(6),e.Q6J("ngIf","single"===t.listType),e.xp6(1),e.Q6J("ngIf","single"!==t.listType),e.xp6(1),e.Q6J("routerLink","/registry/master-lists")("queryParams",e.WLB(10,I5,o.typeCode,t.oid)),e.xp6(1),e.hij(" ",t.displayLabel.localizedValue," "),e.xp6(4),e.Q6J("ngIf",t.write),e.xp6(1),e.Q6J("ngIf","single"===t.listType),e.xp6(1),e.Q6J("ngIf","incremental"===t.listType),e.xp6(1),e.Q6J("ngIf","interval"===t.listType),e.xp6(4),e.Oqu(t.description.localizedValue)}}function N5(i,n){1&i&&e.YNc(0,Z5,21,13,"div",7),2&i&&e.Q6J("ngForOf",n.lists)}function L5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",35)(1,"div",36)(2,"div")(3,"button",37),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCreate())}),e._UZ(4,"localize",38),e.qZA()()()()}}const ry=function(i,n){return{lists:i,listByType:n}};function z5(i,n){if(1&i&&(e.TgZ(0,"div")(1,"h3"),e._UZ(2,"localize",39),e.qZA(),e.GkF(3,40),e.qZA()),2&i){const t=e.oxw(),o=e.MAs(1);e.xp6(3),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(2,ry,t.groups.single,t.listByType))}}function D5(i,n){if(1&i&&(e.TgZ(0,"div")(1,"h3"),e._UZ(2,"localize",41),e.qZA(),e.GkF(3,40),e.qZA()),2&i){const t=e.oxw(),o=e.MAs(1);e.xp6(3),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(2,ry,t.groups.incremental,t.listByType))}}function R5(i,n){if(1&i&&(e.TgZ(0,"div")(1,"h3"),e._UZ(2,"localize",42),e.qZA(),e.GkF(3,40),e.qZA()),2&i){const t=e.oxw(),o=e.MAs(1);e.xp6(3),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(2,ry,t.groups.interval,t.listByType))}}function F5(i,n){1&i&&(e.TgZ(0,"div",43),e._UZ(1,"localize",44),e.qZA())}class Tf{constructor(n,t,o){this.service=n,this.modalService=t,this.localizeService=o,this.listByType=null,this.error=new e.vpe,this.groups={single:[],interval:[],incremental:[]}}ngOnInit(){this.onListTypeChange=new pn.x,this.onListTypeChange.subscribe(()=>{this.service.listForType(this.listByType.typeCode).then(n=>{this.listByType=n,this.createGroups(this.listByType)}).catch(n=>{this.error.emit(n)})})}ngOnDestroy(){this.onListTypeChange.unsubscribe()}ngOnChanges(n){null!=n.listByType&&this.createGroups(n.listByType.currentValue)}createGroups(n){this.groups={single:[],interval:[],incremental:[]},n.lists.forEach(t=>{"single"===t.listType?this.groups.single.push(t):"interval"===t.listType?this.groups.interval.push(t):"incremental"===t.listType&&this.groups.incremental.push(t)})}onCreate(){this.bsModalRef=this.modalService.show(Up,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(this.listByType,this.onListTypeChange)}onEdit(n){this.bsModalRef=this.modalService.show(Up,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(this.listByType,this.onListTypeChange,n)}onDelete(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" ["+n.displayLabel.localizedValue+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe(()=>{this.service.remove(n).then(()=>{this.listByType.lists=this.listByType.lists.filter(t=>t.oid!==n.oid),this.createGroups(this.listByType)}).catch(t=>{this.error.emit(t)})})}}function U5(i,n){1&i&&(e.TgZ(0,"option",23),e._UZ(1,"localize",24),e.qZA())}function q5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",25),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"input",28),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","metadata-displayLabel-"+t.locale)("disabled",o.readonly)("required",!1)}}function J5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",29),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"textarea",30),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function j5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",31),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"textarea",32),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function B5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",33),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"input",28),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","progress-"+t.locale)("disabled",o.readonly)("required",!1)}}function G5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",34),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"input",28),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","accessConstraints-"+t.locale)("disabled",o.readonly)("required",!1)}}function V5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",35),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"input",28),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","useConstraints-"+t.locale)("disabled",o.readonly)("required",!1)}}function Y5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",36),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"textarea",37),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function H5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",38),e.TgZ(4,"span",26),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",27),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",6)(9,"textarea",39),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("disabled",o.readonly)("required",!1)}}function Q5(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",3)(2,"div",4)(3,"label"),e._UZ(4,"localize",40),e.qZA()(),e.TgZ(5,"div",6)(6,"input",41),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.topicCategories=a)}),e.qZA()()(),e.TgZ(7,"div",3)(8,"div",4)(9,"label"),e._UZ(10,"localize",42),e.qZA()(),e.TgZ(11,"div",6)(12,"input",43),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.placeKeywords=a)}),e.qZA()()(),e.TgZ(13,"div",3)(14,"div",4)(15,"label"),e._UZ(16,"localize",44),e.qZA()(),e.TgZ(17,"div",6)(18,"input",45),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.updateFrequency=a)}),e.qZA()()(),e.TgZ(19,"div",3)(20,"div",4)(21,"label"),e._UZ(22,"localize",46),e.qZA()(),e.TgZ(23,"div",6)(24,"input",47),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.lineage=a)}),e.qZA()()(),e.TgZ(25,"div",3)(26,"div",4)(27,"label"),e._UZ(28,"localize",48),e.qZA()(),e.TgZ(29,"div",6)(30,"input",49),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.languages=a)}),e.qZA()()(),e.TgZ(31,"div",3)(32,"div",4)(33,"label"),e._UZ(34,"localize",50),e.qZA()(),e.TgZ(35,"div",6)(36,"input",51),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.scaleResolution=a)}),e.qZA()()(),e.TgZ(37,"div",3)(38,"div",4)(39,"label"),e._UZ(40,"localize",52),e.qZA()(),e.TgZ(41,"div",6)(42,"select",53),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.spatialRepresentation=a)}),e.TgZ(43,"option",54),e._UZ(44,"localize",55),e.qZA()()()(),e.TgZ(45,"div",3)(46,"div",4)(47,"label"),e._UZ(48,"localize",56),e.qZA()(),e.TgZ(49,"div",6)(50,"select",57),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.referenceSystem=a)}),e.TgZ(51,"option",58),e._UZ(52,"localize",59),e.qZA()()()(),e.TgZ(53,"div",3)(54,"div",4)(55,"label"),e._UZ(56,"localize",60),e.qZA()(),e.TgZ(57,"div",6)(58,"input",61),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.reportSpecification=a)}),e.qZA()()(),e.TgZ(59,"div",3)(60,"div",4)(61,"label"),e._UZ(62,"localize",62),e.qZA()(),e.TgZ(63,"div",6)(64,"select",63),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw().metadata;return e.KtG(l.distributionFormat=a)}),e._UZ(65,"option"),e.TgZ(66,"option",64),e._UZ(67,"localize",65),e.qZA()()()(),e.BQk()}if(2&i){const t=e.oxw().metadata,o=e.oxw();e.xp6(6),e.Q6J("ngModel",t.topicCategories)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.placeKeywords)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.updateFrequency)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.lineage)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.languages)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.scaleResolution)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.spatialRepresentation)("disabled",!0),e.xp6(8),e.Q6J("ngModel",t.referenceSystem)("disabled",!0),e.xp6(8),e.Q6J("ngModel",t.reportSpecification)("disabled",o.readonly),e.xp6(6),e.Q6J("ngModel",t.distributionFormat)("disabled",!0)}}function K5(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"label"),e._UZ(3,"localize",5),e.qZA()(),e.TgZ(4,"div",6)(5,"boolean-field",7),e.NdJ("valueChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.master=a)}),e.qZA()()(),e.TgZ(6,"div",3)(7,"div",4)(8,"label"),e._UZ(9,"localize",8),e.qZA()(),e.TgZ(10,"div",6)(11,"select",9),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.visibility=a)}),e.TgZ(12,"option",10),e._UZ(13,"localize",11),e.qZA(),e.YNc(14,U5,2,0,"option",12),e.qZA()()(),e.YNc(15,q5,10,5,"div",13),e.TgZ(16,"div",3)(17,"div",4)(18,"label"),e._UZ(19,"localize",14),e.qZA()(),e.TgZ(20,"div",6)(21,"input",15),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.originator=a)}),e.qZA()()(),e.YNc(22,J5,10,4,"div",13),e.YNc(23,j5,10,4,"div",13),e.YNc(24,B5,10,5,"div",13),e.YNc(25,G5,10,5,"div",13),e.YNc(26,V5,10,5,"div",13),e.YNc(27,Y5,10,4,"div",13),e.YNc(28,H5,10,4,"div",13),e.YNc(29,Q5,68,20,"ng-container",2),e.TgZ(30,"div",3),e._UZ(31,"div",4),e.TgZ(32,"div",6),e._UZ(33,"localize",16),e.qZA()(),e.TgZ(34,"div",3)(35,"div",4)(36,"label"),e._UZ(37,"localize",17),e.qZA()(),e.TgZ(38,"div",6)(39,"input",18),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.contactName=a)}),e.qZA()()(),e.TgZ(40,"div",3)(41,"div",4)(42,"label"),e._UZ(43,"localize",19),e.qZA()(),e.TgZ(44,"div",6)(45,"input",20),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.telephoneNumber=a)}),e.qZA()()(),e.TgZ(46,"div",3)(47,"div",4)(48,"label"),e._UZ(49,"localize",21),e.qZA()(),e.TgZ(50,"div",6)(51,"input",22),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).metadata;return e.KtG(_.email=a)}),e.qZA()()()}if(2&i){const t=n.metadata,o=n.list,a=n.type,l=e.oxw();e.xp6(5),e.Q6J("disable",l.readonly)("value",t.master),e.xp6(6),e.Q6J("ngModel",t.visibility)("disabled",l.readonly),e.xp6(3),e.Q6J("ngIf",!o.typePrivate),e.xp6(1),e.Q6J("ngForOf",t.label.localeValues),e.xp6(6),e.Q6J("ngModel",t.originator)("disabled",l.readonly),e.xp6(1),e.Q6J("ngForOf",t.description.localeValues),e.xp6(1),e.Q6J("ngForOf",t.process.localeValues),e.xp6(1),e.Q6J("ngForOf",t.progress.localeValues),e.xp6(1),e.Q6J("ngForOf",t.accessConstraints.localeValues),e.xp6(1),e.Q6J("ngForOf",t.useConstraints.localeValues),e.xp6(1),e.Q6J("ngForOf",t.acknowledgements.localeValues),e.xp6(1),e.Q6J("ngForOf",t.disclaimer.localeValues),e.xp6(1),e.Q6J("ngIf","geospatial"===a),e.xp6(10),e.Q6J("ngModel",t.contactName)("disabled",l.readonly),e.xp6(6),e.Q6J("ngModel",t.telephoneNumber)("disabled",l.readonly),e.xp6(6),e.Q6J("ngModel",t.email)("disabled",l.readonly)}}function $5(i,n){if(1&i&&(e.TgZ(0,"div",85),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message)}}Tf.\u0275fac=function(n){return new(n||Tf)(e.Y36(Uo),e.Y36(Ln.tT),e.Y36(mo.o))},Tf.\u0275cmp=e.Xpm({type:Tf,selectors:[["lists-for-type"]],inputs:{listByType:"listByType"},outputs:{error:"error"},features:[e.TTD],decls:15,vars:7,consts:[["groupDetail",""],[1,"heading"],[1,"subheading"],["key","list.type.heading"],["style","margin-top:30px;margin-bottom:30px;","class","row",4,"ngIf"],[4,"ngIf"],["style","font-style:italic;",4,"ngIf"],["class","row","style","margin-bottom: 5px;",4,"ngFor","ngForOf"],[1,"row",2,"margin-bottom","5px"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-body"],[1,"row"],[1,"col-md-7",2,"vertical-align","middle","line-height","40px"],["class","fa fa-table","aria-hidden","true",4,"ngIf"],["class","fa-stack fa-lg",4,"ngIf"],["routerLinkActive","active",2,"font-size","18px",3,"routerLink","queryParams"],[1,"col-md-5",2,"text-align","right"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","masterlist.button.configuration"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],["class","row",4,"ngIf"],[2,"color","#707070"],["aria-hidden","true",1,"fa","fa-table"],[1,"fa-stack","fa-lg"],[1,"fa","fa-table","fa-stack-2x"],[1,"fa","fa-table","fa-stack-1x","second-stacked-el",2,"margin-left","8px","margin-top","-4px"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","modal.button.delete"],[1,"unstyled-list"],["key","list.type.valid.on"],[3,"date"],["key","data.property.label.publishingStartDate"],["key","data.property.label.frequency"],[4,"ngFor","ngForOf"],[1,"row",2,"margin-top","30px","margin-bottom","30px"],[1,"col-md-6"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","list.type.button.create"],["key","list.type.single.date"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["key","list.type.incremental.series"],["key","list.type.interval.series"],[2,"font-style","italic"],["key","list.type.no.lists.message"]],template:function(n,t){1&n&&(e.YNc(0,N5,1,1,"ng-template",null,0,e.W1O),e.ynx(2),e.TgZ(3,"div",1)(4,"h2"),e._uU(5),e.qZA()(),e.TgZ(6,"div",2)(7,"h3"),e._UZ(8,"localize",3),e.qZA()(),e._UZ(9,"hr"),e.YNc(10,L5,5,0,"div",4),e.YNc(11,z5,4,5,"div",5),e.YNc(12,D5,4,5,"div",5),e.YNc(13,R5,4,5,"div",5),e.YNc(14,F5,2,0,"div",6),e.BQk()),2&n&&(e.xp6(5),e.AsE(" ",t.listByType.orgLabel," : ",t.listByType.typeLabel," "),e.xp6(5),e.Q6J("ngIf",t.listByType.write),e.xp6(1),e.Q6J("ngIf",t.groups.single.length>0),e.xp6(1),e.Q6J("ngIf",t.groups.incremental.length>0),e.xp6(1),e.Q6J("ngIf",t.groups.interval.length>0),e.xp6(1),e.Q6J("ngIf",0===t.listByType.lists.length))},dependencies:[T.sg,T.O5,T.tP,w.rH,w.Od,Sn.l,Fr.u],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-type-content[_ngcontent-%COMP%]{overflow-y:auto;height:calc(100vh - 50px)}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.got-group-child[_ngcontent-%COMP%]{margin-left:10px}.got-group-child[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding-left:5px;border-left:1px solid}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}.warning-text[_ngcontent-%COMP%]{color:orange}']});const W5=function(i,n){return{metadata:i,list:n,type:"list"}};function X5(i,n){if(1&i&&e.GkF(0,86),2&i){const t=e.oxw(2),o=e.MAs(1);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(2,W5,t.metadata.listMetadata,t.list))}}const ek=function(i,n){return{metadata:i,list:n,type:"geospatial"}};function tk(i,n){if(1&i&&e.GkF(0,86),2&i){const t=e.oxw(2),o=e.MAs(1);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(2,ek,t.metadata.geospatialMetadata,t.list))}}function nk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",87),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSubmit())}),e._UZ(1,"localize",88),e.qZA()}if(2&i){e.oxw();const t=e.MAs(7);e.Q6J("disabled",!t.valid)}}function ik(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,$5,2,1,"div",66),e.TgZ(2,"div",67)(3,"h2"),e._UZ(4,"localize",68),e.qZA(),e._UZ(5,"hr"),e.qZA(),e.TgZ(6,"form",69,70)(8,"fieldset")(9,"div",71)(10,"div",72)(11,"div",73),e._UZ(12,"div",4),e.TgZ(13,"div",6)(14,"div",74)(15,"div",75)(16,"label",76),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleTab("LIST"))}),e.TgZ(17,"span",77),e._UZ(18,"localize",78),e.qZA()(),e.TgZ(19,"label",76),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleTab("GEOSPATIAL"))}),e.TgZ(20,"span",77),e._UZ(21,"localize",79),e.qZA()()()()(),e._UZ(22,"hr",80),e.qZA()(),e.TgZ(23,"div",72)(24,"div",73),e.YNc(25,X5,1,5,"ng-container",81),e.YNc(26,tk,1,5,"ng-container",81),e.qZA()()(),e.TgZ(27,"div",3),e._UZ(28,"div",4),e.TgZ(29,"div",82)(30,"button",83),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCancel())}),e._UZ(31,"localize",27),e.qZA(),e.YNc(32,nk,2,1,"button",84),e.qZA()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(15),e.Q6J("ngClass","LIST"===t.tab?"active":""),e.xp6(3),e.Q6J("ngClass","GEOSPATIAL"===t.tab?"active":""),e.xp6(6),e.Q6J("ngIf","LIST"===t.tab),e.xp6(1),e.Q6J("ngIf","GEOSPATIAL"===t.tab),e.xp6(5),e.Q6J("key",t.readonly?"io.back":"io.cancel"),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}class Fd{constructor(n,t){this.service=n,this.bsModalRef=t,this.message=null,this.list=null,this.entry=null,this.metadata=null,this.tab="LIST",this.readonly=!1}ngOnInit(){}init(n,t,o){if(this.list=n,this.entry=t,this.readonly=!n.write,null==o){const a=t.versions[t.versions.length-1];this.metadata={listMetadata:{visibility:"PRIVATE",master:!1,...JSON.parse(JSON.stringify(a.listMetadata))},geospatialMetadata:{visibility:"PRIVATE",master:!1,...JSON.parse(JSON.stringify(a.geospatialMetadata))}}}else this.metadata=o}onSubmit(){null!=this.metadata.oid?this.service.applyVersion(this.metadata).then(n=>{if(null!=this.entry.versions){const t=this.entry.versions.findIndex(o=>o.oid===n.oid);n.collapsed=this.entry.versions[t].collapsed,this.entry.versions[t]=n}this.bsModalRef.hide()}).catch(n=>{this.error(n)}):this.service.createVersion(this.entry,this.metadata).then(n=>{this.entry.versions.unshift(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}onCancel(){this.bsModalRef.hide()}handleTab(n){this.tab=n}error(n){this.message=Zt.qL.getMessageFromError(n)}}function ok(i,n){if(1&i&&(e.TgZ(0,"span",30),e._UZ(1,"localize",31),e._uU(2),e.qZA()),2&i){const t=e.oxw().version;e.xp6(2),e.hij(" ",t.versionNumber," ")}}function rk(i,n){1&i&&(e.TgZ(0,"span",30),e._UZ(1,"localize",32),e.qZA())}function ak(i,n){1&i&&e._UZ(0,"localize",33)}function sk(i,n){1&i&&e._UZ(0,"localize",34)}function lk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(),l=a.entry,_=a.version,C=e.oxw();return e.KtG(C.onDelete(l,_))}),e._UZ(1,"localize",36),e.qZA()}}function ck(i,n){if(1&i&&(e.TgZ(0,"a",37),e._UZ(1,"localize",38),e.qZA()),2&i){const t=e.oxw().version;e.Q6J("routerLink","/registry/master-list/"+t.oid)}}function uk(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",38),e.qZA())}function pk(i,n){1&i&&e._UZ(0,"localize",39)}function dk(i,n){1&i&&e._UZ(0,"localize",40)}function hk(i,n){1&i&&e._UZ(0,"localize",41)}function fk(i,n){1&i&&e._UZ(0,"localize",42)}function gk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",43),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().version,l=e.oxw();return e.KtG(l.onGotoMap(a))}),e._UZ(1,"localize",44),e.qZA()}}function _k(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",44),e.qZA())}function mk(i,n){1&i&&e._UZ(0,"localize",39)}function yk(i,n){1&i&&e._UZ(0,"localize",40)}function vk(i,n){1&i&&e._UZ(0,"localize",41)}function bk(i,n){1&i&&e._UZ(0,"localize",42)}Fd.\u0275fac=function(n){return new(n||Fd)(e.Y36(Uo),e.Y36(Ln.UZ))},Fd.\u0275cmp=e.Xpm({type:Fd,selectors:[["publish-version"]],decls:4,vars:1,consts:[["metadataDetail",""],[1,"modal-body"],[4,"ngIf"],[1,"row-holder"],[1,"label-holder"],["key","masterlist.ismaster"],[1,"holder"],["label","",3,"disable","value","valueChange"],["key","masterlist.visibility"],["name","visibility","required","",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","PRIVATE"],["key","masterlist.private"],["value","PUBLIC",4,"ngIf"],["class","row-holder",4,"ngFor","ngForOf"],["key","list.type.originator"],["name","originator","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.contact"],["key","masterlist.contactName"],["name","contactName","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.telephoneNumber"],["name","telephoneNumber","type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","masterlist.email"],["name","email","type","email",1,"form-control",3,"ngModel","disabled","ngModelChange"],["value","PUBLIC"],["key","masterlist.public"],["key","masterlist.label"],[2,"color","#BABABA"],[3,"key"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],["key","masterlist.listAbstract"],["name","'description-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","masterlist.process"],["name","'process-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","masterlist.progress"],["key","masterlist.accessConstraints"],["key","masterlist.useConstraints"],["key","masterlist.acknowledgements"],["name","'acknowledgements-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","masterlist.disclaimer"],["name","'disclaimer-' + localeValue.locale",1,"form-control",3,"ngModel","disabled","required","ngModelChange"],["key","list.type.topicCategories"],["name","topicCategories",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.placeKeywords"],["name","placeKeywords",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.updateFrequency"],["name","updateFrequency",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.lineage"],["name","lineage",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.languages"],["name","languages",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.scaleResolution"],["name","scaleResolution",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.spatialRepresentation"],["name","spatialRepresentation",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","vector"],["key","list.type.vector"],["key","list.type.referenceSystem"],["name","referenceSystem",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","EPSG4326"],["key","list.type.epsg4326"],["key","list.type.reportSpecification"],["name","reportSpecification","type","reportSpecification",1,"form-control",3,"ngModel","disabled","ngModelChange"],["key","list.type.distributionFormat"],["name","distributionFormat",1,"select-area",3,"ngModel","disabled","ngModelChange"],["value","SHAPEFILE"],["key","io.shapefile"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"text-center"],["key","type.publish.metadata.header"],["autocomplete","off",1,"modal-form"],["form","ngForm"],[1,"inner-col-content-wrapper",2,"padding-top","30px","margin-top","10px"],[1,"row"],[1,"col-md-12"],[1,"form-group",2,"text-align","center"],[1,"btn-group","geobject-editor-tab-holder"],[1,"btn","full-width-radio-button",2,"width","50%",3,"ngClass","click"],[2,"display","inline-block","width","90%"],["key","list.type.list"],["key","list.type.geospatial"],[2,"border-top","solid 3px #6BA542"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"]],template:function(n,t){1&n&&(e.YNc(0,K5,52,22,"ng-template",null,0,e.W1O),e.TgZ(2,"div",1),e.YNc(3,ik,33,7,"ng-container",2),e.qZA()),2&n&&(e.xp6(3),e.Q6J("ngIf",null!=t.metadata))},dependencies:[T.mk,T.sg,T.O5,T.tP,y._Y,y.YN,y.Kr,y.Fj,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j,rl.M],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-type-content[_ngcontent-%COMP%]{overflow-y:auto;height:calc(100vh - 50px)}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.got-group-child[_ngcontent-%COMP%]{margin-left:10px}.got-group-child[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding-left:5px;border-left:1px solid}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}.warning-text[_ngcontent-%COMP%]{color:orange}']});const xk=function(i,n){return{"fa-chevron-down":i,"fa-chevron-right":n}};function Ck(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"div",10)(2,"span",11),e.NdJ("click",function(){const l=e.CHM(t).version;return e.KtG(l.collapsed=!l.collapsed)}),e._UZ(3,"i",12),e.YNc(4,ok,3,1,"span",13),e.YNc(5,rk,2,0,"span",13),e.TgZ(6,"span",14),e._UZ(7,"localize",15),e._uU(8),e.qZA()()(),e.TgZ(9,"div",16)(10,"button",17),e.NdJ("click",function(){const a=e.CHM(t),l=a.entry,_=a.version,C=e.oxw();return e.KtG(C.onEdit(l,_))}),e.YNc(11,ak,1,0,"localize",18),e.YNc(12,sk,1,0,"localize",19),e.qZA(),e.YNc(13,lk,2,0,"button",20),e.qZA()(),e.TgZ(14,"div",21)(15,"ul",22)(16,"li"),e.YNc(17,ck,2,1,"a",23),e.YNc(18,uk,2,0,"span",24),e.TgZ(19,"span"),e._uU(20," ( "),e.YNc(21,pk,1,0,"localize",25),e.YNc(22,dk,1,0,"localize",26),e._uU(23," ) "),e.qZA(),e.TgZ(24,"span"),e._uU(25," ( "),e.YNc(26,hk,1,0,"localize",27),e.YNc(27,fk,1,0,"localize",28),e._uU(28," ) "),e.qZA()(),e.TgZ(29,"li"),e.YNc(30,gk,2,0,"a",29),e.YNc(31,_k,2,0,"span",24),e.TgZ(32,"span"),e._uU(33," ( "),e.YNc(34,mk,1,0,"localize",25),e.YNc(35,yk,1,0,"localize",26),e._uU(36," ) "),e.qZA(),e.TgZ(37,"span"),e._uU(38," ( "),e.YNc(39,vk,1,0,"localize",27),e.YNc(40,bk,1,0,"localize",28),e._uU(41," ) "),e.qZA()()()()}if(2&i){const t=n.version,o=e.oxw();e.xp6(2),e.uIk("aria-expanded",!t.collapsed),e.xp6(1),e.Q6J("ngClass",e.WLB(21,xk,t.collapsed,!t.collapsed)),e.xp6(1),e.Q6J("ngIf",!t.working),e.xp6(1),e.Q6J("ngIf",t.working),e.xp6(3),e.hij(": ",t.createDate," "),e.xp6(3),e.Q6J("ngIf",t.working),e.xp6(1),e.Q6J("ngIf",!t.working),e.xp6(1),e.Q6J("ngIf",o.list.write&&!t.working),e.xp6(1),e.Q6J("collapse",!t.collapsed),e.xp6(3),e.Q6J("ngIf",t.isMember||"PUBLIC"===t.listMetadata.visibility),e.xp6(1),e.Q6J("ngIf",!(t.isMember||"PUBLIC"===t.listMetadata.visibility)),e.xp6(3),e.Q6J("ngIf","PUBLIC"===t.listMetadata.visibility),e.xp6(1),e.Q6J("ngIf","PUBLIC"!==t.listMetadata.visibility),e.xp6(4),e.Q6J("ngIf",t.listMetadata.master),e.xp6(1),e.Q6J("ngIf",!t.listMetadata.master),e.xp6(3),e.Q6J("ngIf",t.isMember||"PUBLIC"===t.geospatialMetadata.visibility),e.xp6(1),e.Q6J("ngIf",!(t.isMember||"PUBLIC"===t.geospatialMetadata.visibility)),e.xp6(3),e.Q6J("ngIf","PUBLIC"===t.geospatialMetadata.visibility),e.xp6(1),e.Q6J("ngIf","PUBLIC"!==t.geospatialMetadata.visibility),e.xp6(4),e.Q6J("ngIf",t.geospatialMetadata.master),e.xp6(1),e.Q6J("ngIf",!t.geospatialMetadata.master)}}function wk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCreateEntries())}),e._UZ(1,"localize",46),e.qZA()}}function Tk(i,n){if(1&i&&(e.ynx(0),e._uU(1),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.period.value," ")}}function Mk(i,n){if(1&i&&(e.ynx(0),e._UZ(1,"date-text",56),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("date",t.period.value)}}function Ok(i,n){if(1&i&&(e.ynx(0),e._UZ(1,"date-text",56),e._uU(2," - "),e._UZ(3,"date-text",56),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("date",t.period.value.startDate),e.xp6(2),e.Q6J("date",t.period.value.endDate)}}const sv=function(i,n){return{entry:i,version:n}};function Sk(i,n){if(1&i&&e.GkF(0,57),2&i){const t=e.oxw().$implicit;e.oxw();const o=e.MAs(1);e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(2,sv,t,t.versions[t.versions.length-1]))}}function Pk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.onCreate(a))}),e._UZ(1,"localize",58),e.qZA()}}function Ek(i,n){1&i&&e._UZ(0,"localize",61)}function Ak(i,n){1&i&&e._UZ(0,"localize",62)}function kk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw();return e.KtG(l.toggleVersions(a))}),e.YNc(1,Ek,1,0,"localize",59),e.YNc(2,Ak,1,0,"localize",60),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!t.showAll),e.xp6(1),e.Q6J("ngIf",t.showAll)}}function Ik(i,n){if(1&i&&e.GkF(0,57),2&i){const t=e.oxw().$implicit,o=e.oxw(2).$implicit;e.oxw();const a=e.MAs(1);e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.WLB(2,sv,o,t))}}function Zk(i,n){if(1&i&&(e.ynx(0),e.YNc(1,Ik,1,5,"ng-container",50),e.BQk()),2&i){const t=n.index,o=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0===t||o.showAll&&t!==o.versions.length-1)}}function Nk(i,n){if(1&i&&(e.ynx(0),e.YNc(1,Zk,2,1,"ng-container",63),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.versions)}}function Lk(i,n){1&i&&(e.TgZ(0,"div",2)(1,"div",3),e._UZ(2,"localize",64),e.qZA()())}function zk(i,n){if(1&i&&(e.TgZ(0,"div",47)(1,"div",3)(2,"div",48)(3,"div",49)(4,"div",2)(5,"div",3)(6,"h3"),e.YNc(7,Tk,2,1,"ng-container",24),e.YNc(8,Mk,2,1,"ng-container",24),e.YNc(9,Ok,4,2,"ng-container",24),e.qZA()()(),e.YNc(10,Sk,1,5,"ng-container",50),e._UZ(11,"hr",51),e.TgZ(12,"h4",52),e._UZ(13,"localize",53),e.qZA(),e.TgZ(14,"div"),e.YNc(15,Pk,2,0,"button",7),e.YNc(16,kk,3,2,"button",54),e.qZA(),e.YNc(17,Nk,2,1,"ng-container",24),e.YNc(18,Lk,3,0,"div",55),e.qZA()()()()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(7),e.Q6J("ngIf","text"===t.period.type),e.xp6(1),e.Q6J("ngIf","date"===t.period.type),e.xp6(1),e.Q6J("ngIf","range"===t.period.type),e.xp6(1),e.Q6J("ngIf",t.versions.length>0&&t.versions[t.versions.length-1].working),e.xp6(5),e.Q6J("ngIf",o.list.write),e.xp6(1),e.Q6J("ngIf",t.versions.length>2),e.xp6(1),e.Q6J("ngIf",t.versions.length>0&&!t.versions[0].working),e.xp6(1),e.Q6J("ngIf",0===t.versions.length||t.versions[0].working)}}class Mf{constructor(n,t,o,a,l,_,C){this.router=n,this.service=t,this.modalService=o,this.localizeService=a,this.geomService=l,this.authService=_,this.dateService=C,this.error=new e.vpe,this.isRC=!1}ngOnInit(){this.isRC=this.authService.isGeoObjectTypeOrSuperRC({organizationCode:this.list.organization,code:this.list.typeCode,superTypeCode:this.list.superTypeCode}),this.list.entries.filter(n=>null!=n.versions&&n.versions.length>0).forEach(n=>{n.versions[0].collapsed=!0})}ngOnDestroy(){}toggleVersions(n){n.showAll=!n.showAll}onCreate(n){this.bsModalRef=this.modalService.show(Fd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(this.list,n)}onCreateEntries(){this.service.createEntries(this.list.oid).then(n=>{n.entries.forEach(t=>{-1===this.list.entries.findIndex(o=>o.oid===t.oid)&&this.list.entries.push(t),this.list.entries.sort((o,a)=>{const l=this.dateService.getDateFromDateString(o.forDate);return this.dateService.getDateFromDateString(a.forDate).getTime()-l.getTime()})})}).catch(n=>{this.error.emit(n)})}onEdit(n,t){this.bsModalRef=this.modalService.show(Fd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(this.list,n,t)}onViewConfiguration(n){this.bsModalRef=this.modalService.show(Up,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(n,null,n)}onDelete(n,t){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.localizeService.decode("confirm.modal.verify.delete")+" Version ["+t.versionNumber+"]",this.bsModalRef.content.submitText=this.localizeService.decode("modal.button.delete"),this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe(o=>{this.service.removeVersion(t).then(a=>{const l=n.versions.findIndex(_=>_.oid===t.oid);-1!==l&&n.versions.splice(l,1)}).catch(a=>{this.error.emit(a)})})}layerFromVersion(n){let o=new xc(this.service,n.oid).createLayer(n.displayLabel,!0,bl().hexString());return this.geomService.zoomOnReady(o.getId()),this.geomService.getDataSourceFactory().serializeLayers([o])}onGotoMap(n){this.service.getBounds(n.oid).then(t=>{const o={layers:JSON.stringify(this.layerFromVersion(n))};if(t&&Array.isArray(t)){const l=new sr.LngLatBounds([t[0],t[1]],[t[2],t[3]]).toArray();o.bounds=JSON.stringify(l)}this.router.navigate(["/registry/location-manager"],{queryParams:o})}).catch(t=>{this.error.emit(t)})}}Mf.\u0275fac=function(n){return new(n||Mf)(e.Y36(w.F0),e.Y36(Uo),e.Y36(Ln.tT),e.Y36(nn.oQ),e.Y36(vo),e.Y36(nn.e8),e.Y36(nn.Ru))},Mf.\u0275cmp=e.Xpm({type:Mf,selectors:[["list-type"]],inputs:{list:"list"},outputs:{error:"error"},decls:14,vars:3,consts:[["versionDetail",""],[1,"heading"],[1,"row"],[1,"col-md-12"],[1,"col-md-12",2,"padding","20px 15px"],["type","submit","role","button",1,"btn","btn-default",2,"padding-right","10px",3,"click"],["key","masterlist.button.configuration"],["type","submit","class","btn btn-primary","style","margin:0;","role","button",3,"click",4,"ngIf"],["class","row","style","margin-bottom: 5px;",4,"ngFor","ngForOf"],[1,"row",2,"margin-bottom","5px","line-height","40px"],[1,"col-md-7",2,"vertical-align","middle"],[1,"clickable",3,"click"],[1,"fa","fa-chevron-right",2,"font-size","14px",3,"ngClass"],["class","h4",4,"ngIf"],[2,"margin-left","10px","color","grey"],["key","list.type.date.generated"],[1,"col-md-5",2,"text-align","right"],["type","submit","role","button",1,"btn","btn-default",3,"click"],["key","masterlist.button.metadata",4,"ngIf"],["key","masterlist.snapshot.button.metadata",4,"ngIf"],["type","submit","class","btn btn-danger","role","button",3,"click",4,"ngIf"],[1,"row",2,"margin-bottom","5px",3,"collapse"],[2,"list-style","none"],["routerLinkActive","active",3,"routerLink",4,"ngIf"],[4,"ngIf"],["key","masterlist.public",4,"ngIf"],["key","masterlist.private",4,"ngIf"],["key","list.type.master",4,"ngIf"],["key","list.type.non.master",4,"ngIf"],[3,"click",4,"ngIf"],[1,"h4"],["key","list.type.version"],["key","list.type.working.version"],["key","masterlist.button.metadata"],["key","masterlist.snapshot.button.metadata"],["type","submit","role","button",1,"btn","btn-danger",3,"click"],["key","modal.button.delete"],["routerLinkActive","active",3,"routerLink"],["key","list.type.list"],["key","masterlist.public"],["key","masterlist.private"],["key","list.type.master"],["key","list.type.non.master"],[3,"click"],["key","list.type.geospatial"],["type","submit","role","button",1,"btn","btn-primary",2,"margin","0",3,"click"],["key","list.type.create.entries"],[1,"row",2,"margin-bottom","5px"],[1,"panel","panel-default"],[1,"panel-body"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[2,"border-color","lightgrey"],[2,"margin-top","20px"],["key","list.type.published.versions.header"],["type","submit","class","btn btn-default","role","button",3,"click",4,"ngIf"],["class","row",4,"ngIf"],[3,"date"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["key","list.type.new.version"],["key","list.type.see.versions",4,"ngIf"],["key","list.type.hide.versions",4,"ngIf"],["key","list.type.see.versions"],["key","list.type.hide.versions"],[4,"ngFor","ngForOf"],["key","list.type.no.versions",2,"color","grey","font-style","italic"]],template:function(n,t){1&n&&(e.YNc(0,Ck,42,24,"ng-template",null,0,e.W1O),e.ynx(2),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"h2"),e._uU(7),e.qZA()()()(),e.TgZ(8,"div",2)(9,"div",4)(10,"button",5),e.NdJ("click",function(){return t.onViewConfiguration(t.list)}),e._UZ(11,"localize",6),e.qZA(),e.YNc(12,wk,2,0,"button",7),e.qZA()(),e.YNc(13,zk,19,8,"div",8),e.BQk()),2&n&&(e.xp6(7),e.hij(" ",t.list.displayLabel.localizedValue," "),e.xp6(5),e.Q6J("ngIf","incremental"===t.list.listType),e.xp6(1),e.Q6J("ngForOf",t.list.entries))},dependencies:[T.mk,T.sg,T.O5,T.tP,w.rH,w.Od,W.Y,Sn.l,Fr.u],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-type-content[_ngcontent-%COMP%]{overflow-y:auto;height:calc(100vh - 50px)}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.got-group-child[_ngcontent-%COMP%]{margin-left:10px}.got-group-child[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding-left:5px;border-left:1px solid}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}.warning-text[_ngcontent-%COMP%]{color:orange}']});const Dk=["typesByOrgIter"];function Rk(i,n){if(1&i&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}const Fk=function(i){return{"got-group-child":i}},Uk=function(i){return{typeCode:i}};function qk(i,n){if(1&i&&(e.TgZ(0,"li",15,16)(2,"a",17),e._uU(3),e.qZA()()),2&i){const t=n.$implicit;e.Q6J("ngClass",e.VKq(5,Fk,t.superTypeCode))("id",t.code),e.xp6(2),e.Q6J("routerLink","/registry/master-lists")("queryParams",e.VKq(7,Uk,t.code)),e.xp6(1),e.hij(" ",t.label.localizedValue," ")}}function Jk(i,n){if(1&i&&(e.TgZ(0,"ul",12)(1,"div")(2,"div",13)(3,"h3"),e._uU(4),e.qZA()(),e.YNc(5,qk,4,9,"li",14),e.qZA()()),2&i){const t=n.$implicit;e.xp6(4),e.Oqu(t.org.label.localizedValue),e.xp6(1),e.Q6J("ngForOf",t.types)}}function jk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"lists-for-type",18),e.NdJ("error",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.error(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("listByType",t.listByType)}}function Bk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"list-type",19),e.NdJ("error",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.error(a))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("list",t.current)}}class Of{constructor(n,t,o,a){this.service=n,this.registryService=t,this.route=o,this.authService=a,this.message=null,this.typesByOrg=[],this.listByType=null,this.current=null,this.subscription=null,this.noQueryParams=!1}ngOnInit(){this.subscription=this.route.queryParams.subscribe(n=>{const t=n.typeCode,o=n.listId;null!=o&&o.length>0?this.service.entries(o).then(a=>{this.current=a,this.listByType=null}).catch(a=>{this.error(a)}):null!=t&&t.length>0?this.service.listForType(t).then(a=>{this.listByType=a,this.current=null}).catch(a=>{this.error(a)}):this.noQueryParams=!0}),0===this.typesByOrg.length&&this.registryService.init().then(n=>{if(this.typesByOrg=[],n.organizations.sort((t,o)=>t.label.localizedValue<o.label.localizedValue?-1:t.label.localizedValue>o.label.localizedValue?1:0),!this.authService.isSRA()){let t=null,o=this.authService.getMyOrganizations();t=n.organizations.findIndex(a=>a.code===o[0]),t>=0&&ol.arrayMove(n.organizations,t,0)}n.organizations.forEach((t,o)=>{let a=n.types.filter(N=>N.organizationCode===t.code),l=a.filter(N=>!N.superTypeCode);l.sort((N,F)=>N.label.localizedValue<F.label.localizedValue?-1:N.label.localizedValue>F.label.localizedValue?1:0);let _=[];l.filter(N=>N.isAbstract).forEach(N=>{let F={group:N,members:[]};a.forEach(V=>{V.superTypeCode===N.code&&F.members.push(V)}),_.push(F)}),_.forEach(N=>{let F=l.findIndex(V=>N.group.code===V.code);-1!==F&&l.splice(F+1,0,...N.members)}),this.typesByOrg.push({org:t,types:l})})}).catch(n=>{this.error(n)})}ngAfterViewInit(){this.typesByOrgIterEls.changes.subscribe(n=>{if(this.noQueryParams&&n.length>0){let t=document.getElementsByClassName("got-li-item");t&&t.length>0&&t[0].firstChild.click()}})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function Gk(i,n){1&i&&(e.TgZ(0,"option",18),e._UZ(1,"localize",19),e.qZA())}function Vk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",5)(1,"div",6)(2,"label"),e._UZ(3,"localize",20),e.qZA(),e.TgZ(4,"select",21),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.actualGeometryType=a)}),e._UZ(5,"option"),e.TgZ(6,"option",22),e._UZ(7,"localize",23),e.qZA(),e.TgZ(8,"option",24),e._UZ(9,"localize",25),e.qZA(),e.TgZ(10,"option",26),e._UZ(11,"localize",27),e.qZA()()()()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.actualGeometryType)}}function Yk(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"form",3,4)(2,"fieldset")(3,"div",5)(4,"div",6)(5,"label"),e._UZ(6,"localize",7),e.qZA(),e.TgZ(7,"select",8),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.format=a)}),e._UZ(8,"option"),e.TgZ(9,"option",9),e._UZ(10,"localize",10),e.qZA(),e.YNc(11,Gk,2,0,"option",11),e.qZA()()(),e.YNc(12,Vk,12,1,"div",12),e.TgZ(13,"div",5)(14,"div",6)(15,"div",13)(16,"button",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.bsModalRef.hide())}),e.TgZ(17,"span"),e._UZ(18,"localize",15),e.qZA()(),e.TgZ(19,"button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.confirm())}),e.TgZ(20,"span"),e._UZ(21,"localize",17),e.qZA()()()()()()()}if(2&i){const t=e.MAs(1),o=e.oxw();e.xp6(7),e.Q6J("ngModel",o.format),e.xp6(4),e.Q6J("ngIf",o.list.isMember||"PUBLIC"===o.list.geospatialMetadata.visibility),e.xp6(1),e.Q6J("ngIf","SHAPEFILE"===o.format&&"MIXED"===o.list.geometryType),e.xp6(7),e.Q6J("disabled",!t.valid)}}Of.\u0275fac=function(n){return new(n||Of)(e.Y36(Uo),e.Y36(Zi),e.Y36(w.gz),e.Y36($m.e))},Of.\u0275cmp=e.Xpm({type:Of,selectors:[["list-type-manager"]],viewQuery:function(n,t){if(1&n&&e.Gf(Dk,5),2&n){let o;e.iGM(o=e.CRH())&&(t.typesByOrgIterEls=o)}},decls:13,vars:4,consts:[[1,"new-admin-design-main",2,"overflow-y","hidden"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"row"],[1,"col-md-3","list-sidebar"],[1,"sidebar-section-content"],["class","list-group",4,"ngFor","ngForOf"],[1,"col-md-9","list-type-content"],["id","overflow-div"],[3,"listByType","error",4,"ngIf"],[3,"list","error",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"list-group"],[1,"got-org-label-wrapper"],["class","list-group-item got-li-item",3,"ngClass","id",4,"ngFor","ngForOf"],[1,"list-group-item","got-li-item",3,"ngClass","id"],["typesByOrgIter",""],["routerLinkActive","active",3,"routerLink","queryParams"],[3,"listByType","error"],[3,"list","error"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,Rk,2,1,"div",2),e.TgZ(5,"div",3)(6,"nav",4)(7,"div",5),e.YNc(8,Jk,6,2,"ul",6),e.qZA()(),e.TgZ(9,"div",7)(10,"div",8),e.YNc(11,jk,1,1,"lists-for-type",9),e.YNc(12,Bk,1,1,"list-type",10),e.qZA()()()()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(4),e.Q6J("ngForOf",t.typesByOrg),e.xp6(3),e.Q6J("ngIf",null!=t.listByType),e.xp6(1),e.Q6J("ngIf",null!=t.current))},dependencies:[T.mk,T.sg,T.O5,w.rH,w.Od,Da.N,ba.C,Tf,Mf],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-type-content[_ngcontent-%COMP%]{overflow-y:auto;height:calc(100vh - 50px)}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.got-group-child[_ngcontent-%COMP%]{margin-left:10px}.got-group-child[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{padding-left:5px;border-left:1px solid}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}.warning-text[_ngcontent-%COMP%]{color:orange}']});class Ud{constructor(n){this.bsModalRef=n,this.list=null}ngOnInit(){this.onFormat=new pn.x}ngOnDestroy(){this.onFormat.unsubscribe()}init(n){this.list=n}confirm(){this.bsModalRef.hide(),this.onFormat.next({format:this.format,actualGeometryType:this.actualGeometryType})}}Ud.\u0275fac=function(n){return new(n||Ud)(e.Y36(Ln.UZ))},Ud.\u0275cmp=e.Xpm({type:Ud,selectors:[["export-format-modal"]],decls:5,vars:1,consts:[["tabindex","-1","role","dialog",1,"modal-body"],[1,"heading","text-center"],["class","modal-form","name","export-form",4,"ngIf"],["name","export-form",1,"modal-form"],["ngForm","ngForm"],[1,"row"],[1,"col-md-12"],["key","export-modal.message"],["id","format","name","format","required","",1,"select-area",3,"ngModel","ngModelChange"],["value","EXCEL"],["key","export.option.spreadsheet"],["value","SHAPEFILE",4,"ngIf"],["class","row",4,"ngIf"],[1,"button-holder"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",3,"click"],["key","modal.button.cancel"],["type","button","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","modal.button.submit"],["value","SHAPEFILE"],["key","export.option.shapefile"],["key","data.property.label.geometryType"],["name","actualGeometryType","required","",3,"ngModel","ngModelChange"],["value","MULTIPOINT"],["key","georegistry.geometry.point"],["value","MULTILINESTRING"],["key","georegistry.geometry.line"],["value","MULTIPOLYGON"],["key","georegistry.geometry.polygon"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1"),e._uU(3," Export "),e.qZA()(),e.YNc(4,Yk,22,4,"form",2),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.list))},dependencies:[T.O5,y._Y,y.YN,y.Kr,y.EJ,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l],encapsulation:2});var Hk=v(69078),l_=v(40047),Qk=v(10805),Kk=v(82210),$k=v(3631);const Wk=["dt"];function Xk(i,n){1&i&&e._UZ(0,"col")}function e4(i,n){if(1&i&&(e.TgZ(0,"colgroup"),e.YNc(1,Xk,1,0,"col",7),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function t4(i,n){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.uIk("colspan",t.colspan)("rowspan",t.rowspan),e.xp6(1),e.hij(" ",t.header," ")}}const ay=function(i){return{"actions-col":i}};function n4(i,n){if(1&i&&(e.TgZ(0,"th",11),e._uU(1),e._UZ(2,"p-sortIcon",12),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.Q6J("pSortableColumn",t.field)("ngClass",e.VKq(6,ay,"ACTIONS"===t.type)),e.uIk("colspan",t.colspan)("rowspan",t.rowspan),e.xp6(1),e.hij(" ",t.header," "),e.xp6(1),e.Q6J("field",t.field)}}function i4(i,n){if(1&i&&(e.TgZ(0,"th",13),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).$implicit;e.Q6J("ngClass",e.VKq(4,ay,"ACTIONS"===t.type)),e.uIk("colspan",t.colspan)("rowspan",t.rowspan),e.xp6(1),e.hij(" ",t.header," ")}}function o4(i,n){if(1&i&&(e.ynx(0),e.YNc(1,n4,3,8,"th",9),e.YNc(2,i4,2,6,"th",10),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.sortable),e.xp6(1),e.Q6J("ngIf",!t.sortable)}}function r4(i,n){if(1&i&&(e.ynx(0),e.YNc(1,t4,2,3,"th",8),e.YNc(2,o4,3,2,"ng-container",8),e.BQk()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf","ATTRIBUTE"!==t.headerType),e.xp6(1),e.Q6J("ngIf","ATTRIBUTE"===t.headerType)}}function a4(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,r4,3,2,"ng-container",7),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function s4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",21),e.NdJ("input",function(a){e.CHM(t);const l=e.oxw(2).$implicit,_=e.oxw(3),C=e.MAs(2);return e.KtG(_.handleInput(C,a.target,l,"contains"))}),e.qZA()}}function l4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",21),e.NdJ("input",function(a){e.CHM(t);const l=e.oxw(2).$implicit,_=e.oxw(3),C=e.MAs(2);return e.KtG(_.handleInput(C,a.target,l,"contains"))}),e.qZA()}}function c4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"input",22),e.NdJ("input",function(a){e.CHM(t);const l=e.oxw(2).$implicit,_=e.oxw(3),C=e.MAs(2);return e.KtG(_.handleInput(C,a.target,l,"equals"))}),e.qZA()}}function u4(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"date-field",23),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.startDate=a)})("change",function(){e.CHM(t);const a=e.oxw(2).$implicit;e.oxw(3);const l=e.MAs(2);return e.KtG(l.filter({startDate:a.startDate,endDate:a.endDate},a.field,"between"))}),e.ALo(2,"localize"),e.qZA(),e.TgZ(3,"date-field",23),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.endDate=a)})("change",function(){e.CHM(t);const a=e.oxw(2).$implicit;e.oxw(3);const l=e.MAs(2);return e.KtG(l.filter({startDate:a.startDate,endDate:a.endDate},a.field,"between"))}),e.ALo(4,"localize"),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("value",t.startDate)("classNames","search-input")("allowInfinity",!1)("placement","bottom")("placeholder",e.lcZ(2,10,"generic.table.to.date")),e.xp6(2),e.Q6J("value",t.endDate)("classNames","search-input")("allowInfinity",!1)("placement","bottom")("placeholder",e.lcZ(4,12,"generic.table.from.date"))}}function p4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-autoComplete",24),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;return e.KtG(l.text=a)})("completeMethod",function(a){e.CHM(t);const l=e.oxw(2).$implicit,_=e.oxw(3);return e.KtG(_.onComplete(l,a))})("onSelect",function(){e.CHM(t);const a=e.oxw(2).$implicit;e.oxw(3);const l=e.MAs(2);return e.KtG(l.filter(a.text,a.field,"equals"))})("onClear",function(){e.CHM(t);const a=e.oxw(2).$implicit;e.oxw(3);const l=e.MAs(2);return e.KtG(l.filter(a.text,a.field,"equals"))}),e.qZA()}if(2&i){const t=e.oxw(2).$implicit;e.Q6J("ngModel",t.text)("suggestions",t.results)}}function d4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"p-dropdown",25),e.NdJ("onChange",function(a){e.CHM(t);const l=e.oxw(2).$implicit;e.oxw(3);const _=e.MAs(2);return e.KtG(_.filter(a.value.value,l.field,"equals"))}),e.qZA()}if(2&i){const t=e.oxw(5);e.Q6J("options",t.booleanOptions)("virtualScroll",!0)}}function h4(i,n){1&i&&(e.ynx(0),e.YNc(1,s4,1,0,"input",16),e.YNc(2,l4,1,0,"input",16),e.YNc(3,c4,1,0,"input",17),e.YNc(4,u4,5,14,"ng-container",18),e.YNc(5,p4,1,2,"p-autoComplete",19),e.YNc(6,d4,1,2,"p-dropdown",20),e.BQk()),2&i&&(e.xp6(1),e.Q6J("ngSwitchCase","URL"),e.xp6(1),e.Q6J("ngSwitchCase","TEXT"),e.xp6(1),e.Q6J("ngSwitchCase","NUMBER"),e.xp6(1),e.Q6J("ngSwitchCase","DATE"),e.xp6(1),e.Q6J("ngSwitchCase","AUTOCOMPLETE"),e.xp6(1),e.Q6J("ngSwitchCase","BOOLEAN"))}function f4(i,n){if(1&i&&(e.TgZ(0,"th",15),e.YNc(1,h4,7,6,"ng-container",8),e.qZA()),2&i){const t=n.$implicit;e.Q6J("ngSwitch",t.type),e.xp6(1),e.Q6J("ngIf",!1!==t.filter)}}function g4(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,f4,2,2,"th",14),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function _4(i,n){if(1&i&&(e.YNc(0,a4,2,1,"tr",7),e.YNc(1,g4,2,1,"tr",8)),2&i){const t=e.oxw();e.Q6J("ngForOf",t.setup.headers),e.xp6(1),e.Q6J("ngIf",t.hasFilter)}}const m4=function(i){return[i]};function y4(i,n){if(1&i&&(e.ynx(0),e.TgZ(1,"a",29),e._uU(2),e.qZA(),e.BQk()),2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,m4,"/"+t.baseUrl+"/"+o[t.urlField])),e.xp6(1),e.hij(" ",o[t.field]," ")}}function v4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",33),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw().$implicit,_=e.oxw();return e.KtG(_.onClick("view",l,a))}),e.qZA()}if(2&i){const t=e.oxw(4);e.Q6J("title","View "+t.config.label)}}function b4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",34),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw().$implicit,_=e.oxw();return e.KtG(_.onClick("edit",l,a))}),e.qZA()}if(2&i){const t=e.oxw(4);e.Q6J("title","Edit "+t.config.label)}}function x4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",35),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw().$implicit,_=e.oxw();return e.KtG(_.onClick("remove",l,a))}),e.qZA()}if(2&i){const t=e.oxw(4);e.Q6J("title","Remove "+t.config.label)}}function C4(i,n){if(1&i&&(e.ynx(0),e.YNc(1,v4,1,1,"a",30),e.YNc(2,b4,1,1,"a",31),e.YNc(3,x4,1,1,"a",32),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.config.view),e.xp6(1),e.Q6J("ngIf",t.config.edit),e.xp6(1),e.Q6J("ngIf",t.config.remove)}}function w4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"a",37),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw().$implicit,_=e.oxw();return e.KtG(_.onClick("custom",l,a))}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.text," ")}}function T4(i,n){if(1&i&&(e.ynx(0),e.YNc(1,w4,2,1,"a",36),e.BQk()),2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null!=o[t.field])}}function M4(i,n){1&i&&e._UZ(0,"localize",40)}function O4(i,n){1&i&&e._UZ(0,"localize",41)}function S4(i,n){if(1&i&&(e.ynx(0),e.YNc(1,M4,1,0,"localize",38),e.YNc(2,O4,1,0,"localize",39),e.BQk()),2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!0===o[t.field]),e.xp6(1),e.Q6J("ngIf",!1===o[t.field])}}function P4(i,n){1&i&&e.GkF(0)}function E4(i,n){if(1&i&&(e.ynx(0),e._UZ(1,"date-text",42),e.BQk()),2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("date",o[t.field])}}function A4(i,n){if(1&i&&(e.ynx(0),e._uU(1),e.BQk()),2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o[t.field]," ")}}function k4(i,n){if(1&i&&(e.TgZ(0,"td",27),e.YNc(1,y4,3,4,"ng-container",18),e.YNc(2,C4,4,3,"ng-container",18),e.YNc(3,T4,2,1,"ng-container",18),e.YNc(4,S4,3,2,"ng-container",18),e.YNc(5,P4,1,0,"ng-container",18),e.YNc(6,E4,2,1,"ng-container",18),e.YNc(7,A4,2,1,"ng-container",28),e.qZA()),2&i){const t=n.$implicit,o=e.oxw().$implicit,a=e.oxw();e.Q6J("ngSwitch",a.getColumnType(o,t))("ngClass",e.VKq(8,ay,"ACTIONS"===t.type)),e.xp6(1),e.Q6J("ngSwitchCase","URL"),e.xp6(1),e.Q6J("ngSwitchCase","ACTIONS"),e.xp6(1),e.Q6J("ngSwitchCase","CONSTANT"),e.xp6(1),e.Q6J("ngSwitchCase","BOOLEAN"),e.xp6(1),e.Q6J("ngSwitchCase","NONE"),e.xp6(1),e.Q6J("ngSwitchCase","DATE")}}function I4(i,n){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,k4,8,10,"td",26),e.qZA()),2&i){const t=n.columns;e.xp6(1),e.Q6J("ngForOf",t)}}function Z4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onClick("create",null,null))}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.hij("Add new ",t.config.label,"")}}const N4=function(){return[]};class np{constructor(n){this.localizationService=n,this.page={resultSet:[],count:0,pageNumber:1,pageSize:30},this.pageConfig=null,this.initialState=null,this.click=new e.vpe,this.onLoadEvent=new e.vpe,this.paginator=!0,this.scrollable=!1,this.first=0,this.loading=!0,this.booleanOptions=[],this.hasFilter=!1,this.event=null,this.booleanOptions=[{label:"",value:null},{value:!0,label:this.localizationService.decode("change.request.boolean.option.true")},{value:!1,label:this.localizationService.decode("change.request.boolean.option.false")}]}ngOnChanges(n){}ngOnInit(){null!=this.initialState&&(this.first=null!=this.initialState.first?this.initialState.first:0,null!=this.initialState.multiSortMeta&&(this.config.sort=this.initialState.multiSortMeta)),this.loadColumns(),null!=this.refresh&&this.refresh.subscribe(()=>{null!=this.event&&this.onPageChange(this.event)}),null==this.config.baseZIndex&&(this.config.baseZIndex=0),null!=this.config.pageSize&&(this.page.pageSize=this.config.pageSize)}ngAfterViewInit(){null!=this.dt&&null!=this.initialState&&null!=this.initialState.filters&&Object.keys(this.initialState.filters).forEach(t=>{const o=this.initialState.filters[t];this.dt.filter(o.value,t,o.matchMode)})}ngOnDestroy(){null!=this.refresh&&this.refresh.unsubscribe()}loadColumns(){this.setup.columns.forEach(n=>{if("ATTRIBUTE"===n.headerType)if(n.filter&&(this.hasFilter=!0),"DATE"===n.type){if(null!=this.initialState&&null!=this.initialState.filters&&null!=this.initialState.filters[n.field]){const t=this.initialState.filters[n.field].value;n.startDate=t.startDate,n.endDate=t.endDate}}else"BOOLEAN"===n.type||"NUMBER"===n.type?null!=this.initialState&&null!=this.initialState.filters&&null!=this.initialState.filters[n.field]&&(n.value=this.initialState.filters[n.field].value):"AUTOCOMPLETE"===n.type&&null!=this.initialState&&null!=this.initialState.filters&&null!=this.initialState.filters[n.field]&&(n.text=this.initialState.filters[n.field].value)})}onPageChange(n){this.loading=!0,this.event=n,setTimeout(()=>{this.config.service.page(n,this.pageConfig).then(t=>{this.page=t,this.onLoadEvent.emit(n)}).finally(()=>{this.loading=!1})},1e3)}onClick(n,t,o){this.click.emit({type:n,row:t,col:o})}onComplete(n,t){n.onComplete()}getColumnType(n,t){return null!=t.columnType?t.columnType(n):t.type}handleFilter(n){this.onLoadEvent.emit(n)}handleInput(n,t,o,a){n.filter(t.value,o.field,a)}}function L4(i,n){1&i&&e._UZ(0,"progress-bar")}function z4(i,n){if(1&i&&(e.TgZ(0,"div",18),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message)}}function D4(i,n){if(1&i&&(e.TgZ(0,"div",19)(1,"h2"),e._uU(2),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.list.displayLabel," ")}}function R4(i,n){1&i&&e._UZ(0,"localize",31)}function F4(i,n){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,R4,1,0,"localize",30),e._uU(2),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!t.list.working),e.xp6(1),e.hij("\xa0",t.list.versionNumber," ")}}function U4(i,n){1&i&&(e.TgZ(0,"span"),e._UZ(1,"localize",32),e.qZA())}function q4(i,n){1&i&&e._UZ(0,"localize",33)}function J4(i,n){1&i&&e._UZ(0,"localize",34)}function j4(i,n){1&i&&e._UZ(0,"localize",35)}function B4(i,n){1&i&&e._UZ(0,"localize",36)}function G4(i,n){if(1&i&&(e.ynx(0),e._uU(1),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.list.period.value," ")}}function V4(i,n){if(1&i&&(e.ynx(0),e._UZ(1,"date-text",28),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("date",t.list.period.value)}}function Y4(i,n){if(1&i&&(e.ynx(0),e._UZ(1,"date-text",28),e._uU(2," - "),e._UZ(3,"date-text",28),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("date",t.list.period.value.startDate),e.xp6(2),e.Q6J("date",t.list.period.value.endDate)}}function H4(i,n){if(1&i&&(e.TgZ(0,"div",5)(1,"div",9)(2,"h4"),e.YNc(3,F4,3,2,"span",1),e.YNc(4,U4,2,0,"span",1),e.qZA(),e.TgZ(5,"h4"),e._UZ(6,"localize",20),e._uU(7," : "),e.TgZ(8,"span",21),e.YNc(9,q4,1,0,"localize",22),e.YNc(10,J4,1,0,"localize",23),e.qZA()(),e.TgZ(11,"h4"),e._UZ(12,"localize",24),e._uU(13," : "),e.TgZ(14,"span",21),e.YNc(15,j4,1,0,"localize",25),e.YNc(16,B4,1,0,"localize",26),e.qZA()()(),e.TgZ(17,"div",11)(18,"h4"),e._UZ(19,"localize",27),e._uU(20," : "),e.TgZ(21,"span",21),e._UZ(22,"date-text",28),e.qZA()(),e.TgZ(23,"h4"),e._UZ(24,"localize",29),e._uU(25," : "),e.TgZ(26,"span",21),e.YNc(27,G4,2,1,"ng-container",1),e.YNc(28,V4,2,1,"ng-container",1),e.YNc(29,Y4,4,2,"ng-container",1),e.qZA()()()()),2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",!t.list.working),e.xp6(1),e.Q6J("ngIf",t.list.working),e.xp6(5),e.Q6J("ngIf","PUBLIC"===t.list.listMetadata.visibility),e.xp6(1),e.Q6J("ngIf","PUBLIC"!==t.list.listMetadata.visibility),e.xp6(5),e.Q6J("ngIf",t.list.listMetadata.master),e.xp6(1),e.Q6J("ngIf",!t.list.listMetadata.master),e.xp6(6),e.Q6J("date",t.list.publishDate),e.xp6(5),e.Q6J("ngIf","text"===t.list.period.type),e.xp6(1),e.Q6J("ngIf","date"===t.list.period.type),e.xp6(1),e.Q6J("ngIf","range"===t.list.period.type)}}function Q4(i,n){1&i&&(e.TgZ(0,"span",21),e._UZ(1,"localize",43),e.qZA())}np.\u0275fac=function(n){return new(n||np)(e.Y36(mo.o))},np.\u0275cmp=e.Xpm({type:np,selectors:[["generic-table"]],viewQuery:function(n,t){if(1&n&&e.Gf(Wk,5),2&n){let o;e.iGM(o=e.CRH())&&(t.dt=o.first)}},inputs:{setup:"setup",pageConfig:"pageConfig",config:"config",refresh:"refresh",initialState:"initialState",paginator:"paginator",scrollable:"scrollable"},outputs:{click:"click",onLoadEvent:"onLoadEvent"},features:[e.TTD],decls:8,vars:13,consts:[["sortMode","multiple","styleClass","p-datatable-gridlines",3,"columns","value","autoLayout","scrollable","resizableColumns","lazy","paginator","totalRecords","rows","loading","multiSortMeta","onLazyLoad","onFilter"],["dt",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[2,"width","100%","text-align","right"],["style","margin: 10px 0 0;","class","btn btn-primary",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pResizableColumn","",3,"pSortableColumn","ngClass",4,"ngIf"],["pResizableColumn","",3,"ngClass",4,"ngIf"],["pResizableColumn","",3,"pSortableColumn","ngClass"],["ariaLabel","Activate to sort","ariaLabelDesc","Activate to sort in descending order","ariaLabelAsc","Activate to sort in ascending order",2,"float","right",3,"field"],["pResizableColumn","",3,"ngClass"],[3,"ngSwitch",4,"ngFor","ngForOf"],[3,"ngSwitch"],["pInputText","","type","text",3,"input",4,"ngSwitchCase"],["pInputNumber","","type","number","step","any",3,"input",4,"ngSwitchCase"],[4,"ngSwitchCase"],["appendTo","body",3,"ngModel","suggestions","ngModelChange","completeMethod","onSelect","onClear",4,"ngSwitchCase"],["appendTo","body","optionLabel","label","optionValue","value",3,"options","virtualScroll","onChange",4,"ngSwitchCase"],["pInputText","","type","text",3,"input"],["pInputNumber","","type","number","step","any",3,"input"],["customStyles","font-size: 10px;",3,"value","classNames","allowInfinity","placement","placeholder","valueChange","change"],["appendTo","body",3,"ngModel","suggestions","ngModelChange","completeMethod","onSelect","onClear"],["appendTo","body","optionLabel","label","optionValue","value",3,"options","virtualScroll","onChange"],["class","ui-resizable-column",3,"ngSwitch","ngClass",4,"ngFor","ngForOf"],[1,"ui-resizable-column",3,"ngSwitch","ngClass"],[4,"ngSwitchDefault"],[3,"routerLink"],["class","fa fa-eye ico-edit",3,"title","click",4,"ngIf"],["class","fa fa-pencil-alt ico-edit",3,"title","click",4,"ngIf"],["class","fa fa-trash-alt ico-remove",3,"title","click",4,"ngIf"],[1,"fa","fa-eye","ico-edit",3,"title","click"],[1,"fa","fa-pencil-alt","ico-edit",3,"title","click"],[1,"fa","fa-trash-alt","ico-remove",3,"title","click"],[3,"click",4,"ngIf"],[3,"click"],["key","change.request.boolean.option.true",4,"ngIf"],["key","change.request.boolean.option.false",4,"ngIf"],["key","change.request.boolean.option.true"],["key","change.request.boolean.option.false"],[3,"date"],[1,"btn","btn-primary",2,"margin","10px 0 0",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"p-table",0,1),e.NdJ("onLazyLoad",function(a){return t.onPageChange(a)})("onFilter",function(a){return t.handleFilter(a)}),e.YNc(3,e4,2,1,"ng-template",2),e.YNc(4,_4,2,2,"ng-template",3),e.YNc(5,I4,2,1,"ng-template",4),e.qZA(),e.TgZ(6,"div",5),e.YNc(7,Z4,2,1,"button",6),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("columns",t.setup.columns)("value",t.page.resultSet)("autoLayout",!0)("scrollable",!1)("resizableColumns",!0)("lazy",!0)("paginator",!0)("totalRecords",t.page.count)("rows",t.page.pageSize)("loading",t.loading)("multiSortMeta",null!=t.config.sort?t.config.sort:e.DdM(12,N4)),e.xp6(6),e.Q6J("ngIf",t.config.create))},dependencies:[T.mk,T.sg,T.O5,T.RF,T.n9,T.ED,w.rH,y.JJ,y.On,l_.iA,Qk.jx,l_.lQ,l_.Q7,l_.fz,Kk.Lt,$k.Qc,Sn.l,Xl.Q,Fr.u,ia.F],styles:[".ngx-pagination[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{background:#6BA542!important;background:var(--theme-submit-button-color)!important}[_nghost-%COMP%]     .ui-dropdown{width:100%}[_nghost-%COMP%]     body .p-paginator .p-paginator-pages .p-paginator-page.p-state-active{background-color:red}[_nghost-%COMP%]     .actions-col{width:50px;text-align:center}.p-datatable-scrollable-header.ui-widget-header[_ngcontent-%COMP%]{overflow:visible}"]});const K4=function(i){return["/registry/curation-job",i]};function $4(i,n){if(1&i&&(e.TgZ(0,"a",44),e._UZ(1,"localize",45)(2,"date-text",28),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("routerLink",e.VKq(2,K4,t.list.oid)),e.xp6(2),e.Q6J("date",t.list.curation.lastRun)}}function W4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",37)(1,"button",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onRunCuration())}),e._UZ(2,"localize",39),e.qZA(),e.TgZ(3,"span",40),e.YNc(4,Q4,2,0,"span",41),e.YNc(5,$4,3,4,"a",42),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(4),e.Q6J("ngIf",null==t.list.curation.lastRun),e.xp6(1),e.Q6J("ngIf",null!=t.list.curation.lastRun)}}function X4(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",46)(1,"boolean-field",47),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.showInvalid=a)})("change",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handleShowInvalidChange())}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("value",t.showInvalid)("localizeLabelKey","masterlist.showInvalid")}}const eI=function(){return{"fa fa-refresh clickable":!0}};function tI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onPublish())}),e._UZ(1,"i",49)(2,"localize",50),e.qZA()}2&i&&(e.xp6(1),e.Q6J("ngClass",e.DdM(1,eI)))}function nI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onGotoMap(null))}),e._UZ(1,"localize",52),e.qZA()}}function iI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onNewGeoObject())}),e._UZ(1,"localize",53),e.qZA()}}function oI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"a",61),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw(4);return e.KtG(_.onNewGeoObject(l.code))}),e._uU(2),e.qZA()()}if(2&i){const t=n.$implicit;e.xp6(2),e.Oqu(t.label)}}function rI(i,n){if(1&i&&(e.TgZ(0,"ul",59),e.YNc(1,oI,3,1,"li",60),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.list.subtypes)}}function aI(i,n){1&i&&(e.TgZ(0,"span",54,55)(2,"button",56),e._UZ(3,"localize",53)(4,"span",57),e.qZA(),e.YNc(5,rI,2,1,"ul",58),e.qZA())}function sI(i,n){1&i&&e._UZ(0,"localize",64)}function lI(i,n){1&i&&e._UZ(0,"localize",65)}function cI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onExport())}),e.YNc(1,sI,1,0,"localize",62),e.YNc(2,lI,1,0,"localize",63),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.isFiltered),e.xp6(1),e.Q6J("ngIf",t.isFiltered)}}const uI=function(i,n){return{oid:i,showInvalid:n}};function pI(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"generic-table",67),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.onClick(a))})("onLoadEvent",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.onLoadEvent(a))}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("setup",t.setup)("config",t.config)("refresh",t.refresh)("pageConfig",e.WLB(5,uI,t.list.oid,t.showInvalid))("initialState",t.tableState)}}function dI(i,n){if(1&i&&(e.TgZ(0,"div",66),e.YNc(1,pI,2,8,"ng-container",1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null!=t.setup&&null!=t.config)}}function hI(i,n){if(1&i&&(e.TgZ(0,"div",3),e.YNc(1,z4,2,1,"div",4),e.TgZ(2,"div",5),e.YNc(3,D4,3,1,"div",6),e.qZA(),e.YNc(4,H4,30,10,"div",7),e.TgZ(5,"div",8)(6,"div",9),e.YNc(7,W4,6,2,"div",10),e.qZA(),e.TgZ(8,"div",11)(9,"div",12),e.YNc(10,X4,2,2,"span",13),e.YNc(11,tI,3,2,"span",14),e.YNc(12,nI,2,0,"button",15),e.YNc(13,iI,2,0,"button",15),e.YNc(14,aI,6,0,"span",16),e.YNc(15,cI,3,2,"button",15),e.qZA()()(),e.TgZ(16,"div",5),e.YNc(17,dI,2,1,"div",17),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(2),e.Q6J("ngIf",t.list),e.xp6(1),e.Q6J("ngIf",t.list),e.xp6(3),e.Q6J("ngIf",t.list.working&&(t.isRM||t.isSRA)),e.xp6(3),e.Q6J("ngIf",t.isWritable),e.xp6(1),e.Q6J("ngIf",t.list.working),e.xp6(1),e.Q6J("ngIf",t.list.isMember||"PUBLIC"===t.list.geospatialMetadata.visibility),e.xp6(1),e.Q6J("ngIf",t.list.working&&t.isWritable&&!t.list.isAbstract),e.xp6(1),e.Q6J("ngIf",t.list.working&&t.isWritable&&t.list.isAbstract),e.xp6(1),e.Q6J("ngIf","PUBLIC"===t.list.listMetadata.visibility||"PUBLIC"===t.list.geospatialMetadata.visibility||t.isListInOrg()||t.isSRA),e.xp6(2),e.Q6J("ngIf",t.list)}}class Sf{constructor(n,t,o,a,l,_,C,N,F){this.router=n,this.route=t,this.modalService=o,this.service=a,this.pService=l,this.geomService=_,this.locationManagerService=C,this.cacheService=N,this.authService=F,this.message=null,this.list=null,this.current="",this.isRefreshing=!1,this.isWritable=!1,this.isRM=!1,this.isSRA=!1,this.config=null,this.setup=null,this.tableState=null,this.isFiltered=!1,this.showInvalid=!1,this.historyOid=null,this.progressSubscription=null,this.jobSubscription=null,this.userOrgCodes=this.authService.getMyOrganizations()}ngOnInit(){const n=this.route.snapshot.paramMap.get("oid");if(null!=localStorage.getItem(n)){const o=JSON.parse(localStorage.getItem(n));this.tableState=o.event,this.isFiltered=null!=this.tableState&&null!=this.tableState.filters&&Object.keys(this.tableState.filters).length>0}this.service.getVersion(n).then(o=>{this.list=o,this.orgCode=this.list.orgCode;const a=null!=this.list.superTypeCode?this.list.superTypeCode:this.list.typeCode;this.isWritable=this.authService.isGeoObjectTypeRC(this.orgCode,a),this.isRM=this.authService.isGeoObjectTypeRM(this.orgCode,a),this.isSRA=this.authService.isSRA(),this.refreshColumns(),this.config={service:this.service,remove:!1,view:!0,create:!1,label:this.list.displayLabel,sort:[{field:"code",order:1}]},null!=o.refreshProgress&&this.handleProgressChange(o.refreshProgress)});let t=md.buildBaseUrl();this.progressNotifier=Ip(t+"/websocket/progress/"+n),this.progressSubscription=this.progressNotifier.subscribe(o=>{this.handleProgressChange(null!=o.content?o.content:o)}),this.jobNotifier=Ip(t+"/websocket/notify"),this.jobSubscription=this.jobNotifier.subscribe(o=>{this.handleJobChange()}),this.refresh=new pn.x}ngOnDestroy(){null!=this.refresh&&this.refresh.unsubscribe(),null!=this.progressSubscription&&this.progressSubscription.unsubscribe(),this.progressNotifier.complete(),null!=this.jobSubscription&&this.jobSubscription.unsubscribe(),this.jobNotifier.complete()}ngAfterViewInit(){}onClick(n){"view"===n.type&&this.onGotoMap(n.row)}refreshColumns(){this.setup=ol.createColumns(this.list,this.showInvalid,!1,(n,t)=>{this.service.values(this.list.oid,t.text,n.name,this.tableState.filters).then(o=>{t.results=o}).catch(o=>{this.error(o)})})}handleShowInvalidChange(){this.refreshColumns(),this.refresh.next()}handleProgressChange(n){this.isRefreshing=n.current<n.total,this.pService.progress(n),!this.isRefreshing&&null!=this.refresh&&this.refresh.next()}handleJobChange(){null!=this.historyOid&&this.service.getJob(this.historyOid).then(n=>{null!=n&&(("SUCCESS"===n.status||"FAILURE"===n.status)&&(this.handleProgressChange({current:1,total:1}),this.historyOid=null),"FAILURE"===n.status&&null!=n.exception&&(this.message=n.exception.message))})}onEdit(n){let t=this.modalService.show(Ld,{backdrop:!0,ignoreBackdropClick:!0});t.content.configureAsExisting(n.code,this.list.typeCode,this.list.forDate,this.list.isGeometryEditable),t.content.setListId(this.list.oid),t.content.setOnSuccessCallback(()=>{this.refresh.next()})}onPublish(){this.message=null,this.service.publishList(this.list.oid).toPromise().then(n=>{this.isRefreshing=!0,this.list.curation={},this.historyOid=n.jobOid}).catch(n=>{this.error(n)})}onNewGeoObject(n=null){n||(n=this.list.typeCode);const t={type:n,code:"__NEW__"};this.locationManagerService.addLayerForList(this.list,t),this.router.navigate(["/registry/location-manager"],{queryParams:t})}onExport(){const n={filters:null!=this.tableState.filters?{...this.tableState.filters}:{}};this.showInvalid||(n.filters.invalid={value:!1,matchMode:"equals"}),this.bsModalRef=this.modalService.show(Ud,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.init(this.list),this.bsModalRef.content.onFormat.subscribe(t=>{if("SHAPEFILE"===t.format){let o=pt.N.apiUrl+"/api/list-type/export-shapefile?oid="+this.list.oid;o+="&criteria="+encodeURIComponent(JSON.stringify(n)),null!=t.actualGeometryType&&t.actualGeometryType.length>0&&(o+="&actualGeometryType="+encodeURIComponent(t.actualGeometryType)),window.location.href=o}else"EXCEL"===t.format&&(window.location.href=pt.N.apiUrl+"/api/list-type/export-spreadsheet?oid="+this.list.oid+"&criteria="+encodeURIComponent(JSON.stringify(n)))})}onWheel(n){n.target.parentElement.closest("table").parentElement.scrollLeft+=n.deltaY,n.preventDefault()}onGotoMap(n){let t={pageContext:"DATA"};null==n?(this.locationManagerService.selectListRecord(this.list,null,null,t),this.service.getBounds(this.list.oid).then(o=>{if(o&&Array.isArray(o)){const l=new sr.LngLatBounds([o[0],o[1]],[o[2],o[3]]).toArray();t.bounds=JSON.stringify(l)}this.router.navigate(["/registry/location-manager"],{queryParams:t})}).catch(o=>{this.error(o)})):this.service.record(this.list.oid,n.uid,!1).then(o=>{this.cacheService.getTypeCache().waitOnTypes().then(()=>{this.locationManagerService.selectListRecord(this.list,n.uid,o,t),"GEO_OBJECT"===o.recordType?this.router.navigate(["/registry/location-manager"],{queryParams:t}):this.service.getBounds(this.list.oid,n.uid).then(a=>{if(a&&Array.isArray(a)){const _=new sr.LngLatBounds([a[0],a[1]],[a[2],a[3]]).toArray();t.bounds=JSON.stringify(_)}this.router.navigate(["/registry/location-manager"],{queryParams:t})}).catch(a=>{this.error(a)})})}).catch(o=>{this.error(o)})}onRunCuration(){this.service.createCurationJob(this.list).then(n=>{this.router.navigate(["/registry/curation-job",this.list.oid])}).catch(n=>{this.error(n)})}onLoadEvent(n){this.tableState=n,this.isFiltered=null!=this.tableState&&null!=this.tableState.filters&&Object.keys(this.tableState.filters).length>0;const t={event:n,oid:this.list.oid};localStorage.setItem(t.oid,JSON.stringify(t))}isListInOrg(){return!!(this.userOrgCodes&&this.userOrgCodes.length>0&&-1!==this.userOrgCodes.indexOf(this.orgCode))}error(n){this.message=Zt.qL.getMessageFromError(n)}}function fI(i,n){if(1&i&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function gI(i,n){if(1&i&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e._UZ(3,"i",11),e.TgZ(4,"p",12)(5,"span",13)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"span",13),e._UZ(9,"localize",14),e._uU(10),e.qZA(),e.TgZ(11,"span",13),e._UZ(12,"localize",15),e.TgZ(13,"span",16),e._UZ(14,"date-text",17),e.qZA()()()()(),e.TgZ(15,"div",18)(16,"div")(17,"h5")(18,"b"),e._uU(19),e._UZ(20,"localize",19),e._uU(21),e._UZ(22,"localize",20),e.qZA()(),e.TgZ(23,"h5"),e._uU(24),e._UZ(25,"localize",21),e.qZA()()(),e._UZ(26,"div",22),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Oqu(t.version.label),e.xp6(3),e.hij(" ",t.job.lastRunBy," "),e.xp6(4),e.Q6J("date",t.job.lastRun),e.xp6(5),e.hij("",t.job.workProgress," "),e.xp6(2),e.hij(" ",t.job.workTotal," "),e.xp6(3),e.hij("",t.job.workTotal-t.job.workProgress," ")}}function _I(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(3);return e.KtG(l.onEdit(a))}),e._UZ(1,"localize",40),e.qZA()}}function mI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",36),e.YNc(1,_I,2,0,"button",37),e.TgZ(2,"boolean-field",38),e.NdJ("change",function(){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.toggleResolution(a))}),e.ALo(3,"localize"),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","APPLY_GEO_OBJECT"!==t.resolution),e.xp6(1),e.Q6J("value","APPLY_GEO_OBJECT"===t.resolution)("label",e.lcZ(3,3,"list.type.problem.resolved"))}}function yI(i,n){if(1&i&&(e.TgZ(0,"tr")(1,"td",34)(2,"p"),e._uU(3),e.qZA()(),e.TgZ(4,"td",34)(5,"p"),e._uU(6),e.qZA()(),e.YNc(7,mI,4,5,"td",35),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(3);e.xp6(3),e.Oqu(o.getFriendlyProblemType(t.type)),e.xp6(3),e.Oqu(t.goCode),e.xp6(1),e.Q6J("ngIf",o.isAdmin||o.isMaintainer)}}function vI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",32)(1,"pagination-controls",41),e.NdJ("pageChange",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.onPageChange(a))}),e.qZA()()}}Sf.\u0275fac=function(n){return new(n||Sf)(e.Y36(w.F0),e.Y36(w.gz),e.Y36(Ln.tT),e.Y36(Uo),e.Y36(nn.Nz),e.Y36(vo),e.Y36(Wu),e.Y36(Ml),e.Y36(nn.e8))},Sf.\u0275cmp=e.Xpm({type:Sf,selectors:[["list"]],decls:5,vars:2,consts:[[1,"new-admin-design-main"],[4,"ngIf"],["id","app-container","class","container-fluid",4,"ngIf"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"row"],["class","col-md-12",4,"ngIf"],["class","row",4,"ngIf"],[1,"row",2,"margin-bottom","10px"],[1,"col-md-4"],["class","button-holder pull-left",4,"ngIf"],[1,"col-md-8"],[1,"button-holder","pull-right"],["class","clickable","style","vertical-align:middle;display:inline-block;line-height:0;",4,"ngIf"],["class","clickable","style","padding: 10px;",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary","role","button",3,"click",4,"ngIf"],["dropdown","","class","dropdown",4,"ngIf"],["class","col-md-12","style","max-height:calc(100vh - 460px); min-height:calc(100vh - 460px);",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"col-md-12"],["key","masterlist.list.visibility"],[1,"date-string-display"],["key","masterlist.public",4,"ngIf"],["key","masterlist.private",4,"ngIf"],["key","masterlists.list.authoritativeness"],["key","list.type.master",4,"ngIf"],["key","list.type.non.master",4,"ngIf"],["key","masterlist.generatedDate"],[3,"date"],["key","masterlist.forDate"],["key","list.type.version",4,"ngIf"],["key","list.type.version"],["key","list.type.working.version"],["key","masterlist.public"],["key","masterlist.private"],["key","list.type.master"],["key","list.type.non.master"],[1,"button-holder","pull-left"],["type","submit","role","button",1,"btn","btn-primary",2,"margin-left","0",3,"click"],["key","list.type.run.curation"],[2,"vertical-align","middle","display","inline-block","font-style","italic","margin-left","5px","color","grey"],["class","date-string-display",4,"ngIf"],["routerLinkActive","active",3,"routerLink",4,"ngIf"],["key","list.type.run.na"],["routerLinkActive","active",3,"routerLink"],["key","list.type.last.validation.date"],[1,"clickable",2,"vertical-align","middle","display","inline-block","line-height","0"],[3,"value","localizeLabelKey","valueChange","change"],[1,"clickable",2,"padding","10px",3,"click"],["aria-hidden","true",2,"font-size","24px","vertical-align","middle","padding-right","5px",3,"ngClass"],["key","masterlist.publish"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","masterlist.viewOnMap"],["key","masterlist.newGeoObject"],["dropdown","",1,"dropdown"],["dropdown","bs-dropdown"],["dropdownToggle","","type","button","id","dropdownMenu1","data-toggle","dropdown","aria-haspopup","true","aria-expanded","true",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["class","dropdown-menu","aria-labelledby","dropdownMenu1",4,"dropdownMenu"],["aria-labelledby","dropdownMenu1",1,"dropdown-menu"],[4,"ngFor","ngForOf"],[3,"click"],["key","io.export.allrows",4,"ngIf"],["key","io.export.filteredrows",4,"ngIf"],["key","io.export.allrows"],["key","io.export.filteredrows"],[1,"col-md-12",2,"max-height","calc(100vh - 460px)","min-height","calc(100vh - 460px)"],[3,"setup","config","refresh","pageConfig","initialState","click","onLoadEvent"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.YNc(3,L4,1,0,"progress-bar",1),e.YNc(4,hI,18,11,"div",2),e.qZA()),2&n&&(e.xp6(3),e.Q6J("ngIf",t.isRefreshing),e.xp6(1),e.Q6J("ngIf",null!=t.list))},dependencies:[T.mk,T.sg,T.O5,w.rH,w.Od,E.Hz,E.Mq,E.TO,Sn.l,rl.M,Da.N,Hk.R,ba.C,np,Fr.u],styles:[".version-busy-overlay[_ngcontent-%COMP%]{height:100%;width:100%;background-color:#ccc;position:absolute;display:block;opacity:.8;z-index:99999!important}[_nghost-%COMP%]  input{width:100%}[_nghost-%COMP%]  .p-corner-all{border-radius:5px;border:1px solid;border-color:#767676;border-color:var(--theme-input-text-border)}[_nghost-%COMP%]  .p-inputtext:enabled:focus:not(.-state-error){border-color:#6ba542;border-color:var(--theme-input-text-border-active);outline:0;box-shadow:inset 0 1px 1px #00000014,0 0 8px #6ba54299}[_nghost-%COMP%]  .p-datatable .p-sortable-column.p-highlight{background:#6BA542}[_nghost-%COMP%]  .p-datatable .p-sortable-column:focus{box-shadow:inset 0 0 0 .2em #6ba542}[_nghost-%COMP%]  .p-datatable{height:calc(100vh - 295px)}[_nghost-%COMP%]  .p-datatable .p-datatable-wrapper{height:100%}[_nghost-%COMP%]  .p-datatable-table .p-datatable-scrollable-wrapper{height:100%}"]});const bI=function(i,n,t){return{itemsPerPage:i,currentPage:n,totalItems:t}};function xI(i,n){if(1&i&&(e.TgZ(0,"div",25)(1,"ul",26)(2,"table",27)(3,"thead")(4,"tr")(5,"th",28),e._UZ(6,"localize",29),e.qZA(),e.TgZ(7,"th",28),e._UZ(8,"localize",30),e.qZA(),e._UZ(9,"th",28),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,yI,8,3,"tr",31),e.ALo(12,"paginate"),e.qZA()(),e.TgZ(13,"div",32),e.YNc(14,vI,2,0,"div",33),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(11),e.Q6J("ngForOf",e.xi3(12,2,t.page.resultSet,e.kEZ(5,bI,t.page.pageSize,t.page.pageNumber,t.page.count))),e.xp6(3),e.Q6J("ngIf",t.page.resultSet.length>0)}}function CI(i,n){if(1&i&&(e.TgZ(0,"div",23),e.YNc(1,xI,15,9,"div",24),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.job)}}function wI(i,n){1&i&&(e.TgZ(0,"div",23)(1,"div",25),e._UZ(2,"localize",42),e.qZA()())}class Pf{constructor(n,t,o,a,l,_,C){this.router=n,this.service=t,this.modalService=o,this.route=a,this.dateService=l,this.localizeService=_,this.message=null,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.timeCounter=0,this.isPolling=!1,this.hasRowValidationProblem=!1,this.subscription=null,this.isAdmin=C.isAdmin(),this.isMaintainer=this.isAdmin||C.isMaintainer(),this.isContributor=this.isAdmin||this.isMaintainer||C.isContributer()}ngOnInit(){this.service.getVersion(this.route.snapshot.params.oid).then(o=>{this.version=o,this.onPageChange(1)});let t=md.buildBaseUrl();this.notifier=Ip(t+"/websocket/notify"),this.subscription=this.notifier.subscribe(o=>{"CURATION_JOB_CHANGE"===o.type&&this.onPageChange(this.page.pageNumber)})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe(),this.notifier.complete()}formatAffectedRows(n){return n.replace(/,/g,", ")}formatValidationResolve(n){return JSON.stringify(n)}onProblemResolved(n){const t=this.page.resultSet.findIndex(o=>o.id===n.id);-1!==t&&this.page.resultSet.splice(t,1)}getFriendlyProblemType(n){return"NO_GEOMETRY"===n?this.localizeService.decode("list.type.no.geometry"):"INVALID_GEOMETRY"===n?this.localizeService.decode("list.type.invalid.geometry"):n}onEdit(n){const t={layers:JSON.stringify([this.version.oid]),version:this.version.oid,uid:n.goUid,pageContext:"DATA"};this.router.navigate(["/registry/location-manager"],{queryParams:t})}toggleResolution(n){const t=null==n.resolution||0===n.resolution.length||"UNRESOLVED"===n.resolution?"APPLY_GEO_OBJECT":"UNRESOLVED";this.service.setResolution(n,t).then(()=>{n.resolution=t}).catch(o=>{this.error(o)})}onPageChange(n){null!=this.version&&(this.message=null,this.service.getCurationInfo(this.version,!1,n,this.page.pageSize).then(t=>{this.job=t,"SUCCESS"===this.job.status&&(this.page=this.job.page)}).catch(t=>{this.error(t)}))}error(n){this.message=Zt.qL.getMessageFromError(n)}}Pf.\u0275fac=function(n){return new(n||Pf)(e.Y36(w.F0),e.Y36(Uo),e.Y36(Ln.tT),e.Y36(w.gz),e.Y36(zs.R),e.Y36(nn.oQ),e.Y36(nn.e8))},Pf.\u0275cmp=e.Xpm({type:Pf,selectors:[["curation-job"]],decls:11,vars:4,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"py-5"],["key","curation.job.title"],["class","row","style","background: #F4F4F4;\n                                border-radius: 15px;\n                                margin-bottom: 20px;\n                                margin-top: 20px;\n                                padding: 10px;",4,"ngIf"],["class","row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"row",2,"background","#F4F4F4","border-radius","15px","margin-bottom","20px","margin-top","20px","padding","10px"],[1,"col-md-4","order-md-1"],[1,"wrapper"],["aria-hidden","true",1,"fa","fa-file",2,"position","absolute","font-size","55px"],[2,"padding-left","60px"],[2,"display","block"],["key","list.type.job.started.by"],["key","scheduledjobs.job.started.label"],[1,"date-string-display"],[3,"date"],[1,"col-md-3","order-md-1"],["key","list.type.validated.out.of"],["key","scheduledjobs.job.imported.total.label"],["key","scheduledjobs.job.remaining.label"],[1,"col-md-5","order-md-1"],[1,"row"],["class","col-md-12 order-md-1",4,"ngIf"],[1,"col-md-12","order-md-1"],[1,"list-group"],[1,"list-table","table","table-bordered","table-striped"],[1,"label-column"],["key","scheduledjobs.import.table.problem.type.header"],["key","data.property.label.code"],[4,"ngFor","ngForOf"],[1,"solid-table-footer"],["class","solid-table-footer",4,"ngIf"],[1,"label-column",2,"vertical-align","middle"],["class","label-column","style","text-align: right;",4,"ngIf"],[1,"label-column",2,"text-align","right"],["type","submit","class","btn btn-link","role","button",3,"click",4,"ngIf"],[2,"vertical-align","middle","line-height","0",3,"value","label","change"],["type","submit","role","button",1,"btn","btn-link",3,"click"],["key","scheduledjobs.fix.problem.button"],[3,"pageChange"],["key","list.type.validation.empty"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,fI,2,1,"div",2),e.TgZ(5,"div",3)(6,"h2"),e._UZ(7,"localize",4),e.qZA()(),e.YNc(8,gI,27,6,"div",5),e.YNc(9,CI,2,1,"div",6),e.YNc(10,wI,3,0,"div",6),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(4),e.Q6J("ngIf",t.job),e.xp6(1),e.Q6J("ngIf",t.page&&t.page.resultSet.length>0),e.xp6(1),e.Q6J("ngIf",t.job&&"SUCCESS"===t.job.status&&t.page&&0===t.page.resultSet.length))},dependencies:[T.sg,T.O5,U.LS,Sn.l,rl.M,Da.N,ba.C,Fr.u,U._s,ia.F],encapsulation:2});const TI=function(i){return{typeCode:i}};function MI(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"generic-table",3),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.onClick(a))}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.businessType.displayLabel.localizedValue),e.xp6(1),e.Q6J("setup",t.setup)("config",t.config)("pageConfig",e.VKq(4,TI,t.businessType.code))}}class Ef{constructor(n,t,o){this.service=n,this.localizationService=t,this.route=o,this.message=null,this.config=null,this.setup=null}ngOnInit(){const n=this.route.snapshot.paramMap.get("oid");this.service.get(n).then(t=>{this.businessType=t;const o=[];this.businessType.attributes.forEach(a=>{let l="TEXT",_=!0;"integer"===a.type||"decimal"===a.type?l="NUMBER":"boolean"===a.type?l="BOOLEAN":"term"===a.type||"classification"===a.type?_=!1:"date"===a.type&&(l="DATE"),o.push({header:a.label.localizedValue,field:a.code,type:l,sortable:_,filter:_,rowspan:1,colspan:1,headerType:"ATTRIBUTE"})}),this.setup={headers:[o],columns:o},this.config={service:this.service,remove:!1,view:!1,create:!1,label:this.businessType.displayLabel.localizedValue,sort:[{field:"code",order:1}]}})}onClick(n){}}function OI(i,n){if(1&i&&(e.TgZ(0,"div",16),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message)}}function SI(i,n){1&i&&(e.TgZ(0,"h1"),e._UZ(1,"localize",17),e.qZA())}function PI(i,n){if(1&i&&(e.TgZ(0,"h1"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.type.displayLabel.localizedValue," ")}}function EI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"label"),e._UZ(3,"localize",18),e.TgZ(4,"span",19),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",14),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",9)(9,"input",20),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("disabled",o.readonly)("required","defaultLocale"===t.locale)}}function AI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"label"),e._UZ(3,"localize",21),e.TgZ(4,"span",19),e._uU(5," \xa0("),e._UZ(6,"convert-key-label",14),e._uU(7,") "),e.qZA()()(),e.TgZ(8,"div",9)(9,"input",20),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","description-"+t.locale)("disabled",o.readonly)("required","defaultLocale"===t.locale)}}function kI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSubmit())}),e._UZ(1,"localize",23),e.qZA()}if(2&i){e.oxw();const t=e.MAs(6),o=e.oxw();e.Q6J("disabled",t.invalid||!o.valid)}}function II(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,OI,2,1,"div",2),e.TgZ(2,"div",3),e.YNc(3,SI,2,0,"h1",1),e.YNc(4,PI,2,1,"h1",1),e.qZA(),e.TgZ(5,"form",4,5)(7,"fieldset")(8,"div",6)(9,"div",7)(10,"label"),e._UZ(11,"localize",8),e.qZA()(),e.TgZ(12,"div",9)(13,"input",10),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.type.code=a)}),e.qZA()()(),e.YNc(14,EI,10,5,"div",11),e.YNc(15,AI,10,5,"div",11),e.TgZ(16,"div",6),e._UZ(17,"div",7),e.TgZ(18,"div")(19,"div",12)(20,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCancel())}),e._UZ(21,"localize",14),e.qZA(),e.YNc(22,kI,2,1,"button",15),e.qZA()()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(2),e.Q6J("ngIf",t.isNew),e.xp6(1),e.Q6J("ngIf",!t.isNew),e.xp6(9),e.Q6J("ngModel",t.type.code)("disabled",t.readonly||!t.isNew),e.xp6(1),e.Q6J("ngForOf",t.type.displayLabel.localeValues),e.xp6(1),e.Q6J("ngForOf",t.type.description.localeValues),e.xp6(6),e.Q6J("key",t.readonly?"io.back":"io.cancel"),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}Ef.\u0275fac=function(n){return new(n||Ef)(e.Y36(tc),e.Y36(mo.o),e.Y36(w.gz))},Ef.\u0275cmp=e.Xpm({type:Ef,selectors:[["business-table"]],decls:5,vars:1,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],[4,"ngIf"],[3,"setup","config","pageConfig","click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,MI,4,6,"ng-container",2),e.qZA()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.businessType))},dependencies:[T.O5,Da.N,ba.C,np],encapsulation:2});class qd{constructor(n,t,o){this.service=n,this.lService=t,this.bsModalRef=o,this.currentDate=new Date,this.message=null,this.onClassificationTypeChange=null,this.type=null,this.readonly=!1,this.isNew=!1,this.valid=!0}ngOnInit(){this.onClassificationTypeChange=new pn.x}ngOnDestroy(){null!=this.onClassificationTypeChange&&this.onClassificationTypeChange.unsubscribe()}init(n,t){return null==t?(this.isNew=!0,this.type={oid:null,displayLabel:this.lService.create(),description:this.lService.create(),code:""}):(this.type=t,this.isNew=!1),this.onClassificationTypeChange.subscribe(n)}onSubmit(){this.service.apply(this.type).then(n=>{this.onClassificationTypeChange.next(n),this.bsModalRef.hide()}).catch(n=>{this.error(n)})}stringify(n){return JSON.stringify(n)}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}function ZI(i,n){if(1&i&&(e.TgZ(0,"div",16),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.message)}}function NI(i,n){1&i&&(e.TgZ(0,"h1"),e._UZ(1,"localize",17),e.qZA())}function LI(i,n){if(1&i&&(e.TgZ(0,"h1"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.classificationType.displayLabel.localizedValue," ")}}function zI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"label"),e._UZ(3,"localize",18),e.TgZ(4,"span",19),e._uU(5,"\xa0("),e._UZ(6,"convert-key-label",14),e._uU(7,")"),e.qZA()()(),e.TgZ(8,"div",9)(9,"input",20),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","label-"+t.locale)("disabled",o.readonly)("required","defaultLocale"===t.locale)}}function DI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7)(2,"label"),e._UZ(3,"localize",21),e.TgZ(4,"span",19),e._uU(5," \xa0("),e._UZ(6,"convert-key-label",14),e._uU(7,") "),e.qZA()()(),e.TgZ(8,"div",9)(9,"input",20),e.NdJ("ngModelChange",function(a){const _=e.CHM(t).$implicit;return e.KtG(_.value=a)}),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("key",t.locale),e.xp6(3),e.Q6J("ngModel",t.value)("name","description-"+t.locale)("disabled",o.readonly)("required","defaultLocale"===t.locale)}}function RI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onSubmit())}),e._UZ(1,"localize",23),e.qZA()}if(2&i){e.oxw();const t=e.MAs(6),o=e.oxw();e.Q6J("disabled",t.invalid||!o.valid)}}function FI(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,ZI,2,1,"div",2),e.TgZ(2,"div",3),e.YNc(3,NI,2,0,"h1",1),e.YNc(4,LI,2,1,"h1",1),e.qZA(),e.TgZ(5,"form",4,5)(7,"fieldset")(8,"div",6)(9,"div",7)(10,"label"),e._UZ(11,"localize",8),e.qZA()(),e.TgZ(12,"div",9)(13,"input",10),e.NdJ("ngModelChange",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.classification.code=a)}),e.qZA()()(),e.YNc(14,zI,10,5,"div",11),e.YNc(15,DI,10,5,"div",11),e.TgZ(16,"div",6),e._UZ(17,"div",7),e.TgZ(18,"div")(19,"div",12)(20,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCancel())}),e._UZ(21,"localize",14),e.qZA(),e.YNc(22,RI,2,1,"button",15),e.qZA()()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.message),e.xp6(2),e.Q6J("ngIf",t.isNew),e.xp6(1),e.Q6J("ngIf",!t.isNew),e.xp6(9),e.Q6J("ngModel",t.classification.code)("disabled",t.readonly||!t.isNew),e.xp6(1),e.Q6J("ngForOf",t.classification.displayLabel.localeValues),e.xp6(1),e.Q6J("ngForOf",t.classification.description.localeValues),e.xp6(6),e.Q6J("key",t.readonly?"io.back":"io.cancel"),e.xp6(1),e.Q6J("ngIf",!t.readonly)}}qd.\u0275fac=function(n){return new(n||qd)(e.Y36(cu),e.Y36(mo.o),e.Y36(Ln.UZ))},qd.\u0275cmp=e.Xpm({type:qd,selectors:[["classification-type-publish-modal"]],decls:2,vars:1,consts:[[1,"modal-body"],[4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["autocomplete","off",1,"modal-form"],["form","ngForm"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],["name","code","type","text","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","row-holder",4,"ngFor","ngForOf"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],[3,"key"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["key","data.type.create.classification"],["key","data.property.label.label"],[2,"color","#BABABA"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],["key","data.property.label.description"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,II,23,9,"ng-container",1),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.type))},dependencies:[T.sg,T.O5,y._Y,y.Fj,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}hr.bottom[_ngcontent-%COMP%]{border-top:1px solid #776f6f}']});class Jd{constructor(n,t,o){this.service=n,this.lService=t,this.bsModalRef=o,this.message=null,this.onClassificationChange=null,this.classificationType=null,this.parent=null,this.classification=null,this.readonly=!1,this.isNew=!1,this.valid=!0}ngOnInit(){this.onClassificationChange=new pn.x}ngOnDestroy(){null!=this.onClassificationChange&&this.onClassificationChange.unsubscribe()}init(n,t,o,a){return this.classificationType=t,this.parent=o,null==a?(this.isNew=!0,this.classification={code:"",displayLabel:this.lService.create(),description:this.lService.create()}):(this.classification=a,this.isNew=!1),this.onClassificationChange.subscribe(n)}onSubmit(){this.service.apply(this.classificationType.code,null!=this.parent?this.parent.code:null,this.classification,this.isNew).then(o=>{this.onClassificationChange.next(o),this.bsModalRef.hide()}).catch(o=>{this.error(o)})}onCancel(){this.bsModalRef.hide()}error(n){this.message=Zt.qL.getMessageFromError(n)}}Jd.\u0275fac=function(n){return new(n||Jd)(e.Y36(Mc),e.Y36(mo.o),e.Y36(Ln.UZ))},Jd.\u0275cmp=e.Xpm({type:Jd,selectors:[["classification-publish-modal"]],decls:2,vars:1,consts:[[1,"modal-body"],[4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"heading","text-center"],["autocomplete","off",1,"modal-form"],["form","ngForm"],[1,"row-holder"],[1,"label-holder"],["key","data.property.label.code"],[1,"holder"],["name","code","type","text","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","row-holder",4,"ngFor","ngForOf"],[1,"button-holder"],["type","button","role","button",1,"btn","btn-default",3,"click"],[3,"key"],["type","submit","class","btn btn-primary","role","button",3,"disabled","click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],["key","data.type.create.classification"],["key","data.property.label.label"],[2,"color","#BABABA"],["type","text",1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],["key","data.property.label.description"],["type","submit","role","button",1,"btn","btn-primary",3,"disabled","click"],["key","io.submit"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e.YNc(1,FI,23,9,"ng-container",1),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",null!=t.classification))},dependencies:[T.sg,T.O5,y._Y,y.Fj,y.JJ,y.JL,y.Q7,y.On,y.F,Sn.l,al.j],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}hr.bottom[_ngcontent-%COMP%]{border-top:1px solid #776f6f}']});const UI=["nodeMenu"];function qI(i,n){1&i&&e._UZ(0,"localize",7)}function JI(i,n){1&i&&e._UZ(0,"localize",8)}function jI(i,n){1&i&&e._UZ(0,"localize",9)}function BI(i,n){if(1&i&&(e.TgZ(0,"div",10),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}function GI(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onCreate(null))}),e._UZ(2,"localize",14),e.qZA(),e.BQk()}}function VI(i,n){if(1&i&&e._UZ(0,"tree-root",15,16),2&i){const t=e.oxw(2);e.Q6J("options",t.options)("nodes",t.nodes)}}function YI(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",4),e.YNc(2,GI,3,0,"ng-container",11),e.TgZ(3,"div"),e.YNc(4,VI,2,2,"tree-root",12),e.qZA()()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",0===t.nodes.length),e.xp6(2),e.Q6J("ngIf",t.nodes.length>0)}}var uu=(()=>{return(i=uu||(uu={}))[i.CLASSIFICATION=0]="CLASSIFICATION",i[i.LINK=1]="LINK",uu;var i})();class Af{constructor(n,t,o,a){this.contextMenuService=n,this.modalService=t,this.service=o,this.lService=a,this.message=null,this.classificationType=null,this.nodes=null,this.subscription=null,this.options={idField:"code",getChildren:l=>this.getChildren(l),actionMapping:{mouse:{click:(l,_,C)=>{this.treeNodeOnClick(_,C)},contextMenu:(l,_,C)=>{this.handleOnMenu(_,C)},drop:(l,_,C,N)=>{this.onMoveNode(l,_,C,N)}}},allowDrag:l=>{if(l.data.type===uu.CLASSIFICATION){const _=l.data.classification.code;return-1===this.nodes.findIndex(C=>C.classification.code===_)}return!1},allowDrop:(l,_)=>null!=_&&null!=_.parent&&_.parent.data.type===uu.CLASSIFICATION,animateExpand:!0,scrollOnActivate:!0,animateSpeed:2,animateAcceleration:1.01}}ngOnInit(){this.getChildren(null).then(n=>{this.nodes=n,this.nodes.length>0&&window.setTimeout(()=>{this.tree.treeModel.getFirstRoot().expand()},50)})}ngOnDestroy(){null!=this.subscription&&this.subscription.unsubscribe(),this.subscription=null}getChildren(n){const t=null!=n?n.data:null;return this.service.getChildren(this.classificationType.code,null!=t?t.classification.code:null,1,100).then(a=>{const l=this.createNodes(t,a);return null!=t&&(null==t.children&&(t.children=[]),t.children.concat(l)),l}).catch(a=>[])}createNodes(n,t){const o=t.resultSet.map(a=>({code:a.code,name:a.displayLabel.localizedValue,type:uu.CLASSIFICATION,classification:a,hasChildren:!0}));return t.count>t.pageNumber*t.pageSize&&o.push({code:"...",name:"...",type:uu.LINK,hasChildren:!1,pageNumber:t.pageNumber+1,parent:n}),o}handleOnMenu(n,t){this.contextMenuService.show.next({contextMenu:this.nodeMenuComponent,event:t,item:n}),t.preventDefault(),t.stopPropagation()}treeNodeOnClick(n,t){const o=null!=n?n.data:null;if(null!=o&&o.type===uu.LINK){if(null!=n.parent){const a=n.parent.data;this.service.getChildren(this.classificationType.code,a.classification.code,o.pageNumber,100).then(C=>{const N=this.createNodes(a,C);a.children=a.children.filter(F=>"..."!==F.code),a.children=a.children.concat(N),this.tree.treeModel.update()}).catch(C=>{})}}else n.isExpanded?n.collapse():n.expand(),n.setActiveAndVisible()}onCreate(n){null!=this.subscription&&this.subscription.unsubscribe();const t=null!=n?n.data:null;this.bsModalRef=this.modalService.show(Jd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.subscription=this.bsModalRef.content.init(o=>{const a={code:o.code,name:o.displayLabel.localizedValue,type:uu.CLASSIFICATION,classification:o,hasChildren:!0};null!=n?t.children.push(a):this.nodes.push(a),this.tree.treeModel.update()},this.classificationType,null!=t?t.classification:null)}onEdit(n){null!=this.subscription&&this.subscription.unsubscribe(),this.bsModalRef=this.modalService.show(Jd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.subscription=this.bsModalRef.content.init(t=>{const o=n.data;o.classification=t,o.name=t.displayLabel.localizedValue,this.tree.treeModel.update()},this.classificationType,null,n.data.classification)}onRemove(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.lService.decode("confirm.modal.verify.delete")+" ["+n.data.classification.code+"]",this.bsModalRef.content.submitText=this.lService.decode("modal.button.delete"),this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe(()=>{this.removeTreeNode(n)})}onMoveNode(n,t,o,a){const l=t.data.classification,_=a.from.data.classification,C=l.code,N=_.code;let F=this.lService.decode("classification.move.message");F=F.replace("{0}",_.displayLabel.localizedValue),F=F.replace("{1}",l.displayLabel.localizedValue),this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=F,this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe(()=>{this.message=null,this.service.move(this.classificationType.code,N,C).then(()=>{S.iM.MOVE_NODE(n,t,o,a)}).catch(V=>{this.error(V)})})}removeTreeNode(n){this.message=null,this.service.remove(this.classificationType.code,n.data.classification.code).then(()=>{null==n.parent.data.classification&&(this.nodes=[]);const t=n.parent;t.data.children=t.data.children.filter(a=>a.id!==n.data.id),0===t.data.children.length&&(t.data.hasChildren=!1),this.tree.treeModel.update()}).catch(t=>{this.error(t)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}function HI(i,n){if(1&i&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.message)}}Af.\u0275fac=function(n){return new(n||Af)(e.Y36(P.Lk),e.Y36(Ln.tT),e.Y36(Mc),e.Y36(mo.o))},Af.\u0275cmp=e.Xpm({type:Af,selectors:[["classification-type"]],viewQuery:function(n,t){if(1&n&&(e.Gf(S.qr,5),e.Gf(UI,5)),2&n){let o;e.iGM(o=e.CRH())&&(t.tree=o.first),e.iGM(o=e.CRH())&&(t.nodeMenuComponent=o.first)}},inputs:{classificationType:"classificationType"},decls:13,vars:3,consts:[["nodeMenu",""],["contextMenuItem","",3,"execute"],[1,"heading"],[1,"row"],[1,"col-md-12"],["class","alert alert-danger","style","margin-top: 5px;","role","alert",4,"ngIf"],["class","row",4,"ngIf"],["key","modal.button.edit"],["key","modal.button.delete"],["key","hierarchy.content.addChild"],["role","alert",1,"alert","alert-danger",2,"margin-top","5px"],[4,"ngIf"],[3,"options","nodes",4,"ngIf"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","classification.set.root"],[3,"options","nodes"],["tree",""]],template:function(n,t){1&n&&(e.TgZ(0,"context-menu",null,0),e.YNc(2,qI,1,0,"ng-template",1),e.NdJ("execute",function(a){return t.onEdit(a.item)}),e.YNc(3,JI,1,0,"ng-template",1),e.NdJ("execute",function(a){return t.onRemove(a.item)}),e.YNc(4,jI,1,0,"ng-template",1),e.NdJ("execute",function(a){return t.onCreate(a.item)}),e.qZA(),e.ynx(5),e.TgZ(6,"div",2)(7,"div",3)(8,"div",4),e.YNc(9,BI,2,1,"div",5),e.TgZ(10,"h2"),e._uU(11),e.qZA()()()(),e.YNc(12,YI,5,2,"div",6),e.BQk()),2&n&&(e.xp6(9),e.Q6J("ngIf",null!=t.message),e.xp6(2),e.hij(" ",t.classificationType.displayLabel.localizedValue," "),e.xp6(1),e.Q6J("ngIf",null!=t.classificationType&&null!=t.nodes))},dependencies:[T.O5,S.qr,P.GI,P.n5,Sn.l],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}hr.bottom[_ngcontent-%COMP%]{border-top:1px solid #776f6f}']});const QI=function(i){return{typeCode:i}};function KI(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",16)(1,"a",17),e._uU(2),e.qZA(),e.TgZ(3,"span",18)(4,"a",19),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onEdit(l))}),e.ALo(5,"localize"),e.qZA(),e.TgZ(6,"a",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.onDelete(l))}),e.ALo(7,"localize"),e.qZA()()()}if(2&i){const t=n.$implicit;e.Q6J("id",t.code),e.xp6(1),e.Q6J("routerLink","/registry/classification-type")("queryParams",e.VKq(10,QI,t.code)),e.xp6(1),e.hij(" ",t.displayLabel.localizedValue," "),e.xp6(2),e.Q6J("title",e.lcZ(5,6,"modal.button.edit")),e.xp6(2),e.Q6J("title",e.lcZ(7,8,"button.delete.helptext"))}}function $I(i,n){if(1&i&&e._UZ(0,"classification-type",21),2&i){const t=e.oxw();e.Q6J("classificationType",t.classificationType)}}class kf{constructor(n,t,o,a,l){this.route=n,this.router=t,this.service=o,this.lService=a,this.modalService=l,this.message=null,this.page={count:0,pageNumber:1,pageSize:10,resultSet:[]},this.querySubscription=null,this.subscription=null,this.classificationType=null}ngOnInit(){this.querySubscription=this.route.queryParams.subscribe(n=>{const t=n.typeCode;null!=t&&t.length>0?(null==this.classificationType||this.classificationType.code!==t)&&(this.classificationType=null,this.service.get(t).then(o=>{this.classificationType=o}).catch(o=>{this.error(o)})):this.classificationType=null}),this.refresh()}ngOnDestroy(){null!=this.querySubscription&&this.querySubscription.unsubscribe(),this.querySubscription=null,null!=this.subscription&&this.subscription.unsubscribe(),this.subscription=null}onCreate(){null!=this.subscription&&this.subscription.unsubscribe(),this.bsModalRef=this.modalService.show(qd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.subscription=this.bsModalRef.content.init(()=>this.refresh())}onEdit(n){null!=this.subscription&&this.subscription.unsubscribe(),this.bsModalRef=this.modalService.show(qd,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.subscription=this.bsModalRef.content.init(()=>this.refresh(),n)}onDelete(n){this.bsModalRef=this.modalService.show(Zt.z5,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message=this.lService.decode("confirm.modal.verify.delete")+" ["+n.displayLabel.localizedValue+"]",this.bsModalRef.content.submitText=this.lService.decode("modal.button.delete"),this.bsModalRef.content.type="danger",this.bsModalRef.content.onConfirm.subscribe(()=>{this.service.remove(n).then(()=>{const t=this.page.resultSet.findIndex(o=>o.oid===n.oid);-1!==t&&this.page.resultSet.splice(t,1),null!=this.classificationType&&n.code===this.classificationType.code&&this.router.navigate([],{relativeTo:this.route,queryParams:{typeCode:null}})}).catch(t=>{this.error(t)})})}refresh(){this.service.page({}).then(n=>{this.page=n}).catch(n=>{this.error(n)})}error(n){this.message=Zt.qL.getMessageFromError(n)}}kf.\u0275fac=function(n){return new(n||kf)(e.Y36(w.gz),e.Y36(w.F0),e.Y36(cu),e.Y36(mo.o),e.Y36(Ln.tT))},kf.\u0275cmp=e.Xpm({type:kf,selectors:[["classification-type-manager"]],decls:17,vars:3,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container-fluid"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"row"],[1,"col-md-3","list-sidebar"],[1,"sidebar-section-content",2,"padding-top","20px"],[1,"list-group"],["class","list-group-item got-li-item",3,"id",4,"ngFor","ngForOf"],[1,"list-group-item","got-li-item"],[1,"bottom"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","hierarchy.management.button.create"],[1,"col-md-9","hierarchy-content"],["id","overflow-div"],[3,"classificationType",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"list-group-item","got-li-item",3,"id"],["routerLinkActive","active",3,"routerLink","queryParams"],[2,"position","absolute","right","10px","top","50%","transform","translateY(-50%)"],[1,"fa","fa-pencil","ico-edit",3,"title","click"],[1,"fa","fa-trash-o","ico-remove",3,"title","click"],[3,"classificationType"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"cgr-header")(2,"loading-bar"),e.TgZ(3,"div",1),e.YNc(4,HI,2,1,"div",2),e.TgZ(5,"div",3)(6,"nav",4)(7,"div",5)(8,"ul",6),e.YNc(9,KI,8,12,"li",7),e.TgZ(10,"li",8),e._UZ(11,"hr",9),e.TgZ(12,"button",10),e.NdJ("click",function(){return t.onCreate()}),e._UZ(13,"localize",11),e.qZA()()()()(),e.TgZ(14,"div",12)(15,"div",13),e.YNc(16,$I,1,1,"classification-type",14),e.qZA()()()()()),2&n&&(e.xp6(4),e.Q6J("ngIf",null!=t.message),e.xp6(5),e.Q6J("ngForOf",t.page.resultSet),e.xp6(7),e.Q6J("ngIf",null!=t.classificationType))},dependencies:[T.sg,T.O5,w.rH,w.Od,Sn.l,Da.N,ba.C,Af,ia.F],styles:['.list-sidebar[_ngcontent-%COMP%]{z-index:999;background:#f1f1f1;transition:all .3s;vertical-align:top;height:calc(100vh - 50px);overflow-x:hidden;overflow-y:auto}.list-group-item[_ngcontent-%COMP%], li.list-group-item[_ngcontent-%COMP%]{background-color:transparent;padding:3px 10px}.cr-sort-arrow[_ngcontent-%COMP%]{font-size:14px}.cr-filter-link-active[_ngcontent-%COMP%], .cr-filter-link-active[_ngcontent-%COMP%]:active{border-radius:10px;background:#6BA542;color:#fff;font-weight:700;padding:3px 15px}.cr-filter-link-active[_ngcontent-%COMP%]:hover, .cr-filter-link-active[_ngcontent-%COMP%]:focus{color:#fff}.panel-body[_ngcontent-%COMP%]{color:#333;background-color:#f5f5f5;border-color:#ddd}.unstyled-list[_ngcontent-%COMP%]{list-style:none;padding:0;color:#707070}.fa[_ngcontent-%COMP%]{top:5px}.fa-stack[_ngcontent-%COMP%]{width:1.5em}.fa-stack[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{text-align:left}.second-stacked-el[_ngcontent-%COMP%]:before{background:#f5f5f5}.full-width-radio-button[_ngcontent-%COMP%]{position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%], .changeSpan[_ngcontent-%COMP%]{position:absolute}label.settings[_ngcontent-%COMP%] > span[_ngcontent-%COMP%] > i.fa.fa-cog[_ngcontent-%COMP%]{font-size:15px}.full-width-radio-button[_ngcontent-%COMP%]   .errorSpan[_ngcontent-%COMP%]{display:inline-block;position:relative}.full-width-radio-button[_ngcontent-%COMP%]   .changeSpan[_ngcontent-%COMP%]{right:2.5px}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasErrors[_ngcontent-%COMP%]:before{content:" \\25cf";font-size:20px;line-height:12px;text-align:left;color:red}.full-width-radio-button[_ngcontent-%COMP%]   .tabHasChanges[_ngcontent-%COMP%]:after{content:" \\25cf";font-size:20px;line-height:12px;text-align:right;color:orange}hr.bottom[_ngcontent-%COMP%]{border-top:1px solid #776f6f}']});const WI=[{path:"",component:Sd,canActivate:[Ar.a1]},{path:"hierarchies",component:Sd,canActivate:[Ar.a1]},{path:"data",component:ef,canActivate:[Ar.AX]},{path:"change-requests",component:Nd,canActivate:[Ar.cu]},{path:"change-requests/:oid",component:Nd,canActivate:[Ar.cu]},{path:"master-lists",component:Of,canActivate:[Ar.a1]},{path:"master-list/:oid",component:Sf,canActivate:[Ar.a1]},{path:"scheduled-jobs",component:nf,canActivate:[Ar.AX]},{path:"job/:oid",component:uf,canActivate:[Ar.AX]},{path:"change-request",component:Pd,canActivate:[Ar.cu]},{path:"tasks",component:pf,canActivate:[Ar.AX]},{path:"synchronization-configs",component:gf,canActivate:[Ar.a1]},{path:"synchronization-config/:oid",component:_f,canActivate:[Ar.a1]},{path:"location-manager",component:vd,canActivate:[Ar.a1]},{path:"sync/details/:config/:oid",component:mf,canActivate:[Ar.AX]},{path:"curation-job/:oid",component:Pf,canActivate:[Ar.AX]},{path:"historical-events",component:wf,canActivate:[Ar.cu]},{path:"business-types",component:vf,canActivate:[Ar.a1]},{path:"business-importer",component:bf,canActivate:[Ar.a1]},{path:"business-type/:oid",component:Ef,canActivate:[Ar.a1]},{path:"classification-type",component:kf,canActivate:[Ar.a1]}];class jd{}jd.\u0275fac=function(n){return new(n||jd)},jd.\u0275mod=e.oAB({type:jd}),jd.\u0275inj=e.cJS({providers:[{provide:T.S$,useClass:T.Do}],imports:[w.Bz.forChild(WI),w.Bz]});var XI=v(92977);function eZ(i,n){if(1&i&&(e.TgZ(0,"li",8)(1,"div",9)(2,"div",10)(3,"h4",11)(4,"span"),e._uU(5),e.qZA()()(),e.TgZ(6,"div",12),e.ynx(7,13)(8,14),e._UZ(9,"date-text",15),e.BQk(),e.ynx(10,16),e._uU(11),e.BQk()(),e.qZA()()()),2&i){const t=e.oxw().$implicit,o=e.oxw();e.xp6(5),e.hij(" ",t.label.localizedValue," "),e.xp6(4),e.Q6J("date",o.object.data[t.code]),e.xp6(2),e.hij(" ",o.object.data[t.code]," ")}}function tZ(i,n){if(1&i&&(e.ynx(0),e.YNc(1,eZ,12,3,"li",7),e.BQk()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=o.object.data[t.code])}}class If{constructor(){this.close=new e.vpe}onClose(){this.close.emit()}}function nZ(i,n){if(1&i&&(e.TgZ(0,"p",7),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("",t.percent(),"%")}}function iZ(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",19)(1,"boolean-field",20),e.NdJ("valueChange",function(a){e.CHM(t);const l=e.oxw(3);return e.KtG(l.showInvalid=a)})("change",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handleShowInvalidChange())}),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("value",t.showInvalid)("localizeLabelKey","masterlist.showInvalid")}}If.\u0275fac=function(n){return new(n||If)},If.\u0275cmp=e.Xpm({type:If,selectors:[["business-object-panel"]],inputs:{type:"type",object:"object"},outputs:{close:"close"},decls:13,vars:2,consts:[[1,"row"],[1,"col-md-12"],["name","geobject-shared-attribute-editor",1,"modal-form"],["attributeForm","ngForm"],[1,"text"],[1,"list-group"],[4,"ngFor","ngForOf"],["class","list-group-item","style","text-align:left;border:none;padding:0;",4,"ngIf"],[1,"list-group-item",2,"text-align","left","border","none","padding","0"],[1,"panel","panel-default"],[1,"panel-heading"],[2,"margin","0"],[1,"panel-body"],["ng-switch","attributeType.type"],["ng-switch-when","'date'"],[3,"date"],["ng-switch-default",""]],template:function(n,t){1&n&&(e.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"h3"),e._uU(4),e.qZA()()(),e.TgZ(5,"form",2,3)(7,"fieldset")(8,"div",0)(9,"div",1),e._UZ(10,"span",4),e.TgZ(11,"ul",5),e.YNc(12,tZ,2,1,"ng-container",6),e.qZA()()()()()()),2&n&&(e.xp6(4),e.Oqu(t.type.displayLabel.localizedValue),e.xp6(8),e.Q6J("ngForOf",t.type.attributes))},dependencies:[T.sg,T.O5,y._Y,y.JL,y.F,Fr.u],styles:["#hierarchy-tree-container[_ngcontent-%COMP%]{height:calc(100vh - 429px);overflow-y:auto}.location-management-widget-section[_ngcontent-%COMP%]{margin:5px 0}.location-management-widget-section[_ngcontent-%COMP%] > select[_ngcontent-%COMP%]{float:none!important}.list-group-item[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #ddd;margin-bottom:0}.list-group-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.breadcrumb[_ngcontent-%COMP%]{padding:10px 0;background-color:#fff;margin:0}.layer-toggle[_ngcontent-%COMP%]{cursor:pointer;background:#fff;padding:8px;border-radius:4px;width:-moz-fit-content;width:fit-content}.layer-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:auto}.layer-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:5px}#attributes-header[_ngcontent-%COMP%]{background:#adadad;padding:2px 15px;margin:10px 0;color:#fff;border-radius:3px}"]});const oZ=function(){return{"fa fa-refresh clickable":!0}};function rZ(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"span",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onPublish())}),e._UZ(1,"i",21)(2,"localize",22),e.qZA()}2&i&&(e.xp6(1),e.Q6J("ngClass",e.DdM(1,oZ)))}function aZ(i,n){1&i&&e._UZ(0,"localize",26)}function sZ(i,n){1&i&&e._UZ(0,"localize",27)}function lZ(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onExport())}),e.YNc(1,aZ,1,0,"localize",24),e.YNc(2,sZ,1,0,"localize",25),e.qZA()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!t.isFiltered),e.xp6(1),e.Q6J("ngIf",t.isFiltered)}}function cZ(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9),e.YNc(2,iZ,2,2,"span",14),e.YNc(3,rZ,3,2,"span",15),e.YNc(4,lZ,3,2,"button",16),e.TgZ(5,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onClose())}),e._UZ(6,"localize",18),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.isWritable&&t.list.working),e.xp6(1),e.Q6J("ngIf",t.isWritable&&t.list.working),e.xp6(1),e.Q6J("ngIf","PUBLIC"===t.list.listMetadata.visibility||"PUBLIC"===t.list.geospatialMetadata.visibility||t.isListInOrg()||t.isSRA)}}const uZ=function(i,n){return{"fa-arrow-up":i,"fa-arrow-down":n}};function pZ(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",8)(2,"div",9)(3,"span",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onToggleSize())}),e._UZ(4,"i",11),e.qZA()(),e.TgZ(5,"h2"),e._uU(6),e._UZ(7,"date-text",12),e._uU(8,") "),e.qZA()(),e.YNc(9,cZ,7,3,"div",13),e.qZA()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("ngClass",e.WLB(4,uZ,50===t.size,100===t.size)),e.xp6(2),e.hij(" ",t.list.displayLabel," ("),e.xp6(1),e.Q6J("date",t.list.forDate),e.xp6(2),e.Q6J("ngIf",t.list)}}const dZ=function(i,n){return{oid:i,showInvalid:n}};function hZ(i,n){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"generic-table",29),e.NdJ("click",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onClick(a))})("onLoadEvent",function(a){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onLoadEvent(a))}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("setup",t.setup)("config",t.config)("refresh",t.refresh)("pageConfig",e.WLB(5,dZ,t.list.oid,t.showInvalid))("initialState",t.tableState)}}function fZ(i,n){if(1&i&&(e.TgZ(0,"div",2),e.YNc(1,hZ,2,8,"ng-container",28),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.setup&&null!=t.config)}}class Zf{constructor(n,t,o,a,l){this.modalService=n,this.service=t,this.spinner=o,this.authService=a,this.cdr=l,this.CONSTANTS={LIST_MODAL:"list-modal"},this.error=new e.vpe,this.onRowSelect=new e.vpe,this.close=new e.vpe,this.list=null,this.current="",this.isWritable=!1,this.isRM=!1,this.isSRA=!1,this.config=null,this.setup=null,this.showInvalid=!1,this.tableState=null,this.isFiltered=!1,this.progressSubscription=null,this.isRefreshing=!1,this.progress=null,this.size=50,this.userOrgCodes=this.authService.getMyOrganizations()}ngOnInit(){if(this.refresh=new pn.x,this.tableState=null,null!=localStorage.getItem(this.oid)){const t=JSON.parse(localStorage.getItem(this.oid));this.tableState=t.event,this.isFiltered=null!=this.tableState&&null!=this.tableState.filters&&Object.keys(this.tableState.filters).length>0}this.service.getVersion(this.oid).then(t=>{this.list=t,this.orgCode=this.list.orgCode;const o=null!=this.list.superTypeCode?this.list.superTypeCode:this.list.typeCode;this.isWritable=this.authService.isGeoObjectTypeRC(this.orgCode,o),this.isRM=this.authService.isGeoObjectTypeRM(this.orgCode,o),this.isSRA=this.authService.isSRA(),this.refreshColumns(),this.config={service:this.service,remove:!1,view:!0,create:!1,label:this.list.displayLabel,sort:[{field:"code",order:1}],baseZIndex:1051,pageSize:20}});let n=md.buildBaseUrl();this.progressNotifier=Ip(n+"/websocket/progress/"+this.oid),this.progressSubscription=this.progressNotifier.subscribe(t=>{this.handleProgressChange(null!=t.content?t.content:null)})}ngOnDestroy(){null!=this.refresh&&this.refresh.unsubscribe(),null!=this.progressSubscription&&this.progressSubscription.unsubscribe(),null!=this.progressNotifier&&this.progressNotifier.complete()}ngOnChanges(n){null!=n.oid&&null!=this.refresh&&(this.list=null,this.ngOnDestroy(),this.ngOnInit())}refreshColumns(){this.setup=ol.createColumns(this.list,this.showInvalid,!1,(n,t)=>{this.service.values(this.list.oid,t.text,n.name,this.tableState.filters).then(o=>{t.results=o}).catch(o=>{this.error.emit(o)})})}handleShowInvalidChange(){this.refreshColumns(),this.refresh.next()}onLoadEvent(n){this.tableState=n,this.isFiltered=null!=this.tableState&&null!=this.tableState.filters&&Object.keys(this.tableState.filters).length>0;const t={event:n,oid:this.list.oid};localStorage.setItem(t.oid,JSON.stringify(t))}isListInOrg(){return!!(this.userOrgCodes&&this.userOrgCodes.length>0&&-1!==this.userOrgCodes.indexOf(this.orgCode))}handleProgressChange(n){null!=n?(this.isRefreshing=n.current<n.total,this.progress=n,this.isRefreshing?this.spinner.show(this.CONSTANTS.LIST_MODAL):this.spinner.hide(this.CONSTANTS.LIST_MODAL)):(this.isRefreshing=!1,this.progress=null),!this.isRefreshing&&null!=this.refresh&&this.refresh.next()}onClick(n){"view"===n.type&&this.onRowSelect.next({version:this.list,uid:n.row.uid})}onPublish(){this.isRefreshing||this.service.publishList(this.list.oid).toPromise().then(n=>{this.isRefreshing=!0}).catch(n=>{this.error.emit(n)})}onExport(){const n={filters:null!=this.tableState.filters?{...this.tableState.filters}:{}};this.showInvalid||(n.filters.invalid={value:!1,matchMode:"equals"});const t=this.modalService.show(Ud,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.init(this.list),t.content.onFormat.subscribe(o=>{if("SHAPEFILE"===o.format){let a=pt.N.apiUrl+"/api/list-type/export-shapefile?oid="+this.list.oid;a+="&criteria="+encodeURIComponent(JSON.stringify(n)),null!=o.actualGeometryType&&o.actualGeometryType.length>0&&(a+="&actualGeometryType="+encodeURIComponent(o.actualGeometryType)),window.open(a,"_blank")}else"EXCEL"===o.format&&window.open(pt.N.apiUrl+"/api/list-type/export-spreadsheet?oid="+this.list.oid+"&criteria="+encodeURIComponent(JSON.stringify(n)),"_blank")})}onToggleSize(){this.size=50===this.size?100:50,this.cdr.detectChanges()}percent(){return null!=this.progress?Math.floor(this.progress.current/this.progress.total*100):0}onClose(){this.close.emit()}}function gZ(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",6)(2,"h2"),e._uU(3),e.qZA()(),e.TgZ(4,"div",7)(5,"div",8)(6,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onClose())}),e._UZ(7,"localize",10),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(3),e.hij(" ",t.list.displayLabel," ")}}Zf.\u0275fac=function(n){return new(n||Zf)(e.Y36(Ln.tT),e.Y36(Uo),e.Y36(Nn),e.Y36(nn.e8),e.Y36(e.sBO))},Zf.\u0275cmp=e.Xpm({type:Zf,selectors:[["list-panel"]],inputs:{oid:"oid"},outputs:{error:"error",onRowSelect:"onRowSelect",close:"close"},features:[e.TTD],decls:8,vars:7,consts:[[2,"background-color","white","background-color","white","overflow","hidden auto","height","calc(-50px + 100vh)","padding-left","20px"],[1,"row"],[1,"col-md-12"],["type","ball-clip-rotate-multiple","size","medium",3,"fullScreen","name"],["style","font-size: 20px; color: white",4,"ngIf"],["class","row",4,"ngIf"],["class","col-md-12",4,"ngIf"],[2,"font-size","20px","color","white"],[1,"col-md-6"],[1,"button-holder","pull-right",2,"margin-top","10px","margin-right","5px"],[1,"clickable",2,"padding","10px",3,"click"],["aria-hidden","true",1,"fa",2,"font-size","24px","vertical-align","middle","padding-right","5px",3,"ngClass"],[3,"date"],["class","col-md-6",4,"ngIf"],["class","clickable","style","vertical-align:middle;display:inline-block;line-height:0;",4,"ngIf"],["class","clickable","style","padding: 10px;",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary","role","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.close"],[1,"clickable",2,"vertical-align","middle","display","inline-block","line-height","0"],[3,"value","localizeLabelKey","valueChange","change"],["aria-hidden","true",2,"font-size","24px","vertical-align","middle","padding-right","5px",3,"ngClass"],["key","masterlist.publish"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],["key","io.export.allrows",4,"ngIf"],["key","io.export.filteredrows",4,"ngIf"],["key","io.export.allrows"],["key","io.export.filteredrows"],[4,"ngIf"],[3,"setup","config","refresh","pageConfig","initialState","click","onLoadEvent"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ngx-spinner",3),e.YNc(4,nZ,2,1,"p",4),e.qZA(),e.YNc(5,pZ,10,7,"div",5),e.TgZ(6,"div",1),e.YNc(7,fZ,2,1,"div",6),e.qZA()()()()),2&n&&(e.Udp("height","calc("+t.size+"vh - 50px)"),e.xp6(3),e.Q6J("fullScreen",!1)("name",t.CONSTANTS.LIST_MODAL),e.xp6(1),e.Q6J("ngIf",null!=t.progress),e.xp6(1),e.Q6J("ngIf",t.list),e.xp6(2),e.Q6J("ngIf",t.list))},dependencies:[T.mk,T.O5,Sn.l,rl.M,np,Fr.u,Wi],encapsulation:2});const _Z=function(i){return{oid:i,showInvalid:!1}};function mZ(i,n){if(1&i&&(e.ynx(0),e._UZ(1,"generic-table",12),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("setup",t.setup)("config",t.config)("pageConfig",e.VKq(5,_Z,t.list.oid))("initialState",t.tableState)("paginator",!1)}}function yZ(i,n){if(1&i&&(e.TgZ(0,"div",2),e.YNc(1,mZ,2,7,"ng-container",11),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=t.setup&&null!=t.config)}}class Nf{constructor(n){this.service=n,this.error=new e.vpe,this.close=new e.vpe,this.list=null,this.tableState=null,this.config=null,this.setup=null}ngOnInit(){this.refreshVersion()}ngOnDestroy(){}ngOnChanges(n){null!=n.oid?this.refreshVersion():null!=n.uid&&(this.tableState=null,kh(()=>{this.tableState={filters:{uid:{matchMode:"equals",value:this.uid}}}}))}refreshVersion(){this.list=null,this.tableState={filters:{uid:{matchMode:"equals",value:this.uid}}},this.service.getVersion(this.oid).then(n=>{this.list=n,this.refreshColumns(),this.config={service:this.service,remove:!1,view:!0,create:!1,label:this.list.displayLabel,sort:[{field:"code",order:1}],baseZIndex:1051,pageSize:10}})}refreshColumns(){this.setup=ol.createColumns(this.list,!1,!0)}onClose(){this.close.emit()}}Nf.\u0275fac=function(n){return new(n||Nf)(e.Y36(Uo))},Nf.\u0275cmp=e.Xpm({type:Nf,selectors:[["list-row"]],inputs:{oid:"oid",uid:"uid"},outputs:{error:"error",close:"close"},features:[e.TTD],decls:6,vars:2,consts:[[2,"background-color","white","height","160px"],[1,"row"],[1,"col-md-12"],["class","row",4,"ngIf"],[1,"row",2,"padding-bottom","10px"],["class","col-md-12",4,"ngIf"],[1,"col-md-4"],[1,"col-md-8"],[1,"text-right",2,"margin-top","10px","margin-right","5px"],["type","button",1,"btn","btn-default",3,"click"],["key","modal.button.close"],[4,"ngIf"],[3,"setup","config","pageConfig","initialState","paginator"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,gZ,8,1,"div",3),e.TgZ(4,"div",4),e.YNc(5,yZ,2,1,"div",5),e.qZA()()()()),2&n&&(e.xp6(3),e.Q6J("ngIf",t.list),e.xp6(2),e.Q6J("ngIf",null!=t.list&&null!=t.tableState))},dependencies:[T.O5,Sn.l,np],encapsulation:2});class Bd{}Bd.\u0275fac=function(n){return new(n||Bd)},Bd.\u0275mod=e.oAB({type:Bd}),Bd.\u0275inj=e.cJS({providers:[ys,Wl,Xa,Zp,Wu,$l,pr,Zi,Ml,Ku,T.uU,Bh,Rp,Ls,su,tc,Fp,Uo,cu,Mc,vo,$u],imports:[T.ez,w.Bz,y.u5,y.UX,I.Ob,S.xc,P.vI,E.mr,Z.Fq,A.H3,Q.HC,le.P4,W.f,U.JX,XI.m,jd,$t,Og,jr,rM.forRoot(),yn]}),e.B6R(vd,function(){return[T.mk,T.sg,T.O5,T.PC,y.Fj,y.JJ,y.On,A.Bp,Sn.l,Da.N,ba.C,Xl.Q,Wi,zh,jh,bd,If,Zf,Nf]},function(){return[ia.F]}),e.B6R(bd,function(){return[T.O5,y.Fj,y.JJ,y.Q7,y.On,Sn.l,Wi,Dp]},[])},75834:(q,H,v)=>{"use strict";var M=v(95203),D=v(55685),d=D(M("String.prototype.indexOf"));q.exports=function(w,y){var S=M(w,!!y);return"function"==typeof S&&d(w,".prototype.")>-1?D(S):S}},55685:(q,H,v)=>{"use strict";var M=v(86740),D=v(95203),d=D("%Function.prototype.apply%"),T=D("%Function.prototype.call%"),w=D("%Reflect.apply%",!0)||M.call(T,d),y=D("%Object.getOwnPropertyDescriptor%",!0),S=D("%Object.defineProperty%",!0),P=D("%Math.max%");if(S)try{S({},"a",{value:1})}catch{S=null}q.exports=function(A){var I=w(M,T,arguments);if(y&&S){var U=y(I,"length");U.configurable&&S(I,"length",{value:1+P(0,A.length-(arguments.length-1))})}return I};var E=function(){return w(M,d,arguments)};S?S(q.exports,"apply",{value:E}):q.exports.apply=E},51557:(q,H,v)=>{var M=v(27792),D=Math.random();q.exports=function(T,w){return D+=.618033988749895,"number"!=typeof T&&(T=.5),"number"!=typeof w&&(w=.95),M({h:360*(D%=1),s:100*T,v:100*w})}},77957:(q,H,v)=>{var M=v(84769);function D(e){if(e){var Ie=[0,0,0],je=1,X=e.match(/^#([a-fA-F0-9]{3})$/);if(X){X=X[1];for(var ie=0;ie<Ie.length;ie++)Ie[ie]=parseInt(X[ie]+X[ie],16)}else if(X=e.match(/^#([a-fA-F0-9]{6})$/))for(X=X[1],ie=0;ie<Ie.length;ie++)Ie[ie]=parseInt(X.slice(2*ie,2*ie+2),16);else if(X=e.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([\d\.]+)\s*)?\)$/)){for(ie=0;ie<Ie.length;ie++)Ie[ie]=parseInt(X[ie+1]);je=parseFloat(X[4])}else if(X=e.match(/^rgba?\(\s*([\d\.]+)\%\s*,\s*([\d\.]+)\%\s*,\s*([\d\.]+)\%\s*(?:,\s*([\d\.]+)\s*)?\)$/)){for(ie=0;ie<Ie.length;ie++)Ie[ie]=Math.round(2.55*parseFloat(X[ie+1]));je=parseFloat(X[4])}else if(X=e.match(/(\D+)/)){if("transparent"==X[1])return[0,0,0,0];if(!(Ie=M.keyword2rgb(X[1])))return}for(ie=0;ie<Ie.length;ie++)Ie[ie]=W(Ie[ie],0,255);return je=je||0==je?W(je,0,1):1,Ie.push(je),Ie}}function d(e){if(e){var he=e.match(/^hsla?\(\s*(\d+)\s*,\s*([\d\.]+)%\s*,\s*([\d\.]+)%\s*(?:,\s*([\d\.]+)\s*)?\)/);if(he)return[W(parseInt(he[1]),0,360),W(parseFloat(he[2]),0,100),W(parseFloat(he[3]),0,100),W(parseFloat(he[4])||1,0,1)]}}function E(e,de){return void 0===de&&(de=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+de+")"}function A(e,de){return"rgba("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%, "+(de||e[3]||1)+")"}function U(e,de){return void 0===de&&(de=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+de+")"}function W(e,de,he){return Math.min(Math.max(de,e),he)}function le(e){var de=e.toString(16).toUpperCase();return de.length<2?"0"+de:de}q.exports={getRgba:D,getHsla:d,getRgb:function T(e){return D(e).slice(0,3)},getHsl:function w(e){return d(e).slice(0,3)},getAlpha:function y(e){var de=D(e);return de||(de=d(e))?de[3]:void 0},hexString:function S(e){return"#"+le(e[0])+le(e[1])+le(e[2])},rgbString:function P(e,de){return de<1||e[3]&&e[3]<1?E(e,de):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},rgbaString:E,percentString:function Z(e,de){return de<1||e[3]&&e[3]<1?A(e,de):"rgb("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%)"},percentaString:A,hslString:function I(e,de){return de<1||e[3]&&e[3]<1?U(e,de):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"},hslaString:U,keyword:function Q(e){return M.rgb2keyword(e.slice(0,3))}}},41909:q=>{function H(X){var we,Ye,ie=X[0]/255,oe=X[1]/255,ae=X[2]/255,pe=Math.min(ie,oe,ae),xe=Math.max(ie,oe,ae),Ne=xe-pe;return xe==pe?we=0:ie==xe?we=(oe-ae)/Ne:oe==xe?we=2+(ae-ie)/Ne:ae==xe&&(we=4+(ie-oe)/Ne),(we=Math.min(60*we,360))<0&&(we+=360),Ye=(pe+xe)/2,[we,100*(xe==pe?0:Ye<=.5?Ne/(xe+pe):Ne/(2-xe-pe)),100*Ye]}function v(X){var we,me,ie=X[0],oe=X[1],ae=X[2],pe=Math.min(ie,oe,ae),xe=Math.max(ie,oe,ae),Ne=xe-pe;return me=0==xe?0:Ne/xe*1e3/10,xe==pe?we=0:ie==xe?we=(oe-ae)/Ne:oe==xe?we=2+(ae-ie)/Ne:ae==xe&&(we=4+(ie-oe)/Ne),(we=Math.min(60*we,360))<0&&(we+=360),[we,me,xe/255*1e3/10]}function M(X){var we,ie=X[0]/255,oe=X[1]/255,ae=X[2]/255;return[(1-ie-(we=Math.min(1-ie,1-oe,1-ae)))/(1-we)*100,(1-oe-we)/(1-we)*100,(1-ae-we)/(1-we)*100,100*we]}function D(X){return Ie[JSON.stringify(X)]}function d(X){var ie=X[0]/255,oe=X[1]/255,ae=X[2]/255;return[100*(.4124*(ie=ie>.04045?Math.pow((ie+.055)/1.055,2.4):ie/12.92)+.3576*(oe=oe>.04045?Math.pow((oe+.055)/1.055,2.4):oe/12.92)+.1805*(ae=ae>.04045?Math.pow((ae+.055)/1.055,2.4):ae/12.92)),100*(.2126*ie+.7152*oe+.0722*ae),100*(.0193*ie+.1192*oe+.9505*ae)]}function w(X){var pe,xe,Ne,we,me,ie=X[0]/360,oe=X[1]/100,ae=X[2]/100;if(0==oe)return[me=255*ae,me,me];pe=2*ae-(xe=ae<.5?ae*(1+oe):ae+oe-ae*oe),we=[0,0,0];for(var Ye=0;Ye<3;Ye++)(Ne=ie+1/3*-(Ye-1))<0&&Ne++,Ne>1&&Ne--,we[Ye]=255*(me=6*Ne<1?pe+6*(xe-pe)*Ne:2*Ne<1?xe:3*Ne<2?pe+(xe-pe)*(2/3-Ne)*6:pe);return we}function E(X){var ie=X[0]/60,oe=X[1]/100,me=X[2]/100,ae=Math.floor(ie)%6,pe=ie-Math.floor(ie),xe=255*me*(1-oe),Ne=255*me*(1-oe*pe),we=255*me*(1-oe*(1-pe));switch(me*=255,ae){case 0:return[me,we,xe];case 1:return[Ne,me,xe];case 2:return[xe,me,we];case 3:return[xe,Ne,me];case 4:return[we,xe,me];case 5:return[me,xe,Ne]}}function U(X){var oe=X[1]/100,ae=X[2]/100,pe=X[3]/100;return[255*(1-Math.min(1,X[0]/100*(1-pe)+pe)),255*(1-Math.min(1,oe*(1-pe)+pe)),255*(1-Math.min(1,ae*(1-pe)+pe))]}function de(X){return Ue[X]}q.exports={rgb2hsl:H,rgb2hsv:v,rgb2cmyk:M,rgb2keyword:D,rgb2xyz:d,rgb2lab:function T(X){var ie=d(X),oe=ie[0],ae=ie[1],pe=ie[2];return ae/=100,pe/=108.883,oe=(oe/=95.047)>.008856?Math.pow(oe,1/3):7.787*oe+16/116,[116*(ae=ae>.008856?Math.pow(ae,1/3):7.787*ae+16/116)-16,500*(oe-ae),200*(ae-(pe=pe>.008856?Math.pow(pe,1/3):7.787*pe+16/116))]},hsl2rgb:w,hsl2hsv:function y(X){var oe=X[1]/100,ae=X[2]/100;return oe*=(ae*=2)<=1?ae:2-ae,[X[0],100*oe,(ae+oe)/2*100]},hsl2cmyk:function S(X){return M(w(X))},hsl2keyword:function P(X){return D(w(X))},hsv2rgb:E,hsv2hsl:function Z(X){var pe,xe,oe=X[1]/100,ae=X[2]/100;return pe=oe*ae,[X[0],100*(pe/=(xe=(2-oe)*ae)<=1?xe:2-xe),100*(xe/=2)]},hsv2cmyk:function A(X){return M(E(X))},hsv2keyword:function I(X){return D(E(X))},cmyk2rgb:U,cmyk2hsl:function Q(X){return H(U(X))},cmyk2hsv:function W(X){return v(U(X))},cmyk2keyword:function le(X){return D(U(X))},keyword2rgb:de,keyword2hsl:function he(X){return H(de(X))},keyword2hsv:function ke(X){return v(de(X))},keyword2cmyk:function Le(X){return M(de(X))},xyz2rgb:function e(X){var pe,xe,Ne,ie=X[0]/100,oe=X[1]/100,ae=X[2]/100;return xe=-.9689*ie+1.8758*oe+.0415*ae,Ne=.0557*ie+-.204*oe+1.057*ae,[255*(pe=(pe=(pe=3.2406*ie+-1.5372*oe+-.4986*ae)>.0031308?1.055*Math.pow(pe,1/2.4)-.055:pe*=12.92)<0?0:pe),255*(xe=(xe=xe>.0031308?1.055*Math.pow(xe,1/2.4)-.055:xe*=12.92)<0?0:xe),255*(Ne=(Ne=Ne>.0031308?1.055*Math.pow(Ne,1/2.4)-.055:Ne*=12.92)<0?0:Ne)]}};var Ue={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ie={};for(var je in Ue)Ie[JSON.stringify(Ue[je])]=je},84769:(q,H,v)=>{var M=v(41909),D={};for(var d in q.exports=D,M){D[d+"Raw"]=function(S){return function(P){return"number"==typeof P&&(P=Array.prototype.slice.call(arguments)),M[S](P)}}(d);var T=/(\w+)2(\w+)/.exec(d),w=T[1],y=T[2];D[w]=D[w]||{},D[w][y]=D[d]=function(S){return function(P){"number"==typeof P&&(P=Array.prototype.slice.call(arguments));var E=M[S](P);if("string"==typeof E||void 0===E)return E;for(var Z=0;Z<E.length;Z++)E[Z]=Math.round(E[Z]);return E}}(d)}},27792:(q,H,v)=>{var M=v(30798),D=v(77957);q.exports=function(T){return new d(T)};var d=function(T){if(this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],cmyk:[0,0,0,0],alpha:1},"string"==typeof T)(w=D.getRgba(T))?this.setValues("rgb",w):(w=D.getHsla(T))&&this.setValues("hsl",w);else if("object"==typeof T){var w;void 0!==(w=T).r||void 0!==w.red?this.setValues("rgb",w):void 0!==w.l||void 0!==w.lightness?this.setValues("hsl",w):void 0!==w.v||void 0!==w.value?this.setValues("hsv",w):(void 0!==w.c||void 0!==w.cyan)&&this.setValues("cmyk",w)}};d.prototype={rgb:function(T){return this.setSpace("rgb",arguments)},hsl:function(T){return this.setSpace("hsl",arguments)},hsv:function(T){return this.setSpace("hsv",arguments)},cmyk:function(T){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){return this.values.rgb.concat([this.values.alpha])},hslaArray:function(){return this.values.hsl.concat([this.values.alpha])},alpha:function(T){return void 0===T?this.values.alpha:(this.setValues("alpha",T),this)},red:function(T){return this.setChannel("rgb",0,T)},green:function(T){return this.setChannel("rgb",1,T)},blue:function(T){return this.setChannel("rgb",2,T)},hue:function(T){return this.setChannel("hsl",0,T)},saturation:function(T){return this.setChannel("hsl",1,T)},lightness:function(T){return this.setChannel("hsl",2,T)},saturationv:function(T){return this.setChannel("hsv",1,T)},value:function(T){return this.setChannel("hsv",2,T)},cyan:function(T){return this.setChannel("cmyk",0,T)},magenta:function(T){return this.setChannel("cmyk",1,T)},yellow:function(T){return this.setChannel("cmyk",2,T)},black:function(T){return this.setChannel("cmyk",3,T)},hexString:function(){return D.hexString(this.values.rgb)},rgbString:function(){return D.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return D.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return D.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return D.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return D.hslaString(this.values.hsl,this.values.alpha)},keyword:function(){return D.keyword(this.values.rgb,this.values.alpha)},luminosity:function(){for(var T=this.values.rgb,w=[],y=0;y<T.length;y++){var S=T[y]/255;w[y]=S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4)}return.2126*w[0]+.7152*w[1]+.0722*w[2]},contrast:function(T){var w=this.luminosity(),y=T.luminosity();return w>y?(w+.05)/(y+.05):(y+.05)/(w+.05)},level:function(T){var w=this.contrast(T);return w>=7.1?"AAA":w>=4.5?"AA":""},dark:function(){var T=this.values.rgb;return(299*T[0]+587*T[1]+114*T[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var T=[],w=0;w<3;w++)T[w]=255-this.values.rgb[w];return this.setValues("rgb",T),this},lighten:function(T){return this.values.hsl[2]+=this.values.hsl[2]*T,this.setValues("hsl",this.values.hsl),this},darken:function(T){return this.values.hsl[2]-=this.values.hsl[2]*T,this.setValues("hsl",this.values.hsl),this},saturate:function(T){return this.values.hsl[1]+=this.values.hsl[1]*T,this.setValues("hsl",this.values.hsl),this},desaturate:function(T){return this.values.hsl[1]-=this.values.hsl[1]*T,this.setValues("hsl",this.values.hsl),this},greyscale:function(){var T=this.values.rgb,w=.3*T[0]+.59*T[1]+.11*T[2];return this.setValues("rgb",[w,w,w]),this},clearer:function(T){return this.setValues("alpha",this.values.alpha-this.values.alpha*T),this},opaquer:function(T){return this.setValues("alpha",this.values.alpha+this.values.alpha*T),this},rotate:function(T){var w=this.values.hsl[0];return this.values.hsl[0]=w=(w=(w+T)%360)<0?360+w:w,this.setValues("hsl",this.values.hsl),this},mix:function(T,w){for(var y=2*(w=1-(w??.5))-1,S=this.alpha()-T.alpha(),P=((y*S==-1?y:(y+S)/(1+y*S))+1)/2,E=1-P,Z=this.rgbArray(),A=T.rgbArray(),I=0;I<Z.length;I++)Z[I]=Z[I]*P+A[I]*E;this.setValues("rgb",Z);var U=this.alpha()*w+T.alpha()*(1-w);return this.setValues("alpha",U),this},toJSON:function(){return this.rgb()},clone:function(){return new d(this.rgb())}},d.prototype.getValues=function(T){for(var w={},y=0;y<T.length;y++)w[T[y]]=this.values[T][y];return 1!=this.values.alpha&&(w.a=this.values.alpha),w},d.prototype.setValues=function(T,w){var y={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],cmyk:["cyan","magenta","yellow","black"]},S={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],cmyk:[100,100,100,100]},P=1;if("alpha"==T)P=w;else if(w.length)this.values[T]=w.slice(0,T.length),P=w[T.length];else if(void 0!==w[T[0]]){for(var E=0;E<T.length;E++)this.values[T][E]=w[T[E]];P=w.a}else if(void 0!==w[y[T][0]]){var Z=y[T];for(E=0;E<T.length;E++)this.values[T][E]=w[Z[E]];P=w.alpha}if(this.values.alpha=Math.max(0,Math.min(1,void 0!==P?P:this.values.alpha)),"alpha"!=T){for(var A in y)for(A!=T&&(this.values[A]=M[T][A](this.values[T])),E=0;E<A.length;E++){var I=Math.max(0,Math.min(S[A][E],this.values[A][E]));this.values[A][E]=Math.round(I)}return!0}},d.prototype.setSpace=function(T,w){var y=w[0];return void 0===y?this.getValues(T):("number"==typeof y&&(y=Array.prototype.slice.call(w)),this.setValues(T,y),this)},d.prototype.setChannel=function(T,w,y){return void 0===y?this.values[T][w]:(this.values[T][w]=y,this.setValues(T,this.values[T]),this)}},42539:q=>{function H(X){var we,Ye,ie=X[0]/255,oe=X[1]/255,ae=X[2]/255,pe=Math.min(ie,oe,ae),xe=Math.max(ie,oe,ae),Ne=xe-pe;return xe==pe?we=0:ie==xe?we=(oe-ae)/Ne:oe==xe?we=2+(ae-ie)/Ne:ae==xe&&(we=4+(ie-oe)/Ne),(we=Math.min(60*we,360))<0&&(we+=360),Ye=(pe+xe)/2,[we,100*(xe==pe?0:Ye<=.5?Ne/(xe+pe):Ne/(2-xe-pe)),100*Ye]}function v(X){var we,me,ie=X[0],oe=X[1],ae=X[2],pe=Math.min(ie,oe,ae),xe=Math.max(ie,oe,ae),Ne=xe-pe;return me=0==xe?0:Ne/xe*1e3/10,xe==pe?we=0:ie==xe?we=(oe-ae)/Ne:oe==xe?we=2+(ae-ie)/Ne:ae==xe&&(we=4+(ie-oe)/Ne),(we=Math.min(60*we,360))<0&&(we+=360),[we,me,xe/255*1e3/10]}function M(X){var we,ie=X[0]/255,oe=X[1]/255,ae=X[2]/255;return[(1-ie-(we=Math.min(1-ie,1-oe,1-ae)))/(1-we)*100,(1-oe-we)/(1-we)*100,(1-ae-we)/(1-we)*100,100*we]}function D(X){return Ie[JSON.stringify(X)]}function d(X){var ie=X[0]/255,oe=X[1]/255,ae=X[2]/255;return[100*(.4124*(ie=ie>.04045?Math.pow((ie+.055)/1.055,2.4):ie/12.92)+.3576*(oe=oe>.04045?Math.pow((oe+.055)/1.055,2.4):oe/12.92)+.1805*(ae=ae>.04045?Math.pow((ae+.055)/1.055,2.4):ae/12.92)),100*(.2126*ie+.7152*oe+.0722*ae),100*(.0193*ie+.1192*oe+.9505*ae)]}function w(X){var pe,xe,Ne,we,me,ie=X[0]/360,oe=X[1]/100,ae=X[2]/100;if(0==oe)return[me=255*ae,me,me];pe=2*ae-(xe=ae<.5?ae*(1+oe):ae+oe-ae*oe),we=[0,0,0];for(var Ye=0;Ye<3;Ye++)(Ne=ie+1/3*-(Ye-1))<0&&Ne++,Ne>1&&Ne--,we[Ye]=255*(me=6*Ne<1?pe+6*(xe-pe)*Ne:2*Ne<1?xe:3*Ne<2?pe+(xe-pe)*(2/3-Ne)*6:pe);return we}function E(X){var ie=X[0]/60,oe=X[1]/100,me=X[2]/100,ae=Math.floor(ie)%6,pe=ie-Math.floor(ie),xe=255*me*(1-oe),Ne=255*me*(1-oe*pe),we=255*me*(1-oe*(1-pe));switch(me*=255,ae){case 0:return[me,we,xe];case 1:return[Ne,me,xe];case 2:return[xe,me,we];case 3:return[xe,Ne,me];case 4:return[we,xe,me];case 5:return[me,xe,Ne]}}function U(X){var oe=X[1]/100,ae=X[2]/100,pe=X[3]/100;return[255*(1-Math.min(1,X[0]/100*(1-pe)+pe)),255*(1-Math.min(1,oe*(1-pe)+pe)),255*(1-Math.min(1,ae*(1-pe)+pe))]}function de(X){return Ue[X]}q.exports={rgb2hsl:H,rgb2hsv:v,rgb2cmyk:M,rgb2keyword:D,rgb2xyz:d,rgb2lab:function T(X){var ie=d(X),oe=ie[0],ae=ie[1],pe=ie[2];return ae/=100,pe/=108.883,oe=(oe/=95.047)>.008856?Math.pow(oe,1/3):7.787*oe+16/116,[116*(ae=ae>.008856?Math.pow(ae,1/3):7.787*ae+16/116)-16,500*(oe-ae),200*(ae-(pe=pe>.008856?Math.pow(pe,1/3):7.787*pe+16/116))]},hsl2rgb:w,hsl2hsv:function y(X){var oe=X[1]/100,ae=X[2]/100;return oe*=(ae*=2)<=1?ae:2-ae,[X[0],100*oe,(ae+oe)/2*100]},hsl2cmyk:function S(X){return M(w(X))},hsl2keyword:function P(X){return D(w(X))},hsv2rgb:E,hsv2hsl:function Z(X){var pe,xe,oe=X[1]/100,ae=X[2]/100;return pe=oe*ae,[X[0],100*(pe/=(xe=(2-oe)*ae)<=1?xe:2-xe),100*(xe/=2)]},hsv2cmyk:function A(X){return M(E(X))},hsv2keyword:function I(X){return D(E(X))},cmyk2rgb:U,cmyk2hsl:function Q(X){return H(U(X))},cmyk2hsv:function W(X){return v(U(X))},cmyk2keyword:function le(X){return D(U(X))},keyword2rgb:de,keyword2hsl:function he(X){return H(de(X))},keyword2hsv:function ke(X){return v(de(X))},keyword2cmyk:function Le(X){return M(de(X))},xyz2rgb:function e(X){var pe,xe,Ne,ie=X[0]/100,oe=X[1]/100,ae=X[2]/100;return xe=-.9689*ie+1.8758*oe+.0415*ae,Ne=.0557*ie+-.204*oe+1.057*ae,[255*(pe=(pe=(pe=3.2406*ie+-1.5372*oe+-.4986*ae)>.0031308?1.055*Math.pow(pe,1/2.4)-.055:pe*=12.92)<0?0:pe),255*(xe=(xe=xe>.0031308?1.055*Math.pow(xe,1/2.4)-.055:xe*=12.92)<0?0:xe),255*(Ne=(Ne=Ne>.0031308?1.055*Math.pow(Ne,1/2.4)-.055:Ne*=12.92)<0?0:Ne)]}};var Ue={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ie={};for(var je in Ue)Ie[JSON.stringify(Ue[je])]=je},30798:(q,H,v)=>{var M=v(42539),D={};for(var d in q.exports=D,M){D[d+"Raw"]=function(S){return function(P){return"number"==typeof P&&(P=Array.prototype.slice.call(arguments)),M[S](P)}}(d);var T=/(\w+)2(\w+)/.exec(d),w=T[1],y=T[2];D[w]=D[w]||{},D[w][y]=D[d]=function(S){return function(P){"number"==typeof P&&(P=Array.prototype.slice.call(arguments));var E=M[S](P);if("string"==typeof E||void 0===E)return E;for(var Z=0;Z<E.length;Z++)E[Z]=Math.round(E[Z]);return E}}(d)}},59695:(q,H,v)=>{q.exports={graphlib:v(36456),layout:v(14850),debug:v(71914),util:{time:v(11510).time,notime:v(11510).notime},version:v(28126)}},12234:(q,H,v)=>{"use strict";var M=v(45760),D=v(67365);q.exports={run:function d(y){var S="greedy"===y.graph().acyclicer?D(y,function P(E){return function(Z){return E.edge(Z).weight}}(y)):function T(y){var S=[],P={},E={};return M.forEach(y.nodes(),function Z(A){M.has(E,A)||(E[A]=!0,P[A]=!0,M.forEach(y.outEdges(A),function(I){M.has(P,I.w)?S.push(I):Z(I.w)}),delete P[A])}),S}(y);M.forEach(S,function(E){var Z=y.edge(E);y.removeEdge(E),Z.forwardName=E.name,Z.reversed=!0,y.setEdge(E.w,E.v,Z,M.uniqueId("rev"))})},undo:function w(y){M.forEach(y.edges(),function(S){var P=y.edge(S);if(P.reversed){y.removeEdge(S);var E=P.forwardName;delete P.reversed,delete P.forwardName,y.setEdge(S.w,S.v,P,E)}})}}},79999:(q,H,v)=>{var M=v(45760),D=v(11510);function T(w,y,S,P,E,Z){var I=E[y][Z-1],U=D.addDummyNode(w,"border",{width:0,height:0,rank:Z,borderType:y},S);E[y][Z]=U,w.setParent(U,P),I&&w.setEdge(I,U,{weight:1})}q.exports=function d(w){M.forEach(w.children(),function y(S){var P=w.children(S),E=w.node(S);if(P.length&&M.forEach(P,y),M.has(E,"minRank")){E.borderLeft=[],E.borderRight=[];for(var Z=E.minRank,A=E.maxRank+1;Z<A;++Z)T(w,"borderLeft","_bl",S,E,Z),T(w,"borderRight","_br",S,E,Z)}})}},83870:(q,H,v)=>{"use strict";var M=v(45760);function T(Z){M.forEach(Z.nodes(),function(A){w(Z.node(A))}),M.forEach(Z.edges(),function(A){w(Z.edge(A))})}function w(Z){var A=Z.width;Z.width=Z.height,Z.height=A}function S(Z){Z.y=-Z.y}function E(Z){var A=Z.x;Z.x=Z.y,Z.y=A}q.exports={adjust:function D(Z){var A=Z.graph().rankdir.toLowerCase();("lr"===A||"rl"===A)&&T(Z)},undo:function d(Z){var A=Z.graph().rankdir.toLowerCase();("bt"===A||"rl"===A)&&function y(Z){M.forEach(Z.nodes(),function(A){S(Z.node(A))}),M.forEach(Z.edges(),function(A){var I=Z.edge(A);M.forEach(I.points,S),M.has(I,"y")&&S(I)})}(Z),("lr"===A||"rl"===A)&&(function P(Z){M.forEach(Z.nodes(),function(A){E(Z.node(A))}),M.forEach(Z.edges(),function(A){var I=Z.edge(A);M.forEach(I.points,E),M.has(I,"x")&&E(I)})}(Z),T(Z))}}},3226:q=>{function H(){var D={};D._next=D._prev=D,this._sentinel=D}function v(D){D._prev._next=D._next,D._next._prev=D._prev,delete D._next,delete D._prev}function M(D,d){if("_next"!==D&&"_prev"!==D)return d}q.exports=H,H.prototype.dequeue=function(){var D=this._sentinel,d=D._prev;if(d!==D)return v(d),d},H.prototype.enqueue=function(D){var d=this._sentinel;D._prev&&D._next&&v(D),D._next=d._next,d._next._prev=D,d._next=D,D._prev=d},H.prototype.toString=function(){for(var D=[],d=this._sentinel,T=d._prev;T!==d;)D.push(JSON.stringify(T,M)),T=T._prev;return"["+D.join(", ")+"]"}},71914:(q,H,v)=>{var M=v(45760),D=v(11510),d=v(36456).Graph;q.exports={debugOrdering:function T(w){var y=D.buildLayerMatrix(w),S=new d({compound:!0,multigraph:!0}).setGraph({});return M.forEach(w.nodes(),function(P){S.setNode(P,{label:P}),S.setParent(P,"layer"+w.node(P).rank)}),M.forEach(w.edges(),function(P){S.setEdge(P.v,P.w,{},P.name)}),M.forEach(y,function(P,E){S.setNode("layer"+E,{rank:"same"}),M.reduce(P,function(A,I){return S.setEdge(A,I,{style:"invis"}),I})}),S}}},36456:(q,H,v)=>{var M;try{M=v(85510)}catch{}M||(M=window.graphlib),q.exports=M},67365:(q,H,v)=>{var M=v(45760),D=v(36456).Graph,d=v(3226);q.exports=function w(Z,A){if(Z.nodeCount()<=1)return[];var I=function P(Z,A){var I=new D,U=0,Q=0;M.forEach(Z.nodes(),function(e){I.setNode(e,{v:e,in:0,out:0})}),M.forEach(Z.edges(),function(e){var de=I.edge(e.v,e.w)||0,he=A(e);I.setEdge(e.v,e.w,de+he),Q=Math.max(Q,I.node(e.v).out+=he),U=Math.max(U,I.node(e.w).in+=he)});var W=M.range(Q+U+3).map(function(){return new d}),le=U+1;return M.forEach(I.nodes(),function(e){E(W,le,I.node(e))}),{graph:I,buckets:W,zeroIdx:le}}(Z,A||T),U=function y(Z,A,I){for(var le,U=[],Q=A[A.length-1],W=A[0];Z.nodeCount();){for(;le=W.dequeue();)S(Z,A,I,le);for(;le=Q.dequeue();)S(Z,A,I,le);if(Z.nodeCount())for(var e=A.length-2;e>0;--e)if(le=A[e].dequeue()){U=U.concat(S(Z,A,I,le,!0));break}}return U}(I.graph,I.buckets,I.zeroIdx);return M.flatten(M.map(U,function(Q){return Z.outEdges(Q.v,Q.w)}),!0)};var T=M.constant(1);function S(Z,A,I,U,Q){var W=Q?[]:void 0;return M.forEach(Z.inEdges(U.v),function(le){var e=Z.edge(le),de=Z.node(le.v);Q&&W.push({v:le.v,w:le.w}),de.out-=e,E(A,I,de)}),M.forEach(Z.outEdges(U.v),function(le){var e=Z.edge(le),he=Z.node(le.w);he.in-=e,E(A,I,he)}),Z.removeNode(U.v),W}function E(Z,A,I){I.out?I.in?Z[I.out-I.in+A].enqueue(I):Z[Z.length-1].enqueue(I):Z[0].enqueue(I)}},14850:(q,H,v)=>{"use strict";var M=v(45760),D=v(12234),d=v(91496),T=v(94124),w=v(11510).normalizeRanks,y=v(60162),S=v(11510).removeEmptyRanks,P=v(1230),E=v(79999),Z=v(83870),A=v(32974),I=v(78226),U=v(11510),Q=v(36456).Graph;q.exports=function W(st,at){var kt=at&&at.debugTiming?U.time:U.notime;kt("layout",function(){var $t=kt("  buildLayoutGraph",function(){return function ie(st){var at=new Q({multigraph:!0,compound:!0}),kt=Pn(st.graph());return at.setGraph(M.merge({},he,Xt(kt,de),M.pick(kt,ke))),M.forEach(st.nodes(),function($t){var _n=Pn(st.node($t));at.setNode($t,M.defaults(Xt(_n,Le),Ue)),at.setParent($t,st.parent($t))}),M.forEach(st.edges(),function($t){var _n=Pn(st.edge($t));at.setEdge($t,M.merge({},je,Xt(_n,Ie),M.pick(_n,X)))}),at}(st)});kt("  runLayout",function(){!function le(st,at){at("    makeSpaceForEdgeLabels",function(){!function oe(st){var at=st.graph();at.ranksep/=2,M.forEach(st.edges(),function(kt){var $t=st.edge(kt);$t.minlen*=2,"c"!==$t.labelpos.toLowerCase()&&("TB"===at.rankdir||"BT"===at.rankdir?$t.width+=$t.labeloffset:$t.height+=$t.labeloffset)})}(st)}),at("    removeSelfEdges",function(){!function Et(st){M.forEach(st.edges(),function(at){if(at.v===at.w){var kt=st.node(at.v);kt.selfEdges||(kt.selfEdges=[]),kt.selfEdges.push({e:at,label:st.edge(at)}),st.removeEdge(at)}})}(st)}),at("    acyclic",function(){D.run(st)}),at("    nestingGraph.run",function(){P.run(st)}),at("    rank",function(){T(U.asNonCompoundGraph(st))}),at("    injectEdgeLabelProxies",function(){!function ae(st){M.forEach(st.edges(),function(at){var kt=st.edge(at);if(kt.width&&kt.height){var $t=st.node(at.v),_n=st.node(at.w);U.addDummyNode(st,"edge-proxy",{rank:(_n.rank-$t.rank)/2+$t.rank,e:at},"_ep")}})}(st)}),at("    removeEmptyRanks",function(){S(st)}),at("    nestingGraph.cleanup",function(){P.cleanup(st)}),at("    normalizeRanks",function(){w(st)}),at("    assignRankMinMax",function(){!function pe(st){var at=0;M.forEach(st.nodes(),function(kt){var $t=st.node(kt);$t.borderTop&&($t.minRank=st.node($t.borderTop).rank,$t.maxRank=st.node($t.borderBottom).rank,at=M.max(at,$t.maxRank))}),st.graph().maxRank=at}(st)}),at("    removeEdgeLabelProxies",function(){!function xe(st){M.forEach(st.nodes(),function(at){var kt=st.node(at);"edge-proxy"===kt.dummy&&(st.edge(kt.e).labelRank=kt.rank,st.removeNode(at))})}(st)}),at("    normalize.run",function(){d.run(st)}),at("    parentDummyChains",function(){y(st)}),at("    addBorderSegments",function(){E(st)}),at("    order",function(){A(st)}),at("    insertSelfEdges",function(){!function Tt(st){var at=U.buildLayerMatrix(st);M.forEach(at,function(kt){var $t=0;M.forEach(kt,function(_n,Lt){var gn=st.node(_n);gn.order=Lt+$t,M.forEach(gn.selfEdges,function($n){U.addDummyNode(st,"selfedge",{width:$n.label.width,height:$n.label.height,rank:gn.rank,order:Lt+ ++$t,e:$n.e,label:$n.label},"_se")}),delete gn.selfEdges})})}(st)}),at("    adjustCoordinateSystem",function(){Z.adjust(st)}),at("    position",function(){I(st)}),at("    positionSelfEdges",function(){!function Nt(st){M.forEach(st.nodes(),function(at){var kt=st.node(at);if("selfedge"===kt.dummy){var $t=st.node(kt.e.v),_n=$t.x+$t.width/2,Lt=$t.y,gn=kt.x-_n,$n=$t.height/2;st.setEdge(kt.e,kt.label),st.removeNode(at),kt.label.points=[{x:_n+2*gn/3,y:Lt-$n},{x:_n+5*gn/6,y:Lt-$n},{x:_n+gn,y:Lt},{x:_n+5*gn/6,y:Lt+$n},{x:_n+2*gn/3,y:Lt+$n}],kt.label.x=kt.x,kt.label.y=kt.y}})}(st)}),at("    removeBorderNodes",function(){!function mt(st){M.forEach(st.nodes(),function(at){if(st.children(at).length){var kt=st.node(at),$t=st.node(kt.borderTop),_n=st.node(kt.borderBottom),Lt=st.node(M.last(kt.borderLeft)),gn=st.node(M.last(kt.borderRight));kt.width=Math.abs(gn.x-Lt.x),kt.height=Math.abs(_n.y-$t.y),kt.x=Lt.x+kt.width/2,kt.y=$t.y+kt.height/2}}),M.forEach(st.nodes(),function(at){"border"===st.node(at).dummy&&st.removeNode(at)})}(st)}),at("    normalize.undo",function(){d.undo(st)}),at("    fixupEdgeLabelCoords",function(){!function me(st){M.forEach(st.edges(),function(at){var kt=st.edge(at);if(M.has(kt,"x"))switch(("l"===kt.labelpos||"r"===kt.labelpos)&&(kt.width-=kt.labeloffset),kt.labelpos){case"l":kt.x-=kt.width/2+kt.labeloffset;break;case"r":kt.x+=kt.width/2+kt.labeloffset}})}(st)}),at("    undoCoordinateSystem",function(){Z.undo(st)}),at("    translateGraph",function(){!function Ne(st){var at=Number.POSITIVE_INFINITY,kt=0,$t=Number.POSITIVE_INFINITY,_n=0,Lt=st.graph(),gn=Lt.marginx||0,$n=Lt.marginy||0;function pn(Ui){var Gi=Ui.x,yi=Ui.y,Di=Ui.width,gi=Ui.height;at=Math.min(at,Gi-Di/2),kt=Math.max(kt,Gi+Di/2),$t=Math.min($t,yi-gi/2),_n=Math.max(_n,yi+gi/2)}M.forEach(st.nodes(),function(Ui){pn(st.node(Ui))}),M.forEach(st.edges(),function(Ui){var Gi=st.edge(Ui);M.has(Gi,"x")&&pn(Gi)}),at-=gn,$t-=$n,M.forEach(st.nodes(),function(Ui){var Gi=st.node(Ui);Gi.x-=at,Gi.y-=$t}),M.forEach(st.edges(),function(Ui){var Gi=st.edge(Ui);M.forEach(Gi.points,function(yi){yi.x-=at,yi.y-=$t}),M.has(Gi,"x")&&(Gi.x-=at),M.has(Gi,"y")&&(Gi.y-=$t)}),Lt.width=kt-at+gn,Lt.height=_n-$t+$n}(st)}),at("    assignNodeIntersects",function(){!function we(st){M.forEach(st.edges(),function(at){var Lt,gn,kt=st.edge(at),$t=st.node(at.v),_n=st.node(at.w);kt.points?(Lt=kt.points[0],gn=kt.points[kt.points.length-1]):(kt.points=[],Lt=_n,gn=$t),kt.points.unshift(U.intersectRect($t,Lt)),kt.points.push(U.intersectRect(_n,gn))})}(st)}),at("    reversePoints",function(){!function Ye(st){M.forEach(st.edges(),function(at){var kt=st.edge(at);kt.reversed&&kt.points.reverse()})}(st)}),at("    acyclic.undo",function(){D.undo(st)})}($t,kt)}),kt("  updateInputGraph",function(){!function e(st,at){M.forEach(st.nodes(),function(kt){var $t=st.node(kt),_n=at.node(kt);$t&&($t.x=_n.x,$t.y=_n.y,at.children(kt).length&&($t.width=_n.width,$t.height=_n.height))}),M.forEach(st.edges(),function(kt){var $t=st.edge(kt),_n=at.edge(kt);$t.points=_n.points,M.has(_n,"x")&&($t.x=_n.x,$t.y=_n.y)}),st.graph().width=at.graph().width,st.graph().height=at.graph().height}(st,$t)})})};var de=["nodesep","edgesep","ranksep","marginx","marginy"],he={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ke=["acyclicer","ranker","rankdir","align"],Le=["width","height"],Ue={width:0,height:0},Ie=["minlen","weight","width","height","labeloffset"],je={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},X=["labelpos"];function Xt(st,at){return M.mapValues(M.pick(st,at),Number)}function Pn(st){var at={};return M.forEach(st,function(kt,$t){at[$t.toLowerCase()]=kt}),at}},45760:(q,H,v)=>{var M;try{M={cloneDeep:v(90733),constant:v(76684),defaults:v(28800),each:v(35474),filter:v(35281),find:v(62516),flatten:v(22274),forEach:v(89851),forIn:v(41176),has:v(54842),isUndefined:v(34235),last:v(25809),map:v(19984),mapValues:v(10203),max:v(18176),merge:v(80567),min:v(29439),minBy:v(29525),now:v(31710),pick:v(16372),range:v(90361),reduce:v(81337),sortBy:v(12906),uniqueId:v(51541),values:v(90377),zipObject:v(21617)}}catch{}M||(M=window._),q.exports=M},1230:(q,H,v)=>{var M=v(45760),D=v(11510);function T(P,E,Z,A,I,U,Q){var W=P.children(Q);if(W.length){var le=D.addBorderNode(P,"_bt"),e=D.addBorderNode(P,"_bb"),de=P.node(Q);P.setParent(le,Q),de.borderTop=le,P.setParent(e,Q),de.borderBottom=e,M.forEach(W,function(he){T(P,E,Z,A,I,U,he);var ke=P.node(he),Le=ke.borderTop?ke.borderTop:he,Ue=ke.borderBottom?ke.borderBottom:he,Ie=ke.borderTop?A:2*A,je=Le!==Ue?1:I-U[Q]+1;P.setEdge(le,Le,{weight:Ie,minlen:je,nestingEdge:!0}),P.setEdge(Ue,e,{weight:Ie,minlen:je,nestingEdge:!0})}),P.parent(Q)||P.setEdge(E,le,{weight:0,minlen:I+U[Q]})}else Q!==E&&P.setEdge(E,Q,{weight:0,minlen:Z})}q.exports={run:function d(P){var E=D.addDummyNode(P,"root",{},"_root"),Z=function w(P){var E={};function Z(A,I){var U=P.children(A);U&&U.length&&M.forEach(U,function(Q){Z(Q,I+1)}),E[A]=I}return M.forEach(P.children(),function(A){Z(A,1)}),E}(P),A=M.max(M.values(Z))-1,I=2*A+1;P.graph().nestingRoot=E,M.forEach(P.edges(),function(Q){P.edge(Q).minlen*=I});var U=function y(P){return M.reduce(P.edges(),function(E,Z){return E+P.edge(Z).weight},0)}(P)+1;M.forEach(P.children(),function(Q){T(P,E,I,U,A,Z,Q)}),P.graph().nodeRankFactor=I},cleanup:function S(P){var E=P.graph();P.removeNode(E.nestingRoot),delete E.nestingRoot,M.forEach(P.edges(),function(Z){P.edge(Z).nestingEdge&&P.removeEdge(Z)})}}},91496:(q,H,v)=>{"use strict";var M=v(45760),D=v(11510);q.exports={run:function d(y){y.graph().dummyChains=[],M.forEach(y.edges(),function(S){!function T(y,S){var P=S.v,E=y.node(P).rank,Z=S.w,A=y.node(Z).rank,I=S.name,U=y.edge(S),Q=U.labelRank;if(A!==E+1){var W,le,e;for(y.removeEdge(S),e=0,++E;E<A;++e,++E)U.points=[],W=D.addDummyNode(y,"edge",le={width:0,height:0,edgeLabel:U,edgeObj:S,rank:E},"_d"),E===Q&&(le.width=U.width,le.height=U.height,le.dummy="edge-label",le.labelpos=U.labelpos),y.setEdge(P,W,{weight:U.weight},I),0===e&&y.graph().dummyChains.push(W),P=W;y.setEdge(P,Z,{weight:U.weight},I)}}(y,S)})},undo:function w(y){M.forEach(y.graph().dummyChains,function(S){var Z,P=y.node(S),E=P.edgeLabel;for(y.setEdge(P.edgeObj,E);P.dummy;)Z=y.successors(S)[0],y.removeNode(S),E.points.push({x:P.x,y:P.y}),"edge-label"===P.dummy&&(E.x=P.x,E.y=P.y,E.width=P.width,E.height=P.height),P=y.node(S=Z)})}}},33034:(q,H,v)=>{var M=v(45760);q.exports=function D(d,T,w){var S,y={};M.forEach(w,function(P){for(var Z,A,E=d.parent(P);E;){if((Z=d.parent(E))?(A=y[Z],y[Z]=E):(A=S,S=E),A&&A!==E)return void T.setEdge(A,E);E=Z}})}},81323:(q,H,v)=>{var M=v(45760);q.exports=function D(d,T){return M.map(T,function(w){var y=d.inEdges(w);if(y.length){var S=M.reduce(y,function(P,E){var Z=d.edge(E),A=d.node(E.v);return{sum:P.sum+Z.weight*A.order,weight:P.weight+Z.weight}},{sum:0,weight:0});return{v:w,barycenter:S.sum/S.weight,weight:S.weight}}return{v:w}})}},1686:(q,H,v)=>{var M=v(45760),D=v(36456).Graph;q.exports=function d(w,y,S){var P=function T(w){for(var y;w.hasNode(y=M.uniqueId("_root")););return y}(w),E=new D({compound:!0}).setGraph({root:P}).setDefaultNodeLabel(function(Z){return w.node(Z)});return M.forEach(w.nodes(),function(Z){var A=w.node(Z),I=w.parent(Z);(A.rank===y||A.minRank<=y&&y<=A.maxRank)&&(E.setNode(Z),E.setParent(Z,I||P),M.forEach(w[S](Z),function(U){var Q=U.v===Z?U.w:U.v,W=E.edge(Q,Z),le=M.isUndefined(W)?0:W.weight;E.setEdge(Q,Z,{weight:w.edge(U).weight+le})}),M.has(A,"minRank")&&E.setNode(Z,{borderLeft:A.borderLeft[y],borderRight:A.borderRight[y]}))}),E}},18796:(q,H,v)=>{"use strict";var M=v(45760);function d(T,w,y){for(var S=M.zipObject(y,M.map(y,function(U,Q){return Q})),P=M.flatten(M.map(w,function(U){return M.sortBy(M.map(T.outEdges(U),function(Q){return{pos:S[Q.w],weight:T.edge(Q).weight}}),"pos")}),!0),E=1;E<y.length;)E<<=1;var Z=2*E-1;E-=1;var A=M.map(new Array(Z),function(){return 0}),I=0;return M.forEach(P.forEach(function(U){var Q=U.pos+E;A[Q]+=U.weight;for(var W=0;Q>0;)Q%2&&(W+=A[Q+1]),A[Q=Q-1>>1]+=U.weight;I+=U.weight*W})),I}q.exports=function D(T,w){for(var y=0,S=1;S<w.length;++S)y+=d(T,w[S-1],w[S]);return y}},32974:(q,H,v)=>{"use strict";var M=v(45760),D=v(49402),d=v(18796),T=v(61057),w=v(1686),y=v(33034),S=v(36456).Graph,P=v(11510);function Z(U,Q,W){return M.map(Q,function(le){return w(U,le,W)})}function A(U,Q){var W=new S;M.forEach(U,function(le){var e=le.graph().root,de=T(le,e,W,Q);M.forEach(de.vs,function(he,ke){le.node(he).order=ke}),y(le,W,de.vs)})}function I(U,Q){M.forEach(Q,function(W){M.forEach(W,function(le,e){U.node(le).order=e})})}q.exports=function E(U){var Q=P.maxRank(U),W=Z(U,M.range(1,Q+1),"inEdges"),le=Z(U,M.range(Q-1,-1,-1),"outEdges"),e=D(U);I(U,e);for(var he,de=Number.POSITIVE_INFINITY,ke=0,Le=0;Le<4;++ke,++Le){A(ke%2?W:le,ke%4>=2),e=P.buildLayerMatrix(U);var Ue=d(U,e);Ue<de&&(Le=0,he=M.cloneDeep(e),de=Ue)}I(U,he)}},49402:(q,H,v)=>{"use strict";var M=v(45760);q.exports=function D(d){var T={},w=M.filter(d.nodes(),function(Z){return!d.children(Z).length}),y=M.max(M.map(w,function(Z){return d.node(Z).rank})),S=M.map(M.range(y+1),function(){return[]}),E=M.sortBy(w,function(Z){return d.node(Z).rank});return M.forEach(E,function P(Z){if(!M.has(T,Z)){T[Z]=!0;var A=d.node(Z);S[A.rank].push(Z),M.forEach(d.successors(Z),P)}}),S}},83826:(q,H,v)=>{"use strict";var M=v(45760);q.exports=function D(w,y){var S={};return M.forEach(w,function(E,Z){var A=S[E.v]={indegree:0,in:[],out:[],vs:[E.v],i:Z};M.isUndefined(E.barycenter)||(A.barycenter=E.barycenter,A.weight=E.weight)}),M.forEach(y.edges(),function(E){var Z=S[E.v],A=S[E.w];!M.isUndefined(Z)&&!M.isUndefined(A)&&(A.indegree++,Z.out.push(S[E.w]))}),function d(w){var y=[];function S(Z){return function(A){A.merged||(M.isUndefined(A.barycenter)||M.isUndefined(Z.barycenter)||A.barycenter>=Z.barycenter)&&function T(w,y){var S=0,P=0;w.weight&&(S+=w.barycenter*w.weight,P+=w.weight),y.weight&&(S+=y.barycenter*y.weight,P+=y.weight),w.vs=y.vs.concat(w.vs),w.barycenter=S/P,w.weight=P,w.i=Math.min(y.i,w.i),y.merged=!0}(Z,A)}}function P(Z){return function(A){A.in.push(Z),0==--A.indegree&&w.push(A)}}for(;w.length;){var E=w.pop();y.push(E),M.forEach(E.in.reverse(),S(E)),M.forEach(E.out,P(E))}return M.map(M.filter(y,function(Z){return!Z.merged}),function(Z){return M.pick(Z,["vs","i","barycenter","weight"])})}(M.filter(S,function(E){return!E.indegree}))}},61057:(q,H,v)=>{var M=v(45760),D=v(81323),d=v(83826),T=v(93803);q.exports=function w(P,E,Z,A){var I=P.children(E),U=P.node(E),Q=U?U.borderLeft:void 0,W=U?U.borderRight:void 0,le={};Q&&(I=M.filter(I,function(Ue){return Ue!==Q&&Ue!==W}));var e=D(P,I);M.forEach(e,function(Ue){if(P.children(Ue.v).length){var Ie=w(P,Ue.v,Z,A);le[Ue.v]=Ie,M.has(Ie,"barycenter")&&function S(P,E){M.isUndefined(P.barycenter)?(P.barycenter=E.barycenter,P.weight=E.weight):(P.barycenter=(P.barycenter*P.weight+E.barycenter*E.weight)/(P.weight+E.weight),P.weight+=E.weight)}(Ue,Ie)}});var de=d(e,Z);!function y(P,E){M.forEach(P,function(Z){Z.vs=M.flatten(Z.vs.map(function(A){return E[A]?E[A].vs:A}),!0)})}(de,le);var he=T(de,A);if(Q&&(he.vs=M.flatten([Q,he.vs,W],!0),P.predecessors(Q).length)){var ke=P.node(P.predecessors(Q)[0]),Le=P.node(P.predecessors(W)[0]);M.has(he,"barycenter")||(he.barycenter=0,he.weight=0),he.barycenter=(he.barycenter*he.weight+ke.order+Le.order)/(he.weight+2),he.weight+=2}return he}},93803:(q,H,v)=>{var M=v(45760),D=v(11510);function T(y,S,P){for(var E;S.length&&(E=M.last(S)).i<=P;)S.pop(),y.push(E.vs),P++;return P}q.exports=function d(y,S){var P=D.partition(y,function(le){return M.has(le,"barycenter")}),E=P.lhs,Z=M.sortBy(P.rhs,function(le){return-le.i}),A=[],I=0,U=0,Q=0;E.sort(function w(y){return function(S,P){return S.barycenter<P.barycenter?-1:S.barycenter>P.barycenter?1:y?P.i-S.i:S.i-P.i}}(!!S)),Q=T(A,Z,Q),M.forEach(E,function(le){Q+=le.vs.length,A.push(le.vs),I+=le.barycenter*le.weight,U+=le.weight,Q=T(A,Z,Q)});var W={vs:M.flatten(A,!0)};return U&&(W.barycenter=I/U,W.weight=U),W}},60162:(q,H,v)=>{var M=v(45760);q.exports=function D(w){var y=function T(w){var y={},S=0;return M.forEach(w.children(),function P(E){var Z=S;M.forEach(w.children(E),P),y[E]={low:Z,lim:S++}}),y}(w);M.forEach(w.graph().dummyChains,function(S){for(var P=w.node(S),E=P.edgeObj,Z=function d(w,y,S,P){var U,Q,E=[],Z=[],A=Math.min(y[S].low,y[P].low),I=Math.max(y[S].lim,y[P].lim);U=S;do{U=w.parent(U),E.push(U)}while(U&&(y[U].low>A||I>y[U].lim));for(Q=U,U=P;(U=w.parent(U))!==Q;)Z.push(U);return{path:E.concat(Z.reverse()),lca:Q}}(w,y,E.v,E.w),A=Z.path,I=Z.lca,U=0,Q=A[U],W=!0;S!==E.w;){if(P=w.node(S),W){for(;(Q=A[U])!==I&&w.node(Q).maxRank<P.rank;)U++;Q===I&&(W=!1)}if(!W){for(;U<A.length-1&&w.node(Q=A[U+1]).minRank<=P.rank;)U++;Q=A[U]}w.setParent(S,Q),S=w.successors(S)[0]}})}},54058:(q,H,v)=>{"use strict";var M=v(45760),D=v(36456).Graph,d=v(11510);function T(de,he){var ke={};return M.reduce(he,function Le(Ue,Ie){var je=0,X=0,ie=Ue.length,oe=M.last(Ie);return M.forEach(Ie,function(ae,pe){var xe=function y(de,he){if(de.node(he).dummy)return M.find(de.predecessors(he),function(ke){return de.node(ke).dummy})}(de,ae),Ne=xe?de.node(xe).order:ie;(xe||ae===oe)&&(M.forEach(Ie.slice(X,pe+1),function(we){M.forEach(de.predecessors(we),function(me){var Ye=de.node(me),mt=Ye.order;(mt<je||Ne<mt)&&(!Ye.dummy||!de.node(we).dummy)&&S(ke,me,we)})}),X=pe+1,je=Ne)}),Ie}),ke}function w(de,he){var ke={};function Le(Ie,je,X,ie,oe){var ae;M.forEach(M.range(je,X),function(pe){de.node(ae=Ie[pe]).dummy&&M.forEach(de.predecessors(ae),function(xe){var Ne=de.node(xe);Ne.dummy&&(Ne.order<ie||Ne.order>oe)&&S(ke,xe,ae)})})}return M.reduce(he,function Ue(Ie,je){var ie,X=-1,oe=0;return M.forEach(je,function(ae,pe){if("border"===de.node(ae).dummy){var xe=de.predecessors(ae);xe.length&&(ie=de.node(xe[0]).order,Le(je,oe,pe,X,ie),oe=pe,X=ie)}Le(je,oe,je.length,ie,Ie.length)}),je}),ke}function S(de,he,ke){if(he>ke){var Le=he;he=ke,ke=Le}var Ue=de[he];Ue||(de[he]=Ue={}),Ue[ke]=!0}function P(de,he,ke){if(he>ke){var Le=he;he=ke,ke=Le}return M.has(de[he],ke)}function E(de,he,ke,Le){var Ue={},Ie={},je={};return M.forEach(he,function(X){M.forEach(X,function(ie,oe){Ue[ie]=ie,Ie[ie]=ie,je[ie]=oe})}),M.forEach(he,function(X){var ie=-1;M.forEach(X,function(oe){var ae=Le(oe);if(ae.length)for(var pe=((ae=M.sortBy(ae,function(me){return je[me]})).length-1)/2,xe=Math.floor(pe),Ne=Math.ceil(pe);xe<=Ne;++xe){var we=ae[xe];Ie[oe]===oe&&ie<je[we]&&!P(ke,oe,we)&&(Ie[we]=oe,Ie[oe]=Ue[oe]=Ue[we],ie=je[we])}})}),{root:Ue,align:Ie}}function Z(de,he,ke,Le,Ue){var Ie={},je=function A(de,he,ke,Le){var Ue=new D,Ie=de.graph(),je=function le(de,he,ke){return function(Le,Ue,Ie){var oe,je=Le.node(Ue),X=Le.node(Ie),ie=0;if(ie+=je.width/2,M.has(je,"labelpos"))switch(je.labelpos.toLowerCase()){case"l":oe=-je.width/2;break;case"r":oe=je.width/2}if(oe&&(ie+=ke?oe:-oe),oe=0,ie+=(je.dummy?he:de)/2,ie+=(X.dummy?he:de)/2,ie+=X.width/2,M.has(X,"labelpos"))switch(X.labelpos.toLowerCase()){case"l":oe=X.width/2;break;case"r":oe=-X.width/2}return oe&&(ie+=ke?oe:-oe),oe=0,ie}}(Ie.nodesep,Ie.edgesep,Le);return M.forEach(he,function(X){var ie;M.forEach(X,function(oe){var ae=ke[oe];if(Ue.setNode(ae),ie){var pe=ke[ie],xe=Ue.edge(pe,ae);Ue.setEdge(pe,ae,Math.max(je(de,oe,ie),xe||0))}ie=oe})}),Ue}(de,he,ke,Ue),X=Ue?"borderLeft":"borderRight";function ie(pe,xe){for(var Ne=je.nodes(),we=Ne.pop(),me={};we;)me[we]?pe(we):(me[we]=!0,Ne.push(we),Ne=Ne.concat(xe(we))),we=Ne.pop()}return ie(function oe(pe){Ie[pe]=je.inEdges(pe).reduce(function(xe,Ne){return Math.max(xe,Ie[Ne.v]+je.edge(Ne))},0)},je.predecessors.bind(je)),ie(function ae(pe){var xe=je.outEdges(pe).reduce(function(we,me){return Math.min(we,Ie[me.w]-je.edge(me))},Number.POSITIVE_INFINITY),Ne=de.node(pe);xe!==Number.POSITIVE_INFINITY&&Ne.borderType!==X&&(Ie[pe]=Math.max(Ie[pe],xe))},je.successors.bind(je)),M.forEach(Le,function(pe){Ie[pe]=Ie[ke[pe]]}),Ie}function I(de,he){return M.minBy(M.values(he),function(ke){var Le=Number.NEGATIVE_INFINITY,Ue=Number.POSITIVE_INFINITY;return M.forIn(ke,function(Ie,je){var X=function e(de,he){return de.node(he).width}(de,je)/2;Le=Math.max(Ie+X,Le),Ue=Math.min(Ie-X,Ue)}),Le-Ue})}function U(de,he){var ke=M.values(he),Le=M.min(ke),Ue=M.max(ke);M.forEach(["u","d"],function(Ie){M.forEach(["l","r"],function(je){var oe,X=Ie+je,ie=de[X];if(ie!==he){var ae=M.values(ie);(oe="l"===je?Le-M.min(ae):Ue-M.max(ae))&&(de[X]=M.mapValues(ie,function(pe){return pe+oe}))}})})}function Q(de,he){return M.mapValues(de.ul,function(ke,Le){if(he)return de[he.toLowerCase()][Le];var Ue=M.sortBy(M.map(de,Le));return(Ue[1]+Ue[2])/2})}q.exports={positionX:function W(de){var Ue,he=d.buildLayerMatrix(de),ke=M.merge(T(de,he),w(de,he)),Le={};M.forEach(["u","d"],function(je){Ue="u"===je?he:M.values(he).reverse(),M.forEach(["l","r"],function(X){"r"===X&&(Ue=M.map(Ue,function(pe){return M.values(pe).reverse()}));var ie=("u"===je?de.predecessors:de.successors).bind(de),oe=E(0,Ue,ke,ie),ae=Z(de,Ue,oe.root,oe.align,"r"===X);"r"===X&&(ae=M.mapValues(ae,function(pe){return-pe})),Le[je+X]=ae})});var Ie=I(de,Le);return U(Le,Ie),Q(Le,de.graph().align)},findType1Conflicts:T,findType2Conflicts:w,addConflict:S,hasConflict:P,verticalAlignment:E,horizontalCompaction:Z,alignCoordinates:U,findSmallestWidthAlignment:I,balance:Q}},78226:(q,H,v)=>{"use strict";var M=v(45760),D=v(11510),d=v(54058).positionX;q.exports=function T(y){(function w(y){var S=D.buildLayerMatrix(y),P=y.graph().ranksep,E=0;M.forEach(S,function(Z){var A=M.max(M.map(Z,function(I){return y.node(I).height}));M.forEach(Z,function(I){y.node(I).y=E+A/2}),E+=A+P})})(y=D.asNonCompoundGraph(y)),M.forEach(d(y),function(S,P){y.node(P).x=S})}},96632:(q,H,v)=>{"use strict";var M=v(45760),D=v(36456).Graph,d=v(1916).slack;function w(P,E){return M.forEach(P.nodes(),function Z(A){M.forEach(E.nodeEdges(A),function(I){var U=I.v,Q=A===U?I.w:U;!P.hasNode(Q)&&!d(E,I)&&(P.setNode(Q,{}),P.setEdge(A,Q,{}),Z(Q))})}),P.nodeCount()}function y(P,E){return M.minBy(E.edges(),function(Z){if(P.hasNode(Z.v)!==P.hasNode(Z.w))return d(E,Z)})}function S(P,E,Z){M.forEach(P.nodes(),function(A){E.node(A).rank+=Z})}q.exports=function T(P){var I,U,E=new D({directed:!1}),Z=P.nodes()[0],A=P.nodeCount();for(E.setNode(Z,{});w(E,P)<A;)I=y(E,P),U=E.hasNode(I.v)?d(P,I):-d(P,I),S(E,P,U);return E}},94124:(q,H,v)=>{"use strict";var D=v(1916).longestPath,d=v(96632),T=v(63804);q.exports=function w(E){switch(E.graph().ranker){case"network-simplex":default:!function P(E){T(E)}(E);break;case"tight-tree":!function S(E){D(E),d(E)}(E);break;case"longest-path":y(E)}};var y=D},63804:(q,H,v)=>{"use strict";var M=v(45760),D=v(96632),d=v(1916).slack,T=v(1916).longestPath,w=v(36456).alg.preorder,y=v(36456).alg.postorder,S=v(11510).simplify;function P(ke){ke=S(ke),T(ke);var Ue,Le=D(ke);for(I(Le),E(Le,ke);Ue=Q(Le);)le(Le,ke,Ue,W(Le,ke,Ue))}function E(ke,Le){var Ue=y(ke,ke.nodes());Ue=Ue.slice(0,Ue.length-1),M.forEach(Ue,function(Ie){!function Z(ke,Le,Ue){var Ie=ke.node(Ue);ke.edge(Ue,Ie.parent).cutvalue=A(ke,Le,Ue)}(ke,Le,Ie)})}function A(ke,Le,Ue){var je=ke.node(Ue).parent,X=!0,ie=Le.edge(Ue,je),oe=0;return ie||(X=!1,ie=Le.edge(je,Ue)),oe=ie.weight,M.forEach(Le.nodeEdges(Ue),function(ae){var pe=ae.v===Ue,xe=pe?ae.w:ae.v;if(xe!==je){var Ne=pe===X,we=Le.edge(ae).weight;if(oe+=Ne?we:-we,function de(ke,Le,Ue){return ke.hasEdge(Le,Ue)}(ke,Ue,xe)){var me=ke.edge(Ue,xe).cutvalue;oe+=Ne?-me:me}}}),oe}function I(ke,Le){arguments.length<2&&(Le=ke.nodes()[0]),U(ke,{},1,Le)}function U(ke,Le,Ue,Ie,je){var X=Ue,ie=ke.node(Ie);return Le[Ie]=!0,M.forEach(ke.neighbors(Ie),function(oe){M.has(Le,oe)||(Ue=U(ke,Le,Ue,oe,Ie))}),ie.low=X,ie.lim=Ue++,je?ie.parent=je:delete ie.parent,Ue}function Q(ke){return M.find(ke.edges(),function(Le){return ke.edge(Le).cutvalue<0})}function W(ke,Le,Ue){var Ie=Ue.v,je=Ue.w;Le.hasEdge(Ie,je)||(Ie=Ue.w,je=Ue.v);var X=ke.node(Ie),ie=ke.node(je),oe=X,ae=!1;X.lim>ie.lim&&(oe=ie,ae=!0);var pe=M.filter(Le.edges(),function(xe){return ae===he(0,ke.node(xe.v),oe)&&ae!==he(0,ke.node(xe.w),oe)});return M.minBy(pe,function(xe){return d(Le,xe)})}function le(ke,Le,Ue,Ie){ke.removeEdge(Ue.v,Ue.w),ke.setEdge(Ie.v,Ie.w,{}),I(ke),E(ke,Le),function e(ke,Le){var Ue=M.find(ke.nodes(),function(je){return!Le.node(je).parent}),Ie=w(ke,Ue);Ie=Ie.slice(1),M.forEach(Ie,function(je){var X=ke.node(je).parent,ie=Le.edge(je,X),oe=!1;ie||(ie=Le.edge(X,je),oe=!0),Le.node(je).rank=Le.node(X).rank+(oe?ie.minlen:-ie.minlen)})}(ke,Le)}function he(ke,Le,Ue){return Ue.low<=Le.lim&&Le.lim<=Ue.lim}q.exports=P,P.initLowLimValues=I,P.initCutValues=E,P.calcCutValue=A,P.leaveEdge=Q,P.enterEdge=W,P.exchangeEdges=le},1916:(q,H,v)=>{"use strict";var M=v(45760);q.exports={longestPath:function D(T){var w={};M.forEach(T.sources(),function y(S){var P=T.node(S);if(M.has(w,S))return P.rank;w[S]=!0;var E=M.min(M.map(T.outEdges(S),function(Z){return y(Z.w)-T.edge(Z).minlen}));return(E===Number.POSITIVE_INFINITY||null==E)&&(E=0),P.rank=E})},slack:function d(T,w){return T.node(w.w).rank-T.node(w.v).rank-T.edge(w).minlen}}},11510:(q,H,v)=>{"use strict";var M=v(45760),D=v(36456).Graph;function d(e,de,he,ke){var Le;do{Le=M.uniqueId(ke)}while(e.hasNode(Le));return he.dummy=de,e.setNode(Le,he),Le}function U(e){return M.max(M.map(e.nodes(),function(de){var he=e.node(de).rank;if(!M.isUndefined(he))return he}))}q.exports={addDummyNode:d,simplify:function T(e){var de=(new D).setGraph(e.graph());return M.forEach(e.nodes(),function(he){de.setNode(he,e.node(he))}),M.forEach(e.edges(),function(he){var ke=de.edge(he.v,he.w)||{weight:0,minlen:1},Le=e.edge(he);de.setEdge(he.v,he.w,{weight:ke.weight+Le.weight,minlen:Math.max(ke.minlen,Le.minlen)})}),de},asNonCompoundGraph:function w(e){var de=new D({multigraph:e.isMultigraph()}).setGraph(e.graph());return M.forEach(e.nodes(),function(he){e.children(he).length||de.setNode(he,e.node(he))}),M.forEach(e.edges(),function(he){de.setEdge(he,e.edge(he))}),de},successorWeights:function y(e){var de=M.map(e.nodes(),function(he){var ke={};return M.forEach(e.outEdges(he),function(Le){ke[Le.w]=(ke[Le.w]||0)+e.edge(Le).weight}),ke});return M.zipObject(e.nodes(),de)},predecessorWeights:function S(e){var de=M.map(e.nodes(),function(he){var ke={};return M.forEach(e.inEdges(he),function(Le){ke[Le.v]=(ke[Le.v]||0)+e.edge(Le).weight}),ke});return M.zipObject(e.nodes(),de)},intersectRect:function P(e,de){var X,ie,he=e.x,ke=e.y,Le=de.x-he,Ue=de.y-ke,Ie=e.width/2,je=e.height/2;if(!Le&&!Ue)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(Ue)*Ie>Math.abs(Le)*je?(Ue<0&&(je=-je),X=je*Le/Ue,ie=je):(Le<0&&(Ie=-Ie),X=Ie,ie=Ie*Ue/Le),{x:he+X,y:ke+ie}},buildLayerMatrix:function E(e){var de=M.map(M.range(U(e)+1),function(){return[]});return M.forEach(e.nodes(),function(he){var ke=e.node(he),Le=ke.rank;M.isUndefined(Le)||(de[Le][ke.order]=he)}),de},normalizeRanks:function Z(e){var de=M.min(M.map(e.nodes(),function(he){return e.node(he).rank}));M.forEach(e.nodes(),function(he){var ke=e.node(he);M.has(ke,"rank")&&(ke.rank-=de)})},removeEmptyRanks:function A(e){var de=M.min(M.map(e.nodes(),function(Ue){return e.node(Ue).rank})),he=[];M.forEach(e.nodes(),function(Ue){var Ie=e.node(Ue).rank-de;he[Ie]||(he[Ie]=[]),he[Ie].push(Ue)});var ke=0,Le=e.graph().nodeRankFactor;M.forEach(he,function(Ue,Ie){M.isUndefined(Ue)&&Ie%Le!=0?--ke:ke&&M.forEach(Ue,function(je){e.node(je).rank+=ke})})},addBorderNode:function I(e,de,he,ke){var Le={width:0,height:0};return arguments.length>=4&&(Le.rank=he,Le.order=ke),d(e,"border",Le,de)},maxRank:U,partition:function Q(e,de){var he={lhs:[],rhs:[]};return M.forEach(e,function(ke){de(ke)?he.lhs.push(ke):he.rhs.push(ke)}),he},time:function W(e,de){var he=M.now();try{return de()}finally{console.log(e+" time: "+(M.now()-he)+"ms")}},notime:function le(e,de){return de()}}},28126:q=>{q.exports="0.8.5"},56952:(q,H,v)=>{var M=v(71356),D=v(13407),d=v(12e3),T=v(82342),w=v(69235),y=v(42374),S=Date.prototype.getTime;function E(I){return null==I}function Z(I){return!(!I||"object"!=typeof I||"number"!=typeof I.length||"function"!=typeof I.copy||"function"!=typeof I.slice||I.length>0&&"number"!=typeof I[0])}q.exports=function P(I,U,Q){var W=Q||{};return!!(W.strict?d(I,U):I===U)||(!I||!U||"object"!=typeof I&&"object"!=typeof U?W.strict?d(I,U):I==U:function A(I,U,Q){var W,le;if(typeof I!=typeof U||E(I)||E(U)||I.prototype!==U.prototype||D(I)!==D(U))return!1;var e=T(I),de=T(U);if(e!==de)return!1;if(e||de)return I.source===U.source&&w(I)===w(U);if(y(I)&&y(U))return S.call(I)===S.call(U);var he=Z(I),ke=Z(U);if(he!==ke)return!1;if(he||ke){if(I.length!==U.length)return!1;for(W=0;W<I.length;W++)if(I[W]!==U[W])return!1;return!0}if(typeof I!=typeof U)return!1;try{var Le=M(I),Ue=M(U)}catch{return!1}if(Le.length!==Ue.length)return!1;for(Le.sort(),Ue.sort(),W=Le.length-1;W>=0;W--)if(Le[W]!=Ue[W])return!1;for(W=Le.length-1;W>=0;W--)if(!P(I[le=Le[W]],U[le],Q))return!1;return!0}(I,U,W))}},32358:(q,H,v)=>{"use strict";var M=v(71356),D="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),d=Object.prototype.toString,T=Array.prototype.concat,w=Object.defineProperty,S=v(77027)(),P=w&&S,E=function(A,I,U,Q){I in A&&(!function(A){return"function"==typeof A&&"[object Function]"===d.call(A)}(Q)||!Q())||(P?w(A,I,{configurable:!0,enumerable:!1,value:U,writable:!0}):A[I]=U)},Z=function(A,I){var U=arguments.length>2?arguments[2]:{},Q=M(I);D&&(Q=T.call(Q,Object.getOwnPropertySymbols(I)));for(var W=0;W<Q.length;W+=1)E(A,Q[W],I[Q[W]],U[Q[W]])};Z.supportsDescriptors=!!P,q.exports=Z},83457:q=>{"use strict";var H="Function.prototype.bind called on incompatible ",v=Array.prototype.slice,M=Object.prototype.toString,D="[object Function]";q.exports=function(T){var w=this;if("function"!=typeof w||M.call(w)!==D)throw new TypeError(H+w);for(var S,y=v.call(arguments,1),P=function(){if(this instanceof S){var U=w.apply(this,y.concat(v.call(arguments)));return Object(U)===U?U:this}return w.apply(T,y.concat(v.call(arguments)))},E=Math.max(0,w.length-y.length),Z=[],A=0;A<E;A++)Z.push("$"+A);if(S=Function("binder","return function ("+Z.join(",")+"){ return binder.apply(this,arguments); }")(P),w.prototype){var I=function(){};I.prototype=w.prototype,S.prototype=new I,I.prototype=null}return S}},86740:(q,H,v)=>{"use strict";var M=v(83457);q.exports=Function.prototype.bind||M},9582:q=>{"use strict";var H=function(){return"string"==typeof function(){}.name},v=Object.getOwnPropertyDescriptor;if(v)try{v([],"length")}catch{v=null}H.functionsHaveConfigurableNames=function(){if(!H()||!v)return!1;var d=v(function(){},"name");return!!d&&!!d.configurable};var M=Function.prototype.bind;H.boundFunctionsHaveNames=function(){return H()&&"function"==typeof M&&""!==function(){}.bind().name},q.exports=H},15013:(q,H,v)=>{var M=v(56952),D=function(y){this.precision=y&&y.precision?y.precision:17,this.direction=!(!y||!y.direction)&&y.direction,this.pseudoNode=!(!y||!y.pseudoNode)&&y.pseudoNode,this.objectComparator=y&&y.objectComparator?y.objectComparator:w};function d(y){return y.coordinates.map(function(S){return{type:y.type.replace("Multi",""),coordinates:S}})}function T(y,S){return y.hasOwnProperty("coordinates")?y.coordinates.length===S.coordinates.length:y.length===S.length}function w(y,S){return M(y,S,{strict:!0})}D.prototype.compare=function(y,S){if(y.type!==S.type||!T(y,S))return!1;switch(y.type){case"Point":return this.compareCoord(y.coordinates,S.coordinates);case"LineString":return this.compareLine(y.coordinates,S.coordinates,0,!1);case"Polygon":return this.comparePolygon(y,S);case"Feature":return this.compareFeature(y,S);default:if(0===y.type.indexOf("Multi")){var P=this,E=d(y),Z=d(S);return E.every(function(A){return this.some(function(I){return P.compare(A,I)})},Z)}}return!1},D.prototype.compareCoord=function(y,S){if(y.length!==S.length)return!1;for(var P=0;P<y.length;P++)if(y[P].toFixed(this.precision)!==S[P].toFixed(this.precision))return!1;return!0},D.prototype.compareLine=function(y,S,P,E){if(!T(y,S))return!1;var Z=this.pseudoNode?y:this.removePseudo(y),A=this.pseudoNode?S:this.removePseudo(S);if(!E||this.compareCoord(Z[0],A[0])||(A=this.fixStartIndex(A,Z))){var I=this.compareCoord(Z[P],A[P]);return this.direction||I?this.comparePath(Z,A):!!this.compareCoord(Z[P],A[A.length-(1+P)])&&this.comparePath(Z.slice().reverse(),A)}},D.prototype.fixStartIndex=function(y,S){for(var P,E=-1,Z=0;Z<y.length;Z++)if(this.compareCoord(y[Z],S[0])){E=Z;break}return E>=0&&(P=[].concat(y.slice(E,y.length),y.slice(1,E+1))),P},D.prototype.comparePath=function(y,S){var P=this;return y.every(function(E,Z){return P.compareCoord(E,this[Z])},S)},D.prototype.comparePolygon=function(y,S){if(this.compareLine(y.coordinates[0],S.coordinates[0],1,!0)){var P=y.coordinates.slice(1,y.coordinates.length),E=S.coordinates.slice(1,S.coordinates.length),Z=this;return P.every(function(A){return this.some(function(I){return Z.compareLine(A,I,1,!0)})},E)}return!1},D.prototype.compareFeature=function(y,S){return!(y.id!==S.id||!this.objectComparator(y.properties,S.properties)||!this.compareBBox(y,S))&&this.compare(y.geometry,S.geometry)},D.prototype.compareBBox=function(y,S){return!!(!y.bbox&&!S.bbox||y.bbox&&S.bbox&&this.compareCoord(y.bbox,S.bbox))},D.prototype.removePseudo=function(y){return y},q.exports=D},95203:(q,H,v)=>{"use strict";var M,D=SyntaxError,d=Function,T=TypeError,w=function(oe){try{return d('"use strict"; return ('+oe+").constructor;")()}catch{}},y=Object.getOwnPropertyDescriptor;if(y)try{y({},"")}catch{y=null}var S=function(){throw new T},P=y?function(){try{return S}catch{try{return y(arguments,"callee").get}catch{return S}}}():S,E=v(92969)(),Z=Object.getPrototypeOf||function(oe){return oe.__proto__},A={},I=typeof Uint8Array>"u"?M:Z(Uint8Array),U={"%AggregateError%":typeof AggregateError>"u"?M:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?M:ArrayBuffer,"%ArrayIteratorPrototype%":E?Z([][Symbol.iterator]()):M,"%AsyncFromSyncIteratorPrototype%":M,"%AsyncFunction%":A,"%AsyncGenerator%":A,"%AsyncGeneratorFunction%":A,"%AsyncIteratorPrototype%":A,"%Atomics%":typeof Atomics>"u"?M:Atomics,"%BigInt%":typeof BigInt>"u"?M:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?M:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?M:Float32Array,"%Float64Array%":typeof Float64Array>"u"?M:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?M:FinalizationRegistry,"%Function%":d,"%GeneratorFunction%":A,"%Int8Array%":typeof Int8Array>"u"?M:Int8Array,"%Int16Array%":typeof Int16Array>"u"?M:Int16Array,"%Int32Array%":typeof Int32Array>"u"?M:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":E?Z(Z([][Symbol.iterator]())):M,"%JSON%":"object"==typeof JSON?JSON:M,"%Map%":typeof Map>"u"?M:Map,"%MapIteratorPrototype%":typeof Map>"u"||!E?M:Z((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?M:Promise,"%Proxy%":typeof Proxy>"u"?M:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?M:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?M:Set,"%SetIteratorPrototype%":typeof Set>"u"||!E?M:Z((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?M:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":E?Z(""[Symbol.iterator]()):M,"%Symbol%":E?Symbol:M,"%SyntaxError%":D,"%ThrowTypeError%":P,"%TypedArray%":I,"%TypeError%":T,"%Uint8Array%":typeof Uint8Array>"u"?M:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?M:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?M:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?M:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?M:WeakMap,"%WeakRef%":typeof WeakRef>"u"?M:WeakRef,"%WeakSet%":typeof WeakSet>"u"?M:WeakSet},Q=function oe(ae){var pe;if("%AsyncFunction%"===ae)pe=w("async function () {}");else if("%GeneratorFunction%"===ae)pe=w("function* () {}");else if("%AsyncGeneratorFunction%"===ae)pe=w("async function* () {}");else if("%AsyncGenerator%"===ae){var xe=oe("%AsyncGeneratorFunction%");xe&&(pe=xe.prototype)}else if("%AsyncIteratorPrototype%"===ae){var Ne=oe("%AsyncGenerator%");Ne&&(pe=Z(Ne.prototype))}return U[ae]=pe,pe},W={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},le=v(86740),e=v(93164),de=le.call(Function.call,Array.prototype.concat),he=le.call(Function.apply,Array.prototype.splice),ke=le.call(Function.call,String.prototype.replace),Le=le.call(Function.call,String.prototype.slice),Ue=le.call(Function.call,RegExp.prototype.exec),Ie=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,je=/\\(\\)?/g,X=function(ae){var pe=Le(ae,0,1),xe=Le(ae,-1);if("%"===pe&&"%"!==xe)throw new D("invalid intrinsic syntax, expected closing `%`");if("%"===xe&&"%"!==pe)throw new D("invalid intrinsic syntax, expected opening `%`");var Ne=[];return ke(ae,Ie,function(we,me,Ye,mt){Ne[Ne.length]=Ye?ke(mt,je,"$1"):me||we}),Ne},ie=function(ae,pe){var Ne,xe=ae;if(e(W,xe)&&(xe="%"+(Ne=W[xe])[0]+"%"),e(U,xe)){var we=U[xe];if(we===A&&(we=Q(xe)),typeof we>"u"&&!pe)throw new T("intrinsic "+ae+" exists, but is not available. Please file an issue!");return{alias:Ne,name:xe,value:we}}throw new D("intrinsic "+ae+" does not exist!")};q.exports=function(ae,pe){if("string"!=typeof ae||0===ae.length)throw new T("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof pe)throw new T('"allowMissing" argument must be a boolean');if(null===Ue(/^%?[^%]*%?$/,ae))throw new D("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var xe=X(ae),Ne=xe.length>0?xe[0]:"",we=ie("%"+Ne+"%",pe),me=we.name,Ye=we.value,mt=!1,Et=we.alias;Et&&(Ne=Et[0],he(xe,de([0,1],Et)));for(var Tt=1,Nt=!0;Tt<xe.length;Tt+=1){var Xt=xe[Tt],Pn=Le(Xt,0,1),st=Le(Xt,-1);if(('"'===Pn||"'"===Pn||"`"===Pn||'"'===st||"'"===st||"`"===st)&&Pn!==st)throw new D("property names with quotes must have matching quotes");if(("constructor"===Xt||!Nt)&&(mt=!0),e(U,me="%"+(Ne+="."+Xt)+"%"))Ye=U[me];else if(null!=Ye){if(!(Xt in Ye)){if(!pe)throw new T("base intrinsic for "+ae+" exists, but the property is not available.");return}if(y&&Tt+1>=xe.length){var at=y(Ye,Xt);Ye=(Nt=!!at)&&"get"in at&&!("originalValue"in at.get)?at.get:Ye[Xt]}else Nt=e(Ye,Xt),Ye=Ye[Xt];Nt&&!mt&&(U[me]=Ye)}}return Ye}},85510:(q,H,v)=>{var M=v(51838);q.exports={Graph:M.Graph,json:v(21088),alg:v(83430),version:M.version}},86730:(q,H,v)=>{var M=v(79138);q.exports=function D(d){var y,T={},w=[];function S(P){M.has(T,P)||(T[P]=!0,y.push(P),M.each(d.successors(P),S),M.each(d.predecessors(P),S))}return M.each(d.nodes(),function(P){y=[],S(P),y.length&&w.push(y)}),w}},22163:(q,H,v)=>{var M=v(79138);function d(T,w,y,S,P,E){M.has(S,w)||(S[w]=!0,y||E.push(w),M.each(P(w),function(Z){d(T,Z,y,S,P,E)}),y&&E.push(w))}q.exports=function D(T,w,y){M.isArray(w)||(w=[w]);var S=(T.isDirected()?T.successors:T.neighbors).bind(T),P=[],E={};return M.each(w,function(Z){if(!T.hasNode(Z))throw new Error("Graph does not have node: "+Z);d(T,Z,"post"===y,E,S,P)}),P}},25668:(q,H,v)=>{var M=v(61718),D=v(79138);q.exports=function d(T,w,y){return D.transform(T.nodes(),function(S,P){S[P]=M(T,P,w,y)},{})}},61718:(q,H,v)=>{var M=v(79138),D=v(31919);q.exports=function T(y,S,P,E){return function w(y,S,P,E){var I,U,Z={},A=new D,Q=function(W){var le=W.v!==I?W.v:W.w,e=Z[le],de=P(W),he=U.distance+de;if(de<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+W+" Weight: "+de);he<e.distance&&(e.distance=he,e.predecessor=I,A.decrease(le,he))};for(y.nodes().forEach(function(W){var le=W===S?0:Number.POSITIVE_INFINITY;Z[W]={distance:le},A.add(W,le)});A.size()>0&&(I=A.removeMin(),(U=Z[I]).distance!==Number.POSITIVE_INFINITY);)E(I).forEach(Q);return Z}(y,String(S),P||d,E||function(Z){return y.outEdges(Z)})};var d=M.constant(1)},9611:(q,H,v)=>{var M=v(79138),D=v(73585);q.exports=function d(T){return M.filter(D(T),function(w){return w.length>1||1===w.length&&T.hasEdge(w[0],w[0])})}},22881:(q,H,v)=>{var M=v(79138);q.exports=function d(w,y,S){return function T(w,y,S){var P={},E=w.nodes();return E.forEach(function(Z){P[Z]={},P[Z][Z]={distance:0},E.forEach(function(A){Z!==A&&(P[Z][A]={distance:Number.POSITIVE_INFINITY})}),S(Z).forEach(function(A){var I=A.v===Z?A.w:A.v,U=y(A);P[Z][I]={distance:U,predecessor:Z}})}),E.forEach(function(Z){var A=P[Z];E.forEach(function(I){var U=P[I];E.forEach(function(Q){var le=A[Q],e=U[Q],de=U[Z].distance+le.distance;de<e.distance&&(e.distance=de,e.predecessor=le.predecessor)})})}),P}(w,y||D,S||function(P){return w.outEdges(P)})};var D=M.constant(1)},83430:(q,H,v)=>{q.exports={components:v(86730),dijkstra:v(61718),dijkstraAll:v(25668),findCycles:v(9611),floydWarshall:v(22881),isAcyclic:v(46693),postorder:v(46694),preorder:v(5330),prim:v(46823),tarjan:v(73585),topsort:v(52180)}},46693:(q,H,v)=>{var M=v(52180);q.exports=function D(d){try{M(d)}catch(T){if(T instanceof M.CycleException)return!1;throw T}return!0}},46694:(q,H,v)=>{var M=v(22163);q.exports=function D(d,T){return M(d,T,"post")}},5330:(q,H,v)=>{var M=v(22163);q.exports=function D(d,T){return M(d,T,"pre")}},46823:(q,H,v)=>{var M=v(79138),D=v(66568),d=v(31919);q.exports=function T(w,y){var Z,S=new D,P={},E=new d;function A(U){var Q=U.v===Z?U.w:U.v,W=E.priority(Q);if(void 0!==W){var le=y(U);le<W&&(P[Q]=Z,E.decrease(Q,le))}}if(0===w.nodeCount())return S;M.each(w.nodes(),function(U){E.add(U,Number.POSITIVE_INFINITY),S.setNode(U)}),E.decrease(w.nodes()[0],0);for(var I=!1;E.size()>0;){if(Z=E.removeMin(),M.has(P,Z))S.setEdge(Z,P[Z]);else{if(I)throw new Error("Input graph is not connected: "+w);I=!0}w.nodeEdges(Z).forEach(A)}return S}},73585:(q,H,v)=>{var M=v(79138);q.exports=function D(d){var T=0,w=[],y={},S=[];function P(E){var Z=y[E]={onStack:!0,lowlink:T,index:T++};if(w.push(E),d.successors(E).forEach(function(U){M.has(y,U)?y[U].onStack&&(Z.lowlink=Math.min(Z.lowlink,y[U].index)):(P(U),Z.lowlink=Math.min(Z.lowlink,y[U].lowlink))}),Z.lowlink===Z.index){var I,A=[];do{I=w.pop(),y[I].onStack=!1,A.push(I)}while(E!==I);S.push(A)}}return d.nodes().forEach(function(E){M.has(y,E)||P(E)}),S}},52180:(q,H,v)=>{var M=v(79138);function D(T){var w={},y={},S=[];if(M.each(T.sinks(),function P(E){if(M.has(y,E))throw new d;M.has(w,E)||(y[E]=!0,w[E]=!0,M.each(T.predecessors(E),P),delete y[E],S.push(E))}),M.size(w)!==T.nodeCount())throw new d;return S}function d(){}q.exports=D,D.CycleException=d,d.prototype=new Error},31919:(q,H,v)=>{var M=v(79138);function D(){this._arr=[],this._keyIndices={}}q.exports=D,D.prototype.size=function(){return this._arr.length},D.prototype.keys=function(){return this._arr.map(function(d){return d.key})},D.prototype.has=function(d){return M.has(this._keyIndices,d)},D.prototype.priority=function(d){var T=this._keyIndices[d];if(void 0!==T)return this._arr[T].priority},D.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},D.prototype.add=function(d,T){var w=this._keyIndices;if(d=String(d),!M.has(w,d)){var y=this._arr,S=y.length;return w[d]=S,y.push({key:d,priority:T}),this._decrease(S),!0}return!1},D.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var d=this._arr.pop();return delete this._keyIndices[d.key],this._heapify(0),d.key},D.prototype.decrease=function(d,T){var w=this._keyIndices[d];if(T>this._arr[w].priority)throw new Error("New priority is greater than current priority. Key: "+d+" Old: "+this._arr[w].priority+" New: "+T);this._arr[w].priority=T,this._decrease(w)},D.prototype._heapify=function(d){var T=this._arr,w=2*d,y=w+1,S=d;w<T.length&&(S=T[w].priority<T[S].priority?w:S,y<T.length&&(S=T[y].priority<T[S].priority?y:S),S!==d&&(this._swap(d,S),this._heapify(S)))},D.prototype._decrease=function(d){for(var y,T=this._arr,w=T[d].priority;0!==d&&!(T[y=d>>1].priority<w);)this._swap(d,y),d=y},D.prototype._swap=function(d,T){var w=this._arr,y=this._keyIndices,S=w[d],P=w[T];w[d]=P,w[T]=S,y[P.key]=d,y[S.key]=T}},66568:(q,H,v)=>{"use strict";var M=v(79138);q.exports=w;var d="\0";function w(A){this._isDirected=!M.has(A,"directed")||A.directed,this._isMultigraph=!!M.has(A,"multigraph")&&A.multigraph,this._isCompound=!!M.has(A,"compound")&&A.compound,this._label=void 0,this._defaultNodeLabelFn=M.constant(void 0),this._defaultEdgeLabelFn=M.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[d]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function y(A,I){A[I]?A[I]++:A[I]=1}function S(A,I){--A[I]||delete A[I]}function P(A,I,U,Q){var W=""+I,le=""+U;if(!A&&W>le){var e=W;W=le,le=e}return W+"\x01"+le+"\x01"+(M.isUndefined(Q)?"\0":Q)}function E(A,I,U,Q){var W=""+I,le=""+U;if(!A&&W>le){var e=W;W=le,le=e}var de={v:W,w:le};return Q&&(de.name=Q),de}function Z(A,I){return P(A,I.v,I.w,I.name)}w.prototype._nodeCount=0,w.prototype._edgeCount=0,w.prototype.isDirected=function(){return this._isDirected},w.prototype.isMultigraph=function(){return this._isMultigraph},w.prototype.isCompound=function(){return this._isCompound},w.prototype.setGraph=function(A){return this._label=A,this},w.prototype.graph=function(){return this._label},w.prototype.setDefaultNodeLabel=function(A){return M.isFunction(A)||(A=M.constant(A)),this._defaultNodeLabelFn=A,this},w.prototype.nodeCount=function(){return this._nodeCount},w.prototype.nodes=function(){return M.keys(this._nodes)},w.prototype.sources=function(){var A=this;return M.filter(this.nodes(),function(I){return M.isEmpty(A._in[I])})},w.prototype.sinks=function(){var A=this;return M.filter(this.nodes(),function(I){return M.isEmpty(A._out[I])})},w.prototype.setNodes=function(A,I){var U=arguments,Q=this;return M.each(A,function(W){U.length>1?Q.setNode(W,I):Q.setNode(W)}),this},w.prototype.setNode=function(A,I){return M.has(this._nodes,A)?(arguments.length>1&&(this._nodes[A]=I),this):(this._nodes[A]=arguments.length>1?I:this._defaultNodeLabelFn(A),this._isCompound&&(this._parent[A]=d,this._children[A]={},this._children[d][A]=!0),this._in[A]={},this._preds[A]={},this._out[A]={},this._sucs[A]={},++this._nodeCount,this)},w.prototype.node=function(A){return this._nodes[A]},w.prototype.hasNode=function(A){return M.has(this._nodes,A)},w.prototype.removeNode=function(A){var I=this;if(M.has(this._nodes,A)){var U=function(Q){I.removeEdge(I._edgeObjs[Q])};delete this._nodes[A],this._isCompound&&(this._removeFromParentsChildList(A),delete this._parent[A],M.each(this.children(A),function(Q){I.setParent(Q)}),delete this._children[A]),M.each(M.keys(this._in[A]),U),delete this._in[A],delete this._preds[A],M.each(M.keys(this._out[A]),U),delete this._out[A],delete this._sucs[A],--this._nodeCount}return this},w.prototype.setParent=function(A,I){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(M.isUndefined(I))I=d;else{for(var U=I+="";!M.isUndefined(U);U=this.parent(U))if(U===A)throw new Error("Setting "+I+" as parent of "+A+" would create a cycle");this.setNode(I)}return this.setNode(A),this._removeFromParentsChildList(A),this._parent[A]=I,this._children[I][A]=!0,this},w.prototype._removeFromParentsChildList=function(A){delete this._children[this._parent[A]][A]},w.prototype.parent=function(A){if(this._isCompound){var I=this._parent[A];if(I!==d)return I}},w.prototype.children=function(A){if(M.isUndefined(A)&&(A=d),this._isCompound){var I=this._children[A];if(I)return M.keys(I)}else{if(A===d)return this.nodes();if(this.hasNode(A))return[]}},w.prototype.predecessors=function(A){var I=this._preds[A];if(I)return M.keys(I)},w.prototype.successors=function(A){var I=this._sucs[A];if(I)return M.keys(I)},w.prototype.neighbors=function(A){var I=this.predecessors(A);if(I)return M.union(I,this.successors(A))},w.prototype.isLeaf=function(A){return 0===(this.isDirected()?this.successors(A):this.neighbors(A)).length},w.prototype.filterNodes=function(A){var I=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});I.setGraph(this.graph());var U=this;M.each(this._nodes,function(le,e){A(e)&&I.setNode(e,le)}),M.each(this._edgeObjs,function(le){I.hasNode(le.v)&&I.hasNode(le.w)&&I.setEdge(le,U.edge(le))});var Q={};function W(le){var e=U.parent(le);return void 0===e||I.hasNode(e)?(Q[le]=e,e):e in Q?Q[e]:W(e)}return this._isCompound&&M.each(I.nodes(),function(le){I.setParent(le,W(le))}),I},w.prototype.setDefaultEdgeLabel=function(A){return M.isFunction(A)||(A=M.constant(A)),this._defaultEdgeLabelFn=A,this},w.prototype.edgeCount=function(){return this._edgeCount},w.prototype.edges=function(){return M.values(this._edgeObjs)},w.prototype.setPath=function(A,I){var U=this,Q=arguments;return M.reduce(A,function(W,le){return Q.length>1?U.setEdge(W,le,I):U.setEdge(W,le),le}),this},w.prototype.setEdge=function(){var A,I,U,Q,W=!1,le=arguments[0];"object"==typeof le&&null!==le&&"v"in le?(A=le.v,I=le.w,U=le.name,2===arguments.length&&(Q=arguments[1],W=!0)):(A=le,I=arguments[1],U=arguments[3],arguments.length>2&&(Q=arguments[2],W=!0)),A=""+A,I=""+I,M.isUndefined(U)||(U=""+U);var e=P(this._isDirected,A,I,U);if(M.has(this._edgeLabels,e))return W&&(this._edgeLabels[e]=Q),this;if(!M.isUndefined(U)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(A),this.setNode(I),this._edgeLabels[e]=W?Q:this._defaultEdgeLabelFn(A,I,U);var de=E(this._isDirected,A,I,U);return A=de.v,I=de.w,Object.freeze(de),this._edgeObjs[e]=de,y(this._preds[I],A),y(this._sucs[A],I),this._in[I][e]=de,this._out[A][e]=de,this._edgeCount++,this},w.prototype.edge=function(A,I,U){var Q=1===arguments.length?Z(this._isDirected,arguments[0]):P(this._isDirected,A,I,U);return this._edgeLabels[Q]},w.prototype.hasEdge=function(A,I,U){var Q=1===arguments.length?Z(this._isDirected,arguments[0]):P(this._isDirected,A,I,U);return M.has(this._edgeLabels,Q)},w.prototype.removeEdge=function(A,I,U){var Q=1===arguments.length?Z(this._isDirected,arguments[0]):P(this._isDirected,A,I,U),W=this._edgeObjs[Q];return W&&(A=W.v,I=W.w,delete this._edgeLabels[Q],delete this._edgeObjs[Q],S(this._preds[I],A),S(this._sucs[A],I),delete this._in[I][Q],delete this._out[A][Q],this._edgeCount--),this},w.prototype.inEdges=function(A,I){var U=this._in[A];if(U){var Q=M.values(U);return I?M.filter(Q,function(W){return W.v===I}):Q}},w.prototype.outEdges=function(A,I){var U=this._out[A];if(U){var Q=M.values(U);return I?M.filter(Q,function(W){return W.w===I}):Q}},w.prototype.nodeEdges=function(A,I){var U=this.inEdges(A,I);if(U)return U.concat(this.outEdges(A,I))}},51838:(q,H,v)=>{q.exports={Graph:v(66568),version:v(75089)}},21088:(q,H,v)=>{var M=v(79138),D=v(66568);function T(S){return M.map(S.nodes(),function(P){var E=S.node(P),Z=S.parent(P),A={v:P};return M.isUndefined(E)||(A.value=E),M.isUndefined(Z)||(A.parent=Z),A})}function w(S){return M.map(S.edges(),function(P){var E=S.edge(P),Z={v:P.v,w:P.w};return M.isUndefined(P.name)||(Z.name=P.name),M.isUndefined(E)||(Z.value=E),Z})}q.exports={write:function d(S){var P={options:{directed:S.isDirected(),multigraph:S.isMultigraph(),compound:S.isCompound()},nodes:T(S),edges:w(S)};return M.isUndefined(S.graph())||(P.value=M.clone(S.graph())),P},read:function y(S){var P=new D(S.options).setGraph(S.value);return M.each(S.nodes,function(E){P.setNode(E.v,E.value),E.parent&&P.setParent(E.v,E.parent)}),M.each(S.edges,function(E){P.setEdge({v:E.v,w:E.w,name:E.name},E.value)}),P}}},79138:(q,H,v)=>{var M;try{M={clone:v(11094),constant:v(76684),each:v(35474),filter:v(35281),has:v(54842),isArray:v(21503),isEmpty:v(71973),isFunction:v(75946),isUndefined:v(34235),keys:v(118),map:v(19984),reduce:v(81337),size:v(55637),transform:v(89416),union:v(68921),values:v(90377)}}catch{}M||(M=window._),q.exports=M},75089:q=>{q.exports="2.1.8"},77027:(q,H,v)=>{"use strict";var D=v(95203)("%Object.defineProperty%",!0),d=function(){if(D)try{return D({},"a",{value:1}),!0}catch{return!1}return!1};d.hasArrayLengthDefineBug=function(){if(!d())return null;try{return 1!==D([],"length",{value:1}).length}catch{return!0}},q.exports=d},92969:(q,H,v)=>{"use strict";var M=typeof Symbol<"u"&&Symbol,D=v(81983);q.exports=function(){return"function"==typeof M&&"function"==typeof Symbol&&"symbol"==typeof M("foo")&&"symbol"==typeof Symbol("bar")&&D()}},81983:q=>{"use strict";q.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var v={},M=Symbol("test"),D=Object(M);if("string"==typeof M||"[object Symbol]"!==Object.prototype.toString.call(M)||"[object Symbol]"!==Object.prototype.toString.call(D))return!1;for(M in v[M]=42,v)return!1;if("function"==typeof Object.keys&&0!==Object.keys(v).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(v).length)return!1;var T=Object.getOwnPropertySymbols(v);if(1!==T.length||T[0]!==M||!Object.prototype.propertyIsEnumerable.call(v,M))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var w=Object.getOwnPropertyDescriptor(v,M);if(42!==w.value||!0!==w.enumerable)return!1}return!0}},46259:(q,H,v)=>{"use strict";var M=v(81983);q.exports=function(){return M()&&!!Symbol.toStringTag}},93164:(q,H,v)=>{"use strict";var M=v(86740);q.exports=M.call(Function.call,Object.prototype.hasOwnProperty)},13407:(q,H,v)=>{"use strict";var M=v(46259)(),d=v(75834)("Object.prototype.toString"),T=function(P){return!(M&&P&&"object"==typeof P&&Symbol.toStringTag in P)&&"[object Arguments]"===d(P)},w=function(P){return!!T(P)||null!==P&&"object"==typeof P&&"number"==typeof P.length&&P.length>=0&&"[object Array]"!==d(P)&&"[object Function]"===d(P.callee)},y=function(){return T(arguments)}();T.isLegacyArguments=w,q.exports=y?T:w},42374:(q,H,v)=>{"use strict";var M=Date.prototype.getDay,d=Object.prototype.toString,w=v(46259)();q.exports=function(S){return"object"==typeof S&&null!==S&&(w?function(S){try{return M.call(S),!0}catch{return!1}}(S):"[object Date]"===d.call(S))}},82342:(q,H,v)=>{"use strict";var d,T,w,y,M=v(75834),D=v(46259)();if(D){d=M("Object.prototype.hasOwnProperty"),T=M("RegExp.prototype.exec"),w={};var S=function(){throw w};y={toString:S,valueOf:S},"symbol"==typeof Symbol.toPrimitive&&(y[Symbol.toPrimitive]=S)}var P=M("Object.prototype.toString"),E=Object.getOwnPropertyDescriptor;q.exports=D?function(I){if(!I||"object"!=typeof I)return!1;var U=E(I,"lastIndex");if(!U||!d(U,"value"))return!1;try{T(I,y)}catch(W){return W===w}}:function(I){return!(!I||"object"!=typeof I&&"function"!=typeof I)&&"[object RegExp]"===P(I)}},37244:(q,H,v)=>{var d=v(53436)(v(12119),"DataView");q.exports=d},54994:(q,H,v)=>{var M=v(64312),D=v(46421),d=v(15764),T=v(18685),w=v(26676);function y(S){var P=-1,E=null==S?0:S.length;for(this.clear();++P<E;){var Z=S[P];this.set(Z[0],Z[1])}}y.prototype.clear=M,y.prototype.delete=D,y.prototype.get=d,y.prototype.has=T,y.prototype.set=w,q.exports=y},9215:(q,H,v)=>{var M=v(41840),D=v(34378),d=v(54981),T=v(67343),w=v(98895);function y(S){var P=-1,E=null==S?0:S.length;for(this.clear();++P<E;){var Z=S[P];this.set(Z[0],Z[1])}}y.prototype.clear=M,y.prototype.delete=D,y.prototype.get=d,y.prototype.has=T,y.prototype.set=w,q.exports=y},51501:(q,H,v)=>{var d=v(53436)(v(12119),"Map");q.exports=d},99850:(q,H,v)=>{var M=v(10638),D=v(11184),d=v(70866),T=v(43771),w=v(51772);function y(S){var P=-1,E=null==S?0:S.length;for(this.clear();++P<E;){var Z=S[P];this.set(Z[0],Z[1])}}y.prototype.clear=M,y.prototype.delete=D,y.prototype.get=d,y.prototype.has=T,y.prototype.set=w,q.exports=y},44267:(q,H,v)=>{var d=v(53436)(v(12119),"Promise");q.exports=d},46323:(q,H,v)=>{var d=v(53436)(v(12119),"Set");q.exports=d},58849:(q,H,v)=>{var M=v(99850),D=v(4600),d=v(31387);function T(w){var y=-1,S=null==w?0:w.length;for(this.__data__=new M;++y<S;)this.add(w[y])}T.prototype.add=T.prototype.push=D,T.prototype.has=d,q.exports=T},2858:(q,H,v)=>{var M=v(9215),D=v(13720),d=v(64410),T=v(45576),w=v(22247),y=v(41585);function S(P){var E=this.__data__=new M(P);this.size=E.size}S.prototype.clear=D,S.prototype.delete=d,S.prototype.get=T,S.prototype.has=w,S.prototype.set=y,q.exports=S},60443:(q,H,v)=>{var M=v(12119);q.exports=M.Symbol},73457:(q,H,v)=>{var M=v(12119);q.exports=M.Uint8Array},24243:(q,H,v)=>{var d=v(53436)(v(12119),"WeakMap");q.exports=d},26999:q=>{q.exports=function H(v,M,D){switch(D.length){case 0:return v.call(M);case 1:return v.call(M,D[0]);case 2:return v.call(M,D[0],D[1]);case 3:return v.call(M,D[0],D[1],D[2])}return v.apply(M,D)}},96837:q=>{q.exports=function H(v,M){for(var D=-1,d=null==v?0:v.length;++D<d&&!1!==M(v[D],D,v););return v}},69779:q=>{q.exports=function H(v,M){for(var D=-1,d=null==v?0:v.length,T=0,w=[];++D<d;){var y=v[D];M(y,D,v)&&(w[T++]=y)}return w}},61253:(q,H,v)=>{var M=v(14164);q.exports=function D(d,T){return!(null==d||!d.length)&&M(d,T,0)>-1}},37609:q=>{q.exports=function H(v,M,D){for(var d=-1,T=null==v?0:v.length;++d<T;)if(D(M,v[d]))return!0;return!1}},72271:(q,H,v)=>{var M=v(85334),D=v(77151),d=v(21503),T=v(80891),w=v(58442),y=v(48159),P=Object.prototype.hasOwnProperty;q.exports=function E(Z,A){var I=d(Z),U=!I&&D(Z),Q=!I&&!U&&T(Z),W=!I&&!U&&!Q&&y(Z),le=I||U||Q||W,e=le?M(Z.length,String):[],de=e.length;for(var he in Z)(A||P.call(Z,he))&&(!le||!("length"==he||Q&&("offset"==he||"parent"==he)||W&&("buffer"==he||"byteLength"==he||"byteOffset"==he)||w(he,de)))&&e.push(he);return e}},84633:q=>{q.exports=function H(v,M){for(var D=-1,d=null==v?0:v.length,T=Array(d);++D<d;)T[D]=M(v[D],D,v);return T}},85059:q=>{q.exports=function H(v,M){for(var D=-1,d=M.length,T=v.length;++D<d;)v[T+D]=M[D];return v}},8745:q=>{q.exports=function H(v,M,D,d){var T=-1,w=null==v?0:v.length;for(d&&w&&(D=v[++T]);++T<w;)D=M(D,v[T],T,v);return D}},79503:q=>{q.exports=function H(v,M){for(var D=-1,d=null==v?0:v.length;++D<d;)if(M(v[D],D,v))return!0;return!1}},75481:(q,H,v)=>{var D=v(11847)("length");q.exports=D},30583:(q,H,v)=>{var M=v(85683),D=v(20217);q.exports=function d(T,w,y){(void 0!==y&&!D(T[w],y)||void 0===y&&!(w in T))&&M(T,w,y)}},89719:(q,H,v)=>{var M=v(85683),D=v(20217),T=Object.prototype.hasOwnProperty;q.exports=function w(y,S,P){var E=y[S];(!T.call(y,S)||!D(E,P)||void 0===P&&!(S in y))&&M(y,S,P)}},43503:(q,H,v)=>{var M=v(20217);q.exports=function D(d,T){for(var w=d.length;w--;)if(M(d[w][0],T))return w;return-1}},94121:(q,H,v)=>{var M=v(31989),D=v(118);q.exports=function d(T,w){return T&&M(w,D(w),T)}},99287:(q,H,v)=>{var M=v(31989),D=v(16555);q.exports=function d(T,w){return T&&M(w,D(w),T)}},85683:(q,H,v)=>{var M=v(56713);q.exports=function D(d,T,w){"__proto__"==T&&M?M(d,T,{configurable:!0,enumerable:!0,value:w,writable:!0}):d[T]=w}},44462:(q,H,v)=>{var M=v(2858),D=v(96837),d=v(89719),T=v(94121),w=v(99287),y=v(19292),S=v(99454),P=v(84444),E=v(59905),Z=v(47597),A=v(6967),I=v(28794),U=v(76782),Q=v(37878),W=v(4264),le=v(21503),e=v(80891),de=v(13222),he=v(25940),ke=v(90799),Le=v(118),Ue=v(16555),ie="[object Arguments]",Ne="[object Function]",mt="[object Object]",yi={};yi[ie]=yi["[object Array]"]=yi["[object ArrayBuffer]"]=yi["[object DataView]"]=yi["[object Boolean]"]=yi["[object Date]"]=yi["[object Float32Array]"]=yi["[object Float64Array]"]=yi["[object Int8Array]"]=yi["[object Int16Array]"]=yi["[object Int32Array]"]=yi["[object Map]"]=yi["[object Number]"]=yi[mt]=yi["[object RegExp]"]=yi["[object Set]"]=yi["[object String]"]=yi["[object Symbol]"]=yi["[object Uint8Array]"]=yi["[object Uint8ClampedArray]"]=yi["[object Uint16Array]"]=yi["[object Uint32Array]"]=!0,yi["[object Error]"]=yi[Ne]=yi["[object WeakMap]"]=!1,q.exports=function Di(gi,Ni,Mo,No,vr,Oo){var So,ra=1&Ni,aa=2&Ni,bo=4&Ni;if(Mo&&(So=vr?Mo(gi,No,vr,Oo):Mo(gi)),void 0!==So)return So;if(!he(gi))return gi;var tr=le(gi);if(tr){if(So=U(gi),!ra)return S(gi,So)}else{var lo=I(gi),Po=lo==Ne||"[object GeneratorFunction]"==lo;if(e(gi))return y(gi,ra);if(lo==mt||lo==ie||Po&&!vr){if(So=aa||Po?{}:W(gi),!ra)return aa?E(gi,w(So,gi)):P(gi,T(So,gi))}else{if(!yi[lo])return vr?gi:{};So=Q(gi,lo,ra)}}Oo||(Oo=new M);var xa=Oo.get(gi);if(xa)return xa;Oo.set(gi,So),ke(gi)?gi.forEach(function(Bn){So.add(Di(Bn,Ni,Mo,Bn,gi,Oo))}):de(gi)&&gi.forEach(function(Bn,br){So.set(br,Di(Bn,Ni,Mo,br,gi,Oo))});var Eo=tr?void 0:(bo?aa?A:Z:aa?Ue:Le)(gi);return D(Eo||gi,function(Bn,br){Eo&&(Bn=gi[br=Bn]),d(So,br,Di(Bn,Ni,Mo,br,gi,Oo))}),So}},78858:(q,H,v)=>{var M=v(25940),D=Object.create,d=function(){function T(){}return function(w){if(!M(w))return{};if(D)return D(w);T.prototype=w;var y=new T;return T.prototype=void 0,y}}();q.exports=d},43132:(q,H,v)=>{var M=v(45184),d=v(16539)(M);q.exports=d},67308:(q,H,v)=>{var M=v(44129);q.exports=function D(d,T,w){for(var y=-1,S=d.length;++y<S;){var P=d[y],E=T(P);if(null!=E&&(void 0===Z?E==E&&!M(E):w(E,Z)))var Z=E,A=P}return A}},33609:(q,H,v)=>{var M=v(43132);q.exports=function D(d,T){var w=[];return M(d,function(y,S,P){T(y,S,P)&&w.push(y)}),w}},65317:q=>{q.exports=function H(v,M,D,d){for(var T=v.length,w=D+(d?1:-1);d?w--:++w<T;)if(M(v[w],w,v))return w;return-1}},50686:(q,H,v)=>{var M=v(85059),D=v(75039);q.exports=function d(T,w,y,S,P){var E=-1,Z=T.length;for(y||(y=D),P||(P=[]);++E<Z;){var A=T[E];w>0&&y(A)?w>1?d(A,w-1,y,S,P):M(P,A):S||(P[P.length]=A)}return P}},30755:(q,H,v)=>{var D=v(40456)();q.exports=D},45184:(q,H,v)=>{var M=v(30755),D=v(118);q.exports=function d(T,w){return T&&M(T,w,D)}},15456:(q,H,v)=>{var M=v(65456),D=v(68533);q.exports=function d(T,w){for(var y=0,S=(w=M(w,T)).length;null!=T&&y<S;)T=T[D(w[y++])];return y&&y==S?T:void 0}},38247:(q,H,v)=>{var M=v(85059),D=v(21503);q.exports=function d(T,w,y){var S=w(T);return D(T)?S:M(S,y(T))}},93337:(q,H,v)=>{var M=v(60443),D=v(21318),d=v(92902),y=M?M.toStringTag:void 0;q.exports=function S(P){return null==P?void 0===P?"[object Undefined]":"[object Null]":y&&y in Object(P)?D(P):d(P)}},31100:q=>{q.exports=function H(v,M){return v>M}},84781:q=>{var v=Object.prototype.hasOwnProperty;q.exports=function M(D,d){return null!=D&&v.call(D,d)}},69989:q=>{q.exports=function H(v,M){return null!=v&&M in Object(v)}},14164:(q,H,v)=>{var M=v(65317),D=v(70968),d=v(24977);q.exports=function T(w,y,S){return y==y?d(w,y,S):M(w,D,S)}},60186:(q,H,v)=>{var M=v(93337),D=v(72671);q.exports=function T(w){return D(w)&&"[object Arguments]"==M(w)}},85740:(q,H,v)=>{var M=v(58325),D=v(72671);q.exports=function d(T,w,y,S,P){return T===w||(null==T||null==w||!D(T)&&!D(w)?T!=T&&w!=w:M(T,w,y,S,d,P))}},58325:(q,H,v)=>{var M=v(2858),D=v(63914),d=v(78583),T=v(32286),w=v(28794),y=v(21503),S=v(80891),P=v(48159),Z="[object Arguments]",A="[object Array]",I="[object Object]",Q=Object.prototype.hasOwnProperty;q.exports=function W(le,e,de,he,ke,Le){var Ue=y(le),Ie=y(e),je=Ue?A:w(le),X=Ie?A:w(e),ie=(je=je==Z?I:je)==I,oe=(X=X==Z?I:X)==I,ae=je==X;if(ae&&S(le)){if(!S(e))return!1;Ue=!0,ie=!1}if(ae&&!ie)return Le||(Le=new M),Ue||P(le)?D(le,e,de,he,ke,Le):d(le,e,je,de,he,ke,Le);if(!(1&de)){var pe=ie&&Q.call(le,"__wrapped__"),xe=oe&&Q.call(e,"__wrapped__");if(pe||xe){var Ne=pe?le.value():le,we=xe?e.value():e;return Le||(Le=new M),ke(Ne,we,de,he,Le)}}return!!ae&&(Le||(Le=new M),T(le,e,de,he,ke,Le))}},97021:(q,H,v)=>{var M=v(28794),D=v(72671);q.exports=function T(w){return D(w)&&"[object Map]"==M(w)}},40431:(q,H,v)=>{var M=v(2858),D=v(85740);q.exports=function w(y,S,P,E){var Z=P.length,A=Z,I=!E;if(null==y)return!A;for(y=Object(y);Z--;){var U=P[Z];if(I&&U[2]?U[1]!==y[U[0]]:!(U[0]in y))return!1}for(;++Z<A;){var Q=(U=P[Z])[0],W=y[Q],le=U[1];if(I&&U[2]){if(void 0===W&&!(Q in y))return!1}else{var e=new M;if(E)var de=E(W,le,Q,y,S,e);if(!(void 0===de?D(le,W,3,E,e):de))return!1}}return!0}},70968:q=>{q.exports=function H(v){return v!=v}},37304:(q,H,v)=>{var M=v(75946),D=v(91943),d=v(25940),T=v(52827),y=/^\[object .+?Constructor\]$/,A=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");q.exports=function I(U){return!(!d(U)||D(U))&&(M(U)?A:y).test(T(U))}},771:(q,H,v)=>{var M=v(28794),D=v(72671);q.exports=function T(w){return D(w)&&"[object Set]"==M(w)}},1083:(q,H,v)=>{var M=v(93337),D=v(96231),d=v(72671),ae={};ae["[object Float32Array]"]=ae["[object Float64Array]"]=ae["[object Int8Array]"]=ae["[object Int16Array]"]=ae["[object Int32Array]"]=ae["[object Uint8Array]"]=ae["[object Uint8ClampedArray]"]=ae["[object Uint16Array]"]=ae["[object Uint32Array]"]=!0,ae["[object Arguments]"]=ae["[object Array]"]=ae["[object ArrayBuffer]"]=ae["[object Boolean]"]=ae["[object DataView]"]=ae["[object Date]"]=ae["[object Error]"]=ae["[object Function]"]=ae["[object Map]"]=ae["[object Number]"]=ae["[object Object]"]=ae["[object RegExp]"]=ae["[object Set]"]=ae["[object String]"]=ae["[object WeakMap]"]=!1,q.exports=function pe(xe){return d(xe)&&D(xe.length)&&!!ae[M(xe)]}},96517:(q,H,v)=>{var M=v(98133),D=v(9458),d=v(32608),T=v(21503),w=v(87495);q.exports=function y(S){return"function"==typeof S?S:null==S?d:"object"==typeof S?T(S)?D(S[0],S[1]):M(S):w(S)}},81172:(q,H,v)=>{var M=v(45488),D=v(85491),T=Object.prototype.hasOwnProperty;q.exports=function w(y){if(!M(y))return D(y);var S=[];for(var P in Object(y))T.call(y,P)&&"constructor"!=P&&S.push(P);return S}},92809:(q,H,v)=>{var M=v(25940),D=v(45488),d=v(32158),w=Object.prototype.hasOwnProperty;q.exports=function y(S){if(!M(S))return d(S);var P=D(S),E=[];for(var Z in S)"constructor"==Z&&(P||!w.call(S,Z))||E.push(Z);return E}},99069:q=>{q.exports=function H(v,M){return v<M}},92046:(q,H,v)=>{var M=v(43132),D=v(56507);q.exports=function d(T,w){var y=-1,S=D(T)?Array(T.length):[];return M(T,function(P,E,Z){S[++y]=w(P,E,Z)}),S}},98133:(q,H,v)=>{var M=v(40431),D=v(22379),d=v(642);q.exports=function T(w){var y=D(w);return 1==y.length&&y[0][2]?d(y[0][0],y[0][1]):function(S){return S===w||M(S,w,y)}}},9458:(q,H,v)=>{var M=v(85740),D=v(8817),d=v(11172),T=v(45352),w=v(22442),y=v(642),S=v(68533);q.exports=function Z(A,I){return T(A)&&w(I)?y(S(A),I):function(U){var Q=D(U,A);return void 0===Q&&Q===I?d(U,A):M(I,Q,3)}}},73842:(q,H,v)=>{var M=v(2858),D=v(30583),d=v(30755),T=v(33675),w=v(25940),y=v(16555),S=v(99351);q.exports=function P(E,Z,A,I,U){E!==Z&&d(Z,function(Q,W){if(U||(U=new M),w(Q))T(E,Z,W,A,P,I,U);else{var le=I?I(S(E,W),Q,W+"",E,Z,U):void 0;void 0===le&&(le=Q),D(E,W,le)}},y)}},33675:(q,H,v)=>{var M=v(30583),D=v(19292),d=v(65208),T=v(99454),w=v(4264),y=v(77151),S=v(21503),P=v(21330),E=v(80891),Z=v(75946),A=v(25940),I=v(97614),U=v(48159),Q=v(99351),W=v(8067);q.exports=function le(e,de,he,ke,Le,Ue,Ie){var je=Q(e,he),X=Q(de,he),ie=Ie.get(X);if(ie)M(e,he,ie);else{var oe=Ue?Ue(je,X,he+"",e,de,Ie):void 0,ae=void 0===oe;if(ae){var pe=S(X),xe=!pe&&E(X),Ne=!pe&&!xe&&U(X);oe=X,pe||xe||Ne?S(je)?oe=je:P(je)?oe=T(je):xe?(ae=!1,oe=D(X,!0)):Ne?(ae=!1,oe=d(X,!0)):oe=[]:I(X)||y(X)?(oe=je,y(je)?oe=W(je):(!A(je)||Z(je))&&(oe=w(X))):ae=!1}ae&&(Ie.set(X,oe),Le(oe,X,ke,Ue,Ie),Ie.delete(X)),M(e,he,oe)}}},6119:(q,H,v)=>{var M=v(84633),D=v(15456),d=v(96517),T=v(92046),w=v(18750),y=v(85647),S=v(41215),P=v(32608),E=v(21503);q.exports=function Z(A,I,U){I=I.length?M(I,function(le){return E(le)?function(e){return D(e,1===le.length?le[0]:le)}:le}):[P];var Q=-1;I=M(I,y(d));var W=T(A,function(le,e,de){return{criteria:M(I,function(ke){return ke(le)}),index:++Q,value:le}});return w(W,function(le,e){return S(le,e,U)})}},83021:(q,H,v)=>{var M=v(95495),D=v(11172);q.exports=function d(T,w){return M(T,w,function(y,S){return D(T,S)})}},95495:(q,H,v)=>{var M=v(15456),D=v(55963),d=v(65456);q.exports=function T(w,y,S){for(var P=-1,E=y.length,Z={};++P<E;){var A=y[P],I=M(w,A);S(I,A)&&D(Z,d(A,w),I)}return Z}},11847:q=>{q.exports=function H(v){return function(M){return M?.[v]}}},39222:(q,H,v)=>{var M=v(15456);q.exports=function D(d){return function(T){return M(T,d)}}},16307:q=>{var H=Math.ceil,v=Math.max;q.exports=function M(D,d,T,w){for(var y=-1,S=v(H((d-D)/(T||1)),0),P=Array(S);S--;)P[w?S:++y]=D,D+=T;return P}},13570:q=>{q.exports=function H(v,M,D,d,T){return T(v,function(w,y,S){D=d?(d=!1,w):M(D,w,y,S)}),D}},23269:(q,H,v)=>{var M=v(32608),D=v(53983),d=v(72185);q.exports=function T(w,y){return d(D(w,y,M),w+"")}},55963:(q,H,v)=>{var M=v(89719),D=v(65456),d=v(58442),T=v(25940),w=v(68533);q.exports=function y(S,P,E,Z){if(!T(S))return S;for(var A=-1,I=(P=D(P,S)).length,U=I-1,Q=S;null!=Q&&++A<I;){var W=w(P[A]),le=E;if("__proto__"===W||"constructor"===W||"prototype"===W)return S;if(A!=U){var e=Q[W];void 0===(le=Z?Z(e,W,Q):void 0)&&(le=T(e)?e:d(P[A+1])?[]:{})}M(Q,W,le),Q=Q[W]}return S}},69510:(q,H,v)=>{var M=v(76684),D=v(56713),d=v(32608);q.exports=D?function(w,y){return D(w,"toString",{configurable:!0,enumerable:!1,value:M(y),writable:!0})}:d},18750:q=>{q.exports=function H(v,M){var D=v.length;for(v.sort(M);D--;)v[D]=v[D].value;return v}},85334:q=>{q.exports=function H(v,M){for(var D=-1,d=Array(v);++D<v;)d[D]=M(D);return d}},93935:(q,H,v)=>{var M=v(60443),D=v(84633),d=v(21503),T=v(44129),y=M?M.prototype:void 0,S=y?y.toString:void 0;q.exports=function P(E){if("string"==typeof E)return E;if(d(E))return D(E,P)+"";if(T(E))return S?S.call(E):"";var Z=E+"";return"0"==Z&&1/E==-1/0?"-0":Z}},83348:(q,H,v)=>{var M=v(42760),D=/^\s+/;q.exports=function d(T){return T&&T.slice(0,M(T)+1).replace(D,"")}},85647:q=>{q.exports=function H(v){return function(M){return v(M)}}},80707:(q,H,v)=>{var M=v(58849),D=v(61253),d=v(37609),T=v(25972),w=v(14575),y=v(24174);q.exports=function P(E,Z,A){var I=-1,U=D,Q=E.length,W=!0,le=[],e=le;if(A)W=!1,U=d;else if(Q>=200){var de=Z?null:w(E);if(de)return y(de);W=!1,U=T,e=new M}else e=Z?[]:le;e:for(;++I<Q;){var he=E[I],ke=Z?Z(he):he;if(he=A||0!==he?he:0,W&&ke==ke){for(var Le=e.length;Le--;)if(e[Le]===ke)continue e;Z&&e.push(ke),le.push(he)}else U(e,ke,A)||(e!==le&&e.push(ke),le.push(he))}return le}},19179:(q,H,v)=>{var M=v(84633);q.exports=function D(d,T){return M(T,function(w){return d[w]})}},38645:q=>{q.exports=function H(v,M,D){for(var d=-1,T=v.length,w=M.length,y={};++d<T;)D(y,v[d],d<w?M[d]:void 0);return y}},25972:q=>{q.exports=function H(v,M){return v.has(M)}},21481:(q,H,v)=>{var M=v(32608);q.exports=function D(d){return"function"==typeof d?d:M}},65456:(q,H,v)=>{var M=v(21503),D=v(45352),d=v(32855),T=v(73943);q.exports=function w(y,S){return M(y)?y:D(y,S)?[y]:d(T(y))}},43362:(q,H,v)=>{var M=v(73457);q.exports=function D(d){var T=new d.constructor(d.byteLength);return new M(T).set(new M(d)),T}},19292:(q,H,v)=>{q=v.nmd(q);var M=v(12119),D=H&&!H.nodeType&&H,d=D&&q&&!q.nodeType&&q,w=d&&d.exports===D?M.Buffer:void 0,y=w?w.allocUnsafe:void 0;q.exports=function S(P,E){if(E)return P.slice();var Z=P.length,A=y?y(Z):new P.constructor(Z);return P.copy(A),A}},17e3:(q,H,v)=>{var M=v(43362);q.exports=function D(d,T){var w=T?M(d.buffer):d.buffer;return new d.constructor(w,d.byteOffset,d.byteLength)}},74098:q=>{var H=/\w*$/;q.exports=function v(M){var D=new M.constructor(M.source,H.exec(M));return D.lastIndex=M.lastIndex,D}},62533:(q,H,v)=>{var M=v(60443),D=M?M.prototype:void 0,d=D?D.valueOf:void 0;q.exports=function T(w){return d?Object(d.call(w)):{}}},65208:(q,H,v)=>{var M=v(43362);q.exports=function D(d,T){var w=T?M(d.buffer):d.buffer;return new d.constructor(w,d.byteOffset,d.length)}},13443:(q,H,v)=>{var M=v(44129);q.exports=function D(d,T){if(d!==T){var w=void 0!==d,y=null===d,S=d==d,P=M(d),E=void 0!==T,Z=null===T,A=T==T,I=M(T);if(!Z&&!I&&!P&&d>T||P&&E&&A&&!Z&&!I||y&&E&&A||!w&&A||!S)return 1;if(!y&&!P&&!I&&d<T||I&&w&&S&&!y&&!P||Z&&w&&S||!E&&S||!A)return-1}return 0}},41215:(q,H,v)=>{var M=v(13443);q.exports=function D(d,T,w){for(var y=-1,S=d.criteria,P=T.criteria,E=S.length,Z=w.length;++y<E;){var A=M(S[y],P[y]);if(A)return y>=Z?A:A*("desc"==w[y]?-1:1)}return d.index-T.index}},99454:q=>{q.exports=function H(v,M){var D=-1,d=v.length;for(M||(M=Array(d));++D<d;)M[D]=v[D];return M}},31989:(q,H,v)=>{var M=v(89719),D=v(85683);q.exports=function d(T,w,y,S){var P=!y;y||(y={});for(var E=-1,Z=w.length;++E<Z;){var A=w[E],I=S?S(y[A],T[A],A,y,T):void 0;void 0===I&&(I=T[A]),P?D(y,A,I):M(y,A,I)}return y}},84444:(q,H,v)=>{var M=v(31989),D=v(39383);q.exports=function d(T,w){return M(T,D(T),w)}},59905:(q,H,v)=>{var M=v(31989),D=v(53051);q.exports=function d(T,w){return M(T,D(T),w)}},24610:(q,H,v)=>{var M=v(12119);q.exports=M["__core-js_shared__"]},84944:(q,H,v)=>{var M=v(23269),D=v(93342);q.exports=function d(T){return M(function(w,y){var S=-1,P=y.length,E=P>1?y[P-1]:void 0,Z=P>2?y[2]:void 0;for(E=T.length>3&&"function"==typeof E?(P--,E):void 0,Z&&D(y[0],y[1],Z)&&(E=P<3?void 0:E,P=1),w=Object(w);++S<P;){var A=y[S];A&&T(w,A,S,E)}return w})}},16539:(q,H,v)=>{var M=v(56507);q.exports=function D(d,T){return function(w,y){if(null==w)return w;if(!M(w))return d(w,y);for(var S=w.length,P=T?S:-1,E=Object(w);(T?P--:++P<S)&&!1!==y(E[P],P,E););return w}}},40456:q=>{q.exports=function H(v){return function(M,D,d){for(var T=-1,w=Object(M),y=d(M),S=y.length;S--;){var P=y[v?S:++T];if(!1===D(w[P],P,w))break}return M}}},24653:(q,H,v)=>{var M=v(96517),D=v(56507),d=v(118);q.exports=function T(w){return function(y,S,P){var E=Object(y);if(!D(y)){var Z=M(S,3);y=d(y),S=function(I){return Z(E[I],I,E)}}var A=w(y,S,P);return A>-1?E[Z?y[A]:A]:void 0}}},97509:(q,H,v)=>{var M=v(16307),D=v(93342),d=v(12232);q.exports=function T(w){return function(y,S,P){return P&&"number"!=typeof P&&D(y,S,P)&&(S=P=void 0),y=d(y),void 0===S?(S=y,y=0):S=d(S),P=void 0===P?y<S?1:-1:d(P),M(y,S,P,w)}}},14575:(q,H,v)=>{var M=v(46323),D=v(12552),d=v(24174),w=M&&1/d(new M([,-0]))[1]==1/0?function(y){return new M(y)}:D;q.exports=w},56713:(q,H,v)=>{var M=v(53436),D=function(){try{var d=M(Object,"defineProperty");return d({},"",{}),d}catch{}}();q.exports=D},63914:(q,H,v)=>{var M=v(58849),D=v(79503),d=v(25972);q.exports=function y(S,P,E,Z,A,I){var U=1&E,Q=S.length,W=P.length;if(Q!=W&&!(U&&W>Q))return!1;var le=I.get(S),e=I.get(P);if(le&&e)return le==P&&e==S;var de=-1,he=!0,ke=2&E?new M:void 0;for(I.set(S,P),I.set(P,S);++de<Q;){var Le=S[de],Ue=P[de];if(Z)var Ie=U?Z(Ue,Le,de,P,S,I):Z(Le,Ue,de,S,P,I);if(void 0!==Ie){if(Ie)continue;he=!1;break}if(ke){if(!D(P,function(je,X){if(!d(ke,X)&&(Le===je||A(Le,je,E,Z,I)))return ke.push(X)})){he=!1;break}}else if(Le!==Ue&&!A(Le,Ue,E,Z,I)){he=!1;break}}return I.delete(S),I.delete(P),he}},78583:(q,H,v)=>{var M=v(60443),D=v(73457),d=v(20217),T=v(63914),w=v(83205),y=v(24174),ke=M?M.prototype:void 0,Le=ke?ke.valueOf:void 0;q.exports=function Ue(Ie,je,X,ie,oe,ae,pe){switch(X){case"[object DataView]":if(Ie.byteLength!=je.byteLength||Ie.byteOffset!=je.byteOffset)return!1;Ie=Ie.buffer,je=je.buffer;case"[object ArrayBuffer]":return!(Ie.byteLength!=je.byteLength||!ae(new D(Ie),new D(je)));case"[object Boolean]":case"[object Date]":case"[object Number]":return d(+Ie,+je);case"[object Error]":return Ie.name==je.name&&Ie.message==je.message;case"[object RegExp]":case"[object String]":return Ie==je+"";case"[object Map]":var xe=w;case"[object Set]":if(xe||(xe=y),Ie.size!=je.size&&!(1&ie))return!1;var we=pe.get(Ie);if(we)return we==je;ie|=2,pe.set(Ie,je);var me=T(xe(Ie),xe(je),ie,oe,ae,pe);return pe.delete(Ie),me;case"[object Symbol]":if(Le)return Le.call(Ie)==Le.call(je)}return!1}},32286:(q,H,v)=>{var M=v(47597),T=Object.prototype.hasOwnProperty;q.exports=function w(y,S,P,E,Z,A){var I=1&P,U=M(y),Q=U.length;if(Q!=M(S).length&&!I)return!1;for(var e=Q;e--;){var de=U[e];if(!(I?de in S:T.call(S,de)))return!1}var he=A.get(y),ke=A.get(S);if(he&&ke)return he==S&&ke==y;var Le=!0;A.set(y,S),A.set(S,y);for(var Ue=I;++e<Q;){var Ie=y[de=U[e]],je=S[de];if(E)var X=I?E(je,Ie,de,S,y,A):E(Ie,je,de,y,S,A);if(!(void 0===X?Ie===je||Z(Ie,je,P,E,A):X)){Le=!1;break}Ue||(Ue="constructor"==de)}if(Le&&!Ue){var ie=y.constructor,oe=S.constructor;ie!=oe&&"constructor"in y&&"constructor"in S&&!("function"==typeof ie&&ie instanceof ie&&"function"==typeof oe&&oe instanceof oe)&&(Le=!1)}return A.delete(y),A.delete(S),Le}},3975:(q,H,v)=>{var M=v(22274),D=v(53983),d=v(72185);q.exports=function T(w){return d(D(w,void 0,M),w+"")}},79122:q=>{var H="object"==typeof global&&global&&global.Object===Object&&global;q.exports=H},47597:(q,H,v)=>{var M=v(38247),D=v(39383),d=v(118);q.exports=function T(w){return M(w,d,D)}},6967:(q,H,v)=>{var M=v(38247),D=v(53051),d=v(16555);q.exports=function T(w){return M(w,d,D)}},54537:(q,H,v)=>{var M=v(23819);q.exports=function D(d,T){var w=d.__data__;return M(T)?w["string"==typeof T?"string":"hash"]:w.map}},22379:(q,H,v)=>{var M=v(22442),D=v(118);q.exports=function d(T){for(var w=D(T),y=w.length;y--;){var S=w[y],P=T[S];w[y]=[S,P,M(P)]}return w}},53436:(q,H,v)=>{var M=v(37304),D=v(51990);q.exports=function d(T,w){var y=D(T,w);return M(y)?y:void 0}},29519:(q,H,v)=>{var D=v(69385)(Object.getPrototypeOf,Object);q.exports=D},21318:(q,H,v)=>{var M=v(60443),D=Object.prototype,d=D.hasOwnProperty,T=D.toString,w=M?M.toStringTag:void 0;q.exports=function y(S){var P=d.call(S,w),E=S[w];try{S[w]=void 0;var Z=!0}catch{}var A=T.call(S);return Z&&(P?S[w]=E:delete S[w]),A}},39383:(q,H,v)=>{var M=v(69779),D=v(49975),T=Object.prototype.propertyIsEnumerable,w=Object.getOwnPropertySymbols;q.exports=w?function(S){return null==S?[]:(S=Object(S),M(w(S),function(P){return T.call(S,P)}))}:D},53051:(q,H,v)=>{var M=v(85059),D=v(29519),d=v(39383),T=v(49975);q.exports=Object.getOwnPropertySymbols?function(S){for(var P=[];S;)M(P,d(S)),S=D(S);return P}:T},28794:(q,H,v)=>{var M=v(37244),D=v(51501),d=v(44267),T=v(46323),w=v(24243),y=v(93337),S=v(52827),P="[object Map]",Z="[object Promise]",A="[object Set]",I="[object WeakMap]",U="[object DataView]",Q=S(M),W=S(D),le=S(d),e=S(T),de=S(w),he=y;(M&&he(new M(new ArrayBuffer(1)))!=U||D&&he(new D)!=P||d&&he(d.resolve())!=Z||T&&he(new T)!=A||w&&he(new w)!=I)&&(he=function(ke){var Le=y(ke),Ue="[object Object]"==Le?ke.constructor:void 0,Ie=Ue?S(Ue):"";if(Ie)switch(Ie){case Q:return U;case W:return P;case le:return Z;case e:return A;case de:return I}return Le}),q.exports=he},51990:q=>{q.exports=function H(v,M){return v?.[M]}},47283:(q,H,v)=>{var M=v(65456),D=v(77151),d=v(21503),T=v(58442),w=v(96231),y=v(68533);q.exports=function S(P,E,Z){for(var A=-1,I=(E=M(E,P)).length,U=!1;++A<I;){var Q=y(E[A]);if(!(U=null!=P&&Z(P,Q)))break;P=P[Q]}return U||++A!=I?U:!!(I=null==P?0:P.length)&&w(I)&&T(Q,I)&&(d(P)||D(P))}},77609:q=>{var y=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");q.exports=function S(P){return y.test(P)}},64312:(q,H,v)=>{var M=v(60862);q.exports=function D(){this.__data__=M?M(null):{},this.size=0}},46421:q=>{q.exports=function H(v){var M=this.has(v)&&delete this.__data__[v];return this.size-=M?1:0,M}},15764:(q,H,v)=>{var M=v(60862),T=Object.prototype.hasOwnProperty;q.exports=function w(y){var S=this.__data__;if(M){var P=S[y];return"__lodash_hash_undefined__"===P?void 0:P}return T.call(S,y)?S[y]:void 0}},18685:(q,H,v)=>{var M=v(60862),d=Object.prototype.hasOwnProperty;q.exports=function T(w){var y=this.__data__;return M?void 0!==y[w]:d.call(y,w)}},26676:(q,H,v)=>{var M=v(60862);q.exports=function d(T,w){var y=this.__data__;return this.size+=this.has(T)?0:1,y[T]=M&&void 0===w?"__lodash_hash_undefined__":w,this}},76782:q=>{var v=Object.prototype.hasOwnProperty;q.exports=function M(D){var d=D.length,T=new D.constructor(d);return d&&"string"==typeof D[0]&&v.call(D,"index")&&(T.index=D.index,T.input=D.input),T}},37878:(q,H,v)=>{var M=v(43362),D=v(17e3),d=v(74098),T=v(62533),w=v(65208);q.exports=function X(ie,oe,ae){var pe=ie.constructor;switch(oe){case"[object ArrayBuffer]":return M(ie);case"[object Boolean]":case"[object Date]":return new pe(+ie);case"[object DataView]":return D(ie,ae);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return w(ie,ae);case"[object Map]":case"[object Set]":return new pe;case"[object Number]":case"[object String]":return new pe(ie);case"[object RegExp]":return d(ie);case"[object Symbol]":return T(ie)}}},4264:(q,H,v)=>{var M=v(78858),D=v(29519),d=v(45488);q.exports=function T(w){return"function"!=typeof w.constructor||d(w)?{}:M(D(w))}},75039:(q,H,v)=>{var M=v(60443),D=v(77151),d=v(21503),T=M?M.isConcatSpreadable:void 0;q.exports=function w(y){return d(y)||D(y)||!!(T&&y&&y[T])}},58442:q=>{var v=/^(?:0|[1-9]\d*)$/;q.exports=function M(D,d){var T=typeof D;return!!(d=d??9007199254740991)&&("number"==T||"symbol"!=T&&v.test(D))&&D>-1&&D%1==0&&D<d}},93342:(q,H,v)=>{var M=v(20217),D=v(56507),d=v(58442),T=v(25940);q.exports=function w(y,S,P){if(!T(P))return!1;var E=typeof S;return!!("number"==E?D(P)&&d(S,P.length):"string"==E&&S in P)&&M(P[S],y)}},45352:(q,H,v)=>{var M=v(21503),D=v(44129),d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,T=/^\w*$/;q.exports=function w(y,S){if(M(y))return!1;var P=typeof y;return!("number"!=P&&"symbol"!=P&&"boolean"!=P&&null!=y&&!D(y))||T.test(y)||!d.test(y)||null!=S&&y in Object(S)}},23819:q=>{q.exports=function H(v){var M=typeof v;return"string"==M||"number"==M||"symbol"==M||"boolean"==M?"__proto__"!==v:null===v}},91943:(q,H,v)=>{var T,M=v(24610),D=(T=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"";q.exports=function d(T){return!!D&&D in T}},45488:q=>{var H=Object.prototype;q.exports=function v(M){var D=M&&M.constructor;return M===("function"==typeof D&&D.prototype||H)}},22442:(q,H,v)=>{var M=v(25940);q.exports=function D(d){return d==d&&!M(d)}},41840:q=>{q.exports=function H(){this.__data__=[],this.size=0}},34378:(q,H,v)=>{var M=v(43503),d=Array.prototype.splice;q.exports=function T(w){var y=this.__data__,S=M(y,w);return!(S<0||(S==y.length-1?y.pop():d.call(y,S,1),--this.size,0))}},54981:(q,H,v)=>{var M=v(43503);q.exports=function D(d){var T=this.__data__,w=M(T,d);return w<0?void 0:T[w][1]}},67343:(q,H,v)=>{var M=v(43503);q.exports=function D(d){return M(this.__data__,d)>-1}},98895:(q,H,v)=>{var M=v(43503);q.exports=function D(d,T){var w=this.__data__,y=M(w,d);return y<0?(++this.size,w.push([d,T])):w[y][1]=T,this}},10638:(q,H,v)=>{var M=v(54994),D=v(9215),d=v(51501);q.exports=function T(){this.size=0,this.__data__={hash:new M,map:new(d||D),string:new M}}},11184:(q,H,v)=>{var M=v(54537);q.exports=function D(d){var T=M(this,d).delete(d);return this.size-=T?1:0,T}},70866:(q,H,v)=>{var M=v(54537);q.exports=function D(d){return M(this,d).get(d)}},43771:(q,H,v)=>{var M=v(54537);q.exports=function D(d){return M(this,d).has(d)}},51772:(q,H,v)=>{var M=v(54537);q.exports=function D(d,T){var w=M(this,d),y=w.size;return w.set(d,T),this.size+=w.size==y?0:1,this}},83205:q=>{q.exports=function H(v){var M=-1,D=Array(v.size);return v.forEach(function(d,T){D[++M]=[T,d]}),D}},642:q=>{q.exports=function H(v,M){return function(D){return null!=D&&D[v]===M&&(void 0!==M||v in Object(D))}}},90719:(q,H,v)=>{var M=v(30535);q.exports=function d(T){var w=M(T,function(S){return 500===y.size&&y.clear(),S}),y=w.cache;return w}},60862:(q,H,v)=>{var D=v(53436)(Object,"create");q.exports=D},85491:(q,H,v)=>{var D=v(69385)(Object.keys,Object);q.exports=D},32158:q=>{q.exports=function H(v){var M=[];if(null!=v)for(var D in Object(v))M.push(D);return M}},73597:(q,H,v)=>{q=v.nmd(q);var M=v(79122),D=H&&!H.nodeType&&H,d=D&&q&&!q.nodeType&&q,w=d&&d.exports===D&&M.process,y=function(){try{return d&&d.require&&d.require("util").types||w&&w.binding&&w.binding("util")}catch{}}();q.exports=y},92902:q=>{var v=Object.prototype.toString;q.exports=function M(D){return v.call(D)}},69385:q=>{q.exports=function H(v,M){return function(D){return v(M(D))}}},53983:(q,H,v)=>{var M=v(26999),D=Math.max;q.exports=function d(T,w,y){return w=D(void 0===w?T.length-1:w,0),function(){for(var S=arguments,P=-1,E=D(S.length-w,0),Z=Array(E);++P<E;)Z[P]=S[w+P];P=-1;for(var A=Array(w+1);++P<w;)A[P]=S[P];return A[w]=y(Z),M(T,this,A)}}},12119:(q,H,v)=>{var M=v(79122),D="object"==typeof self&&self&&self.Object===Object&&self,d=M||D||Function("return this")();q.exports=d},99351:q=>{q.exports=function H(v,M){if(("constructor"!==M||"function"!=typeof v[M])&&"__proto__"!=M)return v[M]}},4600:q=>{q.exports=function v(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this}},31387:q=>{q.exports=function H(v){return this.__data__.has(v)}},24174:q=>{q.exports=function H(v){var M=-1,D=Array(v.size);return v.forEach(function(d){D[++M]=d}),D}},72185:(q,H,v)=>{var M=v(69510),d=v(10029)(M);q.exports=d},10029:q=>{var M=Date.now;q.exports=function D(d){var T=0,w=0;return function(){var y=M(),S=16-(y-w);if(w=y,S>0){if(++T>=800)return arguments[0]}else T=0;return d.apply(void 0,arguments)}}},13720:(q,H,v)=>{var M=v(9215);q.exports=function D(){this.__data__=new M,this.size=0}},64410:q=>{q.exports=function H(v){var M=this.__data__,D=M.delete(v);return this.size=M.size,D}},45576:q=>{q.exports=function H(v){return this.__data__.get(v)}},22247:q=>{q.exports=function H(v){return this.__data__.has(v)}},41585:(q,H,v)=>{var M=v(9215),D=v(51501),d=v(99850);q.exports=function w(y,S){var P=this.__data__;if(P instanceof M){var E=P.__data__;if(!D||E.length<199)return E.push([y,S]),this.size=++P.size,this;P=this.__data__=new d(E)}return P.set(y,S),this.size=P.size,this}},24977:q=>{q.exports=function H(v,M,D){for(var d=D-1,T=v.length;++d<T;)if(v[d]===M)return d;return-1}},52315:(q,H,v)=>{var M=v(75481),D=v(77609),d=v(81149);q.exports=function T(w){return D(w)?d(w):M(w)}},32855:(q,H,v)=>{var M=v(90719),D=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,T=M(function(w){var y=[];return 46===w.charCodeAt(0)&&y.push(""),w.replace(D,function(S,P,E,Z){y.push(E?Z.replace(d,"$1"):P||S)}),y});q.exports=T},68533:(q,H,v)=>{var M=v(44129);q.exports=function d(T){if("string"==typeof T||M(T))return T;var w=T+"";return"0"==w&&1/T==-1/0?"-0":w}},52827:q=>{var v=Function.prototype.toString;q.exports=function M(D){if(null!=D){try{return v.call(D)}catch{}try{return D+""}catch{}}return""}},42760:q=>{var H=/\s/;q.exports=function v(M){for(var D=M.length;D--&&H.test(M.charAt(D)););return D}},81149:q=>{var H="\\ud800-\\udfff",w="["+H+"]",y="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",S="\\ud83c[\\udffb-\\udfff]",E="[^"+H+"]",Z="(?:\\ud83c[\\udde6-\\uddff]){2}",A="[\\ud800-\\udbff][\\udc00-\\udfff]",U="(?:"+y+"|"+S+")?",Q="[\\ufe0e\\ufe0f]?",le=Q+U+"(?:\\u200d(?:"+[E,Z,A].join("|")+")"+Q+U+")*",e="(?:"+[E+y+"?",y,Z,A,w].join("|")+")",de=RegExp(S+"(?="+S+")|"+e+le,"g");q.exports=function he(ke){for(var Le=de.lastIndex=0;de.test(ke);)++Le;return Le}},11094:(q,H,v)=>{var M=v(44462);q.exports=function d(T){return M(T,4)}},90733:(q,H,v)=>{var M=v(44462);q.exports=function T(w){return M(w,5)}},76684:q=>{q.exports=function H(v){return function(){return v}}},28800:(q,H,v)=>{var M=v(23269),D=v(20217),d=v(93342),T=v(16555),w=Object.prototype,y=w.hasOwnProperty,S=M(function(P,E){P=Object(P);var Z=-1,A=E.length,I=A>2?E[2]:void 0;for(I&&d(E[0],E[1],I)&&(A=1);++Z<A;)for(var U=E[Z],Q=T(U),W=-1,le=Q.length;++W<le;){var e=Q[W],de=P[e];(void 0===de||D(de,w[e])&&!y.call(P,e))&&(P[e]=U[e])}return P});q.exports=S},35474:(q,H,v)=>{q.exports=v(89851)},20217:q=>{q.exports=function H(v,M){return v===M||v!=v&&M!=M}},35281:(q,H,v)=>{var M=v(69779),D=v(33609),d=v(96517),T=v(21503);q.exports=function w(y,S){return(T(y)?M:D)(y,d(S,3))}},62516:(q,H,v)=>{var d=v(24653)(v(36397));q.exports=d},36397:(q,H,v)=>{var M=v(65317),D=v(96517),d=v(44401),T=Math.max;q.exports=function w(y,S,P){var E=null==y?0:y.length;if(!E)return-1;var Z=null==P?0:d(P);return Z<0&&(Z=T(E+Z,0)),M(y,D(S,3),Z)}},22274:(q,H,v)=>{var M=v(50686);q.exports=function D(d){return null!=d&&d.length?M(d,1):[]}},89851:(q,H,v)=>{var M=v(96837),D=v(43132),d=v(21481),T=v(21503);q.exports=function w(y,S){return(T(y)?M:D)(y,d(S))}},41176:(q,H,v)=>{var M=v(30755),D=v(21481),d=v(16555);q.exports=function T(w,y){return null==w?w:M(w,D(y),d)}},8817:(q,H,v)=>{var M=v(15456);q.exports=function D(d,T,w){var y=null==d?void 0:M(d,T);return void 0===y?w:y}},54842:(q,H,v)=>{var M=v(84781),D=v(47283);q.exports=function d(T,w){return null!=T&&D(T,w,M)}},11172:(q,H,v)=>{var M=v(69989),D=v(47283);q.exports=function d(T,w){return null!=T&&D(T,w,M)}},32608:q=>{q.exports=function H(v){return v}},77151:(q,H,v)=>{var M=v(60186),D=v(72671),d=Object.prototype,T=d.hasOwnProperty,w=d.propertyIsEnumerable,y=M(function(){return arguments}())?M:function(S){return D(S)&&T.call(S,"callee")&&!w.call(S,"callee")};q.exports=y},21503:q=>{q.exports=Array.isArray},56507:(q,H,v)=>{var M=v(75946),D=v(96231);q.exports=function d(T){return null!=T&&D(T.length)&&!M(T)}},21330:(q,H,v)=>{var M=v(56507),D=v(72671);q.exports=function d(T){return D(T)&&M(T)}},80891:(q,H,v)=>{q=v.nmd(q);var M=v(12119),D=v(63580),d=H&&!H.nodeType&&H,T=d&&q&&!q.nodeType&&q,y=T&&T.exports===d?M.Buffer:void 0;q.exports=(y?y.isBuffer:void 0)||D},71973:(q,H,v)=>{var M=v(81172),D=v(28794),d=v(77151),T=v(21503),w=v(56507),y=v(80891),S=v(45488),P=v(48159),I=Object.prototype.hasOwnProperty;q.exports=function U(Q){if(null==Q)return!0;if(w(Q)&&(T(Q)||"string"==typeof Q||"function"==typeof Q.splice||y(Q)||P(Q)||d(Q)))return!Q.length;var W=D(Q);if("[object Map]"==W||"[object Set]"==W)return!Q.size;if(S(Q))return!M(Q).length;for(var le in Q)if(I.call(Q,le))return!1;return!0}},75946:(q,H,v)=>{var M=v(93337),D=v(25940);q.exports=function S(P){if(!D(P))return!1;var E=M(P);return"[object Function]"==E||"[object GeneratorFunction]"==E||"[object AsyncFunction]"==E||"[object Proxy]"==E}},96231:q=>{q.exports=function v(M){return"number"==typeof M&&M>-1&&M%1==0&&M<=9007199254740991}},13222:(q,H,v)=>{var M=v(97021),D=v(85647),d=v(73597),T=d&&d.isMap,w=T?D(T):M;q.exports=w},25940:q=>{q.exports=function H(v){var M=typeof v;return null!=v&&("object"==M||"function"==M)}},72671:q=>{q.exports=function H(v){return null!=v&&"object"==typeof v}},97614:(q,H,v)=>{var M=v(93337),D=v(29519),d=v(72671),S=Function.prototype.toString,P=Object.prototype.hasOwnProperty,E=S.call(Object);q.exports=function Z(A){if(!d(A)||"[object Object]"!=M(A))return!1;var I=D(A);if(null===I)return!0;var U=P.call(I,"constructor")&&I.constructor;return"function"==typeof U&&U instanceof U&&S.call(U)==E}},90799:(q,H,v)=>{var M=v(771),D=v(85647),d=v(73597),T=d&&d.isSet,w=T?D(T):M;q.exports=w},30248:(q,H,v)=>{var M=v(93337),D=v(21503),d=v(72671);q.exports=function w(y){return"string"==typeof y||!D(y)&&d(y)&&"[object String]"==M(y)}},44129:(q,H,v)=>{var M=v(93337),D=v(72671);q.exports=function T(w){return"symbol"==typeof w||D(w)&&"[object Symbol]"==M(w)}},48159:(q,H,v)=>{var M=v(1083),D=v(85647),d=v(73597),T=d&&d.isTypedArray,w=T?D(T):M;q.exports=w},34235:q=>{q.exports=function H(v){return void 0===v}},118:(q,H,v)=>{var M=v(72271),D=v(81172),d=v(56507);q.exports=function T(w){return d(w)?M(w):D(w)}},16555:(q,H,v)=>{var M=v(72271),D=v(92809),d=v(56507);q.exports=function T(w){return d(w)?M(w,!0):D(w)}},25809:q=>{q.exports=function H(v){var M=null==v?0:v.length;return M?v[M-1]:void 0}},19984:(q,H,v)=>{var M=v(84633),D=v(96517),d=v(92046),T=v(21503);q.exports=function w(y,S){return(T(y)?M:d)(y,D(S,3))}},10203:(q,H,v)=>{var M=v(85683),D=v(45184),d=v(96517);q.exports=function T(w,y){var S={};return y=d(y,3),D(w,function(P,E,Z){M(S,E,y(P,E,Z))}),S}},18176:(q,H,v)=>{var M=v(67308),D=v(31100),d=v(32608);q.exports=function T(w){return w&&w.length?M(w,d,D):void 0}},30535:(q,H,v)=>{var M=v(99850);function d(T,w){if("function"!=typeof T||null!=w&&"function"!=typeof w)throw new TypeError("Expected a function");var y=function(){var S=arguments,P=w?w.apply(this,S):S[0],E=y.cache;if(E.has(P))return E.get(P);var Z=T.apply(this,S);return y.cache=E.set(P,Z)||E,Z};return y.cache=new(d.Cache||M),y}d.Cache=M,q.exports=d},80567:(q,H,v)=>{var M=v(73842),d=v(84944)(function(T,w,y){M(T,w,y)});q.exports=d},29439:(q,H,v)=>{var M=v(67308),D=v(99069),d=v(32608);q.exports=function T(w){return w&&w.length?M(w,d,D):void 0}},29525:(q,H,v)=>{var M=v(67308),D=v(96517),d=v(99069);q.exports=function T(w,y){return w&&w.length?M(w,D(y,2),d):void 0}},12552:q=>{q.exports=function H(){}},31710:(q,H,v)=>{var M=v(12119);q.exports=function(){return M.Date.now()}},16372:(q,H,v)=>{var M=v(83021),d=v(3975)(function(T,w){return null==T?{}:M(T,w)});q.exports=d},87495:(q,H,v)=>{var M=v(11847),D=v(39222),d=v(45352),T=v(68533);q.exports=function w(y){return d(y)?M(T(y)):D(y)}},90361:(q,H,v)=>{var D=v(97509)();q.exports=D},81337:(q,H,v)=>{var M=v(8745),D=v(43132),d=v(96517),T=v(13570),w=v(21503);q.exports=function y(S,P,E){var Z=w(S)?M:T,A=arguments.length<3;return Z(S,d(P,4),E,A,D)}},55637:(q,H,v)=>{var M=v(81172),D=v(28794),d=v(56507),T=v(30248),w=v(52315);q.exports=function P(E){if(null==E)return 0;if(d(E))return T(E)?w(E):E.length;var Z=D(E);return"[object Map]"==Z||"[object Set]"==Z?E.size:M(E).length}},12906:(q,H,v)=>{var M=v(50686),D=v(6119),d=v(23269),T=v(93342),w=d(function(y,S){if(null==y)return[];var P=S.length;return P>1&&T(y,S[0],S[1])?S=[]:P>2&&T(S[0],S[1],S[2])&&(S=[S[0]]),D(y,M(S,1),[])});q.exports=w},49975:q=>{q.exports=function H(){return[]}},63580:q=>{q.exports=function H(){return!1}},12232:(q,H,v)=>{var M=v(51467),D=1/0;q.exports=function T(w){return w?(w=M(w))===D||w===-D?17976931348623157e292*(w<0?-1:1):w==w?w:0:0===w?w:0}},44401:(q,H,v)=>{var M=v(12232);q.exports=function D(d){var T=M(d),w=T%1;return T==T?w?T-w:T:0}},51467:(q,H,v)=>{var M=v(83348),D=v(25940),d=v(44129),w=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,S=/^0o[0-7]+$/i,P=parseInt;q.exports=function E(Z){if("number"==typeof Z)return Z;if(d(Z))return NaN;if(D(Z)){var A="function"==typeof Z.valueOf?Z.valueOf():Z;Z=D(A)?A+"":A}if("string"!=typeof Z)return 0===Z?Z:+Z;Z=M(Z);var I=y.test(Z);return I||S.test(Z)?P(Z.slice(2),I?2:8):w.test(Z)?NaN:+Z}},8067:(q,H,v)=>{var M=v(31989),D=v(16555);q.exports=function d(T){return M(T,D(T))}},73943:(q,H,v)=>{var M=v(93935);q.exports=function D(d){return null==d?"":M(d)}},89416:(q,H,v)=>{var M=v(96837),D=v(78858),d=v(45184),T=v(96517),w=v(29519),y=v(21503),S=v(80891),P=v(75946),E=v(25940),Z=v(48159);q.exports=function A(I,U,Q){var W=y(I),le=W||S(I)||Z(I);if(U=T(U,4),null==Q){var e=I&&I.constructor;Q=le?W?new e:[]:E(I)&&P(e)?D(w(I)):{}}return(le?M:d)(I,function(de,he,ke){return U(Q,de,he,ke)}),Q}},68921:(q,H,v)=>{var M=v(50686),D=v(23269),d=v(80707),T=v(21330),w=D(function(y){return d(M(y,1,T,!0))});q.exports=w},51541:(q,H,v)=>{var M=v(73943),D=0;q.exports=function d(T){var w=++D;return M(T)+w}},90377:(q,H,v)=>{var M=v(19179),D=v(118);q.exports=function d(T){return null==T?[]:M(T,D(T))}},21617:(q,H,v)=>{var M=v(89719),D=v(38645);q.exports=function d(T,w){return D(T||[],w||[],M)}},69898:function(q){q.exports=function(){"use strict";var H,v,M;function D(d,T){if(H)if(v){var w="var sharedChunk = {}; ("+H+")(sharedChunk); ("+v+")(sharedChunk);",y={};H(y),M=T(y),typeof window<"u"&&(M.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}else v=T;else H=T}return D(0,function(d){function T(r,s){return r(s={exports:{}},s.exports),s.exports}var w=y;function y(r,s,c,f){this.cx=3*r,this.bx=3*(c-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=f,this.p2x=c,this.p2y=f}y.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},y.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},y.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},y.prototype.solveCurveX=function(r,s){var c,f,m,b,O;for(void 0===s&&(s=1e-6),m=r,O=0;O<8;O++){if(b=this.sampleCurveX(m)-r,Math.abs(b)<s)return m;var z=this.sampleCurveDerivativeX(m);if(Math.abs(z)<1e-6)break;m-=b/z}if((m=r)<(c=0))return c;if(m>(f=1))return f;for(;c<f;){if(b=this.sampleCurveX(m),Math.abs(b-r)<s)return m;r>b?c=m:f=m,m=.5*(f-c)+c}return m},y.prototype.solve=function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))};var S=P;function P(r,s){this.x=r,this.y=s}P.prototype={clone:function(){return new P(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,c=r.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=s,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),c=Math.sin(r),f=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=f,this},_rotateAround:function(r,s){var c=Math.cos(r),f=Math.sin(r),m=s.y+f*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-f*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},P.convert=function(r){return r instanceof P?r:Array.isArray(r)?new P(r[0],r[1]):r};var E=typeof self<"u"?self:{},Z=Math.pow(2,53)-1;function A(r,s,c,f){var m=new w(r,s,c,f);return function(b){return m.solve(b)}}var I=A(.25,.1,.25,1);function U(r,s,c){return Math.min(c,Math.max(s,r))}function Q(r,s,c){var f=c-s,m=((r-s)%f+f)%f+s;return m===s?c:m}function W(r){for(var s=[],c=arguments.length-1;c-- >0;)s[c]=arguments[c+1];for(var f=0,m=s;f<m.length;f+=1){var b=m[f];for(var O in b)r[O]=b[O]}return r}var le=1;function e(){return le++}function de(){return function r(s){return s?(s^16*Math.random()>>s/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function he(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function ke(r,s){r.forEach(function(c){s[c]&&(s[c]=s[c].bind(s))})}function Le(r,s){return-1!==r.indexOf(s,r.length-s.length)}function Ue(r,s,c){var f={};for(var m in r)f[m]=s.call(c||this,r[m],m,r);return f}function Ie(r,s,c){var f={};for(var m in r)s.call(c||this,r[m],m,r)&&(f[m]=r[m]);return f}function je(r){return Array.isArray(r)?r.map(je):"object"==typeof r&&r?Ue(r,je):r}var X={};function ie(r){X[r]||(typeof console<"u"&&console.warn(r),X[r]=!0)}function oe(r,s,c){return(c.y-r.y)*(s.x-r.x)>(s.y-r.y)*(c.x-r.x)}function ae(r){for(var s=0,c=0,f=r.length,m=f-1,b=void 0,O=void 0;c<f;m=c++)s+=((O=r[m]).x-(b=r[c]).x)*(b.y+O.y);return s}function pe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function xe(r){var s={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(f,m,b,O){var z=b||O;return s[m]=!z||z.toLowerCase(),""}),s["max-age"]){var c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}var Ne=null;function we(r){if(null==Ne){var s=r.navigator?r.navigator.userAgent:null;Ne=!!r.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ne}function me(r){try{var s=E[r];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}var Ye,mt,Et,Tt,Nt=E.performance&&E.performance.now?E.performance.now.bind(E.performance):Date.now.bind(Date),Xt=E.requestAnimationFrame||E.mozRequestAnimationFrame||E.webkitRequestAnimationFrame||E.msRequestAnimationFrame,Pn=E.cancelAnimationFrame||E.mozCancelAnimationFrame||E.webkitCancelAnimationFrame||E.msCancelAnimationFrame,st={now:Nt,frame:function(r){var s=Xt(r);return{cancel:function(){return Pn(s)}}},getImageData:function(r,s){void 0===s&&(s=0);var c=E.document.createElement("canvas"),f=c.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return c.width=r.width,c.height=r.height,f.drawImage(r,0,0,r.width,r.height),f.getImageData(-s,-s,r.width+2*s,r.height+2*s)},resolveURL:function(r){return Ye||(Ye=E.document.createElement("a")),Ye.href=r,Ye.href},hardwareConcurrency:E.navigator&&E.navigator.hardwareConcurrency||4,get devicePixelRatio(){return E.devicePixelRatio},get prefersReducedMotion(){return!!E.matchMedia&&(null==mt&&(mt=E.matchMedia("(prefers-reduced-motion: reduce)")),mt.matches)}},at={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},kt={supported:!1,testSupport:function(r){!$t&&Tt&&(_n?Lt(r):Et=r)}},$t=!1,_n=!1;function Lt(r){var s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,Tt),r.isContextLost())return;kt.supported=!0}catch{}r.deleteTexture(s),$t=!0}E.document&&((Tt=E.document.createElement("img")).onload=function(){Et&&Lt(Et),Et=null,_n=!0},Tt.onerror=function(){$t=!0,Et=null},Tt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var gn="01",$n=function(r,s){this._transformRequestFn=r,this._customAccessToken=s,this._createSkuToken()};function pn(r){return 0===r.indexOf("mapbox:")}$n.prototype._createSkuToken=function(){var r=function(){for(var s="",c=0;c<10;c++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",gn,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt},$n.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},$n.prototype.transformRequest=function(r,s){return this._transformRequestFn&&this._transformRequestFn(r,s)||{url:r}},$n.prototype.normalizeStyleURL=function(r,s){if(!pn(r))return r;var c=Di(r);return c.path="/styles/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||s)},$n.prototype.normalizeGlyphsURL=function(r,s){if(!pn(r))return r;var c=Di(r);return c.path="/fonts/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||s)},$n.prototype.normalizeSourceURL=function(r,s){if(!pn(r))return r;var c=Di(r);return c.path="/v4/"+c.authority+".json",c.params.push("secure"),this._makeAPIURL(c,this._customAccessToken||s)},$n.prototype.normalizeSpriteURL=function(r,s,c,f){var m=Di(r);return pn(r)?(m.path="/styles/v1"+m.path+"/sprite"+s+c,this._makeAPIURL(m,this._customAccessToken||f)):(m.path+=""+s+c,gi(m))},$n.prototype.normalizeTileURL=function(r,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!pn(r))return r;var c=Di(r);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,(st.devicePixelRatio>=2||512===s?"@2x":"")+(kt.supported?".webp":"$1")),c.path=c.path.replace(/^.+\/v4\//,"/"),c.path="/v4"+c.path;var f=this._customAccessToken||function(m){for(var b=0,O=m;b<O.length;b+=1){var z=O[b].match(/^access_token=(.*)$/);if(z)return z[1]}return null}(c.params)||at.ACCESS_TOKEN;return at.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push("sku="+this._skuToken),this._makeAPIURL(c,f)},$n.prototype.canonicalizeTileURL=function(r,s){var c=Di(r);if(!c.path.match(/(^\/v4\/)/)||!c.path.match(/\.[\w]+$/))return r;var f="mapbox://tiles/";f+=c.path.replace("/v4/","");var m=c.params;return s&&(m=m.filter(function(b){return!b.match(/^access_token=/)})),m.length&&(f+="?"+m.join("&")),f},$n.prototype.canonicalizeTileset=function(r,s){for(var c=!!s&&pn(s),f=[],m=0,b=r.tiles||[];m<b.length;m+=1){var O=b[m];Gi(O)?f.push(this.canonicalizeTileURL(O,c)):f.push(O)}return f},$n.prototype._makeAPIURL=function(r,s){var c="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",f=Di(at.API_URL);if(r.protocol=f.protocol,r.authority=f.authority,"http"===r.protocol){var m=r.params.indexOf("secure");m>=0&&r.params.splice(m,1)}if("/"!==f.path&&(r.path=""+f.path+r.path),!at.REQUIRE_ACCESS_TOKEN)return gi(r);if(!(s=s||at.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+c);if("s"===s[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+c);return r.params=r.params.filter(function(b){return-1===b.indexOf("access_token")}),r.params.push("access_token="+s),gi(r)};var Ui=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Gi(r){return Ui.test(r)}var yi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Di(r){var s=r.match(yi);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function gi(r){var s=r.params.length?"?"+r.params.join("&"):"";return r.protocol+"://"+r.authority+r.path+s}function Ni(r){if(!r)return null;var s=r.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(decodeURIComponent(E.atob(s[1]).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Mo=function(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Mo.prototype.getStorageKey=function(r){var s,c=Ni(at.ACCESS_TOKEN);return s=c&&c.u?E.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,function(f,m){return String.fromCharCode(Number("0x"+m))})):at.ACCESS_TOKEN||"",r?"mapbox.eventData."+r+":"+s:"mapbox.eventData:"+s},Mo.prototype.fetchEventData=function(){var r=me("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(r)try{var f=E.localStorage.getItem(s);f&&(this.eventData=JSON.parse(f));var m=E.localStorage.getItem(c);m&&(this.anonId=m)}catch{ie("Unable to read from LocalStorage")}},Mo.prototype.saveEventData=function(){var r=me("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(r)try{E.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&E.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{ie("Unable to write to LocalStorage")}},Mo.prototype.processRequests=function(r){},Mo.prototype.postEvent=function(r,s,c,f){var m=this;if(at.EVENTS_URL){var b=Di(at.EVENTS_URL);b.params.push("access_token="+(f||at.ACCESS_TOKEN||""));var O={event:this.type,created:new Date(r).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:gn,userId:this.anonId},z=s?W(O,s):O,j={url:gi(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([z])};this.pendingRequest=qi(j,function(G){m.pendingRequest=null,c(G),m.saveEventData(),m.processRequests(f)})}},Mo.prototype.queueRequest=function(r,s){this.queue.push(r),this.processRequests(s)};var No,vr,Oo=function(r){function s(){r.call(this,"map.load"),this.success={},this.skuToken=""}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.postMapLoadEvent=function(c,f,m,b){this.skuToken=m,(at.EVENTS_URL&&b||at.ACCESS_TOKEN&&Array.isArray(c)&&c.some(function(O){return pn(O)||Gi(O)}))&&this.queueRequest({id:f,timestamp:Date.now()},b)},s.prototype.processRequests=function(c){var f=this;if(!this.pendingRequest&&0!==this.queue.length){var m=this.queue.shift(),b=m.id,O=m.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),he(this.anonId)||(this.anonId=de()),this.postEvent(O,{skuToken:this.skuToken},function(z){z||b&&(f.success[b]=!0)},c))}},s}(Mo),So=new(function(r){function s(c){r.call(this,"appUserTurnstile"),this._customAccessToken=c}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.postTurnstileEvent=function(c,f){at.EVENTS_URL&&at.ACCESS_TOKEN&&Array.isArray(c)&&c.some(function(m){return pn(m)||Gi(m)})&&this.queueRequest(Date.now(),f)},s.prototype.processRequests=function(c){var f=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var m=Ni(at.ACCESS_TOKEN),b=m?m.u:at.ACCESS_TOKEN,O=b!==this.eventData.tokenU;he(this.anonId)||(this.anonId=de(),O=!0);var z=this.queue.shift();if(this.eventData.lastSuccess){var j=new Date(this.eventData.lastSuccess),G=new Date(z),$=(z-this.eventData.lastSuccess)/864e5;O=O||$>=1||$<-1||j.getDate()!==G.getDate()}else O=!0;if(!O)return this.processRequests();this.postEvent(z,{"enabled.telemetry":!1},function(ee){ee||(f.eventData.lastSuccess=z,f.eventData.tokenU=b)},c)}},s}(Mo)),ra=So.postTurnstileEvent.bind(So),aa=new Oo,bo=aa.postMapLoadEvent.bind(aa),tr=500,lo=50;function Po(){E.caches&&!No&&(No=E.caches.open("mapbox-tiles"))}function xa(r){var s=r.indexOf("?");return s<0?r:r.slice(0,s)}var Ur,Eo=1/0;function Bn(){return null==Ur&&(Ur=E.OffscreenCanvas&&new E.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof E.createImageBitmap),Ur}var br={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(br);var qr,Ra,sl=function(r){function s(c,f,m){401===f&&Gi(m)&&(c+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),r.call(this,c),this.status=f,this.url=m,this.name=this.constructor.name,this.message=c}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},s}(Error),Ca=pe()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===E.location.protocol?E.parent:E).location.href},Ri=function(r,s){if(!(/^file:/.test(c=r.url)||/^file:/.test(Ca())&&!/^\w+:/.test(c))){if(E.fetch&&E.Request&&E.AbortController&&E.Request.prototype.hasOwnProperty("signal"))return function(f,m){var b,O=new E.AbortController,z=new E.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Ca(),signal:O.signal}),j=!1,G=!1,$=(b=z.url).indexOf("sku=")>0&&Gi(b);"json"===f.type&&z.headers.set("Accept","application/json");var ee=function(ge,Me,Ae){if(!G){if(ge&&"SecurityError"!==ge.message&&ie(ge),Me&&Ae)return se(Me);var Fe=Date.now();E.fetch(z).then(function(ze){if(ze.ok){var Ve=$?ze.clone():null;return se(ze,Ve,Fe)}return m(new sl(ze.statusText,ze.status,f.url))}).catch(function(ze){20!==ze.code&&m(new Error(ze.message))})}},se=function(ge,Me,Ae){("arrayBuffer"===f.type?ge.arrayBuffer():"json"===f.type?ge.json():ge.text()).then(function(Fe){G||(Me&&Ae&&function(ze,Ve,nt){if(Po(),No){var lt={status:Ve.status,statusText:Ve.statusText,headers:new E.Headers};Ve.headers.forEach(function(wt,zt){return lt.headers.set(zt,wt)});var gt=xe(Ve.headers.get("Cache-Control")||"");gt["no-store"]||(gt["max-age"]&&lt.headers.set("Expires",new Date(nt+1e3*gt["max-age"]).toUTCString()),new Date(lt.headers.get("Expires")).getTime()-nt<42e4||function(wt,zt){if(void 0===vr)try{new Response(new ReadableStream),vr=!0}catch{vr=!1}vr?zt(wt.body):wt.blob().then(zt)}(Ve,function(wt){var zt=new E.Response(wt,lt);Po(),No&&No.then(function(jt){return jt.put(xa(ze.url),zt)}).catch(function(jt){return ie(jt.message)})}))}}(z,Me,Ae),j=!0,m(null,Fe,ge.headers.get("Cache-Control"),ge.headers.get("Expires")))}).catch(function(Fe){G||m(new Error(Fe.message))})};return $?function(ge,Me){if(Po(),!No)return Me(null);var Ae=xa(ge.url);No.then(function(Fe){Fe.match(Ae).then(function(ze){var Ve=function(nt){if(!nt)return!1;var lt=new Date(nt.headers.get("Expires")||0),gt=xe(nt.headers.get("Cache-Control")||"");return lt>Date.now()&&!gt["no-cache"]}(ze);Fe.delete(Ae),Ve&&Fe.put(Ae,ze.clone()),Me(null,ze,Ve)}).catch(Me)}).catch(Me)}(z,ee):ee(null,null),{cancel:function(){G=!0,j||O.abort()}}}(r,s);if(pe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,s,void 0,!0)}var c;return function(f,m){var b=new E.XMLHttpRequest;for(var O in b.open(f.method||"GET",f.url,!0),"arrayBuffer"===f.type&&(b.responseType="arraybuffer"),f.headers)b.setRequestHeader(O,f.headers[O]);return"json"===f.type&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials="include"===f.credentials,b.onerror=function(){m(new Error(b.statusText))},b.onload=function(){if((b.status>=200&&b.status<300||0===b.status)&&null!==b.response){var z=b.response;if("json"===f.type)try{z=JSON.parse(b.response)}catch(j){return m(j)}m(null,z,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else m(new sl(b.statusText,b.status,f.url))},b.send(f.body),{cancel:function(){return b.abort()}}}(r,s)},Fs=function(r,s){return Ri(W(r,{type:"arrayBuffer"}),s)},qi=function(r,s){return Ri(W(r,{method:"POST"}),s)},te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";qr=[],Ra=0;var re=function(r,s){if(kt.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Ra>=at.MAX_PARALLEL_IMAGE_REQUESTS){var c={requestParameters:r,callback:s,cancelled:!1,cancel:function(){this.cancelled=!0}};return qr.push(c),c}Ra++;var f=!1,m=function(){if(!f)for(f=!0,Ra--;qr.length&&Ra<at.MAX_PARALLEL_IMAGE_REQUESTS;){var O=qr.shift();O.cancelled||(O.cancel=re(O.requestParameters,O.callback).cancel)}},b=Fs(r,function(O,z,j,G){var ee,se;m(),O?s(O):z&&(Bn()?(ee=s,se=new E.Blob([new Uint8Array(z)],{type:"image/png"}),E.createImageBitmap(se).then(function(ge){ee(null,ge)}).catch(function(ge){ee(new Error("Could not load image because of "+ge.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function($,ee,se,ge){var Me=new E.Image,Ae=E.URL;Me.onload=function(){ee(null,Me),Ae.revokeObjectURL(Me.src),Me.onload=null,E.requestAnimationFrame(function(){Me.src=te})},Me.onerror=function(){return ee(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Fe=new E.Blob([new Uint8Array($)],{type:"image/png"});Me.cacheControl=se,Me.expires=ge,Me.src=$.byteLength?Ae.createObjectURL(Fe):te}(z,s,j,G))});return{cancel:function(){b.cancel(),m()}}};function fe(r,s,c){c[r]&&-1!==c[r].indexOf(s)||(c[r]=c[r]||[],c[r].push(s))}function Ce(r,s,c){if(c&&c[r]){var f=c[r].indexOf(s);-1!==f&&c[r].splice(f,1)}}var Pe=function(r,s){void 0===s&&(s={}),W(this,s),this.type=r},qe=function(r){function s(c,f){void 0===f&&(f={}),r.call(this,"error",W({error:c},f))}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s}(Pe),Ge=function(){};Ge.prototype.on=function(r,s){return this._listeners=this._listeners||{},fe(r,s,this._listeners),this},Ge.prototype.off=function(r,s){return Ce(r,s,this._listeners),Ce(r,s,this._oneTimeListeners),this},Ge.prototype.once=function(r,s){return this._oneTimeListeners=this._oneTimeListeners||{},fe(r,s,this._oneTimeListeners),this},Ge.prototype.fire=function(r,s){"string"==typeof r&&(r=new Pe(r,s||{}));var c=r.type;if(this.listens(c)){r.target=this;for(var f=0,m=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];f<m.length;f+=1)m[f].call(this,r);for(var b=0,O=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];b<O.length;b+=1){var z=O[b];Ce(c,z,this._oneTimeListeners),z.call(this,r)}var j=this._eventedParent;j&&(W(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),j.fire(r))}else r instanceof qe&&console.error(r.error);return this},Ge.prototype.listens=function(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)},Ge.prototype.setEventedParent=function(r,s){return this._eventedParent=r,this._eventedParentData=s,this};var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ze=function(r,s,c,f){this.message=(r?r+": ":"")+c,f&&(this.identifier=f),null!=s&&s.__line__&&(this.line=s.__line__)};function $e(r){var s=r.value;return s?[new Ze(r.key,s,"constants have been deprecated as of v8")]:[]}function Mt(r){for(var s=[],c=arguments.length-1;c-- >0;)s[c]=arguments[c+1];for(var f=0,m=s;f<m.length;f+=1){var b=m[f];for(var O in b)r[O]=b[O]}return r}function It(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function ht(r){if(Array.isArray(r))return r.map(ht);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){var s={};for(var c in r)s[c]=ht(r[c]);return s}return It(r)}var At=function(r){function s(c,f){r.call(this,f),this.message=f,this.key=c}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s}(Error),sn=function(r,s){void 0===s&&(s=[]),this.parent=r,this.bindings={};for(var c=0,f=s;c<f.length;c+=1){var m=f[c];this.bindings[m[0]]=m[1]}};sn.prototype.concat=function(r){return new sn(this,r)},sn.prototype.get=function(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(r+" not found in scope.")},sn.prototype.has=function(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)};var an={kind:"null"},ft={kind:"number"},Qt={kind:"string"},Jt={kind:"boolean"},Yt={kind:"color"},Gn={kind:"object"},Wt={kind:"value"},li={kind:"collator"},zi={kind:"formatted"},zn={kind:"resolvedImage"};function vi(r,s){return{kind:"array",itemType:r,N:s}}function ri(r){if("array"===r.kind){var s=ri(r.itemType);return"number"==typeof r.N?"array<"+s+", "+r.N+">":"value"===r.itemType.kind?"array":"array<"+s+">"}return r.kind}var jo=[an,ft,Qt,Jt,Yt,zi,Gn,vi(Wt),zn];function Ci(r,s){if("error"===s.kind)return null;if("array"===r.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!Ci(r.itemType,s.itemType))&&("number"!=typeof r.N||r.N===s.N))return null}else{if(r.kind===s.kind)return null;if("value"===r.kind)for(var c=0,f=jo;c<f.length;c+=1)if(!Ci(f[c],s))return null}return"Expected "+ri(r)+" but found "+ri(s)+" instead."}function eo(r,s){return s.some(function(c){return c.kind===r.kind})}function Oi(r,s){return s.some(function(c){return"null"===c?null===r:"array"===c?Array.isArray(r):"object"===c?r&&!Array.isArray(r)&&"object"==typeof r:c===typeof r})}var Zn=T(function(r,s){var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(z){return(z=Math.round(z))<0?0:z>255?255:z}function m(z){return f("%"===z[z.length-1]?parseFloat(z)/100*255:parseInt(z))}function b(z){return(j="%"===z[z.length-1]?parseFloat(z)/100:parseFloat(z))<0?0:j>1?1:j;var j}function O(z,j,G){return G<0?G+=1:G>1&&(G-=1),6*G<1?z+(j-z)*G*6:2*G<1?j:3*G<2?z+(j-z)*(2/3-G)*6:z}try{s.parseCSSColor=function(z){var j,G=z.replace(/ /g,"").toLowerCase();if(G in c)return c[G].slice();if("#"===G[0])return 4===G.length?(j=parseInt(G.substr(1),16))>=0&&j<=4095?[(3840&j)>>4|(3840&j)>>8,240&j|(240&j)>>4,15&j|(15&j)<<4,1]:null:7===G.length&&(j=parseInt(G.substr(1),16))>=0&&j<=16777215?[(16711680&j)>>16,(65280&j)>>8,255&j,1]:null;var $=G.indexOf("("),ee=G.indexOf(")");if(-1!==$&&ee+1===G.length){var se=G.substr(0,$),ge=G.substr($+1,ee-($+1)).split(","),Me=1;switch(se){case"rgba":if(4!==ge.length)return null;Me=b(ge.pop());case"rgb":return 3!==ge.length?null:[m(ge[0]),m(ge[1]),m(ge[2]),Me];case"hsla":if(4!==ge.length)return null;Me=b(ge.pop());case"hsl":if(3!==ge.length)return null;var Ae=(parseFloat(ge[0])%360+360)%360/360,Fe=b(ge[1]),ze=b(ge[2]),Ve=ze<=.5?ze*(Fe+1):ze+Fe-ze*Fe,nt=2*ze-Ve;return[f(255*O(nt,Ve,Ae+1/3)),f(255*O(nt,Ve,Ae)),f(255*O(nt,Ve,Ae-1/3)),Me];default:return null}}return null}}catch{}}).parseCSSColor,wi=function(r,s,c,f){void 0===f&&(f=1),this.r=r,this.g=s,this.b=c,this.a=f};wi.parse=function(r){if(r){if(r instanceof wi)return r;if("string"==typeof r){var s=Zn(r);if(s)return new wi(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3])}}},wi.prototype.toString=function(){var r=this.toArray(),s=r[1],c=r[2],f=r[3];return"rgba("+Math.round(r[0])+","+Math.round(s)+","+Math.round(c)+","+f+")"},wi.prototype.toArray=function(){var r=this.a;return 0===r?[0,0,0,0]:[255*this.r/r,255*this.g/r,255*this.b/r,r]},wi.black=new wi(0,0,0,1),wi.white=new wi(1,1,1,1),wi.transparent=new wi(0,0,0,0),wi.red=new wi(1,0,0,1);var dr=function(r,s,c){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};dr.prototype.compare=function(r,s){return this.collator.compare(r,s)},dr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var wa=function(r,s,c,f,m){this.text=r,this.image=s,this.scale=c,this.fontStack=f,this.textColor=m},Yi=function(r){this.sections=r};Yi.fromString=function(r){return new Yi([new wa(r,null,null,null,null)])},Yi.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(r){return 0!==r.text.length||r.image&&0!==r.image.name.length})},Yi.factory=function(r){return r instanceof Yi?r:Yi.fromString(r)},Yi.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(r){return r.text}).join("")},Yi.prototype.serialize=function(){for(var r=["format"],s=0,c=this.sections;s<c.length;s+=1){var f=c[s];if(f.image)r.push(["image",f.image.name]);else{r.push(f.text);var m={};f.fontStack&&(m["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(m["font-scale"]=f.scale),f.textColor&&(m["text-color"]=["rgba"].concat(f.textColor.toArray())),r.push(m)}}return r};var Ko=function(r){this.name=r.name,this.available=r.available};function rs(r,s,c,f){return"number"==typeof r&&r>=0&&r<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===f||"number"==typeof f&&f>=0&&f<=1?null:"Invalid rgba value ["+[r,s,c,f].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof f?[r,s,c,f]:[r,s,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ta(r){if(null===r||"string"==typeof r||"boolean"==typeof r||"number"==typeof r||r instanceof wi||r instanceof dr||r instanceof Yi||r instanceof Ko)return!0;if(Array.isArray(r)){for(var s=0,c=r;s<c.length;s+=1)if(!Ta(c[s]))return!1;return!0}if("object"==typeof r){for(var f in r)if(!Ta(r[f]))return!1;return!0}return!1}function to(r){if(null===r)return an;if("string"==typeof r)return Qt;if("boolean"==typeof r)return Jt;if("number"==typeof r)return ft;if(r instanceof wi)return Yt;if(r instanceof dr)return li;if(r instanceof Yi)return zi;if(r instanceof Ko)return zn;if(Array.isArray(r)){for(var s,c=r.length,f=0,m=r;f<m.length;f+=1){var b=to(m[f]);if(s){if(s===b)continue;s=Wt;break}s=b}return vi(s||Wt,c)}return Gn}function nc(r){var s=typeof r;return null===r?"":"string"===s||"number"===s||"boolean"===s?String(r):r instanceof wi||r instanceof Yi||r instanceof Ko?r.toString():JSON.stringify(r)}Ko.prototype.toString=function(){return this.name},Ko.fromString=function(r){return r?new Ko({name:r,available:!1}):null},Ko.prototype.serialize=function(){return["image",this.name]};var nr=function(r,s){this.type=r,this.value=s};nr.parse=function(r,s){if(2!==r.length)return s.error("'literal' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(!Ta(r[1]))return s.error("invalid value");var c=r[1],f=to(c),m=s.expectedType;return"array"!==f.kind||0!==f.N||!m||"array"!==m.kind||"number"==typeof m.N&&0!==m.N||(f=m),new nr(f,c)},nr.prototype.evaluate=function(){return this.value},nr.prototype.eachChild=function(){},nr.prototype.outputDefined=function(){return!0},nr.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof wi?["rgba"].concat(this.value.toArray()):this.value instanceof Yi?this.value.serialize():this.value};var Bo=function(r){this.name="ExpressionEvaluationError",this.message=r};Bo.prototype.toJSON=function(){return this.message};var kr={string:Qt,number:ft,boolean:Jt,object:Gn},no=function(r,s){this.type=r,this.args=s};no.parse=function(r,s){if(r.length<2)return s.error("Expected at least one argument.");var c,f=1,m=r[0];if("array"===m){var b,O;if(r.length>2){var z=r[1];if("string"!=typeof z||!(z in kr)||"object"===z)return s.error('The item type argument of "array" must be one of string, number, boolean',1);b=kr[z],f++}else b=Wt;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);O=r[2],f++}c=vi(b,O)}else c=kr[m];for(var j=[];f<r.length;f++){var G=s.parse(r[f],f,Wt);if(!G)return null;j.push(G)}return new no(c,j)},no.prototype.evaluate=function(r){for(var s=0;s<this.args.length;s++){var c=this.args[s].evaluate(r);if(!Ci(this.type,to(c)))return c;if(s===this.args.length-1)throw new Bo("Expected value to be of type "+ri(this.type)+", but found "+ri(to(c))+" instead.")}return null},no.prototype.eachChild=function(r){this.args.forEach(r)},no.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},no.prototype.serialize=function(){var r=this.type,s=[r.kind];if("array"===r.kind){var c=r.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){s.push(c.kind);var f=r.N;("number"==typeof f||this.args.length>1)&&s.push(f)}}return s.concat(this.args.map(function(m){return m.serialize()}))};var Ma=function(r){this.type=zi,this.sections=r};Ma.parse=function(r,s){if(r.length<2)return s.error("Expected at least one argument.");var c=r[1];if(!Array.isArray(c)&&"object"==typeof c)return s.error("First argument must be an image or text section.");for(var f=[],m=!1,b=1;b<=r.length-1;++b){var O=r[b];if(m&&"object"==typeof O&&!Array.isArray(O)){m=!1;var z=null;if(O["font-scale"]&&!(z=s.parse(O["font-scale"],1,ft)))return null;var j=null;if(O["text-font"]&&!(j=s.parse(O["text-font"],1,vi(Qt))))return null;var G=null;if(O["text-color"]&&!(G=s.parse(O["text-color"],1,Yt)))return null;var $=f[f.length-1];$.scale=z,$.font=j,$.textColor=G}else{var ee=s.parse(r[b],1,Wt);if(!ee)return null;var se=ee.type.kind;if("string"!==se&&"value"!==se&&"null"!==se&&"resolvedImage"!==se)return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,f.push({content:ee,scale:null,font:null,textColor:null})}}return new Ma(f)},Ma.prototype.evaluate=function(r){return new Yi(this.sections.map(function(s){var c=s.content.evaluate(r);return to(c)===zn?new wa("",c,null,null,null):new wa(nc(c),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null)}))},Ma.prototype.eachChild=function(r){for(var s=0,c=this.sections;s<c.length;s+=1){var f=c[s];r(f.content),f.scale&&r(f.scale),f.font&&r(f.font),f.textColor&&r(f.textColor)}},Ma.prototype.outputDefined=function(){return!1},Ma.prototype.serialize=function(){for(var r=["format"],s=0,c=this.sections;s<c.length;s+=1){var f=c[s];r.push(f.content.serialize());var m={};f.scale&&(m["font-scale"]=f.scale.serialize()),f.font&&(m["text-font"]=f.font.serialize()),f.textColor&&(m["text-color"]=f.textColor.serialize()),r.push(m)}return r};var Jr=function(r){this.type=zn,this.input=r};Jr.parse=function(r,s){if(2!==r.length)return s.error("Expected two arguments.");var c=s.parse(r[1],1,Qt);return c?new Jr(c):s.error("No image name provided.")},Jr.prototype.evaluate=function(r){var s=this.input.evaluate(r),c=Ko.fromString(s);return c&&r.availableImages&&(c.available=r.availableImages.indexOf(s)>-1),c},Jr.prototype.eachChild=function(r){r(this.input)},Jr.prototype.outputDefined=function(){return!1},Jr.prototype.serialize=function(){return["image",this.input.serialize()]};var Sc={"to-boolean":Jt,"to-color":Yt,"to-number":ft,"to-string":Qt},jr=function(r,s){this.type=r,this.args=s};jr.parse=function(r,s){if(r.length<2)return s.error("Expected at least one argument.");var c=r[0];if(("to-boolean"===c||"to-string"===c)&&2!==r.length)return s.error("Expected one argument.");for(var f=Sc[c],m=[],b=1;b<r.length;b++){var O=s.parse(r[b],b,Wt);if(!O)return null;m.push(O)}return new jr(f,m)},jr.prototype.evaluate=function(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){for(var s,c,f=0,m=this.args;f<m.length;f+=1){if(c=null,(s=m[f].evaluate(r))instanceof wi)return s;if("string"==typeof s){var b=r.parseColor(s);if(b)return b}else if(Array.isArray(s)&&!(c=s.length<3||s.length>4?"Invalid rbga value "+JSON.stringify(s)+": expected an array containing either three or four numeric values.":rs(s[0],s[1],s[2],s[3])))return new wi(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Bo(c||"Could not parse color from value '"+("string"==typeof s?s:String(JSON.stringify(s)))+"'")}if("number"===this.type.kind){for(var O=null,z=0,j=this.args;z<j.length;z+=1){if(null===(O=j[z].evaluate(r)))return 0;var G=Number(O);if(!isNaN(G))return G}throw new Bo("Could not convert "+JSON.stringify(O)+" to number.")}return"formatted"===this.type.kind?Yi.fromString(nc(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?Ko.fromString(nc(this.args[0].evaluate(r))):nc(this.args[0].evaluate(r))},jr.prototype.eachChild=function(r){this.args.forEach(r)},jr.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},jr.prototype.serialize=function(){if("formatted"===this.type.kind)return new Ma([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Jr(this.args[0]).serialize();var r=["to-"+this.type.kind];return this.eachChild(function(s){r.push(s.serialize())}),r};var R=["Unknown","Point","LineString","Polygon"],B=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};B.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},B.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?R[this.feature.type]:this.feature.type:null},B.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},B.prototype.canonicalID=function(){return this.canonical},B.prototype.properties=function(){return this.feature&&this.feature.properties||{}},B.prototype.parseColor=function(r){var s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=wi.parse(r)),s};var Y=function(r,s,c,f){this.name=r,this.type=s,this._evaluate=c,this.args=f};Y.prototype.evaluate=function(r){return this._evaluate(r,this.args)},Y.prototype.eachChild=function(r){this.args.forEach(r)},Y.prototype.outputDefined=function(){return!1},Y.prototype.serialize=function(){return[this.name].concat(this.args.map(function(r){return r.serialize()}))},Y.parse=function(r,s){var c,f=r[0],m=Y.definitions[f];if(!m)return s.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0);for(var b=Array.isArray(m)?m[0]:m.type,O=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,z=O.filter(function(On){var rn=On[0];return!Array.isArray(rn)||rn.length===r.length-1}),j=null,G=0,$=z;G<$.length;G+=1){var ee=$[G],se=ee[0],ge=ee[1];j=new ui(s.registry,s.path,null,s.scope);for(var Me=[],Ae=!1,Fe=1;Fe<r.length;Fe++){var ze=r[Fe],Ve=Array.isArray(se)?se[Fe-1]:se.type,nt=j.parse(ze,1+Me.length,Ve);if(!nt){Ae=!0;break}Me.push(nt)}if(!Ae)if(Array.isArray(se)&&se.length!==Me.length)j.error("Expected "+se.length+" arguments, but found "+Me.length+" instead.");else{for(var lt=0;lt<Me.length;lt++){var gt=Array.isArray(se)?se[lt]:se.type,wt=Me[lt];j.concat(lt+1).checkSubtype(gt,wt.type)}if(0===j.errors.length)return new Y(f,b,ge,Me)}}if(1===z.length)(c=s.errors).push.apply(c,j.errors);else{for(var zt=(z.length?z:O).map(function(On){var rn;return rn=On[0],Array.isArray(rn)?"("+rn.map(ri).join(", ")+")":"("+ri(rn.type)+"...)"}).join(" | "),jt=[],vn=1;vn<r.length;vn++){var on=s.parse(r[vn],1+jt.length);if(!on)return null;jt.push(ri(on.type))}s.error("Expected arguments of type "+zt+", but found ("+jt.join(", ")+") instead.")}return null},Y.register=function(r,s){for(var c in Y.definitions=s,s)r[c]=Y};var Je=function(r,s,c){this.type=li,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=s};function tt(r,s){r[0]=Math.min(r[0],s[0]),r[1]=Math.min(r[1],s[1]),r[2]=Math.max(r[2],s[0]),r[3]=Math.max(r[3],s[1])}function Qe(r,s){return!(r[0]<=s[0]||r[2]>=s[2]||r[1]<=s[1]||r[3]>=s[3])}function rt(r,s){var c=(180+r[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*8192),Math.round(f*m*8192)]}function Ft(r,s,c){return s[1]>r[1]!=c[1]>r[1]&&r[0]<(c[0]-s[0])*(r[1]-s[1])/(c[1]-s[1])+s[0]}function Dt(r,s){for(var c,f,m,b,O,z,j,G=!1,$=0,ee=s.length;$<ee;$++)for(var se=s[$],ge=0,Me=se.length;ge<Me-1;ge++){if((b=(c=r)[0]-(f=se[ge])[0])*(j=c[1]-(m=se[ge+1])[1])-(z=c[0]-m[0])*(O=c[1]-f[1])==0&&b*z<=0&&O*j<=0)return!1;Ft(r,se[ge],se[ge+1])&&(G=!G)}return G}function dn(r,s){for(var c=0;c<s.length;c++)if(Dt(r,s[c]))return!0;return!1}function ut(r,s,c,f){var m=f[0]-c[0],b=f[1]-c[1],O=(r[0]-c[0])*b-m*(r[1]-c[1]),z=(s[0]-c[0])*b-m*(s[1]-c[1]);return O>0&&z<0||O<0&&z>0}function tn(r,s,c){for(var f=0,m=c;f<m.length;f+=1)for(var b=m[f],O=0;O<b.length-1;++O)if((ee=[($=b[O+1])[0]-(G=b[O])[0],$[1]-G[1]])[0]*(se=[(j=s)[0]-(z=r)[0],j[1]-z[1]])[1]-ee[1]*se[0]!=0&&ut(z,j,G,$)&&ut(G,$,z,j))return!0;var z,j,G,$,ee,se;return!1}function hn(r,s){for(var c=0;c<r.length;++c)if(!Dt(r[c],s))return!1;for(var f=0;f<r.length-1;++f)if(tn(r[f],r[f+1],s))return!1;return!0}function In(r,s){for(var c=0;c<s.length;c++)if(hn(r,s[c]))return!0;return!1}function Nn(r,s,c){for(var f=[],m=0;m<r.length;m++){for(var b=[],O=0;O<r[m].length;O++){var z=rt(r[m][O],c);tt(s,z),b.push(z)}f.push(b)}return f}function Wi(r,s,c){for(var f=[],m=0;m<r.length;m++){var b=Nn(r[m],s,c);f.push(b)}return f}function Ot(r,s,c,f){if(r[0]<c[0]||r[0]>c[2]){var m=.5*f,b=r[0]-c[0]>m?-f:c[0]-r[0]>m?f:0;0===b&&(b=r[0]-c[2]>m?-f:c[2]-r[0]>m?f:0),r[0]+=b}tt(s,r)}function yn(r,s,c,f){for(var m=8192*Math.pow(2,f.z),b=[8192*f.x,8192*f.y],O=[],z=0,j=r;z<j.length;z+=1)for(var G=0,$=j[z];G<$.length;G+=1){var ee=$[G],se=[ee.x+b[0],ee.y+b[1]];Ot(se,s,c,m),O.push(se)}return O}function Zt(r,s,c,f){for(var m,b=8192*Math.pow(2,f.z),O=[8192*f.x,8192*f.y],z=[],j=0,G=r;j<G.length;j+=1){for(var $=[],ee=0,se=G[j];ee<se.length;ee+=1){var ge=se[ee],Me=[ge.x+O[0],ge.y+O[1]];tt(s,Me),$.push(Me)}z.push($)}if(s[2]-s[0]<=b/2){(m=s)[0]=m[1]=1/0,m[2]=m[3]=-1/0;for(var Ae=0,Fe=z;Ae<Fe.length;Ae+=1)for(var ze=0,Ve=Fe[Ae];ze<Ve.length;ze+=1)Ot(Ve[ze],s,c,b)}return z}Je.parse=function(r,s){if(2!==r.length)return s.error("Expected one argument.");var c=r[1];if("object"!=typeof c||Array.isArray(c))return s.error("Collator options argument must be an object.");var f=s.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,Jt);if(!f)return null;var m=s.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,Jt);if(!m)return null;var b=null;return c.locale&&!(b=s.parse(c.locale,1,Qt))?null:new Je(f,m,b)},Je.prototype.evaluate=function(r){return new dr(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)},Je.prototype.eachChild=function(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)},Je.prototype.outputDefined=function(){return!1},Je.prototype.serialize=function(){var r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]};var ci=function(r,s){this.type=Jt,this.geojson=r,this.geometries=s};function Ji(r){if(r instanceof Y&&("get"===r.name&&1===r.args.length||"feature-state"===r.name||"has"===r.name&&1===r.args.length||"properties"===r.name||"geometry-type"===r.name||"id"===r.name||/^filter-/.test(r.name))||r instanceof ci)return!1;var s=!0;return r.eachChild(function(c){s&&!Ji(c)&&(s=!1)}),s}function Tn(r){if(r instanceof Y&&"feature-state"===r.name)return!1;var s=!0;return r.eachChild(function(c){s&&!Tn(c)&&(s=!1)}),s}function Br(r,s){if(r instanceof Y&&s.indexOf(r.name)>=0)return!1;var c=!0;return r.eachChild(function(f){c&&!Br(f,s)&&(c=!1)}),c}ci.parse=function(r,s){if(2!==r.length)return s.error("'within' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(Ta(r[1])){var c=r[1];if("FeatureCollection"===c.type)for(var f=0;f<c.features.length;++f){var m=c.features[f].geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new ci(c,c.features[f].geometry)}else if("Feature"===c.type){var b=c.geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new ci(c,c.geometry)}else if("Polygon"===c.type||"MultiPolygon"===c.type)return new ci(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ci.prototype.evaluate=function(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(s,c){var f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],b=s.canonicalID();if("Polygon"===c.type){var O=Nn(c.coordinates,m,b),z=yn(s.geometry(),f,m,b);if(!Qe(f,m))return!1;for(var j=0,G=z;j<G.length;j+=1)if(!Dt(G[j],O))return!1}if("MultiPolygon"===c.type){var $=Wi(c.coordinates,m,b),ee=yn(s.geometry(),f,m,b);if(!Qe(f,m))return!1;for(var se=0,ge=ee;se<ge.length;se+=1)if(!dn(ge[se],$))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(s,c){var f=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],b=s.canonicalID();if("Polygon"===c.type){var O=Nn(c.coordinates,m,b),z=Zt(s.geometry(),f,m,b);if(!Qe(f,m))return!1;for(var j=0,G=z;j<G.length;j+=1)if(!hn(G[j],O))return!1}if("MultiPolygon"===c.type){var $=Wi(c.coordinates,m,b),ee=Zt(s.geometry(),f,m,b);if(!Qe(f,m))return!1;for(var se=0,ge=ee;se<ge.length;se+=1)if(!In(ge[se],$))return!1}return!0}(r,this.geometries)}return!1},ci.prototype.eachChild=function(){},ci.prototype.outputDefined=function(){return!0},ci.prototype.serialize=function(){return["within",this.geojson]};var xr=function(r,s){this.type=s.type,this.name=r,this.boundExpression=s};xr.parse=function(r,s){if(2!==r.length||"string"!=typeof r[1])return s.error("'var' expression requires exactly one string literal argument.");var c=r[1];return s.scope.has(c)?new xr(c,s.scope.get(c)):s.error('Unknown variable "'+c+'". Make sure "'+c+'" has been bound in an enclosing "let" expression before using it.',1)},xr.prototype.evaluate=function(r){return this.boundExpression.evaluate(r)},xr.prototype.eachChild=function(){},xr.prototype.outputDefined=function(){return!1},xr.prototype.serialize=function(){return["var",this.name]};var ui=function(r,s,c,f,m){void 0===s&&(s=[]),void 0===f&&(f=new sn),void 0===m&&(m=[]),this.registry=r,this.path=s,this.key=s.map(function(b){return"["+b+"]"}).join(""),this.scope=f,this.errors=m,this.expectedType=c};function Ir(r,s){for(var c,f=r.length-1,m=0,b=f,O=0;m<=b;)if((c=r[O=Math.floor((m+b)/2)])<=s){if(O===f||s<r[O+1])return O;m=O+1}else{if(!(c>s))throw new Bo("Input is not a number.");b=O-1}return 0}ui.prototype.parse=function(r,s,c,f,m){return void 0===m&&(m={}),s?this.concat(s,c,f)._parse(r,m):this._parse(r,m)},ui.prototype._parse=function(r,s){function c(G,$,ee){return"assert"===ee?new no($,[G]):"coerce"===ee?new jr($,[G]):G}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var f=r[0];if("string"!=typeof f)return this.error("Expression name must be a string, but found "+typeof f+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var m=this.registry[f];if(m){var b=m.parse(r,this);if(!b)return null;if(this.expectedType){var O=this.expectedType,z=b.type;if("string"!==O.kind&&"number"!==O.kind&&"boolean"!==O.kind&&"object"!==O.kind&&"array"!==O.kind||"value"!==z.kind)if("color"!==O.kind&&"formatted"!==O.kind&&"resolvedImage"!==O.kind||"value"!==z.kind&&"string"!==z.kind){if(this.checkSubtype(O,z))return null}else b=c(b,O,s.typeAnnotation||"coerce");else b=c(b,O,s.typeAnnotation||"assert")}if(!(b instanceof nr)&&"resolvedImage"!==b.type.kind&&function G($){if($ instanceof xr)return G($.boundExpression);if($ instanceof Y&&"error"===$.name||$ instanceof Je||$ instanceof ci)return!1;var ee=$ instanceof jr||$ instanceof no,se=!0;return $.eachChild(function(ge){se=ee?se&&G(ge):se&&ge instanceof nr}),!!se&&Ji($)&&Br($,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(b)){var j=new B;try{b=new nr(b.type,b.evaluate(j))}catch(G){return this.error(G.message),null}}return b}return this.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof r+" instead.")},ui.prototype.concat=function(r,s,c){var f="number"==typeof r?this.path.concat(r):this.path,m=c?this.scope.concat(c):this.scope;return new ui(this.registry,f,s||null,m,this.errors)},ui.prototype.error=function(r){for(var s=[],c=arguments.length-1;c-- >0;)s[c]=arguments[c+1];var f=""+this.key+s.map(function(m){return"["+m+"]"}).join("");this.errors.push(new At(f,r))},ui.prototype.checkSubtype=function(r,s){var c=Ci(r,s);return c&&this.error(c),c};var Hi=function(r,s,c){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(var f=0,m=c;f<m.length;f+=1){var b=m[f],O=b[1];this.labels.push(b[0]),this.outputs.push(O)}};function co(r,s,c){return r*(1-c)+s*c}Hi.parse=function(r,s){if(r.length-1<4)return s.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");var c=s.parse(r[1],1,ft);if(!c)return null;var f=[],m=null;s.expectedType&&"value"!==s.expectedType.kind&&(m=s.expectedType);for(var b=1;b<r.length;b+=2){var O=1===b?-1/0:r[b],z=r[b+1],j=b,G=b+1;if("number"!=typeof O)return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(f.length&&f[f.length-1][0]>=O)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);var $=s.parse(z,G,m);if(!$)return null;m=m||$.type,f.push([O,$])}return new Hi(m,c,f)},Hi.prototype.evaluate=function(r){var s=this.labels,c=this.outputs;if(1===s.length)return c[0].evaluate(r);var f=this.input.evaluate(r);if(f<=s[0])return c[0].evaluate(r);var m=s.length;return f>=s[m-1]?c[m-1].evaluate(r):c[Ir(s,f)].evaluate(r)},Hi.prototype.eachChild=function(r){r(this.input);for(var s=0,c=this.outputs;s<c.length;s+=1)r(c[s])},Hi.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})},Hi.prototype.serialize=function(){for(var r=["step",this.input.serialize()],s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r};var xs=Object.freeze({__proto__:null,number:co,color:function(r,s,c){return new wi(co(r.r,s.r,c),co(r.g,s.g,c),co(r.b,s.b,c),co(r.a,s.a,c))},array:function(r,s,c){return r.map(function(f,m){return co(f,s[m],c)})}}),Oa=6/29*3*(6/29),Sl=Math.PI/180,du=180/Math.PI;function ic(r){return r>.008856451679035631?Math.pow(r,1/3):r/Oa+4/29}function oc(r){return r>6/29?r*r*r:Oa*(r-4/29)}function ll(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function rc(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Pc(r){var s=rc(r.r),c=rc(r.g),f=rc(r.b),m=ic((.4124564*s+.3575761*c+.1804375*f)/.95047),b=ic((.2126729*s+.7151522*c+.072175*f)/1);return{l:116*b-16,a:500*(m-b),b:200*(b-ic((.0193339*s+.119192*c+.9503041*f)/1.08883)),alpha:r.a}}function hu(r){var s=(r.l+16)/116,c=isNaN(r.a)?s:s+r.a/500,f=isNaN(r.b)?s:s-r.b/200;return s=1*oc(s),c=.95047*oc(c),f=1.08883*oc(f),new wi(ll(3.2404542*c-1.5371385*s-.4985314*f),ll(-.969266*c+1.8760108*s+.041556*f),ll(.0556434*c-.2040259*s+1.0572252*f),r.alpha)}function Us(r,s,c){var f=s-r;return r+c*(f>180||f<-180?f-360*Math.round(f/360):f)}var cl={forward:Pc,reverse:hu,interpolate:function(r,s,c){return{l:co(r.l,s.l,c),a:co(r.a,s.a,c),b:co(r.b,s.b,c),alpha:co(r.alpha,s.alpha,c)}}},Pl={forward:function(r){var s=Pc(r),c=s.l,f=s.a,m=s.b,b=Math.atan2(m,f)*du;return{h:b<0?b+360:b,c:Math.sqrt(f*f+m*m),l:c,alpha:r.a}},reverse:function(r){var s=r.h*Sl,c=r.c;return hu({l:r.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:r.alpha})},interpolate:function(r,s,c){return{h:Us(r.h,s.h,c),c:co(r.c,s.c,c),l:co(r.l,s.l,c),alpha:co(r.alpha,s.alpha,c)}}},fu=Object.freeze({__proto__:null,lab:cl,hcl:Pl}),Lo=function(r,s,c,f,m){this.type=r,this.operator=s,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(var b=0,O=m;b<O.length;b+=1){var z=O[b],j=z[1];this.labels.push(z[0]),this.outputs.push(j)}};function qs(r,s,c,f){var m=f-c,b=r-c;return 0===m?0:1===s?b/m:(Math.pow(s,b)-1)/(Math.pow(s,m)-1)}Lo.interpolationFactor=function(r,s,c,f){var m=0;if("exponential"===r.name)m=qs(s,r.base,c,f);else if("linear"===r.name)m=qs(s,1,c,f);else if("cubic-bezier"===r.name){var b=r.controlPoints;m=new w(b[0],b[1],b[2],b[3]).solve(qs(s,1,c,f))}return m},Lo.parse=function(r,s){var c=r[0],f=r[1],m=r[2],b=r.slice(3);if(!Array.isArray(f)||0===f.length)return s.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){var O=f[1];if("number"!=typeof O)return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:O}}else{if("cubic-bezier"!==f[0])return s.error("Unknown interpolation type "+String(f[0]),1,0);var z=f.slice(1);if(4!==z.length||z.some(function(Fe){return"number"!=typeof Fe||Fe<0||Fe>1}))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:z}}if(r.length-1<4)return s.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(!(m=s.parse(m,2,ft)))return null;var j=[],G=null;"interpolate-hcl"===c||"interpolate-lab"===c?G=Yt:s.expectedType&&"value"!==s.expectedType.kind&&(G=s.expectedType);for(var $=0;$<b.length;$+=2){var ee=b[$],se=b[$+1],ge=$+3,Me=$+4;if("number"!=typeof ee)return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ge);if(j.length&&j[j.length-1][0]>=ee)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ge);var Ae=s.parse(se,Me,G);if(!Ae)return null;G=G||Ae.type,j.push([ee,Ae])}return"number"===G.kind||"color"===G.kind||"array"===G.kind&&"number"===G.itemType.kind&&"number"==typeof G.N?new Lo(G,c,f,m,j):s.error("Type "+ri(G)+" is not interpolatable.")},Lo.prototype.evaluate=function(r){var s=this.labels,c=this.outputs;if(1===s.length)return c[0].evaluate(r);var f=this.input.evaluate(r);if(f<=s[0])return c[0].evaluate(r);var m=s.length;if(f>=s[m-1])return c[m-1].evaluate(r);var b=Ir(s,f),O=Lo.interpolationFactor(this.interpolation,f,s[b],s[b+1]),z=c[b].evaluate(r),j=c[b+1].evaluate(r);return"interpolate"===this.operator?xs[this.type.kind.toLowerCase()](z,j,O):"interpolate-hcl"===this.operator?Pl.reverse(Pl.interpolate(Pl.forward(z),Pl.forward(j),O)):cl.reverse(cl.interpolate(cl.forward(z),cl.forward(j),O))},Lo.prototype.eachChild=function(r){r(this.input);for(var s=0,c=this.outputs;s<c.length;s+=1)r(c[s])},Lo.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})},Lo.prototype.serialize=function(){var r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var s=[this.operator,r,this.input.serialize()],c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s};var Fa=function(r,s){this.type=r,this.args=s};Fa.parse=function(r,s){if(r.length<2)return s.error("Expectected at least one argument.");var c=null,f=s.expectedType;f&&"value"!==f.kind&&(c=f);for(var m=[],b=0,O=r.slice(1);b<O.length;b+=1){var z=s.parse(O[b],1+m.length,c,void 0,{typeAnnotation:"omit"});if(!z)return null;c=c||z.type,m.push(z)}var j=f&&m.some(function(G){return Ci(f,G.type)});return new Fa(j?Wt:c,m)},Fa.prototype.evaluate=function(r){for(var s,c=null,f=0,m=0,b=this.args;m<b.length&&(f++,(c=b[m].evaluate(r))&&c instanceof Ko&&!c.available&&(s||(s=c.name),c=null,f===this.args.length&&(c=s)),null===c);m+=1);return c},Fa.prototype.eachChild=function(r){this.args.forEach(r)},Fa.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},Fa.prototype.serialize=function(){var r=["coalesce"];return this.eachChild(function(s){r.push(s.serialize())}),r};var Ua=function(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s};Ua.prototype.evaluate=function(r){return this.result.evaluate(r)},Ua.prototype.eachChild=function(r){for(var s=0,c=this.bindings;s<c.length;s+=1)r(c[s][1]);r(this.result)},Ua.parse=function(r,s){if(r.length<4)return s.error("Expected at least 3 arguments, but found "+(r.length-1)+" instead.");for(var c=[],f=1;f<r.length-1;f+=2){var m=r[f];if("string"!=typeof m)return s.error("Expected string, but found "+typeof m+" instead.",f);if(/[^a-zA-Z0-9_]/.test(m))return s.error("Variable names must contain only alphanumeric characters or '_'.",f);var b=s.parse(r[f+1],f+1);if(!b)return null;c.push([m,b])}var O=s.parse(r[r.length-1],r.length-1,s.expectedType,c);return O?new Ua(c,O):null},Ua.prototype.outputDefined=function(){return this.result.outputDefined()},Ua.prototype.serialize=function(){for(var r=["let"],s=0,c=this.bindings;s<c.length;s+=1){var f=c[s];r.push(f[0],f[1].serialize())}return r.push(this.result.serialize()),r};var as=function(r,s,c){this.type=r,this.index=s,this.input=c};as.parse=function(r,s){if(3!==r.length)return s.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var c=s.parse(r[1],1,ft),f=s.parse(r[2],2,vi(s.expectedType||Wt));return c&&f?new as(f.type.itemType,c,f):null},as.prototype.evaluate=function(r){var s=this.index.evaluate(r),c=this.input.evaluate(r);if(s<0)throw new Bo("Array index out of bounds: "+s+" < 0.");if(s>=c.length)throw new Bo("Array index out of bounds: "+s+" > "+(c.length-1)+".");if(s!==Math.floor(s))throw new Bo("Array index must be an integer, but found "+s+" instead.");return c[s]},as.prototype.eachChild=function(r){r(this.index),r(this.input)},as.prototype.outputDefined=function(){return!1},as.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Sa=function(r,s){this.type=Jt,this.needle=r,this.haystack=s};Sa.parse=function(r,s){if(3!==r.length)return s.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var c=s.parse(r[1],1,Wt),f=s.parse(r[2],2,Wt);return c&&f?eo(c.type,[Jt,Qt,ft,an,Wt])?new Sa(c,f):s.error("Expected first argument to be of type boolean, string, number or null, but found "+ri(c.type)+" instead"):null},Sa.prototype.evaluate=function(r){var s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!c)return!1;if(!Oi(s,["boolean","string","number","null"]))throw new Bo("Expected first argument to be of type boolean, string, number or null, but found "+ri(to(s))+" instead.");if(!Oi(c,["string","array"]))throw new Bo("Expected second argument to be of type array or string, but found "+ri(to(c))+" instead.");return c.indexOf(s)>=0},Sa.prototype.eachChild=function(r){r(this.needle),r(this.haystack)},Sa.prototype.outputDefined=function(){return!0},Sa.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var qa=function(r,s,c){this.type=ft,this.needle=r,this.haystack=s,this.fromIndex=c};qa.parse=function(r,s){if(r.length<=2||r.length>=5)return s.error("Expected 3 or 4 arguments, but found "+(r.length-1)+" instead.");var c=s.parse(r[1],1,Wt),f=s.parse(r[2],2,Wt);if(!c||!f)return null;if(!eo(c.type,[Jt,Qt,ft,an,Wt]))return s.error("Expected first argument to be of type boolean, string, number or null, but found "+ri(c.type)+" instead");if(4===r.length){var m=s.parse(r[3],3,ft);return m?new qa(c,f,m):null}return new qa(c,f)},qa.prototype.evaluate=function(r){var s=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!Oi(s,["boolean","string","number","null"]))throw new Bo("Expected first argument to be of type boolean, string, number or null, but found "+ri(to(s))+" instead.");if(!Oi(c,["string","array"]))throw new Bo("Expected second argument to be of type array or string, but found "+ri(to(c))+" instead.");if(this.fromIndex){var f=this.fromIndex.evaluate(r);return c.indexOf(s,f)}return c.indexOf(s)},qa.prototype.eachChild=function(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)},qa.prototype.outputDefined=function(){return!1},qa.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Cs=function(r,s,c,f,m,b){this.inputType=r,this.type=s,this.input=c,this.cases=f,this.outputs=m,this.otherwise=b};Cs.parse=function(r,s){if(r.length<5)return s.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if(r.length%2!=1)return s.error("Expected an even number of arguments.");var c,f;s.expectedType&&"value"!==s.expectedType.kind&&(f=s.expectedType);for(var m={},b=[],O=2;O<r.length-1;O+=2){var z=r[O],j=r[O+1];Array.isArray(z)||(z=[z]);var G=s.concat(O);if(0===z.length)return G.error("Expected at least one branch label.");for(var $=0,ee=z;$<ee.length;$+=1){var se=ee[$];if("number"!=typeof se&&"string"!=typeof se)return G.error("Branch labels must be numbers or strings.");if("number"==typeof se&&Math.abs(se)>Number.MAX_SAFE_INTEGER)return G.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof se&&Math.floor(se)!==se)return G.error("Numeric branch labels must be integer values.");if(c){if(G.checkSubtype(c,to(se)))return null}else c=to(se);if(void 0!==m[String(se)])return G.error("Branch labels must be unique.");m[String(se)]=b.length}var ge=s.parse(j,O,f);if(!ge)return null;f=f||ge.type,b.push(ge)}var Me=s.parse(r[1],1,Wt);if(!Me)return null;var Ae=s.parse(r[r.length-1],r.length-1,f);return Ae?"value"!==Me.type.kind&&s.concat(1).checkSubtype(c,Me.type)?null:new Cs(c,f,Me,m,b,Ae):null},Cs.prototype.evaluate=function(r){var s=this.input.evaluate(r);return(to(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)},Cs.prototype.eachChild=function(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)},Cs.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})&&this.otherwise.outputDefined()},Cs.prototype.serialize=function(){for(var r=this,s=["match",this.input.serialize()],c=[],f={},m=0,b=Object.keys(this.cases).sort();m<b.length;m+=1){var O=b[m];void 0===(ee=f[this.cases[O]])?(f[this.cases[O]]=c.length,c.push([this.cases[O],[O]])):c[ee][1].push(O)}for(var z=function(ge){return"number"===r.inputType.kind?Number(ge):ge},j=0,G=c;j<G.length;j+=1){var $=G[j],ee=$[0],se=$[1];s.push(1===se.length?z(se[0]):se.map(z)),s.push(this.outputs[outputIndex$1].serialize())}return s.push(this.otherwise.serialize()),s};var Ja=function(r,s,c){this.type=r,this.branches=s,this.otherwise=c};Ja.parse=function(r,s){if(r.length<4)return s.error("Expected at least 3 arguments, but found only "+(r.length-1)+".");if(r.length%2!=0)return s.error("Expected an odd number of arguments.");var c;s.expectedType&&"value"!==s.expectedType.kind&&(c=s.expectedType);for(var f=[],m=1;m<r.length-1;m+=2){var b=s.parse(r[m],m,Jt);if(!b)return null;var O=s.parse(r[m+1],m+1,c);if(!O)return null;f.push([b,O]),c=c||O.type}var z=s.parse(r[r.length-1],r.length-1,c);return z?new Ja(c,f,z):null},Ja.prototype.evaluate=function(r){for(var s=0,c=this.branches;s<c.length;s+=1){var f=c[s],m=f[1];if(f[0].evaluate(r))return m.evaluate(r)}return this.otherwise.evaluate(r)},Ja.prototype.eachChild=function(r){for(var s=0,c=this.branches;s<c.length;s+=1){var f=c[s],m=f[1];r(f[0]),r(m)}r(this.otherwise)},Ja.prototype.outputDefined=function(){return this.branches.every(function(r){return r[1].outputDefined()})&&this.otherwise.outputDefined()},Ja.prototype.serialize=function(){var r=["case"];return this.eachChild(function(s){r.push(s.serialize())}),r};var ws=function(r,s,c,f){this.type=r,this.input=s,this.beginIndex=c,this.endIndex=f};function gu(r,s){return"=="===r||"!="===r?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function Ec(r,s,c,f){return 0===f.compare(s,c)}function Li(r,s,c){var f="=="!==r&&"!="!==r;return function(){function m(b,O,z){this.type=Jt,this.lhs=b,this.rhs=O,this.collator=z,this.hasUntypedArgument="value"===b.type.kind||"value"===O.type.kind}return m.parse=function(b,O){if(3!==b.length&&4!==b.length)return O.error("Expected two or three arguments.");var z=b[0],j=O.parse(b[1],1,Wt);if(!j)return null;if(!gu(z,j.type))return O.concat(1).error('"'+z+"\" comparisons are not supported for type '"+ri(j.type)+"'.");var G=O.parse(b[2],2,Wt);if(!G)return null;if(!gu(z,G.type))return O.concat(2).error('"'+z+"\" comparisons are not supported for type '"+ri(G.type)+"'.");if(j.type.kind!==G.type.kind&&"value"!==j.type.kind&&"value"!==G.type.kind)return O.error("Cannot compare types '"+ri(j.type)+"' and '"+ri(G.type)+"'.");f&&("value"===j.type.kind&&"value"!==G.type.kind?j=new no(G.type,[j]):"value"!==j.type.kind&&"value"===G.type.kind&&(G=new no(j.type,[G])));var $=null;if(4===b.length){if("string"!==j.type.kind&&"string"!==G.type.kind&&"value"!==j.type.kind&&"value"!==G.type.kind)return O.error("Cannot use collator to compare non-string types.");if(!($=O.parse(b[3],3,li)))return null}return new m(j,G,$)},m.prototype.evaluate=function(b){var O=this.lhs.evaluate(b),z=this.rhs.evaluate(b);if(f&&this.hasUntypedArgument){var j=to(O),G=to(z);if(j.kind!==G.kind||"string"!==j.kind&&"number"!==j.kind)throw new Bo('Expected arguments for "'+r+'" to be (string, string) or (number, number), but found ('+j.kind+", "+G.kind+") instead.")}if(this.collator&&!f&&this.hasUntypedArgument){var $=to(O),ee=to(z);if("string"!==$.kind||"string"!==ee.kind)return s(b,O,z)}return this.collator?c(b,O,z,this.collator.evaluate(b)):s(b,O,z)},m.prototype.eachChild=function(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)},m.prototype.outputDefined=function(){return!0},m.prototype.serialize=function(){var b=[r];return this.eachChild(function(O){b.push(O.serialize())}),b},m}()}ws.parse=function(r,s){if(r.length<=2||r.length>=5)return s.error("Expected 3 or 4 arguments, but found "+(r.length-1)+" instead.");var c=s.parse(r[1],1,Wt),f=s.parse(r[2],2,ft);if(!c||!f)return null;if(!eo(c.type,[vi(Wt),Qt,Wt]))return s.error("Expected first argument to be of type array or string, but found "+ri(c.type)+" instead");if(4===r.length){var m=s.parse(r[3],3,ft);return m?new ws(c.type,c,f,m):null}return new ws(c.type,c,f)},ws.prototype.evaluate=function(r){var s=this.input.evaluate(r),c=this.beginIndex.evaluate(r);if(!Oi(s,["string","array"]))throw new Bo("Expected first argument to be of type array or string, but found "+ri(to(s))+" instead.");if(this.endIndex){var f=this.endIndex.evaluate(r);return s.slice(c,f)}return s.slice(c)},ws.prototype.eachChild=function(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)},ws.prototype.outputDefined=function(){return!1},ws.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Js=Li("==",function(r,s,c){return s===c},Ec),sa=Li("!=",function(r,s,c){return s!==c},function(r,s,c,f){return!Ec(0,s,c,f)}),Ts=Li("<",function(r,s,c){return s<c},function(r,s,c,f){return f.compare(s,c)<0}),ul=Li(">",function(r,s,c){return s>c},function(r,s,c,f){return f.compare(s,c)>0}),ss=Li("<=",function(r,s,c){return s<=c},function(r,s,c,f){return f.compare(s,c)<=0}),_u=Li(">=",function(r,s,c){return s>=c},function(r,s,c,f){return f.compare(s,c)>=0}),ja=function(r,s,c,f,m){this.type=Qt,this.number=r,this.locale=s,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=m};ja.parse=function(r,s){if(3!==r.length)return s.error("Expected two arguments.");var c=s.parse(r[1],1,ft);if(!c)return null;var f=r[2];if("object"!=typeof f||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");var m=null;if(f.locale&&!(m=s.parse(f.locale,1,Qt)))return null;var b=null;if(f.currency&&!(b=s.parse(f.currency,1,Qt)))return null;var O=null;if(f["min-fraction-digits"]&&!(O=s.parse(f["min-fraction-digits"],1,ft)))return null;var z=null;return f["max-fraction-digits"]&&!(z=s.parse(f["max-fraction-digits"],1,ft))?null:new ja(c,m,b,O,z)},ja.prototype.evaluate=function(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))},ja.prototype.eachChild=function(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)},ja.prototype.outputDefined=function(){return!1},ja.prototype.serialize=function(){var r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]};var la=function(r){this.type=ft,this.input=r};la.parse=function(r,s){if(2!==r.length)return s.error("Expected 1 argument, but found "+(r.length-1)+" instead.");var c=s.parse(r[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?s.error("Expected argument of type string or array, but found "+ri(c.type)+" instead."):new la(c):null},la.prototype.evaluate=function(r){var s=this.input.evaluate(r);if("string"==typeof s||Array.isArray(s))return s.length;throw new Bo("Expected value to be of type string or array, but found "+ri(to(s))+" instead.")},la.prototype.eachChild=function(r){r(this.input)},la.prototype.outputDefined=function(){return!1},la.prototype.serialize=function(){var r=["length"];return this.eachChild(function(s){r.push(s.serialize())}),r};var Gr={"==":Js,"!=":sa,">":ul,"<":Ts,">=":_u,"<=":ss,array:no,at:as,boolean:no,case:Ja,coalesce:Fa,collator:Je,format:Ma,image:Jr,in:Sa,"index-of":qa,interpolate:Lo,"interpolate-hcl":Lo,"interpolate-lab":Lo,length:la,let:Ua,literal:nr,match:Cs,number:no,"number-format":ja,object:no,slice:ws,step:Hi,string:no,"to-boolean":jr,"to-color":jr,"to-number":jr,"to-string":jr,var:xr,within:ci};function Ac(r,s){var c=s[0],f=s[1],m=s[2],b=s[3];c=c.evaluate(r),f=f.evaluate(r),m=m.evaluate(r);var O=b?b.evaluate(r):1,z=rs(c,f,m,O);if(z)throw new Bo(z);return new wi(c/255*O,f/255*O,m/255*O,O)}function mu(r,s){return r in s}function kc(r,s){var c=s[r];return void 0===c?null:c}function Ms(r){return{type:r}}function ac(r){return{result:"success",value:r}}function ca(r){return{result:"error",value:r}}function Vr(r){return"data-driven"===r["property-type"]||"cross-faded-data-driven"===r["property-type"]}function Ic(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Yr(r){return!!r.expression&&r.expression.interpolated}function Vi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":null===r?"null":typeof r}function Ba(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)}function yu(r){return r}function pl(r,s,c){return void 0!==r?r:void 0!==s?s:void 0!==c?c:void 0}function El(r,s,c,f,m){return pl(typeof c===m?f[c]:void 0,r.default,s.default)}function Zc(r,s,c){if("number"!==Vi(c))return pl(r.default,s.default);var f=r.stops.length;if(1===f||c<=r.stops[0][0])return r.stops[0][1];if(c>=r.stops[f-1][0])return r.stops[f-1][1];var m=Ir(r.stops.map(function(b){return b[0]}),c);return r.stops[m][1]}function Nc(r,s,c){var f=void 0!==r.base?r.base:1;if("number"!==Vi(c))return pl(r.default,s.default);var m=r.stops.length;if(1===m||c<=r.stops[0][0])return r.stops[0][1];if(c>=r.stops[m-1][0])return r.stops[m-1][1];var se,ge,Ae,Fe,b=Ir(r.stops.map(function(ee){return ee[0]}),c),O=(se=f,Fe=c-(ge=r.stops[b][0]),0==(Ae=r.stops[b+1][0]-ge)?0:1===se?Fe/Ae:(Math.pow(se,Fe)-1)/(Math.pow(se,Ae)-1)),z=r.stops[b][1],j=r.stops[b+1][1],G=xs[s.type]||yu;if(r.colorSpace&&"rgb"!==r.colorSpace){var $=fu[r.colorSpace];G=function(ee,se){return $.reverse($.interpolate($.forward(ee),$.forward(se),O))}}return"function"==typeof z.evaluate?{evaluate:function(){for(var ee=[],se=arguments.length;se--;)ee[se]=arguments[se];var ge=z.evaluate.apply(void 0,ee),Me=j.evaluate.apply(void 0,ee);if(void 0!==ge&&void 0!==Me)return G(ge,Me,O)}}:G(z,j,O)}function Al(r,s,c){return"color"===s.type?c=wi.parse(c):"formatted"===s.type?c=Yi.fromString(c.toString()):"resolvedImage"===s.type?c=Ko.fromString(c.toString()):Vi(c)===s.type||"enum"===s.type&&s.values[c]||(c=void 0),pl(c,r.default,s.default)}Y.register(Gr,{error:[{kind:"error"},[Qt],function(r,s){throw new Bo(s[0].evaluate(r))}],typeof:[Qt,[Wt],function(r,s){return ri(to(s[0].evaluate(r)))}],"to-rgba":[vi(ft,4),[Yt],function(r,s){return s[0].evaluate(r).toArray()}],rgb:[Yt,[ft,ft,ft],Ac],rgba:[Yt,[ft,ft,ft,ft],Ac],has:{type:Jt,overloads:[[[Qt],function(r,s){return mu(s[0].evaluate(r),r.properties())}],[[Qt,Gn],function(r,s){var c=s[1];return mu(s[0].evaluate(r),c.evaluate(r))}]]},get:{type:Wt,overloads:[[[Qt],function(r,s){return kc(s[0].evaluate(r),r.properties())}],[[Qt,Gn],function(r,s){var c=s[1];return kc(s[0].evaluate(r),c.evaluate(r))}]]},"feature-state":[Wt,[Qt],function(r,s){return kc(s[0].evaluate(r),r.featureState||{})}],properties:[Gn,[],function(r){return r.properties()}],"geometry-type":[Qt,[],function(r){return r.geometryType()}],id:[Wt,[],function(r){return r.id()}],zoom:[ft,[],function(r){return r.globals.zoom}],"heatmap-density":[ft,[],function(r){return r.globals.heatmapDensity||0}],"line-progress":[ft,[],function(r){return r.globals.lineProgress||0}],accumulated:[Wt,[],function(r){return void 0===r.globals.accumulated?null:r.globals.accumulated}],"+":[ft,Ms(ft),function(r,s){for(var c=0,f=0,m=s;f<m.length;f+=1)c+=m[f].evaluate(r);return c}],"*":[ft,Ms(ft),function(r,s){for(var c=1,f=0,m=s;f<m.length;f+=1)c*=m[f].evaluate(r);return c}],"-":{type:ft,overloads:[[[ft,ft],function(r,s){var c=s[1];return s[0].evaluate(r)-c.evaluate(r)}],[[ft],function(r,s){return-s[0].evaluate(r)}]]},"/":[ft,[ft,ft],function(r,s){var c=s[1];return s[0].evaluate(r)/c.evaluate(r)}],"%":[ft,[ft,ft],function(r,s){var c=s[1];return s[0].evaluate(r)%c.evaluate(r)}],ln2:[ft,[],function(){return Math.LN2}],pi:[ft,[],function(){return Math.PI}],e:[ft,[],function(){return Math.E}],"^":[ft,[ft,ft],function(r,s){var c=s[1];return Math.pow(s[0].evaluate(r),c.evaluate(r))}],sqrt:[ft,[ft],function(r,s){return Math.sqrt(s[0].evaluate(r))}],log10:[ft,[ft],function(r,s){return Math.log(s[0].evaluate(r))/Math.LN10}],ln:[ft,[ft],function(r,s){return Math.log(s[0].evaluate(r))}],log2:[ft,[ft],function(r,s){return Math.log(s[0].evaluate(r))/Math.LN2}],sin:[ft,[ft],function(r,s){return Math.sin(s[0].evaluate(r))}],cos:[ft,[ft],function(r,s){return Math.cos(s[0].evaluate(r))}],tan:[ft,[ft],function(r,s){return Math.tan(s[0].evaluate(r))}],asin:[ft,[ft],function(r,s){return Math.asin(s[0].evaluate(r))}],acos:[ft,[ft],function(r,s){return Math.acos(s[0].evaluate(r))}],atan:[ft,[ft],function(r,s){return Math.atan(s[0].evaluate(r))}],min:[ft,Ms(ft),function(r,s){return Math.min.apply(Math,s.map(function(c){return c.evaluate(r)}))}],max:[ft,Ms(ft),function(r,s){return Math.max.apply(Math,s.map(function(c){return c.evaluate(r)}))}],abs:[ft,[ft],function(r,s){return Math.abs(s[0].evaluate(r))}],round:[ft,[ft],function(r,s){var c=s[0].evaluate(r);return c<0?-Math.round(-c):Math.round(c)}],floor:[ft,[ft],function(r,s){return Math.floor(s[0].evaluate(r))}],ceil:[ft,[ft],function(r,s){return Math.ceil(s[0].evaluate(r))}],"filter-==":[Jt,[Qt,Wt],function(r,s){var c=s[0],f=s[1];return r.properties()[c.value]===f.value}],"filter-id-==":[Jt,[Wt],function(r,s){var c=s[0];return r.id()===c.value}],"filter-type-==":[Jt,[Qt],function(r,s){var c=s[0];return r.geometryType()===c.value}],"filter-<":[Jt,[Qt,Wt],function(r,s){var c=s[0],f=s[1],m=r.properties()[c.value],b=f.value;return typeof m==typeof b&&m<b}],"filter-id-<":[Jt,[Wt],function(r,s){var c=s[0],f=r.id(),m=c.value;return typeof f==typeof m&&f<m}],"filter->":[Jt,[Qt,Wt],function(r,s){var c=s[0],f=s[1],m=r.properties()[c.value],b=f.value;return typeof m==typeof b&&m>b}],"filter-id->":[Jt,[Wt],function(r,s){var c=s[0],f=r.id(),m=c.value;return typeof f==typeof m&&f>m}],"filter-<=":[Jt,[Qt,Wt],function(r,s){var c=s[0],f=s[1],m=r.properties()[c.value],b=f.value;return typeof m==typeof b&&m<=b}],"filter-id-<=":[Jt,[Wt],function(r,s){var c=s[0],f=r.id(),m=c.value;return typeof f==typeof m&&f<=m}],"filter->=":[Jt,[Qt,Wt],function(r,s){var c=s[0],f=s[1],m=r.properties()[c.value],b=f.value;return typeof m==typeof b&&m>=b}],"filter-id->=":[Jt,[Wt],function(r,s){var c=s[0],f=r.id(),m=c.value;return typeof f==typeof m&&f>=m}],"filter-has":[Jt,[Wt],function(r,s){return s[0].value in r.properties()}],"filter-has-id":[Jt,[],function(r){return null!==r.id()&&void 0!==r.id()}],"filter-type-in":[Jt,[vi(Qt)],function(r,s){return s[0].value.indexOf(r.geometryType())>=0}],"filter-id-in":[Jt,[vi(Wt)],function(r,s){return s[0].value.indexOf(r.id())>=0}],"filter-in-small":[Jt,[Qt,vi(Wt)],function(r,s){var c=s[0];return s[1].value.indexOf(r.properties()[c.value])>=0}],"filter-in-large":[Jt,[Qt,vi(Wt)],function(r,s){var c=s[0],f=s[1];return function(m,b,O,z){for(;O<=z;){var j=O+z>>1;if(b[j]===m)return!0;b[j]>m?z=j-1:O=j+1}return!1}(r.properties()[c.value],f.value,0,f.value.length-1)}],all:{type:Jt,overloads:[[[Jt,Jt],function(r,s){var c=s[1];return s[0].evaluate(r)&&c.evaluate(r)}],[Ms(Jt),function(r,s){for(var c=0,f=s;c<f.length;c+=1)if(!f[c].evaluate(r))return!1;return!0}]]},any:{type:Jt,overloads:[[[Jt,Jt],function(r,s){var c=s[1];return s[0].evaluate(r)||c.evaluate(r)}],[Ms(Jt),function(r,s){for(var c=0,f=s;c<f.length;c+=1)if(f[c].evaluate(r))return!0;return!1}]]},"!":[Jt,[Jt],function(r,s){return!s[0].evaluate(r)}],"is-supported-script":[Jt,[Qt],function(r,s){var c=r.globals&&r.globals.isSupportedScript;return!c||c(s[0].evaluate(r))}],upcase:[Qt,[Qt],function(r,s){return s[0].evaluate(r).toUpperCase()}],downcase:[Qt,[Qt],function(r,s){return s[0].evaluate(r).toLowerCase()}],concat:[Qt,Ms(Wt),function(r,s){return s.map(function(c){return nc(c.evaluate(r))}).join("")}],"resolved-locale":[Qt,[li],function(r,s){return s[0].evaluate(r).resolvedLocale()}]});var js=function(r,s){var c;this.expression=r,this._warningHistory={},this._evaluator=new B,this._defaultValue=s?"color"===(c=s).type&&Ba(c.default)?new wi(0,0,0,0):"color"===c.type?wi.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=s&&"enum"===s.type?s.values:null};function ls(r){return Array.isArray(r)&&r.length>0&&"string"==typeof r[0]&&r[0]in Gr}function kl(r,s){var m,b,c=new ui(Gr,[],s?(b={color:Yt,string:Qt,number:ft,enum:Qt,boolean:Jt,formatted:zi,resolvedImage:zn},"array"===(m=s).type?vi(b[m.value]||Wt,m.length):b[m.type]):void 0),f=c.parse(r,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return f?ac(new js(f,s)):ca(c.errors)}js.prototype.evaluateWithoutErrorHandling=function(r,s,c,f,m,b){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=f,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)},js.prototype.evaluate=function(r,s,c,f,m,b){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=b||null;try{var O=this.expression.evaluate(this._evaluator);if(null==O||"number"==typeof O&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new Bo("Expected value to be one of "+Object.keys(this._enumValues).map(function(z){return JSON.stringify(z)}).join(", ")+", but found "+JSON.stringify(O)+" instead.");return O}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(z.message)),this._defaultValue}};var Il=function(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent="constant"!==r&&!Tn(s.expression)};Il.prototype.evaluateWithoutErrorHandling=function(r,s,c,f,m,b){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,f,m,b)},Il.prototype.evaluate=function(r,s,c,f,m,b){return this._styleExpression.evaluate(r,s,c,f,m,b)};var Ke=function(r,s,c,f){this.kind=r,this.zoomStops=c,this._styleExpression=s,this.isStateDependent="camera"!==r&&!Tn(s.expression),this.interpolationType=f};function Ct(r,s){if("error"===(r=kl(r,s)).result)return r;var c=r.value.expression,f=Ji(c);if(!f&&!Vr(s))return ca([new At("","data expressions not supported")]);var m=Br(c,["zoom"]);if(!m&&!Ic(s))return ca([new At("","zoom expressions not supported")]);var b=function O(z){var j=null;if(z instanceof Ua)j=O(z.result);else if(z instanceof Fa)for(var G=0,$=z.args;G<$.length&&!(j=O($[G]));G+=1);else(z instanceof Hi||z instanceof Lo)&&z.input instanceof Y&&"zoom"===z.input.name&&(j=z);return j instanceof At||z.eachChild(function(ee){var se=O(ee);se instanceof At?j=se:!j&&se?j=new At("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):j&&se&&j!==se&&(j=new At("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),j}(c);return b||m?b instanceof At?ca([b]):b instanceof Lo&&!Yr(s)?ca([new At("",'"interpolate" expressions cannot be used with this property')]):ac(b?new Ke(f?"camera":"composite",r.value,b.labels,b instanceof Lo?b.interpolation:void 0):new Il(f?"constant":"source",r.value)):ca([new At("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Ke.prototype.evaluateWithoutErrorHandling=function(r,s,c,f,m,b){return this._styleExpression.evaluateWithoutErrorHandling(r,s,c,f,m,b)},Ke.prototype.evaluate=function(r,s,c,f,m,b){return this._styleExpression.evaluate(r,s,c,f,m,b)},Ke.prototype.interpolationFactor=function(r,s,c){return this.interpolationType?Lo.interpolationFactor(this.interpolationType,r,s,c):0};var en=function(r,s){this._parameters=r,this._specification=s,Mt(this,function c(f,m){var b,O,z,j="color"===m.type,G=f.stops&&"object"==typeof f.stops[0][0],$=G||!(G||void 0!==f.property),ee=f.type||(Yr(m)?"exponential":"interval");if(j&&((f=Mt({},f)).stops&&(f.stops=f.stops.map(function(on){return[on[0],wi.parse(on[1])]})),f.default=wi.parse(f.default?f.default:m.default)),f.colorSpace&&"rgb"!==f.colorSpace&&!fu[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if("exponential"===ee)b=Nc;else if("interval"===ee)b=Zc;else if("categorical"===ee){b=El,O=Object.create(null);for(var se=0,ge=f.stops;se<ge.length;se+=1){var Me=ge[se];O[Me[0]]=Me[1]}z=typeof f.stops[0][0]}else{if("identity"!==ee)throw new Error('Unknown function type "'+ee+'"');b=Al}if(G){for(var Ae={},Fe=[],ze=0;ze<f.stops.length;ze++){var Ve=f.stops[ze],nt=Ve[0].zoom;void 0===Ae[nt]&&(Ae[nt]={zoom:nt,type:f.type,property:f.property,default:f.default,stops:[]},Fe.push(nt)),Ae[nt].stops.push([Ve[0].value,Ve[1]])}for(var lt=[],gt=0,wt=Fe;gt<wt.length;gt+=1){var zt=wt[gt];lt.push([Ae[zt].zoom,c(Ae[zt],m)])}var jt={name:"linear"};return{kind:"composite",interpolationType:jt,interpolationFactor:Lo.interpolationFactor.bind(void 0,jt),zoomStops:lt.map(function(on){return on[0]}),evaluate:function(on,On){var rn=on.zoom;return Nc({stops:lt,base:f.base},m,rn).evaluate(rn,On)}}}if($){var vn="exponential"===ee?{name:"exponential",base:void 0!==f.base?f.base:1}:null;return{kind:"camera",interpolationType:vn,interpolationFactor:Lo.interpolationFactor.bind(void 0,vn),zoomStops:f.stops.map(function(on){return on[0]}),evaluate:function(on){return b(f,m,on.zoom,O,z)}}}return{kind:"source",evaluate:function(on,On){var rn=On&&On.properties?On.properties[f.property]:void 0;return void 0===rn?pl(f.default,m.default):b(f,m,rn,O,z)}}}(this._parameters,this._specification))};function xn(r){var s=r.key,c=r.value,f=r.valueSpec||{},m=r.objectElementValidators||{},b=r.style,O=r.styleSpec,z=[],j=Vi(c);if("object"!==j)return[new Ze(s,c,"object expected, "+j+" found")];for(var G in c){var $=G.split(".")[0],ee=f[$]||f["*"],se=void 0;if(m[$])se=m[$];else if(f[$])se=Wn;else if(m["*"])se=m["*"];else{if(!f["*"]){z.push(new Ze(s,c[G],'unknown property "'+G+'"'));continue}se=Wn}z=z.concat(se({key:(s&&s+".")+G,value:c[G],valueSpec:ee,style:b,styleSpec:O,object:c,objectKey:G},c))}for(var ge in f)m[ge]||f[ge].required&&void 0===f[ge].default&&void 0===c[ge]&&z.push(new Ze(s,c,'missing required property "'+ge+'"'));return z}function io(r){var s=r.value,c=r.valueSpec,f=r.style,m=r.styleSpec,b=r.key,O=r.arrayElementValidator||Wn;if("array"!==Vi(s))return[new Ze(b,s,"array expected, "+Vi(s)+" found")];if(c.length&&s.length!==c.length)return[new Ze(b,s,"array length "+c.length+" expected, length "+s.length+" found")];if(c["min-length"]&&s.length<c["min-length"])return[new Ze(b,s,"array length at least "+c["min-length"]+" expected, length "+s.length+" found")];var z={type:c.value,values:c.values};m.$version<7&&(z.function=c.function),"object"===Vi(c.value)&&(z=c.value);for(var j=[],G=0;G<s.length;G++)j=j.concat(O({array:s,arrayIndex:G,value:s[G],valueSpec:z,style:f,styleSpec:m,key:b+"["+G+"]"}));return j}function bi(r){var s=r.key,c=r.value,f=r.valueSpec,m=Vi(c);return"number"===m&&c!=c&&(m="NaN"),"number"!==m?[new Ze(s,c,"number expected, "+m+" found")]:"minimum"in f&&c<f.minimum?[new Ze(s,c,c+" is less than the minimum value "+f.minimum)]:"maximum"in f&&c>f.maximum?[new Ze(s,c,c+" is greater than the maximum value "+f.maximum)]:[]}function uo(r){var s,c,f,m=r.valueSpec,b=It(r.value.type),O={},z="categorical"!==b&&void 0===r.value.property,j=!z,G="array"===Vi(r.value.stops)&&"array"===Vi(r.value.stops[0])&&"object"===Vi(r.value.stops[0][0]),$=xn({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(ge){if("identity"===b)return[new Ze(ge.key,ge.value,'identity function may not have a "stops" property')];var Me=[],Ae=ge.value;return Me=Me.concat(io({key:ge.key,value:Ae,valueSpec:ge.valueSpec,style:ge.style,styleSpec:ge.styleSpec,arrayElementValidator:ee})),"array"===Vi(Ae)&&0===Ae.length&&Me.push(new Ze(ge.key,Ae,"array must have at least one stop")),Me},default:function(ge){return Wn({key:ge.key,value:ge.value,valueSpec:m,style:ge.style,styleSpec:ge.styleSpec})}}});return"identity"===b&&z&&$.push(new Ze(r.key,r.value,'missing required property "property"')),"identity"===b||r.value.stops||$.push(new Ze(r.key,r.value,'missing required property "stops"')),"exponential"===b&&r.valueSpec.expression&&!Yr(r.valueSpec)&&$.push(new Ze(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(j&&!Vr(r.valueSpec)?$.push(new Ze(r.key,r.value,"property functions not supported")):z&&!Ic(r.valueSpec)&&$.push(new Ze(r.key,r.value,"zoom functions not supported"))),"categorical"!==b&&!G||void 0!==r.value.property||$.push(new Ze(r.key,r.value,'"property" property is required')),$;function ee(ge){var Me=[],Ae=ge.value,Fe=ge.key;if("array"!==Vi(Ae))return[new Ze(Fe,Ae,"array expected, "+Vi(Ae)+" found")];if(2!==Ae.length)return[new Ze(Fe,Ae,"array length 2 expected, length "+Ae.length+" found")];if(G){if("object"!==Vi(Ae[0]))return[new Ze(Fe,Ae,"object expected, "+Vi(Ae[0])+" found")];if(void 0===Ae[0].zoom)return[new Ze(Fe,Ae,"object stop key must have zoom")];if(void 0===Ae[0].value)return[new Ze(Fe,Ae,"object stop key must have value")];if(f&&f>It(Ae[0].zoom))return[new Ze(Fe,Ae[0].zoom,"stop zoom values must appear in ascending order")];It(Ae[0].zoom)!==f&&(f=It(Ae[0].zoom),c=void 0,O={}),Me=Me.concat(xn({key:Fe+"[0]",value:Ae[0],valueSpec:{zoom:{}},style:ge.style,styleSpec:ge.styleSpec,objectElementValidators:{zoom:bi,value:se}}))}else Me=Me.concat(se({key:Fe+"[0]",value:Ae[0],valueSpec:{},style:ge.style,styleSpec:ge.styleSpec},Ae));return ls(ht(Ae[1]))?Me.concat([new Ze(Fe+"[1]",Ae[1],"expressions are not allowed in function stops.")]):Me.concat(Wn({key:Fe+"[1]",value:Ae[1],valueSpec:m,style:ge.style,styleSpec:ge.styleSpec}))}function se(ge,Me){var Ae=Vi(ge.value),Fe=It(ge.value),ze=null!==ge.value?ge.value:Me;if(s){if(Ae!==s)return[new Ze(ge.key,ze,Ae+" stop domain type must match previous stop domain type "+s)]}else s=Ae;if("number"!==Ae&&"string"!==Ae&&"boolean"!==Ae)return[new Ze(ge.key,ze,"stop domain value must be a number, string, or boolean")];if("number"!==Ae&&"categorical"!==b){var Ve="number expected, "+Ae+" found";return Vr(m)&&void 0===b&&(Ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ze(ge.key,ze,Ve)]}return"categorical"!==b||"number"!==Ae||isFinite(Fe)&&Math.floor(Fe)===Fe?"categorical"!==b&&"number"===Ae&&void 0!==c&&Fe<c?[new Ze(ge.key,ze,"stop domain values must appear in ascending order")]:(c=Fe,"categorical"===b&&Fe in O?[new Ze(ge.key,ze,"stop domain values must be unique")]:(O[Fe]=!0,[])):[new Ze(ge.key,ze,"integer expected, found "+Fe)]}}function oo(r){var s=("property"===r.expressionContext?Ct:kl)(ht(r.value),r.valueSpec);if("error"===s.result)return s.value.map(function(f){return new Ze(""+r.key+f.key,r.value,f.message)});var c=s.value.expression||s.value._styleExpression.expression;if("property"===r.expressionContext&&"text-font"===r.propertyKey&&!c.outputDefined())return[new Ze(r.key,r.value,'Invalid data expression for "'+r.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===r.expressionContext&&"layout"===r.propertyType&&!Tn(c))return[new Ze(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===r.expressionContext&&!Tn(c))return[new Ze(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&0===r.expressionContext.indexOf("cluster")){if(!Br(c,["zoom","feature-state"]))return[new Ze(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===r.expressionContext&&!Ji(c))return[new Ze(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cr(r){var s=r.key,c=r.value,f=r.valueSpec,m=[];return Array.isArray(f.values)?-1===f.values.indexOf(It(c))&&m.push(new Ze(s,c,"expected one of ["+f.values.join(", ")+"], "+JSON.stringify(c)+" found")):-1===Object.keys(f.values).indexOf(It(c))&&m.push(new Ze(s,c,"expected one of ["+Object.keys(f.values).join(", ")+"], "+JSON.stringify(c)+" found")),m}function xo(r){if(!0===r||!1===r)return!0;if(!Array.isArray(r)||0===r.length)return!1;switch(r[0]){case"has":return r.length>=2&&"$id"!==r[1]&&"$type"!==r[1];case"in":return r.length>=3&&("string"!=typeof r[1]||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==r.length||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(var s=0,c=r.slice(1);s<c.length;s+=1){var f=c[s];if(!xo(f)&&"boolean"!=typeof f)return!1}return!0;default:return!0}}en.deserialize=function(r){return new en(r._parameters,r._specification)},en.serialize=function(r){return{_parameters:r._parameters,_specification:r._specification}};var Ao={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Hr(r){if(null==r)return{filter:function(){return!0},needGeometry:!1};xo(r)||(r=$o(r));var s=kl(r,Ao);if("error"===s.result)throw new Error(s.value.map(function(c){return c.key+": "+c.message}).join(", "));return{filter:function(c,f,m){return s.value.evaluate(c,f,{},m)},needGeometry:function c(f){if(!Array.isArray(f))return!1;if("within"===f[0])return!0;for(var m=1;m<f.length;m++)if(c(f[m]))return!0;return!1}(r)}}function cs(r,s){return r<s?-1:r>s?1:0}function $o(r){if(!r)return!0;var s,c=r[0];return r.length<=1?"any"!==c:"=="===c?Pa(r[1],r[2],"=="):"!="===c?wr(Pa(r[1],r[2],"==")):"<"===c||">"===c||"<="===c||">="===c?Pa(r[1],r[2],c):"any"===c?(s=r.slice(1),["any"].concat(s.map($o))):"all"===c?["all"].concat(r.slice(1).map($o)):"none"===c?["all"].concat(r.slice(1).map($o).map(wr)):"in"===c?Bs(r[1],r.slice(2)):"!in"===c?wr(Bs(r[1],r.slice(2))):"has"===c?dl(r[1]):"!has"===c?wr(dl(r[1])):"within"!==c||r}function Pa(r,s,c){switch(r){case"$type":return["filter-type-"+c,s];case"$id":return["filter-id-"+c,s];default:return["filter-"+c,r,s]}}function Bs(r,s){if(0===s.length)return!1;switch(r){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(function(c){return typeof c!=typeof s[0]})?["filter-in-large",r,["literal",s.sort(cs)]]:["filter-in-small",r,["literal",s]]}}function dl(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function wr(r){return["!",r]}function Gs(r){return xo(ht(r.value))?oo(Mt({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function s(c){var f=c.value,m=c.key;if("array"!==Vi(f))return[new Ze(m,f,"array expected, "+Vi(f)+" found")];var b,O=c.styleSpec,z=[];if(f.length<1)return[new Ze(m,f,"filter array must have at least 1 element")];switch(z=z.concat(Cr({key:m+"[0]",value:f[0],valueSpec:O.filter_operator,style:c.style,styleSpec:c.styleSpec})),It(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&"$type"===It(f[1])&&z.push(new Ze(m,f,'"$type" cannot be use with operator "'+f[0]+'"'));case"==":case"!=":3!==f.length&&z.push(new Ze(m,f,'filter array for operator "'+f[0]+'" must have 3 elements'));case"in":case"!in":f.length>=2&&"string"!==(b=Vi(f[1]))&&z.push(new Ze(m+"[1]",f[1],"string expected, "+b+" found"));for(var j=2;j<f.length;j++)b=Vi(f[j]),"$type"===It(f[1])?z=z.concat(Cr({key:m+"["+j+"]",value:f[j],valueSpec:O.geometry_type,style:c.style,styleSpec:c.styleSpec})):"string"!==b&&"number"!==b&&"boolean"!==b&&z.push(new Ze(m+"["+j+"]",f[j],"string, number, or boolean expected, "+b+" found"));break;case"any":case"all":case"none":for(var G=1;G<f.length;G++)z=z.concat(s({key:m+"["+G+"]",value:f[G],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":b=Vi(f[1]),2!==f.length?z.push(new Ze(m,f,'filter array for "'+f[0]+'" operator must have 2 elements')):"string"!==b&&z.push(new Ze(m+"[1]",f[1],"string expected, "+b+" found"));break;case"within":b=Vi(f[1]),2!==f.length?z.push(new Ze(m,f,'filter array for "'+f[0]+'" operator must have 2 elements')):"object"!==b&&z.push(new Ze(m+"[1]",f[1],"object expected, "+b+" found"))}return z}(r)}function sc(r,s){var c=r.key,f=r.style,m=r.styleSpec,b=r.value,O=r.objectKey,z=m[s+"_"+r.layerType];if(!z)return[];var j=O.match(/^(.*)-transition$/);if("paint"===s&&j&&z[j[1]]&&z[j[1]].transition)return Wn({key:c,value:b,valueSpec:m.transition,style:f,styleSpec:m});var G,$=r.valueSpec||z[O];if(!$)return[new Ze(c,b,'unknown property "'+O+'"')];if("string"===Vi(b)&&Vr($)&&!$.tokens&&(G=/^{([^}]+)}$/.exec(b)))return[new Ze(c,b,'"'+O+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(G[1])+" }`.")];var ee=[];return"symbol"===r.layerType&&("text-field"===O&&f&&!f.glyphs&&ee.push(new Ze(c,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===O&&Ba(ht(b))&&"identity"===It(b.type)&&ee.push(new Ze(c,b,'"text-font" does not support identity functions'))),ee.concat(Wn({key:r.key,value:b,valueSpec:$,style:f,styleSpec:m,expressionContext:"property",propertyType:s,propertyKey:O}))}function lc(r){return sc(r,"paint")}function Zl(r){return sc(r,"layout")}function Qi(r){var s=[],c=r.value,f=r.key,m=r.style,b=r.styleSpec;c.type||c.ref||s.push(new Ze(f,c,'either "type" or "ref" is required'));var O,z=It(c.type),j=It(c.ref);if(c.id)for(var G=It(c.id),$=0;$<r.arrayIndex;$++){var ee=m.layers[$];It(ee.id)===G&&s.push(new Ze(f,c.id,'duplicate layer id "'+c.id+'", previously used at line '+ee.id.__line__))}if("ref"in c)["type","source","source-layer","filter","layout"].forEach(function(Me){Me in c&&s.push(new Ze(f,c[Me],'"'+Me+'" is prohibited for ref layers'))}),m.layers.forEach(function(Me){It(Me.id)===j&&(O=Me)}),O?O.ref?s.push(new Ze(f,c.ref,"ref cannot reference another ref layer")):z=It(O.type):s.push(new Ze(f,c.ref,'ref layer "'+j+'" not found'));else if("background"!==z)if(c.source){var se=m.sources&&m.sources[c.source],ge=se&&It(se.type);se?"vector"===ge&&"raster"===z?s.push(new Ze(f,c.source,'layer "'+c.id+'" requires a raster source')):"raster"===ge&&"raster"!==z?s.push(new Ze(f,c.source,'layer "'+c.id+'" requires a vector source')):"vector"!==ge||c["source-layer"]?"raster-dem"===ge&&"hillshade"!==z?s.push(new Ze(f,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==z||!c.paint||!c.paint["line-gradient"]||"geojson"===ge&&se.lineMetrics||s.push(new Ze(f,c,'layer "'+c.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):s.push(new Ze(f,c,'layer "'+c.id+'" must specify a "source-layer"')):s.push(new Ze(f,c.source,'source "'+c.source+'" not found'))}else s.push(new Ze(f,c,'missing required property "source"'));return s=s.concat(xn({key:f,value:c,valueSpec:b.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Wn({key:f+".type",value:c.type,valueSpec:b.layer.type,style:r.style,styleSpec:r.styleSpec,object:c,objectKey:"type"})},filter:Gs,layout:function(Me){return xn({layer:c,key:Me.key,value:Me.value,style:Me.style,styleSpec:Me.styleSpec,objectElementValidators:{"*":function(Ae){return Zl(Mt({layerType:z},Ae))}}})},paint:function(Me){return xn({layer:c,key:Me.key,value:Me.value,style:Me.style,styleSpec:Me.styleSpec,objectElementValidators:{"*":function(Ae){return lc(Mt({layerType:z},Ae))}}})}}}))}function Si(r){var s=r.value,c=r.key,f=Vi(s);return"string"!==f?[new Ze(c,s,"string expected, "+f+" found")]:[]}var ji={promoteId:function(r){var s=r.key,c=r.value;if("string"===Vi(c))return Si({key:s,value:c});var f=[];for(var m in c)f.push.apply(f,Si({key:s+"."+m,value:c[m]}));return f}};function Ga(r){var s=r.value,c=r.key,f=r.styleSpec,m=r.style;if(!s.type)return[new Ze(c,s,'"type" is required')];var b,O=It(s.type);switch(O){case"vector":case"raster":case"raster-dem":return xn({key:c,value:s,valueSpec:f["source_"+O.replace("-","_")],style:r.style,styleSpec:f,objectElementValidators:ji});case"geojson":if(b=xn({key:c,value:s,valueSpec:f.source_geojson,style:m,styleSpec:f,objectElementValidators:ji}),s.cluster)for(var z in s.clusterProperties){var j=s.clusterProperties[z],G=j[0],$="string"==typeof G?[G,["accumulated"],["get",z]]:G;b.push.apply(b,oo({key:c+"."+z+".map",value:j[1],expressionContext:"cluster-map"})),b.push.apply(b,oo({key:c+"."+z+".reduce",value:$,expressionContext:"cluster-reduce"}))}return b;case"video":return xn({key:c,value:s,valueSpec:f.source_video,style:m,styleSpec:f});case"image":return xn({key:c,value:s,valueSpec:f.source_image,style:m,styleSpec:f});case"canvas":return[new Ze(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Cr({key:c+".type",value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,styleSpec:f})}}function Va(r){var s=r.value,c=r.styleSpec,f=c.light,m=r.style,b=[],O=Vi(s);if(void 0===s)return b;if("object"!==O)return b.concat([new Ze("light",s,"object expected, "+O+" found")]);for(var z in s){var j=z.match(/^(.*)-transition$/);b=b.concat(j&&f[j[1]]&&f[j[1]].transition?Wn({key:z,value:s[z],valueSpec:c.transition,style:m,styleSpec:c}):f[z]?Wn({key:z,value:s[z],valueSpec:f[z],style:m,styleSpec:c}):[new Ze(z,s[z],'unknown property "'+z+'"')])}return b}var Go={"*":function(){return[]},array:io,boolean:function(r){var s=r.value,c=r.key,f=Vi(s);return"boolean"!==f?[new Ze(c,s,"boolean expected, "+f+" found")]:[]},number:bi,color:function(r){var s=r.key,c=r.value,f=Vi(c);return"string"!==f?[new Ze(s,c,"color expected, "+f+" found")]:null===Zn(c)?[new Ze(s,c,'color expected, "'+c+'" found')]:[]},constants:$e,enum:Cr,filter:Gs,function:uo,layer:Qi,object:xn,source:Ga,light:Va,string:Si,formatted:function(r){return 0===Si(r).length?[]:oo(r)},resolvedImage:function(r){return 0===Si(r).length?[]:oo(r)}};function Wn(r){var s=r.value,c=r.valueSpec,f=r.styleSpec;return c.expression&&Ba(It(s))?uo(r):c.expression&&ls(ht(s))?oo(r):c.type&&Go[c.type]?Go[c.type](r):xn(Mt({},r,{valueSpec:c.type?f[c.type]:c}))}function Ti(r){var s=r.value,c=r.key,f=Si(r);return f.length||(-1===s.indexOf("{fontstack}")&&f.push(new Ze(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&f.push(new Ze(c,s,'"glyphs" url must include a "{range}" token'))),f}function Wo(r,s){void 0===s&&(s=ye);var c=[];return c=c.concat(Wn({key:"",value:r,valueSpec:s.$root,styleSpec:s,style:r,objectElementValidators:{glyphs:Ti,"*":function(){return[]}}})),r.constants&&(c=c.concat($e({key:"constants",value:r.constants,style:r,styleSpec:s}))),zo(c)}function zo(r){return[].concat(r).sort(function(s,c){return s.line-c.line})}function ua(r){return function(){for(var s=[],c=arguments.length;c--;)s[c]=arguments[c];return zo(r.apply(this,s))}}Wo.source=ua(Ga),Wo.light=ua(Va),Wo.layer=ua(Qi),Wo.filter=ua(Gs),Wo.paintProperty=ua(lc),Wo.layoutProperty=ua(Zl);var hr=Wo,Lc=hr.light,Nl=hr.paintProperty,Ya=hr.layoutProperty;function Vs(r,s){var c=!1;if(s&&s.length)for(var f=0,m=s;f<m.length;f+=1)r.fire(new qe(new Error(m[f].message))),c=!0;return c}var Qr=Co;function Co(r,s,c){var f=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var m=new Int32Array(this.arrayBuffer);r=m[0],this.d=(s=m[1])+2*(c=m[2]);for(var b=0;b<this.d*this.d;b++){var O=m[3+b],z=m[3+b+1];f.push(O===z?null:m.subarray(O,z))}var j=m[3+f.length+1];this.keys=m.subarray(m[3+f.length],j),this.bboxes=m.subarray(j),this.insert=this._insertReadonly}else{this.d=s+2*c;for(var G=0;G<this.d*this.d;G++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=c,this.scale=s/r,this.uid=0;var $=c/s*r;this.min=-$,this.max=r+$}Co.prototype.insert=function(r,s,c,f,m){this._forEachCell(s,c,f,m,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(m)},Co.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Co.prototype._insertCell=function(r,s,c,f,m,b){this.cells[m].push(b)},Co.prototype.query=function(r,s,c,f,m){var b=this.min,O=this.max;if(r<=b&&s<=b&&O<=c&&O<=f&&!m)return Array.prototype.slice.call(this.keys);var z=[];return this._forEachCell(r,s,c,f,this._queryCell,z,{},m),z},Co.prototype._queryCell=function(r,s,c,f,m,b,O,z){var j=this.cells[m];if(null!==j)for(var G=this.keys,$=this.bboxes,ee=0;ee<j.length;ee++){var se=j[ee];if(void 0===O[se]){var ge=4*se;(z?z($[ge+0],$[ge+1],$[ge+2],$[ge+3]):r<=$[ge+2]&&s<=$[ge+3]&&c>=$[ge+0]&&f>=$[ge+1])?(O[se]=!0,b.push(G[se])):O[se]=!1}}},Co.prototype._forEachCell=function(r,s,c,f,m,b,O,z){for(var j=this._convertToCellCoord(r),G=this._convertToCellCoord(s),$=this._convertToCellCoord(c),ee=this._convertToCellCoord(f),se=j;se<=$;se++)for(var ge=G;ge<=ee;ge++){var Me=this.d*ge+se;if((!z||z(this._convertFromCellCoord(se),this._convertFromCellCoord(ge),this._convertFromCellCoord(se+1),this._convertFromCellCoord(ge+1)))&&m.call(this,r,s,c,f,Me,b,O,z))return}},Co.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},Co.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},Co.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,s=3+this.cells.length+1+1,c=0,f=0;f<this.cells.length;f++)c+=this.cells[f].length;var m=new Int32Array(s+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var b=s,O=0;O<r.length;O++){var z=r[O];m[3+O]=b,m.set(z,b),b+=z.length}return m[3+r.length]=b,m.set(this.keys,b),m[3+r.length+1]=b+=this.keys.length,m.set(this.bboxes,b),b+=this.bboxes.length,m.buffer};var Ha=E.ImageData,Ys=E.ImageBitmap,ro={};function cn(r,s,c){void 0===c&&(c={}),Object.defineProperty(s,"_classRegistryKey",{value:r,writeable:!1}),ro[r]={klass:s,omit:c.omit||[],shallow:c.shallow||[]}}for(var Zr in cn("Object",Object),Qr.serialize=function(r,s){var c=r.toArrayBuffer();return s&&s.push(c),{buffer:c}},Qr.deserialize=function(r){return new Qr(r.buffer)},cn("Grid",Qr),cn("Color",wi),cn("Error",Error),cn("ResolvedImage",Ko),cn("StylePropertyFunction",en),cn("StyleExpression",js,{omit:["_evaluator"]}),cn("ZoomDependentExpression",Ke),cn("ZoomConstantExpression",Il),cn("CompoundExpression",Y,{omit:["_evaluate"]}),Gr)Gr[Zr]._classRegistryKey||cn("Expression_"+Zr,Gr[Zr]);function zc(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&"ArrayBuffer"===r.constructor.name)}function cc(r){return Ys&&r instanceof Ys}function pa(r,s){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(zc(r)||cc(r))return s&&s.push(r),r;if(ArrayBuffer.isView(r)){var c=r;return s&&s.push(c.buffer),c}if(r instanceof Ha)return s&&s.push(r.data.buffer),r;if(Array.isArray(r)){for(var f=[],m=0,b=r;m<b.length;m+=1)f.push(pa(b[m],s));return f}if("object"==typeof r){var O=r.constructor,z=O._classRegistryKey;if(!z)throw new Error("can't serialize object of unregistered class");var j=O.serialize?O.serialize(r,s):{};if(!O.serialize){for(var G in r)if(r.hasOwnProperty(G)&&!(ro[z].omit.indexOf(G)>=0)){var $=r[G];j[G]=ro[z].shallow.indexOf(G)>=0?$:pa($,s)}r instanceof Error&&(j.message=r.message)}if(j.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==z&&(j.$name=z),j}throw new Error("can't serialize object of type "+typeof r)}function Kr(r){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||zc(r)||cc(r)||ArrayBuffer.isView(r)||r instanceof Ha)return r;if(Array.isArray(r))return r.map(Kr);if("object"==typeof r){var s=r.$name||"Object",c=ro[s].klass;if(!c)throw new Error("can't deserialize unregistered class "+s);if(c.deserialize)return c.deserialize(r);for(var f=Object.create(c.prototype),m=0,b=Object.keys(r);m<b.length;m+=1){var O=b[m];if("$name"!==O){var z=r[O];f[O]=ro[s].shallow.indexOf(O)>=0?z:Kr(z)}}return f}throw new Error("can't deserialize object of type "+typeof r)}var op=function(){this.first=!0};op.prototype.update=function(r,s){var c=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=s),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=c,!0))};var Ht={"Latin-1 Supplement":function(r){return r>=128&&r<=255},Arabic:function(r){return r>=1536&&r<=1791},"Arabic Supplement":function(r){return r>=1872&&r<=1919},"Arabic Extended-A":function(r){return r>=2208&&r<=2303},"Hangul Jamo":function(r){return r>=4352&&r<=4607},"Unified Canadian Aboriginal Syllabics":function(r){return r>=5120&&r<=5759},Khmer:function(r){return r>=6016&&r<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(r){return r>=6320&&r<=6399},"General Punctuation":function(r){return r>=8192&&r<=8303},"Letterlike Symbols":function(r){return r>=8448&&r<=8527},"Number Forms":function(r){return r>=8528&&r<=8591},"Miscellaneous Technical":function(r){return r>=8960&&r<=9215},"Control Pictures":function(r){return r>=9216&&r<=9279},"Optical Character Recognition":function(r){return r>=9280&&r<=9311},"Enclosed Alphanumerics":function(r){return r>=9312&&r<=9471},"Geometric Shapes":function(r){return r>=9632&&r<=9727},"Miscellaneous Symbols":function(r){return r>=9728&&r<=9983},"Miscellaneous Symbols and Arrows":function(r){return r>=11008&&r<=11263},"CJK Radicals Supplement":function(r){return r>=11904&&r<=12031},"Kangxi Radicals":function(r){return r>=12032&&r<=12255},"Ideographic Description Characters":function(r){return r>=12272&&r<=12287},"CJK Symbols and Punctuation":function(r){return r>=12288&&r<=12351},Hiragana:function(r){return r>=12352&&r<=12447},Katakana:function(r){return r>=12448&&r<=12543},Bopomofo:function(r){return r>=12544&&r<=12591},"Hangul Compatibility Jamo":function(r){return r>=12592&&r<=12687},Kanbun:function(r){return r>=12688&&r<=12703},"Bopomofo Extended":function(r){return r>=12704&&r<=12735},"CJK Strokes":function(r){return r>=12736&&r<=12783},"Katakana Phonetic Extensions":function(r){return r>=12784&&r<=12799},"Enclosed CJK Letters and Months":function(r){return r>=12800&&r<=13055},"CJK Compatibility":function(r){return r>=13056&&r<=13311},"CJK Unified Ideographs Extension A":function(r){return r>=13312&&r<=19903},"Yijing Hexagram Symbols":function(r){return r>=19904&&r<=19967},"CJK Unified Ideographs":function(r){return r>=19968&&r<=40959},"Yi Syllables":function(r){return r>=40960&&r<=42127},"Yi Radicals":function(r){return r>=42128&&r<=42191},"Hangul Jamo Extended-A":function(r){return r>=43360&&r<=43391},"Hangul Syllables":function(r){return r>=44032&&r<=55215},"Hangul Jamo Extended-B":function(r){return r>=55216&&r<=55295},"Private Use Area":function(r){return r>=57344&&r<=63743},"CJK Compatibility Ideographs":function(r){return r>=63744&&r<=64255},"Arabic Presentation Forms-A":function(r){return r>=64336&&r<=65023},"Vertical Forms":function(r){return r>=65040&&r<=65055},"CJK Compatibility Forms":function(r){return r>=65072&&r<=65103},"Small Form Variants":function(r){return r>=65104&&r<=65135},"Arabic Presentation Forms-B":function(r){return r>=65136&&r<=65279},"Halfwidth and Fullwidth Forms":function(r){return r>=65280&&r<=65519}};function rp(r){for(var s=0,c=r;s<c.length;s+=1)if(vu(c[s].charCodeAt(0)))return!0;return!1}function vu(r){return!(746!==r&&747!==r&&(r<4352||!(Ht["Bopomofo Extended"](r)||Ht.Bopomofo(r)||Ht["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Ht["CJK Compatibility Ideographs"](r)||Ht["CJK Compatibility"](r)||Ht["CJK Radicals Supplement"](r)||Ht["CJK Strokes"](r)||!(!Ht["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||12336===r)||Ht["CJK Unified Ideographs Extension A"](r)||Ht["CJK Unified Ideographs"](r)||Ht["Enclosed CJK Letters and Months"](r)||Ht["Hangul Compatibility Jamo"](r)||Ht["Hangul Jamo Extended-A"](r)||Ht["Hangul Jamo Extended-B"](r)||Ht["Hangul Jamo"](r)||Ht["Hangul Syllables"](r)||Ht.Hiragana(r)||Ht["Ideographic Description Characters"](r)||Ht.Kanbun(r)||Ht["Kangxi Radicals"](r)||Ht["Katakana Phonetic Extensions"](r)||Ht.Katakana(r)&&12540!==r||!(!Ht["Halfwidth and Fullwidth Forms"](r)||65288===r||65289===r||65293===r||r>=65306&&r<=65310||65339===r||65341===r||65343===r||r>=65371&&r<=65503||65507===r||r>=65512&&r<=65519)||!(!Ht["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Ht["Unified Canadian Aboriginal Syllabics"](r)||Ht["Unified Canadian Aboriginal Syllabics Extended"](r)||Ht["Vertical Forms"](r)||Ht["Yijing Hexagram Symbols"](r)||Ht["Yi Syllables"](r)||Ht["Yi Radicals"](r))))}function bu(r){return!(vu(r)||(s=r,Ht["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||Ht["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||Ht["Letterlike Symbols"](s)||Ht["Number Forms"](s)||Ht["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||Ht["Control Pictures"](s)&&9251!==s||Ht["Optical Character Recognition"](s)||Ht["Enclosed Alphanumerics"](s)||Ht["Geometric Shapes"](s)||Ht["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Ht["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Ht["CJK Symbols and Punctuation"](s)||Ht.Katakana(s)||Ht["Private Use Area"](s)||Ht["CJK Compatibility Forms"](s)||Ht["Small Form Variants"](s)||Ht["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}function Ea(r){return r>=1424&&r<=2303||Ht["Arabic Presentation Forms-A"](r)||Ht["Arabic Presentation Forms-B"](r)}function Aa(r,s){return!(!s&&Ea(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Ht.Khmer(r))}function ap(r){for(var s=0,c=r;s<c.length;s+=1)if(Ea(c[s].charCodeAt(0)))return!0;return!1}var Dc=null,da="unavailable",Os=null,Rc=function(r){r&&"string"==typeof r&&r.indexOf("NetworkError")>-1&&(da="error"),Dc&&Dc(r)};function Fc(){sp.fire(new Pe("pluginStateChange",{pluginStatus:da,pluginURL:Os}))}var sp=new Ge,xu=function(){return da},ka=function(){if("deferred"!==da||!Os)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");da="loading",Fc(),Os&&Fs({url:Os},function(r){r?Rc(r):(da="loaded",Fc())})},fr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===da||null!=fr.applyArabicShaping},isLoading:function(){return"loading"===da},setState:function(r){da=r.pluginStatus,Os=r.pluginURL},isParsed:function(){return null!=fr.applyArabicShaping&&null!=fr.processBidirectionalText&&null!=fr.processStyledBidirectionalText},getPluginURL:function(){return Os}},oi=function(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new op,this.transition={})};oi.prototype.isSupportedScript=function(r){return function(s,c){for(var f=0,m=s;f<m.length;f+=1)if(!Aa(m[f].charCodeAt(0),c))return!1;return!0}(r,fr.isLoaded())},oi.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},oi.prototype.getCrossfadeParameters=function(){var r=this.zoom,s=r-Math.floor(r),c=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*s}};var ha=function(r,s){this.property=r,this.value=s,this.expression=function(c,f){if(Ba(c))return new en(c,f);if(ls(c)){var m=Ct(c,f);if("error"===m.result)throw new Error(m.value.map(function(O){return O.key+": "+O.message}).join(", "));return m.value}var b=c;return"string"==typeof c&&"color"===f.type&&(b=wi.parse(c)),{kind:"constant",evaluate:function(){return b}}}(void 0===s?r.specification.default:s,r.specification)};ha.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ha.prototype.possiblyEvaluate=function(r,s,c){return this.property.possiblyEvaluate(this,r,s,c)};var Ia=function(r){this.property=r,this.value=new ha(r,void 0)};Ia.prototype.transitioned=function(r,s){return new us(this.property,this.value,s,W({},r.transition,this.transition),r.now)},Ia.prototype.untransitioned=function(){return new us(this.property,this.value,null,{},0)};var Vo=function(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)};Vo.prototype.getValue=function(r){return je(this._values[r].value.value)},Vo.prototype.setValue=function(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Ia(this._values[r].property)),this._values[r].value=new ha(this._values[r].property,null===s?void 0:je(s))},Vo.prototype.getTransition=function(r){return je(this._values[r].transition)},Vo.prototype.setTransition=function(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Ia(this._values[r].property)),this._values[r].transition=je(s)||void 0},Vo.prototype.serialize=function(){for(var r={},s=0,c=Object.keys(this._values);s<c.length;s+=1){var f=c[s],m=this.getValue(f);void 0!==m&&(r[f]=m);var b=this.getTransition(f);void 0!==b&&(r[f+"-transition"]=b)}return r},Vo.prototype.transitioned=function(r,s){for(var c=new ps(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var b=m[f];c._values[b]=this._values[b].transitioned(r,s._values[b])}return c},Vo.prototype.untransitioned=function(){for(var r=new ps(this._properties),s=0,c=Object.keys(this._values);s<c.length;s+=1){var f=c[s];r._values[f]=this._values[f].untransitioned()}return r};var us=function(r,s,c,f,m){this.property=r,this.value=s,this.begin=m+f.delay||0,this.end=this.begin+f.duration||0,r.specification.transition&&(f.delay||f.duration)&&(this.prior=c)};us.prototype.possiblyEvaluate=function(r,s,c){var f=r.now||0,m=this.value.possiblyEvaluate(r,s,c),b=this.prior;if(b){if(f>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(f<this.begin)return b.possiblyEvaluate(r,s,c);var O=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(r,s,c),m,function(z){if(z<=0)return 0;if(z>=1)return 1;var j=z*z,G=j*z;return 4*(z<.5?G:3*(z-j)+G-.75)}(O))}return m};var ps=function(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)};ps.prototype.possiblyEvaluate=function(r,s,c){for(var f=new Hs(this._properties),m=0,b=Object.keys(this._values);m<b.length;m+=1){var O=b[m];f._values[O]=this._values[O].possiblyEvaluate(r,s,c)}return f},ps.prototype.hasTransition=function(){for(var r=0,s=Object.keys(this._values);r<s.length;r+=1)if(this._values[s[r]].prior)return!0;return!1};var Tr=function(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)};Tr.prototype.getValue=function(r){return je(this._values[r].value)},Tr.prototype.setValue=function(r,s){this._values[r]=new ha(this._values[r].property,null===s?void 0:je(s))},Tr.prototype.serialize=function(){for(var r={},s=0,c=Object.keys(this._values);s<c.length;s+=1){var f=c[s],m=this.getValue(f);void 0!==m&&(r[f]=m)}return r},Tr.prototype.possiblyEvaluate=function(r,s,c){for(var f=new Hs(this._properties),m=0,b=Object.keys(this._values);m<b.length;m+=1){var O=b[m];f._values[O]=this._values[O].possiblyEvaluate(r,s,c)}return f};var ir=function(r,s,c){this.property=r,this.value=s,this.parameters=c};ir.prototype.isConstant=function(){return"constant"===this.value.kind},ir.prototype.constantOr=function(r){return"constant"===this.value.kind?this.value.value:r},ir.prototype.evaluate=function(r,s,c,f){return this.property.evaluate(this.value,this.parameters,r,s,c,f)};var Hs=function(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)};Hs.prototype.get=function(r){return this._values[r]};var Cn=function(r){this.specification=r};Cn.prototype.possiblyEvaluate=function(r,s){return r.expression.evaluate(s)},Cn.prototype.interpolate=function(r,s,c){var f=xs[this.specification.type];return f?f(r,s,c):r};var un=function(r,s){this.specification=r,this.overrides=s};un.prototype.possiblyEvaluate=function(r,s,c,f){return new ir(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(s,null,{},c,f)}:r.expression,s)},un.prototype.interpolate=function(r,s,c){if("constant"!==r.value.kind||"constant"!==s.value.kind)return r;if(void 0===r.value.value||void 0===s.value.value)return new ir(this,{kind:"constant",value:void 0},r.parameters);var f=xs[this.specification.type];return f?new ir(this,{kind:"constant",value:f(r.value.value,s.value.value,c)},r.parameters):r},un.prototype.evaluate=function(r,s,c,f,m,b){return"constant"===r.kind?r.value:r.evaluate(s,c,f,m,b)};var Cu=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.possiblyEvaluate=function(c,f,m,b){if(void 0===c.value)return new ir(this,{kind:"constant",value:void 0},f);if("constant"===c.expression.kind){var O=c.expression.evaluate(f,null,{},m,b),z="resolvedImage"===c.property.specification.type&&"string"!=typeof O?O.name:O,j=this._calculate(z,z,z,f);return new ir(this,{kind:"constant",value:j},f)}if("camera"===c.expression.kind){var G=this._calculate(c.expression.evaluate({zoom:f.zoom-1}),c.expression.evaluate({zoom:f.zoom}),c.expression.evaluate({zoom:f.zoom+1}),f);return new ir(this,{kind:"constant",value:G},f)}return new ir(this,c.expression,f)},s.prototype.evaluate=function(c,f,m,b,O,z){if("source"===c.kind){var j=c.evaluate(f,m,b,O,z);return this._calculate(j,j,j,f)}return"composite"===c.kind?this._calculate(c.evaluate({zoom:Math.floor(f.zoom)-1},m,b),c.evaluate({zoom:Math.floor(f.zoom)},m,b),c.evaluate({zoom:Math.floor(f.zoom)+1},m,b),f):c.value},s.prototype._calculate=function(c,f,m,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:f}:{from:m,to:f}},s.prototype.interpolate=function(c){return c},s}(un),Xo=function(r){this.specification=r};Xo.prototype.possiblyEvaluate=function(r,s,c,f){if(void 0!==r.value){if("constant"===r.expression.kind){var m=r.expression.evaluate(s,null,{},c,f);return this._calculate(m,m,m,s)}return this._calculate(r.expression.evaluate(new oi(Math.floor(s.zoom-1),s)),r.expression.evaluate(new oi(Math.floor(s.zoom),s)),r.expression.evaluate(new oi(Math.floor(s.zoom+1),s)),s)}},Xo.prototype._calculate=function(r,s,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:c,to:s}},Xo.prototype.interpolate=function(r){return r};var fa=function(r){this.specification=r};fa.prototype.possiblyEvaluate=function(r,s,c,f){return!!r.expression.evaluate(s,null,{},c,f)},fa.prototype.interpolate=function(){return!1};var or=function(r){for(var s in this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],r){var c=r[s];c.specification.overridable&&this.overridableProperties.push(s);var f=this.defaultPropertyValues[s]=new ha(c,void 0),m=this.defaultTransitionablePropertyValues[s]=new Ia(c);this.defaultTransitioningPropertyValues[s]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate({})}};cn("DataDrivenProperty",un),cn("DataConstantProperty",Cn),cn("CrossFadedDataDrivenProperty",Cu),cn("CrossFadedProperty",Xo),cn("ColorRampProperty",fa);var ds=function(r){function s(c,f){if(r.call(this),this.id=c.id,this.type=c.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==c.type&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,"background"!==c.type&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),f.layout&&(this._unevaluatedLayout=new Tr(f.layout)),f.paint)){for(var m in this._transitionablePaint=new Vo(f.paint),c.paint)this.setPaintProperty(m,c.paint[m],{validate:!1});for(var b in c.layout)this.setLayoutProperty(b,c.layout[b],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Hs(f.paint)}}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},s.prototype.getLayoutProperty=function(c){return"visibility"===c?this.visibility:this._unevaluatedLayout.getValue(c)},s.prototype.setLayoutProperty=function(c,f,m){void 0===m&&(m={}),null!=f&&this._validate(Ya,"layers."+this.id+".layout."+c,c,f,m)||("visibility"!==c?this._unevaluatedLayout.setValue(c,f):this.visibility=f)},s.prototype.getPaintProperty=function(c){return Le(c,"-transition")?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)},s.prototype.setPaintProperty=function(c,f,m){if(void 0===m&&(m={}),null!=f&&this._validate(Nl,"layers."+this.id+".paint."+c,c,f,m))return!1;if(Le(c,"-transition"))return this._transitionablePaint.setTransition(c.slice(0,-11),f||void 0),!1;var b=this._transitionablePaint._values[c],O="cross-faded-data-driven"===b.property.specification["property-type"],z=b.value.isDataDriven(),j=b.value;this._transitionablePaint.setValue(c,f),this._handleSpecialPaintPropertyUpdate(c);var G=this._transitionablePaint._values[c].value;return G.isDataDriven()||z||O||this._handleOverridablePaintPropertyUpdate(c,j,G)},s.prototype._handleSpecialPaintPropertyUpdate=function(c){},s.prototype._handleOverridablePaintPropertyUpdate=function(c,f,m){return!1},s.prototype.isHidden=function(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||"none"===this.visibility},s.prototype.updateTransitions=function(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)},s.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},s.prototype.recalculate=function(c,f){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,f)},s.prototype.serialize=function(){var c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),Ie(c,function(f,m){return!(void 0===f||"layout"===m&&!Object.keys(f).length||"paint"===m&&!Object.keys(f).length)})},s.prototype._validate=function(c,f,m,b,O){return void 0===O&&(O={}),(!O||!1!==O.validate)&&Vs(this,c.call(hr,{key:f,layerType:this.type,objectKey:m,value:b,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))},s.prototype.is3D=function(){return!1},s.prototype.isTileClipped=function(){return!1},s.prototype.hasOffscreenPass=function(){return!1},s.prototype.resize=function(){},s.prototype.isStateDependent=function(){for(var c in this.paint._values){var f=this.paint.get(c);if(f instanceof ir&&Vr(f.property.specification)&&("source"===f.value.kind||"composite"===f.value.kind)&&f.value.isStateDependent)return!0}return!1},s}(Ge),lp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},wu=function(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ki=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Yo(r,s){void 0===s&&(s=1);var c=0,f=0;return{members:r.map(function(m){var b=lp[m.type].BYTES_PER_ELEMENT,O=c=Jp(c,Math.max(s,b)),z=m.components||1;return f=Math.max(f,b),c+=b*z,{name:m.name,type:m.type,components:z,offset:O}}),size:Jp(c,Math.max(f,s)),alignment:s}}function Jp(r,s){return Math.ceil(r/s)*s}ki.serialize=function(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}},ki.deserialize=function(r){var s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s},ki.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ki.prototype.clear=function(){this.length=0},ki.prototype.resize=function(r){this.reserve(r),this.length=r},ki.prototype.reserve=function(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}},ki.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ll=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f){var m=this.length;return this.resize(m+1),this.emplace(m,c,f)},s.prototype.emplace=function(c,f,m){var b=2*c;return this.int16[b+0]=f,this.int16[b+1]=m,c},s}(ki);Ll.prototype.bytesPerElement=4,cn("StructArrayLayout2i4",Ll);var Tu=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b){var O=this.length;return this.resize(O+1),this.emplace(O,c,f,m,b)},s.prototype.emplace=function(c,f,m,b,O){var z=4*c;return this.int16[z+0]=f,this.int16[z+1]=m,this.int16[z+2]=b,this.int16[z+3]=O,c},s}(ki);Tu.prototype.bytesPerElement=8,cn("StructArrayLayout4i8",Tu);var Ss=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z){var j=this.length;return this.resize(j+1),this.emplace(j,c,f,m,b,O,z)},s.prototype.emplace=function(c,f,m,b,O,z,j){var G=6*c;return this.int16[G+0]=f,this.int16[G+1]=m,this.int16[G+2]=b,this.int16[G+3]=O,this.int16[G+4]=z,this.int16[G+5]=j,c},s}(ki);Ss.prototype.bytesPerElement=12,cn("StructArrayLayout2i4i12",Ss);var Nr=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z){var j=this.length;return this.resize(j+1),this.emplace(j,c,f,m,b,O,z)},s.prototype.emplace=function(c,f,m,b,O,z,j){var G=4*c,$=8*c;return this.int16[G+0]=f,this.int16[G+1]=m,this.uint8[$+4]=b,this.uint8[$+5]=O,this.uint8[$+6]=z,this.uint8[$+7]=j,c},s}(ki);Nr.prototype.bytesPerElement=8,cn("StructArrayLayout2i4ub8",Nr);var Qs=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f){var m=this.length;return this.resize(m+1),this.emplace(m,c,f)},s.prototype.emplace=function(c,f,m){var b=2*c;return this.float32[b+0]=f,this.float32[b+1]=m,c},s}(ki);Qs.prototype.bytesPerElement=8,cn("StructArrayLayout2f8",Qs);var hs=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z,j,G,$,ee){var se=this.length;return this.resize(se+1),this.emplace(se,c,f,m,b,O,z,j,G,$,ee)},s.prototype.emplace=function(c,f,m,b,O,z,j,G,$,ee,se){var ge=10*c;return this.uint16[ge+0]=f,this.uint16[ge+1]=m,this.uint16[ge+2]=b,this.uint16[ge+3]=O,this.uint16[ge+4]=z,this.uint16[ge+5]=j,this.uint16[ge+6]=G,this.uint16[ge+7]=$,this.uint16[ge+8]=ee,this.uint16[ge+9]=se,c},s}(ki);hs.prototype.bytesPerElement=20,cn("StructArrayLayout10ui20",hs);var uc=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z,j,G,$,ee,se,ge){var Me=this.length;return this.resize(Me+1),this.emplace(Me,c,f,m,b,O,z,j,G,$,ee,se,ge)},s.prototype.emplace=function(c,f,m,b,O,z,j,G,$,ee,se,ge,Me){var Ae=12*c;return this.int16[Ae+0]=f,this.int16[Ae+1]=m,this.int16[Ae+2]=b,this.int16[Ae+3]=O,this.uint16[Ae+4]=z,this.uint16[Ae+5]=j,this.uint16[Ae+6]=G,this.uint16[Ae+7]=$,this.int16[Ae+8]=ee,this.int16[Ae+9]=se,this.int16[Ae+10]=ge,this.int16[Ae+11]=Me,c},s}(ki);uc.prototype.bytesPerElement=24,cn("StructArrayLayout4i4ui4i24",uc);var Ks=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m){var b=this.length;return this.resize(b+1),this.emplace(b,c,f,m)},s.prototype.emplace=function(c,f,m,b){var O=3*c;return this.float32[O+0]=f,this.float32[O+1]=m,this.float32[O+2]=b,c},s}(ki);Ks.prototype.bytesPerElement=12,cn("StructArrayLayout3f12",Ks);var hl=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c){var f=this.length;return this.resize(f+1),this.emplace(f,c)},s.prototype.emplace=function(c,f){return this.uint32[1*c+0]=f,c},s}(ki);hl.prototype.bytesPerElement=4,cn("StructArrayLayout1ul4",hl);var Uc=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z,j,G,$){var ee=this.length;return this.resize(ee+1),this.emplace(ee,c,f,m,b,O,z,j,G,$)},s.prototype.emplace=function(c,f,m,b,O,z,j,G,$,ee){var se=10*c,ge=5*c;return this.int16[se+0]=f,this.int16[se+1]=m,this.int16[se+2]=b,this.int16[se+3]=O,this.int16[se+4]=z,this.int16[se+5]=j,this.uint32[ge+3]=G,this.uint16[se+8]=$,this.uint16[se+9]=ee,c},s}(ki);Uc.prototype.bytesPerElement=20,cn("StructArrayLayout6i1ul2ui20",Uc);var $r=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z){var j=this.length;return this.resize(j+1),this.emplace(j,c,f,m,b,O,z)},s.prototype.emplace=function(c,f,m,b,O,z,j){var G=6*c;return this.int16[G+0]=f,this.int16[G+1]=m,this.int16[G+2]=b,this.int16[G+3]=O,this.int16[G+4]=z,this.int16[G+5]=j,c},s}(ki);$r.prototype.bytesPerElement=12,cn("StructArrayLayout2i2i2i12",$r);var Mr=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O){var z=this.length;return this.resize(z+1),this.emplace(z,c,f,m,b,O)},s.prototype.emplace=function(c,f,m,b,O,z){var j=4*c,G=8*c;return this.float32[j+0]=f,this.float32[j+1]=m,this.float32[j+2]=b,this.int16[G+6]=O,this.int16[G+7]=z,c},s}(ki);Mr.prototype.bytesPerElement=16,cn("StructArrayLayout2f1f2i16",Mr);var cp=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b){var O=this.length;return this.resize(O+1),this.emplace(O,c,f,m,b)},s.prototype.emplace=function(c,f,m,b,O){var z=12*c,j=3*c;return this.uint8[z+0]=f,this.uint8[z+1]=m,this.float32[j+1]=b,this.float32[j+2]=O,c},s}(ki);cp.prototype.bytesPerElement=12,cn("StructArrayLayout2ub2f12",cp);var fl=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m){var b=this.length;return this.resize(b+1),this.emplace(b,c,f,m)},s.prototype.emplace=function(c,f,m,b){var O=3*c;return this.uint16[O+0]=f,this.uint16[O+1]=m,this.uint16[O+2]=b,c},s}(ki);fl.prototype.bytesPerElement=6,cn("StructArrayLayout3ui6",fl);var gl=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae,Fe,ze,Ve){var nt=this.length;return this.resize(nt+1),this.emplace(nt,c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae,Fe,ze,Ve)},s.prototype.emplace=function(c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae,Fe,ze,Ve,nt){var lt=24*c,gt=12*c,wt=48*c;return this.int16[lt+0]=f,this.int16[lt+1]=m,this.uint16[lt+2]=b,this.uint16[lt+3]=O,this.uint32[gt+2]=z,this.uint32[gt+3]=j,this.uint32[gt+4]=G,this.uint16[lt+10]=$,this.uint16[lt+11]=ee,this.uint16[lt+12]=se,this.float32[gt+7]=ge,this.float32[gt+8]=Me,this.uint8[wt+36]=Ae,this.uint8[wt+37]=Fe,this.uint8[wt+38]=ze,this.uint32[gt+10]=Ve,this.int16[lt+22]=nt,c},s}(ki);gl.prototype.bytesPerElement=48,cn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",gl);var Qa=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae,Fe,ze,Ve,nt,lt,gt,wt,zt,jt,vn,on,On,rn,ii){var Jn=this.length;return this.resize(Jn+1),this.emplace(Jn,c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae,Fe,ze,Ve,nt,lt,gt,wt,zt,jt,vn,on,On,rn,ii)},s.prototype.emplace=function(c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae,Fe,ze,Ve,nt,lt,gt,wt,zt,jt,vn,on,On,rn,ii,Jn){var mn=34*c,ai=17*c;return this.int16[mn+0]=f,this.int16[mn+1]=m,this.int16[mn+2]=b,this.int16[mn+3]=O,this.int16[mn+4]=z,this.int16[mn+5]=j,this.int16[mn+6]=G,this.int16[mn+7]=$,this.uint16[mn+8]=ee,this.uint16[mn+9]=se,this.uint16[mn+10]=ge,this.uint16[mn+11]=Me,this.uint16[mn+12]=Ae,this.uint16[mn+13]=Fe,this.uint16[mn+14]=ze,this.uint16[mn+15]=Ve,this.uint16[mn+16]=nt,this.uint16[mn+17]=lt,this.uint16[mn+18]=gt,this.uint16[mn+19]=wt,this.uint16[mn+20]=zt,this.uint16[mn+21]=jt,this.uint16[mn+22]=vn,this.uint32[ai+12]=on,this.float32[ai+13]=On,this.float32[ai+14]=rn,this.float32[ai+15]=ii,this.float32[ai+16]=Jn,c},s}(ki);Qa.prototype.bytesPerElement=68,cn("StructArrayLayout8i15ui1ul4f68",Qa);var $s=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c){var f=this.length;return this.resize(f+1),this.emplace(f,c)},s.prototype.emplace=function(c,f){return this.float32[1*c+0]=f,c},s}(ki);$s.prototype.bytesPerElement=4,cn("StructArrayLayout1f4",$s);var ga=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m){var b=this.length;return this.resize(b+1),this.emplace(b,c,f,m)},s.prototype.emplace=function(c,f,m,b){var O=3*c;return this.int16[O+0]=f,this.int16[O+1]=m,this.int16[O+2]=b,c},s}(ki);ga.prototype.bytesPerElement=6,cn("StructArrayLayout3i6",ga);var Mu=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m){var b=this.length;return this.resize(b+1),this.emplace(b,c,f,m)},s.prototype.emplace=function(c,f,m,b){var O=4*c;return this.uint32[2*c+0]=f,this.uint16[O+2]=m,this.uint16[O+3]=b,c},s}(ki);Mu.prototype.bytesPerElement=8,cn("StructArrayLayout1ul2ui8",Mu);var _l=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f){var m=this.length;return this.resize(m+1),this.emplace(m,c,f)},s.prototype.emplace=function(c,f,m){var b=2*c;return this.uint16[b+0]=f,this.uint16[b+1]=m,c},s}(ki);_l.prototype.bytesPerElement=4,cn("StructArrayLayout2ui4",_l);var up=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c){var f=this.length;return this.resize(f+1),this.emplace(f,c)},s.prototype.emplace=function(c,f){return this.uint16[1*c+0]=f,c},s}(ki);up.prototype.bytesPerElement=2,cn("StructArrayLayout1ui2",up);var Ou=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},s.prototype.emplaceBack=function(c,f,m,b){var O=this.length;return this.resize(O+1),this.emplace(O,c,f,m,b)},s.prototype.emplace=function(c,f,m,b,O){var z=4*c;return this.float32[z+0]=f,this.float32[z+1]=m,this.float32[z+2]=b,this.float32[z+3]=O,c},s}(ki);Ou.prototype.bytesPerElement=16,cn("StructArrayLayout4f16",Ou);var u=function(r){function s(){r.apply(this,arguments)}r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return c.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},c.x1.get=function(){return this._structArray.int16[this._pos2+2]},c.y1.get=function(){return this._structArray.int16[this._pos2+3]},c.x2.get=function(){return this._structArray.int16[this._pos2+4]},c.y2.get=function(){return this._structArray.int16[this._pos2+5]},c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.anchorPoint.get=function(){return new S(this.anchorPointX,this.anchorPointY)},Object.defineProperties(s.prototype,c),s}(wu);u.prototype.size=20;var h=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.get=function(c){return new u(this,c)},s}(Uc);cn("CollisionBoxArray",h);var p=function(r){function s(){r.apply(this,arguments)}r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},c.segment.get=function(){return this._structArray.uint16[this._pos2+10]},c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},c.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},c.placedOrientation.set=function(f){this._structArray.uint8[this._pos1+37]=f},c.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},c.hidden.set=function(f){this._structArray.uint8[this._pos1+38]=f},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},c.crossTileID.set=function(f){this._structArray.uint32[this._pos4+10]=f},c.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(s.prototype,c),s}(wu);p.prototype.size=48;var g=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.get=function(c){return new p(this,c)},s}(gl);cn("PlacedSymbolArray",g);var x=function(r){function s(){r.apply(this,arguments)}r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},c.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},c.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},c.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},c.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},c.key.get=function(){return this._structArray.uint16[this._pos2+8]},c.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},c.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},c.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},c.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},c.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},c.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},c.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},c.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},c.crossTileID.set=function(f){this._structArray.uint32[this._pos4+12]=f},c.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},c.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},c.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},c.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(s.prototype,c),s}(wu);x.prototype.size=68;var k=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.get=function(c){return new x(this,c)},s}(Qa);cn("SymbolInstanceArray",k);var L=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.getoffsetX=function(c){return this.float32[1*c+0]},s}($s);cn("GlyphOffsetArray",L);var J=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.getx=function(c){return this.int16[3*c+0]},s.prototype.gety=function(c){return this.int16[3*c+1]},s.prototype.gettileUnitDistanceFromAnchor=function(c){return this.int16[3*c+2]},s}(ga);cn("SymbolLineVertexArray",J);var K=function(r){function s(){r.apply(this,arguments)}r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(s.prototype,c),s}(wu);K.prototype.size=8;var ne=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.get=function(c){return new K(this,c)},s}(Mu);cn("FeatureIndexArray",ne);var _e=Yo([{name:"a_pos",components:2,type:"Int16"}],4).members,ve=function(r){void 0===r&&(r=[]),this.segments=r};function be(r,s){return 256*(r=U(Math.floor(r),0,255))+U(Math.floor(s),0,255)}ve.prototype.prepareSegment=function(r,s,c,f){var m=this.segments[this.segments.length-1];return r>ve.MAX_VERTEX_ARRAY_LENGTH&&ie("Max vertices per segment is "+ve.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+r),(!m||m.vertexLength+r>ve.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==f)&&(m={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==f&&(m.sortKey=f),this.segments.push(m)),m},ve.prototype.get=function(){return this.segments},ve.prototype.destroy=function(){for(var r=0,s=this.segments;r<s.length;r+=1){var c=s[r];for(var f in c.vaos)c.vaos[f].destroy()}},ve.simpleSegment=function(r,s,c,f){return new ve([{vertexOffset:r,primitiveOffset:s,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])},ve.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,cn("SegmentVector",ve);var Ee=Yo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Oe=T(function(r){r.exports=function(s,c){var f,m,b,O,z,j,G,$;for(m=s.length-(f=3&s.length),b=c,z=3432918353,j=461845907,$=0;$<m;)G=255&s.charCodeAt($)|(255&s.charCodeAt(++$))<<8|(255&s.charCodeAt(++$))<<16|(255&s.charCodeAt(++$))<<24,++$,b=27492+(65535&(O=5*(65535&(b=(b^=G=(65535&(G=(G=(65535&G)*z+(((G>>>16)*z&65535)<<16)&4294967295)<<15|G>>>17))*j+(((G>>>16)*j&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(O>>>16)&65535)<<16);switch(G=0,f){case 3:G^=(255&s.charCodeAt($+2))<<16;case 2:G^=(255&s.charCodeAt($+1))<<8;case 1:b^=G=(65535&(G=(G=(65535&(G^=255&s.charCodeAt($)))*z+(((G>>>16)*z&65535)<<16)&4294967295)<<15|G>>>17))*j+(((G>>>16)*j&65535)<<16)&4294967295}return b^=s.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),Re=T(function(r){r.exports=function(s,c){for(var f,m=s.length,b=c^m,O=0;m>=4;)f=1540483477*(65535&(f=255&s.charCodeAt(O)|(255&s.charCodeAt(++O))<<8|(255&s.charCodeAt(++O))<<16|(255&s.charCodeAt(++O))<<24))+((1540483477*(f>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),m-=4,++O;switch(m){case 3:b^=(255&s.charCodeAt(O+2))<<16;case 2:b^=(255&s.charCodeAt(O+1))<<8;case 1:b=1540483477*(65535&(b^=255&s.charCodeAt(O)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),Se=Oe,De=Re;Se.murmur3=Oe,Se.murmur2=De;var Be=function(){this.ids=[],this.positions=[],this.indexed=!1};Be.prototype.add=function(r,s,c,f){this.ids.push(_t(r)),this.positions.push(s,c,f)},Be.prototype.getPositions=function(r){for(var s=_t(r),c=0,f=this.ids.length-1;c<f;){var m=c+f>>1;this.ids[m]>=s?f=m:c=m+1}for(var b=[];this.ids[c]===s;)b.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return b},Be.serialize=function(r,s){var c=new Float64Array(r.ids),f=new Uint32Array(r.positions);return function m(b,O,z,j){for(;z<j;){for(var G=b[z+j>>1],$=z-1,ee=j+1;;){do{$++}while(b[$]<G);do{ee--}while(b[ee]>G);if($>=ee)break;ct(b,$,ee),ct(O,3*$,3*ee),ct(O,3*$+1,3*ee+1),ct(O,3*$+2,3*ee+2)}ee-z<j-ee?(m(b,O,z,ee),z=ee+1):(m(b,O,ee+1,j),j=ee)}}(c,f,0,c.length-1),s&&s.push(c.buffer,f.buffer),{ids:c,positions:f}},Be.deserialize=function(r){var s=new Be;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s};var Xe=Math.pow(2,53)-1;function _t(r){var s=+r;return!isNaN(s)&&s<=Xe?s:Se(String(r))}function ct(r,s,c){var f=r[s];r[s]=r[c],r[c]=f}cn("FeaturePositionMap",Be);var yt=function(r,s){this.gl=r.gl,this.location=s},St=function(r){function s(c,f){r.call(this,c,f),this.current=0}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))},s}(yt),Ut=function(r){function s(c,f){r.call(this,c,f),this.current=0}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))},s}(yt),Rt=function(r){function s(c,f){r.call(this,c,f),this.current=[0,0]}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))},s}(yt),Kt=function(r){function s(c,f){r.call(this,c,f),this.current=[0,0,0]}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))},s}(yt),wn=function(r){function s(c,f){r.call(this,c,f),this.current=[0,0,0,0]}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))},s}(yt),Mn=function(r){function s(c,f){r.call(this,c,f),this.current=wi.transparent}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))},s}(yt),En=new Float32Array(16),_i=function(r){function s(c,f){r.call(this,c,f),this.current=En}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.set=function(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(var f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}},s}(yt);function Gt(r){return[be(255*r.r,255*r.g),be(255*r.b,255*r.a)]}var jn=function(r,s,c){this.value=r,this.uniformNames=s.map(function(f){return"u_"+f}),this.type=c};jn.prototype.setUniform=function(r,s,c){r.set(c.constantOr(this.value))},jn.prototype.getBinding=function(r,s,c){return"color"===this.type?new Mn(r,s):new Ut(r,s)};var ti=function(r,s){this.uniformNames=s.map(function(c){return"u_"+c}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ti.prototype.setConstantPatternPositions=function(r,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=r.tlbr},ti.prototype.setUniform=function(r,s,c,f){var m="u_pattern_to"===f?this.patternTo:"u_pattern_from"===f?this.patternFrom:"u_pixel_ratio_to"===f?this.pixelRatioTo:"u_pixel_ratio_from"===f?this.pixelRatioFrom:null;m&&r.set(m)},ti.prototype.getBinding=function(r,s,c){return"u_pattern"===c.substr(0,9)?new wn(r,s):new Ut(r,s)};var Fn=function(r,s,c,f){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(function(m){return{name:"a_"+m,type:"Float32",components:"color"===c?2:1,offset:0}}),this.paintVertexArray=new f};Fn.prototype.populatePaintArray=function(r,s,c,f,m){var b=this.paintVertexArray.length,O=this.expression.evaluate(new oi(0),s,{},f,[],m);this.paintVertexArray.resize(r),this._setPaintValue(b,r,O)},Fn.prototype.updatePaintArray=function(r,s,c,f){var m=this.expression.evaluate({zoom:0},c,f);this._setPaintValue(r,s,m)},Fn.prototype._setPaintValue=function(r,s,c){if("color"===this.type)for(var f=Gt(c),m=r;m<s;m++)this.paintVertexArray.emplace(m,f[0],f[1]);else{for(var b=r;b<s;b++)this.paintVertexArray.emplace(b,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}},Fn.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Fn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Un=function(r,s,c,f,m,b){this.expression=r,this.uniformNames=s.map(function(O){return"u_"+O+"_t"}),this.type=c,this.useIntegerZoom=f,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=s.map(function(O){return{name:"a_"+O,type:"Float32",components:"color"===c?4:2,offset:0}}),this.paintVertexArray=new b};Un.prototype.populatePaintArray=function(r,s,c,f,m){var b=this.expression.evaluate(new oi(this.zoom),s,{},f,[],m),O=this.expression.evaluate(new oi(this.zoom+1),s,{},f,[],m),z=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(z,r,b,O)},Un.prototype.updatePaintArray=function(r,s,c,f){var m=this.expression.evaluate({zoom:this.zoom},c,f),b=this.expression.evaluate({zoom:this.zoom+1},c,f);this._setPaintValue(r,s,m,b)},Un.prototype._setPaintValue=function(r,s,c,f){if("color"===this.type)for(var m=Gt(c),b=Gt(f),O=r;O<s;O++)this.paintVertexArray.emplace(O,m[0],m[1],b[0],b[1]);else{for(var z=r;z<s;z++)this.paintVertexArray.emplace(z,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}},Un.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Un.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Un.prototype.setUniform=function(r,s){var c=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,f=U(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);r.set(f)},Un.prototype.getBinding=function(r,s,c){return new Ut(r,s)};var Xn=function(r,s,c,f,m,b){this.expression=r,this.type=s,this.useIntegerZoom=c,this.zoom=f,this.layerId=b,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};Xn.prototype.populatePaintArray=function(r,s,c){var f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(f,r,s.patterns&&s.patterns[this.layerId],c)},Xn.prototype.updatePaintArray=function(r,s,c,f,m){this._setPaintValues(r,s,c.patterns&&c.patterns[this.layerId],m)},Xn.prototype._setPaintValues=function(r,s,c,f){if(f&&c){var m=f[c.min],b=f[c.mid],O=f[c.max];if(m&&b&&O)for(var z=r;z<s;z++)this.zoomInPaintVertexArray.emplace(z,b.tl[0],b.tl[1],b.br[0],b.br[1],m.tl[0],m.tl[1],m.br[0],m.br[1],b.pixelRatio,m.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,b.tl[0],b.tl[1],b.br[0],b.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],b.pixelRatio,O.pixelRatio)}},Xn.prototype.upload=function(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,Ee.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,Ee.members,this.expression.isStateDependent))},Xn.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var qn=function(r,s,c){this.binders={},this._buffers=[];var f=[];for(var m in r.paint._values)if(c(m)){var b=r.paint.get(m);if(b instanceof ir&&Vr(b.property.specification)){var O=Do(m,r.type),z=b.value,j=b.property.specification.type,G=b.property.useIntegerZoom,$=b.property.specification["property-type"],ee="cross-faded"===$||"cross-faded-data-driven"===$;if("constant"===z.kind)this.binders[m]=ee?new ti(z.value,O):new jn(z.value,O,j),f.push("/u_"+m);else if("source"===z.kind||ee){var se=yo(m,j,"source");this.binders[m]=ee?new Xn(z,j,G,s,se,r.id):new Fn(z,O,j,se),f.push("/a_"+m)}else{var ge=yo(m,j,"composite");this.binders[m]=new Un(z,O,j,G,s,ge),f.push("/z_"+m)}}}this.cacheKey=f.sort().join("")};qn.prototype.getMaxValue=function(r){var s=this.binders[r];return s instanceof Fn||s instanceof Un?s.maxValue:0},qn.prototype.populatePaintArrays=function(r,s,c,f,m){for(var b in this.binders){var O=this.binders[b];(O instanceof Fn||O instanceof Un||O instanceof Xn)&&O.populatePaintArray(r,s,c,f,m)}},qn.prototype.setConstantPatternPositions=function(r,s){for(var c in this.binders){var f=this.binders[c];f instanceof ti&&f.setConstantPatternPositions(r,s)}},qn.prototype.updatePaintArrays=function(r,s,c,f,m){var b=!1;for(var O in r)for(var z=0,j=s.getPositions(O);z<j.length;z+=1){var G=j[z],$=c.feature(G.index);for(var ee in this.binders){var se=this.binders[ee];if((se instanceof Fn||se instanceof Un||se instanceof Xn)&&!0===se.expression.isStateDependent){var ge=f.paint.get(ee);se.expression=ge.value,se.updatePaintArray(G.start,G.end,$,r[O],m),b=!0}}}return b},qn.prototype.defines=function(){var r=[];for(var s in this.binders){var c=this.binders[s];(c instanceof jn||c instanceof ti)&&r.push.apply(r,c.uniformNames.map(function(f){return"#define HAS_UNIFORM_"+f}))}return r},qn.prototype.getBinderAttributes=function(){var r=[];for(var s in this.binders){var c=this.binders[s];if(c instanceof Fn||c instanceof Un)for(var f=0;f<c.paintVertexAttributes.length;f++)r.push(c.paintVertexAttributes[f].name);else if(c instanceof Xn)for(var m=0;m<Ee.members.length;m++)r.push(Ee.members[m].name)}return r},qn.prototype.getBinderUniforms=function(){var r=[];for(var s in this.binders){var c=this.binders[s];if(c instanceof jn||c instanceof ti||c instanceof Un)for(var f=0,m=c.uniformNames;f<m.length;f+=1)r.push(m[f])}return r},qn.prototype.getPaintVertexBuffers=function(){return this._buffers},qn.prototype.getUniforms=function(r,s){var c=[];for(var f in this.binders){var m=this.binders[f];if(m instanceof jn||m instanceof ti||m instanceof Un)for(var b=0,O=m.uniformNames;b<O.length;b+=1){var z=O[b];if(s[z]){var j=m.getBinding(r,s[z],z);c.push({name:z,property:f,binding:j})}}}return c},qn.prototype.setUniforms=function(r,s,c,f){for(var m=0,b=s;m<b.length;m+=1){var O=b[m],z=O.name,j=O.property;this.binders[j].setUniform(O.binding,f,c.get(j),z)}},qn.prototype.updatePaintBuffers=function(r){for(var s in this._buffers=[],this.binders){var c=this.binders[s];if(r&&c instanceof Xn){var f=2===r.fromScale?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof Fn||c instanceof Un)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}},qn.prototype.upload=function(r){for(var s in this.binders){var c=this.binders[s];(c instanceof Fn||c instanceof Un||c instanceof Xn)&&c.upload(r)}this.updatePaintBuffers()},qn.prototype.destroy=function(){for(var r in this.binders){var s=this.binders[r];(s instanceof Fn||s instanceof Un||s instanceof Xn)&&s.destroy()}};var bn=function(r,s,c){void 0===c&&(c=function(){return!0}),this.programConfigurations={};for(var f=0,m=r;f<m.length;f+=1){var b=m[f];this.programConfigurations[b.id]=new qn(b,s,c)}this.needsUpload=!1,this._featureMap=new Be,this._bufferOffset=0};function Do(r,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(s+"-","").replace(/-/g,"_")]}function yo(r,s,c){var m={"line-pattern":{source:hs,composite:hs},"fill-pattern":{source:hs,composite:hs},"fill-extrusion-pattern":{source:hs,composite:hs}}[r];return m&&m[c]||{color:{source:Qs,composite:Ou},number:{source:$s,composite:Qs}}[s][c]}bn.prototype.populatePaintArrays=function(r,s,c,f,m,b){for(var O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(r,s,f,m,b);void 0!==s.id&&this._featureMap.add(s.id,c,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0},bn.prototype.updatePaintArrays=function(r,s,c,f){for(var m=0,b=c;m<b.length;m+=1){var O=b[m];this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(r,this._featureMap,s,O,f)||this.needsUpload}},bn.prototype.get=function(r){return this.programConfigurations[r]},bn.prototype.upload=function(r){if(this.needsUpload){for(var s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}},bn.prototype.destroy=function(){for(var r in this.programConfigurations)this.programConfigurations[r].destroy()},cn("ConstantBinder",jn),cn("CrossFadedConstantBinder",ti),cn("SourceExpressionBinder",Fn),cn("CrossFadedCompositeBinder",Xn),cn("CompositeExpressionBinder",Un),cn("ProgramConfiguration",qn,{omit:["_buffers"]}),cn("ProgramConfigurationSet",bn);var Or=Math.pow(2,14)-1,rr=-Or-1;function po(r){for(var s=8192/r.extent,c=r.loadGeometry(),f=0;f<c.length;f++)for(var m=c[f],b=0;b<m.length;b++){var O=m[b],z=Math.round(O.x*s),j=Math.round(O.y*s);O.x=U(z,rr,Or),O.y=U(j,rr,Or),(z<O.x||z>O.x+1||j<O.y||j>O.y+1)&&ie("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return c}function wo(r,s){return{type:r.type,id:r.id,properties:r.properties,geometry:s?po(r):[]}}function _a(r,s,c,f,m){r.emplaceBack(2*s+(f+1)/2,2*c+(m+1)/2)}var Wr=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(s){return s.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Ll,this.indexArray=new fl,this.segments=new ve,this.programConfigurations=new bn(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(function(s){return s.isStateDependent()}).map(function(s){return s.id})};function ml(r,s){for(var c=0;c<r.length;c++)if(Es(s,r[c]))return!0;for(var f=0;f<s.length;f++)if(Es(r,s[f]))return!0;return!!Su(r,s)}function Lr(r,s,c){return!!Es(r,s)||!!Ps(s,r,c)}function ma(r,s){if(1===r.length)return Jc(s,r[0]);for(var c=0;c<s.length;c++)for(var f=s[c],m=0;m<f.length;m++)if(Es(r,f[m]))return!0;for(var b=0;b<r.length;b++)if(Jc(s,r[b]))return!0;for(var O=0;O<s.length;O++)if(Su(r,s[O]))return!0;return!1}function Za(r,s,c){if(r.length>1){if(Su(r,s))return!0;for(var f=0;f<s.length;f++)if(Ps(s[f],r,c))return!0}for(var m=0;m<r.length;m++)if(Ps(r[m],s,c))return!0;return!1}function Su(r,s){if(0===r.length||0===s.length)return!1;for(var c=0;c<r.length-1;c++)for(var f=r[c],m=r[c+1],b=0;b<s.length-1;b++)if(qc(f,m,s[b],s[b+1]))return!0;return!1}function qc(r,s,c,f){return oe(r,c,f)!==oe(s,c,f)&&oe(r,s,c)!==oe(r,s,f)}function Ps(r,s,c){var f=c*c;if(1===s.length)return r.distSqr(s[0])<f;for(var m=1;m<s.length;m++)if(yl(r,s[m-1],s[m])<f)return!0;return!1}function yl(r,s,c){var f=s.distSqr(c);if(0===f)return r.distSqr(s);var m=((r.x-s.x)*(c.x-s.x)+(r.y-s.y)*(c.y-s.y))/f;return r.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function Jc(r,s){for(var c,f,m,b=!1,O=0;O<r.length;O++)for(var z=0,j=(c=r[O]).length-1;z<c.length;j=z++)(f=c[z]).y>s.y!=(m=c[j]).y>s.y&&s.x<(m.x-f.x)*(s.y-f.y)/(m.y-f.y)+f.x&&(b=!b);return b}function Es(r,s){for(var c=!1,f=0,m=r.length-1;f<r.length;m=f++){var b=r[f],O=r[m];b.y>s.y!=O.y>s.y&&s.x<(O.x-b.x)*(s.y-b.y)/(O.y-b.y)+b.x&&(c=!c)}return c}function pc(r,s,c){var f=c[0],m=c[2];if(r.x<f.x&&s.x<f.x||r.x>m.x&&s.x>m.x||r.y<f.y&&s.y<f.y||r.y>m.y&&s.y>m.y)return!1;var b=oe(r,s,c[0]);return b!==oe(r,s,c[1])||b!==oe(r,s,c[2])||b!==oe(r,s,c[3])}function fs(r,s,c){var f=s.paint.get(r).value;return"constant"===f.kind?f.value:c.programConfigurations.get(s.id).getMaxValue(r)}function er(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Ws(r,s,c,f,m){if(!s[0]&&!s[1])return r;var b=S.convert(s)._mult(m);"viewport"===c&&b._rotate(-f);for(var O=[],z=0;z<r.length;z++)O.push(r[z].sub(b));return O}Wr.prototype.populate=function(r,s,c){var f=this.layers[0],m=[],b=null;"circle"===f.type&&(b=f.layout.get("circle-sort-key"));for(var O=0,z=r;O<z.length;O+=1){var j=z[O],G=j.feature,$=j.id,ee=j.index,se=j.sourceLayerIndex,ge=this.layers[0]._featureFilter.needGeometry,Me=wo(G,ge);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),Me,c)){var Ae=b?b.evaluate(Me,{},c):void 0,Fe={id:$,properties:G.properties,type:G.type,sourceLayerIndex:se,index:ee,geometry:ge?Me.geometry:po(G),patterns:{},sortKey:Ae};m.push(Fe)}}b&&m.sort(function(jt,vn){return jt.sortKey-vn.sortKey});for(var ze=0,Ve=m;ze<Ve.length;ze+=1){var nt=Ve[ze],lt=nt.geometry,gt=nt.index,wt=nt.sourceLayerIndex,zt=r[gt].feature;this.addFeature(nt,lt,gt,c),s.featureIndex.insert(zt,lt,gt,wt,this.index)}},Wr.prototype.update=function(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)},Wr.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Wr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Wr.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,_e),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},Wr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Wr.prototype.addFeature=function(r,s,c,f){for(var m=0,b=s;m<b.length;m+=1)for(var O=0,z=b[m];O<z.length;O+=1){var j=z[O],G=j.x,$=j.y;if(!(G<0||G>=8192||$<0||$>=8192)){var ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),se=ee.vertexLength;_a(this.layoutVertexArray,G,$,-1,-1),_a(this.layoutVertexArray,G,$,1,-1),_a(this.layoutVertexArray,G,$,1,1),_a(this.layoutVertexArray,G,$,-1,1),this.indexArray.emplaceBack(se,se+1,se+2),this.indexArray.emplaceBack(se,se+3,se+2),ee.vertexLength+=4,ee.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},f)},cn("CircleBucket",Wr,{omit:["layers"]});var vl=new or({"circle-sort-key":new un(ye.layout_circle["circle-sort-key"])}),zl={paint:new or({"circle-radius":new un(ye.paint_circle["circle-radius"]),"circle-color":new un(ye.paint_circle["circle-color"]),"circle-blur":new un(ye.paint_circle["circle-blur"]),"circle-opacity":new un(ye.paint_circle["circle-opacity"]),"circle-translate":new Cn(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Cn(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Cn(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Cn(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new un(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new un(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new un(ye.paint_circle["circle-stroke-opacity"])}),layout:vl},Ii=typeof Float32Array<"u"?Float32Array:Array;function Na(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Xr(r,s,c){var f=s[0],m=s[1],b=s[2],O=s[3],z=s[4],j=s[5],G=s[6],$=s[7],ee=s[8],se=s[9],ge=s[10],Me=s[11],Ae=s[12],Fe=s[13],ze=s[14],Ve=s[15],nt=c[0],lt=c[1],gt=c[2],wt=c[3];return r[0]=nt*f+lt*z+gt*ee+wt*Ae,r[1]=nt*m+lt*j+gt*se+wt*Fe,r[2]=nt*b+lt*G+gt*ge+wt*ze,r[3]=nt*O+lt*$+gt*Me+wt*Ve,r[4]=(nt=c[4])*f+(lt=c[5])*z+(gt=c[6])*ee+(wt=c[7])*Ae,r[5]=nt*m+lt*j+gt*se+wt*Fe,r[6]=nt*b+lt*G+gt*ge+wt*ze,r[7]=nt*O+lt*$+gt*Me+wt*Ve,r[8]=(nt=c[8])*f+(lt=c[9])*z+(gt=c[10])*ee+(wt=c[11])*Ae,r[9]=nt*m+lt*j+gt*se+wt*Fe,r[10]=nt*b+lt*G+gt*ge+wt*ze,r[11]=nt*O+lt*$+gt*Me+wt*Ve,r[12]=(nt=c[12])*f+(lt=c[13])*z+(gt=c[14])*ee+(wt=c[15])*Ae,r[13]=nt*m+lt*j+gt*se+wt*Fe,r[14]=nt*b+lt*G+gt*ge+wt*ze,r[15]=nt*O+lt*$+gt*Me+wt*Ve,r}Math.hypot||(Math.hypot=function(){for(var r=arguments,s=0,c=arguments.length;c--;)s+=r[c]*r[c];return Math.sqrt(s)});var Dl,r,Gd=Xr;function Pu(r,s,c){var f=s[0],m=s[1],b=s[2],O=s[3];return r[0]=c[0]*f+c[4]*m+c[8]*b+c[12]*O,r[1]=c[1]*f+c[5]*m+c[9]*b+c[13]*O,r[2]=c[2]*f+c[6]*m+c[10]*b+c[14]*O,r[3]=c[3]*f+c[7]*m+c[11]*b+c[15]*O,r}Dl=new Ii(3),Ii!=Float32Array&&(Dl[0]=0,Dl[1]=0,Dl[2]=0),r=new Ii(4),Ii!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0);var Vd=(function(){var r=new Ii(2);Ii!=Float32Array&&(r[0]=0,r[1]=0)}(),function(r){function s(c){r.call(this,c,zl)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.createBucket=function(c){return new Wr(c)},s.prototype.queryRadius=function(c){var f=c;return fs("circle-radius",this,f)+fs("circle-stroke-width",this,f)+er(this.paint.get("circle-translate"))},s.prototype.queryIntersectsFeature=function(c,f,m,b,O,z,j,G){for(var $=Ws(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,j),ee=this.paint.get("circle-radius").evaluate(f,m)+this.paint.get("circle-stroke-width").evaluate(f,m),se="map"===this.paint.get("circle-pitch-alignment"),ge=se?$:function(zt,jt){return zt.map(function(vn){return jc(vn,jt)})}($,G),Me=se?ee*j:ee,Ae=0,Fe=b;Ae<Fe.length;Ae+=1)for(var ze=0,Ve=Fe[Ae];ze<Ve.length;ze+=1){var nt=Ve[ze],lt=se?nt:jc(nt,G),gt=Me,wt=Pu([],[nt.x,nt.y,0,1],G);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?gt*=wt[3]/z.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(gt*=z.cameraToCenterDistance/wt[3]),Lr(ge,lt,gt))return!0}return!1},s}(ds));function jc(r,s){var c=Pu([],[r.x,r.y,0,1],s);return new S(c[0]/c[3],c[1]/c[3])}var jp=function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s}(Wr);function dc(r,s,c,f){var m=s.width,b=s.height;if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==m*b*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(m*b*c);return r.width=m,r.height=b,r.data=f,r}function Eu(r,s,c){var f=s.width,m=s.height;if(f!==r.width||m!==r.height){var b=dc({},{width:f,height:m},c);Yd(r,b,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,f),height:Math.min(r.height,m)},c),r.width=f,r.height=m,r.data=b.data}}function Yd(r,s,c,f,m,b){if(0===m.width||0===m.height)return s;if(m.width>r.width||m.height>r.height||c.x>r.width-m.width||c.y>r.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||f.x>s.width-m.width||f.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");for(var O=r.data,z=s.data,j=0;j<m.height;j++)for(var G=((c.y+j)*r.width+c.x)*b,$=((f.y+j)*s.width+f.x)*b,ee=0;ee<m.width*b;ee++)z[$+ee]=O[G+ee];return s}cn("HeatmapBucket",jp,{omit:["layers"]});var Bc=function(r,s){dc(this,r,1,s)};Bc.prototype.resize=function(r){Eu(this,r,1)},Bc.prototype.clone=function(){return new Bc({width:this.width,height:this.height},new Uint8Array(this.data))},Bc.copy=function(r,s,c,f,m){Yd(r,s,c,f,m,1)};var ya=function(r,s){dc(this,r,4,s)};ya.prototype.resize=function(r){Eu(this,r,4)},ya.prototype.replace=function(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r},ya.prototype.clone=function(){return new ya({width:this.width,height:this.height},new Uint8Array(this.data))},ya.copy=function(r,s,c,f,m){Yd(r,s,c,f,m,4)},cn("AlphaImage",Bc),cn("RGBAImage",ya);var c_={paint:new or({"heatmap-radius":new un(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new un(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Cn(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fa(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Cn(ye.paint_heatmap["heatmap-opacity"])})};function Df(r){var s={},c=r.resolution||256,f=r.clips?r.clips.length:1,m=r.image||new ya({width:c,height:f}),b=function(Me,Ae,Fe){s[r.evaluationKey]=Fe;var ze=r.expression.evaluate(s);m.data[Me+Ae+0]=Math.floor(255*ze.r/ze.a),m.data[Me+Ae+1]=Math.floor(255*ze.g/ze.a),m.data[Me+Ae+2]=Math.floor(255*ze.b/ze.a),m.data[Me+Ae+3]=Math.floor(255*ze.a)};if(r.clips)for(var O=0,z=0;O<f;++O,z+=4*c)for(var j=0,G=0;j<c;j++,G+=4){var $=j/(c-1),ee=r.clips[O];b(z,G,ee.start*(1-$)+ee.end*$)}else for(var se=0,ge=0;se<c;se++,ge+=4)b(0,ge,se/(c-1));return m}var u_=function(r){function s(c){r.call(this,c,c_),this._updateColorRamp()}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.createBucket=function(c){return new jp(c)},s.prototype._handleSpecialPaintPropertyUpdate=function(c){"heatmap-color"===c&&this._updateColorRamp()},s.prototype._updateColorRamp=function(){this.colorRamp=Df({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},s.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},s.prototype.queryRadius=function(){return 0},s.prototype.queryIntersectsFeature=function(){return!1},s.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},s}(ds),p_={paint:new or({"hillshade-illumination-direction":new Cn(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Cn(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Cn(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Cn(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Cn(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Cn(ye.paint_hillshade["hillshade-accent-color"])})},d_=function(r){function s(c){r.call(this,c,p_)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},s}(ds),h_=Yo([{name:"a_pos",components:2,type:"Int16"}],4).members,Hd=Bp,f_=Bp;function Bp(r,s,c){c=c||2;var f,m,b,O,z,j,G,$=s&&s.length,ee=$?s[0]*c:r.length,se=Rf(r,0,ee,c,!0),ge=[];if(!se||se.next===se.prev)return ge;if($&&(se=function(Ae,Fe,ze,Ve){var nt,lt,gt,wt=[];for(nt=0,lt=Fe.length;nt<lt;nt++)(gt=Rf(Ae,Fe[nt]*Ve,nt<lt-1?Fe[nt+1]*Ve:Ae.length,Ve,!1))===gt.next&&(gt.steiner=!0),wt.push(x_(gt));for(wt.sort(Ff),nt=0;nt<wt.length;nt++)v_(wt[nt],ze),ze=hc(ze,ze.next);return ze}(r,s,se,c)),r.length>80*c){f=b=r[0],m=O=r[1];for(var Me=c;Me<ee;Me+=c)(z=r[Me])<f&&(f=z),(j=r[Me+1])<m&&(m=j),z>b&&(b=z),j>O&&(O=j);G=0!==(G=Math.max(b-f,O-m))?1/G:0}return pp(se,ge,c,f,m,G),ge}function Rf(r,s,c,f,m){var b,O;if(m===Xs(r,s,c,f)>0)for(b=s;b<c;b+=f)O=Jf(b,r[b],r[b+1],O);else for(b=c-f;b>=s;b-=f)O=Jf(b,r[b],r[b+1],O);return O&&Gp(O,O.next)&&(hp(O),O=O.next),O}function hc(r,s){if(!r)return r;s||(s=r);var c,f=r;do{if(c=!1,f.steiner||!Gp(f,f.next)&&0!==Ho(f.prev,f,f.next))f=f.next;else{if(hp(f),(f=s=f.prev)===f.next)break;c=!0}}while(c||f!==s);return s}function pp(r,s,c,f,m,b,O){if(r){!O&&b&&function($,ee,se,ge){var Me=$;do{null===Me.z&&(Me.z=Qd(Me.x,Me.y,ee,se,ge)),Me.prevZ=Me.prev,Me.nextZ=Me.next,Me=Me.next}while(Me!==$);Me.prevZ.nextZ=null,Me.prevZ=null,function(Ae){var Fe,ze,Ve,nt,lt,gt,wt,zt,jt=1;do{for(ze=Ae,Ae=null,lt=null,gt=0;ze;){for(gt++,Ve=ze,wt=0,Fe=0;Fe<jt&&(wt++,Ve=Ve.nextZ);Fe++);for(zt=jt;wt>0||zt>0&&Ve;)0!==wt&&(0===zt||!Ve||ze.z<=Ve.z)?(nt=ze,ze=ze.nextZ,wt--):(nt=Ve,Ve=Ve.nextZ,zt--),lt?lt.nextZ=nt:Ae=nt,nt.prevZ=lt,lt=nt;ze=Ve}lt.nextZ=null,jt*=2}while(gt>1)}(Me)}(r,f,m,b);for(var z,j,G=r;r.prev!==r.next;)if(z=r.prev,j=r.next,b?__(r,f,m,b):g_(r))s.push(z.i/c),s.push(r.i/c),s.push(j.i/c),hp(r),r=j.next,G=j.next;else if((r=j)===G){O?1===O?pp(r=m_(hc(r),s,c),s,c,f,m,b,2):2===O&&y_(r,s,c,f,m,b):pp(hc(r),s,c,f,m,b,1);break}}}function g_(r){var s=r.prev,c=r,f=r.next;if(Ho(s,c,f)>=0)return!1;for(var m=r.next.next;m!==r.prev;){if(Au(s.x,s.y,c.x,c.y,f.x,f.y,m.x,m.y)&&Ho(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function __(r,s,c,f){var m=r.prev,b=r,O=r.next;if(Ho(m,b,O)>=0)return!1;for(var z=m.x>b.x?m.x>O.x?m.x:O.x:b.x>O.x?b.x:O.x,j=m.y>b.y?m.y>O.y?m.y:O.y:b.y>O.y?b.y:O.y,G=Qd(m.x<b.x?m.x<O.x?m.x:O.x:b.x<O.x?b.x:O.x,m.y<b.y?m.y<O.y?m.y:O.y:b.y<O.y?b.y:O.y,s,c,f),$=Qd(z,j,s,c,f),ee=r.prevZ,se=r.nextZ;ee&&ee.z>=G&&se&&se.z<=$;){if(ee!==r.prev&&ee!==r.next&&Au(m.x,m.y,b.x,b.y,O.x,O.y,ee.x,ee.y)&&Ho(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,se!==r.prev&&se!==r.next&&Au(m.x,m.y,b.x,b.y,O.x,O.y,se.x,se.y)&&Ho(se.prev,se,se.next)>=0))return!1;se=se.nextZ}for(;ee&&ee.z>=G;){if(ee!==r.prev&&ee!==r.next&&Au(m.x,m.y,b.x,b.y,O.x,O.y,ee.x,ee.y)&&Ho(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;se&&se.z<=$;){if(se!==r.prev&&se!==r.next&&Au(m.x,m.y,b.x,b.y,O.x,O.y,se.x,se.y)&&Ho(se.prev,se,se.next)>=0)return!1;se=se.nextZ}return!0}function m_(r,s,c){var f=r;do{var m=f.prev,b=f.next.next;!Gp(m,b)&&Uf(m,f,f.next,b)&&dp(m,b)&&dp(b,m)&&(s.push(m.i/c),s.push(f.i/c),s.push(b.i/c),hp(f),hp(f.next),f=r=b),f=f.next}while(f!==r);return hc(f)}function y_(r,s,c,f,m,b){var O=r;do{for(var z=O.next.next;z!==O.prev;){if(O.i!==z.i&&C_(O,z)){var j=qf(O,z);return O=hc(O,O.next),j=hc(j,j.next),pp(O,s,c,f,m,b),void pp(j,s,c,f,m,b)}z=z.next}O=O.next}while(O!==r)}function Ff(r,s){return r.x-s.x}function v_(r,s){if(s=function(f,m){var b,O=m,z=f.x,j=f.y,G=-1/0;do{if(j<=O.y&&j>=O.next.y&&O.next.y!==O.y){var $=O.x+(j-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if($<=z&&$>G){if(G=$,$===z){if(j===O.y)return O;if(j===O.next.y)return O.next}b=O.x<O.next.x?O:O.next}}O=O.next}while(O!==m);if(!b)return null;if(z===G)return b;var ee,se=b,ge=b.x,Me=b.y,Ae=1/0;O=b;do{z>=O.x&&O.x>=ge&&z!==O.x&&Au(j<Me?z:G,j,ge,Me,j<Me?G:z,j,O.x,O.y)&&(ee=Math.abs(j-O.y)/(z-O.x),dp(O,f)&&(ee<Ae||ee===Ae&&(O.x>b.x||O.x===b.x&&b_(b,O)))&&(b=O,Ae=ee)),O=O.next}while(O!==se);return b}(r,s)){var c=qf(s,r);hc(s,s.next),hc(c,c.next)}}function b_(r,s){return Ho(r.prev,r,s.prev)<0&&Ho(s.next,r,r.next)<0}function Qd(r,s,c,f,m){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-c)*m)|r<<8))|r<<4))|r<<2))|r<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-f)*m)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function x_(r){var s=r,c=r;do{(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next}while(s!==r);return c}function Au(r,s,c,f,m,b,O,z){return(m-O)*(s-z)-(r-O)*(b-z)>=0&&(r-O)*(f-z)-(c-O)*(s-z)>=0&&(c-O)*(b-z)-(m-O)*(f-z)>=0}function C_(r,s){return r.next.i!==s.i&&r.prev.i!==s.i&&!function(c,f){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==f.i&&m.next.i!==f.i&&Uf(m,m.next,c,f))return!0;m=m.next}while(m!==c);return!1}(r,s)&&(dp(r,s)&&dp(s,r)&&function(c,f){var m=c,b=!1,O=(c.x+f.x)/2,z=(c.y+f.y)/2;do{m.y>z!=m.next.y>z&&m.next.y!==m.y&&O<(m.next.x-m.x)*(z-m.y)/(m.next.y-m.y)+m.x&&(b=!b),m=m.next}while(m!==c);return b}(r,s)&&(Ho(r.prev,r,s.prev)||Ho(r,s.prev,s))||Gp(r,s)&&Ho(r.prev,r,r.next)>0&&Ho(s.prev,s,s.next)>0)}function Ho(r,s,c){return(s.y-r.y)*(c.x-s.x)-(s.x-r.x)*(c.y-s.y)}function Gp(r,s){return r.x===s.x&&r.y===s.y}function Uf(r,s,c,f){var m=Yp(Ho(r,s,c)),b=Yp(Ho(r,s,f)),O=Yp(Ho(c,f,r)),z=Yp(Ho(c,f,s));return m!==b&&O!==z||!(0!==m||!Vp(r,c,s))||!(0!==b||!Vp(r,f,s))||!(0!==O||!Vp(c,r,f))||!(0!==z||!Vp(c,s,f))}function Vp(r,s,c){return s.x<=Math.max(r.x,c.x)&&s.x>=Math.min(r.x,c.x)&&s.y<=Math.max(r.y,c.y)&&s.y>=Math.min(r.y,c.y)}function Yp(r){return r>0?1:r<0?-1:0}function dp(r,s){return Ho(r.prev,r,r.next)<0?Ho(r,s,r.next)>=0&&Ho(r,r.prev,s)>=0:Ho(r,s,r.prev)<0||Ho(r,r.next,s)<0}function qf(r,s){var c=new Kd(r.i,r.x,r.y),f=new Kd(s.i,s.x,s.y),m=r.next,b=s.prev;return r.next=s,s.prev=r,c.next=m,m.prev=c,f.next=c,c.prev=f,b.next=f,f.prev=b,f}function Jf(r,s,c,f){var m=new Kd(r,s,c);return f?(m.next=f.next,m.prev=f,f.next.prev=m,f.next=m):(m.prev=m,m.next=m),m}function hp(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Kd(r,s,c){this.i=r,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xs(r,s,c,f){for(var m=0,b=s,O=c-f;b<c;b+=f)m+=(r[O]-r[b])*(r[b+1]+r[O+1]),O=b;return m}function w_(r,s,c,f,m){!function b(O,z,j,G,$){for(;G>j;){if(G-j>600){var ee=G-j+1,se=z-j+1,ge=Math.log(ee),Me=.5*Math.exp(2*ge/3),Ae=.5*Math.sqrt(ge*Me*(ee-Me)/ee)*(se-ee/2<0?-1:1);b(O,z,Math.max(j,Math.floor(z-se*Me/ee+Ae)),Math.min(G,Math.floor(z+(ee-se)*Me/ee+Ae)),$)}var Fe=O[z],ze=j,Ve=G;for(ku(O,j,z),$(O[G],Fe)>0&&ku(O,j,G);ze<Ve;){for(ku(O,ze,Ve),ze++,Ve--;$(O[ze],Fe)<0;)ze++;for(;$(O[Ve],Fe)>0;)Ve--}0===$(O[j],Fe)?ku(O,j,Ve):ku(O,++Ve,G),Ve<=z&&(j=Ve+1),z<=Ve&&(G=Ve-1)}}(r,s,c||0,f||r.length-1,m||Rl)}function ku(r,s,c){var f=r[s];r[s]=r[c],r[c]=f}function Rl(r,s){return r<s?-1:r>s?1:0}function jf(r,s){var c=r.length;if(c<=1)return[r];for(var f,m,b=[],O=0;O<c;O++){var z=ae(r[O]);0!==z&&(r[O].area=Math.abs(z),void 0===m&&(m=z<0),m===z<0?(f&&b.push(f),f=[r[O]]):f.push(r[O]))}if(f&&b.push(f),s>1)for(var j=0;j<b.length;j++)b[j].length<=s||(w_(b[j],s,1,b[j].length-1,sy),b[j]=b[j].slice(0,s));return b}function sy(r,s){return s.area-r.area}function $d(r,s,c){for(var f=c.patternDependencies,m=!1,b=0,O=s;b<O.length;b+=1){var z=O[b].paint.get(r+"-pattern");z.isConstant()||(m=!0);var j=z.constantOr(null);j&&(m=!0,f[j.to]=!0,f[j.from]=!0)}return m}function Wd(r,s,c,f,m){for(var b=m.patternDependencies,O=0,z=s;O<z.length;O+=1){var j=z[O],G=j.paint.get(r+"-pattern").value;if("constant"!==G.kind){var $=G.evaluate({zoom:f-1},c,{},m.availableImages),ee=G.evaluate({zoom:f},c,{},m.availableImages),se=G.evaluate({zoom:f+1},c,{},m.availableImages);ee=ee&&ee.name?ee.name:ee,se=se&&se.name?se.name:se,b[$=$&&$.name?$.name:$]=!0,b[ee]=!0,b[se]=!0,c.patterns[j.id]={min:$,mid:ee,max:se}}}return c}Bp.deviation=function(r,s,c,f){var m=s&&s.length,b=Math.abs(Xs(r,0,m?s[0]*c:r.length,c));if(m)for(var O=0,z=s.length;O<z;O++)b-=Math.abs(Xs(r,s[O]*c,O<z-1?s[O+1]*c:r.length,c));var j=0;for(O=0;O<f.length;O+=3){var G=f[O]*c,$=f[O+1]*c,ee=f[O+2]*c;j+=Math.abs((r[G]-r[ee])*(r[$+1]-r[G+1])-(r[G]-r[$])*(r[ee+1]-r[G+1]))}return 0===b&&0===j?0:Math.abs((j-b)/b)},Bp.flatten=function(r){for(var s=r[0][0].length,c={vertices:[],holes:[],dimensions:s},f=0,m=0;m<r.length;m++){for(var b=0;b<r[m].length;b++)for(var O=0;O<s;O++)c.vertices.push(r[m][b][O]);m>0&&c.holes.push(f+=r[m-1].length)}return c},Hd.default=f_;var el=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(s){return s.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ll,this.indexArray=new fl,this.indexArray2=new _l,this.programConfigurations=new bn(r.layers,r.zoom),this.segments=new ve,this.segments2=new ve,this.stateDependentLayerIds=this.layers.filter(function(s){return s.isStateDependent()}).map(function(s){return s.id})};el.prototype.populate=function(r,s,c){this.hasPattern=$d("fill",this.layers,s);for(var f=this.layers[0].layout.get("fill-sort-key"),m=[],b=0,O=r;b<O.length;b+=1){var z=O[b],j=z.feature,G=z.id,$=z.index,ee=z.sourceLayerIndex,se=this.layers[0]._featureFilter.needGeometry,ge=wo(j,se);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),ge,c)){var Me=f?f.evaluate(ge,{},c,s.availableImages):void 0,Ae={id:G,properties:j.properties,type:j.type,sourceLayerIndex:ee,index:$,geometry:se?ge.geometry:po(j),patterns:{},sortKey:Me};m.push(Ae)}}f&&m.sort(function(zt,jt){return zt.sortKey-jt.sortKey});for(var Fe=0,ze=m;Fe<ze.length;Fe+=1){var Ve=ze[Fe],nt=Ve.geometry,lt=Ve.index,gt=Ve.sourceLayerIndex;if(this.hasPattern){var wt=Wd("fill",this.layers,Ve,this.zoom,s);this.patternFeatures.push(wt)}else this.addFeature(Ve,nt,lt,c,{});s.featureIndex.insert(r[lt].feature,nt,lt,gt,this.index)}},el.prototype.update=function(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)},el.prototype.addFeatures=function(r,s,c){for(var f=0,m=this.patternFeatures;f<m.length;f+=1){var b=m[f];this.addFeature(b,b.geometry,b.index,s,c)}},el.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},el.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},el.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,h_),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0},el.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},el.prototype.addFeature=function(r,s,c,f,m){for(var b=0,O=jf(s,500);b<O.length;b+=1){for(var z=O[b],j=0,G=0,$=z;G<$.length;G+=1)j+=$[G].length;for(var ee=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),se=ee.vertexLength,ge=[],Me=[],Ae=0,Fe=z;Ae<Fe.length;Ae+=1){var ze=Fe[Ae];if(0!==ze.length){ze!==z[0]&&Me.push(ge.length/2);var Ve=this.segments2.prepareSegment(ze.length,this.layoutVertexArray,this.indexArray2),nt=Ve.vertexLength;this.layoutVertexArray.emplaceBack(ze[0].x,ze[0].y),this.indexArray2.emplaceBack(nt+ze.length-1,nt),ge.push(ze[0].x),ge.push(ze[0].y);for(var lt=1;lt<ze.length;lt++)this.layoutVertexArray.emplaceBack(ze[lt].x,ze[lt].y),this.indexArray2.emplaceBack(nt+lt-1,nt+lt),ge.push(ze[lt].x),ge.push(ze[lt].y);Ve.vertexLength+=ze.length,Ve.primitiveLength+=ze.length}}for(var gt=Hd(ge,Me),wt=0;wt<gt.length;wt+=3)this.indexArray.emplaceBack(se+gt[wt],se+gt[wt+1],se+gt[wt+2]);ee.vertexLength+=j,ee.primitiveLength+=gt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,m,f)},cn("FillBucket",el,{omit:["layers","patternFeatures"]});var T_=new or({"fill-sort-key":new un(ye.layout_fill["fill-sort-key"])}),Bf={paint:new or({"fill-antialias":new Cn(ye.paint_fill["fill-antialias"]),"fill-opacity":new un(ye.paint_fill["fill-opacity"]),"fill-color":new un(ye.paint_fill["fill-color"]),"fill-outline-color":new un(ye.paint_fill["fill-outline-color"]),"fill-translate":new Cn(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Cn(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new Cu(ye.paint_fill["fill-pattern"])}),layout:T_},Gf=function(r){function s(c){r.call(this,c,Bf)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.recalculate=function(c,f){r.prototype.recalculate.call(this,c,f);var m=this.paint._values["fill-outline-color"];"constant"===m.value.kind&&void 0===m.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},s.prototype.createBucket=function(c){return new el(c)},s.prototype.queryRadius=function(){return er(this.paint.get("fill-translate"))},s.prototype.queryIntersectsFeature=function(c,f,m,b,O,z,j){return ma(Ws(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,j),b)},s.prototype.isTileClipped=function(){return!0},s}(ds),M_=Yo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Xd=Iu;function Iu(r,s,c,f,m){this.properties={},this.extent=c,this.type=0,this._pbf=r,this._geometry=-1,this._keys=f,this._values=m,r.readFields(O_,this,s)}function O_(r,s,c){1==r?s.id=c.readVarint():2==r?function(f,m){for(var b=f.readVarint()+f.pos;f.pos<b;){var O=m._keys[f.readVarint()],z=m._values[f.readVarint()];m.properties[O]=z}}(c,s):3==r?s.type=c.readVarint():4==r&&(s._geometry=c.pos)}function Zu(r){for(var s,c,f=0,m=0,b=r.length,O=b-1;m<b;O=m++)f+=((c=r[O]).x-(s=r[m]).x)*(s.y+c.y);return f}Iu.types=["Unknown","Point","LineString","Polygon"],Iu.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var s,c=r.readVarint()+r.pos,f=1,m=0,b=0,O=0,z=[];r.pos<c;){if(m<=0){var j=r.readVarint();f=7&j,m=j>>3}if(m--,1===f||2===f)b+=r.readSVarint(),O+=r.readSVarint(),1===f&&(s&&z.push(s),s=[]),s.push(new S(b,O));else{if(7!==f)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&z.push(s),z},Iu.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var s=r.readVarint()+r.pos,c=1,f=0,m=0,b=0,O=1/0,z=-1/0,j=1/0,G=-1/0;r.pos<s;){if(f<=0){var $=r.readVarint();c=7&$,f=$>>3}if(f--,1===c||2===c)(m+=r.readSVarint())<O&&(O=m),m>z&&(z=m),(b+=r.readSVarint())<j&&(j=b),b>G&&(G=b);else if(7!==c)throw new Error("unknown command "+c)}return[O,j,z,G]},Iu.prototype.toGeoJSON=function(r,s,c){var f,m,b=this.extent*Math.pow(2,c),O=this.extent*r,z=this.extent*s,j=this.loadGeometry(),G=Iu.types[this.type];function $(ge){for(var Me=0;Me<ge.length;Me++){var Ae=ge[Me];ge[Me]=[360*(Ae.x+O)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ae.y+z)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var ee=[];for(f=0;f<j.length;f++)ee[f]=j[f][0];$(j=ee);break;case 2:for(f=0;f<j.length;f++)$(j[f]);break;case 3:for(j=function(ge){var Me=ge.length;if(Me<=1)return[ge];for(var Ae,Fe,ze=[],Ve=0;Ve<Me;Ve++){var nt=Zu(ge[Ve]);0!==nt&&(void 0===Fe&&(Fe=nt<0),Fe===nt<0?(Ae&&ze.push(Ae),Ae=[ge[Ve]]):Ae.push(ge[Ve]))}return Ae&&ze.push(Ae),ze}(j),f=0;f<j.length;f++)for(m=0;m<j[f].length;m++)$(j[f][m])}1===j.length?j=j[0]:G="Multi"+G;var se={type:"Feature",geometry:{type:G,coordinates:j},properties:this.properties};return"id"in this&&(se.id=this.id),se};var Vf=S_;function S_(r,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(P_,this,s),this.length=this._features.length}function P_(r,s,c){15===r?s.version=c.readVarint():1===r?s.name=c.readString():5===r?s.extent=c.readVarint():2===r?s._features.push(c.pos):3===r?s._keys.push(c.readString()):4===r&&s._values.push(function(f){for(var m=null,b=f.readVarint()+f.pos;f.pos<b;){var O=f.readVarint()>>3;m=1===O?f.readString():2===O?f.readFloat():3===O?f.readDouble():4===O?f.readVarint64():5===O?f.readVarint():6===O?f.readSVarint():7===O?f.readBoolean():null}return m}(c))}function E_(r,s,c){if(3===r){var f=new Vf(c,c.readVarint()+c.pos);f.length&&(s[f.name]=f)}}S_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var s=this._pbf.readVarint()+this._pbf.pos;return new Xd(this._pbf,s,this.extent,this._keys,this._values)};var Nu={VectorTile:function(r,s){this.layers=r.readFields(E_,{},s)},VectorTileFeature:Xd,VectorTileLayer:Vf},A_=Nu.VectorTileFeature.types,Yf=Math.pow(2,13);function fp(r,s,c,f,m,b,O,z){r.emplaceBack(s,c,2*Math.floor(f*Yf)+O,m*Yf*2,b*Yf*2,Math.round(z))}var tl=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(s){return s.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Ss,this.indexArray=new fl,this.programConfigurations=new bn(r.layers,r.zoom),this.segments=new ve,this.stateDependentLayerIds=this.layers.filter(function(s){return s.isStateDependent()}).map(function(s){return s.id})};function Hf(r,s){return r.x===s.x&&(r.x<0||r.x>8192)||r.y===s.y&&(r.y<0||r.y>8192)}tl.prototype.populate=function(r,s,c){this.features=[],this.hasPattern=$d("fill-extrusion",this.layers,s);for(var f=0,m=r;f<m.length;f+=1){var b=m[f],O=b.feature,z=b.id,j=b.index,G=b.sourceLayerIndex,$=this.layers[0]._featureFilter.needGeometry,ee=wo(O,$);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),ee,c)){var se={id:z,sourceLayerIndex:G,index:j,geometry:$?ee.geometry:po(O),properties:O.properties,type:O.type,patterns:{}};this.hasPattern?this.features.push(Wd("fill-extrusion",this.layers,se,this.zoom,s)):this.addFeature(se,se.geometry,j,c,{}),s.featureIndex.insert(O,se.geometry,j,G,this.index,!0)}}},tl.prototype.addFeatures=function(r,s,c){for(var f=0,m=this.features;f<m.length;f+=1){var b=m[f];this.addFeature(b,b.geometry,b.index,s,c)}},tl.prototype.update=function(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)},tl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},tl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},tl.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,M_),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},tl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},tl.prototype.addFeature=function(r,s,c,f,m){for(var b=0,O=jf(s,500);b<O.length;b+=1){for(var z=O[b],j=0,G=0,$=z;G<$.length;G+=1)j+=$[G].length;for(var ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),se=0,ge=z;se<ge.length;se+=1){var Me=ge[se];if(0!==Me.length&&!((ai=Me).every(function(ni){return ni.x<0})||ai.every(function(ni){return ni.x>8192})||ai.every(function(ni){return ni.y<0})||ai.every(function(ni){return ni.y>8192})))for(var Ae=0,Fe=0;Fe<Me.length;Fe++){var ze=Me[Fe];if(Fe>=1){var Ve=Me[Fe-1];if(!Hf(ze,Ve)){ee.vertexLength+4>ve.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var nt=ze.sub(Ve)._perp()._unit(),lt=Ve.dist(ze);Ae+lt>32768&&(Ae=0),fp(this.layoutVertexArray,ze.x,ze.y,nt.x,nt.y,0,0,Ae),fp(this.layoutVertexArray,ze.x,ze.y,nt.x,nt.y,0,1,Ae),fp(this.layoutVertexArray,Ve.x,Ve.y,nt.x,nt.y,0,0,Ae+=lt),fp(this.layoutVertexArray,Ve.x,Ve.y,nt.x,nt.y,0,1,Ae);var gt=ee.vertexLength;this.indexArray.emplaceBack(gt,gt+2,gt+1),this.indexArray.emplaceBack(gt+1,gt+2,gt+3),ee.vertexLength+=4,ee.primitiveLength+=2}}}}if(ee.vertexLength+j>ve.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray)),"Polygon"===A_[r.type]){for(var wt=[],zt=[],jt=ee.vertexLength,vn=0,on=z;vn<on.length;vn+=1){var On=on[vn];if(0!==On.length){On!==z[0]&&zt.push(wt.length/2);for(var rn=0;rn<On.length;rn++){var ii=On[rn];fp(this.layoutVertexArray,ii.x,ii.y,0,0,1,1,0),wt.push(ii.x),wt.push(ii.y)}}}for(var Jn=Hd(wt,zt),mn=0;mn<Jn.length;mn+=3)this.indexArray.emplaceBack(jt+Jn[mn],jt+Jn[mn+2],jt+Jn[mn+1]);ee.primitiveLength+=Jn.length/3,ee.vertexLength+=j}}var ai;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,m,f)},cn("FillExtrusionBucket",tl,{omit:["layers","features"]});var k_={paint:new or({"fill-extrusion-opacity":new Cn(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new un(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Cn(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Cn(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Cu(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new un(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new un(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Cn(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ly=function(r){function s(c){r.call(this,c,k_)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.createBucket=function(c){return new tl(c)},s.prototype.queryRadius=function(){return er(this.paint.get("fill-extrusion-translate"))},s.prototype.is3D=function(){return!0},s.prototype.queryIntersectsFeature=function(c,f,m,b,O,z,j,G){var $=Ws(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,j),ee=this.paint.get("fill-extrusion-height").evaluate(f,m),se=this.paint.get("fill-extrusion-base").evaluate(f,m),ge=function(Ae,Fe,ze,Ve){for(var nt=[],lt=0,gt=Ae;lt<gt.length;lt+=1){var wt=gt[lt],zt=[wt.x,wt.y,0,1];Pu(zt,zt,Fe),nt.push(new S(zt[0]/zt[3],zt[1]/zt[3]))}return nt}($,G),Me=function(Ae,Fe,ze,Ve){for(var nt=[],lt=[],gt=Ve[8]*Fe,wt=Ve[9]*Fe,zt=Ve[10]*Fe,jt=Ve[11]*Fe,vn=Ve[8]*ze,on=Ve[9]*ze,On=Ve[10]*ze,rn=Ve[11]*ze,ii=0,Jn=Ae;ii<Jn.length;ii+=1){for(var mn=[],ai=[],ni=0,xi=Jn[ii];ni<xi.length;ni+=1){var An=xi[ni],si=An.x,Xi=An.y,ho=Ve[0]*si+Ve[4]*Xi+Ve[12],fo=Ve[1]*si+Ve[5]*Xi+Ve[13],go=Ve[2]*si+Ve[6]*Xi+Ve[14],Io=Ve[3]*si+Ve[7]*Xi+Ve[15],lr=go+zt,cr=Io+jt,ea=ho+vn,_r=fo+on,ta=go+On,_o=Io+rn,ur=new S((ho+gt)/cr,(fo+wt)/cr);ur.z=lr/cr,mn.push(ur);var di=new S(ea/_o,_r/_o);di.z=ta/_o,ai.push(di)}nt.push(mn),lt.push(ai)}return[nt,lt]}(b,se,ee,G);return function(Ae,Fe,ze){var Ve=1/0;ma(ze,Fe)&&(Ve=Qf(ze,Fe[0]));for(var nt=0;nt<Fe.length;nt++)for(var lt=Fe[nt],gt=Ae[nt],wt=0;wt<lt.length-1;wt++){var zt=lt[wt],jt=[zt,lt[wt+1],gt[wt+1],gt[wt],zt];ml(ze,jt)&&(Ve=Math.min(Ve,Qf(ze,jt)))}return Ve!==1/0&&Ve}(Me[0],Me[1],ge)},s}(ds);function Hp(r,s){return r.x*s.x+r.y*s.y}function Qf(r,s){if(1===r.length){for(var c,f=0,m=s[f++];!c||m.equals(c);)if(!(c=s[f++]))return 1/0;for(;f<s.length;f++){var b=s[f],O=r[0],z=c.sub(m),j=b.sub(m),G=O.sub(m),$=Hp(z,z),ee=Hp(z,j),se=Hp(j,j),ge=Hp(G,z),Me=Hp(G,j),Ae=$*se-ee*ee,Fe=(se*ge-ee*Me)/Ae,ze=($*Me-ee*ge)/Ae,Ve=m.z*(1-Fe-ze)+c.z*Fe+b.z*ze;if(isFinite(Ve))return Ve}return 1/0}for(var nt=1/0,lt=0,gt=s;lt<gt.length;lt+=1)nt=Math.min(nt,gt[lt].z);return nt}var Kf=Yo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,I_=Yo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Z_=Nu.VectorTileFeature.types,gp=Math.cos(Math.PI/180*37.5),N_=Math.pow(2,14)/.5,zr=function(r){var s=this;this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(c){return c.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(c){s.gradients[c.id]={}}),this.layoutVertexArray=new Nr,this.layoutVertexArray2=new Qs,this.indexArray=new fl,this.programConfigurations=new bn(r.layers,r.zoom),this.segments=new ve,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(c){return c.isStateDependent()}).map(function(c){return c.id})};zr.prototype.populate=function(r,s,c){this.hasPattern=$d("line",this.layers,s);for(var f=this.layers[0].layout.get("line-sort-key"),m=[],b=0,O=r;b<O.length;b+=1){var z=O[b],j=z.feature,G=z.id,$=z.index,ee=z.sourceLayerIndex,se=this.layers[0]._featureFilter.needGeometry,ge=wo(j,se);if(this.layers[0]._featureFilter.filter(new oi(this.zoom),ge,c)){var Me=f?f.evaluate(ge,{},c):void 0,Ae={id:G,properties:j.properties,type:j.type,sourceLayerIndex:ee,index:$,geometry:se?ge.geometry:po(j),patterns:{},sortKey:Me};m.push(Ae)}}f&&m.sort(function(zt,jt){return zt.sortKey-jt.sortKey});for(var Fe=0,ze=m;Fe<ze.length;Fe+=1){var Ve=ze[Fe],nt=Ve.geometry,lt=Ve.index,gt=Ve.sourceLayerIndex;if(this.hasPattern){var wt=Wd("line",this.layers,Ve,this.zoom,s);this.patternFeatures.push(wt)}else this.addFeature(Ve,nt,lt,c,{});s.featureIndex.insert(r[lt].feature,nt,lt,gt,this.index)}},zr.prototype.update=function(r,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,c)},zr.prototype.addFeatures=function(r,s,c){for(var f=0,m=this.patternFeatures;f<m.length;f+=1){var b=m[f];this.addFeature(b,b.geometry,b.index,s,c)}},zr.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},zr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},zr.prototype.upload=function(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,I_)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Kf),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},zr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},zr.prototype.lineFeatureClips=function(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}},zr.prototype.addFeature=function(r,s,c,f,m){var b=this.layers[0].layout,O=b.get("line-join").evaluate(r,{}),z=b.get("line-cap"),j=b.get("line-miter-limit"),G=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(var $=0,ee=s;$<ee.length;$+=1)this.addLine(ee[$],r,O,z,j,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,m,f)},zr.prototype.addLine=function(r,s,c,f,m,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var O=0;O<r.length-1;O++)this.totalDistance+=r[O].dist(r[O+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var z="Polygon"===Z_[s.type],j=r.length;j>=2&&r[j-1].equals(r[j-2]);)j--;for(var G=0;G<j-1&&r[G].equals(r[G+1]);)G++;if(!(j<(z?3:2))){"bevel"===c&&(m=1.05);var $,ee=this.overscaling<=16?122880/(512*this.overscaling):0,se=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray),ge=void 0,Me=void 0,Ae=void 0,Fe=void 0;this.e1=this.e2=-1,z&&(Fe=r[G].sub($=r[j-2])._unit()._perp());for(var ze=G;ze<j;ze++)if(!(Me=ze===j-1?z?r[G+1]:void 0:r[ze+1])||!r[ze].equals(Me)){Fe&&(Ae=Fe),$&&(ge=$),$=r[ze],Fe=Me?Me.sub($)._unit()._perp():Ae;var Ve=(Ae=Ae||Fe).add(Fe);0===Ve.x&&0===Ve.y||Ve._unit();var nt=Ae.x*Fe.x+Ae.y*Fe.y,lt=Ve.x*Fe.x+Ve.y*Fe.y,gt=0!==lt?1/lt:1/0,wt=2*Math.sqrt(2-2*lt),zt=lt<gp&&ge&&Me,jt=Ae.x*Fe.y-Ae.y*Fe.x>0;if(zt&&ze>G){var vn=$.dist(ge);if(vn>2*ee){var on=$.sub($.sub(ge)._mult(ee/vn)._round());this.updateDistance(ge,on),this.addCurrentVertex(on,Ae,0,0,se),ge=on}}var On=ge&&Me,rn=On?c:z?"butt":f;if(On&&"round"===rn&&(gt<b?rn="miter":gt<=2&&(rn="fakeround")),"miter"===rn&&gt>m&&(rn="bevel"),"bevel"===rn&&(gt>2&&(rn="flipbevel"),gt<m&&(rn="miter")),ge&&this.updateDistance(ge,$),"miter"===rn)Ve._mult(gt),this.addCurrentVertex($,Ve,0,0,se);else if("flipbevel"===rn){if(gt>100)Ve=Fe.mult(-1);else{var ii=gt*Ae.add(Fe).mag()/Ae.sub(Fe).mag();Ve._perp()._mult(ii*(jt?-1:1))}this.addCurrentVertex($,Ve,0,0,se),this.addCurrentVertex($,Ve.mult(-1),0,0,se)}else if("bevel"===rn||"fakeround"===rn){var Jn=-Math.sqrt(gt*gt-1),mn=jt?Jn:0,ai=jt?0:Jn;if(ge&&this.addCurrentVertex($,Ae,mn,ai,se),"fakeround"===rn)for(var ni=Math.round(180*wt/Math.PI/20),xi=1;xi<ni;xi++){var An=xi/ni;if(.5!==An){var si=An-.5;An+=An*si*(An-1)*((1.0904+nt*(nt*(3.55645-1.43519*nt)-3.2452))*si*si+(.848013+nt*(.215638*nt-1.06021)))}var Xi=Fe.sub(Ae)._mult(An)._add(Ae)._unit()._mult(jt?-1:1);this.addHalfVertex($,Xi.x,Xi.y,!1,jt,0,se)}Me&&this.addCurrentVertex($,Fe,-mn,-ai,se)}else if("butt"===rn)this.addCurrentVertex($,Ve,0,0,se);else if("square"===rn){var ho=ge?1:-1;this.addCurrentVertex($,Ve,ho,ho,se)}else"round"===rn&&(ge&&(this.addCurrentVertex($,Ae,0,0,se),this.addCurrentVertex($,Ae,1,1,se,!0)),Me&&(this.addCurrentVertex($,Fe,-1,-1,se,!0),this.addCurrentVertex($,Fe,0,0,se)));if(zt&&ze<j-1){var fo=$.dist(Me);if(fo>2*ee){var go=$.add(Me.sub($)._mult(ee/fo)._round());this.updateDistance($,go),this.addCurrentVertex(go,Fe,0,0,se),$=go}}}}},zr.prototype.addCurrentVertex=function(r,s,c,f,m,b){void 0===b&&(b=!1);var O=s.y*f-s.x,z=-s.y-s.x*f;this.addHalfVertex(r,s.x+s.y*c,s.y-s.x*c,b,!1,c,m),this.addHalfVertex(r,O,z,b,!0,-f,m),this.distance>N_/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(r,s,c,f,m,b))},zr.prototype.addHalfVertex=function(r,s,c,f,m,b,O){var z=.5*(this.lineClips?this.scaledDistance*(N_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r.x<<1)+(f?1:0),(r.y<<1)+(m?1:0),Math.round(63*s)+128,Math.round(63*c)+128,1+(0===b?0:b<0?-1:1)|(63&z)<<2,z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var j=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,j),O.primitiveLength++),m?this.e2=j:this.e1=j},zr.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},zr.prototype.updateDistance=function(r,s){this.distance+=r.dist(s),this.updateScaledDistance()},cn("LineBucket",zr,{omit:["layers","patternFeatures"]});var L_=new or({"line-cap":new Cn(ye.layout_line["line-cap"]),"line-join":new un(ye.layout_line["line-join"]),"line-miter-limit":new Cn(ye.layout_line["line-miter-limit"]),"line-round-limit":new Cn(ye.layout_line["line-round-limit"]),"line-sort-key":new un(ye.layout_line["line-sort-key"])}),$f={paint:new or({"line-opacity":new un(ye.paint_line["line-opacity"]),"line-color":new un(ye.paint_line["line-color"]),"line-translate":new Cn(ye.paint_line["line-translate"]),"line-translate-anchor":new Cn(ye.paint_line["line-translate-anchor"]),"line-width":new un(ye.paint_line["line-width"]),"line-gap-width":new un(ye.paint_line["line-gap-width"]),"line-offset":new un(ye.paint_line["line-offset"]),"line-blur":new un(ye.paint_line["line-blur"]),"line-dasharray":new Xo(ye.paint_line["line-dasharray"]),"line-pattern":new Cu(ye.paint_line["line-pattern"]),"line-gradient":new fa(ye.paint_line["line-gradient"])}),layout:L_},z_=new(function(r){function s(){r.apply(this,arguments)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.possiblyEvaluate=function(c,f){return f=new oi(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),r.prototype.possiblyEvaluate.call(this,c,f)},s.prototype.evaluate=function(c,f,m,b){return f=W({},f,{zoom:Math.floor(f.zoom)}),r.prototype.evaluate.call(this,c,f,m,b)},s}(un))($f.paint.properties["line-width"].specification);z_.useIntegerZoom=!0;var Wf=function(r){function s(c){r.call(this,c,$f),this.gradientVersion=0}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype._handleSpecialPaintPropertyUpdate=function(c){"line-gradient"===c&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Hi,this.gradientVersion=(this.gradientVersion+1)%Z)},s.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},s.prototype.recalculate=function(c,f){r.prototype.recalculate.call(this,c,f),this.paint._values["line-floorwidth"]=z_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)},s.prototype.createBucket=function(c){return new zr(c)},s.prototype.queryRadius=function(c){var f=c,m=eh(fs("line-width",this,f),fs("line-gap-width",this,f)),b=fs("line-offset",this,f);return m/2+Math.abs(b)+er(this.paint.get("line-translate"))},s.prototype.queryIntersectsFeature=function(c,f,m,b,O,z,j){var G=Ws(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,j),$=j/2*eh(this.paint.get("line-width").evaluate(f,m),this.paint.get("line-gap-width").evaluate(f,m)),ee=this.paint.get("line-offset").evaluate(f,m);return ee&&(b=function(se,ge){for(var Me=[],Ae=new S(0,0),Fe=0;Fe<se.length;Fe++){for(var ze=se[Fe],Ve=[],nt=0;nt<ze.length;nt++){var lt=ze[nt],gt=ze[nt+1],wt=0===nt?Ae:lt.sub(ze[nt-1])._unit()._perp(),zt=nt===ze.length-1?Ae:gt.sub(lt)._unit()._perp(),jt=wt._add(zt)._unit();jt._mult(1/(jt.x*zt.x+jt.y*zt.y)),Ve.push(jt._mult(ge)._add(lt))}Me.push(Ve)}return Me}(b,ee*j)),function(se,ge,Me){for(var Ae=0;Ae<ge.length;Ae++){var Fe=ge[Ae];if(se.length>=3)for(var ze=0;ze<Fe.length;ze++)if(Es(se,Fe[ze]))return!0;if(Za(se,Fe,Me))return!0}return!1}(G,b,$)},s.prototype.isTileClipped=function(){return!0},s}(ds);function eh(r,s){return s>0?s+2*r:r}var fc=Yo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),D_=Yo([{name:"a_projected_pos",components:3,type:"Float32"}],4),Sr=(Yo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Yo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Fl=(Yo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Yo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),R_=Yo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Xf(r,s,c){return r.sections.forEach(function(f){var m,O,z;f.text=(m=f.text,O=c,"uppercase"===(z=s.layout.get("text-transform").evaluate(O,{}))?m=m.toLocaleUpperCase():"lowercase"===z&&(m=m.toLocaleLowerCase()),fr.applyArabicShaping&&(m=fr.applyArabicShaping(m)),m)}),r}Yo([{name:"triangle",components:3,type:"Uint16"}]),Yo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Yo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Yo([{type:"Float32",name:"offsetX"}]),Yo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var _p={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},eg=function(r,s,c,f,m){var b,O,z=8*m-f-1,j=(1<<z)-1,G=j>>1,$=-7,ee=c?m-1:0,se=c?-1:1,ge=r[s+ee];for(ee+=se,b=ge&(1<<-$)-1,ge>>=-$,$+=z;$>0;b=256*b+r[s+ee],ee+=se,$-=8);for(O=b&(1<<-$)-1,b>>=-$,$+=f;$>0;O=256*O+r[s+ee],ee+=se,$-=8);if(0===b)b=1-G;else{if(b===j)return O?NaN:1/0*(ge?-1:1);O+=Math.pow(2,f),b-=G}return(ge?-1:1)*O*Math.pow(2,b-f)},tg=function(r,s,c,f,m,b){var O,z,j,G=8*b-m-1,$=(1<<G)-1,ee=$>>1,se=23===m?Math.pow(2,-24)-Math.pow(2,-77):0,ge=f?0:b-1,Me=f?1:-1,Ae=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(z=isNaN(s)?1:0,O=$):(O=Math.floor(Math.log(s)/Math.LN2),s*(j=Math.pow(2,-O))<1&&(O--,j*=2),(s+=O+ee>=1?se/j:se*Math.pow(2,1-ee))*j>=2&&(O++,j/=2),O+ee>=$?(z=0,O=$):O+ee>=1?(z=(s*j-1)*Math.pow(2,m),O+=ee):(z=s*Math.pow(2,ee-1)*Math.pow(2,m),O=0));m>=8;r[c+ge]=255&z,ge+=Me,z/=256,m-=8);for(O=O<<m|z,G+=m;G>0;r[c+ge]=255&O,ge+=Me,O/=256,G-=8);r[c+ge-Me]|=128*Ae},Qp=pi;function pi(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}pi.Varint=0,pi.Fixed64=1,pi.Bytes=2,pi.Fixed32=5;var ng=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ul(r){return r.type===pi.Bytes?r.readVarint()+r.pos:r.pos+1}function ig(r,s,c){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(f);for(var m=c.pos-1;m>=r;m--)c.buf[m+f]=c.buf[m]}function F_(r,s){for(var c=0;c<r.length;c++)s.writeVarint(r[c])}function U_(r,s){for(var c=0;c<r.length;c++)s.writeSVarint(r[c])}function q_(r,s){for(var c=0;c<r.length;c++)s.writeFloat(r[c])}function J_(r,s){for(var c=0;c<r.length;c++)s.writeDouble(r[c])}function j_(r,s){for(var c=0;c<r.length;c++)s.writeBoolean(r[c])}function B_(r,s){for(var c=0;c<r.length;c++)s.writeFixed32(r[c])}function G_(r,s){for(var c=0;c<r.length;c++)s.writeSFixed32(r[c])}function th(r,s){for(var c=0;c<r.length;c++)s.writeFixed64(r[c])}function nh(r,s){for(var c=0;c<r.length;c++)s.writeSFixed64(r[c])}function mp(r,s){return(r[s]|r[s+1]<<8|r[s+2]<<16)+16777216*r[s+3]}function gr(r,s,c){r[c]=s,r[c+1]=s>>>8,r[c+2]=s>>>16,r[c+3]=s>>>24}function og(r,s){return(r[s]|r[s+1]<<8|r[s+2]<<16)+(r[s+3]<<24)}function V_(r,s,c){1===r&&c.readMessage(rg,s)}function rg(r,s,c){if(3===r){var f=c.readMessage(As,{}),m=f.width,b=f.height,O=f.left,z=f.top,j=f.advance;s.push({id:f.id,bitmap:new Bc({width:m+6,height:b+6},f.bitmap),metrics:{width:m,height:b,left:O,top:z,advance:j}})}}function As(r,s,c){1===r?s.id=c.readVarint():2===r?s.bitmap=c.readBytes():3===r?s.width=c.readVarint():4===r?s.height=c.readVarint():5===r?s.left=c.readSVarint():6===r?s.top=c.readSVarint():7===r&&(s.advance=c.readVarint())}function yp(r){for(var s=0,c=0,f=0,m=r;f<m.length;f+=1){var b=m[f];s+=b.w*b.h,c=Math.max(c,b.w)}r.sort(function(Ae,Fe){return Fe.h-Ae.h});for(var O=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}],z=0,j=0,G=0,$=r;G<$.length;G+=1)for(var ee=$[G],se=O.length-1;se>=0;se--){var ge=O[se];if(!(ee.w>ge.w||ee.h>ge.h)){if(ee.x=ge.x,ee.y=ge.y,j=Math.max(j,ee.y+ee.h),z=Math.max(z,ee.x+ee.w),ee.w===ge.w&&ee.h===ge.h){var Me=O.pop();se<O.length&&(O[se]=Me)}else ee.h===ge.h?(ge.x+=ee.w,ge.w-=ee.w):ee.w===ge.w?(ge.y+=ee.h,ge.h-=ee.h):(O.push({x:ge.x+ee.w,y:ge.y,w:ge.w-ee.w,h:ee.h}),ge.y+=ee.h,ge.h-=ee.h);break}}return{w:z,h:j,fill:s/(z*j)||0}}pi.prototype={destroy:function(){this.buf=null},readFields:function(r,s,c){for(c=c||this.length;this.pos<c;){var f=this.readVarint(),m=f>>3,b=this.pos;this.type=7&f,r(m,s,this),this.pos===b&&this.skip(f)}return s},readMessage:function(r,s){return this.readFields(r,s,this.readVarint()+this.pos)},readFixed32:function(){var r=mp(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=og(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=mp(this.buf,this.pos)+4294967296*mp(this.buf,this.pos+4);return this.pos+=8,r},readSFixed64:function(){var r=mp(this.buf,this.pos)+4294967296*og(this.buf,this.pos+4);return this.pos+=8,r},readFloat:function(){var r=eg(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=eg(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var s,c,f=this.buf;return s=127&(c=f[this.pos++]),c<128?s:(s|=(127&(c=f[this.pos++]))<<7,c<128?s:(s|=(127&(c=f[this.pos++]))<<14,c<128?s:(s|=(127&(c=f[this.pos++]))<<21,c<128?s:function(m,b,O){var z,j,G=O.buf;if(z=(112&(j=G[O.pos++]))>>4,j<128||(z|=(127&(j=G[O.pos++]))<<3,j<128)||(z|=(127&(j=G[O.pos++]))<<10,j<128)||(z|=(127&(j=G[O.pos++]))<<17,j<128)||(z|=(127&(j=G[O.pos++]))<<24,j<128)||(z|=(1&(j=G[O.pos++]))<<31,j<128))return function Lu(r,s,c){return c?4294967296*s+(r>>>0):4294967296*(s>>>0)+(r>>>0)}(m,z,b);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=f[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,s=this.pos;return this.pos=r,r-s>=12&&ng?ng.decode(this.buf.subarray(s,r)):function(c,f,m){for(var b="",O=f;O<m;){var z,j,G,$=c[O],ee=null,se=$>239?4:$>223?3:$>191?2:1;if(O+se>m)break;1===se?$<128&&(ee=$):2===se?128==(192&(z=c[O+1]))&&(ee=(31&$)<<6|63&z)<=127&&(ee=null):3===se?(j=c[O+2],128==(192&(z=c[O+1]))&&128==(192&j)&&((ee=(15&$)<<12|(63&z)<<6|63&j)<=2047||ee>=55296&&ee<=57343)&&(ee=null)):4===se&&(j=c[O+2],G=c[O+3],128==(192&(z=c[O+1]))&&128==(192&j)&&128==(192&G)&&((ee=(15&$)<<18|(63&z)<<12|(63&j)<<6|63&G)<=65535||ee>=1114112)&&(ee=null)),null===ee?(ee=65533,se=1):ee>65535&&(ee-=65536,b+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|1023&ee),b+=String.fromCharCode(ee),O+=se}return b}(this.buf,s,r)},readBytes:function(){var r=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,r);return this.pos=r,s},readPackedVarint:function(r,s){if(this.type!==pi.Bytes)return r.push(this.readVarint(s));var c=Ul(this);for(r=r||[];this.pos<c;)r.push(this.readVarint(s));return r},readPackedSVarint:function(r){if(this.type!==pi.Bytes)return r.push(this.readSVarint());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==pi.Bytes)return r.push(this.readBoolean());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==pi.Bytes)return r.push(this.readFloat());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==pi.Bytes)return r.push(this.readDouble());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==pi.Bytes)return r.push(this.readFixed32());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==pi.Bytes)return r.push(this.readSFixed32());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==pi.Bytes)return r.push(this.readFixed64());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==pi.Bytes)return r.push(this.readSFixed64());var s=Ul(this);for(r=r||[];this.pos<s;)r.push(this.readSFixed64());return r},skip:function(r){var s=7&r;if(s===pi.Varint)for(;this.buf[this.pos++]>127;);else if(s===pi.Bytes)this.pos=this.readVarint()+this.pos;else if(s===pi.Fixed32)this.pos+=4;else{if(s!==pi.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(r,s){this.writeVarint(r<<3|s)},realloc:function(r){for(var s=this.length||16;s<this.pos+r;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),gr(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),gr(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),gr(this.buf,-1&r,this.pos),gr(this.buf,Math.floor(r*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),gr(this.buf,-1&r,this.pos),gr(this.buf,Math.floor(r*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(s,c){var f,m,b,z;if(s>=0?(f=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,m=m+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),b=f,(z=c).buf[z.pos++]=127&b|128,b>>>=7,z.buf[z.pos++]=127&b|128,b>>>=7,z.buf[z.pos++]=127&b|128,b>>>=7,z.buf[z.pos++]=127&b|128,z.buf[z.pos]=127&(b>>>=7),function(b,O){var z=(7&b)<<4;O.buf[O.pos++]|=z|((b>>>=3)?128:0),b&&(O.buf[O.pos++]=127&b|((b>>>=7)?128:0),b&&(O.buf[O.pos++]=127&b|((b>>>=7)?128:0),b&&(O.buf[O.pos++]=127&b|((b>>>=7)?128:0),b&&(O.buf[O.pos++]=127&b|((b>>>=7)?128:0),b&&(O.buf[O.pos++]=127&b)))))}(m,c)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var s=this.pos;this.pos=function(f,m,b){for(var O,z,j=0;j<m.length;j++){if((O=m.charCodeAt(j))>55295&&O<57344){if(!z){O>56319||j+1===m.length?(f[b++]=239,f[b++]=191,f[b++]=189):z=O;continue}if(O<56320){f[b++]=239,f[b++]=191,f[b++]=189,z=O;continue}O=z-55296<<10|O-56320|65536,z=null}else z&&(f[b++]=239,f[b++]=191,f[b++]=189,z=null);O<128?f[b++]=O:(O<2048?f[b++]=O>>6|192:(O<65536?f[b++]=O>>12|224:(f[b++]=O>>18|240,f[b++]=O>>12&63|128),f[b++]=O>>6&63|128),f[b++]=63&O|128)}return b}(this.buf,r,this.pos);var c=this.pos-s;c>=128&&ig(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(r){this.realloc(4),tg(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),tg(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var s=r.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=r[c]},writeRawMessage:function(r,s){this.pos++;var c=this.pos;r(s,this);var f=this.pos-c;f>=128&&ig(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f},writeMessage:function(r,s,c){this.writeTag(r,pi.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(r,s){s.length&&this.writeMessage(r,F_,s)},writePackedSVarint:function(r,s){s.length&&this.writeMessage(r,U_,s)},writePackedBoolean:function(r,s){s.length&&this.writeMessage(r,j_,s)},writePackedFloat:function(r,s){s.length&&this.writeMessage(r,q_,s)},writePackedDouble:function(r,s){s.length&&this.writeMessage(r,J_,s)},writePackedFixed32:function(r,s){s.length&&this.writeMessage(r,B_,s)},writePackedSFixed32:function(r,s){s.length&&this.writeMessage(r,G_,s)},writePackedFixed64:function(r,s){s.length&&this.writeMessage(r,th,s)},writePackedSFixed64:function(r,s){s.length&&this.writeMessage(r,nh,s)},writeBytesField:function(r,s){this.writeTag(r,pi.Bytes),this.writeBytes(s)},writeFixed32Field:function(r,s){this.writeTag(r,pi.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(r,s){this.writeTag(r,pi.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(r,s){this.writeTag(r,pi.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(r,s){this.writeTag(r,pi.Fixed64),this.writeSFixed64(s)},writeVarintField:function(r,s){this.writeTag(r,pi.Varint),this.writeVarint(s)},writeSVarintField:function(r,s){this.writeTag(r,pi.Varint),this.writeSVarint(s)},writeStringField:function(r,s){this.writeTag(r,pi.Bytes),this.writeString(s)},writeFloatField:function(r,s){this.writeTag(r,pi.Fixed32),this.writeFloat(s)},writeDoubleField:function(r,s){this.writeTag(r,pi.Fixed64),this.writeDouble(s)},writeBooleanField:function(r,s){this.writeVarintField(r,Boolean(s))}};var vp=function(r,s){var c=s.pixelRatio,f=s.version,m=s.stretchX,b=s.stretchY,O=s.content;this.paddedRect=r,this.pixelRatio=c,this.stretchX=m,this.stretchY=b,this.content=O,this.version=f},Gc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Gc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Gc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Gc.tlbr.get=function(){return this.tl.concat(this.br)},Gc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(vp.prototype,Gc);var Kp=function(r,s){var c={},f={};this.haveRenderCallbacks=[];var m=[];this.addImages(r,c,m),this.addImages(s,f,m);var b=yp(m),O=new ya({width:b.w||1,height:b.h||1});for(var z in r){var j=r[z],G=c[z].paddedRect;ya.copy(j.data,O,{x:0,y:0},{x:G.x+1,y:G.y+1},j.data)}for(var $ in s){var ee=s[$],se=f[$].paddedRect,ge=se.x+1,Me=se.y+1,Ae=ee.data.width,Fe=ee.data.height;ya.copy(ee.data,O,{x:0,y:0},{x:ge,y:Me},ee.data),ya.copy(ee.data,O,{x:0,y:Fe-1},{x:ge,y:Me-1},{width:Ae,height:1}),ya.copy(ee.data,O,{x:0,y:0},{x:ge,y:Me+Fe},{width:Ae,height:1}),ya.copy(ee.data,O,{x:Ae-1,y:0},{x:ge-1,y:Me},{width:1,height:Fe}),ya.copy(ee.data,O,{x:0,y:0},{x:ge+Ae,y:Me},{width:1,height:Fe})}this.image=O,this.iconPositions=c,this.patternPositions=f};Kp.prototype.addImages=function(r,s,c){for(var f in r){var m=r[f],b={x:0,y:0,w:m.data.width+2,h:m.data.height+2};c.push(b),s[f]=new vp(b,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(f)}},Kp.prototype.patchUpdatedImages=function(r,s){for(var c in r.dispatchRenderCallbacks(this.haveRenderCallbacks),r.updatedImages)this.patchUpdatedImage(this.iconPositions[c],r.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],r.getImage(c),s)},Kp.prototype.patchUpdatedImage=function(r,s,c){if(r&&s&&r.version!==s.version){r.version=s.version;var f=r.tl;c.update(s.data,void 0,{x:f[0],y:f[1]})}},cn("ImagePosition",vp),cn("ImageAtlas",Kp);var Ka={horizontal:1,vertical:2,horizontalOnly:3},zu=function(){this.scale=1,this.fontStack="",this.imageName=null};zu.forText=function(r,s){var c=new zu;return c.scale=r||1,c.fontStack=s,c},zu.forImage=function(r){var s=new zu;return s.imageName=r,s};var Pr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function bp(r,s,c,f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae){var Fe,ze=Pr.fromFeature(r,m);ee===Ka.vertical&&ze.verticalizePunctuation();var Ve=fr.processBidirectionalText,nt=fr.processStyledBidirectionalText;if(Ve&&1===ze.sections.length){Fe=[];for(var lt=0,gt=Ve(ze.toString(),$p(ze,G,b,s,f,ge,Me));lt<gt.length;lt+=1){var wt=gt[lt],zt=new Pr;zt.text=wt,zt.sections=ze.sections;for(var jt=0;jt<wt.length;jt++)zt.sectionIndex.push(0);Fe.push(zt)}}else if(nt){Fe=[];for(var vn=0,on=nt(ze.text,ze.sectionIndex,$p(ze,G,b,s,f,ge,Me));vn<on.length;vn+=1){var On=on[vn],rn=new Pr;rn.text=On[0],rn.sectionIndex=On[1],rn.sections=ze.sections,Fe.push(rn)}}else Fe=function(mn,ai){for(var ni=[],xi=mn.text,An=0,si=0,Xi=ai;si<Xi.length;si+=1){var ho=Xi[si];ni.push(mn.substring(An,ho)),An=ho}return An<xi.length&&ni.push(mn.substring(An,xi.length)),ni}(ze,$p(ze,G,b,s,f,ge,Me));var ii=[],Jn={positionedLines:ii,text:ze.toString(),top:$[1],bottom:$[1],left:$[0],right:$[0],writingMode:ee,iconsInText:!1,verticalizable:!1};return function(mn,ai,ni,xi,An,si,Xi,ho,fo,go,Io,lr){for(var cr=0,ea=-17,_r=0,ta=0,_o="right"===ho?1:"left"===ho?0:.5,ur=0,di=0,Ki=An;di<Ki.length;di+=1){var Fi=Ki[di];Fi.trim();var Mi=Fi.getMaxScale(),va=24*(Mi-1),mr={positionedGlyphs:[],lineOffset:0};mn.positionedLines[ur]=mr;var so=mr.positionedGlyphs,To=0;if(Fi.length()){for(var Rr=0;Rr<Fi.length();Rr++){var Ei=Fi.getSection(Rr),Jl=Fi.getSectionIndex(Rr),Wa=Fi.getCharCode(Rr),jl=0,Zo=null,_s=null,La=null,Bl=24,_c=!(fo===Ka.horizontal||!Io&&!vu(Wa)||Io&&(Vc[Wa]||(nn=Wa,Ht.Arabic(nn)||Ht["Arabic Supplement"](nn)||Ht["Arabic Extended-A"](nn)||Ht["Arabic Presentation Forms-A"](nn)||Ht["Arabic Presentation Forms-B"](nn))));if(Ei.imageName){var Is=xi[Ei.imageName];if(!Is)continue;La=Ei.imageName,mn.iconsInText=mn.iconsInText||!0,_s=Is.paddedRect;var xl=Is.displaySize;Ei.scale=24*Ei.scale/lr,jl=va+(24-xl[1]*Ei.scale),Bl=(Zo={width:xl[0],height:xl[1],left:1,top:-3,advance:_c?xl[1]:xl[0]}).advance;var Cp=_c?xl[0]*Ei.scale-24*Mi:xl[1]*Ei.scale-24*Mi;Cp>0&&Cp>To&&(To=Cp)}else{var hh=ni[Ei.fontStack],ms=hh&&hh[Wa];if(ms&&ms.rect)_s=ms.rect,Zo=ms.metrics;else{var Bu=ai[Ei.fontStack],Bt=Bu&&Bu[Wa];if(!Bt)continue;Zo=Bt.metrics}jl=24*(Mi-Ei.scale)}_c?(mn.verticalizable=!0,so.push({glyph:Wa,imageName:La,x:cr,y:ea+jl,vertical:_c,scale:Ei.scale,fontStack:Ei.fontStack,sectionIndex:Jl,metrics:Zo,rect:_s}),cr+=Bl*Ei.scale+go):(so.push({glyph:Wa,imageName:La,x:cr,y:ea+jl,vertical:_c,scale:Ei.scale,fontStack:Ei.fontStack,sectionIndex:Jl,metrics:Zo,rect:_s}),cr+=Zo.advance*Ei.scale+go)}0!==so.length&&(_r=Math.max(cr-go,_r),Q_(so,0,so.length-1,_o,To)),cr=0;var pt=si*Mi+To;mr.lineOffset=Math.max(To,va),ea+=pt,ta=Math.max(pt,ta),++ur}else ea+=si,++ur}var nn,Zi=ea- -17,Xa=oh(Xi),mc=Xa.horizontalAlign,Wc=Xa.verticalAlign;(function(ys,Uo,mo,wp,fh,yc,vc,vo,Xc){var bc,eu=(Uo-mo)*fh;bc=yc!==vc?-vo*wp- -17:(-wp*Xc+.5)*vc;for(var Gl=0,Vl=ys;Gl<Vl.length;Gl+=1)for(var il=0,Zs=Vl[Gl].positionedGlyphs;il<Zs.length;il+=1){var vs=Zs[il];vs.x+=eu,vs.y+=bc}})(mn.positionedLines,_o,mc,Wc,_r,ta,si,Zi,An.length),mn.top+=-Wc*Zi,mn.bottom=mn.top+Zi,mn.left+=-mc*_r,mn.right=mn.left+_r}(Jn,s,c,f,Fe,O,z,j,ee,G,se,Ae),!function(mn){for(var ai=0,ni=mn;ai<ni.length;ai+=1)if(0!==ni[ai].positionedGlyphs.length)return!1;return!0}(ii)&&Jn}Pr.fromFeature=function(r,s){for(var c=new Pr,f=0;f<r.sections.length;f++){var m=r.sections[f];m.image?c.addImageSection(m):c.addTextSection(m,s)}return c},Pr.prototype.length=function(){return this.text.length},Pr.prototype.getSection=function(r){return this.sections[this.sectionIndex[r]]},Pr.prototype.getSectionIndex=function(r){return this.sectionIndex[r]},Pr.prototype.getCharCode=function(r){return this.text.charCodeAt(r)},Pr.prototype.verticalizePunctuation=function(){this.text=function(r){for(var s="",c=0;c<r.length;c++){var f=r.charCodeAt(c+1)||null,m=r.charCodeAt(c-1)||null;s+=f&&bu(f)&&!_p[r[c+1]]||m&&bu(m)&&!_p[r[c-1]]||!_p[r[c]]?r[c]:_p[r[c]]}return s}(this.text)},Pr.prototype.trim=function(){for(var r=0,s=0;s<this.text.length&&Vc[this.text.charCodeAt(s)];s++)r++;for(var c=this.text.length,f=this.text.length-1;f>=0&&f>=r&&Vc[this.text.charCodeAt(f)];f--)c--;this.text=this.text.substring(r,c),this.sectionIndex=this.sectionIndex.slice(r,c)},Pr.prototype.substring=function(r,s){var c=new Pr;return c.text=this.text.substring(r,s),c.sectionIndex=this.sectionIndex.slice(r,s),c.sections=this.sections,c},Pr.prototype.toString=function(){return this.text},Pr.prototype.getMaxScale=function(){var r=this;return this.sectionIndex.reduce(function(s,c){return Math.max(s,r.sections[c].scale)},0)},Pr.prototype.addTextSection=function(r,s){this.text+=r.text,this.sections.push(zu.forText(r.scale,r.fontStack||s));for(var c=this.sections.length-1,f=0;f<r.text.length;++f)this.sectionIndex.push(c)},Pr.prototype.addImageSection=function(r){var s=r.image?r.image.name:"";if(0!==s.length){var c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(zu.forImage(s)),this.sectionIndex.push(this.sections.length-1)):ie("Reached maximum number of images 6401")}else ie("Can't add FormattedSection with an empty image.")},Pr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Vc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ar={};function ag(r,s,c,f,m,b){if(s.imageName){var O=f[s.imageName];return O?O.displaySize[0]*s.scale*24/b+m:0}var z=c[s.fontStack],j=z&&z[r];return j?j.metrics.advance*s.scale+m:0}function Y_(r,s,c,f){var m=Math.pow(r-s,2);return f?r<s?m/2:2*m:m+Math.abs(c)*c}function H_(r,s,c){var f=0;return 10===r&&(f-=1e4),c&&(f+=150),40!==r&&65288!==r||(f+=50),41!==s&&65289!==s||(f+=50),f}function ih(r,s,c,f,m,b){for(var O=null,z=Y_(s,c,m,b),j=0,G=f;j<G.length;j+=1){var $=G[j],ee=Y_(s-$.x,c,m,b)+$.badness;ee<=z&&(O=$,z=ee)}return{index:r,x:s,priorBreak:O,badness:z}}function $p(r,s,c,f,m,b,O){if("point"!==b)return[];if(!r)return[];for(var z,j=[],G=function(Fe,ze,Ve,nt,lt,gt){for(var wt=0,zt=0;zt<Fe.length();zt++){var jt=Fe.getSection(zt);wt+=ag(Fe.getCharCode(zt),jt,nt,lt,ze,gt)}return wt/Math.max(1,Math.ceil(wt/Ve))}(r,s,c,f,m,O),$=r.text.indexOf("\u200b")>=0,ee=0,se=0;se<r.length();se++){var ge=r.getSection(se),Me=r.getCharCode(se);if(Vc[Me]||(ee+=ag(Me,ge,f,m,s,O)),se<r.length()-1){var Ae=!((z=Me)<11904||!(Ht["Bopomofo Extended"](z)||Ht.Bopomofo(z)||Ht["CJK Compatibility Forms"](z)||Ht["CJK Compatibility Ideographs"](z)||Ht["CJK Compatibility"](z)||Ht["CJK Radicals Supplement"](z)||Ht["CJK Strokes"](z)||Ht["CJK Symbols and Punctuation"](z)||Ht["CJK Unified Ideographs Extension A"](z)||Ht["CJK Unified Ideographs"](z)||Ht["Enclosed CJK Letters and Months"](z)||Ht["Halfwidth and Fullwidth Forms"](z)||Ht.Hiragana(z)||Ht["Ideographic Description Characters"](z)||Ht["Kangxi Radicals"](z)||Ht["Katakana Phonetic Extensions"](z)||Ht.Katakana(z)||Ht["Vertical Forms"](z)||Ht["Yi Radicals"](z)||Ht["Yi Syllables"](z)));(ar[Me]||Ae||ge.imageName)&&j.push(ih(se+1,ee,G,j,H_(Me,r.getCharCode(se+1),Ae&&$),!1))}}return function Fe(ze){return ze?Fe(ze.priorBreak).concat(ze.index):[]}(ih(r.length(),ee,G,j,0,!0))}function oh(r){var s=.5,c=.5;switch(r){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function Q_(r,s,c,f,m){if(f||m)for(var b=r[c],O=(r[c].x+b.metrics.advance*b.scale)*f,z=s;z<=c;z++)r[z].x-=O,r[z].y+=m}function sg(r,s,c,f,m,b){var O,z=r.image;if(z.content){var j=z.content,G=z.pixelRatio||1;O=[j[0]/G,j[1]/G,z.displaySize[0]-j[2]/G,z.displaySize[1]-j[3]/G]}var $,ee,se,ge,Me=s.left*b,Ae=s.right*b;"width"===c||"both"===c?(ge=m[0]+Me-f[3],ee=m[0]+Ae+f[1]):ee=(ge=m[0]+(Me+Ae-z.displaySize[0])/2)+z.displaySize[0];var Fe=s.top*b,ze=s.bottom*b;return"height"===c||"both"===c?($=m[1]+Fe-f[0],se=m[1]+ze+f[2]):se=($=m[1]+(Fe+ze-z.displaySize[1])/2)+z.displaySize[1],{image:z,top:$,right:ee,bottom:se,left:ge,collisionPadding:O}}ar[10]=!0,ar[32]=!0,ar[38]=!0,ar[40]=!0,ar[41]=!0,ar[43]=!0,ar[45]=!0,ar[47]=!0,ar[173]=!0,ar[183]=!0,ar[8203]=!0,ar[8208]=!0,ar[8211]=!0,ar[8231]=!0;var Du=function(r){function s(c,f,m,b){r.call(this,c,f),this.angle=m,void 0!==b&&(this.segment=b)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.clone=function(){return new s(this.x,this.y,this.angle,this.segment)},s}(S);function Wp(r,s){var c=s.expression;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new oi(r+1))};if("source"===c.kind)return{kind:"source"};for(var f=c.zoomStops,m=c.interpolationType,b=0;b<f.length&&f[b]<=r;)b++;for(var O=b=Math.max(0,b-1);O<f.length&&f[O]<r+1;)O++;O=Math.min(f.length-1,O);var z=f[b],j=f[O];return"composite"===c.kind?{kind:"composite",minZoom:z,maxZoom:j,interpolationType:m}:{kind:"camera",minZoom:z,maxZoom:j,minSize:c.evaluate(new oi(z)),maxSize:c.evaluate(new oi(j)),interpolationType:m}}function rh(r,s,c){var f=s.uSize,m=c.lowerSize;return"source"===r.kind?m/128:"composite"===r.kind?co(m/128,c.upperSize/128,s.uSizeT):f}function lg(r,s){var c=0,f=0;if("constant"===r.kind)f=r.layoutSize;else if("source"!==r.kind){var m=r.interpolationType,b=m?U(Lo.interpolationFactor(m,s,r.minZoom,r.maxZoom),0,1):0;"camera"===r.kind?f=co(r.minSize,r.maxSize,b):c=b}return{uSizeT:c,uSize:f}}cn("Anchor",Du);var K_=Object.freeze({__proto__:null,getSizeData:Wp,evaluateSizeForFeature:rh,evaluateSizeForZoom:lg,SIZE_PACK_FACTOR:128});function cg(r,s,c,f,m){if(void 0===s.segment)return!0;for(var b=s,O=s.segment+1,z=0;z>-c/2;){if(--O<0)return!1;z-=r[O].dist(b),b=r[O]}z+=r[O].dist(r[O+1]),O++;for(var j=[],G=0;z<c/2;){var $=r[O],ee=r[O+1];if(!ee)return!1;var se=r[O-1].angleTo($)-$.angleTo(ee);for(se=Math.abs((se+3*Math.PI)%(2*Math.PI)-Math.PI),j.push({distance:z,angleDelta:se}),G+=se;z-j[0].distance>f;)G-=j.shift().angleDelta;if(G>m)return!1;O++,z+=$.dist(ee)}return!0}function ug(r){for(var s=0,c=0;c<r.length-1;c++)s+=r[c].dist(r[c+1]);return s}function pg(r,s,c){return r?.6*s*c:0}function dg(r,s){return Math.max(r?r.right-r.left:0,s?s.right-s.left:0)}function $_(r,s,c,f,m,b){for(var O=pg(c,m,b),z=dg(c,f)*b,j=0,G=ug(r)/2,$=0;$<r.length-1;$++){var ee=r[$],se=r[$+1],ge=ee.dist(se);if(j+ge>G){var Me=(G-j)/ge,Ae=co(ee.x,se.x,Me),Fe=co(ee.y,se.y,Me),ze=new Du(Ae,Fe,se.angleTo(ee),$);return ze._round(),!O||cg(r,ze,z,O,s)?ze:void 0}j+=ge}}function W_(r,s,c,f,m,b,O,z,j){var G=pg(f,b,O),$=dg(f,m),ee=$*O,se=0===r[0].x||r[0].x===j||0===r[0].y||r[0].y===j;return s-ee<s/4&&(s=ee+s/4),function ge(Me,Ae,Fe,ze,Ve,nt,lt,gt,wt){for(var zt=nt/2,jt=ug(Me),vn=0,on=Ae-Fe,On=[],rn=0;rn<Me.length-1;rn++){for(var ii=Me[rn],Jn=Me[rn+1],mn=ii.dist(Jn),ai=Jn.angleTo(ii);on+Fe<vn+mn;){var ni=((on+=Fe)-vn)/mn,xi=co(ii.x,Jn.x,ni),An=co(ii.y,Jn.y,ni);if(xi>=0&&xi<wt&&An>=0&&An<wt&&on-zt>=0&&on+zt<=jt){var si=new Du(xi,An,ai,rn);si._round(),ze&&!cg(Me,si,nt,ze,Ve)||On.push(si)}}vn+=mn}return gt||On.length||lt||(On=ge(Me,vn/2,Fe,ze,Ve,nt,lt,!0,wt)),On}(r,se?s/2*z%s:($/2+2*b)*O*z%s,s,G,c,ee,se,!1,j)}function hg(r,s,c,f,m){for(var b=[],O=0;O<r.length;O++)for(var z=r[O],j=void 0,G=0;G<z.length-1;G++){var $=z[G],ee=z[G+1];$.x<s&&ee.x<s||($.x<s?$=new S(s,$.y+(s-$.x)/(ee.x-$.x)*(ee.y-$.y))._round():ee.x<s&&(ee=new S(s,$.y+(s-$.x)/(ee.x-$.x)*(ee.y-$.y))._round()),$.y<c&&ee.y<c||($.y<c?$=new S($.x+(c-$.y)/(ee.y-$.y)*(ee.x-$.x),c)._round():ee.y<c&&(ee=new S($.x+(c-$.y)/(ee.y-$.y)*(ee.x-$.x),c)._round()),$.x>=f&&ee.x>=f||($.x>=f?$=new S(f,$.y+(f-$.x)/(ee.x-$.x)*(ee.y-$.y))._round():ee.x>=f&&(ee=new S(f,$.y+(f-$.x)/(ee.x-$.x)*(ee.y-$.y))._round()),$.y>=m&&ee.y>=m||($.y>=m?$=new S($.x+(m-$.y)/(ee.y-$.y)*(ee.x-$.x),m)._round():ee.y>=m&&(ee=new S($.x+(m-$.y)/(ee.y-$.y)*(ee.x-$.x),m)._round()),j&&$.equals(j[j.length-1])||b.push(j=[$]),j.push(ee)))))}return b}function fg(r,s,c,f){var m=[],b=r.image,O=b.pixelRatio,z=b.paddedRect.w-2,j=b.paddedRect.h-2,G=r.right-r.left,$=r.bottom-r.top,ee=b.stretchX||[[0,z]],se=b.stretchY||[[0,j]],ge=function(xi,An){return xi+An[1]-An[0]},Me=ee.reduce(ge,0),Ae=se.reduce(ge,0),Fe=z-Me,ze=j-Ae,Ve=0,nt=Me,lt=0,gt=Ae,wt=0,zt=Fe,jt=0,vn=ze;if(b.content&&f){var on=b.content;Ve=Xp(ee,0,on[0]),lt=Xp(se,0,on[1]),nt=Xp(ee,on[0],on[2]),gt=Xp(se,on[1],on[3]),wt=on[0]-Ve,jt=on[1]-lt,zt=on[2]-on[0]-nt,vn=on[3]-on[1]-gt}var On=function(xi,An,si,Xi){var ho=ed(xi.stretch-Ve,nt,G,r.left),fo=td(xi.fixed-wt,zt,xi.stretch,Me),go=ed(An.stretch-lt,gt,$,r.top),Io=td(An.fixed-jt,vn,An.stretch,Ae),lr=ed(si.stretch-Ve,nt,G,r.left),cr=td(si.fixed-wt,zt,si.stretch,Me),ea=ed(Xi.stretch-lt,gt,$,r.top),_r=td(Xi.fixed-jt,vn,Xi.stretch,Ae),ta=new S(ho,go),_o=new S(lr,go),ur=new S(lr,ea),di=new S(ho,ea),Ki=new S(fo/O,Io/O),Fi=new S(cr/O,_r/O),Mi=s*Math.PI/180;if(Mi){var va=Math.sin(Mi),mr=Math.cos(Mi),so=[mr,-va,va,mr];ta._matMult(so),_o._matMult(so),di._matMult(so),ur._matMult(so)}var To=xi.stretch+xi.fixed,Rr=An.stretch+An.fixed;return{tl:ta,tr:_o,bl:di,br:ur,tex:{x:b.paddedRect.x+1+To,y:b.paddedRect.y+1+Rr,w:si.stretch+si.fixed-To,h:Xi.stretch+Xi.fixed-Rr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ki,pixelOffsetBR:Fi,minFontScaleX:zt/O/G,minFontScaleY:vn/O/$,isSDF:c}};if(f&&(b.stretchX||b.stretchY))for(var rn=gg(ee,Fe,Me),ii=gg(se,ze,Ae),Jn=0;Jn<rn.length-1;Jn++)for(var mn=rn[Jn],ai=rn[Jn+1],ni=0;ni<ii.length-1;ni++)m.push(On(mn,ii[ni],ai,ii[ni+1]));else m.push(On({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:z+1},{fixed:0,stretch:j+1}));return m}function Xp(r,s,c){for(var f=0,m=0,b=r;m<b.length;m+=1){var O=b[m];f+=Math.max(s,Math.min(c,O[1]))-Math.max(s,Math.min(c,O[0]))}return f}function gg(r,s,c){for(var f=[{fixed:-1,stretch:0}],m=0,b=r;m<b.length;m+=1){var O=b[m],z=O[0],j=O[1],G=f[f.length-1];f.push({fixed:z-G.stretch,stretch:G.stretch}),f.push({fixed:z-G.stretch,stretch:G.stretch+(j-z)})}return f.push({fixed:s+1,stretch:c}),f}function ed(r,s,c,f){return r/s*c+f}function td(r,s,c,f){return r-s*c/f}var gc=function(r,s,c,f,m,b,O,z,j,G){if(this.boxStartIndex=r.length,j){var $=b.top,ee=b.bottom,se=b.collisionPadding;se&&($-=se[1],ee+=se[3]);var ge=ee-$;ge>0&&(ge=Math.max(10,ge),this.circleDiameter=ge)}else{var Me=b.top*O-z,Ae=b.bottom*O+z,Fe=b.left*O-z,ze=b.right*O+z,Ve=b.collisionPadding;if(Ve&&(Fe-=Ve[0]*O,Me-=Ve[1]*O,ze+=Ve[2]*O,Ae+=Ve[3]*O),G){var nt=new S(Fe,Me),lt=new S(ze,Me),gt=new S(Fe,Ae),wt=new S(ze,Ae),zt=G*Math.PI/180;nt._rotate(zt),lt._rotate(zt),gt._rotate(zt),wt._rotate(zt),Fe=Math.min(nt.x,lt.x,gt.x,wt.x),ze=Math.max(nt.x,lt.x,gt.x,wt.x),Me=Math.min(nt.y,lt.y,gt.y,wt.y),Ae=Math.max(nt.y,lt.y,gt.y,wt.y)}r.emplaceBack(s.x,s.y,Fe,Me,ze,Ae,c,f,m)}this.boxEndIndex=r.length},Ru=function(r,s){if(void 0===r&&(r=[]),void 0===s&&(s=X_),this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function X_(r,s){return r<s?-1:r>s?1:0}function em(r,s,c){void 0===s&&(s=1),void 0===c&&(c=!1);for(var f=1/0,m=1/0,b=-1/0,O=-1/0,z=r[0],j=0;j<z.length;j++){var G=z[j];(!j||G.x<f)&&(f=G.x),(!j||G.y<m)&&(m=G.y),(!j||G.x>b)&&(b=G.x),(!j||G.y>O)&&(O=G.y)}var $=Math.min(b-f,O-m),ee=$/2,se=new Ru([],tm);if(0===$)return new S(f,m);for(var ge=f;ge<b;ge+=$)for(var Me=m;Me<O;Me+=$)se.push(new Fu(ge+ee,Me+ee,ee,r));for(var Ae=function(Ve){for(var nt=0,lt=0,gt=0,wt=Ve[0],zt=0,jt=wt.length,vn=jt-1;zt<jt;vn=zt++){var on=wt[zt],On=wt[vn],rn=on.x*On.y-On.x*on.y;lt+=(on.x+On.x)*rn,gt+=(on.y+On.y)*rn,nt+=3*rn}return new Fu(lt/nt,gt/nt,0,Ve)}(r),Fe=se.length;se.length;){var ze=se.pop();(ze.d>Ae.d||!Ae.d)&&(Ae=ze,c&&console.log("found best %d after %d probes",Math.round(1e4*ze.d)/1e4,Fe)),ze.max-Ae.d<=s||(se.push(new Fu(ze.p.x-(ee=ze.h/2),ze.p.y-ee,ee,r)),se.push(new Fu(ze.p.x+ee,ze.p.y-ee,ee,r)),se.push(new Fu(ze.p.x-ee,ze.p.y+ee,ee,r)),se.push(new Fu(ze.p.x+ee,ze.p.y+ee,ee,r)),Fe+=4)}return c&&(console.log("num probes: "+Fe),console.log("best distance: "+Ae.d)),Ae.p}function tm(r,s){return s.max-r.max}function Fu(r,s,c,f){this.p=new S(r,s),this.h=c,this.d=function(m,b){for(var O=!1,z=1/0,j=0;j<b.length;j++)for(var G=b[j],$=0,ee=G.length,se=ee-1;$<ee;se=$++){var ge=G[$],Me=G[se];ge.y>m.y!=Me.y>m.y&&m.x<(Me.x-ge.x)*(m.y-ge.y)/(Me.y-ge.y)+ge.x&&(O=!O),z=Math.min(z,yl(m,ge,Me))}return(O?1:-1)*Math.sqrt(z)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}Ru.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},Ru.prototype.pop=function(){if(0!==this.length){var r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}},Ru.prototype.peek=function(){return this.data[0]},Ru.prototype._up=function(r){for(var s=this.data,c=this.compare,f=s[r];r>0;){var m=r-1>>1,b=s[m];if(c(f,b)>=0)break;s[r]=b,r=m}s[r]=f},Ru.prototype._down=function(r){for(var s=this.data,c=this.compare,f=this.length>>1,m=s[r];r<f;){var b=1+(r<<1),O=s[b],z=b+1;if(z<this.length&&c(s[z],O)<0&&(b=z,O=s[z]),c(O,m)>=0)break;s[r]=O,r=b}s[r]=m};var ah=Number.POSITIVE_INFINITY;function _g(r,s){return s[1]!==ah?function(c,f,m){var b=0,O=0;switch(f=Math.abs(f),m=Math.abs(m),c){case"top-right":case"top-left":case"top":O=m-7;break;case"bottom-right":case"bottom-left":case"bottom":O=7-m}switch(c){case"top-right":case"bottom-right":case"right":b=-f;break;case"top-left":case"bottom-left":case"left":b=f}return[b,O]}(r,s[0],s[1]):function(c,f){var m=0,b=0;f<0&&(f=0);var O=f/Math.sqrt(2);switch(c){case"top-right":case"top-left":b=O-7;break;case"bottom-right":case"bottom-left":b=7-O;break;case"bottom":b=7-f;break;case"top":b=f-7}switch(c){case"top-right":case"bottom-right":m=-O;break;case"top-left":case"bottom-left":m=O;break;case"left":m=f;break;case"right":m=-f}return[m,b]}(r,s[0])}function sh(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function mg(r,s,c,f,m,b,O,z,j,G,$,ee,se,ge,Me){var Ae=function(lt,gt,wt,zt,jt,vn,on,On){for(var rn=zt.layout.get("text-rotate").evaluate(vn,{})*Math.PI/180,ii=[],Jn=0,mn=gt.positionedLines;Jn<mn.length;Jn+=1)for(var ai=mn[Jn],ni=0,xi=ai.positionedGlyphs;ni<xi.length;ni+=1){var An=xi[ni];if(An.rect){var si=An.rect||{},Xi=4,ho=!0,fo=1,go=0,Io=(jt||On)&&An.vertical,lr=An.metrics.advance*An.scale/2;if(On&&gt.verticalizable&&(go=ai.lineOffset/2-(An.imageName?-(24-An.metrics.width*An.scale)/2:24*(An.scale-1))),An.imageName){var cr=on[An.imageName];ho=cr.sdf,Xi=1/(fo=cr.pixelRatio)}var ea=jt?[An.x+lr,An.y]:[0,0],_r=jt?[0,0]:[An.x+lr+wt[0],An.y+wt[1]-go],ta=[0,0];Io&&(ta=_r,_r=[0,0]);var _o=(An.metrics.left-Xi)*An.scale-lr+_r[0],ur=(-An.metrics.top-Xi)*An.scale+_r[1],di=_o+si.w*An.scale/fo,Ki=ur+si.h*An.scale/fo,Fi=new S(_o,ur),Mi=new S(di,ur),va=new S(_o,Ki),mr=new S(di,Ki);if(Io){var so=new S(-lr,lr- -17),To=-Math.PI/2,Rr=12-lr,Ei=new S(22-Rr,-(An.imageName?Rr:0)),Jl=new(Function.prototype.bind.apply(S,[null].concat(ta)));Fi._rotateAround(To,so)._add(Ei)._add(Jl),Mi._rotateAround(To,so)._add(Ei)._add(Jl),va._rotateAround(To,so)._add(Ei)._add(Jl),mr._rotateAround(To,so)._add(Ei)._add(Jl)}if(rn){var Wa=Math.sin(rn),jl=Math.cos(rn),Zo=[jl,-Wa,Wa,jl];Fi._matMult(Zo),Mi._matMult(Zo),va._matMult(Zo),mr._matMult(Zo)}var _s=new S(0,0),La=new S(0,0);ii.push({tl:Fi,tr:Mi,bl:va,br:mr,tex:si,writingMode:gt.writingMode,glyphOffset:ea,sectionIndex:An.sectionIndex,isSDF:ho,pixelOffsetTL:_s,pixelOffsetBR:La,minFontScaleX:0,minFontScaleY:0})}}return ii}(0,c,z,m,b,O,f,r.allowVerticalPlacement),Fe=r.textSizeData,ze=null;"source"===Fe.kind?(ze=[128*m.layout.get("text-size").evaluate(O,{})])[0]>32640&&ie(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Fe.kind&&((ze=[128*ge.compositeTextSizes[0].evaluate(O,{},Me),128*ge.compositeTextSizes[1].evaluate(O,{},Me)])[0]>32640||ze[1]>32640)&&ie(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),r.addSymbols(r.text,Ae,ze,z,b,O,G,s,j.lineStartIndex,j.lineLength,se,Me);for(var Ve=0,nt=$;Ve<nt.length;Ve+=1)ee[nt[Ve]]=r.text.placedSymbolArray.length-1;return 4*Ae.length}function yg(r){for(var s in r)return r[s];return null}function nm(r,s,c,f){var m=r.compareText;if(s in m){for(var b=m[s],O=b.length-1;O>=0;O--)if(f.dist(b[O])<c)return!0}else m[s]=[];return m[s].push(f),!1}var im=Nu.VectorTileFeature.types,om=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nd(r,s,c,f,m,b,O,z,j,G,$,ee,se){var ge=z?Math.min(32640,Math.round(z[0])):0,Me=z?Math.min(32640,Math.round(z[1])):0;r.emplaceBack(s,c,Math.round(32*f),Math.round(32*m),b,O,(ge<<1)+(j?1:0),Me,16*G,16*$,256*ee,256*se)}function lh(r,s,c){r.emplaceBack(s.x,s.y,c),r.emplaceBack(s.x,s.y,c),r.emplaceBack(s.x,s.y,c),r.emplaceBack(s.x,s.y,c)}function rm(r){for(var s=0,c=r.sections;s<c.length;s+=1)if(ap(c[s].text))return!0;return!1}var Yc=function(r){this.layoutVertexArray=new uc,this.indexArray=new fl,this.programConfigurations=r,this.segments=new ve,this.dynamicLayoutVertexArray=new Ks,this.opacityVertexArray=new hl,this.placedSymbolArray=new g};Yc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Yc.prototype.upload=function(r,s,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,fc.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,D_.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,om,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(r))},Yc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},cn("SymbolBuffers",Yc);var gs=function(r,s,c){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new c,this.segments=new ve,this.collisionVertexArray=new cp};gs.prototype.upload=function(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,Sr.members,!0)},gs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},cn("CollisionBuffers",gs);var Pi=function(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(b){return b.id}),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Na([]),this.placementViewportMatrix=Na([]);var s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Wp(this.zoom,s["text-size"]),this.iconSizeData=Wp(this.zoom,s["icon-size"]);var c=this.layers[0].layout,f=c.get("symbol-sort-key"),m=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==m&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===m||"auto"===m&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===c.get("symbol-placement")&&(this.writingModes=c.get("text-writing-mode").map(function(b){return Ka[b]})),this.stateDependentLayerIds=this.layers.filter(function(b){return b.isStateDependent()}).map(function(b){return b.id}),this.sourceID=r.sourceID};Pi.prototype.createArrays=function(){this.text=new Yc(new bn(this.layers,this.zoom,function(r){return/^text/.test(r)})),this.icon=new Yc(new bn(this.layers,this.zoom,function(r){return/^icon/.test(r)})),this.glyphOffsetArray=new L,this.lineVertexArray=new J,this.symbolInstances=new k},Pi.prototype.calculateGlyphDependencies=function(r,s,c,f,m){for(var b=0;b<r.length;b++)if(s[r.charCodeAt(b)]=!0,(c||f)&&m){var O=_p[r.charAt(b)];O&&(s[O.charCodeAt(0)]=!0)}},Pi.prototype.populate=function(r,s,c){var f=this.layers[0],m=f.layout,b=m.get("text-font"),O=m.get("text-field"),z=m.get("icon-image"),j=("constant"!==O.value.kind||O.value.value instanceof Yi&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),G="constant"!==z.value.kind||!!z.value.value||Object.keys(z.parameters).length>0,$=m.get("symbol-sort-key");if(this.features=[],j||G){for(var ee=s.iconDependencies,se=s.glyphDependencies,ge=s.availableImages,Me=new oi(this.zoom),Ae=0,Fe=r;Ae<Fe.length;Ae+=1){var ze=Fe[Ae],Ve=ze.feature,nt=ze.id,lt=ze.index,gt=ze.sourceLayerIndex,wt=f._featureFilter.needGeometry,zt=wo(Ve,wt);if(f._featureFilter.filter(Me,zt,c)){wt||(zt.geometry=po(Ve));var jt=void 0;if(j){var vn=f.getValueAndResolveTokens("text-field",zt,c,ge),on=Yi.factory(vn);rm(on)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===xu()||this.hasRTLText&&fr.isParsed())&&(jt=Xf(on,f,zt))}var On=void 0;if(G){var rn=f.getValueAndResolveTokens("icon-image",zt,c,ge);On=rn instanceof Ko?rn:Ko.fromString(rn)}if(jt||On){var ii=this.sortFeaturesByKey?$.evaluate(zt,{},c):void 0;if(this.features.push({id:nt,text:jt,icon:On,index:lt,sourceLayerIndex:gt,geometry:zt.geometry,properties:Ve.properties,type:im[Ve.type],sortKey:ii}),On&&(ee[On.name]=!0),jt){var Jn=b.evaluate(zt,{},c).join(","),mn="map"===m.get("text-rotation-alignment")&&"point"!==m.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ka.vertical)>=0;for(var ai=0,ni=jt.sections;ai<ni.length;ai+=1){var xi=ni[ai];if(xi.image)ee[xi.image.name]=!0;else{var An=rp(jt.toString()),si=xi.fontStack||Jn,Xi=se[si]=se[si]||{};this.calculateGlyphDependencies(xi.text,Xi,mn,this.allowVerticalPlacement,An)}}}}}}"line"===m.get("symbol-placement")&&(this.features=function(ho){var fo={},go={},Io=[],lr=0;function cr(so){Io.push(ho[so]),lr++}function ea(so,To,Rr){var Ei=go[so];return delete go[so],go[To]=Ei,Io[Ei].geometry[0].pop(),Io[Ei].geometry[0]=Io[Ei].geometry[0].concat(Rr[0]),Ei}function _r(so,To,Rr){var Ei=fo[To];return delete fo[To],fo[so]=Ei,Io[Ei].geometry[0].shift(),Io[Ei].geometry[0]=Rr[0].concat(Io[Ei].geometry[0]),Ei}function ta(so,To,Rr){var Ei=Rr?To[0][To[0].length-1]:To[0][0];return so+":"+Ei.x+":"+Ei.y}for(var _o=0;_o<ho.length;_o++){var ur=ho[_o],di=ur.geometry,Ki=ur.text?ur.text.toString():null;if(Ki){var Fi=ta(Ki,di),Mi=ta(Ki,di,!0);if(Fi in go&&Mi in fo&&go[Fi]!==fo[Mi]){var va=_r(Fi,Mi,di),mr=ea(Fi,Mi,Io[va].geometry);delete fo[Fi],delete go[Mi],go[ta(Ki,Io[mr].geometry,!0)]=mr,Io[va].geometry=null}else Fi in go?ea(Fi,Mi,di):Mi in fo?_r(Fi,Mi,di):(cr(_o),fo[Fi]=lr-1,go[Mi]=lr-1)}else cr(_o)}return Io.filter(function(so){return so.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ho,fo){return ho.sortKey-fo.sortKey})}},Pi.prototype.update=function(r,s,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,c),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,c))},Pi.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Pi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Pi.prototype.upload=function(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Pi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Pi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Pi.prototype.addToLineVertexArray=function(r,s){var c=this.lineVertexArray.length;if(void 0!==r.segment){for(var f=r.dist(s[r.segment+1]),m=r.dist(s[r.segment]),b={},O=r.segment+1;O<s.length;O++)b[O]={x:s[O].x,y:s[O].y,tileUnitDistanceFromAnchor:f},O<s.length-1&&(f+=s[O+1].dist(s[O]));for(var z=r.segment||0;z>=0;z--)b[z]={x:s[z].x,y:s[z].y,tileUnitDistanceFromAnchor:m},z>0&&(m+=s[z-1].dist(s[z]));for(var j=0;j<s.length;j++){var G=b[j];this.lineVertexArray.emplaceBack(G.x,G.y,G.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}},Pi.prototype.addSymbols=function(r,s,c,f,m,b,O,z,j,G,$,ee){for(var se=r.indexArray,ge=r.layoutVertexArray,Me=r.segments.prepareSegment(4*s.length,ge,se,this.canOverlap?b.sortKey:void 0),Ae=this.glyphOffsetArray.length,Fe=Me.vertexLength,ze=this.allowVerticalPlacement&&O===Ka.vertical?Math.PI/2:0,Ve=b.text&&b.text.sections,nt=0;nt<s.length;nt++){var lt=s[nt],gt=lt.tl,wt=lt.tr,zt=lt.bl,jt=lt.br,vn=lt.tex,on=lt.pixelOffsetTL,On=lt.pixelOffsetBR,rn=lt.minFontScaleX,ii=lt.minFontScaleY,Jn=lt.glyphOffset,mn=lt.isSDF,ai=lt.sectionIndex,ni=Me.vertexLength,xi=Jn[1];nd(ge,z.x,z.y,gt.x,xi+gt.y,vn.x,vn.y,c,mn,on.x,on.y,rn,ii),nd(ge,z.x,z.y,wt.x,xi+wt.y,vn.x+vn.w,vn.y,c,mn,On.x,on.y,rn,ii),nd(ge,z.x,z.y,zt.x,xi+zt.y,vn.x,vn.y+vn.h,c,mn,on.x,On.y,rn,ii),nd(ge,z.x,z.y,jt.x,xi+jt.y,vn.x+vn.w,vn.y+vn.h,c,mn,On.x,On.y,rn,ii),lh(r.dynamicLayoutVertexArray,z,ze),se.emplaceBack(ni,ni+1,ni+2),se.emplaceBack(ni+1,ni+2,ni+3),Me.vertexLength+=4,Me.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Jn[0]),nt!==s.length-1&&ai===s[nt+1].sectionIndex||r.programConfigurations.populatePaintArrays(ge.length,b,b.index,{},ee,Ve&&Ve[ai])}r.placedSymbolArray.emplaceBack(z.x,z.y,Ae,this.glyphOffsetArray.length-Ae,Fe,j,G,z.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],O,0,!1,0,$)},Pi.prototype._addCollisionDebugVertex=function(r,s,c,f,m,b){return s.emplaceBack(0,0),r.emplaceBack(c.x,c.y,f,m,Math.round(b.x),Math.round(b.y))},Pi.prototype.addCollisionDebugVertices=function(r,s,c,f,m,b,O){var z=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),j=z.vertexLength,G=m.layoutVertexArray,$=m.collisionVertexArray,ee=O.anchorX,se=O.anchorY;this._addCollisionDebugVertex(G,$,b,ee,se,new S(r,s)),this._addCollisionDebugVertex(G,$,b,ee,se,new S(c,s)),this._addCollisionDebugVertex(G,$,b,ee,se,new S(c,f)),this._addCollisionDebugVertex(G,$,b,ee,se,new S(r,f)),z.vertexLength+=4;var ge=m.indexArray;ge.emplaceBack(j,j+1),ge.emplaceBack(j+1,j+2),ge.emplaceBack(j+2,j+3),ge.emplaceBack(j+3,j),z.primitiveLength+=4},Pi.prototype.addDebugCollisionBoxes=function(r,s,c,f){for(var m=r;m<s;m++){var b=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,f?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,c)}},Pi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gs($r,Fl.members,_l),this.iconCollisionBox=new gs($r,Fl.members,_l);for(var r=0;r<this.symbolInstances.length;r++){var s=this.symbolInstances.get(r);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}},Pi.prototype._deserializeCollisionBoxesForSymbol=function(r,s,c,f,m,b,O,z,j){for(var G={},$=s;$<c;$++){var ee=r.get($);G.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.textFeatureIndex=ee.featureIndex;break}for(var se=f;se<m;se++){var ge=r.get(se);G.verticalTextBox={x1:ge.x1,y1:ge.y1,x2:ge.x2,y2:ge.y2,anchorPointX:ge.anchorPointX,anchorPointY:ge.anchorPointY},G.verticalTextFeatureIndex=ge.featureIndex;break}for(var Me=b;Me<O;Me++){var Ae=r.get(Me);G.iconBox={x1:Ae.x1,y1:Ae.y1,x2:Ae.x2,y2:Ae.y2,anchorPointX:Ae.anchorPointX,anchorPointY:Ae.anchorPointY},G.iconFeatureIndex=Ae.featureIndex;break}for(var Fe=z;Fe<j;Fe++){var ze=r.get(Fe);G.verticalIconBox={x1:ze.x1,y1:ze.y1,x2:ze.x2,y2:ze.y2,anchorPointX:ze.anchorPointX,anchorPointY:ze.anchorPointY},G.verticalIconFeatureIndex=ze.featureIndex;break}return G},Pi.prototype.deserializeCollisionBoxes=function(r){this.collisionArrays=[];for(var s=0;s<this.symbolInstances.length;s++){var c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}},Pi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Pi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Pi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Pi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Pi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Pi.prototype.addIndicesForPlacedSymbol=function(r,s){for(var c=r.placedSymbolArray.get(s),f=c.vertexStartIndex+4*c.numGlyphs,m=c.vertexStartIndex;m<f;m+=4)r.indexArray.emplaceBack(m,m+1,m+2),r.indexArray.emplaceBack(m+1,m+2,m+3)},Pi.prototype.getSortedSymbolIndexes=function(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var s=Math.sin(r),c=Math.cos(r),f=[],m=[],b=[],O=0;O<this.symbolInstances.length;++O){b.push(O);var z=this.symbolInstances.get(O);f.push(0|Math.round(s*z.anchorX+c*z.anchorY)),m.push(z.featureIndex)}return b.sort(function(j,G){return f[j]-f[G]||m[G]-m[j]}),b},Pi.prototype.addToSortKeyRanges=function(r,s){var c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})},Pi.prototype.sortFeatures=function(r){var s=this;if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,f=this.symbolInstanceIndexes;c<f.length;c+=1){var m=this.symbolInstances.get(f[c]);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach(function(b,O,z){b>=0&&z.indexOf(b)===O&&s.addIndicesForPlacedSymbol(s.text,b)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},cn("SymbolBucket",Pi,{omit:["layers","collisionBoxArray","features","compareText"]}),Pi.MAX_GLYPHS=65535,Pi.addDynamicAttributes=lh;var Uu=new or({"symbol-placement":new Cn(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Cn(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Cn(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new un(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Cn(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Cn(ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Cn(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Cn(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Cn(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new un(ye.layout_symbol["icon-size"]),"icon-text-fit":new Cn(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Cn(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new un(ye.layout_symbol["icon-image"]),"icon-rotate":new un(ye.layout_symbol["icon-rotate"]),"icon-padding":new Cn(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Cn(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new un(ye.layout_symbol["icon-offset"]),"icon-anchor":new un(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Cn(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Cn(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Cn(ye.layout_symbol["text-rotation-alignment"]),"text-field":new un(ye.layout_symbol["text-field"]),"text-font":new un(ye.layout_symbol["text-font"]),"text-size":new un(ye.layout_symbol["text-size"]),"text-max-width":new un(ye.layout_symbol["text-max-width"]),"text-line-height":new Cn(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new un(ye.layout_symbol["text-letter-spacing"]),"text-justify":new un(ye.layout_symbol["text-justify"]),"text-radial-offset":new un(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Cn(ye.layout_symbol["text-variable-anchor"]),"text-anchor":new un(ye.layout_symbol["text-anchor"]),"text-max-angle":new Cn(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Cn(ye.layout_symbol["text-writing-mode"]),"text-rotate":new un(ye.layout_symbol["text-rotate"]),"text-padding":new Cn(ye.layout_symbol["text-padding"]),"text-keep-upright":new Cn(ye.layout_symbol["text-keep-upright"]),"text-transform":new un(ye.layout_symbol["text-transform"]),"text-offset":new un(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Cn(ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Cn(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Cn(ye.layout_symbol["text-optional"])}),ch={paint:new or({"icon-opacity":new un(ye.paint_symbol["icon-opacity"]),"icon-color":new un(ye.paint_symbol["icon-color"]),"icon-halo-color":new un(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new un(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new un(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Cn(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Cn(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new un(ye.paint_symbol["text-opacity"]),"text-color":new un(ye.paint_symbol["text-color"],{runtimeType:Yt,getOverride:function(r){return r.textColor},hasOverride:function(r){return!!r.textColor}}),"text-halo-color":new un(ye.paint_symbol["text-halo-color"]),"text-halo-width":new un(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new un(ye.paint_symbol["text-halo-blur"]),"text-translate":new Cn(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Cn(ye.paint_symbol["text-translate-anchor"])}),layout:Uu},qu=function(r){this.type=r.property.overrides?r.property.overrides.runtimeType:an,this.defaultValue=r};qu.prototype.evaluate=function(r){if(r.formattedSection){var s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default},qu.prototype.eachChild=function(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)},qu.prototype.outputDefined=function(){return!1},qu.prototype.serialize=function(){return null},cn("FormatSectionOverride",qu,{omit:["defaultValue"]});var vg=function(r){function s(c){r.call(this,c,ch)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.recalculate=function(c,f){if(r.prototype.recalculate.call(this,c,f),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var m=this.layout.get("text-writing-mode");if(m){for(var b=[],O=0,z=m;O<z.length;O+=1){var j=z[O];b.indexOf(j)<0&&b.push(j)}this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},s.prototype.getValueAndResolveTokens=function(c,f,m,b){var j,O=this.layout.get(c).evaluate(f,{},m,b),z=this._unevaluatedLayout._values[c];return z.isDataDriven()||ls(z.value)||!O?O:(j=f.properties,O.replace(/{([^{}]+)}/g,function($,ee){return ee in j?String(j[ee]):""}))},s.prototype.createBucket=function(c){return new Pi(c)},s.prototype.queryRadius=function(){return 0},s.prototype.queryIntersectsFeature=function(){return!1},s.prototype._setPaintOverrides=function(){for(var c=0,f=ch.paint.overridableProperties;c<f.length;c+=1){var m=f[c];if(s.hasPaintOverride(this.layout,m)){var b,O=this.paint.get(m),z=new qu(O),j=new js(z,O.property.specification);b="constant"===O.value.kind||"source"===O.value.kind?new Il("source",j):new Ke("composite",j,O.value.zoomStops,O.value._interpolationType),this.paint._values[m]=new ir(O.property,b,O.parameters)}}},s.prototype._handleOverridablePaintPropertyUpdate=function(c,f,m){return!(!this.layout||f.isDataDriven()||m.isDataDriven())&&s.hasPaintOverride(this.layout,c)},s.hasPaintOverride=function(c,f){var m=c.get("text-field"),b=ch.paint.properties[f],O=!1,z=function($){for(var ee=0,se=$;ee<se.length;ee+=1)if(b.overrides&&b.overrides.hasOverride(se[ee]))return void(O=!0)};if("constant"===m.value.kind&&m.value.value instanceof Yi)z(m.value.value.sections);else if("source"===m.value.kind){var j=function($){O||($ instanceof nr&&to($.value)===zi?z($.value.sections):$ instanceof Ma?z($.sections):$.eachChild(j))},G=m.value;G._styleExpression&&j(G._styleExpression.expression)}return O},s}(ds),am={paint:new or({"background-color":new Cn(ye.paint_background["background-color"]),"background-pattern":new Xo(ye.paint_background["background-pattern"]),"background-opacity":new Cn(ye.paint_background["background-opacity"])})},sm=function(r){function s(c){r.call(this,c,am)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s}(ds),lm={paint:new or({"raster-opacity":new Cn(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Cn(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Cn(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Cn(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Cn(ye.paint_raster["raster-saturation"]),"raster-contrast":new Cn(ye.paint_raster["raster-contrast"]),"raster-resampling":new Cn(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Cn(ye.paint_raster["raster-fade-duration"])})},Hc=function(r){function s(c){r.call(this,c,lm)}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s}(ds),cy=function(r){function s(c){r.call(this,c,{}),this.implementation=c}return r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s,s.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},s.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},s.prototype.recalculate=function(){},s.prototype.updateTransitions=function(){},s.prototype.hasTransition=function(){},s.prototype.serialize=function(){},s.prototype.onAdd=function(c){this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},s.prototype.onRemove=function(c){this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},s}(ds),cm={circle:Vd,heatmap:u_,hillshade:d_,fill:Gf,"fill-extrusion":ly,line:Wf,symbol:vg,background:sm,raster:Hc},bg=E.HTMLImageElement,xg=E.HTMLCanvasElement,um=E.HTMLVideoElement,uh=E.ImageData,id=E.ImageBitmap,ks=function(r,s,c,f){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(s,f)};ks.prototype.update=function(r,s,c){var f=r.width,m=r.height,b=!(this.size&&this.size[0]===f&&this.size[1]===m||c),O=this.context,z=O.gl;if(this.useMipmap=Boolean(s&&s.useMipmap),z.bindTexture(z.TEXTURE_2D,this.texture),O.pixelStoreUnpackFlipY.set(!1),O.pixelStoreUnpack.set(1),O.pixelStoreUnpackPremultiplyAlpha.set(this.format===z.RGBA&&(!s||!1!==s.premultiply)),b)this.size=[f,m],r instanceof bg||r instanceof xg||r instanceof um||r instanceof uh||id&&r instanceof id?z.texImage2D(z.TEXTURE_2D,0,this.format,this.format,z.UNSIGNED_BYTE,r):z.texImage2D(z.TEXTURE_2D,0,this.format,f,m,0,this.format,z.UNSIGNED_BYTE,r.data);else{var j=c||{x:0,y:0},G=j.x,$=j.y;r instanceof bg||r instanceof xg||r instanceof um||r instanceof uh||id&&r instanceof id?z.texSubImage2D(z.TEXTURE_2D,0,G,$,z.RGBA,z.UNSIGNED_BYTE,r):z.texSubImage2D(z.TEXTURE_2D,0,G,$,f,m,z.RGBA,z.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&z.generateMipmap(z.TEXTURE_2D)},ks.prototype.bind=function(r,s,c){var f=this.context.gl;f.bindTexture(f.TEXTURE_2D,this.texture),c!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=f.LINEAR),r!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,r),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,c||r),this.filter=r),s!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrap=s)},ks.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ks.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ph=function(r){var s=this;this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){s._triggered=!1,s._callback()})};ph.prototype.trigger=function(){var r=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){r._triggered=!1,r._callback()},0))},ph.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Qc=function(r,s,c){this.target=r,this.parent=s,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ke(["receive","process"],this),this.invoker=new ph(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=pe()?r:E};function Cg(r,s,c){var f=2*Math.PI*6378137/256/Math.pow(2,c);return[r*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}Qc.prototype.send=function(r,s,c,f,m){var b=this;void 0===m&&(m=!1);var O=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[O]=c);var z=we(this.globalScope)?void 0:[];return this.target.postMessage({id:O,type:r,hasCallback:!!c,targetMapId:f,mustQueue:m,sourceMapId:this.mapId,data:pa(s,z)},z),{cancel:function(){c&&delete b.callbacks[O],b.target.postMessage({id:O,type:"<cancel>",targetMapId:f,sourceMapId:b.mapId})}}},Qc.prototype.receive=function(r){var s=r.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if("<cancel>"===s.type){delete this.tasks[c];var f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f()}else pe()||s.mustQueue?(this.tasks[c]=s,this.taskQueue.push(c),this.invoker.trigger()):this.processTask(c,s)},Qc.prototype.process=function(){if(this.taskQueue.length){var r=this.taskQueue.shift(),s=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),s&&this.processTask(r,s)}},Qc.prototype.processTask=function(r,s){var c=this;if("<response>"===s.type){var f=this.callbacks[r];delete this.callbacks[r],f&&(s.error?f(Kr(s.error)):f(null,Kr(s.data)))}else{var m=!1,b=we(this.globalScope)?void 0:[],O=s.hasCallback?function($,ee){m=!0,delete c.cancelCallbacks[r],c.target.postMessage({id:r,type:"<response>",sourceMapId:c.mapId,error:$?pa($):null,data:pa(ee,b)},b)}:function($){m=!0},z=null,j=Kr(s.data);if(this.parent[s.type])z=this.parent[s.type](s.sourceMapId,j,O);else if(this.parent.getWorkerSource){var G=s.type.split(".");z=this.parent.getWorkerSource(s.sourceMapId,G[0],j.source)[G[1]](j,O)}else O(new Error("Could not find function "+s.type));!m&&z&&z.cancel&&(this.cancelCallbacks[r]=z.cancel)}},Qc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ro=function(r,s){r&&(s?this.setSouthWest(r).setNorthEast(s):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))};Ro.prototype.setNorthEast=function(r){return this._ne=r instanceof ao?new ao(r.lng,r.lat):ao.convert(r),this},Ro.prototype.setSouthWest=function(r){return this._sw=r instanceof ao?new ao(r.lng,r.lat):ao.convert(r),this},Ro.prototype.extend=function(r){var s,c,f=this._sw,m=this._ne;if(r instanceof ao)s=r,c=r;else{if(!(r instanceof Ro))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(Ro.convert(r)):this.extend(ao.convert(r)):this;if(c=r._ne,!(s=r._sw)||!c)return this}return f||m?(f.lng=Math.min(s.lng,f.lng),f.lat=Math.min(s.lat,f.lat),m.lng=Math.max(c.lng,m.lng),m.lat=Math.max(c.lat,m.lat)):(this._sw=new ao(s.lng,s.lat),this._ne=new ao(c.lng,c.lat)),this},Ro.prototype.getCenter=function(){return new ao((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ro.prototype.getSouthWest=function(){return this._sw},Ro.prototype.getNorthEast=function(){return this._ne},Ro.prototype.getNorthWest=function(){return new ao(this.getWest(),this.getNorth())},Ro.prototype.getSouthEast=function(){return new ao(this.getEast(),this.getSouth())},Ro.prototype.getWest=function(){return this._sw.lng},Ro.prototype.getSouth=function(){return this._sw.lat},Ro.prototype.getEast=function(){return this._ne.lng},Ro.prototype.getNorth=function(){return this._ne.lat},Ro.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ro.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ro.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ro.prototype.contains=function(r){var s=ao.convert(r),c=s.lng,f=s.lat,m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&m},Ro.convert=function(r){return!r||r instanceof Ro?r:new Ro(r)};var ao=function(r,s){if(isNaN(r)||isNaN(s))throw new Error("Invalid LngLat object: ("+r+", "+s+")");if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ao.prototype.wrap=function(){return new ao(Q(this.lng,-180,180),this.lat)},ao.prototype.toArray=function(){return[this.lng,this.lat]},ao.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ao.prototype.distanceTo=function(r){var s=Math.PI/180,c=this.lat*s,f=r.lat*s,m=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((r.lng-this.lng)*s);return 6371008.8*Math.acos(Math.min(m,1))},ao.prototype.toBounds=function(r){void 0===r&&(r=0);var s=360*r/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Ro(new ao(this.lng-c,this.lat-s),new ao(this.lng+c,this.lat+s))},ao.convert=function(r){if(r instanceof ao)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new ao(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new ao(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var wg=2*Math.PI*6371008.8;function Tg(r){return wg*Math.cos(r*Math.PI/180)}function Mg(r){return(180+r)/360}function Og(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function xp(r,s){return r/Tg(s)}function Sg(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}var Kc=function(r,s,c){void 0===c&&(c=0),this.x=+r,this.y=+s,this.z=+c};Kc.fromLngLat=function(r,s){void 0===s&&(s=0);var c=ao.convert(r);return new Kc(Mg(c.lng),Og(c.lat),xp(s,c.lat))},Kc.prototype.toLngLat=function(){return new ao(360*this.x-180,Sg(this.y))},Kc.prototype.toAltitude=function(){return this.z*Tg(Sg(this.y))},Kc.prototype.meterInMercatorCoordinateUnits=function(){return 1/wg*(r=Sg(this.y),1/Math.cos(r*Math.PI/180));var r};var Ju=function(r,s,c){this.z=r,this.x=s,this.y=c,this.key=ju(0,r,r,s,c)};Ju.prototype.equals=function(r){return this.z===r.z&&this.x===r.x&&this.y===r.y},Ju.prototype.url=function(r,s){var c,f,m,b,O,z=(f=this.y,m=this.z,b=Cg(256*(c=this.x),256*(f=Math.pow(2,m)-f-1),m),O=Cg(256*(c+1),256*(f+1),m),b[0]+","+b[1]+","+O[0]+","+O[1]),j=function(G,$,ee){for(var se,ge="",Me=G;Me>0;Me--)ge+=($&(se=1<<Me-1)?1:0)+(ee&se?2:0);return ge}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===s?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",j).replace("{bbox-epsg-3857}",z)},Ju.prototype.getTilePoint=function(r){var s=Math.pow(2,this.z);return new S(8192*(r.x*s-this.x),8192*(r.y*s-this.y))},Ju.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var dh=function(r,s){this.wrap=r,this.canonical=s,this.key=ju(r,s.z,s.z,s.x,s.y)},Qo=function(r,s,c,f,m){this.overscaledZ=r,this.wrap=s,this.canonical=new Ju(c,+f,+m),this.key=ju(s,r,c,f,m)};function ju(r,s,c,f,m){(r*=2)<0&&(r=-1*r-1);var b=1<<c;return(b*b*r+b*m+f).toString(36)+c.toString(36)+s.toString(36)}Qo.prototype.equals=function(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)},Qo.prototype.scaledTo=function(r){var s=this.canonical.z-r;return r>this.canonical.z?new Qo(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qo(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)},Qo.prototype.calculateScaledKey=function(r,s){var c=this.canonical.z-r;return r>this.canonical.z?ju(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y):ju(this.wrap*+s,r,r,this.canonical.x>>c,this.canonical.y>>c)},Qo.prototype.isChildOf=function(r){if(r.wrap!==this.wrap)return!1;var s=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s},Qo.prototype.children=function(r){if(this.overscaledZ>=r)return[new Qo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var s=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Qo(s,this.wrap,s,c,f),new Qo(s,this.wrap,s,c+1,f),new Qo(s,this.wrap,s,c,f+1),new Qo(s,this.wrap,s,c+1,f+1)]},Qo.prototype.isLessThan=function(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))},Qo.prototype.wrapped=function(){return new Qo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Qo.prototype.unwrapTo=function(r){return new Qo(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)},Qo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Qo.prototype.toUnwrapped=function(){return new dh(this.wrap,this.canonical)},Qo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Qo.prototype.getTilePoint=function(r){return this.canonical.getTilePoint(new Kc(r.x-this.wrap,r.y))},cn("CanonicalTileID",Ju),cn("OverscaledTileID",Qo,{omit:["posMatrix"]});var ql=function(r,s,c){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return ie('"'+c+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=s.height;var f=this.dim=s.height-2;this.data=new Uint32Array(s.data.buffer),this.encoding=c||"mapbox";for(var m=0;m<f;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(f,m)]=this.data[this._idx(f-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,f)]=this.data[this._idx(m,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};ql.prototype.get=function(r,s){var c=new Uint8Array(this.data.buffer),f=4*this._idx(r,s);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(c[f],c[f+1],c[f+2])},ql.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ql.prototype._idx=function(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)},ql.prototype._unpackMapbox=function(r,s,c){return(256*r*256+256*s+c)/10-1e4},ql.prototype._unpackTerrarium=function(r,s,c){return 256*r+s+c/256-32768},ql.prototype.getPixels=function(){return new ya({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ql.prototype.backfillBorder=function(r,s,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");var f=s*this.dim,m=s*this.dim+this.dim,b=c*this.dim,O=c*this.dim+this.dim;switch(s){case-1:f=m-1;break;case 1:m=f+1}switch(c){case-1:b=O-1;break;case 1:O=b+1}for(var z=-s*this.dim,j=-c*this.dim,G=b;G<O;G++)for(var $=f;$<m;$++)this.data[this._idx($,G)]=r.data[this._idx($+z,G+j)]},cn("DEMData",ql);var Er=function(r){this._stringToNumber={},this._numberToString=[];for(var s=0;s<r.length;s++){var c=r[s];this._stringToNumber[c]=s,this._numberToString[s]=c}};Er.prototype.encode=function(r){return this._stringToNumber[r]},Er.prototype.decode=function(r){return this._numberToString[r]};var Dr=function(r,s,c,f,m){this.type="Feature",this._vectorTileFeature=r,r._z=s,r._x=c,r._y=f,this.properties=r.properties,this.id=m},ko={geometry:{configurable:!0}};ko.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ko.geometry.set=function(r){this._geometry=r},Dr.prototype.toJSON=function(){var r={geometry:this.geometry};for(var s in this)"_geometry"!==s&&"_vectorTileFeature"!==s&&(r[s]=this[s]);return r},Object.defineProperties(Dr.prototype,ko);var $a=function(){this.state={},this.stateChanges={},this.deletedStates={}};$a.prototype.updateState=function(r,s,c){var f=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][f]=this.stateChanges[r][f]||{},W(this.stateChanges[r][f],c),null===this.deletedStates[r])for(var m in this.deletedStates[r]={},this.state[r])m!==f&&(this.deletedStates[r][m]=null);else if(this.deletedStates[r]&&null===this.deletedStates[r][f])for(var b in this.deletedStates[r][f]={},this.state[r][f])c[b]||(this.deletedStates[r][f][b]=null);else for(var O in c)this.deletedStates[r]&&this.deletedStates[r][f]&&null===this.deletedStates[r][f][O]&&delete this.deletedStates[r][f][O]},$a.prototype.removeFeatureState=function(r,s,c){if(null!==this.deletedStates[r]){var f=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&void 0!==s)null!==this.deletedStates[r][f]&&(this.deletedStates[r][f]=this.deletedStates[r][f]||{},this.deletedStates[r][f][c]=null);else if(void 0!==s)if(this.stateChanges[r]&&this.stateChanges[r][f])for(c in this.deletedStates[r][f]={},this.stateChanges[r][f])this.deletedStates[r][f][c]=null;else this.deletedStates[r][f]=null;else this.deletedStates[r]=null}},$a.prototype.getState=function(r,s){var c=String(s),f=W({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){var m=this.deletedStates[r][s];if(null===m)return{};for(var b in m)delete f[b]}return f},$a.prototype.initializeTileState=function(r,s){r.setFeatureState(this.state,s)},$a.prototype.coalesceChanges=function(r,s){var c={};for(var f in this.stateChanges){this.state[f]=this.state[f]||{};var m={};for(var b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),W(this.state[f][b],this.stateChanges[f][b]),m[b]=this.state[f][b];c[f]=m}for(var O in this.deletedStates){this.state[O]=this.state[O]||{};var z={};if(null===this.deletedStates[O])for(var j in this.state[O])z[j]={},this.state[O][j]={};else for(var G in this.deletedStates[O]){if(null===this.deletedStates[O][G])this.state[O][G]={};else for(var $=0,ee=Object.keys(this.deletedStates[O][G]);$<ee.length;$+=1)delete this.state[O][G][ee[$]];z[G]=this.state[O][G]}c[O]=c[O]||{},W(c[O],z)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(var se in r)r[se].setFeatureState(c,s)};var Fo=function(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Qr(8192,16,0),this.grid3D=new Qr(8192,16,0),this.featureIndexArray=new ne,this.promoteId=s};function $c(r,s,c,f,m){return Ue(r,function(b,O){var z=s instanceof Hs?s.get(O):null;return z&&z.evaluate?z.evaluate(c,f,m):z})}function bl(r){for(var s=1/0,c=1/0,f=-1/0,m=-1/0,b=0,O=r;b<O.length;b+=1){var z=O[b];s=Math.min(s,z.x),c=Math.min(c,z.y),f=Math.max(f,z.x),m=Math.max(m,z.y)}return{minX:s,minY:c,maxX:f,maxY:m}}function sr(r,s){return s-r}Fo.prototype.insert=function(r,s,c,f,m,b){var O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,m);for(var z=b?this.grid3D:this.grid,j=0;j<s.length;j++){for(var G=s[j],$=[1/0,1/0,-1/0,-1/0],ee=0;ee<G.length;ee++){var se=G[ee];$[0]=Math.min($[0],se.x),$[1]=Math.min($[1],se.y),$[2]=Math.max($[2],se.x),$[3]=Math.max($[3],se.y)}$[0]<8192&&$[1]<8192&&$[2]>=0&&$[3]>=0&&z.insert(O,$[0],$[1],$[2],$[3])}},Fo.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Nu.VectorTile(new Qp(this.rawTileData)).layers,this.sourceLayerCoder=new Er(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Fo.prototype.query=function(r,s,c,f){var m=this;this.loadVTLayers();for(var b=r.params||{},O=8192/r.tileSize/r.scale,z=Hr(b.filter),j=r.queryGeometry,G=r.queryPadding*O,$=bl(j),ee=this.grid.query($.minX-G,$.minY-G,$.maxX+G,$.maxY+G),se=bl(r.cameraQueryGeometry),Me=0,Ae=this.grid3D.query(se.minX-G,se.minY-G,se.maxX+G,se.maxY+G,function(lt,gt,wt,zt){return function(jt,vn,on,On,rn){for(var ii=0,Jn=jt;ii<Jn.length;ii+=1){var mn=Jn[ii];if(vn<=mn.x&&on<=mn.y&&On>=mn.x&&rn>=mn.y)return!0}var ai=[new S(vn,on),new S(vn,rn),new S(On,rn),new S(On,on)];if(jt.length>2)for(var ni=0,xi=ai;ni<xi.length;ni+=1)if(Es(jt,xi[ni]))return!0;for(var An=0;An<jt.length-1;An++)if(pc(jt[An],jt[An+1],ai))return!0;return!1}(r.cameraQueryGeometry,lt-G,gt-G,wt+G,zt+G)});Me<Ae.length;Me+=1)ee.push(Ae[Me]);ee.sort(sr);for(var Fe,ze={},Ve=function(lt){var gt=ee[lt];if(gt!==Fe){Fe=gt;var wt=m.featureIndexArray.get(gt),zt=null;m.loadMatchingFeature(ze,wt.bucketIndex,wt.sourceLayerIndex,wt.featureIndex,z,b.layers,b.availableImages,s,c,f,function(jt,vn,on){return zt||(zt=po(jt)),vn.queryIntersectsFeature(j,jt,on,zt,m.z,r.transform,O,r.pixelPosMatrix)})}},nt=0;nt<ee.length;nt++)Ve(nt);return ze},Fo.prototype.loadMatchingFeature=function(r,s,c,f,m,b,O,z,j,G,$){var ee=this.bucketLayerIDs[s];if(!b||function(jt,vn){for(var on=0;on<jt.length;on++)if(vn.indexOf(jt[on])>=0)return!0;return!1}(b,ee)){var se=this.sourceLayerCoder.decode(c),ge=this.vtLayers[se].feature(f);if(m.needGeometry){var Me=wo(ge,!0);if(!m.filter(new oi(this.tileID.overscaledZ),Me,this.tileID.canonical))return}else if(!m.filter(new oi(this.tileID.overscaledZ),ge))return;for(var Ae=this.getId(ge,se),Fe=0;Fe<ee.length;Fe++){var ze=ee[Fe];if(!(b&&b.indexOf(ze)<0)){var Ve=z[ze];if(Ve){var nt={};void 0!==Ae&&G&&(nt=G.getState(Ve.sourceLayer||"_geojsonTileLayer",Ae));var lt=W({},j[ze]);lt.paint=$c(lt.paint,Ve.paint,ge,nt,O),lt.layout=$c(lt.layout,Ve.layout,ge,nt,O);var gt=!$||$(ge,Ve,nt);if(gt){var wt=new Dr(ge,this.z,this.x,this.y,Ae);wt.layer=lt;var zt=r[ze];void 0===zt&&(zt=r[ze]=[]),zt.push({featureIndex:f,feature:wt,intersectionZ:gt})}}}}}},Fo.prototype.lookupSymbolFeatures=function(r,s,c,f,m,b,O,z){var j={};this.loadVTLayers();for(var G=Hr(m),$=0,ee=r;$<ee.length;$+=1)this.loadMatchingFeature(j,c,f,ee[$],G,b,O,z,s);return j},Fo.prototype.hasLayer=function(r){for(var s=0,c=this.bucketLayerIDs;s<c.length;s+=1)for(var f=0,m=c[s];f<m.length;f+=1)if(r===m[f])return!0;return!1},Fo.prototype.getId=function(r,s){var c=r.id;return this.promoteId&&"boolean"==typeof(c=r.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[s]])&&(c=Number(c)),c},cn("FeatureIndex",Fo,{omit:["rawTileData","sourceLayerCoder"]});var ot=function(r,s){this.tileID=r,this.uid=e(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ot.prototype.registerFadeDuration=function(r){var s=r+this.timeAdded;s<st.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)},ot.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},ot.prototype.loadVectorData=function(r,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){for(var f in r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(G,$){var ee={};if(!$)return ee;for(var se=function(){var Ae=Me[ge],Fe=Ae.layerIds.map(function(nt){return $.getLayer(nt)}).filter(Boolean);if(0!==Fe.length){Ae.layers=Fe,Ae.stateDependentLayerIds&&(Ae.stateDependentLayers=Ae.stateDependentLayerIds.map(function(nt){return Fe.filter(function(lt){return lt.id===nt})[0]}));for(var ze=0,Ve=Fe;ze<Ve.length;ze+=1)ee[Ve[ze].id]=Ae}},ge=0,Me=G;ge<Me.length;ge+=1)se();return ee}(r.buckets,s.style),this.hasSymbolBuckets=!1,this.buckets){var m=this.buckets[f];if(m instanceof Pi){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var b in this.buckets){var O=this.buckets[b];if(O instanceof Pi&&O.hasRTLText){this.hasRTLText=!0,fr.isLoading()||fr.isLoaded()||"deferred"!==xu()||ka();break}}for(var z in this.queryPadding=0,this.buckets){var j=this.buckets[z];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(z).queryRadius(j))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new h},ot.prototype.unloadVectorData=function(){for(var r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ot.prototype.getBucket=function(r){return this.buckets[r.id]},ot.prototype.upload=function(r){for(var s in this.buckets){var c=this.buckets[s];c.uploadPending()&&c.upload(r)}var f=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ks(r,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ks(r,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)},ot.prototype.prepare=function(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)},ot.prototype.queryRenderedFeatures=function(r,s,c,f,m,b,O,z,j,G){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:m,scale:b,tileSize:this.tileSize,pixelPosMatrix:G,transform:z,params:O,queryPadding:this.queryPadding*j},r,s,c):{}},ot.prototype.querySourceFeatures=function(r,s){var c=this.latestFeatureIndex;if(c&&c.rawTileData){var f=c.loadVTLayers(),m=s?s.sourceLayer:"",b=f._geojsonTileLayer||f[m];if(b)for(var O=Hr(s&&s.filter),z=this.tileID.canonical,j=z.z,G=z.x,$=z.y,ee={z:j,x:G,y:$},se=0;se<b.length;se++){var ge=b.feature(se);if(O.needGeometry){var Me=wo(ge,!0);if(!O.filter(new oi(this.tileID.overscaledZ),Me,this.tileID.canonical))continue}else if(!O.filter(new oi(this.tileID.overscaledZ),ge))continue;var Ae=c.getId(ge,m),Fe=new Dr(ge,j,G,$,Ae);Fe.tile=ee,r.push(Fe)}}},ot.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},ot.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ot.prototype.setExpiryData=function(r){var s=this.expirationTime;if(r.cacheControl){var c=xe(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){var f=Date.now(),m=!1;if(this.expirationTime>f)m=!1;else if(s)if(this.expirationTime<s)m=!0;else{var b=this.expirationTime-s;b?this.expirationTime=f+Math.max(b,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ot.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},ot.prototype.setFeatureState=function(r,s){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(r).length){var c=this.latestFeatureIndex.loadVTLayers();for(var f in this.buckets)if(s.style.hasLayer(f)){var m=this.buckets[f],b=m.layers[0].sourceLayer||"_geojsonTileLayer",O=c[b],z=r[b];if(O&&z&&0!==Object.keys(z).length){m.update(z,O,this.imageAtlas&&this.imageAtlas.patternPositions||{});var j=s&&s.style&&s.style.getLayer(f);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(m)))}}}},ot.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},ot.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<st.now()},ot.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ot.prototype.setHoldDuration=function(r){this.symbolFadeHoldUntil=st.now()+r},ot.prototype.setDependencies=function(r,s){for(var c={},f=0,m=s;f<m.length;f+=1)c[m[f]]=!0;this.dependencies[r]=c},ot.prototype.hasDependency=function(r,s){for(var c=0,f=r;c<f.length;c+=1){var m=this.dependencies[f[c]];if(m)for(var b=0,O=s;b<O.length;b+=1)if(m[O[b]])return!0}return!1};var nl=E.performance,Pg=function(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},nl.mark(this._marks.start)};Pg.prototype.finish=function(){nl.mark(this._marks.end);var r=nl.getEntriesByName(this._marks.measure);return 0===r.length&&(nl.measure(this._marks.measure,this._marks.start,this._marks.end),r=nl.getEntriesByName(this._marks.measure),nl.clearMarks(this._marks.start),nl.clearMarks(this._marks.end),nl.clearMeasures(this._marks.measure)),r},d.Actor=Qc,d.AlphaImage=Bc,d.CanonicalTileID=Ju,d.CollisionBoxArray=h,d.Color=wi,d.DEMData=ql,d.DataConstantProperty=Cn,d.DictionaryCoder=Er,d.EXTENT=8192,d.ErrorEvent=qe,d.EvaluationParameters=oi,d.Event=Pe,d.Evented=Ge,d.FeatureIndex=Fo,d.FillBucket=el,d.FillExtrusionBucket=tl,d.ImageAtlas=Kp,d.ImagePosition=vp,d.LineBucket=zr,d.LngLat=ao,d.LngLatBounds=Ro,d.MercatorCoordinate=Kc,d.ONE_EM=24,d.OverscaledTileID=Qo,d.Point=S,d.Point$1=S,d.Properties=or,d.Protobuf=Qp,d.RGBAImage=ya,d.RequestManager=$n,d.RequestPerformance=Pg,d.ResourceType=br,d.SegmentVector=ve,d.SourceFeatureState=$a,d.StructArrayLayout1ui2=up,d.StructArrayLayout2f1f2i16=Mr,d.StructArrayLayout2i4=Ll,d.StructArrayLayout3ui6=fl,d.StructArrayLayout4i8=Tu,d.SymbolBucket=Pi,d.Texture=ks,d.Tile=ot,d.Transitionable=Vo,d.Uniform1f=Ut,d.Uniform1i=St,d.Uniform2f=Rt,d.Uniform3f=Kt,d.Uniform4f=wn,d.UniformColor=Mn,d.UniformMatrix4f=_i,d.UnwrappedTileID=dh,d.ValidationError=Ze,d.WritingMode=Ka,d.ZoomHistory=op,d.add=function(r,s,c){return r[0]=s[0]+c[0],r[1]=s[1]+c[1],r[2]=s[2]+c[2],r},d.addDynamicAttributes=lh,d.asyncAll=function(r,s,c){if(!r.length)return c(null,[]);var f=r.length,m=new Array(r.length),b=null;r.forEach(function(O,z){s(O,function(j,G){j&&(b=j),m[z]=G,0==--f&&c(b,m)})})},d.bezier=A,d.bindAll=ke,d.browser=st,d.cacheEntryPossiblyAdded=function(r){++Eo>lo&&(r.getActor().send("enforceCacheSizeLimit",tr),Eo=0)},d.clamp=U,d.clearTileCache=function(r){var s=E.caches.delete("mapbox-tiles");r&&s.catch(r).then(function(){return r()})},d.clipLine=hg,d.clone=function(r){var s=new Ii(16);return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},d.clone$1=je,d.clone$2=function(r){var s=new Ii(3);return s[0]=r[0],s[1]=r[1],s[2]=r[2],s},d.collisionCircleLayout=R_,d.config=at,d.create=function(){var r=new Ii(16);return Ii!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},d.create$1=function(){var r=new Ii(9);return Ii!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},d.create$2=function(){var r=new Ii(4);return Ii!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},d.createCommonjsModule=T,d.createExpression=kl,d.createLayout=Yo,d.createStyleLayer=function(r){return"custom"===r.type?new cy(r):new cm[r.type](r)},d.cross=function(r,s,c){var f=s[0],m=s[1],b=s[2],O=c[0],z=c[1],j=c[2];return r[0]=m*j-b*z,r[1]=b*O-f*j,r[2]=f*z-m*O,r},d.deepEqual=function r(s,c){if(Array.isArray(s)){if(!Array.isArray(c)||s.length!==c.length)return!1;for(var f=0;f<s.length;f++)if(!r(s[f],c[f]))return!1;return!0}if("object"==typeof s&&null!==s&&null!==c){if("object"!=typeof c||Object.keys(s).length!==Object.keys(c).length)return!1;for(var m in s)if(!r(s[m],c[m]))return!1;return!0}return s===c},d.dot=function(r,s){return r[0]*s[0]+r[1]*s[1]+r[2]*s[2]},d.dot$1=function(r,s){return r[0]*s[0]+r[1]*s[1]+r[2]*s[2]+r[3]*s[3]},d.ease=I,d.emitValidationErrors=Vs,d.endsWith=Le,d.enforceCacheSizeLimit=function(r){Po(),No&&No.then(function(s){s.keys().then(function(c){for(var f=0;f<c.length-r;f++)s.delete(c[f])})})},d.evaluateSizeForFeature=rh,d.evaluateSizeForZoom=lg,d.evaluateVariableOffset=_g,d.evented=sp,d.extend=W,d.featureFilter=Hr,d.filterObject=Ie,d.fromRotation=function(r,s){var c=Math.sin(s),f=Math.cos(s);return r[0]=f,r[1]=c,r[2]=0,r[3]=-c,r[4]=f,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},d.getAnchorAlignment=oh,d.getAnchorJustification=sh,d.getArrayBuffer=Fs,d.getImage=re,d.getJSON=function(r,s){return Ri(W(r,{type:"json"}),s)},d.getRTLTextPluginStatus=xu,d.getReferrer=Ca,d.getVideo=function(r,s){var c,f,m=E.document.createElement("video");m.muted=!0,m.onloadstart=function(){s(null,m)};for(var b=0;b<r.length;b++){var O=E.document.createElement("source");c=r[b],f=void 0,(f=E.document.createElement("a")).href=c,(f.protocol!==E.document.location.protocol||f.host!==E.document.location.host)&&(m.crossOrigin="Anonymous"),O.src=r[b],m.appendChild(O)}return{cancel:function(){}}},d.identity=Na,d.invert=function(r,s){var c=s[0],f=s[1],m=s[2],b=s[3],O=s[4],z=s[5],j=s[6],G=s[7],$=s[8],ee=s[9],se=s[10],ge=s[11],Me=s[12],Ae=s[13],Fe=s[14],ze=s[15],Ve=c*z-f*O,nt=c*j-m*O,lt=c*G-b*O,gt=f*j-m*z,wt=f*G-b*z,zt=m*G-b*j,jt=$*Ae-ee*Me,vn=$*Fe-se*Me,on=$*ze-ge*Me,On=ee*Fe-se*Ae,rn=ee*ze-ge*Ae,ii=se*ze-ge*Fe,Jn=Ve*ii-nt*rn+lt*On+gt*on-wt*vn+zt*jt;return Jn?(r[0]=(z*ii-j*rn+G*On)*(Jn=1/Jn),r[1]=(m*rn-f*ii-b*On)*Jn,r[2]=(Ae*zt-Fe*wt+ze*gt)*Jn,r[3]=(se*wt-ee*zt-ge*gt)*Jn,r[4]=(j*on-O*ii-G*vn)*Jn,r[5]=(c*ii-m*on+b*vn)*Jn,r[6]=(Fe*lt-Me*zt-ze*nt)*Jn,r[7]=($*zt-se*lt+ge*nt)*Jn,r[8]=(O*rn-z*on+G*jt)*Jn,r[9]=(f*on-c*rn-b*jt)*Jn,r[10]=(Me*wt-Ae*lt+ze*Ve)*Jn,r[11]=(ee*lt-$*wt-ge*Ve)*Jn,r[12]=(z*vn-O*On-j*jt)*Jn,r[13]=(c*On-f*vn+m*jt)*Jn,r[14]=(Ae*nt-Me*gt-Fe*Ve)*Jn,r[15]=($*gt-ee*nt+se*Ve)*Jn,r):null},d.isChar=Ht,d.isMapboxURL=pn,d.keysDifference=function(r,s){var c=[];for(var f in r)f in s||c.push(f);return c},d.makeRequest=Ri,d.mapObject=Ue,d.mercatorXfromLng=Mg,d.mercatorYfromLat=Og,d.mercatorZfromAltitude=xp,d.mul=Gd,d.multiply=Xr,d.mvt=Nu,d.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},d.normalize=function(r,s){var c=s[0],f=s[1],m=s[2],b=c*c+f*f+m*m;return b>0&&(b=1/Math.sqrt(b)),r[0]=s[0]*b,r[1]=s[1]*b,r[2]=s[2]*b,r},d.number=co,d.offscreenCanvasSupported=Bn,d.ortho=function(r,s,c,f,m,b,O){var z=1/(s-c),j=1/(f-m),G=1/(b-O);return r[0]=-2*z,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*j,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*G,r[11]=0,r[12]=(s+c)*z,r[13]=(m+f)*j,r[14]=(O+b)*G,r[15]=1,r},d.parseGlyphPBF=function(r){return new Qp(r).readFields(V_,[])},d.pbf=Qp,d.performSymbolLayout=function(r,s,c,f,m,b,O){r.createArrays(),r.tilePixelRatio=8192/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;var z=r.layers[0].layout,j=r.layers[0]._unevaluatedLayout._values,G={};if("composite"===r.textSizeData.kind){var $=r.textSizeData,ee=$.maxZoom;G.compositeTextSizes=[j["text-size"].possiblyEvaluate(new oi($.minZoom),O),j["text-size"].possiblyEvaluate(new oi(ee),O)]}if("composite"===r.iconSizeData.kind){var se=r.iconSizeData,ge=se.maxZoom;G.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new oi(se.minZoom),O),j["icon-size"].possiblyEvaluate(new oi(ge),O)]}G.layoutTextSize=j["text-size"].possiblyEvaluate(new oi(r.zoom+1),O),G.layoutIconSize=j["icon-size"].possiblyEvaluate(new oi(r.zoom+1),O),G.textMaxSize=j["text-size"].possiblyEvaluate(new oi(18));for(var Me=24*z.get("text-line-height"),Ae="map"===z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),Fe=z.get("text-keep-upright"),ze=z.get("text-size"),Ve=function(){var gt=lt[nt],wt=z.get("text-font").evaluate(gt,{},O).join(","),zt=ze.evaluate(gt,{},O),jt=G.layoutTextSize.evaluate(gt,{},O),vn=G.layoutIconSize.evaluate(gt,{},O),on={horizontal:{},vertical:void 0},On=gt.text,rn=[0,0];if(On){var ii=On.toString(),Jn=24*z.get("text-letter-spacing").evaluate(gt,{},O),mn=function(di){for(var Ki=0,Fi=di;Ki<Fi.length;Ki+=1)if(Mi=Fi[Ki].charCodeAt(0),Ht.Arabic(Mi)||Ht["Arabic Supplement"](Mi)||Ht["Arabic Extended-A"](Mi)||Ht["Arabic Presentation Forms-A"](Mi)||Ht["Arabic Presentation Forms-B"](Mi))return!1;var Mi;return!0}(ii)?Jn:0,ai=z.get("text-anchor").evaluate(gt,{},O),ni=z.get("text-variable-anchor");if(!ni){var xi=z.get("text-radial-offset").evaluate(gt,{},O);rn=xi?_g(ai,[24*xi,ah]):z.get("text-offset").evaluate(gt,{},O).map(function(di){return 24*di})}var An=Ae?"center":z.get("text-justify").evaluate(gt,{},O),si=z.get("symbol-placement"),Xi="point"===si?24*z.get("text-max-width").evaluate(gt,{},O):0,ho=function(){r.allowVerticalPlacement&&rp(ii)&&(on.vertical=bp(On,s,c,m,wt,Xi,Me,ai,"left",mn,rn,Ka.vertical,!0,si,jt,zt))};if(!Ae&&ni){for(var fo="auto"===An?ni.map(function(di){return sh(di)}):[An],go=!1,Io=0;Io<fo.length;Io++){var lr=fo[Io];if(!on.horizontal[lr])if(go)on.horizontal[lr]=on.horizontal[0];else{var cr=bp(On,s,c,m,wt,Xi,Me,"center",lr,mn,rn,Ka.horizontal,!1,si,jt,zt);cr&&(on.horizontal[lr]=cr,go=1===cr.positionedLines.length)}}ho()}else{"auto"===An&&(An=sh(ai));var ea=bp(On,s,c,m,wt,Xi,Me,ai,An,mn,rn,Ka.horizontal,!1,si,jt,zt);ea&&(on.horizontal[An]=ea),ho(),rp(ii)&&Ae&&Fe&&(on.vertical=bp(On,s,c,m,wt,Xi,Me,ai,An,mn,rn,Ka.vertical,!1,si,jt,zt))}}var di,Ki,Mi,va,mr,_r=void 0,ta=!1;if(gt.icon&&gt.icon.name){var _o=f[gt.icon.name];_o&&(di=m[gt.icon.name],Ki=z.get("icon-offset").evaluate(gt,{},O),Mi=oh(z.get("icon-anchor").evaluate(gt,{},O)),_r={image:di,top:mr=Ki[1]-di.displaySize[1]*Mi.verticalAlign,bottom:mr+di.displaySize[1],left:va=Ki[0]-di.displaySize[0]*Mi.horizontalAlign,right:va+di.displaySize[0]},ta=_o.sdf,void 0===r.sdfIcons?r.sdfIcons=_o.sdf:r.sdfIcons!==_o.sdf&&ie("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_o.pixelRatio!==r.pixelRatio||0!==z.get("icon-rotate").constantOr(1))&&(r.iconsNeedLinear=!0))}var ur=yg(on.horizontal)||on.vertical;r.iconsInText=!!ur&&ur.iconsInText,(ur||_r)&&function(di,Ki,Fi,Mi,va,mr,so,To,Rr,Ei,Jl){var Wa=mr.textMaxSize.evaluate(Ki,{});void 0===Wa&&(Wa=so);var jl,Zo=di.layers[0].layout,_s=Zo.get("icon-offset").evaluate(Ki,{},Jl),La=yg(Fi.horizontal),Bl=so/24,_c=di.tilePixelRatio*Bl,Is=di.tilePixelRatio*Wa/24,xl=di.tilePixelRatio*To,Cp=di.tilePixelRatio*Zo.get("symbol-spacing"),hh=Zo.get("text-padding")*di.tilePixelRatio,ms=Zo.get("icon-padding")*di.tilePixelRatio,Bu=Zo.get("text-max-angle")/180*Math.PI,Bt="map"===Zo.get("text-rotation-alignment")&&"point"!==Zo.get("symbol-placement"),pt="map"===Zo.get("icon-rotation-alignment")&&"point"!==Zo.get("symbol-placement"),nn=Zo.get("symbol-placement"),Zi=Cp/2,Xa=Zo.get("icon-text-fit");Mi&&"none"!==Xa&&(di.allowVerticalPlacement&&Fi.vertical&&(jl=sg(Mi,Fi.vertical,Xa,Zo.get("icon-text-fit-padding"),_s,Bl)),La&&(Mi=sg(Mi,La,Xa,Zo.get("icon-text-fit-padding"),_s,Bl)));var mc=function(Tp,za){za.x<0||za.x>=8192||za.y<0||za.y>=8192||function($i,na,Eg,Yl,Ag,pm,mh,Hl,yh,od,vh,bh,kg,dm,rd,hm,fm,gm,_m,mm,es,ad,sd,Cl,xh){var Ig,wc,Vu,Yu,tu,nu=$i.addToLineVertexArray(na,Eg),Zg=0,Ng=0,Lg=0,zg=0,Ch=-1,wh=-1,Ql={},Dg=Se(""),Th=0,ld=0;if(void 0===Hl._unevaluatedLayout.getValue("text-radial-offset")?(Th=(Ig=Hl.layout.get("text-offset").evaluate(es,{},Cl).map(function(Pp){return 24*Pp}))[0],ld=Ig[1]):(Th=24*Hl.layout.get("text-radial-offset").evaluate(es,{},Cl),ld=ah),$i.allowVerticalPlacement&&Yl.vertical){var Rg=Hl.layout.get("text-rotate").evaluate(es,{},Cl)+90;Yu=new gc(yh,na,od,vh,bh,Yl.vertical,kg,dm,rd,Rg),mh&&(tu=new gc(yh,na,od,vh,bh,mh,fm,gm,rd,Rg))}if(Ag){var Hu=Hl.layout.get("icon-rotate").evaluate(es,{}),Fg="none"!==Hl.layout.get("icon-text-fit"),Ug=fg(Ag,Hu,sd,Fg),Mh=mh?fg(mh,Hu,sd,Fg):void 0;Vu=new gc(yh,na,od,vh,bh,Ag,fm,gm,!1,Hu),Zg=4*Ug.length;var qg=$i.iconSizeData,Mp=null;"source"===qg.kind?(Mp=[128*Hl.layout.get("icon-size").evaluate(es,{})])[0]>32640&&ie($i.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===qg.kind&&((Mp=[128*ad.compositeIconSizes[0].evaluate(es,{},Cl),128*ad.compositeIconSizes[1].evaluate(es,{},Cl)])[0]>32640||Mp[1]>32640)&&ie($i.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),$i.addSymbols($i.icon,Ug,Mp,mm,_m,es,!1,na,nu.lineStartIndex,nu.lineLength,-1,Cl),Ch=$i.icon.placedSymbolArray.length-1,Mh&&(Ng=4*Mh.length,$i.addSymbols($i.icon,Mh,Mp,mm,_m,es,Ka.vertical,na,nu.lineStartIndex,nu.lineLength,-1,Cl),wh=$i.icon.placedSymbolArray.length-1)}for(var Jg in Yl.horizontal){var cd=Yl.horizontal[Jg];if(!wc){Dg=Se(cd.text);var ym=Hl.layout.get("text-rotate").evaluate(es,{},Cl);wc=new gc(yh,na,od,vh,bh,cd,kg,dm,rd,ym)}var jg=1===cd.positionedLines.length;if(Lg+=mg($i,na,cd,pm,Hl,rd,es,hm,nu,Yl.vertical?Ka.horizontal:Ka.horizontalOnly,jg?Object.keys(Yl.horizontal):[Jg],Ql,Ch,ad,Cl),jg)break}Yl.vertical&&(zg+=mg($i,na,Yl.vertical,pm,Hl,rd,es,hm,nu,Ka.vertical,["vertical"],Ql,wh,ad,Cl));var vm=wc?wc.boxStartIndex:$i.collisionBoxArray.length,bm=wc?wc.boxEndIndex:$i.collisionBoxArray.length,xm=Yu?Yu.boxStartIndex:$i.collisionBoxArray.length,Cm=Yu?Yu.boxEndIndex:$i.collisionBoxArray.length,wm=Vu?Vu.boxStartIndex:$i.collisionBoxArray.length,Tm=Vu?Vu.boxEndIndex:$i.collisionBoxArray.length,Mm=tu?tu.boxStartIndex:$i.collisionBoxArray.length,Om=tu?tu.boxEndIndex:$i.collisionBoxArray.length,Ns=-1,Op=function(Pp,Bg){return Pp&&Pp.circleDiameter?Math.max(Pp.circleDiameter,Bg):Bg};Ns=Op(wc,Ns),Ns=Op(Yu,Ns),Ns=Op(Vu,Ns);var Sp=(Ns=Op(tu,Ns))>-1?1:0;Sp&&(Ns*=xh/24),$i.glyphOffsetArray.length>=Pi.MAX_GLYPHS&&ie("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==es.sortKey&&$i.addToSortKeyRanges($i.symbolInstances.length,es.sortKey),$i.symbolInstances.emplaceBack(na.x,na.y,Ql.right>=0?Ql.right:-1,Ql.center>=0?Ql.center:-1,Ql.left>=0?Ql.left:-1,Ql.vertical||-1,Ch,wh,Dg,vm,bm,xm,Cm,wm,Tm,Mm,Om,od,Lg,zg,Zg,Ng,Sp,0,kg,Th,ld,Ns)}(di,za,Tp,Fi,Mi,va,jl,di.layers[0],di.collisionBoxArray,Ki.index,Ki.sourceLayerIndex,di.index,_c,hh,Bt,Rr,xl,ms,pt,_s,Ki,mr,Ei,Jl,so)};if("line"===nn)for(var Wc=0,ys=hg(Ki.geometry,0,0,8192,8192);Wc<ys.length;Wc+=1)for(var Uo=ys[Wc],mo=0,wp=W_(Uo,Cp,Bu,Fi.vertical||La,Mi,24,Is,di.overscaling,8192);mo<wp.length;mo+=1){var fh=wp[mo];La&&nm(di,La.text,Zi,fh)||mc(Uo,fh)}else if("line-center"===nn)for(var yc=0,vc=Ki.geometry;yc<vc.length;yc+=1){var vo=vc[yc];if(vo.length>1){var Xc=$_(vo,Bu,Fi.vertical||La,Mi,24,Is);Xc&&mc(vo,Xc)}}else if("Polygon"===Ki.type)for(var bc=0,eu=jf(Ki.geometry,0);bc<eu.length;bc+=1){var Gl=eu[bc],Vl=em(Gl,16);mc(Gl[0],new Du(Vl.x,Vl.y,0))}else if("LineString"===Ki.type)for(var il=0,Zs=Ki.geometry;il<Zs.length;il+=1){var vs=Zs[il];mc(vs,new Du(vs[0].x,vs[0].y,0))}else if("Point"===Ki.type)for(var xc=0,gh=Ki.geometry;xc<gh.length;xc+=1)for(var Gu=0,_h=gh[xc];Gu<_h.length;Gu+=1){var Cc=_h[Gu];mc([Cc],new Du(Cc.x,Cc.y,0))}}(r,gt,on,_r,f,G,jt,vn,rn,ta,O)},nt=0,lt=r.features;nt<lt.length;nt+=1)Ve();b&&r.generateCollisionDebugBuffers()},d.perspective=function(r,s,c,f,m){var b,O=1/Math.tan(s/2);return r[0]=O/c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=O,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=m&&m!==1/0?(r[10]=(m+f)*(b=1/(f-m)),r[14]=2*m*f*b):(r[10]=-1,r[14]=-2*f),r},d.pick=function(r,s){for(var c={},f=0;f<s.length;f++){var m=s[f];m in r&&(c[m]=r[m])}return c},d.plugin=fr,d.polygonIntersectsPolygon=ml,d.postMapLoadEvent=bo,d.postTurnstileEvent=ra,d.potpack=yp,d.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],d.register=cn,d.registerForPluginStateChange=function(r){return r({pluginStatus:da,pluginURL:Os}),sp.on("pluginStateChange",r),r},d.renderColorRamp=Df,d.rotate=function(r,s,c){var f=s[0],m=s[1],b=s[2],O=s[3],z=Math.sin(c),j=Math.cos(c);return r[0]=f*j+b*z,r[1]=m*j+O*z,r[2]=f*-z+b*j,r[3]=m*-z+O*j,r},d.rotateX=function(r,s,c){var f=Math.sin(c),m=Math.cos(c),b=s[4],O=s[5],z=s[6],j=s[7],G=s[8],$=s[9],ee=s[10],se=s[11];return s!==r&&(r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15]),r[4]=b*m+G*f,r[5]=O*m+$*f,r[6]=z*m+ee*f,r[7]=j*m+se*f,r[8]=G*m-b*f,r[9]=$*m-O*f,r[10]=ee*m-z*f,r[11]=se*m-j*f,r},d.rotateZ=function(r,s,c){var f=Math.sin(c),m=Math.cos(c),b=s[0],O=s[1],z=s[2],j=s[3],G=s[4],$=s[5],ee=s[6],se=s[7];return s!==r&&(r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15]),r[0]=b*m+G*f,r[1]=O*m+$*f,r[2]=z*m+ee*f,r[3]=j*m+se*f,r[4]=G*m-b*f,r[5]=$*m-O*f,r[6]=ee*m-z*f,r[7]=se*m-j*f,r},d.scale=function(r,s,c){var f=c[0],m=c[1],b=c[2];return r[0]=s[0]*f,r[1]=s[1]*f,r[2]=s[2]*f,r[3]=s[3]*f,r[4]=s[4]*m,r[5]=s[5]*m,r[6]=s[6]*m,r[7]=s[7]*m,r[8]=s[8]*b,r[9]=s[9]*b,r[10]=s[10]*b,r[11]=s[11]*b,r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},d.scale$1=function(r,s,c){return r[0]=s[0]*c,r[1]=s[1]*c,r[2]=s[2]*c,r[3]=s[3]*c,r},d.scale$2=function(r,s,c){return r[0]=s[0]*c,r[1]=s[1]*c,r[2]=s[2]*c,r},d.setCacheLimits=function(r,s){tr=r,lo=s},d.setRTLTextPlugin=function(r,s,c){if(void 0===c&&(c=!1),"deferred"===da||"loading"===da||"loaded"===da)throw new Error("setRTLTextPlugin cannot be called multiple times.");Os=st.resolveURL(r),da="deferred",Dc=s,Fc(),c||ka()},d.sphericalToCartesian=function(r){var s=r[0],c=r[1],f=r[2];return c+=90,c*=Math.PI/180,f*=Math.PI/180,{x:s*Math.cos(c)*Math.sin(f),y:s*Math.sin(c)*Math.sin(f),z:s*Math.cos(f)}},d.sqrLen=function(r){var s=r[0],c=r[1];return s*s+c*c},d.styleSpec=ye,d.sub=function(r,s,c){return r[0]=s[0]-c[0],r[1]=s[1]-c[1],r[2]=s[2]-c[2],r},d.symbolSize=K_,d.transformMat3=function(r,s,c){var f=s[0],m=s[1],b=s[2];return r[0]=f*c[0]+m*c[3]+b*c[6],r[1]=f*c[1]+m*c[4]+b*c[7],r[2]=f*c[2]+m*c[5]+b*c[8],r},d.transformMat4=Pu,d.translate=function(r,s,c){var f,m,b,O,z,j,G,$,ee,se,ge,Me,Ae=c[0],Fe=c[1],ze=c[2];return s===r?(r[12]=s[0]*Ae+s[4]*Fe+s[8]*ze+s[12],r[13]=s[1]*Ae+s[5]*Fe+s[9]*ze+s[13],r[14]=s[2]*Ae+s[6]*Fe+s[10]*ze+s[14],r[15]=s[3]*Ae+s[7]*Fe+s[11]*ze+s[15]):(m=s[1],b=s[2],O=s[3],z=s[4],j=s[5],G=s[6],$=s[7],ee=s[8],se=s[9],ge=s[10],Me=s[11],r[0]=f=s[0],r[1]=m,r[2]=b,r[3]=O,r[4]=z,r[5]=j,r[6]=G,r[7]=$,r[8]=ee,r[9]=se,r[10]=ge,r[11]=Me,r[12]=f*Ae+z*Fe+ee*ze+s[12],r[13]=m*Ae+j*Fe+se*ze+s[13],r[14]=b*Ae+G*Fe+ge*ze+s[14],r[15]=O*Ae+$*Fe+Me*ze+s[15]),r},d.triggerPluginCompletionEvent=Rc,d.uniqueId=e,d.validateCustomStyleLayer=function(r){var s=[],c=r.id;return void 0===c&&s.push({message:"layers."+c+': missing required property "id"'}),void 0===r.render&&s.push({message:"layers."+c+': missing required method "render"'}),r.renderingMode&&"2d"!==r.renderingMode&&"3d"!==r.renderingMode&&s.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),s},d.validateLight=Lc,d.validateStyle=hr,d.values=function(r){var s=[];for(var c in r)s.push(r[c]);return s},d.vectorTile=Nu,d.version="1.13.2",d.warnOnce=ie,d.webpSupported=kt,d.window=E,d.wrap=Q}),D(0,function(d){function T(te){var re=typeof te;if("number"===re||"boolean"===re||"string"===re||null==te)return JSON.stringify(te);if(Array.isArray(te)){for(var fe="[",Ce=0,Pe=te;Ce<Pe.length;Ce+=1)fe+=T(Pe[Ce])+",";return fe+"]"}for(var qe=Object.keys(te).sort(),Ge="{",ye=0;ye<qe.length;ye++)Ge+=JSON.stringify(qe[ye])+":"+T(te[qe[ye]])+",";return Ge+"}"}function w(te){for(var re="",fe=0,Ce=d.refProperties;fe<Ce.length;fe+=1)re+="/"+T(te[Ce[fe]]);return re}var y=function(te){this.keyCache={},te&&this.replace(te)};y.prototype.replace=function(te){this._layerConfigs={},this._layers={},this.update(te,[])},y.prototype.update=function(te,re){for(var fe=this,Ce=0,Pe=te;Ce<Pe.length;Ce+=1){var qe=Pe[Ce];this._layerConfigs[qe.id]=qe;var Ge=this._layers[qe.id]=d.createStyleLayer(qe);Ge._featureFilter=d.featureFilter(Ge.filter),this.keyCache[qe.id]&&delete this.keyCache[qe.id]}for(var ye=0,Ze=re;ye<Ze.length;ye+=1){var $e=Ze[ye];delete this.keyCache[$e],delete this._layerConfigs[$e],delete this._layers[$e]}this.familiesBySource={};for(var Mt=0,It=function(Jt,Yt){for(var Gn={},Wt=0;Wt<Jt.length;Wt++){var li=Yt&&Yt[Jt[Wt].id]||w(Jt[Wt]);Yt&&(Yt[Jt[Wt].id]=li);var zi=Gn[li];zi||(zi=Gn[li]=[]),zi.push(Jt[Wt])}var zn=[];for(var vi in Gn)zn.push(Gn[vi]);return zn}(d.values(this._layerConfigs),this.keyCache);Mt<It.length;Mt+=1){var ht=It[Mt].map(function(Jt){return fe._layers[Jt.id]}),At=ht[0];if("none"!==At.visibility){var sn=At.source||"",an=this.familiesBySource[sn];an||(an=this.familiesBySource[sn]={});var ft=At.sourceLayer||"_geojsonTileLayer",Qt=an[ft];Qt||(Qt=an[ft]=[]),Qt.push(ht)}}};var S=function(te){var re={},fe=[];for(var Ce in te){var Pe=te[Ce],qe=re[Ce]={};for(var Ge in Pe){var ye=Pe[+Ge];if(ye&&0!==ye.bitmap.width&&0!==ye.bitmap.height){var Ze={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};fe.push(Ze),qe[Ge]={rect:Ze,metrics:ye.metrics}}}}var $e=d.potpack(fe),Mt=new d.AlphaImage({width:$e.w||1,height:$e.h||1});for(var It in te){var ht=te[It];for(var At in ht){var sn=ht[+At];if(sn&&0!==sn.bitmap.width&&0!==sn.bitmap.height){var an=re[It][At].rect;d.AlphaImage.copy(sn.bitmap,Mt,{x:0,y:0},{x:an.x+1,y:an.y+1},sn.bitmap)}}}this.image=Mt,this.positions=re};d.register("GlyphAtlas",S);var P=function(te){this.tileID=new d.OverscaledTileID(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId};function E(te,re,fe){for(var Ce=new d.EvaluationParameters(re),Pe=0,qe=te;Pe<qe.length;Pe+=1)qe[Pe].recalculate(Ce,fe)}function Z(te,re){var fe=d.getArrayBuffer(te.request,function(Ce,Pe,qe,Ge){Ce?re(Ce):Pe&&re(null,{vectorTile:new d.vectorTile.VectorTile(new d.pbf(Pe)),rawData:Pe,cacheControl:qe,expires:Ge})});return function(){fe.cancel(),re()}}P.prototype.parse=function(te,re,fe,Ce,Pe){var qe=this;this.status="parsing",this.data=te,this.collisionBoxArray=new d.CollisionBoxArray;var Ge=new d.DictionaryCoder(Object.keys(te.layers).sort()),ye=new d.FeatureIndex(this.tileID,this.promoteId);ye.bucketLayerIDs=[];var Ze,$e,Mt,It,ht={},At={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fe},sn=re.familiesBySource[this.source];for(var an in sn){var ft=te.layers[an];if(ft){1===ft.version&&d.warnOnce('Vector tile source "'+this.source+'" layer "'+an+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Qt=Ge.encode(an),Jt=[],Yt=0;Yt<ft.length;Yt++){var Gn=ft.feature(Yt),Wt=ye.getId(Gn,an);Jt.push({feature:Gn,id:Wt,index:Yt,sourceLayerIndex:Qt})}for(var li=0,zi=sn[an];li<zi.length;li+=1){var zn=zi[li],vi=zn[0];vi.minzoom&&this.zoom<Math.floor(vi.minzoom)||vi.maxzoom&&this.zoom>=vi.maxzoom||"none"!==vi.visibility&&(E(zn,this.zoom,fe),(ht[vi.id]=vi.createBucket({index:ye.bucketLayerIDs.length,layers:zn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qt,sourceID:this.source})).populate(Jt,At,this.tileID.canonical),ye.bucketLayerIDs.push(zn.map(function(Oi){return Oi.id})))}}}var ri=d.mapObject(At.glyphDependencies,function(Oi){return Object.keys(Oi).map(Number)});Object.keys(ri).length?Ce.send("getGlyphs",{uid:this.uid,stacks:ri},function(Oi,Zn){Ze||(Ze=Oi,$e=Zn,eo.call(qe))}):$e={};var jo=Object.keys(At.iconDependencies);jo.length?Ce.send("getImages",{icons:jo,source:this.source,tileID:this.tileID,type:"icons"},function(Oi,Zn){Ze||(Ze=Oi,Mt=Zn,eo.call(qe))}):Mt={};var Ci=Object.keys(At.patternDependencies);function eo(){if(Ze)return Pe(Ze);if($e&&Mt&&It){var Oi=new S($e),Zn=new d.ImageAtlas(Mt,It);for(var wi in ht){var dr=ht[wi];dr instanceof d.SymbolBucket?(E(dr.layers,this.zoom,fe),d.performSymbolLayout(dr,$e,Oi.positions,Mt,Zn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):dr.hasPattern&&(dr instanceof d.LineBucket||dr instanceof d.FillBucket||dr instanceof d.FillExtrusionBucket)&&(E(dr.layers,this.zoom,fe),dr.addFeatures(At,this.tileID.canonical,Zn.patternPositions))}this.status="done",Pe(null,{buckets:d.values(ht).filter(function(wa){return!wa.isEmpty()}),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Oi.image,imageAtlas:Zn,glyphMap:this.returnDependencies?$e:null,iconMap:this.returnDependencies?Mt:null,glyphPositions:this.returnDependencies?Oi.positions:null})}}Ci.length?Ce.send("getImages",{icons:Ci,source:this.source,tileID:this.tileID,type:"patterns"},function(Oi,Zn){Ze||(Ze=Oi,It=Zn,eo.call(qe))}):It={},eo.call(this)};var A=function(te,re,fe,Ce){this.actor=te,this.layerIndex=re,this.availableImages=fe,this.loadVectorData=Ce||Z,this.loading={},this.loaded={}};A.prototype.loadTile=function(te,re){var fe=this,Ce=te.uid;this.loading||(this.loading={});var Pe=!!(te&&te.request&&te.request.collectResourceTiming)&&new d.RequestPerformance(te.request),qe=this.loading[Ce]=new P(te);qe.abort=this.loadVectorData(te,function(Ge,ye){if(delete fe.loading[Ce],Ge||!ye)return qe.status="done",fe.loaded[Ce]=qe,re(Ge);var Ze=ye.rawData,$e={};ye.expires&&($e.expires=ye.expires),ye.cacheControl&&($e.cacheControl=ye.cacheControl);var Mt={};if(Pe){var It=Pe.finish();It&&(Mt.resourceTiming=JSON.parse(JSON.stringify(It)))}qe.vectorTile=ye.vectorTile,qe.parse(ye.vectorTile,fe.layerIndex,fe.availableImages,fe.actor,function(ht,At){if(ht||!At)return re(ht);re(null,d.extend({rawTileData:Ze.slice(0)},At,$e,Mt))}),fe.loaded=fe.loaded||{},fe.loaded[Ce]=qe})},A.prototype.reloadTile=function(te,re){var fe=this,Ce=this.loaded,Pe=te.uid,qe=this;if(Ce&&Ce[Pe]){var Ge=Ce[Pe];Ge.showCollisionBoxes=te.showCollisionBoxes;var ye=function(Ze,$e){var Mt=Ge.reloadCallback;Mt&&(delete Ge.reloadCallback,Ge.parse(Ge.vectorTile,qe.layerIndex,fe.availableImages,qe.actor,Mt)),re(Ze,$e)};"parsing"===Ge.status?Ge.reloadCallback=ye:"done"===Ge.status&&(Ge.vectorTile?Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.actor,ye):ye())}},A.prototype.abortTile=function(te,re){var fe=this.loading,Ce=te.uid;fe&&fe[Ce]&&fe[Ce].abort&&(fe[Ce].abort(),delete fe[Ce]),re()},A.prototype.removeTile=function(te,re){var fe=this.loaded,Ce=te.uid;fe&&fe[Ce]&&delete fe[Ce],re()};var I=d.window.ImageBitmap,U=function(){this.loaded={}};function Q(te,re){if(0!==te.length){W(te[0],re);for(var fe=1;fe<te.length;fe++)W(te[fe],!re)}}function W(te,re){for(var fe=0,Ce=0,Pe=te.length,qe=Pe-1;Ce<Pe;qe=Ce++)fe+=(te[Ce][0]-te[qe][0])*(te[qe][1]+te[Ce][1]);fe>=0!=!!re&&te.reverse()}U.prototype.loadTile=function(te,re){var fe=te.uid,Ce=te.encoding,Pe=te.rawImageData,qe=I&&Pe instanceof I?this.getImageData(Pe):Pe,Ge=new d.DEMData(fe,qe,Ce);this.loaded=this.loaded||{},this.loaded[fe]=Ge,re(null,Ge)},U.prototype.getImageData=function(te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);var re=this.offscreenCanvasContext.getImageData(-1,-1,te.width+2,te.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new d.RGBAImage({width:re.width,height:re.height},re.data)},U.prototype.removeTile=function(te){var re=this.loaded,fe=te.uid;re&&re[fe]&&delete re[fe]};var le=d.vectorTile.VectorTileFeature.prototype.toGeoJSON,e=function(te){this._feature=te,this.extent=d.EXTENT,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))};e.prototype.loadGeometry=function(){if(1===this._feature.type){for(var te=[],re=0,fe=this._feature.geometry;re<fe.length;re+=1){var Ce=fe[re];te.push([new d.Point$1(Ce[0],Ce[1])])}return te}for(var Pe=[],qe=0,Ge=this._feature.geometry;qe<Ge.length;qe+=1){for(var ye=[],Ze=0,$e=Ge[qe];Ze<$e.length;Ze+=1){var Mt=$e[Ze];ye.push(new d.Point$1(Mt[0],Mt[1]))}Pe.push(ye)}return Pe},e.prototype.toGeoJSON=function(te,re,fe){return le.call(this,te,re,fe)};var de=function(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=d.EXTENT,this.length=te.length,this._features=te};de.prototype.feature=function(te){return new e(this._features[te])};var he=d.vectorTile.VectorTileFeature,ke=Le;function Le(te,re){this.options=re||{},this.features=te,this.length=te.length}function Ue(te,re){this.id="number"==typeof te.id?te.id:void 0,this.type=te.type,this.rawGeometry=1===te.type?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=re||4096}Le.prototype.feature=function(te){return new Ue(this.features[te],this.options.extent)},Ue.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var re=0;re<te.length;re++){for(var fe=te[re],Ce=[],Pe=0;Pe<fe.length;Pe++)Ce.push(new d.Point$1(fe[Pe][0],fe[Pe][1]));this.geometry.push(Ce)}return this.geometry},Ue.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,re=1/0,fe=-1/0,Ce=1/0,Pe=-1/0,qe=0;qe<te.length;qe++)for(var Ge=te[qe],ye=0;ye<Ge.length;ye++){var Ze=Ge[ye];re=Math.min(re,Ze.x),fe=Math.max(fe,Ze.x),Ce=Math.min(Ce,Ze.y),Pe=Math.max(Pe,Ze.y)}return[re,Ce,fe,Pe]},Ue.prototype.toGeoJSON=he.prototype.toGeoJSON;var Ie=X,je=ke;function X(te){var re=new d.pbf;return function(fe,Ce){for(var Pe in fe.layers)Ce.writeMessage(3,ie,fe.layers[Pe])}(te,re),re.finish()}function ie(te,re){var fe;re.writeVarintField(15,te.version||1),re.writeStringField(1,te.name||""),re.writeVarintField(5,te.extent||4096);var Ce={keys:[],values:[],keycache:{},valuecache:{}};for(fe=0;fe<te.length;fe++)Ce.feature=te.feature(fe),re.writeMessage(2,oe,Ce);var Pe=Ce.keys;for(fe=0;fe<Pe.length;fe++)re.writeStringField(3,Pe[fe]);var qe=Ce.values;for(fe=0;fe<qe.length;fe++)re.writeMessage(4,we,qe[fe])}function oe(te,re){var fe=te.feature;void 0!==fe.id&&re.writeVarintField(1,fe.id),re.writeMessage(2,ae,te),re.writeVarintField(3,fe.type),re.writeMessage(4,Ne,fe)}function ae(te,re){var fe=te.feature,Ce=te.keys,Pe=te.values,qe=te.keycache,Ge=te.valuecache;for(var ye in fe.properties){var Ze=qe[ye];void 0===Ze&&(Ce.push(ye),qe[ye]=Ze=Ce.length-1),re.writeVarint(Ze);var $e=fe.properties[ye],Mt=typeof $e;"string"!==Mt&&"boolean"!==Mt&&"number"!==Mt&&($e=JSON.stringify($e));var It=Mt+":"+$e,ht=Ge[It];void 0===ht&&(Pe.push($e),Ge[It]=ht=Pe.length-1),re.writeVarint(ht)}}function pe(te,re){return(re<<3)+(7&te)}function xe(te){return te<<1^te>>31}function Ne(te,re){for(var fe=te.loadGeometry(),Ce=te.type,Pe=0,qe=0,Ge=fe.length,ye=0;ye<Ge;ye++){var Ze=fe[ye],$e=1;1===Ce&&($e=Ze.length),re.writeVarint(pe(1,$e));for(var Mt=3===Ce?Ze.length-1:Ze.length,It=0;It<Mt;It++){1===It&&1!==Ce&&re.writeVarint(pe(2,Mt-1));var ht=Ze[It].x-Pe,At=Ze[It].y-qe;re.writeVarint(xe(ht)),re.writeVarint(xe(At)),Pe+=ht,qe+=At}3===Ce&&re.writeVarint(pe(7,1))}}function we(te,re){var fe=typeof te;"string"===fe?re.writeStringField(1,te):"boolean"===fe?re.writeBooleanField(7,te):"number"===fe&&(te%1!=0?re.writeDoubleField(3,te):te<0?re.writeSVarintField(6,te):re.writeVarintField(5,te))}function me(te,re,fe,Ce){Ye(te,fe,Ce),Ye(re,2*fe,2*Ce),Ye(re,2*fe+1,2*Ce+1)}function Ye(te,re,fe){var Ce=te[re];te[re]=te[fe],te[fe]=Ce}function mt(te,re,fe,Ce){var Pe=te-fe,qe=re-Ce;return Pe*Pe+qe*qe}Ie.fromVectorTileJs=X,Ie.fromGeojsonVt=function(te,re){re=re||{};var fe={};for(var Ce in te)fe[Ce]=new ke(te[Ce].features,re),fe[Ce].name=Ce,fe[Ce].version=re.version,fe[Ce].extent=re.extent;return X({layers:fe})},Ie.GeoJSONWrapper=je;var Et=function(te){return te[0]},Tt=function(te){return te[1]},Nt=function(te,re,fe,Ce,Pe){void 0===re&&(re=Et),void 0===fe&&(fe=Tt),void 0===Ce&&(Ce=64),void 0===Pe&&(Pe=Float64Array),this.nodeSize=Ce,this.points=te;for(var qe=te.length<65536?Uint16Array:Uint32Array,Ge=this.ids=new qe(te.length),ye=this.coords=new Pe(2*te.length),Ze=0;Ze<te.length;Ze++)Ge[Ze]=Ze,ye[2*Ze]=re(te[Ze]),ye[2*Ze+1]=fe(te[Ze]);!function $e(Mt,It,ht,At,sn,an){if(!(sn-At<=ht)){var ft=At+sn>>1;(function Qt(Jt,Yt,Gn,Wt,li,zi){for(;li>Wt;){if(li-Wt>600){var zn=li-Wt+1,vi=Gn-Wt+1,ri=Math.log(zn),jo=.5*Math.exp(2*ri/3),Ci=.5*Math.sqrt(ri*jo*(zn-jo)/zn)*(vi-zn/2<0?-1:1);Qt(Jt,Yt,Gn,Math.max(Wt,Math.floor(Gn-vi*jo/zn+Ci)),Math.min(li,Math.floor(Gn+(zn-vi)*jo/zn+Ci)),zi)}var eo=Yt[2*Gn+zi],Oi=Wt,Zn=li;for(me(Jt,Yt,Wt,Gn),Yt[2*li+zi]>eo&&me(Jt,Yt,Wt,li);Oi<Zn;){for(me(Jt,Yt,Oi,Zn),Oi++,Zn--;Yt[2*Oi+zi]<eo;)Oi++;for(;Yt[2*Zn+zi]>eo;)Zn--}Yt[2*Wt+zi]===eo?me(Jt,Yt,Wt,Zn):me(Jt,Yt,++Zn,li),Zn<=Gn&&(Wt=Zn+1),Gn<=Zn&&(li=Zn-1)}})(Mt,It,ft,At,sn,an%2),$e(Mt,It,ht,At,ft-1,an+1),$e(Mt,It,ht,ft+1,sn,an+1)}}(Ge,ye,Ce,0,Ge.length-1,0)};Nt.prototype.range=function(te,re,fe,Ce){return function(Pe,qe,Ge,ye,Ze,$e,Mt){for(var It,ht,At=[0,Pe.length-1,0],sn=[];At.length;){var an=At.pop(),ft=At.pop(),Qt=At.pop();if(ft-Qt<=Mt)for(var Jt=Qt;Jt<=ft;Jt++)ht=qe[2*Jt+1],(It=qe[2*Jt])>=Ge&&It<=Ze&&ht>=ye&&ht<=$e&&sn.push(Pe[Jt]);else{var Yt=Math.floor((Qt+ft)/2);ht=qe[2*Yt+1],(It=qe[2*Yt])>=Ge&&It<=Ze&&ht>=ye&&ht<=$e&&sn.push(Pe[Yt]);var Gn=(an+1)%2;(0===an?Ge<=It:ye<=ht)&&(At.push(Qt),At.push(Yt-1),At.push(Gn)),(0===an?Ze>=It:$e>=ht)&&(At.push(Yt+1),At.push(ft),At.push(Gn))}}return sn}(this.ids,this.coords,te,re,fe,Ce,this.nodeSize)},Nt.prototype.within=function(te,re,fe){return function(Ce,Pe,qe,Ge,ye,Ze){for(var $e=[0,Ce.length-1,0],Mt=[],It=ye*ye;$e.length;){var ht=$e.pop(),At=$e.pop(),sn=$e.pop();if(At-sn<=Ze)for(var an=sn;an<=At;an++)mt(Pe[2*an],Pe[2*an+1],qe,Ge)<=It&&Mt.push(Ce[an]);else{var ft=Math.floor((sn+At)/2),Qt=Pe[2*ft],Jt=Pe[2*ft+1];mt(Qt,Jt,qe,Ge)<=It&&Mt.push(Ce[ft]);var Yt=(ht+1)%2;(0===ht?qe-ye<=Qt:Ge-ye<=Jt)&&($e.push(sn),$e.push(ft-1),$e.push(Yt)),(0===ht?qe+ye>=Qt:Ge+ye>=Jt)&&($e.push(ft+1),$e.push(At),$e.push(Yt))}}return Mt}(this.ids,this.coords,te,re,fe,this.nodeSize)};var Xt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(te){return te}},Pn=function(te){this.options=gn(Object.create(Xt),te),this.trees=new Array(this.options.maxZoom+1)};function st(te,re,fe,Ce,Pe){return{x:te,y:re,zoom:1/0,id:fe,parentId:-1,numPoints:Ce,properties:Pe}}function at(te,re){var fe=te.geometry.coordinates,Ce=fe[1];return{x:_n(fe[0]),y:Lt(Ce),zoom:1/0,index:re,parentId:-1}}function kt(te){return{type:"Feature",id:te.id,properties:$t(te),geometry:{type:"Point",coordinates:[(Ce=te.x,360*(Ce-.5)),(re=te.y,fe=(180-360*re)*Math.PI/180,360*Math.atan(Math.exp(fe))/Math.PI-90)]}};var re,fe,Ce}function $t(te){var re=te.numPoints,fe=re>=1e4?Math.round(re/1e3)+"k":re>=1e3?Math.round(re/100)/10+"k":re;return gn(gn({},te.properties),{cluster:!0,cluster_id:te.id,point_count:re,point_count_abbreviated:fe})}function _n(te){return te/360+.5}function Lt(te){var re=Math.sin(te*Math.PI/180),fe=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return fe<0?0:fe>1?1:fe}function gn(te,re){for(var fe in re)te[fe]=re[fe];return te}function $n(te){return te.x}function pn(te){return te.y}function Ui(te,re,fe,Ce,Pe,qe){var Ge=Pe-fe,ye=qe-Ce;if(0!==Ge||0!==ye){var Ze=((te-fe)*Ge+(re-Ce)*ye)/(Ge*Ge+ye*ye);Ze>1?(fe=Pe,Ce=qe):Ze>0&&(fe+=Ge*Ze,Ce+=ye*Ze)}return(Ge=te-fe)*Ge+(ye=re-Ce)*ye}function Gi(te,re,fe,Ce){var Pe={id:void 0===te?null:te,type:re,geometry:fe,tags:Ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qe){var Ge=qe.geometry,ye=qe.type;if("Point"===ye||"MultiPoint"===ye||"LineString"===ye)yi(qe,Ge);else if("Polygon"===ye||"MultiLineString"===ye)for(var Ze=0;Ze<Ge.length;Ze++)yi(qe,Ge[Ze]);else if("MultiPolygon"===ye)for(Ze=0;Ze<Ge.length;Ze++)for(var $e=0;$e<Ge[Ze].length;$e++)yi(qe,Ge[Ze][$e])}(Pe),Pe}function yi(te,re){for(var fe=0;fe<re.length;fe+=3)te.minX=Math.min(te.minX,re[fe]),te.minY=Math.min(te.minY,re[fe+1]),te.maxX=Math.max(te.maxX,re[fe]),te.maxY=Math.max(te.maxY,re[fe+1])}function Di(te,re,fe,Ce){if(re.geometry){var Pe=re.geometry.coordinates,qe=re.geometry.type,Ge=Math.pow(fe.tolerance/((1<<fe.maxZoom)*fe.extent),2),ye=[],Ze=re.id;if(fe.promoteId?Ze=re.properties[fe.promoteId]:fe.generateId&&(Ze=Ce||0),"Point"===qe)gi(Pe,ye);else if("MultiPoint"===qe)for(var $e=0;$e<Pe.length;$e++)gi(Pe[$e],ye);else if("LineString"===qe)Ni(Pe,ye,Ge,!1);else if("MultiLineString"===qe){if(fe.lineMetrics){for($e=0;$e<Pe.length;$e++)Ni(Pe[$e],ye=[],Ge,!1),te.push(Gi(Ze,"LineString",ye,re.properties));return}Mo(Pe,ye,Ge,!1)}else if("Polygon"===qe)Mo(Pe,ye,Ge,!0);else{if("MultiPolygon"!==qe){if("GeometryCollection"===qe){for($e=0;$e<re.geometry.geometries.length;$e++)Di(te,{id:Ze,geometry:re.geometry.geometries[$e],properties:re.properties},fe,Ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for($e=0;$e<Pe.length;$e++){var Mt=[];Mo(Pe[$e],Mt,Ge,!0),ye.push(Mt)}}te.push(Gi(Ze,qe,ye,re.properties))}}function gi(te,re){re.push(No(te[0])),re.push(vr(te[1])),re.push(0)}function Ni(te,re,fe,Ce){for(var Pe,qe,Ge=0,ye=0;ye<te.length;ye++){var Ze=No(te[ye][0]),$e=vr(te[ye][1]);re.push(Ze),re.push($e),re.push(0),ye>0&&(Ge+=Ce?(Pe*$e-Ze*qe)/2:Math.sqrt(Math.pow(Ze-Pe,2)+Math.pow($e-qe,2))),Pe=Ze,qe=$e}var Mt=re.length-3;re[2]=1,function It(ht,At,sn,an){for(var ft,Qt=an,Jt=sn-At>>1,Yt=sn-At,Gn=ht[At],Wt=ht[At+1],li=ht[sn],zi=ht[sn+1],zn=At+3;zn<sn;zn+=3){var vi=Ui(ht[zn],ht[zn+1],Gn,Wt,li,zi);if(vi>Qt)ft=zn,Qt=vi;else if(vi===Qt){var ri=Math.abs(zn-Jt);ri<Yt&&(ft=zn,Yt=ri)}}Qt>an&&(ft-At>3&&It(ht,At,ft,an),ht[ft+2]=Qt,sn-ft>3&&It(ht,ft,sn,an))}(re,0,Mt,fe),re[Mt+2]=1,re.size=Math.abs(Ge),re.start=0,re.end=re.size}function Mo(te,re,fe,Ce){for(var Pe=0;Pe<te.length;Pe++){var qe=[];Ni(te[Pe],qe,fe,Ce),re.push(qe)}}function No(te){return te/360+.5}function vr(te){var re=Math.sin(te*Math.PI/180),fe=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return fe<0?0:fe>1?1:fe}function Oo(te,re,fe,Ce,Pe,qe,Ge,ye){if(Ce/=re,qe>=(fe/=re)&&Ge<Ce)return te;if(Ge<fe||qe>=Ce)return null;for(var Ze=[],$e=0;$e<te.length;$e++){var Mt=te[$e],It=Mt.geometry,ht=Mt.type,At=0===Pe?Mt.minX:Mt.minY,sn=0===Pe?Mt.maxX:Mt.maxY;if(At>=fe&&sn<Ce)Ze.push(Mt);else if(!(sn<fe||At>=Ce)){var an=[];if("Point"===ht||"MultiPoint"===ht)So(It,an,fe,Ce,Pe);else if("LineString"===ht)ra(It,an,fe,Ce,Pe,!1,ye.lineMetrics);else if("MultiLineString"===ht)bo(It,an,fe,Ce,Pe,!1);else if("Polygon"===ht)bo(It,an,fe,Ce,Pe,!0);else if("MultiPolygon"===ht)for(var ft=0;ft<It.length;ft++){var Qt=[];bo(It[ft],Qt,fe,Ce,Pe,!0),Qt.length&&an.push(Qt)}if(an.length){if(ye.lineMetrics&&"LineString"===ht){for(ft=0;ft<an.length;ft++)Ze.push(Gi(Mt.id,ht,an[ft],Mt.tags));continue}"LineString"!==ht&&"MultiLineString"!==ht||(1===an.length?(ht="LineString",an=an[0]):ht="MultiLineString"),"Point"!==ht&&"MultiPoint"!==ht||(ht=3===an.length?"Point":"MultiPoint"),Ze.push(Gi(Mt.id,ht,an,Mt.tags))}}}return Ze.length?Ze:null}function So(te,re,fe,Ce,Pe){for(var qe=0;qe<te.length;qe+=3){var Ge=te[qe+Pe];Ge>=fe&&Ge<=Ce&&(re.push(te[qe]),re.push(te[qe+1]),re.push(te[qe+2]))}}function ra(te,re,fe,Ce,Pe,qe,Ge){for(var ye,Ze,$e=aa(te),Mt=0===Pe?lo:Po,It=te.start,ht=0;ht<te.length-3;ht+=3){var At=te[ht],sn=te[ht+1],an=te[ht+2],ft=te[ht+3],Qt=te[ht+4],Jt=0===Pe?At:sn,Yt=0===Pe?ft:Qt,Gn=!1;Ge&&(ye=Math.sqrt(Math.pow(At-ft,2)+Math.pow(sn-Qt,2))),Jt<fe?Yt>fe&&(Ze=Mt($e,At,sn,ft,Qt,fe),Ge&&($e.start=It+ye*Ze)):Jt>Ce?Yt<Ce&&(Ze=Mt($e,At,sn,ft,Qt,Ce),Ge&&($e.start=It+ye*Ze)):tr($e,At,sn,an),Yt<fe&&Jt>=fe&&(Ze=Mt($e,At,sn,ft,Qt,fe),Gn=!0),Yt>Ce&&Jt<=Ce&&(Ze=Mt($e,At,sn,ft,Qt,Ce),Gn=!0),!qe&&Gn&&(Ge&&($e.end=It+ye*Ze),re.push($e),$e=aa(te)),Ge&&(It+=ye)}var Wt=te.length-3;At=te[Wt],sn=te[Wt+1],an=te[Wt+2],(Jt=0===Pe?At:sn)>=fe&&Jt<=Ce&&tr($e,At,sn,an),Wt=$e.length-3,qe&&Wt>=3&&($e[Wt]!==$e[0]||$e[Wt+1]!==$e[1])&&tr($e,$e[0],$e[1],$e[2]),$e.length&&re.push($e)}function aa(te){var re=[];return re.size=te.size,re.start=te.start,re.end=te.end,re}function bo(te,re,fe,Ce,Pe,qe){for(var Ge=0;Ge<te.length;Ge++)ra(te[Ge],re,fe,Ce,Pe,qe,!1)}function tr(te,re,fe,Ce){te.push(re),te.push(fe),te.push(Ce)}function lo(te,re,fe,Ce,Pe,qe){var Ge=(qe-re)/(Ce-re);return te.push(qe),te.push(fe+(Pe-fe)*Ge),te.push(1),Ge}function Po(te,re,fe,Ce,Pe,qe){var Ge=(qe-fe)/(Pe-fe);return te.push(re+(Ce-re)*Ge),te.push(qe),te.push(1),Ge}function xa(te,re){for(var fe=[],Ce=0;Ce<te.length;Ce++){var Pe,qe=te[Ce],Ge=qe.type;if("Point"===Ge||"MultiPoint"===Ge||"LineString"===Ge)Pe=Ur(qe.geometry,re);else if("MultiLineString"===Ge||"Polygon"===Ge){Pe=[];for(var ye=0;ye<qe.geometry.length;ye++)Pe.push(Ur(qe.geometry[ye],re))}else if("MultiPolygon"===Ge)for(Pe=[],ye=0;ye<qe.geometry.length;ye++){for(var Ze=[],$e=0;$e<qe.geometry[ye].length;$e++)Ze.push(Ur(qe.geometry[ye][$e],re));Pe.push(Ze)}fe.push(Gi(qe.id,Ge,Pe,qe.tags))}return fe}function Ur(te,re){var fe=[];fe.size=te.size,void 0!==te.start&&(fe.start=te.start,fe.end=te.end);for(var Ce=0;Ce<te.length;Ce+=3)fe.push(te[Ce]+re,te[Ce+1],te[Ce+2]);return fe}function Eo(te,re){if(te.transformed)return te;var fe,Ce,Pe,qe=1<<te.z,Ge=te.x,ye=te.y;for(fe=0;fe<te.features.length;fe++){var Ze=te.features[fe],$e=Ze.geometry,Mt=Ze.type;if(Ze.geometry=[],1===Mt)for(Ce=0;Ce<$e.length;Ce+=2)Ze.geometry.push(Bn($e[Ce],$e[Ce+1],re,qe,Ge,ye));else for(Ce=0;Ce<$e.length;Ce++){var It=[];for(Pe=0;Pe<$e[Ce].length;Pe+=2)It.push(Bn($e[Ce][Pe],$e[Ce][Pe+1],re,qe,Ge,ye));Ze.geometry.push(It)}}return te.transformed=!0,te}function Bn(te,re,fe,Ce,Pe,qe){return[Math.round(fe*(te*Ce-Pe)),Math.round(fe*(re*Ce-qe))]}function br(te,re,fe,Ce,Pe){for(var qe=re===Pe.maxZoom?0:Pe.tolerance/((1<<re)*Pe.extent),Ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:fe,y:Ce,z:re,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<te.length;ye++){Ge.numFeatures++,sl(Ge,te[ye],qe,Pe);var Ze=te[ye].minX,$e=te[ye].minY,Mt=te[ye].maxX,It=te[ye].maxY;Ze<Ge.minX&&(Ge.minX=Ze),$e<Ge.minY&&(Ge.minY=$e),Mt>Ge.maxX&&(Ge.maxX=Mt),It>Ge.maxY&&(Ge.maxY=It)}return Ge}function sl(te,re,fe,Ce){var Pe=re.geometry,qe=re.type,Ge=[];if("Point"===qe||"MultiPoint"===qe)for(var ye=0;ye<Pe.length;ye+=3)Ge.push(Pe[ye]),Ge.push(Pe[ye+1]),te.numPoints++,te.numSimplified++;else if("LineString"===qe)Ca(Ge,Pe,te,fe,!1,!1);else if("MultiLineString"===qe||"Polygon"===qe)for(ye=0;ye<Pe.length;ye++)Ca(Ge,Pe[ye],te,fe,"Polygon"===qe,0===ye);else if("MultiPolygon"===qe)for(var Ze=0;Ze<Pe.length;Ze++){var $e=Pe[Ze];for(ye=0;ye<$e.length;ye++)Ca(Ge,$e[ye],te,fe,!0,0===ye)}if(Ge.length){var Mt=re.tags||null;if("LineString"===qe&&Ce.lineMetrics){for(var It in Mt={},re.tags)Mt[It]=re.tags[It];Mt.mapbox_clip_start=Pe.start/Pe.size,Mt.mapbox_clip_end=Pe.end/Pe.size}var ht={geometry:Ge,type:"Polygon"===qe||"MultiPolygon"===qe?3:"LineString"===qe||"MultiLineString"===qe?2:1,tags:Mt};null!==re.id&&(ht.id=re.id),te.features.push(ht)}}function Ca(te,re,fe,Ce,Pe,qe){var Ge=Ce*Ce;if(Ce>0&&re.size<(Pe?Ge:Ce))fe.numPoints+=re.length/3;else{for(var ye=[],Ze=0;Ze<re.length;Ze+=3)(0===Ce||re[Ze+2]>Ge)&&(fe.numSimplified++,ye.push(re[Ze]),ye.push(re[Ze+1])),fe.numPoints++;Pe&&function($e,Mt){for(var It=0,ht=0,At=$e.length,sn=At-2;ht<At;sn=ht,ht+=2)It+=($e[ht]-$e[sn])*($e[ht+1]+$e[sn+1]);if(It>0===Mt)for(ht=0,At=$e.length;ht<At/2;ht+=2){var an=$e[ht],ft=$e[ht+1];$e[ht]=$e[At-2-ht],$e[ht+1]=$e[At-1-ht],$e[At-2-ht]=an,$e[At-1-ht]=ft}}(ye,qe),te.push(ye)}}function qr(te,re){var fe=(re=this.options=function(Pe,qe){for(var Ge in qe)Pe[Ge]=qe[Ge];return Pe}(Object.create(this.options),re)).debug;if(fe&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");var Pe,qe,Ge,ye,Ze,$e,Ce=function(Pe,qe){var Ge=[];if("FeatureCollection"===Pe.type)for(var ye=0;ye<Pe.features.length;ye++)Di(Ge,Pe.features[ye],qe,ye);else Di(Ge,"Feature"===Pe.type?Pe:{geometry:Pe},qe);return Ge}(te,re);this.tiles={},this.tileCoords=[],fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Pe=Ce,qe=re,Ge=qe.buffer/qe.extent,ye=Pe,Ze=Oo(Pe,1,-1-Ge,Ge,0,-1,2,qe),$e=Oo(Pe,1,1-Ge,2+Ge,0,-1,2,qe),(Ze||$e)&&(ye=Oo(Pe,1,-Ge,1+Ge,0,-1,2,qe)||[],Ze&&(ye=xa(Ze,1).concat(ye)),$e&&(ye=ye.concat(xa($e,-1)))),Ce=ye).length&&this.splitTile(Ce,0,0,0),fe&&(Ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ra(te,re,fe){return 32*((1<<te)*fe+re)+te}function Ri(te,re){var fe=te.tileID.canonical;if(!this._geoJSONIndex)return re(null,null);var Ce=this._geoJSONIndex.getTile(fe.z,fe.x,fe.y);if(!Ce)return re(null,null);var Pe=new de(Ce.features),qe=Ie(Pe);0===qe.byteOffset&&qe.byteLength===qe.buffer.byteLength||(qe=new Uint8Array(qe)),re(null,{vectorTile:Pe,rawData:qe.buffer})}Pn.prototype.load=function(te){var re=this.options,fe=re.log,Ce=re.minZoom,Pe=re.maxZoom,qe=re.nodeSize;fe&&console.time("total time");var Ge="prepare "+te.length+" points";fe&&console.time(Ge),this.points=te;for(var ye=[],Ze=0;Ze<te.length;Ze++)te[Ze].geometry&&ye.push(at(te[Ze],Ze));this.trees[Pe+1]=new Nt(ye,$n,pn,qe,Float32Array),fe&&console.timeEnd(Ge);for(var $e=Pe;$e>=Ce;$e--){var Mt=+Date.now();ye=this._cluster(ye,$e),this.trees[$e]=new Nt(ye,$n,pn,qe,Float32Array),fe&&console.log("z%d: %d clusters in %dms",$e,ye.length,+Date.now()-Mt)}return fe&&console.timeEnd("total time"),this},Pn.prototype.getClusters=function(te,re){var fe=((te[0]+180)%360+360)%360-180,Ce=Math.max(-90,Math.min(90,te[1])),Pe=180===te[2]?180:((te[2]+180)%360+360)%360-180,qe=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)fe=-180,Pe=180;else if(fe>Pe){var Ge=this.getClusters([fe,Ce,180,qe],re),ye=this.getClusters([-180,Ce,Pe,qe],re);return Ge.concat(ye)}for(var Ze=this.trees[this._limitZoom(re)],$e=[],Mt=0,It=Ze.range(_n(fe),Lt(qe),_n(Pe),Lt(Ce));Mt<It.length;Mt+=1){var ht=Ze.points[It[Mt]];$e.push(ht.numPoints?kt(ht):this.points[ht.index])}return $e},Pn.prototype.getChildren=function(te){var re=this._getOriginId(te),fe=this._getOriginZoom(te),Ce="No cluster with the specified id.",Pe=this.trees[fe];if(!Pe)throw new Error(Ce);var qe=Pe.points[re];if(!qe)throw new Error(Ce);for(var Ge=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),ye=[],Ze=0,$e=Pe.within(qe.x,qe.y,Ge);Ze<$e.length;Ze+=1){var Mt=Pe.points[$e[Ze]];Mt.parentId===te&&ye.push(Mt.numPoints?kt(Mt):this.points[Mt.index])}if(0===ye.length)throw new Error(Ce);return ye},Pn.prototype.getLeaves=function(te,re,fe){var Ce=[];return this._appendLeaves(Ce,te,re=re||10,fe=fe||0,0),Ce},Pn.prototype.getTile=function(te,re,fe){var Ce=this.trees[this._limitZoom(te)],Pe=Math.pow(2,te),qe=this.options,Ge=qe.radius/qe.extent,ye=(fe-Ge)/Pe,Ze=(fe+1+Ge)/Pe,$e={features:[]};return this._addTileFeatures(Ce.range((re-Ge)/Pe,ye,(re+1+Ge)/Pe,Ze),Ce.points,re,fe,Pe,$e),0===re&&this._addTileFeatures(Ce.range(1-Ge/Pe,ye,1,Ze),Ce.points,Pe,fe,Pe,$e),re===Pe-1&&this._addTileFeatures(Ce.range(0,ye,Ge/Pe,Ze),Ce.points,-1,fe,Pe,$e),$e.features.length?$e:null},Pn.prototype.getClusterExpansionZoom=function(te){for(var re=this._getOriginZoom(te)-1;re<=this.options.maxZoom;){var fe=this.getChildren(te);if(re++,1!==fe.length)break;te=fe[0].properties.cluster_id}return re},Pn.prototype._appendLeaves=function(te,re,fe,Ce,Pe){for(var qe=0,Ge=this.getChildren(re);qe<Ge.length;qe+=1){var ye=Ge[qe],Ze=ye.properties;if(Ze&&Ze.cluster?Pe+Ze.point_count<=Ce?Pe+=Ze.point_count:Pe=this._appendLeaves(te,Ze.cluster_id,fe,Ce,Pe):Pe<Ce?Pe++:te.push(ye),te.length===fe)break}return Pe},Pn.prototype._addTileFeatures=function(te,re,fe,Ce,Pe,qe){for(var Ge=0,ye=te;Ge<ye.length;Ge+=1){var Ze=re[ye[Ge]],$e=Ze.numPoints,Mt={type:1,geometry:[[Math.round(this.options.extent*(Ze.x*Pe-fe)),Math.round(this.options.extent*(Ze.y*Pe-Ce))]],tags:$e?$t(Ze):this.points[Ze.index].properties},It=void 0;$e?It=Ze.id:this.options.generateId?It=Ze.index:this.points[Ze.index].id&&(It=this.points[Ze.index].id),void 0!==It&&(Mt.id=It),qe.features.push(Mt)}},Pn.prototype._limitZoom=function(te){return Math.max(this.options.minZoom,Math.min(+te,this.options.maxZoom+1))},Pn.prototype._cluster=function(te,re){for(var fe=[],Ce=this.options,Pe=Ce.reduce,qe=Ce.minPoints,Ge=Ce.radius/(Ce.extent*Math.pow(2,re)),ye=0;ye<te.length;ye++){var Ze=te[ye];if(!(Ze.zoom<=re)){Ze.zoom=re;for(var $e=this.trees[re+1],Mt=$e.within(Ze.x,Ze.y,Ge),It=Ze.numPoints||1,ht=It,At=0,sn=Mt;At<sn.length;At+=1){var an=$e.points[sn[At]];an.zoom>re&&(ht+=an.numPoints||1)}if(ht>=qe){for(var ft=Ze.x*It,Qt=Ze.y*It,Jt=Pe&&It>1?this._map(Ze,!0):null,Yt=(ye<<5)+(re+1)+this.points.length,Gn=0,Wt=Mt;Gn<Wt.length;Gn+=1){var li=$e.points[Wt[Gn]];if(!(li.zoom<=re)){li.zoom=re;var zi=li.numPoints||1;ft+=li.x*zi,Qt+=li.y*zi,li.parentId=Yt,Pe&&(Jt||(Jt=this._map(Ze,!0)),Pe(Jt,this._map(li)))}}Ze.parentId=Yt,fe.push(st(ft/ht,Qt/ht,Yt,ht,Jt))}else if(fe.push(Ze),ht>1)for(var zn=0,vi=Mt;zn<vi.length;zn+=1){var ri=$e.points[vi[zn]];ri.zoom<=re||(ri.zoom=re,fe.push(ri))}}}return fe},Pn.prototype._getOriginId=function(te){return te-this.points.length>>5},Pn.prototype._getOriginZoom=function(te){return(te-this.points.length)%32},Pn.prototype._map=function(te,re){if(te.numPoints)return re?gn({},te.properties):te.properties;var fe=this.points[te.index].properties,Ce=this.options.map(fe);return re&&Ce===fe?gn({},Ce):Ce},qr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qr.prototype.splitTile=function(te,re,fe,Ce,Pe,qe,Ge){for(var ye=[te,re,fe,Ce],Ze=this.options,$e=Ze.debug;ye.length;){Ce=ye.pop(),fe=ye.pop(),re=ye.pop(),te=ye.pop();var Mt=1<<re,It=Ra(re,fe,Ce),ht=this.tiles[It];if(!ht&&($e>1&&console.time("creation"),ht=this.tiles[It]=br(te,re,fe,Ce,Ze),this.tileCoords.push({z:re,x:fe,y:Ce}),$e)){$e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,fe,Ce,ht.numFeatures,ht.numPoints,ht.numSimplified),console.timeEnd("creation"));var At="z"+re;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(ht.source=te,Pe){if(re===Ze.maxZoom||re===Pe)continue;var sn=1<<Pe-re;if(fe!==Math.floor(qe/sn)||Ce!==Math.floor(Ge/sn))continue}else if(re===Ze.indexMaxZoom||ht.numPoints<=Ze.indexMaxPoints)continue;if(ht.source=null,0!==te.length){$e>1&&console.time("clipping");var an,ft,Qt,Jt,Yt,Gn,Wt=.5*Ze.buffer/Ze.extent,li=.5-Wt,zi=.5+Wt,zn=1+Wt;an=ft=Qt=Jt=null,Yt=Oo(te,Mt,fe-Wt,fe+zi,0,ht.minX,ht.maxX,Ze),Gn=Oo(te,Mt,fe+li,fe+zn,0,ht.minX,ht.maxX,Ze),te=null,Yt&&(an=Oo(Yt,Mt,Ce-Wt,Ce+zi,1,ht.minY,ht.maxY,Ze),ft=Oo(Yt,Mt,Ce+li,Ce+zn,1,ht.minY,ht.maxY,Ze),Yt=null),Gn&&(Qt=Oo(Gn,Mt,Ce-Wt,Ce+zi,1,ht.minY,ht.maxY,Ze),Jt=Oo(Gn,Mt,Ce+li,Ce+zn,1,ht.minY,ht.maxY,Ze),Gn=null),$e>1&&console.timeEnd("clipping"),ye.push(an||[],re+1,2*fe,2*Ce),ye.push(ft||[],re+1,2*fe,2*Ce+1),ye.push(Qt||[],re+1,2*fe+1,2*Ce),ye.push(Jt||[],re+1,2*fe+1,2*Ce+1)}}},qr.prototype.getTile=function(te,re,fe){var Ce=this.options,Pe=Ce.extent,qe=Ce.debug;if(te<0||te>24)return null;var Ge=1<<te,ye=Ra(te,re=(re%Ge+Ge)%Ge,fe);if(this.tiles[ye])return Eo(this.tiles[ye],Pe);qe>1&&console.log("drilling down to z%d-%d-%d",te,re,fe);for(var Ze,$e=te,Mt=re,It=fe;!Ze&&$e>0;)$e--,Mt=Math.floor(Mt/2),It=Math.floor(It/2),Ze=this.tiles[Ra($e,Mt,It)];return Ze&&Ze.source?(qe>1&&console.log("found parent tile z%d-%d-%d",$e,Mt,It),qe>1&&console.time("drilling down"),this.splitTile(Ze.source,$e,Mt,It,te,re,fe),qe>1&&console.timeEnd("drilling down"),this.tiles[ye]?Eo(this.tiles[ye],Pe):null):null};var Fs=function(te){function re(fe,Ce,Pe,qe){te.call(this,fe,Ce,Pe,Ri),qe&&(this.loadGeoJSON=qe)}return te&&(re.__proto__=te),(re.prototype=Object.create(te&&te.prototype)).constructor=re,re.prototype.loadData=function(fe,Ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Ce,this._pendingLoadDataParams=fe,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},re.prototype._loadData=function(){var fe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Ce=this._pendingCallback,Pe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var qe=!!(Pe&&Pe.request&&Pe.request.collectResourceTiming)&&new d.RequestPerformance(Pe.request);this.loadGeoJSON(Pe,function(Ge,ye){if(Ge||!ye)return Ce(Ge);if("object"!=typeof ye)return Ce(new Error("Input data given to '"+Pe.source+"' is not a valid GeoJSON object."));!function ht(At,sn){var an,ft=At&&At.type;if("FeatureCollection"===ft)for(an=0;an<At.features.length;an++)ht(At.features[an],sn);else if("GeometryCollection"===ft)for(an=0;an<At.geometries.length;an++)ht(At.geometries[an],sn);else if("Feature"===ft)ht(At.geometry,sn);else if("Polygon"===ft)Q(At.coordinates,sn);else if("MultiPolygon"===ft)for(an=0;an<At.coordinates.length;an++)Q(At.coordinates[an],sn);return At}(ye,!0);try{if(Pe.filter){var Ze=d.createExpression(Pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ze.result)throw new Error(Ze.value.map(function(ht){return ht.key+": "+ht.message}).join(", "));var $e=ye.features.filter(function(ht){return Ze.value.evaluate({zoom:0},ht)});ye={type:"FeatureCollection",features:$e}}fe._geoJSONIndex=Pe.cluster?new Pn(function(ht){var At=ht.superclusterOptions,sn=ht.clusterProperties;if(!sn||!At)return At;for(var an={},ft={},Qt={accumulated:null,zoom:0},Jt={properties:null},Yt=Object.keys(sn),Gn=0,Wt=Yt;Gn<Wt.length;Gn+=1){var li=Wt[Gn],zi=sn[li],zn=zi[0],vi=d.createExpression(zi[1]),ri=d.createExpression("string"==typeof zn?[zn,["accumulated"],["get",li]]:zn);an[li]=vi.value,ft[li]=ri.value}return At.map=function(jo){Jt.properties=jo;for(var Ci={},eo=0,Oi=Yt;eo<Oi.length;eo+=1){var Zn=Oi[eo];Ci[Zn]=an[Zn].evaluate(Qt,Jt)}return Ci},At.reduce=function(jo,Ci){Jt.properties=Ci;for(var eo=0,Oi=Yt;eo<Oi.length;eo+=1){var Zn=Oi[eo];Qt.accumulated=jo[Zn],jo[Zn]=ft[Zn].evaluate(Qt,Jt)}},At}(Pe)).load(ye.features):new qr(ht=ye,Pe.geojsonVtOptions)}catch(ht){return Ce(ht)}var ht;fe.loaded={};var Mt={};if(qe){var It=qe.finish();It&&(Mt.resourceTiming={},Mt.resourceTiming[Pe.source]=JSON.parse(JSON.stringify(It)))}Ce(null,Mt)})}},re.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},re.prototype.reloadTile=function(fe,Ce){var Pe=this.loaded;return Pe&&Pe[fe.uid]?te.prototype.reloadTile.call(this,fe,Ce):this.loadTile(fe,Ce)},re.prototype.loadGeoJSON=function(fe,Ce){if(fe.request)d.getJSON(fe.request,Ce);else{if("string"!=typeof fe.data)return Ce(new Error("Input data given to '"+fe.source+"' is not a valid GeoJSON object."));try{return Ce(null,JSON.parse(fe.data))}catch{return Ce(new Error("Input data given to '"+fe.source+"' is not a valid GeoJSON object."))}}},re.prototype.removeSource=function(fe,Ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Ce()},re.prototype.getClusterExpansionZoom=function(fe,Ce){try{Ce(null,this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId))}catch(Pe){Ce(Pe)}},re.prototype.getClusterChildren=function(fe,Ce){try{Ce(null,this._geoJSONIndex.getChildren(fe.clusterId))}catch(Pe){Ce(Pe)}},re.prototype.getClusterLeaves=function(fe,Ce){try{Ce(null,this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset))}catch(Pe){Ce(Pe)}},re}(A),qi=function(te){var re=this;this.self=te,this.actor=new d.Actor(te,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:A,geojson:Fs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(fe,Ce){if(re.workerSourceTypes[fe])throw new Error('Worker source with name "'+fe+'" already registered.');re.workerSourceTypes[fe]=Ce},this.self.registerRTLTextPlugin=function(fe){if(d.plugin.isParsed())throw new Error("RTL text plugin already registered.");d.plugin.applyArabicShaping=fe.applyArabicShaping,d.plugin.processBidirectionalText=fe.processBidirectionalText,d.plugin.processStyledBidirectionalText=fe.processStyledBidirectionalText}};return qi.prototype.setReferrer=function(te,re){this.referrer=re},qi.prototype.setImages=function(te,re,fe){for(var Ce in this.availableImages[te]=re,this.workerSources[te]){var Pe=this.workerSources[te][Ce];for(var qe in Pe)Pe[qe].availableImages=re}fe()},qi.prototype.setLayers=function(te,re,fe){this.getLayerIndex(te).replace(re),fe()},qi.prototype.updateLayers=function(te,re,fe){this.getLayerIndex(te).update(re.layers,re.removedIds),fe()},qi.prototype.loadTile=function(te,re,fe){this.getWorkerSource(te,re.type,re.source).loadTile(re,fe)},qi.prototype.loadDEMTile=function(te,re,fe){this.getDEMWorkerSource(te,re.source).loadTile(re,fe)},qi.prototype.reloadTile=function(te,re,fe){this.getWorkerSource(te,re.type,re.source).reloadTile(re,fe)},qi.prototype.abortTile=function(te,re,fe){this.getWorkerSource(te,re.type,re.source).abortTile(re,fe)},qi.prototype.removeTile=function(te,re,fe){this.getWorkerSource(te,re.type,re.source).removeTile(re,fe)},qi.prototype.removeDEMTile=function(te,re){this.getDEMWorkerSource(te,re.source).removeTile(re)},qi.prototype.removeSource=function(te,re,fe){if(this.workerSources[te]&&this.workerSources[te][re.type]&&this.workerSources[te][re.type][re.source]){var Ce=this.workerSources[te][re.type][re.source];delete this.workerSources[te][re.type][re.source],void 0!==Ce.removeSource?Ce.removeSource(re,fe):fe()}},qi.prototype.loadWorkerSource=function(te,re,fe){try{this.self.importScripts(re.url),fe()}catch(Ce){fe(Ce.toString())}},qi.prototype.syncRTLPluginState=function(te,re,fe){try{d.plugin.setState(re);var Ce=d.plugin.getPluginURL();if(d.plugin.isLoaded()&&!d.plugin.isParsed()&&null!=Ce){this.self.importScripts(Ce);var Pe=d.plugin.isParsed();fe(Pe?void 0:new Error("RTL Text Plugin failed to import scripts from "+Ce),Pe)}}catch(qe){fe(qe.toString())}},qi.prototype.getAvailableImages=function(te){var re=this.availableImages[te];return re||(re=[]),re},qi.prototype.getLayerIndex=function(te){var re=this.layerIndexes[te];return re||(re=this.layerIndexes[te]=new y),re},qi.prototype.getWorkerSource=function(te,re,fe){var Ce=this;return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][re]||(this.workerSources[te][re]={}),this.workerSources[te][re][fe]||(this.workerSources[te][re][fe]=new this.workerSourceTypes[re]({send:function(Pe,qe,Ge){Ce.actor.send(Pe,qe,Ge,te)}},this.getLayerIndex(te),this.getAvailableImages(te))),this.workerSources[te][re][fe]},qi.prototype.getDEMWorkerSource=function(te,re){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][re]||(this.demWorkerSources[te][re]=new U),this.demWorkerSources[te][re]},qi.prototype.enforceCacheSizeLimit=function(te,re){d.enforceCacheSizeLimit(re)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new qi(self)),qi}),D(0,function(d){var T=d.createCommonjsModule(function(u){function h(x){return!p(x)}function p(x){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,J,K=new Blob([""],{type:"text/javascript"}),ne=URL.createObjectURL(K);try{J=new Worker(ne),L=!0}catch{L=!1}return J&&J.terminate(),URL.revokeObjectURL(ne),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var J=L.getContext("2d");if(!J)return!1;var K=J.getImageData(0,0,1,1);return K&&K.width===L.width}()?(void 0===g[k=x&&x.failIfMajorPerformanceCaveat]&&(g[k]=function(L){var ne,_e,ve,J=(ne=L,_e=document.createElement("canvas"),(ve=Object.create(h.webGLContextAttributes)).failIfMajorPerformanceCaveat=ne,_e.probablySupportsContext?_e.probablySupportsContext("webgl",ve)||_e.probablySupportsContext("experimental-webgl",ve):_e.supportsContext?_e.supportsContext("webgl",ve)||_e.supportsContext("experimental-webgl",ve):_e.getContext("webgl",ve)||_e.getContext("experimental-webgl",ve));if(!J)return!1;var K=J.createShader(J.VERTEX_SHADER);return!(!K||J.isContextLost())&&(J.shaderSource(K,"void main() {}"),J.compileShader(K),!0===J.getShaderParameter(K,J.COMPILE_STATUS))}(k)),g[k]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var k}u.exports?u.exports=h:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=h,window.mapboxgl.notSupportedReason=p);var g={};h.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),w={create:function(u,h,p){var g=d.window.document.createElement(u);return void 0!==h&&(g.className=h),p&&p.appendChild(g),g},createNS:function(u,h){return d.window.document.createElementNS(u,h)}},y=d.window.document&&d.window.document.documentElement.style;function S(u){if(!y)return u[0];for(var h=0;h<u.length;h++)if(u[h]in y)return u[h];return u[0]}var P,E=S(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);w.disableDrag=function(){y&&E&&(P=y[E],y[E]="none")},w.enableDrag=function(){y&&E&&(y[E]=P)};var Z=S(["transform","WebkitTransform"]);w.setTransform=function(u,h){u.style[Z]=h};var A=!1;try{var I=Object.defineProperty({},"passive",{get:function(){A=!0}});d.window.addEventListener("test",I,I),d.window.removeEventListener("test",I,I)}catch{A=!1}w.addEventListener=function(u,h,p,g){void 0===g&&(g={}),u.addEventListener(h,p,"passive"in g&&A?g:g.capture)},w.removeEventListener=function(u,h,p,g){void 0===g&&(g={}),u.removeEventListener(h,p,"passive"in g&&A?g:g.capture)};var U=function(u){u.preventDefault(),u.stopPropagation(),d.window.removeEventListener("click",U,!0)};function Q(u){var h=u.userImage;return!!(h&&h.render&&h.render())&&(u.data.replace(new Uint8Array(h.data.buffer)),!0)}w.suppressClick=function(){d.window.addEventListener("click",U,!0),d.window.setTimeout(function(){d.window.removeEventListener("click",U,!0)},0)},w.mousePos=function(u,h){var p=u.getBoundingClientRect();return new d.Point(h.clientX-p.left-u.clientLeft,h.clientY-p.top-u.clientTop)},w.touchPos=function(u,h){for(var p=u.getBoundingClientRect(),g=[],x=0;x<h.length;x++)g.push(new d.Point(h[x].clientX-p.left-u.clientLeft,h[x].clientY-p.top-u.clientTop));return g},w.mouseButton=function(u){return void 0!==d.window.InstallTrigger&&2===u.button&&u.ctrlKey&&d.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button},w.remove=function(u){u.parentNode&&u.parentNode.removeChild(u)};var W=function(u){function h(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.RGBAImage({width:1,height:1}),this.dirty=!0}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.isLoaded=function(){return this.loaded},h.prototype.setLoaded=function(p){if(this.loaded!==p&&(this.loaded=p,p)){for(var g=0,x=this.requestors;g<x.length;g+=1){var k=x[g];this._notify(k.ids,k.callback)}this.requestors=[]}},h.prototype.getImage=function(p){return this.images[p]},h.prototype.addImage=function(p,g){this._validate(p,g)&&(this.images[p]=g)},h.prototype._validate=function(p,g){var x=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new d.ErrorEvent(new Error('Image "'+p+'" has invalid "stretchX" value'))),x=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new d.ErrorEvent(new Error('Image "'+p+'" has invalid "stretchY" value'))),x=!1),this._validateContent(g.content,g)||(this.fire(new d.ErrorEvent(new Error('Image "'+p+'" has invalid "content" value'))),x=!1),x},h.prototype._validateStretch=function(p,g){if(!p)return!0;for(var x=0,k=0,L=p;k<L.length;k+=1){var J=L[k];if(J[0]<x||J[1]<J[0]||g<J[1])return!1;x=J[1]}return!0},h.prototype._validateContent=function(p,g){return!(p&&(4!==p.length||p[0]<0||g.data.width<p[0]||p[1]<0||g.data.height<p[1]||p[2]<0||g.data.width<p[2]||p[3]<0||g.data.height<p[3]||p[2]<p[0]||p[3]<p[1]))},h.prototype.updateImage=function(p,g){g.version=this.images[p].version+1,this.images[p]=g,this.updatedImages[p]=!0},h.prototype.removeImage=function(p){var g=this.images[p];delete this.images[p],delete this.patterns[p],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()},h.prototype.listImages=function(){return Object.keys(this.images)},h.prototype.getImages=function(p,g){var x=!0;if(!this.isLoaded())for(var k=0,L=p;k<L.length;k+=1)this.images[L[k]]||(x=!1);this.isLoaded()||x?this._notify(p,g):this.requestors.push({ids:p,callback:g})},h.prototype._notify=function(p,g){for(var x={},k=0,L=p;k<L.length;k+=1){var J=L[k];this.images[J]||this.fire(new d.Event("styleimagemissing",{id:J}));var K=this.images[J];K?x[J]={data:K.data.clone(),pixelRatio:K.pixelRatio,sdf:K.sdf,version:K.version,stretchX:K.stretchX,stretchY:K.stretchY,content:K.content,hasRenderCallback:Boolean(K.userImage&&K.userImage.render)}:d.warnOnce('Image "'+J+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}g(null,x)},h.prototype.getPixelSize=function(){var p=this.atlasImage;return{width:p.width,height:p.height}},h.prototype.getPattern=function(p){var g=this.patterns[p],x=this.getImage(p);if(!x)return null;if(g&&g.position.version===x.version)return g.position;if(g)g.position.version=x.version;else{var k={w:x.data.width+2,h:x.data.height+2,x:0,y:0},L=new d.ImagePosition(k,x);this.patterns[p]={bin:k,position:L}}return this._updatePatternAtlas(),this.patterns[p].position},h.prototype.bind=function(p){var g=p.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new d.Texture(p,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)},h.prototype._updatePatternAtlas=function(){var p=[];for(var g in this.patterns)p.push(this.patterns[g].bin);var x=d.potpack(p),k=x.w,L=x.h,J=this.atlasImage;for(var K in J.resize({width:k||1,height:L||1}),this.patterns){var ne=this.patterns[K].bin,_e=ne.x+1,ve=ne.y+1,be=this.images[K].data,Ee=be.width,Oe=be.height;d.RGBAImage.copy(be,J,{x:0,y:0},{x:_e,y:ve},{width:Ee,height:Oe}),d.RGBAImage.copy(be,J,{x:0,y:Oe-1},{x:_e,y:ve-1},{width:Ee,height:1}),d.RGBAImage.copy(be,J,{x:0,y:0},{x:_e,y:ve+Oe},{width:Ee,height:1}),d.RGBAImage.copy(be,J,{x:Ee-1,y:0},{x:_e-1,y:ve},{width:1,height:Oe}),d.RGBAImage.copy(be,J,{x:0,y:0},{x:_e+Ee,y:ve},{width:1,height:Oe})}this.dirty=!0},h.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},h.prototype.dispatchRenderCallbacks=function(p){for(var g=0,x=p;g<x.length;g+=1){var k=x[g];if(!this.callbackDispatchedThisFrame[k]){this.callbackDispatchedThisFrame[k]=!0;var L=this.images[k];Q(L)&&this.updateImage(k,L)}}},h}(d.Evented),le=he,e=he,de=1e20;function he(u,h,p,g,x,k){this.fontSize=u||24,this.buffer=void 0===h?3:h,this.cutoff=g||.25,this.fontFamily=x||"sans-serif",this.fontWeight=k||"normal",this.radius=p||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ke(u,h,p,g,x,k,L){for(var J=0;J<h;J++){for(var K=0;K<p;K++)g[K]=u[K*h+J];for(Le(g,x,k,L,p),K=0;K<p;K++)u[K*h+J]=x[K]}for(K=0;K<p;K++){for(J=0;J<h;J++)g[J]=u[K*h+J];for(Le(g,x,k,L,h),J=0;J<h;J++)u[K*h+J]=Math.sqrt(x[J])}}function Le(u,h,p,g,x){p[0]=0,g[0]=-de,g[1]=+de;for(var k=1,L=0;k<x;k++){for(var J=(u[k]+k*k-(u[p[L]]+p[L]*p[L]))/(2*k-2*p[L]);J<=g[L];)L--,J=(u[k]+k*k-(u[p[L]]+p[L]*p[L]))/(2*k-2*p[L]);p[++L]=k,g[L]=J,g[L+1]=+de}for(k=0,L=0;k<x;k++){for(;g[L+1]<k;)L++;h[k]=(k-p[L])*(k-p[L])+u[p[L]]}}he.prototype.draw=function(u){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(u,this.buffer,this.middle);for(var h=this.ctx.getImageData(0,0,this.size,this.size),p=new Uint8ClampedArray(this.size*this.size),g=0;g<this.size*this.size;g++){var x=h.data[4*g+3]/255;this.gridOuter[g]=1===x?0:0===x?de:Math.pow(Math.max(0,.5-x),2),this.gridInner[g]=1===x?de:0===x?0:Math.pow(Math.max(0,x-.5),2)}for(ke(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ke(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),g=0;g<this.size*this.size;g++)p[g]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[g]-this.gridInner[g])/this.radius+this.cutoff))));return p},le.default=e;var Ue=function(u,h){this.requestManager=u,this.localIdeographFontFamily=h,this.entries={}};Ue.prototype.setURL=function(u){this.url=u},Ue.prototype.getGlyphs=function(u,h){var p=this,g=[];for(var x in u)for(var k=0,L=u[x];k<L.length;k+=1)g.push({stack:x,id:L[k]});d.asyncAll(g,function(J,K){var ne=J.stack,_e=J.id,ve=p.entries[ne];ve||(ve=p.entries[ne]={glyphs:{},requests:{},ranges:{}});var be=ve.glyphs[_e];if(void 0===be){if(be=p._tinySDF(ve,ne,_e))return ve.glyphs[_e]=be,void K(null,{stack:ne,id:_e,glyph:be});var Ee=Math.floor(_e/256);if(256*Ee>65535)K(new Error("glyphs > 65535 not supported"));else if(ve.ranges[Ee])K(null,{stack:ne,id:_e,glyph:be});else{var Oe=ve.requests[Ee];Oe||(Oe=ve.requests[Ee]=[],Ue.loadGlyphRange(ne,Ee,p.url,p.requestManager,function(Re,Se){if(Se){for(var De in Se)p._doesCharSupportLocalGlyph(+De)||(ve.glyphs[+De]=Se[+De]);ve.ranges[Ee]=!0}for(var Be=0,Xe=Oe;Be<Xe.length;Be+=1)(0,Xe[Be])(Re,Se);delete ve.requests[Ee]})),Oe.push(function(Re,Se){Re?K(Re):Se&&K(null,{stack:ne,id:_e,glyph:Se[_e]||null})})}}else K(null,{stack:ne,id:_e,glyph:be})},function(J,K){if(J)h(J);else if(K){for(var ne={},_e=0,ve=K;_e<ve.length;_e+=1){var be=ve[_e],Ee=be.stack,Oe=be.id,Re=be.glyph;(ne[Ee]||(ne[Ee]={}))[Oe]=Re&&{id:Re.id,bitmap:Re.bitmap.clone(),metrics:Re.metrics}}h(null,ne)}})},Ue.prototype._doesCharSupportLocalGlyph=function(u){return!!this.localIdeographFontFamily&&(d.isChar["CJK Unified Ideographs"](u)||d.isChar["Hangul Syllables"](u)||d.isChar.Hiragana(u)||d.isChar.Katakana(u))},Ue.prototype._tinySDF=function(u,h,p){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(p)){var x=u.tinySDF;if(!x){var k="400";/bold/i.test(h)?k="900":/medium/i.test(h)?k="500":/light/i.test(h)&&(k="200"),x=u.tinySDF=new Ue.TinySDF(24,3,8,.25,g,k)}return{id:p,bitmap:new d.AlphaImage({width:30,height:30},x.draw(String.fromCharCode(p))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ue.loadGlyphRange=function(u,h,p,g,x){var k=256*h,L=k+255,J=g.transformRequest(g.normalizeGlyphsURL(p).replace("{fontstack}",u).replace("{range}",k+"-"+L),d.ResourceType.Glyphs);d.getArrayBuffer(J,function(K,ne){if(K)x(K);else if(ne){for(var _e={},ve=0,be=d.parseGlyphPBF(ne);ve<be.length;ve+=1){var Ee=be[ve];_e[Ee.id]=Ee}x(null,_e)}})},Ue.TinySDF=le;var Ie=function(){this.specification=d.styleSpec.light.position};Ie.prototype.possiblyEvaluate=function(u,h){return d.sphericalToCartesian(u.expression.evaluate(h))},Ie.prototype.interpolate=function(u,h,p){return{x:d.number(u.x,h.x,p),y:d.number(u.y,h.y,p),z:d.number(u.z,h.z,p)}};var je=new d.Properties({anchor:new d.DataConstantProperty(d.styleSpec.light.anchor),position:new Ie,color:new d.DataConstantProperty(d.styleSpec.light.color),intensity:new d.DataConstantProperty(d.styleSpec.light.intensity)}),X=function(u){function h(p){u.call(this),this._transitionable=new d.Transitionable(je),this.setLight(p),this._transitioning=this._transitionable.untransitioned()}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getLight=function(){return this._transitionable.serialize()},h.prototype.setLight=function(p,g){if(void 0===g&&(g={}),!this._validate(d.validateLight,p,g))for(var x in p){var k=p[x];d.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),k):this._transitionable.setValue(x,k)}},h.prototype.updateTransitions=function(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)},h.prototype.hasTransition=function(){return this._transitioning.hasTransition()},h.prototype.recalculate=function(p){this.properties=this._transitioning.possiblyEvaluate(p)},h.prototype._validate=function(p,g,x){return(!x||!1!==x.validate)&&d.emitValidationErrors(this,p.call(d.validateStyle,d.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:d.styleSpec})))},h}(d.Evented),ie=function(u,h){this.width=u,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ie.prototype.getDash=function(u,h){var p=u.join(",")+String(h);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(u,h)),this.dashEntry[p]},ie.prototype.getDashRanges=function(u,h,p){var g=[],x=u.length%2==1?-u[u.length-1]*p:0,k=u[0]*p,L=!0;g.push({left:x,right:k,isDash:L,zeroLength:0===u[0]});for(var J=u[0],K=1;K<u.length;K++){var ne=u[K];g.push({left:x=J*p,right:k=(J+=ne)*p,isDash:L=!L,zeroLength:0===ne})}return g},ie.prototype.addRoundDash=function(u,h,p){for(var g=h/2,x=-p;x<=p;x++)for(var k=this.width*(this.nextRow+p+x),L=0,J=u[L],K=0;K<this.width;K++){K/J.right>1&&(J=u[++L]);var ne=Math.abs(K-J.left),_e=Math.abs(K-J.right),ve=Math.min(ne,_e),be=void 0,Ee=x/p*(g+1);if(J.isDash){var Oe=g-Math.abs(Ee);be=Math.sqrt(ve*ve+Oe*Oe)}else be=g-Math.sqrt(ve*ve+Ee*Ee);this.data[k+K]=Math.max(0,Math.min(255,be+128))}},ie.prototype.addRegularDash=function(u){for(var h=u.length-1;h>=0;--h){var p=u[h],g=u[h+1];p.zeroLength?u.splice(h,1):g&&g.isDash===p.isDash&&(g.left=p.left,u.splice(h,1))}var x=u[0],k=u[u.length-1];x.isDash===k.isDash&&(x.left=k.left-this.width,k.right=x.right+this.width);for(var L=this.width*this.nextRow,J=0,K=u[J],ne=0;ne<this.width;ne++){ne/K.right>1&&(K=u[++J]);var _e=Math.abs(ne-K.left),ve=Math.abs(ne-K.right),be=Math.min(_e,ve);this.data[L+ne]=Math.max(0,Math.min(255,(K.isDash?be:-be)+128))}},ie.prototype.addDash=function(u,h){var p=h?7:0,g=2*p+1;if(this.nextRow+g>this.height)return d.warnOnce("LineAtlas out of space"),null;for(var x=0,k=0;k<u.length;k++)x+=u[k];if(0!==x){var L=this.width/x,J=this.getDashRanges(u,this.width,L);h?this.addRoundDash(J,L,p):this.addRegularDash(J)}var K={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:x};return this.nextRow+=g,this.dirty=!0,K},ie.prototype.bind=function(u){var h=u.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))};var oe=function u(h,p){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=d.uniqueId();for(var g=this.workerPool.acquire(this.id),x=0;x<g.length;x++){var k=new u.Actor(g[x],p,this.id);k.name="Worker "+x,this.actors.push(k)}};function ae(u,h,p){var g=function(x,k){if(x)return p(x);if(k){var L=d.pick(d.extend(k,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);k.vector_layers&&(L.vectorLayers=k.vector_layers,L.vectorLayerIds=L.vectorLayers.map(function(J){return J.id})),L.tiles=h.canonicalizeTileset(L,u.url),p(null,L)}};return u.url?d.getJSON(h.transformRequest(h.normalizeSourceURL(u.url),d.ResourceType.Source),g):d.browser.frame(function(){return g(null,u)})}oe.prototype.broadcast=function(u,h,p){d.asyncAll(this.actors,function(g,x){g.send(u,h,x)},p=p||function(){})},oe.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},oe.prototype.remove=function(){this.actors.forEach(function(u){u.remove()}),this.actors=[],this.workerPool.release(this.id)},oe.Actor=d.Actor;var pe=function(u,h,p){this.bounds=d.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=h||0,this.maxzoom=p||24};pe.prototype.validateBounds=function(u){return Array.isArray(u)&&4===u.length?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]},pe.prototype.contains=function(u){var h=Math.pow(2,u.z),p=Math.floor(d.mercatorXfromLng(this.bounds.getWest())*h),g=Math.floor(d.mercatorYfromLat(this.bounds.getNorth())*h),x=Math.ceil(d.mercatorXfromLng(this.bounds.getEast())*h),k=Math.ceil(d.mercatorYfromLat(this.bounds.getSouth())*h);return u.x>=p&&u.x<x&&u.y>=g&&u.y<k};var xe=function(u){function h(p,g,x,k){if(u.call(this),this.id=p,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.extend(this,d.pick(g,["url","scheme","tileSize","promoteId"])),this._options=d.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(k)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.load=function(){var p=this;this._loaded=!1,this.fire(new d.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ae(this._options,this.map._requestManager,function(g,x){p._tileJSONRequest=null,p._loaded=!0,g?p.fire(new d.ErrorEvent(g)):x&&(d.extend(p,x),x.bounds&&(p.tileBounds=new pe(x.bounds,p.minzoom,p.maxzoom)),d.postTurnstileEvent(x.tiles,p.map._requestManager._customAccessToken),d.postMapLoadEvent(x.tiles,p.map._getMapId(),p.map._requestManager._skuToken,p.map._requestManager._customAccessToken),p.fire(new d.Event("data",{dataType:"source",sourceDataType:"metadata"})),p.fire(new d.Event("data",{dataType:"source",sourceDataType:"content"})))})},h.prototype.loaded=function(){return this._loaded},h.prototype.hasTile=function(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)},h.prototype.onAdd=function(p){this.map=p,this.load()},h.prototype.setSourceProperty=function(p){this._tileJSONRequest&&this._tileJSONRequest.cancel(),p(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},h.prototype.setTiles=function(p){var g=this;return this.setSourceProperty(function(){g._options.tiles=p}),this},h.prototype.setUrl=function(p){var g=this;return this.setSourceProperty(function(){g.url=p,g._options.url=p}),this},h.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},h.prototype.serialize=function(){return d.extend({},this._options)},h.prototype.loadTile=function(p,g){var x=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),k={request:this.map._requestManager.transformRequest(x,d.ResourceType.Tile),uid:p.uid,tileID:p.tileID,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:d.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(J,K){return delete p.request,p.aborted?g(null):J&&404!==J.status?g(J):(K&&K.resourceTiming&&(p.resourceTiming=K.resourceTiming),this.map._refreshExpiredTiles&&K&&p.setExpiryData(K),p.loadVectorData(K,this.map.painter),d.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(p.reloadCallback&&(this.loadTile(p,p.reloadCallback),p.reloadCallback=null)))}k.request.collectResourceTiming=this._collectResourceTiming,p.actor&&"expired"!==p.state?"loading"===p.state?p.reloadCallback=g:p.request=p.actor.send("reloadTile",k,L.bind(this)):(p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",k,L.bind(this)))},h.prototype.abortTile=function(p){p.request&&(p.request.cancel(),delete p.request),p.actor&&p.actor.send("abortTile",{uid:p.uid,type:this.type,source:this.id},void 0)},h.prototype.unloadTile=function(p){p.unloadVectorData(),p.actor&&p.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id},void 0)},h.prototype.hasTransition=function(){return!1},h}(d.Evented),Ne=function(u){function h(p,g,x,k){u.call(this),this.id=p,this.dispatcher=x,this.setEventedParent(k),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.extend({type:"raster"},g),d.extend(this,d.pick(g,["url","scheme","tileSize"]))}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.load=function(){var p=this;this._loaded=!1,this.fire(new d.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ae(this._options,this.map._requestManager,function(g,x){p._tileJSONRequest=null,p._loaded=!0,g?p.fire(new d.ErrorEvent(g)):x&&(d.extend(p,x),x.bounds&&(p.tileBounds=new pe(x.bounds,p.minzoom,p.maxzoom)),d.postTurnstileEvent(x.tiles),d.postMapLoadEvent(x.tiles,p.map._getMapId(),p.map._requestManager._skuToken),p.fire(new d.Event("data",{dataType:"source",sourceDataType:"metadata"})),p.fire(new d.Event("data",{dataType:"source",sourceDataType:"content"})))})},h.prototype.loaded=function(){return this._loaded},h.prototype.onAdd=function(p){this.map=p,this.load()},h.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},h.prototype.serialize=function(){return d.extend({},this._options)},h.prototype.hasTile=function(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)},h.prototype.loadTile=function(p,g){var x=this,k=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);p.request=d.getImage(this.map._requestManager.transformRequest(k,d.ResourceType.Tile),function(L,J){if(delete p.request,p.aborted)p.state="unloaded",g(null);else if(L)p.state="errored",g(L);else if(J){x.map._refreshExpiredTiles&&p.setExpiryData(J),delete J.cacheControl,delete J.expires;var K=x.map.painter.context,ne=K.gl;p.texture=x.map.painter.getTileTexture(J.width),p.texture?p.texture.update(J,{useMipmap:!0}):(p.texture=new d.Texture(K,J,ne.RGBA,{useMipmap:!0}),p.texture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE,ne.LINEAR_MIPMAP_NEAREST),K.extTextureFilterAnisotropic&&ne.texParameterf(ne.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax)),p.state="loaded",d.cacheEntryPossiblyAdded(x.dispatcher),g(null)}})},h.prototype.abortTile=function(p,g){p.request&&(p.request.cancel(),delete p.request),g()},h.prototype.unloadTile=function(p,g){p.texture&&this.map.painter.saveTileTexture(p.texture),g()},h.prototype.hasTransition=function(){return!1},h}(d.Evented),we=function(u){function h(p,g,x,k){u.call(this,p,g,x,k),this.type="raster-dem",this.maxzoom=22,this._options=d.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},h.prototype.loadTile=function(p,g){var x=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function k(L,J){L&&(p.state="errored",g(L)),J&&(p.dem=J,p.needsHillshadePrepare=!0,p.state="loaded",g(null))}p.request=d.getImage(this.map._requestManager.transformRequest(x,d.ResourceType.Tile),function(L,J){if(delete p.request,p.aborted)p.state="unloaded",g(null);else if(L)p.state="errored",g(L);else if(J){this.map._refreshExpiredTiles&&p.setExpiryData(J),delete J.cacheControl,delete J.expires;var K=d.window.ImageBitmap&&J instanceof d.window.ImageBitmap&&d.offscreenCanvasSupported()?J:d.browser.getImageData(J,1),ne={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:K,encoding:this.encoding};p.actor&&"expired"!==p.state||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",ne,k.bind(this)))}}.bind(this)),p.neighboringTiles=this._getNeighboringTiles(p.tileID)},h.prototype._getNeighboringTiles=function(p){var g=p.canonical,x=Math.pow(2,g.z),k=(g.x-1+x)%x,L=0===g.x?p.wrap-1:p.wrap,J=(g.x+1+x)%x,K=g.x+1===x?p.wrap+1:p.wrap,ne={};return ne[new d.OverscaledTileID(p.overscaledZ,L,g.z,k,g.y).key]={backfilled:!1},ne[new d.OverscaledTileID(p.overscaledZ,K,g.z,J,g.y).key]={backfilled:!1},g.y>0&&(ne[new d.OverscaledTileID(p.overscaledZ,L,g.z,k,g.y-1).key]={backfilled:!1},ne[new d.OverscaledTileID(p.overscaledZ,p.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},ne[new d.OverscaledTileID(p.overscaledZ,K,g.z,J,g.y-1).key]={backfilled:!1}),g.y+1<x&&(ne[new d.OverscaledTileID(p.overscaledZ,L,g.z,k,g.y+1).key]={backfilled:!1},ne[new d.OverscaledTileID(p.overscaledZ,p.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},ne[new d.OverscaledTileID(p.overscaledZ,K,g.z,J,g.y+1).key]={backfilled:!1}),ne},h.prototype.unloadTile=function(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded",p.actor&&p.actor.send("removeDEMTile",{uid:p.uid,source:this.id})},h}(Ne),me=function(u){function h(p,g,x,k){u.call(this),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=x.getActor(),this.setEventedParent(k),this._data=g.data,this._options=d.extend({},g),this._collectResourceTiming=g.collectResourceTiming,this._resourceTiming=[],void 0!==g.maxzoom&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;var L=d.EXTENT/this.tileSize;this.workerOptions=d.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(void 0!==g.buffer?g.buffer:128)*L,tolerance:(void 0!==g.tolerance?g.tolerance:.375)*L,extent:d.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:void 0!==g.clusterMaxZoom?Math.min(g.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:d.EXTENT,radius:(g.clusterRadius||50)*L,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.load=function(){var p=this;this.fire(new d.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)p.fire(new d.ErrorEvent(g));else{var x={dataType:"source",sourceDataType:"metadata"};p._collectResourceTiming&&p._resourceTiming&&p._resourceTiming.length>0&&(x.resourceTiming=p._resourceTiming,p._resourceTiming=[]),p.fire(new d.Event("data",x))}})},h.prototype.onAdd=function(p){this.map=p,this.load()},h.prototype.setData=function(p){var g=this;return this._data=p,this.fire(new d.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(x){if(x)g.fire(new d.ErrorEvent(x));else{var k={dataType:"source",sourceDataType:"content"};g._collectResourceTiming&&g._resourceTiming&&g._resourceTiming.length>0&&(k.resourceTiming=g._resourceTiming,g._resourceTiming=[]),g.fire(new d.Event("data",k))}}),this},h.prototype.getClusterExpansionZoom=function(p,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},g),this},h.prototype.getClusterChildren=function(p,g){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},g),this},h.prototype.getClusterLeaves=function(p,g,x,k){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:g,offset:x},k),this},h.prototype._updateWorkerData=function(p){var g=this;this._loaded=!1;var x=d.extend({},this.workerOptions),k=this._data;"string"==typeof k?(x.request=this.map._requestManager.transformRequest(d.browser.resolveURL(k),d.ResourceType.Source),x.request.collectResourceTiming=this._collectResourceTiming):x.data=JSON.stringify(k),this.actor.send(this.type+".loadData",x,function(L,J){g._removed||J&&J.abandoned||(g._loaded=!0,J&&J.resourceTiming&&J.resourceTiming[g.id]&&(g._resourceTiming=J.resourceTiming[g.id].slice(0)),g.actor.send(g.type+".coalesce",{source:x.source},null),p(L))})},h.prototype.loaded=function(){return this._loaded},h.prototype.loadTile=function(p,g){var x=this,k=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(k,{type:this.type,uid:p.uid,tileID:p.tileID,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:d.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,J){return delete p.request,p.unloadVectorData(),p.aborted?g(null):L?g(L):(p.loadVectorData(J,x.map.painter,"reloadTile"===k),g(null))})},h.prototype.abortTile=function(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0},h.prototype.unloadTile=function(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})},h.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},h.prototype.serialize=function(){return d.extend({},this._options,{type:this.type,data:this._data})},h.prototype.hasTransition=function(){return!1},h}(d.Evented),Ye=d.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),mt=function(u){function h(p,g,x,k){u.call(this),this.id=p,this.dispatcher=x,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(k),this.options=g}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.load=function(p,g){var x=this;this._loaded=!1,this.fire(new d.Event("dataloading",{dataType:"source"})),this.url=this.options.url,d.getImage(this.map._requestManager.transformRequest(this.url,d.ResourceType.Image),function(k,L){x._loaded=!0,k?x.fire(new d.ErrorEvent(k)):L&&(x.image=L,p&&(x.coordinates=p),g&&g(),x._finishLoading())})},h.prototype.loaded=function(){return this._loaded},h.prototype.updateImage=function(p){var g=this;return this.image&&p.url?(this.options.url=p.url,this.load(p.coordinates,function(){g.texture=null}),this):this},h.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"metadata"})))},h.prototype.onAdd=function(p){this.map=p,this.load()},h.prototype.setCoordinates=function(p){var g=this;this.coordinates=p;var x=p.map(d.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var J=1/0,K=1/0,ne=-1/0,_e=-1/0,ve=0,be=L;ve<be.length;ve+=1){var Ee=be[ve];J=Math.min(J,Ee.x),K=Math.min(K,Ee.y),ne=Math.max(ne,Ee.x),_e=Math.max(_e,Ee.y)}var Oe=Math.max(ne-J,_e-K),Re=Math.max(0,Math.floor(-Math.log(Oe)/Math.LN2)),Se=Math.pow(2,Re);return new d.CanonicalTileID(Re,Math.floor((J+ne)/2*Se),Math.floor((K+_e)/2*Se))}(x),this.minzoom=this.maxzoom=this.tileID.z;var k=x.map(function(L){return g.tileID.getTilePoint(L)._round()});return this._boundsArray=new d.StructArrayLayout4i8,this._boundsArray.emplaceBack(k[0].x,k[0].y,0,0),this._boundsArray.emplaceBack(k[1].x,k[1].y,d.EXTENT,0),this._boundsArray.emplaceBack(k[3].x,k[3].y,0,d.EXTENT),this._boundsArray.emplaceBack(k[2].x,k[2].y,d.EXTENT,d.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"content"})),this},h.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var p=this.map.painter.context,g=p.gl;for(var x in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,Ye.members)),this.boundsSegments||(this.boundsSegments=d.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new d.Texture(p,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var k=this.tiles[x];"loaded"!==k.state&&(k.state="loaded",k.texture=this.texture)}}},h.prototype.loadTile=function(p,g){this.tileID&&this.tileID.equals(p.tileID.canonical)?(this.tiles[String(p.tileID.wrap)]=p,p.buckets={},g(null)):(p.state="errored",g(null))},h.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},h.prototype.hasTransition=function(){return!1},h}(d.Evented),Et=function(u){function h(p,g,x,k){u.call(this,p,g,x,k),this.roundZoom=!0,this.type="video",this.options=g}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.load=function(){var p=this;this._loaded=!1;var g=this.options;this.urls=[];for(var x=0,k=g.urls;x<k.length;x+=1)this.urls.push(this.map._requestManager.transformRequest(k[x],d.ResourceType.Source).url);d.getVideo(this.urls,function(L,J){p._loaded=!0,L?p.fire(new d.ErrorEvent(L)):J&&(p.video=J,p.video.loop=!0,p.video.addEventListener("playing",function(){p.map.triggerRepaint()}),p.map&&p.video.play(),p._finishLoading())})},h.prototype.pause=function(){this.video&&this.video.pause()},h.prototype.play=function(){this.video&&this.video.play()},h.prototype.seek=function(p){if(this.video){var g=this.video.seekable;p<g.start(0)||p>g.end(0)?this.fire(new d.ErrorEvent(new d.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+g.start(0)+" and "+g.end(0)+"-second mark."))):this.video.currentTime=p}},h.prototype.getVideo=function(){return this.video},h.prototype.onAdd=function(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},h.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var p=this.map.painter.context,g=p.gl;for(var x in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,Ye.members)),this.boundsSegments||(this.boundsSegments=d.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new d.Texture(p,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var k=this.tiles[x];"loaded"!==k.state&&(k.state="loaded",k.texture=this.texture)}}},h.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},h.prototype.hasTransition=function(){return this.video&&!this.video.paused},h}(mt),Tt=function(u){function h(p,g,x,k){u.call(this,p,g,x,k),g.coordinates?Array.isArray(g.coordinates)&&4===g.coordinates.length&&!g.coordinates.some(function(L){return!Array.isArray(L)||2!==L.length||L.some(function(J){return"number"!=typeof J})})||this.fire(new d.ErrorEvent(new d.ValidationError("sources."+p,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.ErrorEvent(new d.ValidationError("sources."+p,null,'missing required property "coordinates"'))),g.animate&&"boolean"!=typeof g.animate&&this.fire(new d.ErrorEvent(new d.ValidationError("sources."+p,null,'optional "animate" property must be a boolean value'))),g.canvas?"string"==typeof g.canvas||g.canvas instanceof d.window.HTMLCanvasElement||this.fire(new d.ErrorEvent(new d.ValidationError("sources."+p,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.ErrorEvent(new d.ValidationError("sources."+p,null,'missing required property "canvas"'))),this.options=g,this.animate=void 0===g.animate||g.animate}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof d.window.HTMLCanvasElement?this.options.canvas:d.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},h.prototype.getCanvas=function(){return this.canvas},h.prototype.onAdd=function(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()},h.prototype.onRemove=function(){this.pause()},h.prototype.prepare=function(){var p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var g=this.map.painter.context,x=g.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,Ye.members)),this.boundsSegments||(this.boundsSegments=d.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new d.Texture(g,this.canvas,x.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[k];"loaded"!==L.state&&(L.state="loaded",L.texture=this.texture)}}},h.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},h.prototype.hasTransition=function(){return this._playing},h.prototype._hasInvalidDimensions=function(){for(var p=0,g=[this.canvas.width,this.canvas.height];p<g.length;p+=1){var x=g[p];if(isNaN(x)||x<=0)return!0}return!1},h}(mt),Nt={vector:xe,raster:Ne,"raster-dem":we,geojson:me,video:Et,image:mt,canvas:Tt};function Xt(u,h){var p=d.identity([]);return d.translate(p,p,[1,1,0]),d.scale(p,p,[.5*u.width,.5*u.height,1]),d.multiply(p,p,u.calculatePosMatrix(h.toUnwrapped()))}function Pn(u,h,p,g,x,k){var L=function(Re,Se,De){if(Re)for(var Be=0,Xe=Re;Be<Xe.length;Be+=1){var _t=Se[Xe[Be]];if(_t&&_t.source===De&&"fill-extrusion"===_t.type)return!0}else for(var ct in Se){var yt=Se[ct];if(yt.source===De&&"fill-extrusion"===yt.type)return!0}return!1}(x&&x.layers,h,u.id),J=k.maxPitchScaleFactor(),K=u.tilesIn(g,J,L);K.sort(st);for(var ne=[],_e=0,ve=K;_e<ve.length;_e+=1){var be=ve[_e];ne.push({wrappedTileID:be.tileID.wrapped().key,queryResults:be.tile.queryRenderedFeatures(h,p,u._state,be.queryGeometry,be.cameraQueryGeometry,be.scale,x,k,J,Xt(u.transform,be.tileID))})}var Ee=function(Re){for(var Se={},De={},Be=0,Xe=Re;Be<Xe.length;Be+=1){var _t=Xe[Be],ct=_t.queryResults,yt=_t.wrappedTileID,St=De[yt]=De[yt]||{};for(var Ut in ct)for(var Rt=ct[Ut],Kt=St[Ut]=St[Ut]||{},wn=Se[Ut]=Se[Ut]||[],Mn=0,En=Rt;Mn<En.length;Mn+=1){var _i=En[Mn];Kt[_i.featureIndex]||(Kt[_i.featureIndex]=!0,wn.push(_i))}}return Se}(ne);for(var Oe in Ee)Ee[Oe].forEach(function(Re){var Se=Re.feature,De=u.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=De});return Ee}function st(u,h){var p=u.tileID,g=h.tileID;return p.overscaledZ-g.overscaledZ||p.canonical.y-g.canonical.y||p.wrap-g.wrap||p.canonical.x-g.canonical.x}var at=function(u,h){this.max=u,this.onRemove=h,this.reset()};at.prototype.reset=function(){for(var u in this.data)for(var h=0,p=this.data[u];h<p.length;h+=1){var g=p[h];g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value)}return this.data={},this.order=[],this},at.prototype.add=function(u,h,p){var g=this,x=u.wrapped().key;void 0===this.data[x]&&(this.data[x]=[]);var k={value:h,timeout:void 0};if(void 0!==p&&(k.timeout=setTimeout(function(){g.remove(u,k)},p)),this.data[x].push(k),this.order.push(x),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},at.prototype.has=function(u){return u.wrapped().key in this.data},at.prototype.getAndRemove=function(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null},at.prototype._getAndRemoveByKey=function(u){var h=this.data[u].shift();return h.timeout&&clearTimeout(h.timeout),0===this.data[u].length&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),h.value},at.prototype.getByKey=function(u){var h=this.data[u];return h?h[0].value:null},at.prototype.get=function(u){return this.has(u)?this.data[u.wrapped().key][0].value:null},at.prototype.remove=function(u,h){if(!this.has(u))return this;var p=u.wrapped().key,g=void 0===h?0:this.data[p].indexOf(h),x=this.data[p][g];return this.data[p].splice(g,1),x.timeout&&clearTimeout(x.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(x.value),this.order.splice(this.order.indexOf(p),1),this},at.prototype.setMaxSize=function(u){for(this.max=u;this.order.length>this.max;){var h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this},at.prototype.filter=function(u){var h=[];for(var p in this.data)for(var g=0,x=this.data[p];g<x.length;g+=1){var k=x[g];u(k.value)||h.push(k)}for(var L=0,J=h;L<J.length;L+=1){var K=J[L];this.remove(K.value.tileID,K)}};var kt=function(u,h,p){this.context=u;var g=u.gl;this.buffer=g.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer};kt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},kt.prototype.updateData=function(u){var h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)},kt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var $t={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},_n=function(u,h,p,g){this.length=h.length,this.attributes=p,this.itemSize=h.bytesPerElement,this.dynamicDraw=g,this.context=u;var x=u.gl;this.buffer=x.createBuffer(),u.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer};_n.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},_n.prototype.updateData=function(u){var h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,u.arrayBuffer)},_n.prototype.enableAttributes=function(u,h){for(var p=0;p<this.attributes.length;p++){var g=h.attributes[this.attributes[p].name];void 0!==g&&u.enableVertexAttribArray(g)}},_n.prototype.setVertexAttribPointers=function(u,h,p){for(var g=0;g<this.attributes.length;g++){var x=this.attributes[g],k=h.attributes[x.name];void 0!==k&&u.vertexAttribPointer(k,x.components,u[$t[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}},_n.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Lt=function(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Lt.prototype.get=function(){return this.current},Lt.prototype.set=function(u){},Lt.prototype.getDefault=function(){return this.default},Lt.prototype.setDefault=function(){this.set(this.default)};var gn=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return d.Color.transparent},h.prototype.set=function(p){var g=this.current;(p.r!==g.r||p.g!==g.g||p.b!==g.b||p.a!==g.a||this.dirty)&&(this.gl.clearColor(p.r,p.g,p.b,p.a),this.current=p,this.dirty=!1)},h}(Lt),$n=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return 1},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.clearDepth(p),this.current=p,this.dirty=!1)},h}(Lt),pn=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return 0},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.clearStencil(p),this.current=p,this.dirty=!1)},h}(Lt),Ui=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return[!0,!0,!0,!0]},h.prototype.set=function(p){var g=this.current;(p[0]!==g[0]||p[1]!==g[1]||p[2]!==g[2]||p[3]!==g[3]||this.dirty)&&(this.gl.colorMask(p[0],p[1],p[2],p[3]),this.current=p,this.dirty=!1)},h}(Lt),Gi=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!0},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.depthMask(p),this.current=p,this.dirty=!1)},h}(Lt),yi=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return 255},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.stencilMask(p),this.current=p,this.dirty=!1)},h}(Lt),Di=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},h.prototype.set=function(p){var g=this.current;(p.func!==g.func||p.ref!==g.ref||p.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(p.func,p.ref,p.mask),this.current=p,this.dirty=!1)},h}(Lt),gi=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){var p=this.gl;return[p.KEEP,p.KEEP,p.KEEP]},h.prototype.set=function(p){var g=this.current;(p[0]!==g[0]||p[1]!==g[1]||p[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(p[0],p[1],p[2]),this.current=p,this.dirty=!1)},h}(Lt),Ni=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!1},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;p?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=p,this.dirty=!1}},h}(Lt),Mo=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return[0,1]},h.prototype.set=function(p){var g=this.current;(p[0]!==g[0]||p[1]!==g[1]||this.dirty)&&(this.gl.depthRange(p[0],p[1]),this.current=p,this.dirty=!1)},h}(Lt),No=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!1},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;p?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=p,this.dirty=!1}},h}(Lt),vr=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return this.gl.LESS},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.depthFunc(p),this.current=p,this.dirty=!1)},h}(Lt),Oo=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!1},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;p?g.enable(g.BLEND):g.disable(g.BLEND),this.current=p,this.dirty=!1}},h}(Lt),So=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){var p=this.gl;return[p.ONE,p.ZERO]},h.prototype.set=function(p){var g=this.current;(p[0]!==g[0]||p[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(p[0],p[1]),this.current=p,this.dirty=!1)},h}(Lt),ra=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return d.Color.transparent},h.prototype.set=function(p){var g=this.current;(p.r!==g.r||p.g!==g.g||p.b!==g.b||p.a!==g.a||this.dirty)&&(this.gl.blendColor(p.r,p.g,p.b,p.a),this.current=p,this.dirty=!1)},h}(Lt),aa=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return this.gl.FUNC_ADD},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.blendEquation(p),this.current=p,this.dirty=!1)},h}(Lt),bo=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!1},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;p?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=p,this.dirty=!1}},h}(Lt),tr=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return this.gl.BACK},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.cullFace(p),this.current=p,this.dirty=!1)},h}(Lt),lo=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return this.gl.CCW},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.frontFace(p),this.current=p,this.dirty=!1)},h}(Lt),Po=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)},h}(Lt),xa=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return this.gl.TEXTURE0},h.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.activeTexture(p),this.current=p,this.dirty=!1)},h}(Lt),Ur=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){var p=this.gl;return[0,0,p.drawingBufferWidth,p.drawingBufferHeight]},h.prototype.set=function(p){var g=this.current;(p[0]!==g[0]||p[1]!==g[1]||p[2]!==g[2]||p[3]!==g[3]||this.dirty)&&(this.gl.viewport(p[0],p[1],p[2],p[3]),this.current=p,this.dirty=!1)},h}(Lt),Eo=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,p),this.current=p,this.dirty=!1}},h}(Lt),Bn=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,p),this.current=p,this.dirty=!1}},h}(Lt),br=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,p),this.current=p,this.dirty=!1}},h}(Lt),sl=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,p),this.current=p,this.dirty=!1}},h}(Lt),Ca=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){var g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,p),this.current=p,this.dirty=!1},h}(Lt),qr=function(u){function h(p){u.call(this,p),this.vao=p.extVertexArrayObject}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h.prototype.set=function(p){this.vao&&(p!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(p),this.current=p,this.dirty=!1)},h}(Lt),Ra=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return 4},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,p),this.current=p,this.dirty=!1}},h}(Lt),Ri=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!1},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),this.current=p,this.dirty=!1}},h}(Lt),Fs=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return!1},h.prototype.set=function(p){if(p!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,p),this.current=p,this.dirty=!1}},h}(Lt),qi=function(u){function h(p,g){u.call(this,p),this.context=p,this.parent=g}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getDefault=function(){return null},h}(Lt),te=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.setDirty=function(){this.dirty=!0},h.prototype.set=function(p){if(p!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,p,0),this.current=p,this.dirty=!1}},h}(qi),re=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.set=function(p){if(p!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,p),this.current=p,this.dirty=!1}},h}(qi),fe=function(u,h,p,g){this.context=u,this.width=h,this.height=p;var x=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new te(u,x),g&&(this.depthAttachment=new re(u,x))};fe.prototype.destroy=function(){var u=this.context.gl,h=this.colorAttachment.get();if(h&&u.deleteTexture(h),this.depthAttachment){var p=this.depthAttachment.get();p&&u.deleteRenderbuffer(p)}u.deleteFramebuffer(this.framebuffer)};var Ce=function(u,h,p){this.func=u,this.mask=h,this.range=p};Ce.ReadOnly=!1,Ce.ReadWrite=!0,Ce.disabled=new Ce(519,Ce.ReadOnly,[0,1]);var Pe=function(u,h,p,g,x,k){this.test=u,this.ref=h,this.mask=p,this.fail=g,this.depthFail=x,this.pass=k};Pe.disabled=new Pe({func:519,mask:0},0,0,7680,7680,7680);var qe=function(u,h,p){this.blendFunction=u,this.blendColor=h,this.mask=p};qe.disabled=new qe(qe.Replace=[1,0],d.Color.transparent,[!1,!1,!1,!1]),qe.unblended=new qe(qe.Replace,d.Color.transparent,[!0,!0,!0,!0]),qe.alphaBlended=new qe([1,771],d.Color.transparent,[!0,!0,!0,!0]);var Ge=function(u,h,p){this.enable=u,this.mode=h,this.frontFace=p};Ge.disabled=new Ge(!1,1029,2305),Ge.backCCW=new Ge(!0,1029,2305);var ye=function(u){this.gl=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new gn(this),this.clearDepth=new $n(this),this.clearStencil=new pn(this),this.colorMask=new Ui(this),this.depthMask=new Gi(this),this.stencilMask=new yi(this),this.stencilFunc=new Di(this),this.stencilOp=new gi(this),this.stencilTest=new Ni(this),this.depthRange=new Mo(this),this.depthTest=new No(this),this.depthFunc=new vr(this),this.blend=new Oo(this),this.blendFunc=new So(this),this.blendColor=new ra(this),this.blendEquation=new aa(this),this.cullFace=new bo(this),this.cullFaceSide=new tr(this),this.frontFace=new lo(this),this.program=new Po(this),this.activeTexture=new xa(this),this.viewport=new Ur(this),this.bindFramebuffer=new Eo(this),this.bindRenderbuffer=new Bn(this),this.bindTexture=new br(this),this.bindVertexBuffer=new sl(this),this.bindElementBuffer=new Ca(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new qr(this),this.pixelStoreUnpack=new Ra(this),this.pixelStoreUnpackPremultiplyAlpha=new Ri(this),this.pixelStoreUnpackFlipY=new Fs(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=u.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(u.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)};ye.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ye.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ye.prototype.createIndexBuffer=function(u,h){return new kt(this,u,h)},ye.prototype.createVertexBuffer=function(u,h,p){return new _n(this,u,h,p)},ye.prototype.createRenderbuffer=function(u,h,p){var g=this.gl,x=g.createRenderbuffer();return this.bindRenderbuffer.set(x),g.renderbufferStorage(g.RENDERBUFFER,u,h,p),this.bindRenderbuffer.set(null),x},ye.prototype.createFramebuffer=function(u,h,p){return new fe(this,u,h,p)},ye.prototype.clear=function(u){var h=u.color,p=u.depth,g=this.gl,x=0;h&&(x|=g.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),void 0!==p&&(x|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),g.clear(x)},ye.prototype.setCullFace=function(u){!1===u.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))},ye.prototype.setDepthMode=function(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)},ye.prototype.setStencilMode=function(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)},ye.prototype.setColorMode=function(u){d.deepEqual(u.blendFunction,qe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)},ye.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ze=function(u){function h(p,g,x){var k=this;u.call(this),this.id=p,this.dispatcher=x,this.on("data",function(L){"source"===L.dataType&&"metadata"===L.sourceDataType&&(k._sourceLoaded=!0),k._sourceLoaded&&!k._paused&&"source"===L.dataType&&"content"===L.sourceDataType&&(k.reload(),k.transform&&k.update(k.transform))}),this.on("error",function(){k._sourceErrored=!0}),this._source=function(L,J,K,ne){var _e=new Nt[J.type](L,J,K,ne);if(_e.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+_e.id);return d.bindAll(["load","abort","unload","serialize","prepare"],_e),_e}(p,g,x,this),this._tiles={},this._cache=new at(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new d.SourceFeatureState}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.onAdd=function(p){this.map=p,this._maxTileCacheSize=p?p._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(p)},h.prototype.onRemove=function(p){this._source&&this._source.onRemove&&this._source.onRemove(p)},h.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var p in this._tiles){var g=this._tiles[p];if("loaded"!==g.state&&"errored"!==g.state)return!1}return!0},h.prototype.getSource=function(){return this._source},h.prototype.pause=function(){this._paused=!0},h.prototype.resume=function(){if(this._paused){var p=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,p&&this.reload(),this.transform&&this.update(this.transform)}},h.prototype._loadTile=function(p,g){return this._source.loadTile(p,g)},h.prototype._unloadTile=function(p){if(this._source.unloadTile)return this._source.unloadTile(p,function(){})},h.prototype._abortTile=function(p){if(this._source.abortTile)return this._source.abortTile(p,function(){})},h.prototype.serialize=function(){return this._source.serialize()},h.prototype.prepare=function(p){for(var g in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var x=this._tiles[g];x.upload(p),x.prepare(this.map.style.imageManager)}},h.prototype.getIds=function(){return d.values(this._tiles).map(function(p){return p.tileID}).sort($e).map(function(p){return p.key})},h.prototype.getRenderableIds=function(p){var g=this,x=[];for(var k in this._tiles)this._isIdRenderable(k,p)&&x.push(this._tiles[k]);return p?x.sort(function(L,J){var K=L.tileID,ne=J.tileID,_e=new d.Point(K.canonical.x,K.canonical.y)._rotate(g.transform.angle),ve=new d.Point(ne.canonical.x,ne.canonical.y)._rotate(g.transform.angle);return K.overscaledZ-ne.overscaledZ||ve.y-_e.y||ve.x-_e.x}).map(function(L){return L.tileID.key}):x.map(function(L){return L.tileID}).sort($e).map(function(L){return L.key})},h.prototype.hasRenderableParent=function(p){var g=this.findLoadedParent(p,0);return!!g&&this._isIdRenderable(g.tileID.key)},h.prototype._isIdRenderable=function(p,g){return this._tiles[p]&&this._tiles[p].hasData()&&!this._coveredTiles[p]&&(g||!this._tiles[p].holdingForFade())},h.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var p in this._cache.reset(),this._tiles)"errored"!==this._tiles[p].state&&this._reloadTile(p,"reloading")},h.prototype._reloadTile=function(p,g){var x=this._tiles[p];x&&("loading"!==x.state&&(x.state=g),this._loadTile(x,this._tileLoaded.bind(this,x,p,g)))},h.prototype._tileLoaded=function(p,g,x,k){if(k)return p.state="errored",void(404!==k.status?this._source.fire(new d.ErrorEvent(k,{tile:p})):this.update(this.transform));p.timeAdded=d.browser.now(),"expired"===x&&(p.refreshedUponExpiration=!0),this._setTileReloadTimer(g,p),"raster-dem"===this.getSource().type&&p.dem&&this._backfillDEM(p),this._state.initializeTileState(p,this.map?this.map.painter:null),this._source.fire(new d.Event("data",{dataType:"source",tile:p,coord:p.tileID}))},h.prototype._backfillDEM=function(p){for(var g=this.getRenderableIds(),x=0;x<g.length;x++){var k=g[x];if(p.neighboringTiles&&p.neighboringTiles[k]){var L=this.getTileByID(k);J(p,L),J(L,p)}}function J(K,ne){K.needsHillshadePrepare=!0;var _e=ne.tileID.canonical.x-K.tileID.canonical.x,ve=ne.tileID.canonical.y-K.tileID.canonical.y,be=Math.pow(2,K.tileID.canonical.z),Ee=ne.tileID.key;0===_e&&0===ve||Math.abs(ve)>1||(Math.abs(_e)>1&&(1===Math.abs(_e+be)?_e+=be:1===Math.abs(_e-be)&&(_e-=be)),ne.dem&&K.dem&&(K.dem.backfillBorder(ne.dem,_e,ve),K.neighboringTiles&&K.neighboringTiles[Ee]&&(K.neighboringTiles[Ee].backfilled=!0)))}},h.prototype.getTile=function(p){return this.getTileByID(p.key)},h.prototype.getTileByID=function(p){return this._tiles[p]},h.prototype._retainLoadedChildren=function(p,g,x,k){for(var L in this._tiles){var J=this._tiles[L];if(!(k[L]||!J.hasData()||J.tileID.overscaledZ<=g||J.tileID.overscaledZ>x)){for(var K=J.tileID;J&&J.tileID.overscaledZ>g+1;){var ne=J.tileID.scaledTo(J.tileID.overscaledZ-1);(J=this._tiles[ne.key])&&J.hasData()&&(K=ne)}for(var _e=K;_e.overscaledZ>g;)if(p[(_e=_e.scaledTo(_e.overscaledZ-1)).key]){k[K.key]=K;break}}}},h.prototype.findLoadedParent=function(p,g){if(p.key in this._loadedParentTiles){var x=this._loadedParentTiles[p.key];return x&&x.tileID.overscaledZ>=g?x:null}for(var k=p.overscaledZ-1;k>=g;k--){var L=p.scaledTo(k),J=this._getLoadedTile(L);if(J)return J}},h.prototype._getLoadedTile=function(p){var g=this._tiles[p.key];return g&&g.hasData()?g:this._cache.getByKey(p.wrapped().key)},h.prototype.updateCacheSize=function(p){var g=Math.ceil(p.width/this._source.tileSize)+1,x=Math.ceil(p.height/this._source.tileSize)+1,k=Math.floor(g*x*5),L="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,k):k;this._cache.setMaxSize(L)},h.prototype.handleWrapJump=function(p){var g=Math.round((p-(void 0===this._prevLng?p:this._prevLng))/360);if(this._prevLng=p,g){var x={};for(var k in this._tiles){var L=this._tiles[k];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+g),x[L.tileID.key]=L}for(var J in this._tiles=x,this._timers)clearTimeout(this._timers[J]),delete this._timers[J];for(var K in this._tiles)this._setTileReloadTimer(K,this._tiles[K])}},h.prototype.update=function(p){var g=this;if(this.transform=p,this._sourceLoaded&&!this._paused){var x;this.updateCacheSize(p),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?x=p.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(St){return new d.OverscaledTileID(St.canonical.z,St.wrap,St.canonical.z,St.canonical.x,St.canonical.y)}):(x=p.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(x=x.filter(function(St){return g._source.hasTile(St)}))):x=[];var k=p.coveringZoomLevel(this._source),L=Math.max(k-h.maxOverzooming,this._source.minzoom),J=Math.max(k+h.maxUnderzooming,this._source.minzoom),K=this._updateRetainedTiles(x,k);if(Mt(this._source.type)){for(var ne={},_e={},ve=0,be=Object.keys(K);ve<be.length;ve+=1){var Ee=be[ve],Oe=K[Ee],Re=this._tiles[Ee];if(Re&&!(Re.fadeEndTime&&Re.fadeEndTime<=d.browser.now())){var Se=this.findLoadedParent(Oe,L);Se&&(this._addTile(Se.tileID),ne[Se.tileID.key]=Se.tileID),_e[Ee]=Oe}}for(var De in this._retainLoadedChildren(_e,k,J,K),ne)K[De]||(this._coveredTiles[De]=!0,K[De]=ne[De])}for(var Be in K)this._tiles[Be].clearFadeHold();for(var Xe=0,_t=d.keysDifference(this._tiles,K);Xe<_t.length;Xe+=1){var ct=_t[Xe],yt=this._tiles[ct];yt.hasSymbolBuckets&&!yt.holdingForFade()?yt.setHoldDuration(this.map._fadeDuration):yt.hasSymbolBuckets&&!yt.symbolFadeFinished()||this._removeTile(ct)}this._updateLoadedParentTileCache()}},h.prototype.releaseSymbolFadeTiles=function(){for(var p in this._tiles)this._tiles[p].holdingForFade()&&this._removeTile(p)},h.prototype._updateRetainedTiles=function(p,g){for(var x={},k={},L=Math.max(g-h.maxOverzooming,this._source.minzoom),J=Math.max(g+h.maxUnderzooming,this._source.minzoom),K={},ne=0,_e=p;ne<_e.length;ne+=1){var ve=_e[ne],be=this._addTile(ve);x[ve.key]=ve,be.hasData()||g<this._source.maxzoom&&(K[ve.key]=ve)}this._retainLoadedChildren(K,g,J,x);for(var Ee=0,Oe=p;Ee<Oe.length;Ee+=1){var Re=Oe[Ee],Se=this._tiles[Re.key];if(!Se.hasData()){if(g+1>this._source.maxzoom){var De=Re.children(this._source.maxzoom)[0],Be=this.getTile(De);if(Be&&Be.hasData()){x[De.key]=De;continue}}else{var Xe=Re.children(this._source.maxzoom);if(x[Xe[0].key]&&x[Xe[1].key]&&x[Xe[2].key]&&x[Xe[3].key])continue}for(var _t=Se.wasRequested(),ct=Re.overscaledZ-1;ct>=L;--ct){var yt=Re.scaledTo(ct);if(k[yt.key]||(k[yt.key]=!0,!(Se=this.getTile(yt))&&_t&&(Se=this._addTile(yt)),Se&&(x[yt.key]=yt,_t=Se.wasRequested(),Se.hasData())))break}}}return x},h.prototype._updateLoadedParentTileCache=function(){for(var p in this._loadedParentTiles={},this._tiles){for(var g=[],x=void 0,k=this._tiles[p].tileID;k.overscaledZ>0;){if(k.key in this._loadedParentTiles){x=this._loadedParentTiles[k.key];break}g.push(k.key);var L=k.scaledTo(k.overscaledZ-1);if(x=this._getLoadedTile(L))break;k=L}for(var J=0,K=g;J<K.length;J+=1)this._loadedParentTiles[K[J]]=x}},h.prototype._addTile=function(p){var g=this._tiles[p.key];if(g)return g;(g=this._cache.getAndRemove(p))&&(this._setTileReloadTimer(p.key,g),g.tileID=p,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[p.key]&&(clearTimeout(this._cacheTimers[p.key]),delete this._cacheTimers[p.key],this._setTileReloadTimer(p.key,g)));var x=Boolean(g);return x||(g=new d.Tile(p,this._source.tileSize*p.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,p.key,g.state))),g?(g.uses++,this._tiles[p.key]=g,x||this._source.fire(new d.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null},h.prototype._setTileReloadTimer=function(p,g){var x=this;p in this._timers&&(clearTimeout(this._timers[p]),delete this._timers[p]);var k=g.getExpiryTimeout();k&&(this._timers[p]=setTimeout(function(){x._reloadTile(p,"expired"),delete x._timers[p]},k))},h.prototype._removeTile=function(p){var g=this._tiles[p];g&&(g.uses--,delete this._tiles[p],this._timers[p]&&(clearTimeout(this._timers[p]),delete this._timers[p]),g.uses>0||(g.hasData()&&"reloading"!==g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))},h.prototype.clearTiles=function(){for(var p in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(p);this._cache.reset()},h.prototype.tilesIn=function(p,g,x){var k=this,L=[],J=this.transform;if(!J)return L;for(var K=x?J.getCameraQueryGeometry(p):p,ne=p.map(function(ct){return J.pointCoordinate(ct)}),_e=K.map(function(ct){return J.pointCoordinate(ct)}),ve=this.getIds(),be=1/0,Ee=1/0,Oe=-1/0,Re=-1/0,Se=0,De=_e;Se<De.length;Se+=1){var Be=De[Se];be=Math.min(be,Be.x),Ee=Math.min(Ee,Be.y),Oe=Math.max(Oe,Be.x),Re=Math.max(Re,Be.y)}for(var Xe=function(ct){var yt=k._tiles[ve[ct]];if(!yt.holdingForFade()){var St=yt.tileID,Ut=Math.pow(2,J.zoom-yt.tileID.overscaledZ),Rt=g*yt.queryPadding*d.EXTENT/yt.tileSize/Ut,Kt=[St.getTilePoint(new d.MercatorCoordinate(be,Ee)),St.getTilePoint(new d.MercatorCoordinate(Oe,Re))];if(Kt[0].x-Rt<d.EXTENT&&Kt[0].y-Rt<d.EXTENT&&Kt[1].x+Rt>=0&&Kt[1].y+Rt>=0){var wn=ne.map(function(En){return St.getTilePoint(En)}),Mn=_e.map(function(En){return St.getTilePoint(En)});L.push({tile:yt,tileID:St,queryGeometry:wn,cameraQueryGeometry:Mn,scale:Ut})}}},_t=0;_t<ve.length;_t++)Xe(_t);return L},h.prototype.getVisibleCoordinates=function(p){for(var g=this,x=this.getRenderableIds(p).map(function(K){return g._tiles[K].tileID}),k=0,L=x;k<L.length;k+=1){var J=L[k];J.posMatrix=this.transform.calculatePosMatrix(J.toUnwrapped())}return x},h.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Mt(this._source.type))for(var p in this._tiles){var g=this._tiles[p];if(void 0!==g.fadeEndTime&&g.fadeEndTime>=d.browser.now())return!0}return!1},h.prototype.setFeatureState=function(p,g,x){this._state.updateState(p=p||"_geojsonTileLayer",g,x)},h.prototype.removeFeatureState=function(p,g,x){this._state.removeFeatureState(p=p||"_geojsonTileLayer",g,x)},h.prototype.getFeatureState=function(p,g){return this._state.getState(p=p||"_geojsonTileLayer",g)},h.prototype.setDependencies=function(p,g,x){var k=this._tiles[p];k&&k.setDependencies(g,x)},h.prototype.reloadTilesForDependencies=function(p,g){for(var x in this._tiles)this._tiles[x].hasDependency(p,g)&&this._reloadTile(x,"reloading");this._cache.filter(function(k){return!k.hasDependency(p,g)})},h}(d.Evented);function $e(u,h){var p=Math.abs(2*u.wrap)-+(u.wrap<0),g=Math.abs(2*h.wrap)-+(h.wrap<0);return u.overscaledZ-h.overscaledZ||g-p||h.canonical.y-u.canonical.y||h.canonical.x-u.canonical.x}function Mt(u){return"raster"===u||"image"===u||"video"===u}function It(){return new d.window.Worker(Ou.workerUrl)}Ze.maxOverzooming=10,Ze.maxUnderzooming=3;var ht="mapboxgl_preloaded_worker_pool",At=function(){this.active={}};At.prototype.acquire=function(u){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new It);return this.active[u]=!0,this.workers.slice()},At.prototype.release=function(u){delete this.active[u],0===this.numActive()&&(this.workers.forEach(function(h){h.terminate()}),this.workers=null)},At.prototype.isPreloaded=function(){return!!this.active[ht]},At.prototype.numActive=function(){return Object.keys(this.active).length};var sn,an=Math.floor(d.browser.hardwareConcurrency/2);function ft(){return sn||(sn=new At),sn}function Qt(u,h){var p={};for(var g in u)"ref"!==g&&(p[g]=u[g]);return d.refProperties.forEach(function(x){x in h&&(p[x]=h[x])}),p}function Jt(u){u=u.slice();for(var h=Object.create(null),p=0;p<u.length;p++)h[u[p].id]=u[p];for(var g=0;g<u.length;g++)"ref"in u[g]&&(u[g]=Qt(u[g],h[u[g].ref]));return u}At.workerCount=Math.max(Math.min(an,6),1);var Yt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Gn(u,h,p){p.push({command:Yt.addSource,args:[u,h[u]]})}function Wt(u,h,p){h.push({command:Yt.removeSource,args:[u]}),p[u]=!0}function li(u,h,p,g){Wt(u,p,g),Gn(u,h,p)}function zi(u,h,p){var g;for(g in u[p])if(u[p].hasOwnProperty(g)&&"data"!==g&&!d.deepEqual(u[p][g],h[p][g]))return!1;for(g in h[p])if(h[p].hasOwnProperty(g)&&"data"!==g&&!d.deepEqual(u[p][g],h[p][g]))return!1;return!0}function zn(u,h,p,g,x,k){var L;for(L in h=h||{},u=u||{})u.hasOwnProperty(L)&&(d.deepEqual(u[L],h[L])||p.push({command:k,args:[g,L,h[L],x]}));for(L in h)h.hasOwnProperty(L)&&!u.hasOwnProperty(L)&&(d.deepEqual(u[L],h[L])||p.push({command:k,args:[g,L,h[L],x]}))}function vi(u){return u.id}function ri(u,h){return u[h.id]=h,u}var jo=function(u,h){this.reset(u,h)};jo.prototype.reset=function(u,h){this.points=u||[],this._distances=[0];for(var p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding},jo.prototype.lerp=function(u){if(1===this.points.length)return this.points[0];u=d.clamp(u,0,1);for(var h=1,p=this._distances[h],g=u*this.paddedLength+this.padding;p<g&&h<this._distances.length;)p=this._distances[++h];var x=h-1,k=this._distances[x],L=p-k,J=L>0?(g-k)/L:0;return this.points[x].mult(1-J).add(this.points[h].mult(J))};var Ci=function(u,h,p){var g=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(u/p),this.yCellCount=Math.ceil(h/p);for(var k=0;k<this.xCellCount*this.yCellCount;k++)g.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=h,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0};function eo(u,h,p,g,x){var k=d.create();return h?(d.scale(k,k,[1/x,1/x,1]),p||d.rotateZ(k,k,g.angle)):d.multiply(k,g.labelPlaneMatrix,u),k}function Oi(u,h,p,g,x){if(h){var k=d.clone(u);return d.scale(k,k,[x,x,1]),p||d.rotateZ(k,k,-g.angle),k}return g.glCoordMatrix}function Zn(u,h){var p=[u.x,u.y,0,1];Bo(p,p,h);var g=p[3];return{point:new d.Point(p[0]/g,p[1]/g),signedDistanceFromCamera:g}}function wi(u,h){return.5+u/h*.5}function dr(u,h){var p=u[0]/u[3],g=u[1]/u[3];return p>=-h[0]&&p<=h[0]&&g>=-h[1]&&g<=h[1]}function wa(u,h,p,g,x,k,L,J){var K=g?u.textSizeData:u.iconSizeData,ne=d.evaluateSizeForZoom(K,p.transform.zoom),_e=[256/p.width*2+1,256/p.height*2+1],ve=g?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;ve.clear();for(var be=u.lineVertexArray,Ee=g?u.text.placedSymbolArray:u.icon.placedSymbolArray,Oe=p.transform.width/p.transform.height,Re=!1,Se=0;Se<Ee.length;Se++){var De=Ee.get(Se);if(De.hidden||De.writingMode===d.WritingMode.vertical&&!Re)nr(De.numGlyphs,ve);else{Re=!1;var Be=[De.anchorX,De.anchorY,0,1];if(d.transformMat4(Be,Be,h),dr(Be,_e)){var Xe=wi(p.transform.cameraToCenterDistance,Be[3]),_t=d.evaluateSizeForFeature(K,ne,De),ct=L?_t/Xe:_t*Xe,yt=new d.Point(De.anchorX,De.anchorY),St=Zn(yt,x).point,Ut={},Rt=rs(De,ct,!1,J,h,x,k,u.glyphOffsetArray,be,ve,St,yt,Ut,Oe);Re=Rt.useVertical,(Rt.notEnoughRoom||Re||Rt.needsFlipping&&rs(De,ct,!0,J,h,x,k,u.glyphOffsetArray,be,ve,St,yt,Ut,Oe).notEnoughRoom)&&nr(De.numGlyphs,ve)}else nr(De.numGlyphs,ve)}}g?u.text.dynamicLayoutVertexBuffer.updateData(ve):u.icon.dynamicLayoutVertexBuffer.updateData(ve)}function Yi(u,h,p,g,x,k,L,J,K,ne,_e){var ve=J.glyphStartIndex+J.numGlyphs,be=J.lineStartIndex,Ee=J.lineStartIndex+J.lineLength,Oe=h.getoffsetX(J.glyphStartIndex),Re=h.getoffsetX(ve-1),Se=to(u*Oe,p,g,x,k,L,J.segment,be,Ee,K,ne,_e);if(!Se)return null;var De=to(u*Re,p,g,x,k,L,J.segment,be,Ee,K,ne,_e);return De?{first:Se,last:De}:null}function Ko(u,h,p,g){return u===d.WritingMode.horizontal&&Math.abs(p.y-h.y)>Math.abs(p.x-h.x)*g?{useVertical:!0}:(u===d.WritingMode.vertical?h.y<p.y:h.x>p.x)?{needsFlipping:!0}:null}function rs(u,h,p,g,x,k,L,J,K,ne,_e,ve,be,Ee){var Oe,Re=h/24,Se=u.lineOffsetX*Re,De=u.lineOffsetY*Re;if(u.numGlyphs>1){var Be=u.glyphStartIndex+u.numGlyphs,Xe=u.lineStartIndex,_t=u.lineStartIndex+u.lineLength,ct=Yi(Re,J,Se,De,p,_e,ve,u,K,k,be);if(!ct)return{notEnoughRoom:!0};var yt=Zn(ct.first.point,L).point,St=Zn(ct.last.point,L).point;if(g&&!p){var Ut=Ko(u.writingMode,yt,St,Ee);if(Ut)return Ut}Oe=[ct.first];for(var Rt=u.glyphStartIndex+1;Rt<Be-1;Rt++)Oe.push(to(Re*J.getoffsetX(Rt),Se,De,p,_e,ve,u.segment,Xe,_t,K,k,be));Oe.push(ct.last)}else{if(g&&!p){var Kt=Zn(ve,x).point,wn=u.lineStartIndex+u.segment+1,Mn=new d.Point(K.getx(wn),K.gety(wn)),En=Zn(Mn,x),_i=En.signedDistanceFromCamera>0?En.point:Ta(ve,Mn,Kt,1,x),Gt=Ko(u.writingMode,Kt,_i,Ee);if(Gt)return Gt}var jn=to(Re*J.getoffsetX(u.glyphStartIndex),Se,De,p,_e,ve,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,K,k,be);if(!jn)return{notEnoughRoom:!0};Oe=[jn]}for(var ti=0,Fn=Oe;ti<Fn.length;ti+=1){var Un=Fn[ti];d.addDynamicAttributes(ne,Un.point,Un.angle)}return{}}function Ta(u,h,p,g,x){var k=Zn(u.add(u.sub(h)._unit()),x).point,L=p.sub(k);return p.add(L._mult(g/L.mag()))}function to(u,h,p,g,x,k,L,J,K,ne,_e,ve){var be=g?u-h:u+h,Ee=be>0?1:-1,Oe=0;g&&(Ee*=-1,Oe=Math.PI),Ee<0&&(Oe+=Math.PI);for(var Re=Ee>0?J+L:J+L+1,Se=x,De=x,Be=0,Xe=0,_t=Math.abs(be),ct=[];Be+Xe<=_t;){if((Re+=Ee)<J||Re>=K)return null;if(De=Se,ct.push(Se),void 0===(Se=ve[Re])){var yt=new d.Point(ne.getx(Re),ne.gety(Re)),St=Zn(yt,_e);if(St.signedDistanceFromCamera>0)Se=ve[Re]=St.point;else{var Ut=Re-Ee;Se=Ta(0===Be?k:new d.Point(ne.getx(Ut),ne.gety(Ut)),yt,De,_t-Be+1,_e)}}Be+=Xe,Xe=De.dist(Se)}var Rt=(_t-Be)/Xe,Kt=Se.sub(De),wn=Kt.mult(Rt)._add(De);wn._add(Kt._unit()._perp()._mult(p*Ee));var Mn=Oe+Math.atan2(Se.y-De.y,Se.x-De.x);return ct.push(wn),{point:wn,angle:Mn,path:ct}}Ci.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ci.prototype.insert=function(u,h,p,g,x){this._forEachCell(h,p,g,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(x)},Ci.prototype.insertCircle=function(u,h,p,g){this._forEachCell(h-g,p-g,h+g,p+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(h),this.circles.push(p),this.circles.push(g)},Ci.prototype._insertBoxCell=function(u,h,p,g,x,k){this.boxCells[x].push(k)},Ci.prototype._insertCircleCell=function(u,h,p,g,x,k){this.circleCells[x].push(k)},Ci.prototype._query=function(u,h,p,g,x,k){if(p<0||u>this.width||g<0||h>this.height)return!x&&[];var L=[];if(u<=0&&h<=0&&this.width<=p&&this.height<=g){if(x)return!0;for(var J=0;J<this.boxKeys.length;J++)L.push({key:this.boxKeys[J],x1:this.bboxes[4*J],y1:this.bboxes[4*J+1],x2:this.bboxes[4*J+2],y2:this.bboxes[4*J+3]});for(var K=0;K<this.circleKeys.length;K++){var ne=this.circles[3*K],_e=this.circles[3*K+1],ve=this.circles[3*K+2];L.push({key:this.circleKeys[K],x1:ne-ve,y1:_e-ve,x2:ne+ve,y2:_e+ve})}return k?L.filter(k):L}return this._forEachCell(u,h,p,g,this._queryCell,L,{hitTest:x,seenUids:{box:{},circle:{}}},k),x?L.length>0:L},Ci.prototype._queryCircle=function(u,h,p,g,x){var k=u-p,L=u+p,J=h-p,K=h+p;if(L<0||k>this.width||K<0||J>this.height)return!g&&[];var ne=[];return this._forEachCell(k,J,L,K,this._queryCellCircle,ne,{hitTest:g,circle:{x:u,y:h,radius:p},seenUids:{box:{},circle:{}}},x),g?ne.length>0:ne},Ci.prototype.query=function(u,h,p,g,x){return this._query(u,h,p,g,!1,x)},Ci.prototype.hitTest=function(u,h,p,g,x){return this._query(u,h,p,g,!0,x)},Ci.prototype.hitTestCircle=function(u,h,p,g){return this._queryCircle(u,h,p,!0,g)},Ci.prototype._queryCell=function(u,h,p,g,x,k,L,J){var K=L.seenUids,ne=this.boxCells[x];if(null!==ne)for(var _e=this.bboxes,ve=0,be=ne;ve<be.length;ve+=1){var Ee=be[ve];if(!K.box[Ee]){K.box[Ee]=!0;var Oe=4*Ee;if(u<=_e[Oe+2]&&h<=_e[Oe+3]&&p>=_e[Oe+0]&&g>=_e[Oe+1]&&(!J||J(this.boxKeys[Ee]))){if(L.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[Ee],x1:_e[Oe],y1:_e[Oe+1],x2:_e[Oe+2],y2:_e[Oe+3]})}}}var Re=this.circleCells[x];if(null!==Re)for(var Se=this.circles,De=0,Be=Re;De<Be.length;De+=1){var Xe=Be[De];if(!K.circle[Xe]){K.circle[Xe]=!0;var _t=3*Xe;if(this._circleAndRectCollide(Se[_t],Se[_t+1],Se[_t+2],u,h,p,g)&&(!J||J(this.circleKeys[Xe]))){if(L.hitTest)return k.push(!0),!0;var ct=Se[_t],yt=Se[_t+1],St=Se[_t+2];k.push({key:this.circleKeys[Xe],x1:ct-St,y1:yt-St,x2:ct+St,y2:yt+St})}}}},Ci.prototype._queryCellCircle=function(u,h,p,g,x,k,L,J){var K=L.circle,ne=L.seenUids,_e=this.boxCells[x];if(null!==_e)for(var ve=this.bboxes,be=0,Ee=_e;be<Ee.length;be+=1){var Oe=Ee[be];if(!ne.box[Oe]){ne.box[Oe]=!0;var Re=4*Oe;if(this._circleAndRectCollide(K.x,K.y,K.radius,ve[Re+0],ve[Re+1],ve[Re+2],ve[Re+3])&&(!J||J(this.boxKeys[Oe])))return k.push(!0),!0}}var Se=this.circleCells[x];if(null!==Se)for(var De=this.circles,Be=0,Xe=Se;Be<Xe.length;Be+=1){var _t=Xe[Be];if(!ne.circle[_t]){ne.circle[_t]=!0;var ct=3*_t;if(this._circlesCollide(De[ct],De[ct+1],De[ct+2],K.x,K.y,K.radius)&&(!J||J(this.circleKeys[_t])))return k.push(!0),!0}}},Ci.prototype._forEachCell=function(u,h,p,g,x,k,L,J){for(var K=this._convertToXCellCoord(u),ne=this._convertToYCellCoord(h),_e=this._convertToXCellCoord(p),ve=this._convertToYCellCoord(g),be=K;be<=_e;be++)for(var Ee=ne;Ee<=ve;Ee++)if(x.call(this,u,h,p,g,this.xCellCount*Ee+be,k,L,J))return},Ci.prototype._convertToXCellCoord=function(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))},Ci.prototype._convertToYCellCoord=function(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))},Ci.prototype._circlesCollide=function(u,h,p,g,x,k){var L=g-u,J=x-h,K=p+k;return K*K>L*L+J*J},Ci.prototype._circleAndRectCollide=function(u,h,p,g,x,k,L){var J=(k-g)/2,K=Math.abs(u-(g+J));if(K>J+p)return!1;var ne=(L-x)/2,_e=Math.abs(h-(x+ne));if(_e>ne+p)return!1;if(K<=J||_e<=ne)return!0;var ve=K-J,be=_e-ne;return ve*ve+be*be<=p*p};var nc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nr(u,h){for(var p=0;p<u;p++){var g=h.length;h.resize(g+4),h.float32.set(nc,3*g)}}function Bo(u,h,p){var g=h[0],x=h[1];return u[0]=p[0]*g+p[4]*x+p[12],u[1]=p[1]*g+p[5]*x+p[13],u[3]=p[3]*g+p[7]*x+p[15],u}var kr=function(u,h,p){void 0===h&&(h=new Ci(u.width+200,u.height+200,25)),void 0===p&&(p=new Ci(u.width+200,u.height+200,25)),this.transform=u,this.grid=h,this.ignoredGrid=p,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+100,this.screenBottomBoundary=u.height+100,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200};function no(u,h,p){return h*(d.EXTENT/(u.tileSize*Math.pow(2,p-u.tileID.overscaledZ)))}kr.prototype.placeCollisionBox=function(u,h,p,g,x){var k=this.projectAndGetPerspectiveRatio(g,u.anchorPointX,u.anchorPointY),L=p*k.perspectiveRatio,J=u.x1*L+k.point.x,K=u.y1*L+k.point.y,ne=u.x2*L+k.point.x,_e=u.y2*L+k.point.y;return!this.isInsideGrid(J,K,ne,_e)||!h&&this.grid.hitTest(J,K,ne,_e,x)?{box:[],offscreen:!1}:{box:[J,K,ne,_e],offscreen:this.isOffscreen(J,K,ne,_e)}},kr.prototype.placeCollisionCircles=function(u,h,p,g,x,k,L,J,K,ne,_e,ve,be){var Ee=[],Oe=new d.Point(h.anchorX,h.anchorY),Re=Zn(Oe,k),Se=wi(this.transform.cameraToCenterDistance,Re.signedDistanceFromCamera),De=(ne?x/Se:x*Se)/d.ONE_EM,Be=Zn(Oe,L).point,Xe=Yi(De,g,h.lineOffsetX*De,h.lineOffsetY*De,!1,Be,Oe,h,p,L,{}),_t=!1,ct=!1,yt=!0;if(Xe){for(var St=.5*ve*Se+be,Ut=new d.Point(-100,-100),Rt=new d.Point(this.screenRightBoundary,this.screenBottomBoundary),Kt=new jo,wn=Xe.first,Mn=Xe.last,En=[],_i=wn.path.length-1;_i>=1;_i--)En.push(wn.path[_i]);for(var Gt=1;Gt<Mn.path.length;Gt++)En.push(Mn.path[Gt]);var jn=2.5*St;if(J){var ti=En.map(function(Za){return Zn(Za,J)});En=ti.some(function(Za){return Za.signedDistanceFromCamera<=0})?[]:ti.map(function(Za){return Za.point})}var Fn=[];if(En.length>0){for(var Un=En[0].clone(),Xn=En[0].clone(),qn=1;qn<En.length;qn++)Un.x=Math.min(Un.x,En[qn].x),Un.y=Math.min(Un.y,En[qn].y),Xn.x=Math.max(Xn.x,En[qn].x),Xn.y=Math.max(Xn.y,En[qn].y);Fn=Un.x>=Ut.x&&Xn.x<=Rt.x&&Un.y>=Ut.y&&Xn.y<=Rt.y?[En]:Xn.x<Ut.x||Un.x>Rt.x||Xn.y<Ut.y||Un.y>Rt.y?[]:d.clipLine([En],Ut.x,Ut.y,Rt.x,Rt.y)}for(var bn=0,Do=Fn;bn<Do.length;bn+=1){var yo;Kt.reset(Do[bn],.25*St),yo=Kt.length<=.5*St?1:Math.ceil(Kt.paddedLength/jn)+1;for(var Or=0;Or<yo;Or++){var rr=Or/Math.max(yo-1,1),po=Kt.lerp(rr),wo=po.x+100,_a=po.y+100;Ee.push(wo,_a,St,0);var Wr=wo-St,ml=_a-St,Lr=wo+St,ma=_a+St;if(yt=yt&&this.isOffscreen(Wr,ml,Lr,ma),ct=ct||this.isInsideGrid(Wr,ml,Lr,ma),!u&&this.grid.hitTestCircle(wo,_a,St,_e)&&(_t=!0,!K))return{circles:[],offscreen:!1,collisionDetected:_t}}}}return{circles:!K&&_t||!ct?[]:Ee,offscreen:yt,collisionDetected:_t}},kr.prototype.queryRenderedSymbols=function(u){if(0===u.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var h=[],p=1/0,g=1/0,x=-1/0,k=-1/0,L=0,J=u;L<J.length;L+=1){var K=J[L],ne=new d.Point(K.x+100,K.y+100);p=Math.min(p,ne.x),g=Math.min(g,ne.y),x=Math.max(x,ne.x),k=Math.max(k,ne.y),h.push(ne)}for(var _e={},ve={},be=0,Ee=this.grid.query(p,g,x,k).concat(this.ignoredGrid.query(p,g,x,k));be<Ee.length;be+=1){var Oe=Ee[be],Re=Oe.key;if(void 0===_e[Re.bucketInstanceId]&&(_e[Re.bucketInstanceId]={}),!_e[Re.bucketInstanceId][Re.featureIndex]){var Se=[new d.Point(Oe.x1,Oe.y1),new d.Point(Oe.x2,Oe.y1),new d.Point(Oe.x2,Oe.y2),new d.Point(Oe.x1,Oe.y2)];d.polygonIntersectsPolygon(h,Se)&&(_e[Re.bucketInstanceId][Re.featureIndex]=!0,void 0===ve[Re.bucketInstanceId]&&(ve[Re.bucketInstanceId]=[]),ve[Re.bucketInstanceId].push(Re.featureIndex))}}return ve},kr.prototype.insertCollisionBox=function(u,h,p,g,x){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:x},u[0],u[1],u[2],u[3])},kr.prototype.insertCollisionCircles=function(u,h,p,g,x){for(var k=h?this.ignoredGrid:this.grid,L={bucketInstanceId:p,featureIndex:g,collisionGroupID:x},J=0;J<u.length;J+=4)k.insertCircle(L,u[J],u[J+1],u[J+2])},kr.prototype.projectAndGetPerspectiveRatio=function(u,h,p){var g=[h,p,0,1];return Bo(g,g,u),{point:new d.Point((g[0]/g[3]+1)/2*this.transform.width+100,(-g[1]/g[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}},kr.prototype.isOffscreen=function(u,h,p,g){return p<100||u>=this.screenRightBoundary||g<100||h>this.screenBottomBoundary},kr.prototype.isInsideGrid=function(u,h,p,g){return p>=0&&u<this.gridRightBoundary&&g>=0&&h<this.gridBottomBoundary},kr.prototype.getViewportMatrix=function(){var u=d.identity([]);return d.translate(u,u,[-100,-100,0]),u};var Ma=function(u,h,p,g){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?h:-h))):g&&p?1:0,this.placed=p};Ma.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Jr=function(u,h,p,g,x){this.text=new Ma(u?u.text:null,h,p,x),this.icon=new Ma(u?u.icon:null,h,g,x)};Jr.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Sc=function(u,h,p){this.text=u,this.icon=h,this.skipFade=p},jr=function(){this.invProjMatrix=d.create(),this.viewportMatrix=d.create(),this.circles=[]},R=function(u,h,p,g,x){this.bucketInstanceId=u,this.featureIndex=h,this.sourceLayerIndex=p,this.bucketIndex=g,this.tileID=x},B=function(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}};function Y(u,h,p,g,x){var k=d.getAnchorAlignment(u),L=-(k.horizontalAlign-.5)*h,J=-(k.verticalAlign-.5)*p,K=d.evaluateVariableOffset(u,g);return new d.Point(L+K[0]*x,J+K[1]*x)}function Je(u,h,p,g,x,k){var L=u.x1,J=u.x2,K=u.y1,ne=u.y2,_e=u.anchorPointX,ve=u.anchorPointY,be=new d.Point(h,p);return g&&be._rotate(x?k:-k),{x1:L+be.x,y1:K+be.y,x2:J+be.x,y2:ne+be.y,anchorPointX:_e,anchorPointY:ve}}B.prototype.get=function(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){var h=++this.maxGroupID;this.collisionGroups[u]={ID:h,predicate:function(p){return p.collisionGroupID===h}}}return this.collisionGroups[u]};var tt=function(u,h,p,g){this.transform=u.clone(),this.collisionIndex=new kr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new B(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function Qe(u,h,p,g,x){u.emplaceBack(h?1:0,p?1:0,g||0,x||0),u.emplaceBack(h?1:0,p?1:0,g||0,x||0),u.emplaceBack(h?1:0,p?1:0,g||0,x||0),u.emplaceBack(h?1:0,p?1:0,g||0,x||0)}tt.prototype.getBucketParts=function(u,h,p,g){var x=p.getBucket(h),k=p.latestFeatureIndex;if(x&&k&&h.id===x.layerIds[0]){var L=p.collisionBoxArray,J=x.layers[0].layout,K=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),ne=p.tileSize/d.EXTENT,_e=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),ve="map"===J.get("text-pitch-alignment"),be="map"===J.get("text-rotation-alignment"),Ee=no(p,1,this.transform.zoom),Oe=eo(_e,ve,be,this.transform,Ee),Re=null;if(ve){var Se=Oi(_e,ve,be,this.transform,Ee);Re=d.multiply([],this.transform.labelPlaneMatrix,Se)}this.retainedQueryData[x.bucketInstanceId]=new R(x.bucketInstanceId,k,x.sourceLayerIndex,x.index,p.tileID);var De={bucket:x,layout:J,posMatrix:_e,textLabelPlaneMatrix:Oe,labelToScreenMatrix:Re,scale:K,textPixelRatio:ne,holdingForFade:p.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:d.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(g)for(var Be=0,Xe=x.sortKeyRanges;Be<Xe.length;Be+=1){var _t=Xe[Be];u.push({sortKey:_t.sortKey,symbolInstanceStart:_t.symbolInstanceStart,symbolInstanceEnd:_t.symbolInstanceEnd,parameters:De})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:De})}},tt.prototype.attemptAnchorPlacement=function(u,h,p,g,x,k,L,J,K,ne,_e,ve,be,Ee,Oe){var Re,Se=[ve.textOffset0,ve.textOffset1],De=Y(u,p,g,Se,x),Be=this.collisionIndex.placeCollisionBox(Je(h,De.x,De.y,k,L,this.transform.angle),_e,J,K,ne.predicate);if(!Oe||0!==this.collisionIndex.placeCollisionBox(Je(Oe,De.x,De.y,k,L,this.transform.angle),_e,J,K,ne.predicate).box.length)return Be.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID].text&&(Re=this.prevPlacement.variableOffsets[ve.crossTileID].anchor),this.variableOffsets[ve.crossTileID]={textOffset:Se,width:p,height:g,anchor:u,textBoxScale:x,prevAnchor:Re},this.markUsedJustification(be,u,ve,Ee),be.allowVerticalPlacement&&(this.markUsedOrientation(be,Ee,ve),this.placedOrientations[ve.crossTileID]=Ee),{shift:De,placedGlyphBoxes:Be}):void 0},tt.prototype.placeLayerBucketPart=function(u,h,p){var g=this,x=u.parameters,k=x.bucket,L=x.layout,J=x.posMatrix,K=x.textLabelPlaneMatrix,ne=x.labelToScreenMatrix,_e=x.textPixelRatio,ve=x.holdingForFade,be=x.collisionBoxArray,Ee=x.partiallyEvaluatedTextSize,Oe=x.collisionGroup,Re=L.get("text-optional"),Se=L.get("icon-optional"),De=L.get("text-allow-overlap"),Be=L.get("icon-allow-overlap"),Xe="map"===L.get("text-rotation-alignment"),_t="map"===L.get("text-pitch-alignment"),ct="none"!==L.get("icon-text-fit"),yt="viewport-y"===L.get("symbol-z-order"),St=De&&(Be||!k.hasIconData()||Se),Ut=Be&&(De||!k.hasTextData()||Re);!k.collisionArrays&&be&&k.deserializeCollisionBoxes(be);var Rt=function(Gt,jn){if(!h[Gt.crossTileID])if(ve)g.placements[Gt.crossTileID]=new Sc(!1,!1,!1);else{var ti,Fn=!1,Un=!1,Xn=!0,qn=null,bn={box:null,offscreen:null},Do={box:null,offscreen:null},yo=null,Or=null,rr=0,po=0,wo=0;jn.textFeatureIndex?rr=jn.textFeatureIndex:Gt.useRuntimeCollisionCircles&&(rr=Gt.featureIndex),jn.verticalTextFeatureIndex&&(po=jn.verticalTextFeatureIndex);var _a=jn.textBox;if(_a){var Wr=function(Ii){var Na=d.WritingMode.horizontal;if(k.allowVerticalPlacement&&!Ii&&g.prevPlacement){var Xr=g.prevPlacement.placedOrientations[Gt.crossTileID];Xr&&(g.placedOrientations[Gt.crossTileID]=Xr,g.markUsedOrientation(k,Na=Xr,Gt))}return Na},ml=function(Ii,Na){if(k.allowVerticalPlacement&&Gt.numVerticalGlyphVertices>0&&jn.verticalTextBox)for(var Xr=0,Dl=k.writingModes;Xr<Dl.length&&(Dl[Xr]===d.WritingMode.vertical?(bn=Na(),Do=bn):bn=Ii(),!(bn&&bn.box&&bn.box.length));Xr+=1);else bn=Ii()};if(L.get("text-variable-anchor")){var Lr=L.get("text-variable-anchor");if(g.prevPlacement&&g.prevPlacement.variableOffsets[Gt.crossTileID]){var ma=g.prevPlacement.variableOffsets[Gt.crossTileID];Lr.indexOf(ma.anchor)>0&&(Lr=Lr.filter(function(Ii){return Ii!==ma.anchor})).unshift(ma.anchor)}var Za=function(Ii,Na,Xr){for(var Dl=Ii.x2-Ii.x1,Gd=Ii.y2-Ii.y1,Pu=Gt.textBoxScale,Vd=ct&&!Be?Na:null,jc={box:[],offscreen:!1},jp=De?2*Lr.length:Lr.length,dc=0;dc<jp;++dc){var Eu=g.attemptAnchorPlacement(Lr[dc%Lr.length],Ii,Dl,Gd,Pu,Xe,_t,_e,J,Oe,dc>=Lr.length,Gt,k,Xr,Vd);if(Eu&&(jc=Eu.placedGlyphBoxes)&&jc.box&&jc.box.length){Fn=!0,qn=Eu.shift;break}}return jc};ml(function(){return Za(_a,jn.iconBox,d.WritingMode.horizontal)},function(){var Ii=jn.verticalTextBox;return k.allowVerticalPlacement&&!(bn&&bn.box&&bn.box.length)&&Gt.numVerticalGlyphVertices>0&&Ii?Za(Ii,jn.verticalIconBox,d.WritingMode.vertical):{box:null,offscreen:null}}),bn&&(Fn=bn.box,Xn=bn.offscreen);var Su=Wr(bn&&bn.box);if(!Fn&&g.prevPlacement){var qc=g.prevPlacement.variableOffsets[Gt.crossTileID];qc&&(g.variableOffsets[Gt.crossTileID]=qc,g.markUsedJustification(k,qc.anchor,Gt,Su))}}else{var Ps=function(Ii,Na){var Xr=g.collisionIndex.placeCollisionBox(Ii,De,_e,J,Oe.predicate);return Xr&&Xr.box&&Xr.box.length&&(g.markUsedOrientation(k,Na,Gt),g.placedOrientations[Gt.crossTileID]=Na),Xr};ml(function(){return Ps(_a,d.WritingMode.horizontal)},function(){var Ii=jn.verticalTextBox;return k.allowVerticalPlacement&&Gt.numVerticalGlyphVertices>0&&Ii?Ps(Ii,d.WritingMode.vertical):{box:null,offscreen:null}}),Wr(bn&&bn.box&&bn.box.length)}}if(Fn=(ti=bn)&&ti.box&&ti.box.length>0,Xn=ti&&ti.offscreen,Gt.useRuntimeCollisionCircles){var yl=k.text.placedSymbolArray.get(Gt.centerJustifiedTextSymbolIndex),Jc=d.evaluateSizeForFeature(k.textSizeData,Ee,yl),Es=L.get("text-padding");yo=g.collisionIndex.placeCollisionCircles(De,yl,k.lineVertexArray,k.glyphOffsetArray,Jc,J,K,ne,p,_t,Oe.predicate,Gt.collisionCircleDiameter,Es),Fn=De||yo.circles.length>0&&!yo.collisionDetected,Xn=Xn&&yo.offscreen}if(jn.iconFeatureIndex&&(wo=jn.iconFeatureIndex),jn.iconBox){var pc=function(Ii){var Na=ct&&qn?Je(Ii,qn.x,qn.y,Xe,_t,g.transform.angle):Ii;return g.collisionIndex.placeCollisionBox(Na,Be,_e,J,Oe.predicate)};Un=Do&&Do.box&&Do.box.length&&jn.verticalIconBox?(Or=pc(jn.verticalIconBox)).box.length>0:(Or=pc(jn.iconBox)).box.length>0,Xn=Xn&&Or.offscreen}var fs=Re||0===Gt.numHorizontalGlyphVertices&&0===Gt.numVerticalGlyphVertices,er=Se||0===Gt.numIconVertices;if(fs||er?er?fs||(Un=Un&&Fn):Fn=Un&&Fn:Un=Fn=Un&&Fn,Fn&&ti&&ti.box&&g.collisionIndex.insertCollisionBox(ti.box,L.get("text-ignore-placement"),k.bucketInstanceId,Do&&Do.box&&po?po:rr,Oe.ID),Un&&Or&&g.collisionIndex.insertCollisionBox(Or.box,L.get("icon-ignore-placement"),k.bucketInstanceId,wo,Oe.ID),yo&&(Fn&&g.collisionIndex.insertCollisionCircles(yo.circles,L.get("text-ignore-placement"),k.bucketInstanceId,rr,Oe.ID),p)){var Ws=k.bucketInstanceId,vl=g.collisionCircleArrays[Ws];void 0===vl&&(vl=g.collisionCircleArrays[Ws]=new jr);for(var zl=0;zl<yo.circles.length;zl+=4)vl.circles.push(yo.circles[zl+0]),vl.circles.push(yo.circles[zl+1]),vl.circles.push(yo.circles[zl+2]),vl.circles.push(yo.collisionDetected?1:0)}g.placements[Gt.crossTileID]=new Sc(Fn||St,Un||Ut,Xn||k.justReloaded),h[Gt.crossTileID]=!0}};if(yt)for(var Kt=k.getSortedSymbolIndexes(this.transform.angle),wn=Kt.length-1;wn>=0;--wn){var Mn=Kt[wn];Rt(k.symbolInstances.get(Mn),k.collisionArrays[Mn])}else for(var En=u.symbolInstanceStart;En<u.symbolInstanceEnd;En++)Rt(k.symbolInstances.get(En),k.collisionArrays[En]);if(p&&k.bucketInstanceId in this.collisionCircleArrays){var _i=this.collisionCircleArrays[k.bucketInstanceId];d.invert(_i.invProjMatrix,J),_i.viewportMatrix=this.collisionIndex.getViewportMatrix()}k.justReloaded=!1},tt.prototype.markUsedJustification=function(u,h,p,g){var x;x=g===d.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[d.getAnchorJustification(h)];for(var k=0,L=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];k<L.length;k+=1){var J=L[k];J>=0&&(u.text.placedSymbolArray.get(J).crossTileID=x>=0&&J!==x?0:p.crossTileID)}},tt.prototype.markUsedOrientation=function(u,h,p){for(var g=h===d.WritingMode.horizontal||h===d.WritingMode.horizontalOnly?h:0,x=h===d.WritingMode.vertical?h:0,k=0,L=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];k<L.length;k+=1)u.text.placedSymbolArray.get(L[k]).placedOrientation=g;p.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=x)},tt.prototype.commit=function(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;var h=this.prevPlacement,p=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;var g=h?h.symbolFadeChange(u):1,x=h?h.opacities:{},k=h?h.variableOffsets:{},L=h?h.placedOrientations:{};for(var J in this.placements){var K=this.placements[J],ne=x[J];ne?(this.opacities[J]=new Jr(ne,g,K.text,K.icon),p=p||K.text!==ne.text.placed||K.icon!==ne.icon.placed):(this.opacities[J]=new Jr(null,g,K.text,K.icon,K.skipFade),p=p||K.text||K.icon)}for(var _e in x){var ve=x[_e];if(!this.opacities[_e]){var be=new Jr(ve,g,!1,!1);be.isHidden()||(this.opacities[_e]=be,p=p||ve.text.placed||ve.icon.placed)}}for(var Ee in k)this.variableOffsets[Ee]||!this.opacities[Ee]||this.opacities[Ee].isHidden()||(this.variableOffsets[Ee]=k[Ee]);for(var Oe in L)this.placedOrientations[Oe]||!this.opacities[Oe]||this.opacities[Oe].isHidden()||(this.placedOrientations[Oe]=L[Oe]);p?this.lastPlacementChangeTime=u:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:u)},tt.prototype.updateLayerOpacities=function(u,h){for(var p={},g=0,x=h;g<x.length;g+=1){var k=x[g],L=k.getBucket(u);L&&k.latestFeatureIndex&&u.id===L.layerIds[0]&&this.updateBucketOpacities(L,p,k.collisionBoxArray)}},tt.prototype.updateBucketOpacities=function(u,h,p){var g=this;u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();var x=u.layers[0].layout,k=new Jr(null,0,!1,!1,!0),L=x.get("text-allow-overlap"),J=x.get("icon-allow-overlap"),K=x.get("text-variable-anchor"),ne="map"===x.get("text-rotation-alignment"),_e="map"===x.get("text-pitch-alignment"),ve="none"!==x.get("icon-text-fit"),be=new Jr(null,0,L&&(J||!u.hasIconData()||x.get("icon-optional")),J&&(L||!u.hasTextData()||x.get("text-optional")),!0);!u.collisionArrays&&p&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(p);for(var Ee=function(De,Be,Xe){for(var _t=0;_t<Be/4;_t++)De.opacityVertexArray.emplaceBack(Xe)},Oe=function(De){var Be=u.symbolInstances.get(De),Xe=Be.numHorizontalGlyphVertices,_t=Be.numVerticalGlyphVertices,ct=Be.crossTileID,yt=g.opacities[ct];h[ct]?yt=k:yt||(g.opacities[ct]=yt=be),h[ct]=!0;var St=Be.numIconVertices>0,Ut=g.placedOrientations[Be.crossTileID],Rt=Ut===d.WritingMode.vertical,Kt=Ut===d.WritingMode.horizontal||Ut===d.WritingMode.horizontalOnly;if(Xe>0||_t>0){var wn=In(yt.text);Ee(u.text,Xe,Rt?Nn:wn),Ee(u.text,_t,Kt?Nn:wn);var Mn=yt.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(function(bn){bn>=0&&(u.text.placedSymbolArray.get(bn).hidden=Mn||Rt?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=Mn||Kt?1:0);var En=g.variableOffsets[Be.crossTileID];En&&g.markUsedJustification(u,En.anchor,Be,Ut);var _i=g.placedOrientations[Be.crossTileID];_i&&(g.markUsedJustification(u,"left",Be,_i),g.markUsedOrientation(u,_i,Be))}if(St){var Gt=In(yt.icon),jn=!(ve&&Be.verticalPlacedIconSymbolIndex&&Rt);Be.placedIconSymbolIndex>=0&&(Ee(u.icon,Be.numIconVertices,jn?Gt:Nn),u.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=yt.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(Ee(u.icon,Be.numVerticalIconVertices,jn?Nn:Gt),u.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=yt.icon.isHidden())}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){var ti=u.collisionArrays[De];if(ti){var Fn=new d.Point(0,0);if(ti.textBox||ti.verticalTextBox){var Un=!0;if(K){var Xn=g.variableOffsets[ct];Xn?(Fn=Y(Xn.anchor,Xn.width,Xn.height,Xn.textOffset,Xn.textBoxScale),ne&&Fn._rotate(_e?g.transform.angle:-g.transform.angle)):Un=!1}ti.textBox&&Qe(u.textCollisionBox.collisionVertexArray,yt.text.placed,!Un||Rt,Fn.x,Fn.y),ti.verticalTextBox&&Qe(u.textCollisionBox.collisionVertexArray,yt.text.placed,!Un||Kt,Fn.x,Fn.y)}var qn=Boolean(!Kt&&ti.verticalIconBox);ti.iconBox&&Qe(u.iconCollisionBox.collisionVertexArray,yt.icon.placed,qn,ve?Fn.x:0,ve?Fn.y:0),ti.verticalIconBox&&Qe(u.iconCollisionBox.collisionVertexArray,yt.icon.placed,!qn,ve?Fn.x:0,ve?Fn.y:0)}}},Re=0;Re<u.symbolInstances.length;Re++)Oe(Re);if(u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){var Se=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Se.invProjMatrix,u.placementViewportMatrix=Se.viewportMatrix,u.collisionCircleArray=Se.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}},tt.prototype.symbolFadeChange=function(u){return 0===this.fadeDuration?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},tt.prototype.zoomAdjustment=function(u){return Math.max(0,(this.transform.zoom-u)/1.5)},tt.prototype.hasTransitions=function(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration},tt.prototype.stillRecent=function(u,h){var p=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*p>u},tt.prototype.setStale=function(){this.stale=!0};var rt=Math.pow(2,25),Ft=Math.pow(2,24),Dt=Math.pow(2,17),dn=Math.pow(2,16),ut=Math.pow(2,9),tn=Math.pow(2,8),hn=Math.pow(2,1);function In(u){if(0===u.opacity&&!u.placed)return 0;if(1===u.opacity&&u.placed)return 4294967295;var h=u.placed?1:0,p=Math.floor(127*u.opacity);return p*rt+h*Ft+p*Dt+h*dn+p*ut+h*tn+p*hn+h}var Nn=0,Wi=function(u){this._sortAcrossTiles="viewport-y"!==u.layout.get("symbol-z-order")&&void 0!==u.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Wi.prototype.continuePlacement=function(u,h,p,g,x){for(var k=this._bucketParts;this._currentTileIndex<u.length;)if(h.getBucketParts(k,g,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort(function(L,J){return L.sortKey-J.sortKey}));this._currentPartIndex<k.length;)if(h.placeLayerBucketPart(k[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,x())return!0;return!1};var Ot=function(u,h,p,g,x,k,L){this.placement=new tt(u,x,k,L),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1};Ot.prototype.isDone=function(){return this._done},Ot.prototype.continuePlacement=function(u,h,p){for(var g=this,x=d.browser.now(),k=function(){var K=d.browser.now()-x;return!g._forceFullPlacement&&K>2};this._currentPlacementIndex>=0;){var L=h[u[this._currentPlacementIndex]],J=this.placement.collisionIndex.transform.zoom;if("symbol"===L.type&&(!L.minzoom||L.minzoom<=J)&&(!L.maxzoom||L.maxzoom>J)){if(this._inProgressLayer||(this._inProgressLayer=new Wi(L)),this._inProgressLayer.continuePlacement(p[L.source],this.placement,this._showCollisionBoxes,L,k))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ot.prototype.commit=function(u){return this.placement.commit(u),this.placement};var yn=512/d.EXTENT/2,Zt=function(u,h,p){this.tileID=u,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(var g=0;g<h.length;g++){var x=h.get(g),k=x.key;this.indexedSymbolInstances[k]||(this.indexedSymbolInstances[k]=[]),this.indexedSymbolInstances[k].push({crossTileID:x.crossTileID,coord:this.getScaledCoordinates(x,u)})}};Zt.prototype.getScaledCoordinates=function(u,h){var p=yn/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*d.EXTENT+u.anchorX)*p),y:Math.floor((h.canonical.y*d.EXTENT+u.anchorY)*p)}},Zt.prototype.findMatches=function(u,h,p){for(var g=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),x=0;x<u.length;x++){var k=u.get(x);if(!k.crossTileID){var L=this.indexedSymbolInstances[k.key];if(L)for(var J=this.getScaledCoordinates(k,h),K=0,ne=L;K<ne.length;K+=1){var _e=ne[K];if(Math.abs(_e.coord.x-J.x)<=g&&Math.abs(_e.coord.y-J.y)<=g&&!p[_e.crossTileID]){p[_e.crossTileID]=!0,k.crossTileID=_e.crossTileID;break}}}}};var ci=function(){this.maxCrossTileID=0};ci.prototype.generate=function(){return++this.maxCrossTileID};var Ji=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ji.prototype.handleWrapJump=function(u){var h=Math.round((u-this.lng)/360);if(0!==h)for(var p in this.indexes){var g=this.indexes[p],x={};for(var k in g){var L=g[k];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+h),x[L.tileID.key]=L}this.indexes[p]=x}this.lng=u},Ji.prototype.addBucket=function(u,h,p){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(var g=0;g<h.symbolInstances.length;g++)h.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});var x=this.usedCrossTileIDs[u.overscaledZ];for(var k in this.indexes){var L=this.indexes[k];if(Number(k)>u.overscaledZ)for(var J in L){var K=L[J];K.tileID.isChildOf(u)&&K.findMatches(h.symbolInstances,u,x)}else{var ne=L[u.scaledTo(Number(k)).key];ne&&ne.findMatches(h.symbolInstances,u,x)}}for(var _e=0;_e<h.symbolInstances.length;_e++){var ve=h.symbolInstances.get(_e);ve.crossTileID||(ve.crossTileID=p.generate(),x[ve.crossTileID]=!0)}return void 0===this.indexes[u.overscaledZ]&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Zt(u,h.symbolInstances,h.bucketInstanceId),!0},Ji.prototype.removeBucketCrossTileIDs=function(u,h){for(var p in h.indexedSymbolInstances)for(var g=0,x=h.indexedSymbolInstances[p];g<x.length;g+=1)delete this.usedCrossTileIDs[u][x[g].crossTileID]},Ji.prototype.removeStaleBuckets=function(u){var h=!1;for(var p in this.indexes){var g=this.indexes[p];for(var x in g)u[g[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,g[x]),delete g[x],h=!0)}return h};var Tn=function(){this.layerIndexes={},this.crossTileIDs=new ci,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Tn.prototype.addLayer=function(u,h,p){var g=this.layerIndexes[u.id];void 0===g&&(g=this.layerIndexes[u.id]=new Ji);var x=!1,k={};g.handleWrapJump(p);for(var L=0,J=h;L<J.length;L+=1){var K=J[L],ne=K.getBucket(u);ne&&u.id===ne.layerIds[0]&&(ne.bucketInstanceId||(ne.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(K.tileID,ne,this.crossTileIDs)&&(x=!0),k[ne.bucketInstanceId]=!0)}return g.removeStaleBuckets(k)&&(x=!0),x},Tn.prototype.pruneUnusedLayers=function(u){var h={};for(var p in u.forEach(function(g){h[g]=!0}),this.layerIndexes)h[p]||delete this.layerIndexes[p]};var Br=function(u,h){return d.emitValidationErrors(u,h&&h.filter(function(p){return"source.canvas"!==p.identifier}))},xr=d.pick(Yt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ui=d.pick(Yt,["setCenter","setZoom","setBearing","setPitch"]),Ir=function(){var u={},h=d.styleSpec.$version;for(var p in d.styleSpec.$root){var g,x=d.styleSpec.$root[p];x.required&&null!=(g="version"===p?h:"array"===x.type?[]:{})&&(u[p]=g)}return u}(),Hi=function(u){function h(p,g){var x=this;void 0===g&&(g={}),u.call(this),this.map=p,this.dispatcher=new oe(ft(),this),this.imageManager=new W,this.imageManager.setEventedParent(this),this.glyphManager=new Ue(p._requestManager,g.localIdeographFontFamily),this.lineAtlas=new ie(256,512),this.crossTileSymbolIndex=new Tn,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",d.getReferrer());var k=this;this._rtlTextPluginCallback=h.registerForPluginStateChange(function(L){k.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(J,K){if(d.triggerPluginCompletionEvent(J),K&&K.every(function(_e){return _e}))for(var ne in k.sourceCaches)k.sourceCaches[ne].reload()})}),this.on("data",function(L){if("source"===L.dataType&&"metadata"===L.sourceDataType){var J=x.sourceCaches[L.sourceId];if(J){var K=J.getSource();if(K&&K.vectorLayerIds)for(var ne in x._layers){var _e=x._layers[ne];_e.source===K.id&&x._validateLayer(_e)}}}})}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.loadURL=function(p,g){var x=this;void 0===g&&(g={}),this.fire(new d.Event("dataloading",{dataType:"style"}));var k="boolean"==typeof g.validate?g.validate:!d.isMapboxURL(p);p=this.map._requestManager.normalizeStyleURL(p,g.accessToken);var L=this.map._requestManager.transformRequest(p,d.ResourceType.Style);this._request=d.getJSON(L,function(J,K){x._request=null,J?x.fire(new d.ErrorEvent(J)):K&&x._load(K,k)})},h.prototype.loadJSON=function(p,g){var x=this;void 0===g&&(g={}),this.fire(new d.Event("dataloading",{dataType:"style"})),this._request=d.browser.frame(function(){x._request=null,x._load(p,!1!==g.validate)})},h.prototype.loadEmpty=function(){this.fire(new d.Event("dataloading",{dataType:"style"})),this._load(Ir,!1)},h.prototype._load=function(p,g){if(!g||!Br(this,d.validateStyle(p))){for(var x in this._loaded=!0,this.stylesheet=p,p.sources)this.addSource(x,p.sources[x],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs);var k=Jt(this.stylesheet.layers);this._order=k.map(function(ne){return ne.id}),this._layers={},this._serializedLayers={};for(var L=0,J=k;L<J.length;L+=1){var K=J[L];(K=d.createStyleLayer(K)).setEventedParent(this,{layer:{id:K.id}}),this._layers[K.id]=K,this._serializedLayers[K.id]=K.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new X(this.stylesheet.light),this.fire(new d.Event("data",{dataType:"style"})),this.fire(new d.Event("style.load"))}},h.prototype._loadSprite=function(p){var g=this;this._spriteRequest=function(x,k,L){var J,K,ne,_e=d.browser.devicePixelRatio>1?"@2x":"",ve=d.getJSON(k.transformRequest(k.normalizeSpriteURL(x,_e,".json"),d.ResourceType.SpriteJSON),function(Oe,Re){ve=null,ne||(ne=Oe,J=Re,Ee())}),be=d.getImage(k.transformRequest(k.normalizeSpriteURL(x,_e,".png"),d.ResourceType.SpriteImage),function(Oe,Re){be=null,ne||(ne=Oe,K=Re,Ee())});function Ee(){if(ne)L(ne);else if(J&&K){var Oe=d.browser.getImageData(K),Re={};for(var Se in J){var De=J[Se],Be=De.width,Xe=De.height,_t=De.x,ct=De.y,yt=De.sdf,St=De.pixelRatio,Ut=De.stretchX,Rt=De.stretchY,Kt=De.content,wn=new d.RGBAImage({width:Be,height:Xe});d.RGBAImage.copy(Oe,wn,{x:_t,y:ct},{x:0,y:0},{width:Be,height:Xe}),Re[Se]={data:wn,pixelRatio:St,sdf:yt,stretchX:Ut,stretchY:Rt,content:Kt}}L(null,Re)}}return{cancel:function(){ve&&(ve.cancel(),ve=null),be&&(be.cancel(),be=null)}}}(p,this.map._requestManager,function(x,k){if(g._spriteRequest=null,x)g.fire(new d.ErrorEvent(x));else if(k)for(var L in k)g.imageManager.addImage(L,k[L]);g.imageManager.setLoaded(!0),g._availableImages=g.imageManager.listImages(),g.dispatcher.broadcast("setImages",g._availableImages),g.fire(new d.Event("data",{dataType:"style"}))})},h.prototype._validateLayer=function(p){var g=this.sourceCaches[p.source];if(g){var x=p.sourceLayer;if(x){var k=g.getSource();("geojson"===k.type||k.vectorLayerIds&&-1===k.vectorLayerIds.indexOf(x))&&this.fire(new d.ErrorEvent(new Error('Source layer "'+x+'" does not exist on source "'+k.id+'" as specified by style layer "'+p.id+'"')))}}},h.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var p in this.sourceCaches)if(!this.sourceCaches[p].loaded())return!1;return!!this.imageManager.isLoaded()},h.prototype._serializeLayers=function(p){for(var g=[],x=0,k=p;x<k.length;x+=1){var L=this._layers[k[x]];"custom"!==L.type&&g.push(L.serialize())}return g},h.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var p in this.sourceCaches)if(this.sourceCaches[p].hasTransition())return!0;for(var g in this._layers)if(this._layers[g].hasTransition())return!0;return!1},h.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},h.prototype.update=function(p){if(this._loaded){var g=this._changed;if(this._changed){var x=Object.keys(this._updatedLayers),k=Object.keys(this._removedLayers);for(var L in(x.length||k.length)&&this._updateWorkerLayers(x,k),this._updatedSources){var J=this._updatedSources[L];"reload"===J?this._reloadSource(L):"clear"===J&&this._clearSource(L)}for(var K in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[K].updateTransitions(p);this.light.updateTransitions(p),this._resetUpdates()}var ne={};for(var _e in this.sourceCaches){var ve=this.sourceCaches[_e];ne[_e]=ve.used,ve.used=!1}for(var be=0,Ee=this._order;be<Ee.length;be+=1){var Oe=this._layers[Ee[be]];Oe.recalculate(p,this._availableImages),!Oe.isHidden(p.zoom)&&Oe.source&&(this.sourceCaches[Oe.source].used=!0)}for(var Re in ne){var Se=this.sourceCaches[Re];ne[Re]!==Se.used&&Se.fire(new d.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Re}))}this.light.recalculate(p),this.z=p.zoom,g&&this.fire(new d.Event("data",{dataType:"style"}))}},h.prototype._updateTilesForChangedImages=function(){var p=Object.keys(this._changedImages);if(p.length){for(var g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],p);this._changedImages={}}},h.prototype._updateWorkerLayers=function(p,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(p),removedIds:g})},h.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},h.prototype.setState=function(p){var g=this;if(this._checkLoaded(),Br(this,d.validateStyle(p)))return!1;(p=d.clone$1(p)).layers=Jt(p.layers);var x=function(L,J){if(!L)return[{command:Yt.setStyle,args:[J]}];var K=[];try{if(!d.deepEqual(L.version,J.version))return[{command:Yt.setStyle,args:[J]}];d.deepEqual(L.center,J.center)||K.push({command:Yt.setCenter,args:[J.center]}),d.deepEqual(L.zoom,J.zoom)||K.push({command:Yt.setZoom,args:[J.zoom]}),d.deepEqual(L.bearing,J.bearing)||K.push({command:Yt.setBearing,args:[J.bearing]}),d.deepEqual(L.pitch,J.pitch)||K.push({command:Yt.setPitch,args:[J.pitch]}),d.deepEqual(L.sprite,J.sprite)||K.push({command:Yt.setSprite,args:[J.sprite]}),d.deepEqual(L.glyphs,J.glyphs)||K.push({command:Yt.setGlyphs,args:[J.glyphs]}),d.deepEqual(L.transition,J.transition)||K.push({command:Yt.setTransition,args:[J.transition]}),d.deepEqual(L.light,J.light)||K.push({command:Yt.setLight,args:[J.light]});var ne={},_e=[];!function(be,Ee,Oe,Re){var Se;for(Se in Ee=Ee||{},be=be||{})be.hasOwnProperty(Se)&&(Ee.hasOwnProperty(Se)||Wt(Se,Oe,Re));for(Se in Ee)Ee.hasOwnProperty(Se)&&(be.hasOwnProperty(Se)?d.deepEqual(be[Se],Ee[Se])||("geojson"===be[Se].type&&"geojson"===Ee[Se].type&&zi(be,Ee,Se)?Oe.push({command:Yt.setGeoJSONSourceData,args:[Se,Ee[Se].data]}):li(Se,Ee,Oe,Re)):Gn(Se,Ee,Oe))}(L.sources,J.sources,_e,ne);var ve=[];L.layers&&L.layers.forEach(function(be){ne[be.source]?K.push({command:Yt.removeLayer,args:[be.id]}):ve.push(be)}),K=K.concat(_e),function(be,Ee,Oe){Ee=Ee||[];var Re,Se,De,Be,Xe,_t,ct,yt=(be=be||[]).map(vi),St=Ee.map(vi),Ut=be.reduce(ri,{}),Rt=Ee.reduce(ri,{}),Kt=yt.slice(),wn=Object.create(null);for(Re=0,Se=0;Re<yt.length;Re++)Rt.hasOwnProperty(De=yt[Re])?Se++:(Oe.push({command:Yt.removeLayer,args:[De]}),Kt.splice(Kt.indexOf(De,Se),1));for(Re=0,Se=0;Re<St.length;Re++)Kt[Kt.length-1-Re]!==(De=St[St.length-1-Re])&&(Ut.hasOwnProperty(De)?(Oe.push({command:Yt.removeLayer,args:[De]}),Kt.splice(Kt.lastIndexOf(De,Kt.length-Se),1)):Se++,Oe.push({command:Yt.addLayer,args:[Rt[De],_t=Kt[Kt.length-Re]]}),Kt.splice(Kt.length-Re,0,De),wn[De]=!0);for(Re=0;Re<St.length;Re++)if(Be=Ut[De=St[Re]],Xe=Rt[De],!wn[De]&&!d.deepEqual(Be,Xe))if(d.deepEqual(Be.source,Xe.source)&&d.deepEqual(Be["source-layer"],Xe["source-layer"])&&d.deepEqual(Be.type,Xe.type)){for(ct in zn(Be.layout,Xe.layout,Oe,De,null,Yt.setLayoutProperty),zn(Be.paint,Xe.paint,Oe,De,null,Yt.setPaintProperty),d.deepEqual(Be.filter,Xe.filter)||Oe.push({command:Yt.setFilter,args:[De,Xe.filter]}),d.deepEqual(Be.minzoom,Xe.minzoom)&&d.deepEqual(Be.maxzoom,Xe.maxzoom)||Oe.push({command:Yt.setLayerZoomRange,args:[De,Xe.minzoom,Xe.maxzoom]}),Be)Be.hasOwnProperty(ct)&&"layout"!==ct&&"paint"!==ct&&"filter"!==ct&&"metadata"!==ct&&"minzoom"!==ct&&"maxzoom"!==ct&&(0===ct.indexOf("paint.")?zn(Be[ct],Xe[ct],Oe,De,ct.slice(6),Yt.setPaintProperty):d.deepEqual(Be[ct],Xe[ct])||Oe.push({command:Yt.setLayerProperty,args:[De,ct,Xe[ct]]}));for(ct in Xe)Xe.hasOwnProperty(ct)&&!Be.hasOwnProperty(ct)&&"layout"!==ct&&"paint"!==ct&&"filter"!==ct&&"metadata"!==ct&&"minzoom"!==ct&&"maxzoom"!==ct&&(0===ct.indexOf("paint.")?zn(Be[ct],Xe[ct],Oe,De,ct.slice(6),Yt.setPaintProperty):d.deepEqual(Be[ct],Xe[ct])||Oe.push({command:Yt.setLayerProperty,args:[De,ct,Xe[ct]]}))}else Oe.push({command:Yt.removeLayer,args:[De]}),_t=Kt[Kt.lastIndexOf(De)+1],Oe.push({command:Yt.addLayer,args:[Xe,_t]})}(ve,J.layers,K)}catch(be){console.warn("Unable to compute style diff:",be),K=[{command:Yt.setStyle,args:[J]}]}return K}(this.serialize(),p).filter(function(L){return!(L.command in ui)});if(0===x.length)return!1;var k=x.filter(function(L){return!(L.command in xr)});if(k.length>0)throw new Error("Unimplemented: "+k.map(function(L){return L.command}).join(", ")+".");return x.forEach(function(L){"setTransition"!==L.command&&g[L.command].apply(g,L.args)}),this.stylesheet=p,!0},h.prototype.addImage=function(p,g){if(this.getImage(p))return this.fire(new d.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(p,g),this._afterImageUpdated(p)},h.prototype.updateImage=function(p,g){this.imageManager.updateImage(p,g)},h.prototype.getImage=function(p){return this.imageManager.getImage(p)},h.prototype.removeImage=function(p){if(!this.getImage(p))return this.fire(new d.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(p),this._afterImageUpdated(p)},h.prototype._afterImageUpdated=function(p){this._availableImages=this.imageManager.listImages(),this._changedImages[p]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.Event("data",{dataType:"style"}))},h.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},h.prototype.addSource=function(p,g,x){var k=this;if(void 0===x&&(x={}),this._checkLoaded(),void 0!==this.sourceCaches[p])throw new Error("There is already a source with this ID");if(!g.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(g).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(d.validateStyle.source,"sources."+p,g,null,x))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var L=this.sourceCaches[p]=new Ze(p,g,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:k.loaded(),source:L.serialize(),sourceId:p}}),L.onAdd(this.map),this._changed=!0}},h.prototype.removeSource=function(p){if(this._checkLoaded(),void 0===this.sourceCaches[p])throw new Error("There is no source with this ID");for(var g in this._layers)if(this._layers[g].source===p)return this.fire(new d.ErrorEvent(new Error('Source "'+p+'" cannot be removed while layer "'+g+'" is using it.')));var x=this.sourceCaches[p];delete this.sourceCaches[p],delete this._updatedSources[p],x.fire(new d.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:p})),x.setEventedParent(null),x.clearTiles(),x.onRemove&&x.onRemove(this.map),this._changed=!0},h.prototype.setGeoJSONSourceData=function(p,g){this._checkLoaded(),this.sourceCaches[p].getSource().setData(g),this._changed=!0},h.prototype.getSource=function(p){return this.sourceCaches[p]&&this.sourceCaches[p].getSource()},h.prototype.addLayer=function(p,g,x){void 0===x&&(x={}),this._checkLoaded();var k=p.id;if(this.getLayer(k))this.fire(new d.ErrorEvent(new Error('Layer with id "'+k+'" already exists on this map')));else{var L;if("custom"===p.type){if(Br(this,d.validateCustomStyleLayer(p)))return;L=d.createStyleLayer(p)}else{if("object"==typeof p.source&&(this.addSource(k,p.source),p=d.clone$1(p),p=d.extend(p,{source:k})),this._validate(d.validateStyle.layer,"layers."+k,p,{arrayIndex:-1},x))return;L=d.createStyleLayer(p),this._validateLayer(L),L.setEventedParent(this,{layer:{id:k}}),this._serializedLayers[L.id]=L.serialize()}var J=g?this._order.indexOf(g):this._order.length;if(g&&-1===J)this.fire(new d.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.')));else{if(this._order.splice(J,0,k),this._layerOrderChanged=!0,this._layers[k]=L,this._removedLayers[k]&&L.source&&"custom"!==L.type){var K=this._removedLayers[k];delete this._removedLayers[k],K.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},h.prototype.moveLayer=function(p,g){if(this._checkLoaded(),this._changed=!0,this._layers[p]){if(p!==g){var x=this._order.indexOf(p);this._order.splice(x,1);var k=g?this._order.indexOf(g):this._order.length;g&&-1===k?this.fire(new d.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.'))):(this._order.splice(k,0,p),this._layerOrderChanged=!0)}}else this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be moved.")))},h.prototype.removeLayer=function(p){this._checkLoaded();var g=this._layers[p];if(g){g.setEventedParent(null);var x=this._order.indexOf(p);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[p]=g,delete this._layers[p],delete this._serializedLayers[p],delete this._updatedLayers[p],delete this._updatedPaintProps[p],g.onRemove&&g.onRemove(this.map)}else this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be removed.")))},h.prototype.getLayer=function(p){return this._layers[p]},h.prototype.hasLayer=function(p){return p in this._layers},h.prototype.setLayerZoomRange=function(p,g,x){this._checkLoaded();var k=this.getLayer(p);k?k.minzoom===g&&k.maxzoom===x||(null!=g&&(k.minzoom=g),null!=x&&(k.maxzoom=x),this._updateLayer(k)):this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot have zoom extent.")))},h.prototype.setFilter=function(p,g,x){void 0===x&&(x={}),this._checkLoaded();var k=this.getLayer(p);if(k){if(!d.deepEqual(k.filter,g))return null==g?(k.filter=void 0,void this._updateLayer(k)):void(this._validate(d.validateStyle.filter,"layers."+k.id+".filter",g,null,x)||(k.filter=d.clone$1(g),this._updateLayer(k)))}else this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be filtered.")))},h.prototype.getFilter=function(p){return d.clone$1(this.getLayer(p).filter)},h.prototype.setLayoutProperty=function(p,g,x,k){void 0===k&&(k={}),this._checkLoaded();var L=this.getLayer(p);L?d.deepEqual(L.getLayoutProperty(g),x)||(L.setLayoutProperty(g,x,k),this._updateLayer(L)):this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be styled.")))},h.prototype.getLayoutProperty=function(p,g){var x=this.getLayer(p);if(x)return x.getLayoutProperty(g);this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style.")))},h.prototype.setPaintProperty=function(p,g,x,k){void 0===k&&(k={}),this._checkLoaded();var L=this.getLayer(p);L?d.deepEqual(L.getPaintProperty(g),x)||(L.setPaintProperty(g,x,k)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[p]=!0):this.fire(new d.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be styled.")))},h.prototype.getPaintProperty=function(p,g){return this.getLayer(p).getPaintProperty(g)},h.prototype.setFeatureState=function(p,g){this._checkLoaded();var x=p.source,k=p.sourceLayer,L=this.sourceCaches[x];if(void 0!==L){var J=L.getSource().type;"geojson"===J&&k?this.fire(new d.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==J||k?(void 0===p.id&&this.fire(new d.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(k,p.id,g)):this.fire(new d.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new d.ErrorEvent(new Error("The source '"+x+"' does not exist in the map's style.")))},h.prototype.removeFeatureState=function(p,g){this._checkLoaded();var x=p.source,k=this.sourceCaches[x];if(void 0!==k){var L=k.getSource().type,J="vector"===L?p.sourceLayer:void 0;"vector"!==L||J?g&&"string"!=typeof p.id&&"number"!=typeof p.id?this.fire(new d.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):k.removeFeatureState(J,p.id,g):this.fire(new d.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new d.ErrorEvent(new Error("The source '"+x+"' does not exist in the map's style.")))},h.prototype.getFeatureState=function(p){this._checkLoaded();var g=p.source,x=p.sourceLayer,k=this.sourceCaches[g];if(void 0!==k){if("vector"!==k.getSource().type||x)return void 0===p.id&&this.fire(new d.ErrorEvent(new Error("The feature id parameter must be provided."))),k.getFeatureState(x,p.id);this.fire(new d.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new d.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},h.prototype.getTransition=function(){return d.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},h.prototype.serialize=function(){return d.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:d.mapObject(this.sourceCaches,function(p){return p.serialize()}),layers:this._serializeLayers(this._order)},function(p){return void 0!==p})},h.prototype._updateLayer=function(p){this._updatedLayers[p.id]=!0,p.source&&!this._updatedSources[p.source]&&"raster"!==this.sourceCaches[p.source].getSource().type&&(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause()),this._changed=!0},h.prototype._flattenAndSortRenderedFeatures=function(p){for(var g=this,x=function(Ut){return"fill-extrusion"===g._layers[Ut].type},k={},L=[],J=this._order.length-1;J>=0;J--){var K=this._order[J];if(x(K)){k[K]=J;for(var ne=0,_e=p;ne<_e.length;ne+=1){var ve=_e[ne][K];if(ve)for(var be=0,Ee=ve;be<Ee.length;be+=1)L.push(Ee[be])}}}L.sort(function(Ut,Rt){return Rt.intersectionZ-Ut.intersectionZ});for(var Oe=[],Re=this._order.length-1;Re>=0;Re--){var Se=this._order[Re];if(x(Se))for(var De=L.length-1;De>=0;De--){var Be=L[De].feature;if(k[Be.layer.id]<Re)break;Oe.push(Be),L.pop()}else for(var Xe=0,_t=p;Xe<_t.length;Xe+=1){var ct=_t[Xe][Se];if(ct)for(var yt=0,St=ct;yt<St.length;yt+=1)Oe.push(St[yt].feature)}}return Oe},h.prototype.queryRenderedFeatures=function(p,g,x){g&&g.filter&&this._validate(d.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);var k={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new d.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,J=g.layers;L<J.length;L+=1){var K=J[L],ne=this._layers[K];if(!ne)return this.fire(new d.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be queried for features."))),[];k[ne.source]=!0}}var _e=[];for(var ve in g.availableImages=this._availableImages,this.sourceCaches)g.layers&&!k[ve]||_e.push(Pn(this.sourceCaches[ve],this._layers,this._serializedLayers,p,g,x));return this.placement&&_e.push(function(be,Ee,Oe,Re,Se,De,Be){for(var Xe={},_t=De.queryRenderedSymbols(Re),ct=[],yt=0,St=Object.keys(_t).map(Number);yt<St.length;yt+=1)ct.push(Be[St[yt]]);ct.sort(st);for(var Ut=function(){var En=Kt[Rt],_i=En.featureIndex.lookupSymbolFeatures(_t[En.bucketInstanceId],Ee,En.bucketIndex,En.sourceLayerIndex,Se.filter,Se.layers,Se.availableImages,be);for(var Gt in _i){var jn=Xe[Gt]=Xe[Gt]||[],ti=_i[Gt];ti.sort(function(Xn,qn){var bn=En.featureSortOrder;if(bn){var Do=bn.indexOf(Xn.featureIndex);return bn.indexOf(qn.featureIndex)-Do}return qn.featureIndex-Xn.featureIndex});for(var Fn=0,Un=ti;Fn<Un.length;Fn+=1)jn.push(Un[Fn])}},Rt=0,Kt=ct;Rt<Kt.length;Rt+=1)Ut();var wn=function(En){Xe[En].forEach(function(_i){var Gt=_i.feature,jn=Oe[be[En].source].getFeatureState(Gt.layer["source-layer"],Gt.id);Gt.source=Gt.layer.source,Gt.layer["source-layer"]&&(Gt.sourceLayer=Gt.layer["source-layer"]),Gt.state=jn})};for(var Mn in Xe)wn(Mn);return Xe}(this._layers,this._serializedLayers,this.sourceCaches,p,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_e)},h.prototype.querySourceFeatures=function(p,g){g&&g.filter&&this._validate(d.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);var x=this.sourceCaches[p];return x?function(k,L){for(var J=k.getRenderableIds().map(function(Ee){return k.getTileByID(Ee)}),K=[],ne={},_e=0;_e<J.length;_e++){var ve=J[_e],be=ve.tileID.canonical.key;ne[be]||(ne[be]=!0,ve.querySourceFeatures(K,L))}return K}(x,g):[]},h.prototype.addSourceType=function(p,g,x){return h.getSourceType(p)?x(new Error('A source type called "'+p+'" already exists.')):(h.setSourceType(p,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:p,url:g.workerSourceURL},x):x(null,null))},h.prototype.getLight=function(){return this.light.getLight()},h.prototype.setLight=function(p,g){void 0===g&&(g={}),this._checkLoaded();var x=this.light.getLight(),k=!1;for(var L in p)if(!d.deepEqual(p[L],x[L])){k=!0;break}if(k){var J={now:d.browser.now(),transition:d.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(p,g),this.light.updateTransitions(J)}},h.prototype._validate=function(p,g,x,k,L){return void 0===L&&(L={}),(!L||!1!==L.validate)&&Br(this,p.call(d.validateStyle,d.extend({key:g,style:this.serialize(),value:x,styleSpec:d.styleSpec},k)))},h.prototype._remove=function(){for(var p in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),d.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[p].setEventedParent(null);for(var g in this.sourceCaches)this.sourceCaches[g].clearTiles(),this.sourceCaches[g].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},h.prototype._clearSource=function(p){this.sourceCaches[p].clearTiles()},h.prototype._reloadSource=function(p){this.sourceCaches[p].resume(),this.sourceCaches[p].reload()},h.prototype._updateSources=function(p){for(var g in this.sourceCaches)this.sourceCaches[g].update(p)},h.prototype._generateCollisionBoxes=function(){for(var p in this.sourceCaches)this._reloadSource(p)},h.prototype._updatePlacement=function(p,g,x,k,L){void 0===L&&(L=!1);for(var J=!1,K=!1,ne={},_e=0,ve=this._order;_e<ve.length;_e+=1){var be=this._layers[ve[_e]];if("symbol"===be.type){if(!ne[be.source]){var Ee=this.sourceCaches[be.source];ne[be.source]=Ee.getRenderableIds(!0).map(function(Be){return Ee.getTileByID(Be)}).sort(function(Be,Xe){return Xe.tileID.overscaledZ-Be.tileID.overscaledZ||(Be.tileID.isLessThan(Xe.tileID)?-1:1)})}var Oe=this.crossTileSymbolIndex.addLayer(be,ne[be.source],p.center.lng);J=J||Oe}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||0===x)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(d.browser.now(),p.zoom))&&(this.pauseablePlacement=new Ot(p,this._order,L,g,x,k,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ne),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(d.browser.now()),K=!0),J&&this.pauseablePlacement.placement.setStale()),K||J)for(var Re=0,Se=this._order;Re<Se.length;Re+=1){var De=this._layers[Se[Re]];"symbol"===De.type&&this.placement.updateLayerOpacities(De,ne[De.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(d.browser.now())},h.prototype._releaseSymbolFadeTiles=function(){for(var p in this.sourceCaches)this.sourceCaches[p].releaseSymbolFadeTiles()},h.prototype.getImages=function(p,g,x){this.imageManager.getImages(g.icons,x),this._updateTilesForChangedImages();var k=this.sourceCaches[g.source];k&&k.setDependencies(g.tileID.key,g.type,g.icons)},h.prototype.getGlyphs=function(p,g,x){this.glyphManager.getGlyphs(g.stacks,x)},h.prototype.getResource=function(p,g,x){return d.makeRequest(g,x)},h}(d.Evented);Hi.getSourceType=function(u){return Nt[u]},Hi.setSourceType=function(u,h){Nt[u]=h},Hi.registerForPluginStateChange=d.registerForPluginStateChange;var co=d.createLayout([{name:"a_pos",type:"Int16",components:2}]),xs=Li("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Oa=Li("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Sl=Li("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),du=Li("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),ic=Li("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),oc=Li("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),ll=Li("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),rc=Li("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Pc=Li("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),hu=Li("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Us=Li("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),cl=Li("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Pl=Li("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fu=Li("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Lo=Li("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),qs=Li("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Fa=Li("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ua=Li("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),as=Li("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Sa=Li("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),qa=Li("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Cs=Li("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Ja=Li("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ws=Li("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),gu=Li("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ec=Li("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Li(u,h){var p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=h.match(/attribute ([\w]+) ([\w]+)/g),x=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=k?k.concat(x):x,J={};return{fragmentSource:u=u.replace(p,function(K,ne,_e,ve,be){return J[be]=!0,"define"===ne?"\n#ifndef HAS_UNIFORM_u_"+be+"\nvarying "+_e+" "+ve+" "+be+";\n#else\nuniform "+_e+" "+ve+" u_"+be+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+be+"\n    "+_e+" "+ve+" "+be+" = u_"+be+";\n#endif\n"}),vertexSource:h=h.replace(p,function(K,ne,_e,ve,be){var Ee="float"===ve?"vec2":"vec4",Oe=be.match(/color/)?"color":Ee;return J[be]?"define"===ne?"\n#ifndef HAS_UNIFORM_u_"+be+"\nuniform lowp float u_"+be+"_t;\nattribute "+_e+" "+Ee+" a_"+be+";\nvarying "+_e+" "+ve+" "+be+";\n#else\nuniform "+_e+" "+ve+" u_"+be+";\n#endif\n":"vec4"===Oe?"\n#ifndef HAS_UNIFORM_u_"+be+"\n    "+be+" = a_"+be+";\n#else\n    "+_e+" "+ve+" "+be+" = u_"+be+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+be+"\n    "+be+" = unpack_mix_"+Oe+"(a_"+be+", u_"+be+"_t);\n#else\n    "+_e+" "+ve+" "+be+" = u_"+be+";\n#endif\n":"define"===ne?"\n#ifndef HAS_UNIFORM_u_"+be+"\nuniform lowp float u_"+be+"_t;\nattribute "+_e+" "+Ee+" a_"+be+";\n#else\nuniform "+_e+" "+ve+" u_"+be+";\n#endif\n":"vec4"===Oe?"\n#ifndef HAS_UNIFORM_u_"+be+"\n    "+_e+" "+ve+" "+be+" = a_"+be+";\n#else\n    "+_e+" "+ve+" "+be+" = u_"+be+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+be+"\n    "+_e+" "+ve+" "+be+" = unpack_mix_"+Oe+"(a_"+be+", u_"+be+"_t);\n#else\n    "+_e+" "+ve+" "+be+" = u_"+be+";\n#endif\n"}),staticAttributes:g,staticUniforms:L}}var Js=Object.freeze({__proto__:null,prelude:xs,background:Oa,backgroundPattern:Sl,circle:du,clippingMask:ic,heatmap:oc,heatmapTexture:ll,collisionBox:rc,collisionCircle:Pc,debug:hu,fill:Us,fillOutline:cl,fillOutlinePattern:Pl,fillPattern:fu,fillExtrusion:Lo,fillExtrusionPattern:qs,hillshadePrepare:Fa,hillshade:Ua,line:as,lineGradient:Sa,linePattern:qa,lineSDF:Cs,raster:Ja,symbolIcon:ws,symbolSDF:gu,symbolTextAndIcon:Ec}),sa=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Ts(u){for(var h=[],p=0;p<u.length;p++)if(null!==u[p]){var g=u[p].split(" ");h.push(g.pop())}return h}sa.prototype.bind=function(u,h,p,g,x,k,L,J){this.context=u;for(var K=this.boundPaintVertexBuffers.length!==g.length,ne=0;!K&&ne<g.length;ne++)this.boundPaintVertexBuffers[ne]!==g[ne]&&(K=!0);u.extVertexArrayObject&&this.vao&&this.boundProgram===h&&this.boundLayoutVertexBuffer===p&&!K&&this.boundIndexBuffer===x&&this.boundVertexOffset===k&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===J?(u.bindVertexArrayOES.set(this.vao),L&&L.bind(),x&&x.dynamicDraw&&x.bind(),J&&J.bind()):this.freshBind(h,p,g,x,k,L,J)},sa.prototype.freshBind=function(u,h,p,g,x,k,L){var J,K=u.numAttributes,ne=this.context,_e=ne.gl;if(ne.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ne.extVertexArrayObject.createVertexArrayOES(),ne.bindVertexArrayOES.set(this.vao),J=0,this.boundProgram=u,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=g,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=k,this.boundDynamicVertexBuffer2=L;else{J=ne.currentNumAttributes||0;for(var ve=K;ve<J;ve++)_e.disableVertexAttribArray(ve)}h.enableAttributes(_e,u);for(var be=0,Ee=p;be<Ee.length;be+=1)Ee[be].enableAttributes(_e,u);k&&k.enableAttributes(_e,u),L&&L.enableAttributes(_e,u),h.bind(),h.setVertexAttribPointers(_e,u,x);for(var Oe=0,Re=p;Oe<Re.length;Oe+=1){var Se=Re[Oe];Se.bind(),Se.setVertexAttribPointers(_e,u,x)}k&&(k.bind(),k.setVertexAttribPointers(_e,u,x)),g&&g.bind(),L&&(L.bind(),L.setVertexAttribPointers(_e,u,x)),ne.currentNumAttributes=K},sa.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ul=function(u,h,p,g,x,k){var L=u.gl;this.program=L.createProgram();for(var J=Ts(p.staticAttributes),K=g?g.getBinderAttributes():[],ne=J.concat(K),_e=p.staticUniforms?Ts(p.staticUniforms):[],ve=g?g.getBinderUniforms():[],be=[],Ee=0,Oe=_e.concat(ve);Ee<Oe.length;Ee+=1){var Re=Oe[Ee];be.indexOf(Re)<0&&be.push(Re)}var Se=g?g.defines():[];k&&Se.push("#define OVERDRAW_INSPECTOR;");var De=Se.concat(xs.fragmentSource,p.fragmentSource).join("\n"),Be=Se.concat(xs.vertexSource,p.vertexSource).join("\n"),Xe=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(Xe,De),L.compileShader(Xe),L.attachShader(this.program,Xe);var _t=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(_t,Be),L.compileShader(_t),L.attachShader(this.program,_t),this.attributes={};var ct={};this.numAttributes=ne.length;for(var yt=0;yt<this.numAttributes;yt++)ne[yt]&&(L.bindAttribLocation(this.program,yt,ne[yt]),this.attributes[ne[yt]]=yt);L.linkProgram(this.program),L.deleteShader(_t),L.deleteShader(Xe);for(var St=0;St<be.length;St++){var Ut=be[St];if(Ut&&!ct[Ut]){var Rt=L.getUniformLocation(this.program,Ut);Rt&&(ct[Ut]=Rt)}}this.fixedUniforms=x(u,ct),this.binderUniforms=g?g.getUniforms(u,ct):[]}}};function ss(u,h,p){var g=1/no(p,1,h.transform.tileZoom),x=Math.pow(2,p.tileID.overscaledZ),k=p.tileSize*Math.pow(2,h.transform.tileZoom)/x,L=k*(p.tileID.canonical.x+p.tileID.wrap*x),J=k*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[g,u.fromScale,u.toScale],u_fade:u.t,u_pixel_coord_upper:[L>>16,J>>16],u_pixel_coord_lower:[65535&L,65535&J]}}ul.prototype.draw=function(u,h,p,g,x,k,L,J,K,ne,_e,ve,be,Ee,Oe,Re){var Se,De=u.gl;if(!this.failedToCreate){for(var Be in u.program.set(this.program),u.setDepthMode(p),u.setStencilMode(g),u.setColorMode(x),u.setCullFace(k),this.fixedUniforms)this.fixedUniforms[Be].set(L[Be]);Ee&&Ee.setUniforms(u,this.binderUniforms,ve,{zoom:be});for(var Xe=(Se={},Se[De.LINES]=2,Se[De.TRIANGLES]=3,Se[De.LINE_STRIP]=1,Se)[h],_t=0,ct=_e.get();_t<ct.length;_t+=1){var yt=ct[_t],St=yt.vaos||(yt.vaos={});(St[J]||(St[J]=new sa)).bind(u,this,K,Ee?Ee.getPaintVertexBuffers():[],ne,yt.vertexOffset,Oe,Re),De.drawElements(h,yt.primitiveLength*Xe,De.UNSIGNED_SHORT,yt.primitiveOffset*Xe*2)}}};var _u=function(u,h,p,g){var x=h.style.light,k=x.properties.get("position"),L=[k.x,k.y,k.z],J=d.create$1();"viewport"===x.properties.get("anchor")&&d.fromRotation(J,-h.transform.angle),d.transformMat3(L,L,J);var K=x.properties.get("color");return{u_matrix:u,u_lightpos:L,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[K.r,K.g,K.b],u_vertical_gradient:+p,u_opacity:g}},ja=function(u,h,p,g,x,k,L){return d.extend(_u(u,h,p,g),ss(k,h,L),{u_height_factor:-Math.pow(2,x.overscaledZ)/L.tileSize/8})},la=function(u){return{u_matrix:u}},Gr=function(u,h,p,g){return d.extend(la(u),ss(p,h,g))},Ac=function(u,h){return{u_matrix:u,u_world:h}},mu=function(u,h,p,g,x){return d.extend(Gr(u,h,p,g),{u_world:x})},kc=function(u,h,p,g){var x,k,L=u.transform;if("map"===g.paint.get("circle-pitch-alignment")){var J=no(p,1,L.zoom);x=!0,k=[J,J]}else x=!1,k=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+("map"===g.paint.get("circle-pitch-scale")),u_matrix:u.translatePosMatrix(h.posMatrix,p,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:d.browser.devicePixelRatio,u_extrude_scale:k}},Ms=function(u,h,p){var g=no(p,1,h.zoom),x=Math.pow(2,h.zoom-p.tileID.overscaledZ),k=p.tileID.overscaleFactor();return{u_matrix:u,u_camera_to_center_distance:h.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[h.pixelsToGLUnits[0]/(g*x),h.pixelsToGLUnits[1]/(g*x)],u_overscale_factor:k}},ac=function(u,h,p){return{u_matrix:u,u_inv_matrix:h,u_camera_to_center_distance:p.cameraToCenterDistance,u_viewport_size:[p.width,p.height]}},ca=function(u,h,p){return void 0===p&&(p=1),{u_matrix:u,u_color:h,u_overlay:0,u_overlay_scale:p}},Vr=function(u){return{u_matrix:u}},Ic=function(u,h,p,g){return{u_matrix:u,u_extrude_scale:no(h,1,p),u_intensity:g}},Yr=function(u,h,p){var g=u.transform;return{u_matrix:El(u,h,p),u_ratio:1/no(h,1,g.zoom),u_device_pixel_ratio:d.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Vi=function(u,h,p,g){return d.extend(Yr(u,h,p),{u_image:0,u_image_height:g})},Ba=function(u,h,p,g){var x=u.transform,k=pl(h,x);return{u_matrix:El(u,h,p),u_texsize:h.imageAtlasTexture.size,u_ratio:1/no(h,1,x.zoom),u_device_pixel_ratio:d.browser.devicePixelRatio,u_image:0,u_scale:[k,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},yu=function(u,h,p,g,x){var k=u.lineAtlas,L=pl(h,u.transform),J="round"===p.layout.get("line-cap"),K=k.getDash(g.from,J),ne=k.getDash(g.to,J),_e=K.width*x.fromScale,ve=ne.width*x.toScale;return d.extend(Yr(u,h,p),{u_patternscale_a:[L/_e,-K.height/2],u_patternscale_b:[L/ve,-ne.height/2],u_sdfgamma:k.width/(256*Math.min(_e,ve)*d.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:K.y,u_tex_y_b:ne.y,u_mix:x.t})};function pl(u,h){return 1/no(u,1,h.tileZoom)}function El(u,h,p){return u.translatePosMatrix(h.tileID.posMatrix,h,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}var Zc=function(u,h,p,g,x){return{u_matrix:u,u_tl_parent:h,u_scale_parent:p,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(L=x.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(k=x.paint.get("raster-contrast"),k>0?1/(1-k):1+k),u_spin_weights:Nc(x.paint.get("raster-hue-rotate"))};var k,L};function Nc(u){u*=Math.PI/180;var h=Math.sin(u),p=Math.cos(u);return[(2*p+1)/3,(-Math.sqrt(3)*h-p+1)/3,(Math.sqrt(3)*h-p+1)/3]}var Al,js=function(u,h,p,g,x,k,L,J,K,ne){var _e=x.transform;return{u_is_size_zoom_constant:+("constant"===u||"source"===u),u_is_size_feature_constant:+("constant"===u||"camera"===u),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_pitch:_e.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:_e.width/_e.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:k,u_label_plane_matrix:L,u_coord_matrix:J,u_is_text:+K,u_pitch_with_map:+g,u_texsize:ne,u_texture:0}},ls=function(u,h,p,g,x,k,L,J,K,ne,_e){var ve=x.transform;return d.extend(js(u,h,p,g,x,k,L,J,K,ne),{u_gamma_scale:g?Math.cos(ve._pitch)*ve.cameraToCenterDistance:1,u_device_pixel_ratio:d.browser.devicePixelRatio,u_is_halo:+_e})},kl=function(u,h,p,g,x,k,L,J,K,ne){return d.extend(ls(u,h,p,g,x,k,L,J,!0,K,!0),{u_texsize_icon:ne,u_texture_icon:1})},Il=function(u,h,p){return{u_matrix:u,u_opacity:h,u_color:p}},Ke=function(u,h,p,g,x,k){return d.extend((J=k,ne=x,_e=(K=p).imageManager.getPattern((L=g).from.toString()),ve=K.imageManager.getPattern(L.to.toString()),Ee=(be=K.imageManager.getPixelSize()).width,Oe=be.height,Re=Math.pow(2,ne.tileID.overscaledZ),De=(Se=ne.tileSize*Math.pow(2,K.transform.tileZoom)/Re)*(ne.tileID.canonical.x+ne.tileID.wrap*Re),Be=Se*ne.tileID.canonical.y,{u_image:0,u_pattern_tl_a:_e.tl,u_pattern_br_a:_e.br,u_pattern_tl_b:ve.tl,u_pattern_br_b:ve.br,u_texsize:[Ee,Oe],u_mix:J.t,u_pattern_size_a:_e.displaySize,u_pattern_size_b:ve.displaySize,u_scale_a:J.fromScale,u_scale_b:J.toScale,u_tile_units_to_pixels:1/no(ne,1,K.transform.tileZoom),u_pixel_coord_upper:[De>>16,Be>>16],u_pixel_coord_lower:[65535&De,65535&Be]}),{u_matrix:u,u_opacity:h});var L,J,K,ne,_e,ve,be,Ee,Oe,Re,Se,De,Be},Ct={fillExtrusion:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_lightpos:new d.Uniform3f(u,h.u_lightpos),u_lightintensity:new d.Uniform1f(u,h.u_lightintensity),u_lightcolor:new d.Uniform3f(u,h.u_lightcolor),u_vertical_gradient:new d.Uniform1f(u,h.u_vertical_gradient),u_opacity:new d.Uniform1f(u,h.u_opacity)}},fillExtrusionPattern:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_lightpos:new d.Uniform3f(u,h.u_lightpos),u_lightintensity:new d.Uniform1f(u,h.u_lightintensity),u_lightcolor:new d.Uniform3f(u,h.u_lightcolor),u_vertical_gradient:new d.Uniform1f(u,h.u_vertical_gradient),u_height_factor:new d.Uniform1f(u,h.u_height_factor),u_image:new d.Uniform1i(u,h.u_image),u_texsize:new d.Uniform2f(u,h.u_texsize),u_pixel_coord_upper:new d.Uniform2f(u,h.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(u,h.u_pixel_coord_lower),u_scale:new d.Uniform3f(u,h.u_scale),u_fade:new d.Uniform1f(u,h.u_fade),u_opacity:new d.Uniform1f(u,h.u_opacity)}},fill:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix)}},fillPattern:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_image:new d.Uniform1i(u,h.u_image),u_texsize:new d.Uniform2f(u,h.u_texsize),u_pixel_coord_upper:new d.Uniform2f(u,h.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(u,h.u_pixel_coord_lower),u_scale:new d.Uniform3f(u,h.u_scale),u_fade:new d.Uniform1f(u,h.u_fade)}},fillOutline:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_world:new d.Uniform2f(u,h.u_world)}},fillOutlinePattern:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_world:new d.Uniform2f(u,h.u_world),u_image:new d.Uniform1i(u,h.u_image),u_texsize:new d.Uniform2f(u,h.u_texsize),u_pixel_coord_upper:new d.Uniform2f(u,h.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(u,h.u_pixel_coord_lower),u_scale:new d.Uniform3f(u,h.u_scale),u_fade:new d.Uniform1f(u,h.u_fade)}},circle:function(u,h){return{u_camera_to_center_distance:new d.Uniform1f(u,h.u_camera_to_center_distance),u_scale_with_map:new d.Uniform1i(u,h.u_scale_with_map),u_pitch_with_map:new d.Uniform1i(u,h.u_pitch_with_map),u_extrude_scale:new d.Uniform2f(u,h.u_extrude_scale),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_matrix:new d.UniformMatrix4f(u,h.u_matrix)}},collisionBox:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_camera_to_center_distance:new d.Uniform1f(u,h.u_camera_to_center_distance),u_pixels_to_tile_units:new d.Uniform1f(u,h.u_pixels_to_tile_units),u_extrude_scale:new d.Uniform2f(u,h.u_extrude_scale),u_overscale_factor:new d.Uniform1f(u,h.u_overscale_factor)}},collisionCircle:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_inv_matrix:new d.UniformMatrix4f(u,h.u_inv_matrix),u_camera_to_center_distance:new d.Uniform1f(u,h.u_camera_to_center_distance),u_viewport_size:new d.Uniform2f(u,h.u_viewport_size)}},debug:function(u,h){return{u_color:new d.UniformColor(u,h.u_color),u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_overlay:new d.Uniform1i(u,h.u_overlay),u_overlay_scale:new d.Uniform1f(u,h.u_overlay_scale)}},clippingMask:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix)}},heatmap:function(u,h){return{u_extrude_scale:new d.Uniform1f(u,h.u_extrude_scale),u_intensity:new d.Uniform1f(u,h.u_intensity),u_matrix:new d.UniformMatrix4f(u,h.u_matrix)}},heatmapTexture:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_world:new d.Uniform2f(u,h.u_world),u_image:new d.Uniform1i(u,h.u_image),u_color_ramp:new d.Uniform1i(u,h.u_color_ramp),u_opacity:new d.Uniform1f(u,h.u_opacity)}},hillshade:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_image:new d.Uniform1i(u,h.u_image),u_latrange:new d.Uniform2f(u,h.u_latrange),u_light:new d.Uniform2f(u,h.u_light),u_shadow:new d.UniformColor(u,h.u_shadow),u_highlight:new d.UniformColor(u,h.u_highlight),u_accent:new d.UniformColor(u,h.u_accent)}},hillshadePrepare:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_image:new d.Uniform1i(u,h.u_image),u_dimension:new d.Uniform2f(u,h.u_dimension),u_zoom:new d.Uniform1f(u,h.u_zoom),u_unpack:new d.Uniform4f(u,h.u_unpack)}},line:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_ratio:new d.Uniform1f(u,h.u_ratio),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_units_to_pixels:new d.Uniform2f(u,h.u_units_to_pixels)}},lineGradient:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_ratio:new d.Uniform1f(u,h.u_ratio),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_units_to_pixels:new d.Uniform2f(u,h.u_units_to_pixels),u_image:new d.Uniform1i(u,h.u_image),u_image_height:new d.Uniform1f(u,h.u_image_height)}},linePattern:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_texsize:new d.Uniform2f(u,h.u_texsize),u_ratio:new d.Uniform1f(u,h.u_ratio),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_image:new d.Uniform1i(u,h.u_image),u_units_to_pixels:new d.Uniform2f(u,h.u_units_to_pixels),u_scale:new d.Uniform3f(u,h.u_scale),u_fade:new d.Uniform1f(u,h.u_fade)}},lineSDF:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_ratio:new d.Uniform1f(u,h.u_ratio),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_units_to_pixels:new d.Uniform2f(u,h.u_units_to_pixels),u_patternscale_a:new d.Uniform2f(u,h.u_patternscale_a),u_patternscale_b:new d.Uniform2f(u,h.u_patternscale_b),u_sdfgamma:new d.Uniform1f(u,h.u_sdfgamma),u_image:new d.Uniform1i(u,h.u_image),u_tex_y_a:new d.Uniform1f(u,h.u_tex_y_a),u_tex_y_b:new d.Uniform1f(u,h.u_tex_y_b),u_mix:new d.Uniform1f(u,h.u_mix)}},raster:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_tl_parent:new d.Uniform2f(u,h.u_tl_parent),u_scale_parent:new d.Uniform1f(u,h.u_scale_parent),u_buffer_scale:new d.Uniform1f(u,h.u_buffer_scale),u_fade_t:new d.Uniform1f(u,h.u_fade_t),u_opacity:new d.Uniform1f(u,h.u_opacity),u_image0:new d.Uniform1i(u,h.u_image0),u_image1:new d.Uniform1i(u,h.u_image1),u_brightness_low:new d.Uniform1f(u,h.u_brightness_low),u_brightness_high:new d.Uniform1f(u,h.u_brightness_high),u_saturation_factor:new d.Uniform1f(u,h.u_saturation_factor),u_contrast_factor:new d.Uniform1f(u,h.u_contrast_factor),u_spin_weights:new d.Uniform3f(u,h.u_spin_weights)}},symbolIcon:function(u,h){return{u_is_size_zoom_constant:new d.Uniform1i(u,h.u_is_size_zoom_constant),u_is_size_feature_constant:new d.Uniform1i(u,h.u_is_size_feature_constant),u_size_t:new d.Uniform1f(u,h.u_size_t),u_size:new d.Uniform1f(u,h.u_size),u_camera_to_center_distance:new d.Uniform1f(u,h.u_camera_to_center_distance),u_pitch:new d.Uniform1f(u,h.u_pitch),u_rotate_symbol:new d.Uniform1i(u,h.u_rotate_symbol),u_aspect_ratio:new d.Uniform1f(u,h.u_aspect_ratio),u_fade_change:new d.Uniform1f(u,h.u_fade_change),u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_label_plane_matrix:new d.UniformMatrix4f(u,h.u_label_plane_matrix),u_coord_matrix:new d.UniformMatrix4f(u,h.u_coord_matrix),u_is_text:new d.Uniform1i(u,h.u_is_text),u_pitch_with_map:new d.Uniform1i(u,h.u_pitch_with_map),u_texsize:new d.Uniform2f(u,h.u_texsize),u_texture:new d.Uniform1i(u,h.u_texture)}},symbolSDF:function(u,h){return{u_is_size_zoom_constant:new d.Uniform1i(u,h.u_is_size_zoom_constant),u_is_size_feature_constant:new d.Uniform1i(u,h.u_is_size_feature_constant),u_size_t:new d.Uniform1f(u,h.u_size_t),u_size:new d.Uniform1f(u,h.u_size),u_camera_to_center_distance:new d.Uniform1f(u,h.u_camera_to_center_distance),u_pitch:new d.Uniform1f(u,h.u_pitch),u_rotate_symbol:new d.Uniform1i(u,h.u_rotate_symbol),u_aspect_ratio:new d.Uniform1f(u,h.u_aspect_ratio),u_fade_change:new d.Uniform1f(u,h.u_fade_change),u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_label_plane_matrix:new d.UniformMatrix4f(u,h.u_label_plane_matrix),u_coord_matrix:new d.UniformMatrix4f(u,h.u_coord_matrix),u_is_text:new d.Uniform1i(u,h.u_is_text),u_pitch_with_map:new d.Uniform1i(u,h.u_pitch_with_map),u_texsize:new d.Uniform2f(u,h.u_texsize),u_texture:new d.Uniform1i(u,h.u_texture),u_gamma_scale:new d.Uniform1f(u,h.u_gamma_scale),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_is_halo:new d.Uniform1i(u,h.u_is_halo)}},symbolTextAndIcon:function(u,h){return{u_is_size_zoom_constant:new d.Uniform1i(u,h.u_is_size_zoom_constant),u_is_size_feature_constant:new d.Uniform1i(u,h.u_is_size_feature_constant),u_size_t:new d.Uniform1f(u,h.u_size_t),u_size:new d.Uniform1f(u,h.u_size),u_camera_to_center_distance:new d.Uniform1f(u,h.u_camera_to_center_distance),u_pitch:new d.Uniform1f(u,h.u_pitch),u_rotate_symbol:new d.Uniform1i(u,h.u_rotate_symbol),u_aspect_ratio:new d.Uniform1f(u,h.u_aspect_ratio),u_fade_change:new d.Uniform1f(u,h.u_fade_change),u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_label_plane_matrix:new d.UniformMatrix4f(u,h.u_label_plane_matrix),u_coord_matrix:new d.UniformMatrix4f(u,h.u_coord_matrix),u_is_text:new d.Uniform1i(u,h.u_is_text),u_pitch_with_map:new d.Uniform1i(u,h.u_pitch_with_map),u_texsize:new d.Uniform2f(u,h.u_texsize),u_texsize_icon:new d.Uniform2f(u,h.u_texsize_icon),u_texture:new d.Uniform1i(u,h.u_texture),u_texture_icon:new d.Uniform1i(u,h.u_texture_icon),u_gamma_scale:new d.Uniform1f(u,h.u_gamma_scale),u_device_pixel_ratio:new d.Uniform1f(u,h.u_device_pixel_ratio),u_is_halo:new d.Uniform1i(u,h.u_is_halo)}},background:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_opacity:new d.Uniform1f(u,h.u_opacity),u_color:new d.UniformColor(u,h.u_color)}},backgroundPattern:function(u,h){return{u_matrix:new d.UniformMatrix4f(u,h.u_matrix),u_opacity:new d.Uniform1f(u,h.u_opacity),u_image:new d.Uniform1i(u,h.u_image),u_pattern_tl_a:new d.Uniform2f(u,h.u_pattern_tl_a),u_pattern_br_a:new d.Uniform2f(u,h.u_pattern_br_a),u_pattern_tl_b:new d.Uniform2f(u,h.u_pattern_tl_b),u_pattern_br_b:new d.Uniform2f(u,h.u_pattern_br_b),u_texsize:new d.Uniform2f(u,h.u_texsize),u_mix:new d.Uniform1f(u,h.u_mix),u_pattern_size_a:new d.Uniform2f(u,h.u_pattern_size_a),u_pattern_size_b:new d.Uniform2f(u,h.u_pattern_size_b),u_scale_a:new d.Uniform1f(u,h.u_scale_a),u_scale_b:new d.Uniform1f(u,h.u_scale_b),u_pixel_coord_upper:new d.Uniform2f(u,h.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(u,h.u_pixel_coord_lower),u_tile_units_to_pixels:new d.Uniform1f(u,h.u_tile_units_to_pixels)}}};function en(u,h,p,g,x,k,L){for(var J=u.context,K=J.gl,ne=u.useProgram("collisionBox"),_e=[],ve=0,be=0,Ee=0;Ee<g.length;Ee++){var Oe=g[Ee],Re=h.getTile(Oe),Se=Re.getBucket(p);if(Se){var De=Oe.posMatrix;0===x[0]&&0===x[1]||(De=u.translatePosMatrix(Oe.posMatrix,Re,x,k));var Be=L?Se.textCollisionBox:Se.iconCollisionBox,Xe=Se.collisionCircleArray;if(Xe.length>0){var _t=d.create(),ct=De;d.mul(_t,Se.placementInvProjMatrix,u.transform.glCoordMatrix),d.mul(_t,_t,Se.placementViewportMatrix),_e.push({circleArray:Xe,circleOffset:be,transform:ct,invTransform:_t}),be=ve+=Xe.length/4}Be&&ne.draw(J,K.LINES,Ce.disabled,Pe.disabled,u.colorModeForRenderPass(),Ge.disabled,Ms(De,u.transform,Re),p.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,null,u.transform.zoom,null,null,Be.collisionVertexBuffer)}}if(L&&_e.length){var yt=u.useProgram("collisionCircle"),St=new d.StructArrayLayout2f1f2i16;St.resize(4*ve),St._trim();for(var Ut=0,Rt=0,Kt=_e;Rt<Kt.length;Rt+=1)for(var wn=Kt[Rt],Mn=0;Mn<wn.circleArray.length/4;Mn++){var En=4*Mn,_i=wn.circleArray[En+0],Gt=wn.circleArray[En+1],jn=wn.circleArray[En+2],ti=wn.circleArray[En+3];St.emplace(Ut++,_i,Gt,jn,ti,0),St.emplace(Ut++,_i,Gt,jn,ti,1),St.emplace(Ut++,_i,Gt,jn,ti,2),St.emplace(Ut++,_i,Gt,jn,ti,3)}(!Al||Al.length<2*ve)&&(Al=function(yo){var Or=2*yo,rr=new d.StructArrayLayout3ui6;rr.resize(Or),rr._trim();for(var po=0;po<Or;po++){var wo=6*po;rr.uint16[wo+0]=4*po+0,rr.uint16[wo+1]=4*po+1,rr.uint16[wo+2]=4*po+2,rr.uint16[wo+3]=4*po+2,rr.uint16[wo+4]=4*po+3,rr.uint16[wo+5]=4*po+0}return rr}(ve));for(var Fn=J.createIndexBuffer(Al,!0),Un=J.createVertexBuffer(St,d.collisionCircleLayout.members,!0),Xn=0,qn=_e;Xn<qn.length;Xn+=1){var bn=qn[Xn],Do=ac(bn.transform,bn.invTransform,u.transform);yt.draw(J,K.TRIANGLES,Ce.disabled,Pe.disabled,u.colorModeForRenderPass(),Ge.disabled,Do,p.id,Un,Fn,d.SegmentVector.simpleSegment(0,2*bn.circleOffset,bn.circleArray.length,bn.circleArray.length/2),null,u.transform.zoom,null,null,null)}Un.destroy(),Fn.destroy()}}var xn=d.identity(new Float32Array(16));function io(u,h,p,g,x,k){var L=d.getAnchorAlignment(u),J=-(L.horizontalAlign-.5)*h,K=-(L.verticalAlign-.5)*p,ne=d.evaluateVariableOffset(u,g);return new d.Point((J/x+ne[0])*k,(K/x+ne[1])*k)}function bi(u,h,p,g,x,k,L,J,K,ne,_e){var ve=u.text.placedSymbolArray,be=u.text.dynamicLayoutVertexArray,Ee=u.icon.dynamicLayoutVertexArray,Oe={};be.clear();for(var Re=0;Re<ve.length;Re++){var Se=ve.get(Re),De=Se.hidden||!Se.crossTileID||u.allowVerticalPlacement&&!Se.placedOrientation?null:g[Se.crossTileID];if(De){var Be=new d.Point(Se.anchorX,Se.anchorY),Xe=Zn(Be,p?J:L),_t=wi(k.cameraToCenterDistance,Xe.signedDistanceFromCamera),ct=x.evaluateSizeForFeature(u.textSizeData,ne,Se)*_t/d.ONE_EM;p&&(ct*=u.tilePixelRatio/K);for(var yt=io(De.anchor,De.width,De.height,De.textOffset,De.textBoxScale,ct),St=p?Zn(Be.add(yt),L).point:Xe.point.add(h?yt.rotate(-k.angle):yt),Ut=u.allowVerticalPlacement&&Se.placedOrientation===d.WritingMode.vertical?Math.PI/2:0,Rt=0;Rt<Se.numGlyphs;Rt++)d.addDynamicAttributes(be,St,Ut);_e&&Se.associatedIconIndex>=0&&(Oe[Se.associatedIconIndex]={shiftedAnchor:St,angle:Ut})}else nr(Se.numGlyphs,be)}if(_e){Ee.clear();for(var Kt=u.icon.placedSymbolArray,wn=0;wn<Kt.length;wn++){var Mn=Kt.get(wn);if(Mn.hidden)nr(Mn.numGlyphs,Ee);else{var En=Oe[wn];if(En)for(var _i=0;_i<Mn.numGlyphs;_i++)d.addDynamicAttributes(Ee,En.shiftedAnchor,En.angle);else nr(Mn.numGlyphs,Ee)}}u.icon.dynamicLayoutVertexBuffer.updateData(Ee)}u.text.dynamicLayoutVertexBuffer.updateData(be)}function uo(u,h,p){return p.iconsInText&&h?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function oo(u,h,p,g,x,k,L,J,K,ne,_e,ve){for(var be=u.context,Ee=be.gl,Oe=u.transform,Re="map"===J,Se="map"===K,De=Re&&"point"!==p.layout.get("symbol-placement"),Be=Re&&!Se&&!De,Xe=void 0!==p.layout.get("symbol-sort-key").constantOr(1),_t=!1,ct=u.depthModeForSublayer(0,Ce.ReadOnly),yt=p.layout.get("text-variable-anchor"),St=[],Ut=0,Rt=g;Ut<Rt.length;Ut+=1){var Kt=Rt[Ut],wn=h.getTile(Kt),Mn=wn.getBucket(p);if(Mn){var En=x?Mn.text:Mn.icon;if(En&&En.segments.get().length){var _i=En.programConfigurations.get(p.id),Gt=x||Mn.sdfIcons,jn=x?Mn.textSizeData:Mn.iconSizeData,ti=Se||0!==Oe.pitch,Fn=u.useProgram(uo(Gt,x,Mn),_i),Un=d.evaluateSizeForZoom(jn,Oe.zoom),Xn=void 0,qn=[0,0],bn=void 0,Do=void 0,yo=null,Or=void 0;if(x)bn=wn.glyphAtlasTexture,Do=Ee.LINEAR,Xn=wn.glyphAtlasTexture.size,Mn.iconsInText&&(qn=wn.imageAtlasTexture.size,yo=wn.imageAtlasTexture,Or=ti||u.options.rotating||u.options.zooming||"composite"===jn.kind||"camera"===jn.kind?Ee.LINEAR:Ee.NEAREST);else{var rr=1!==p.layout.get("icon-size").constantOr(0)||Mn.iconsNeedLinear;bn=wn.imageAtlasTexture,Do=Gt||u.options.rotating||u.options.zooming||rr||ti?Ee.LINEAR:Ee.NEAREST,Xn=wn.imageAtlasTexture.size}var po=no(wn,1,u.transform.zoom),wo=eo(Kt.posMatrix,Se,Re,u.transform,po),_a=Oi(Kt.posMatrix,Se,Re,u.transform,po),Wr=yt&&Mn.hasTextData(),ml="none"!==p.layout.get("icon-text-fit")&&Wr&&Mn.hasIconData();De&&wa(Mn,Kt.posMatrix,u,x,wo,_a,Se,ne);var Lr=u.translatePosMatrix(Kt.posMatrix,wn,k,L),ma=De||x&&yt||ml?xn:wo,Za=u.translatePosMatrix(_a,wn,k,L,!0),Su=Gt&&0!==p.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1),qc={program:Fn,buffers:En,uniformValues:Gt?Mn.iconsInText?kl(jn.kind,Un,Be,Se,u,Lr,ma,Za,Xn,qn):ls(jn.kind,Un,Be,Se,u,Lr,ma,Za,x,Xn,!0):js(jn.kind,Un,Be,Se,u,Lr,ma,Za,x,Xn),atlasTexture:bn,atlasTextureIcon:yo,atlasInterpolation:Do,atlasInterpolationIcon:Or,isSDF:Gt,hasHalo:Su};if(Xe&&Mn.canOverlap){_t=!0;for(var Ps=0,yl=En.segments.get();Ps<yl.length;Ps+=1){var Jc=yl[Ps];St.push({segments:new d.SegmentVector([Jc]),sortKey:Jc.sortKey,state:qc})}}else St.push({segments:En.segments,sortKey:0,state:qc})}}}_t&&St.sort(function(vl,zl){return vl.sortKey-zl.sortKey});for(var Es=0,pc=St;Es<pc.length;Es+=1){var fs=pc[Es],er=fs.state;if(be.activeTexture.set(Ee.TEXTURE0),er.atlasTexture.bind(er.atlasInterpolation,Ee.CLAMP_TO_EDGE),er.atlasTextureIcon&&(be.activeTexture.set(Ee.TEXTURE1),er.atlasTextureIcon&&er.atlasTextureIcon.bind(er.atlasInterpolationIcon,Ee.CLAMP_TO_EDGE)),er.isSDF){var Ws=er.uniformValues;er.hasHalo&&(Ws.u_is_halo=1,Cr(er.buffers,fs.segments,p,u,er.program,ct,_e,ve,Ws)),Ws.u_is_halo=0}Cr(er.buffers,fs.segments,p,u,er.program,ct,_e,ve,er.uniformValues)}}function Cr(u,h,p,g,x,k,L,J,K){var ne=g.context;x.draw(ne,ne.gl.TRIANGLES,k,L,J,Ge.disabled,K,p.id,u.layoutVertexBuffer,u.indexBuffer,h,p.paint,g.transform.zoom,u.programConfigurations.get(p.id),u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer)}function xo(u,h,p,g,x,k,L){var J,K,ne,_e,ve,be=u.context.gl,Ee=p.paint.get("fill-pattern"),Oe=Ee&&Ee.constantOr(1),Re=p.getCrossfadeParameters();L?(K=Oe&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=be.LINES):(K=Oe?"fillPattern":"fill",J=be.TRIANGLES);for(var Se=0,De=g;Se<De.length;Se+=1){var Be=De[Se],Xe=h.getTile(Be);if(!Oe||Xe.patternsLoaded()){var _t=Xe.getBucket(p);if(_t){var ct=_t.programConfigurations.get(p.id),yt=u.useProgram(K,ct);Oe&&(u.context.activeTexture.set(be.TEXTURE0),Xe.imageAtlasTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE),ct.updatePaintBuffers(Re));var St=Ee.constantOr(null);if(St&&Xe.imageAtlas){var Ut=Xe.imageAtlas,Rt=Ut.patternPositions[St.to.toString()],Kt=Ut.patternPositions[St.from.toString()];Rt&&Kt&&ct.setConstantPatternPositions(Rt,Kt)}var wn=u.translatePosMatrix(Be.posMatrix,Xe,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(L){_e=_t.indexBuffer2,ve=_t.segments2;var Mn=[be.drawingBufferWidth,be.drawingBufferHeight];ne="fillOutlinePattern"===K&&Oe?mu(wn,u,Re,Xe,Mn):Ac(wn,Mn)}else _e=_t.indexBuffer,ve=_t.segments,ne=Oe?Gr(wn,u,Re,Xe):la(wn);yt.draw(u.context,J,x,u.stencilModeForClipping(Be),k,Ge.disabled,ne,p.id,_t.layoutVertexBuffer,_e,ve,p.paint,u.transform.zoom,ct)}}}}function Ao(u,h,p,g,x,k,L){for(var J=u.context,K=J.gl,ne=p.paint.get("fill-extrusion-pattern"),_e=ne.constantOr(1),ve=p.getCrossfadeParameters(),be=p.paint.get("fill-extrusion-opacity"),Ee=0,Oe=g;Ee<Oe.length;Ee+=1){var Re=Oe[Ee],Se=h.getTile(Re),De=Se.getBucket(p);if(De){var Be=De.programConfigurations.get(p.id),Xe=u.useProgram(_e?"fillExtrusionPattern":"fillExtrusion",Be);_e&&(u.context.activeTexture.set(K.TEXTURE0),Se.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Be.updatePaintBuffers(ve));var _t=ne.constantOr(null);if(_t&&Se.imageAtlas){var ct=Se.imageAtlas,yt=ct.patternPositions[_t.to.toString()],St=ct.patternPositions[_t.from.toString()];yt&&St&&Be.setConstantPatternPositions(yt,St)}var Ut=u.translatePosMatrix(Re.posMatrix,Se,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Rt=p.paint.get("fill-extrusion-vertical-gradient"),Kt=_e?ja(Ut,u,Rt,be,Re,ve,Se):_u(Ut,u,Rt,be);Xe.draw(J,J.gl.TRIANGLES,x,k,L,Ge.backCCW,Kt,p.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,p.paint,u.transform.zoom,Be)}}}function Hr(u,h,p,g,x,k){var L=u.context,J=L.gl,K=h.fbo;if(K){var ne=u.useProgram("hillshade");L.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,K.colorAttachment.get());var _e=function(ve,be,Ee){var Oe=Ee.paint.get("hillshade-shadow-color"),Re=Ee.paint.get("hillshade-highlight-color"),Se=Ee.paint.get("hillshade-accent-color"),De=Ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ee.paint.get("hillshade-illumination-anchor")&&(De-=ve.transform.angle);var Be,Xe,_t,ct=!ve.options.moving;return{u_matrix:ve.transform.calculatePosMatrix(be.tileID.toUnwrapped(),ct),u_image:0,u_latrange:(Be=be.tileID,Xe=Math.pow(2,Be.canonical.z),_t=Be.canonical.y,[new d.MercatorCoordinate(0,_t/Xe).toLngLat().lat,new d.MercatorCoordinate(0,(_t+1)/Xe).toLngLat().lat]),u_light:[Ee.paint.get("hillshade-exaggeration"),De],u_shadow:Oe,u_highlight:Re,u_accent:Se}}(u,h,p);ne.draw(L,J.TRIANGLES,g,x,k,Ge.disabled,_e,p.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}}function cs(u,h,p,g,x,k){var Re,Se,De,Be,L=u.context,J=L.gl,K=h.dem;if(K&&K.data){var ne=K.dim,_e=K.stride,ve=K.getPixels();if(L.activeTexture.set(J.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||u.getTileTexture(_e),h.demTexture){var be=h.demTexture;be.update(ve,{premultiply:!1}),be.bind(J.NEAREST,J.CLAMP_TO_EDGE)}else h.demTexture=new d.Texture(L,ve,J.RGBA,{premultiply:!1}),h.demTexture.bind(J.NEAREST,J.CLAMP_TO_EDGE);L.activeTexture.set(J.TEXTURE0);var Ee=h.fbo;if(!Ee){var Oe=new d.Texture(L,{width:ne,height:ne,data:null},J.RGBA);Oe.bind(J.LINEAR,J.CLAMP_TO_EDGE),(Ee=h.fbo=L.createFramebuffer(ne,ne,!0)).colorAttachment.set(Oe.texture)}L.bindFramebuffer.set(Ee.framebuffer),L.viewport.set([0,0,ne,ne]),u.useProgram("hillshadePrepare").draw(L,J.TRIANGLES,g,x,k,Ge.disabled,(Re=h.tileID,De=(Se=K).stride,Be=d.create(),d.ortho(Be,0,d.EXTENT,-d.EXTENT,0,0,1),d.translate(Be,Be,[0,-d.EXTENT,0]),{u_matrix:Be,u_image:1,u_dimension:[De,De],u_zoom:Re.overscaledZ,u_unpack:Se.getUnpackVector()}),p.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments),h.needsHillshadePrepare=!1}}function $o(u,h,p,g,x){var k=g.paint.get("raster-fade-duration");if(k>0){var L=d.browser.now(),J=(L-u.timeAdded)/k,K=h?(L-h.timeAdded)/k:-1,ne=p.getSource(),_e=x.coveringZoomLevel({tileSize:ne.tileSize,roundZoom:ne.roundZoom}),ve=!h||Math.abs(h.tileID.overscaledZ-_e)>Math.abs(u.tileID.overscaledZ-_e),be=ve&&u.refreshedUponExpiration?1:d.clamp(ve?J:1-K,0,1);return u.refreshedUponExpiration&&J>=1&&(u.refreshedUponExpiration=!1),h?{opacity:1,mix:1-be}:{opacity:be,mix:0}}return{opacity:1,mix:0}}var Pa=new d.Color(1,0,0,1),Bs=new d.Color(0,1,0,1),dl=new d.Color(0,0,1,1),wr=new d.Color(1,0,1,1),Gs=new d.Color(0,1,1,1);function sc(u,h,p,g){Zl(u,0,h+p/2,u.transform.width,p,g)}function lc(u,h,p,g){Zl(u,h-p/2,0,p,u.transform.height,g)}function Zl(u,h,p,g,x,k){var L=u.context,J=L.gl;J.enable(J.SCISSOR_TEST),J.scissor(h*d.browser.devicePixelRatio,p*d.browser.devicePixelRatio,g*d.browser.devicePixelRatio,x*d.browser.devicePixelRatio),L.clear({color:k}),J.disable(J.SCISSOR_TEST)}function Qi(u,h,p){var g=u.context,x=g.gl,k=p.posMatrix,L=u.useProgram("debug"),J=Ce.disabled,K=Pe.disabled,ne=u.colorModeForRenderPass();g.activeTexture.set(x.TEXTURE0),u.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),L.draw(g,x.LINE_STRIP,J,K,ne,Ge.disabled,ca(k,d.Color.red),"$debug",u.debugBuffer,u.tileBorderIndexBuffer,u.debugSegments);var _e=h.getTileByID(p.key).latestRawTileData,ve=Math.floor((_e&&_e.byteLength||0)/1024),be=h.getTile(p).tileSize,Ee=512/Math.min(be,512)*(p.overscaledZ/u.transform.zoom)*.5,Oe=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Oe+=" => "+p.overscaledZ),function(Re,Se){Re.initDebugOverlayCanvas();var De=Re.debugOverlayCanvas,Be=Re.context.gl,Xe=Re.debugOverlayCanvas.getContext("2d");Xe.clearRect(0,0,De.width,De.height),Xe.shadowColor="white",Xe.shadowBlur=2,Xe.lineWidth=1.5,Xe.strokeStyle="white",Xe.textBaseline="top",Xe.font="bold 36px Open Sans, sans-serif",Xe.fillText(Se,5,5),Xe.strokeText(Se,5,5),Re.debugOverlayTexture.update(De),Re.debugOverlayTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE)}(u,Oe+" "+ve+"kb"),L.draw(g,x.TRIANGLES,J,K,qe.alphaBlended,Ge.disabled,ca(k,d.Color.transparent,Ee),"$debug",u.debugBuffer,u.quadTriangleIndexBuffer,u.debugSegments)}var Si={symbol:function(u,h,p,g,x){if("translucent"===u.renderPass){var k=Pe.disabled,L=u.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(J,K,ne,_e,ve,be,Ee){for(var Oe=K.transform,Re="map"===ve,Se="map"===be,De=0,Be=J;De<Be.length;De+=1){var Xe=Be[De],_t=_e.getTile(Xe),ct=_t.getBucket(ne);if(ct&&ct.text&&ct.text.segments.get().length){var yt=d.evaluateSizeForZoom(ct.textSizeData,Oe.zoom),St=no(_t,1,K.transform.zoom),Ut=eo(Xe.posMatrix,Se,Re,K.transform,St),Rt="none"!==ne.layout.get("icon-text-fit")&&ct.hasIconData();if(yt){var Kt=Math.pow(2,Oe.zoom-_t.tileID.overscaledZ);bi(ct,Re,Se,Ee,d.symbolSize,Oe,Ut,Xe.posMatrix,Kt,yt,Rt)}}}}(g,u,p,h,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),x),0!==p.paint.get("icon-opacity").constantOr(1)&&oo(u,h,p,g,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),k,L),0!==p.paint.get("text-opacity").constantOr(1)&&oo(u,h,p,g,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),k,L),h.map.showCollisionBoxes&&(en(u,h,p,g,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),en(u,h,p,g,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))}},circle:function(u,h,p,g){if("translucent"===u.renderPass){var x=p.paint.get("circle-opacity"),k=p.paint.get("circle-stroke-width"),L=p.paint.get("circle-stroke-opacity"),J=void 0!==p.layout.get("circle-sort-key").constantOr(1);if(0!==x.constantOr(1)||0!==k.constantOr(1)&&0!==L.constantOr(1)){for(var K=u.context,ne=K.gl,_e=u.depthModeForSublayer(0,Ce.ReadOnly),ve=Pe.disabled,be=u.colorModeForRenderPass(),Ee=[],Oe=0;Oe<g.length;Oe++){var Re=g[Oe],Se=h.getTile(Re),De=Se.getBucket(p);if(De){var Be=De.programConfigurations.get(p.id),Xe={programConfiguration:Be,program:u.useProgram("circle",Be),layoutVertexBuffer:De.layoutVertexBuffer,indexBuffer:De.indexBuffer,uniformValues:kc(u,Re,Se,p)};if(J)for(var _t=0,ct=De.segments.get();_t<ct.length;_t+=1){var yt=ct[_t];Ee.push({segments:new d.SegmentVector([yt]),sortKey:yt.sortKey,state:Xe})}else Ee.push({segments:De.segments,sortKey:0,state:Xe})}}J&&Ee.sort(function(wn,Mn){return wn.sortKey-Mn.sortKey});for(var St=0,Ut=Ee;St<Ut.length;St+=1){var Rt=Ut[St],Kt=Rt.state;Kt.program.draw(K,ne.TRIANGLES,_e,ve,be,Ge.disabled,Kt.uniformValues,p.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Rt.segments,p.paint,u.transform.zoom,Kt.programConfiguration)}}}},heatmap:function(u,h,p,g){if(0!==p.paint.get("heatmap-opacity"))if("offscreen"===u.renderPass){var x=u.context,k=x.gl,L=Pe.disabled,J=new qe([k.ONE,k.ONE],d.Color.transparent,[!0,!0,!0,!0]);(function(Ee,Oe,Re){var Se=Ee.gl;Ee.activeTexture.set(Se.TEXTURE1),Ee.viewport.set([0,0,Oe.width/4,Oe.height/4]);var Xe,_t,ct,yt,St,De=Re.heatmapFbo;if(De)Se.bindTexture(Se.TEXTURE_2D,De.colorAttachment.get()),Ee.bindFramebuffer.set(De.framebuffer);else{var Be=Se.createTexture();Se.bindTexture(Se.TEXTURE_2D,Be),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_S,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_WRAP_T,Se.CLAMP_TO_EDGE),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MIN_FILTER,Se.LINEAR),Se.texParameteri(Se.TEXTURE_2D,Se.TEXTURE_MAG_FILTER,Se.LINEAR),ct=Be,yt=De=Re.heatmapFbo=Ee.createFramebuffer(Oe.width/4,Oe.height/4,!1),(St=(Xe=Ee).gl).texImage2D(St.TEXTURE_2D,0,St.RGBA,(_t=Oe).width/4,_t.height/4,0,St.RGBA,Xe.extRenderToTextureHalfFloat?Xe.extTextureHalfFloat.HALF_FLOAT_OES:St.UNSIGNED_BYTE,null),yt.colorAttachment.set(ct)}})(x,u,p),x.clear({color:d.Color.transparent});for(var K=0;K<g.length;K++){var ne=g[K];if(!h.hasRenderableParent(ne)){var _e=h.getTile(ne),ve=_e.getBucket(p);if(ve){var be=ve.programConfigurations.get(p.id);u.useProgram("heatmap",be).draw(x,k.TRIANGLES,Ce.disabled,L,J,Ge.disabled,Ic(ne.posMatrix,_e,u.transform.zoom,p.paint.get("heatmap-intensity")),p.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,p.paint,u.transform.zoom,be)}}}x.viewport.set([0,0,u.width,u.height])}else"translucent"===u.renderPass&&(u.context.setColorMode(u.colorModeForRenderPass()),function(Ee,Oe){var Re=Ee.context,Se=Re.gl,De=Oe.heatmapFbo;if(De){Re.activeTexture.set(Se.TEXTURE0),Se.bindTexture(Se.TEXTURE_2D,De.colorAttachment.get()),Re.activeTexture.set(Se.TEXTURE1);var Be=Oe.colorRampTexture;Be||(Be=Oe.colorRampTexture=new d.Texture(Re,Oe.colorRamp,Se.RGBA)),Be.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),Ee.useProgram("heatmapTexture").draw(Re,Se.TRIANGLES,Ce.disabled,Pe.disabled,Ee.colorModeForRenderPass(),Ge.disabled,function(Xe,_t,ct,yt){var St=d.create();d.ortho(St,0,Xe.width,Xe.height,0,0,1);var Ut=Xe.context.gl;return{u_matrix:St,u_world:[Ut.drawingBufferWidth,Ut.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:_t.paint.get("heatmap-opacity")}}(Ee,Oe),Oe.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments,Oe.paint,Ee.transform.zoom)}}(u,p))},line:function(u,h,p,g){if("translucent"===u.renderPass){var x=p.paint.get("line-opacity"),k=p.paint.get("line-width");if(0!==x.constantOr(1)&&0!==k.constantOr(1))for(var L=u.depthModeForSublayer(0,Ce.ReadOnly),J=u.colorModeForRenderPass(),K=p.paint.get("line-dasharray"),ne=p.paint.get("line-pattern"),_e=ne.constantOr(1),ve=p.paint.get("line-gradient"),be=p.getCrossfadeParameters(),Ee=_e?"linePattern":K?"lineSDF":ve?"lineGradient":"line",Oe=u.context,Re=Oe.gl,Se=!0,De=0,Be=g;De<Be.length;De+=1){var Xe=Be[De],_t=h.getTile(Xe);if(!_e||_t.patternsLoaded()){var ct=_t.getBucket(p);if(ct){var yt=ct.programConfigurations.get(p.id),St=u.context.program.get(),Ut=u.useProgram(Ee,yt),Rt=Se||Ut.program!==St,Kt=ne.constantOr(null);if(Kt&&_t.imageAtlas){var wn=_t.imageAtlas,Mn=wn.patternPositions[Kt.to.toString()],En=wn.patternPositions[Kt.from.toString()];Mn&&En&&yt.setConstantPatternPositions(Mn,En)}var _i=_e?Ba(u,_t,p,be):K?yu(u,_t,p,K,be):ve?Vi(u,_t,p,ct.lineClipsArray.length):Yr(u,_t,p);if(_e)Oe.activeTexture.set(Re.TEXTURE0),_t.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),yt.updatePaintBuffers(be);else if(K&&(Rt||u.lineAtlas.dirty))Oe.activeTexture.set(Re.TEXTURE0),u.lineAtlas.bind(Oe);else if(ve){var Gt=ct.gradients[p.id],jn=Gt.texture;if(p.gradientVersion!==Gt.version){var ti=256;if(p.stepInterpolant){var Fn=h.getSource().maxzoom,Un=Xe.canonical.z===Fn?Math.ceil(1<<u.transform.maxZoom-Xe.canonical.z):1;ti=d.clamp(d.nextPowerOfTwo(ct.maxLineLength/d.EXTENT*1024*Un),256,Oe.maxTextureSize)}Gt.gradient=d.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:ti,image:Gt.gradient||void 0,clips:ct.lineClipsArray}),Gt.texture?Gt.texture.update(Gt.gradient):Gt.texture=new d.Texture(Oe,Gt.gradient,Re.RGBA),Gt.version=p.gradientVersion,jn=Gt.texture}Oe.activeTexture.set(Re.TEXTURE0),jn.bind(p.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}Ut.draw(Oe,Re.TRIANGLES,L,u.stencilModeForClipping(Xe),J,Ge.disabled,_i,p.id,ct.layoutVertexBuffer,ct.indexBuffer,ct.segments,p.paint,u.transform.zoom,yt,ct.layoutVertexBuffer2),Se=!1}}}}},fill:function(u,h,p,g){var x=p.paint.get("fill-color"),k=p.paint.get("fill-opacity");if(0!==k.constantOr(1)){var L=u.colorModeForRenderPass(),J=p.paint.get("fill-pattern"),K=u.opaquePassEnabledForLayer()&&!J.constantOr(1)&&1===x.constantOr(d.Color.transparent).a&&1===k.constantOr(0)?"opaque":"translucent";if(u.renderPass===K){var ne=u.depthModeForSublayer(1,"opaque"===u.renderPass?Ce.ReadWrite:Ce.ReadOnly);xo(u,h,p,g,ne,L,!1)}if("translucent"===u.renderPass&&p.paint.get("fill-antialias")){var _e=u.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,Ce.ReadOnly);xo(u,h,p,g,_e,L,!0)}}},"fill-extrusion":function(u,h,p,g){var x=p.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===u.renderPass){var k=new Ce(u.context.gl.LEQUAL,Ce.ReadWrite,u.depthRangeFor3D);if(1!==x||p.paint.get("fill-extrusion-pattern").constantOr(1))Ao(u,h,p,g,k,Pe.disabled,qe.disabled),Ao(u,h,p,g,k,u.stencilModeFor3D(),u.colorModeForRenderPass());else{var L=u.colorModeForRenderPass();Ao(u,h,p,g,k,Pe.disabled,L)}}},hillshade:function(u,h,p,g){if("offscreen"===u.renderPass||"translucent"===u.renderPass){for(var x=u.context,k=u.depthModeForSublayer(0,Ce.ReadOnly),L=u.colorModeForRenderPass(),J="translucent"===u.renderPass?u.stencilConfigForOverlap(g):[{},g],K=J[0],ne=0,_e=J[1];ne<_e.length;ne+=1){var ve=_e[ne],be=h.getTile(ve);be.needsHillshadePrepare&&"offscreen"===u.renderPass?cs(u,be,p,k,Pe.disabled,L):"translucent"===u.renderPass&&Hr(u,be,p,k,K[ve.overscaledZ],L)}x.viewport.set([0,0,u.width,u.height])}},raster:function(u,h,p,g){if("translucent"===u.renderPass&&0!==p.paint.get("raster-opacity")&&g.length)for(var x=u.context,k=x.gl,L=h.getSource(),J=u.useProgram("raster"),K=u.colorModeForRenderPass(),ne=L instanceof mt?[{},g]:u.stencilConfigForOverlap(g),_e=ne[0],ve=ne[1],be=ve[ve.length-1].overscaledZ,Ee=!u.options.moving,Oe=0,Re=ve;Oe<Re.length;Oe+=1){var Se=Re[Oe],De=u.depthModeForSublayer(Se.overscaledZ-be,1===p.paint.get("raster-opacity")?Ce.ReadWrite:Ce.ReadOnly,k.LESS),Be=h.getTile(Se),Xe=u.transform.calculatePosMatrix(Se.toUnwrapped(),Ee);Be.registerFadeDuration(p.paint.get("raster-fade-duration"));var _t=h.findLoadedParent(Se,0),ct=$o(Be,_t,h,p,u.transform),yt=void 0,St=void 0,Ut="nearest"===p.paint.get("raster-resampling")?k.NEAREST:k.LINEAR;x.activeTexture.set(k.TEXTURE0),Be.texture.bind(Ut,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),x.activeTexture.set(k.TEXTURE1),_t?(_t.texture.bind(Ut,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),yt=Math.pow(2,_t.tileID.overscaledZ-Be.tileID.overscaledZ),St=[Be.tileID.canonical.x*yt%1,Be.tileID.canonical.y*yt%1]):Be.texture.bind(Ut,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST);var Rt=Zc(Xe,St||[0,0],yt||1,ct,p);L instanceof mt?J.draw(x,k.TRIANGLES,De,Pe.disabled,K,Ge.disabled,Rt,p.id,L.boundsBuffer,u.quadTriangleIndexBuffer,L.boundsSegments):J.draw(x,k.TRIANGLES,De,_e[Se.overscaledZ],K,Ge.disabled,Rt,p.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}},background:function(u,h,p){var g=p.paint.get("background-color"),x=p.paint.get("background-opacity");if(0!==x){var k=u.context,L=k.gl,J=u.transform,K=J.tileSize,ne=p.paint.get("background-pattern");if(!u.isPatternMissing(ne)){var _e=!ne&&1===g.a&&1===x&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass===_e){var ve=Pe.disabled,be=u.depthModeForSublayer(0,"opaque"===_e?Ce.ReadWrite:Ce.ReadOnly),Ee=u.colorModeForRenderPass(),Oe=u.useProgram(ne?"backgroundPattern":"background"),Re=J.coveringTiles({tileSize:K});ne&&(k.activeTexture.set(L.TEXTURE0),u.imageManager.bind(u.context));for(var Se=p.getCrossfadeParameters(),De=0,Be=Re;De<Be.length;De+=1){var Xe=Be[De],_t=u.transform.calculatePosMatrix(Xe.toUnwrapped()),ct=ne?Ke(_t,x,u,ne,{tileID:Xe,tileSize:K},Se):Il(_t,x,g);Oe.draw(k,L.TRIANGLES,be,ve,Ee,Ge.disabled,ct,p.id,u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments)}}}}},debug:function(u,h,p){for(var g=0;g<p.length;g++)Qi(u,h,p[g])},custom:function(u,h,p){var g=u.context,x=p.implementation;if("offscreen"===u.renderPass){var k=x.prerender;k&&(u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),k.call(x,g.gl,u.transform.customLayerMatrix()),g.setDirty(),u.setBaseState())}else if("translucent"===u.renderPass){u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),g.setStencilMode(Pe.disabled);var L="3d"===x.renderingMode?new Ce(u.context.gl.LEQUAL,Ce.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,Ce.ReadOnly);g.setDepthMode(L),x.render(g.gl,u.transform.customLayerMatrix()),g.setDirty(),u.setBaseState(),g.bindFramebuffer.set(null)}}},ji=function(u,h){this.context=new ye(u),this.transform=h,this._tileTextures={},this.setup(),this.numSublayers=Ze.maxUnderzooming+Ze.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Tn,this.gpuTimers={}};ji.prototype.resize=function(u,h){if(this.width=u*d.browser.devicePixelRatio,this.height=h*d.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var p=0,g=this.style._order;p<g.length;p+=1)this.style._layers[g[p]].resize()},ji.prototype.setup=function(){var u=this.context,h=new d.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(d.EXTENT,0),h.emplaceBack(0,d.EXTENT),h.emplaceBack(d.EXTENT,d.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(h,co.members),this.tileExtentSegments=d.SegmentVector.simpleSegment(0,0,4,2);var p=new d.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(d.EXTENT,0),p.emplaceBack(0,d.EXTENT),p.emplaceBack(d.EXTENT,d.EXTENT),this.debugBuffer=u.createVertexBuffer(p,co.members),this.debugSegments=d.SegmentVector.simpleSegment(0,0,4,5);var g=new d.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(d.EXTENT,0,d.EXTENT,0),g.emplaceBack(0,d.EXTENT,0,d.EXTENT),g.emplaceBack(d.EXTENT,d.EXTENT,d.EXTENT,d.EXTENT),this.rasterBoundsBuffer=u.createVertexBuffer(g,Ye.members),this.rasterBoundsSegments=d.SegmentVector.simpleSegment(0,0,4,2);var x=new d.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(x,co.members),this.viewportSegments=d.SegmentVector.simpleSegment(0,0,4,2);var k=new d.StructArrayLayout1ui2;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(k);var L=new d.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(L),this.emptyTexture=new d.Texture(u,{width:1,height:1,data:new Uint8Array([0,0,0,0])},u.gl.RGBA);var J=this.context.gl;this.stencilClearMode=new Pe({func:J.ALWAYS,mask:0},0,255,J.ZERO,J.ZERO,J.ZERO)},ji.prototype.clearStencil=function(){var u=this.context,h=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var p=d.create();d.ortho(p,0,this.width,this.height,0,0,1),d.scale(p,p,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(u,h.TRIANGLES,Ce.disabled,this.stencilClearMode,qe.disabled,Ge.disabled,Vr(p),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ji.prototype._renderTileClippingMasks=function(u,h){if(this.currentStencilSource!==u.source&&u.isTileClipped()&&h&&h.length){this.currentStencilSource=u.source;var p=this.context,g=p.gl;this.nextStencilID+h.length>256&&this.clearStencil(),p.setColorMode(qe.disabled),p.setDepthMode(Ce.disabled);var x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var k=0,L=h;k<L.length;k+=1){var J=L[k],K=this._tileClippingMaskIDs[J.key]=this.nextStencilID++;x.draw(p,g.TRIANGLES,Ce.disabled,new Pe({func:g.ALWAYS,mask:0},K,255,g.KEEP,g.KEEP,g.REPLACE),qe.disabled,Ge.disabled,Vr(J.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ji.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var u=this.nextStencilID++,h=this.context.gl;return new Pe({func:h.NOTEQUAL,mask:255},u,255,h.KEEP,h.KEEP,h.REPLACE)},ji.prototype.stencilModeForClipping=function(u){var h=this.context.gl;return new Pe({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,h.KEEP,h.KEEP,h.REPLACE)},ji.prototype.stencilConfigForOverlap=function(u){var h,p=this.context.gl,g=u.sort(function(K,ne){return ne.overscaledZ-K.overscaledZ}),x=g[g.length-1].overscaledZ,k=g[0].overscaledZ-x+1;if(k>1){this.currentStencilSource=void 0,this.nextStencilID+k>256&&this.clearStencil();for(var L={},J=0;J<k;J++)L[J+x]=new Pe({func:p.GEQUAL,mask:255},J+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=k,[L,g]}return[(h={},h[x]=Pe.disabled,h),g]},ji.prototype.colorModeForRenderPass=function(){var u=this.context.gl;return this._showOverdrawInspector?new qe([u.CONSTANT_COLOR,u.ONE],new d.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?qe.unblended:qe.alphaBlended},ji.prototype.depthModeForSublayer=function(u,h,p){if(!this.opaquePassEnabledForLayer())return Ce.disabled;var g=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new Ce(p||this.context.gl.LEQUAL,h,[g,g])},ji.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ji.prototype.render=function(u,h){var p=this;this.style=u,this.options=h,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(d.browser.now()),this.imageManager.beginFrame();var g=this.style._order,x=this.style.sourceCaches;for(var k in x){var L=x[k];L.used&&L.prepare(this.context)}var J,K,ne={},_e={},ve={};for(var be in x){var Ee=x[be];ne[be]=Ee.getVisibleCoordinates(),_e[be]=ne[be].slice().reverse(),ve[be]=Ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Oe=0;Oe<g.length;Oe++)if(this.style._layers[g[Oe]].is3D()){this.opaquePassCutoff=Oe;break}this.renderPass="offscreen";for(var Re=0,Se=g;Re<Se.length;Re+=1){var De=this.style._layers[Se[Re]];if(De.hasOffscreenPass()&&!De.isHidden(this.transform.zoom)){var Be=_e[De.source];("custom"===De.type||Be.length)&&this.renderLayer(this,x[De.source],De,Be)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?d.Color.black:d.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){var Xe=this.style._layers[g[this.currentLayer]],_t=x[Xe.source],ct=ne[Xe.source];this._renderTileClippingMasks(Xe,ct),this.renderLayer(this,_t,Xe,ct)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){var yt=this.style._layers[g[this.currentLayer]],St=x[yt.source],Ut=("symbol"===yt.type?ve:_e)[yt.source];this._renderTileClippingMasks(yt,ne[yt.source]),this.renderLayer(this,St,yt,Ut)}this.options.showTileBoundaries&&(d.values(this.style._layers).forEach(function(Rt){Rt.source&&!Rt.isHidden(p.transform.zoom)&&(Rt.source!==(K&&K.id)&&(K=p.style.sourceCaches[Rt.source]),(!J||J.getSource().maxzoom<K.getSource().maxzoom)&&(J=K))}),J&&Si.debug(this,J,J.getVisibleCoordinates())),this.options.showPadding&&function(Rt){var Kt=Rt.transform.padding;sc(Rt,Rt.transform.height-(Kt.top||0),3,Pa),sc(Rt,Kt.bottom||0,3,Bs),lc(Rt,Kt.left||0,3,dl),lc(Rt,Rt.transform.width-(Kt.right||0),3,wr);var Mn,En,_i,Gt,wn=Rt.transform.centerPoint;Zl(Mn=Rt,(En=wn.x)-1,(_i=Rt.transform.height-wn.y)-10,2,20,Gt=Gs),Zl(Mn,En-10,_i-1,20,2,Gt)}(this),this.context.setDefault()},ji.prototype.renderLayer=function(u,h,p,g){p.isHidden(this.transform.zoom)||("background"===p.type||"custom"===p.type||g.length)&&(this.id=p.id,this.gpuTimingStart(p),Si[p.type](u,h,p,g,this.style.placement.variableOffsets),this.gpuTimingEnd())},ji.prototype.gpuTimingStart=function(u){if(this.options.gpuTiming){var h=this.context.extTimerQuery,p=this.gpuTimers[u.id];p||(p=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),p.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,p.query)}},ji.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}},ji.prototype.collectGpuTimers=function(){var u=this.gpuTimers;return this.gpuTimers={},u},ji.prototype.queryGpuTimers=function(u){var h={};for(var p in u){var g=u[p],x=this.context.extTimerQuery,k=x.getQueryObjectEXT(g.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(g.query),h[p]=k}return h},ji.prototype.translatePosMatrix=function(u,h,p,g,x){if(!p[0]&&!p[1])return u;var k=x?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(k){var L=Math.sin(k),J=Math.cos(k);p=[p[0]*J-p[1]*L,p[0]*L+p[1]*J]}var K=[x?p[0]:no(h,p[0],this.transform.zoom),x?p[1]:no(h,p[1],this.transform.zoom),0],ne=new Float32Array(16);return d.translate(ne,u,K),ne},ji.prototype.saveTileTexture=function(u){var h=this._tileTextures[u.size[0]];h?h.push(u):this._tileTextures[u.size[0]]=[u]},ji.prototype.getTileTexture=function(u){var h=this._tileTextures[u];return h&&h.length>0?h.pop():null},ji.prototype.isPatternMissing=function(u){if(!u)return!1;if(!u.from||!u.to)return!0;var h=this.imageManager.getPattern(u.from.toString()),p=this.imageManager.getPattern(u.to.toString());return!h||!p},ji.prototype.useProgram=function(u,h){this.cache=this.cache||{};var p=""+u+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[p]||(this.cache[p]=new ul(this.context,u,Js[u],h,Ct[u],this._showOverdrawInspector)),this.cache[p]},ji.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ji.prototype.setBaseState=function(){var u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)},ji.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=d.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new d.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},ji.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Ga=function(u,h){this.points=u,this.planes=h};Ga.fromInvProjectionMatrix=function(u,h,p){var g=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return d.transformMat4([],L,u)}).map(function(L){return d.scale$1([],L,1/L[3]/h*g)}),k=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var J=d.sub([],x[L[0]],x[L[1]]),K=d.sub([],x[L[2]],x[L[1]]),ne=d.normalize([],d.cross([],J,K)),_e=-d.dot(ne,x[L[1]]);return ne.concat(_e)});return new Ga(x,k)};var Va=function(u,h){this.min=u,this.max=h,this.center=d.scale$2([],d.add([],this.min,this.max),.5)};Va.prototype.quadrant=function(u){for(var h=[u%2==0,u<2],p=d.clone$2(this.min),g=d.clone$2(this.max),x=0;x<h.length;x++)p[x]=h[x]?this.min[x]:this.center[x],g[x]=h[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new Va(p,g)},Va.prototype.distanceX=function(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]},Va.prototype.distanceY=function(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]},Va.prototype.intersects=function(u){for(var h=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],p=!0,g=0;g<u.planes.length;g++){for(var x=u.planes[g],k=0,L=0;L<h.length;L++)k+=d.dot$1(x,h[L])>=0;if(0===k)return 0;k!==h.length&&(p=!1)}if(p)return 2;for(var J=0;J<3;J++){for(var K=Number.MAX_VALUE,ne=-Number.MAX_VALUE,_e=0;_e<u.points.length;_e++){var ve=u.points[_e][J]-this.min[J];K=Math.min(K,ve),ne=Math.max(ne,ve)}if(ne<0||K>this.max[J]-this.min[J])return 0}return 1};var Go=function(u,h,p,g){if(void 0===u&&(u=0),void 0===h&&(h=0),void 0===p&&(p=0),void 0===g&&(g=0),isNaN(u)||u<0||isNaN(h)||h<0||isNaN(p)||p<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=h,this.left=p,this.right=g};Go.prototype.interpolate=function(u,h,p){return null!=h.top&&null!=u.top&&(this.top=d.number(u.top,h.top,p)),null!=h.bottom&&null!=u.bottom&&(this.bottom=d.number(u.bottom,h.bottom,p)),null!=h.left&&null!=u.left&&(this.left=d.number(u.left,h.left,p)),null!=h.right&&null!=u.right&&(this.right=d.number(u.right,h.right,p)),this},Go.prototype.getCenter=function(u,h){var p=d.clamp((this.left+u-this.right)/2,0,u),g=d.clamp((this.top+h-this.bottom)/2,0,h);return new d.Point(p,g)},Go.prototype.equals=function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right},Go.prototype.clone=function(){return new Go(this.top,this.bottom,this.left,this.right)},Go.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Wn=function(u,h,p,g,x){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===x||x,this._minZoom=u||0,this._maxZoom=h||22,this._minPitch=p??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Go,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ti={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Wn.prototype.clone=function(){var u=new Wn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u._center=this._center,u.zoom=this.zoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._calcMatrices(),u},Ti.minZoom.get=function(){return this._minZoom},Ti.minZoom.set=function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))},Ti.maxZoom.get=function(){return this._maxZoom},Ti.maxZoom.set=function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))},Ti.minPitch.get=function(){return this._minPitch},Ti.minPitch.set=function(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))},Ti.maxPitch.get=function(){return this._maxPitch},Ti.maxPitch.set=function(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))},Ti.renderWorldCopies.get=function(){return this._renderWorldCopies},Ti.renderWorldCopies.set=function(u){void 0===u?u=!0:null===u&&(u=!1),this._renderWorldCopies=u},Ti.worldSize.get=function(){return this.tileSize*this.scale},Ti.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ti.size.get=function(){return new d.Point(this.width,this.height)},Ti.bearing.get=function(){return-this.angle/Math.PI*180},Ti.bearing.set=function(u){var h=-d.wrap(u,-180,180)*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=d.create$2(),d.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ti.pitch.get=function(){return this._pitch/Math.PI*180},Ti.pitch.set=function(u){var h=d.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())},Ti.fov.get=function(){return this._fov/Math.PI*180},Ti.fov.set=function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=u/180*Math.PI,this._calcMatrices())},Ti.zoom.get=function(){return this._zoom},Ti.zoom.set=function(u){var h=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom,this._constrain(),this._calcMatrices())},Ti.center.get=function(){return this._center},Ti.center.set=function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._constrain(),this._calcMatrices())},Ti.padding.get=function(){return this._edgeInsets.toJSON()},Ti.padding.set=function(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())},Ti.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Wn.prototype.isPaddingEqual=function(u){return this._edgeInsets.equals(u)},Wn.prototype.interpolatePadding=function(u,h,p){this._unmodified=!1,this._edgeInsets.interpolate(u,h,p),this._constrain(),this._calcMatrices()},Wn.prototype.coveringZoomLevel=function(u){var h=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,h)},Wn.prototype.getVisibleUnwrappedCoordinates=function(u){var h=[new d.UnwrappedTileID(0,u)];if(this._renderWorldCopies)for(var p=this.pointCoordinate(new d.Point(0,0)),g=this.pointCoordinate(new d.Point(this.width,0)),x=this.pointCoordinate(new d.Point(this.width,this.height)),k=this.pointCoordinate(new d.Point(0,this.height)),L=Math.floor(Math.min(p.x,g.x,x.x,k.x)),J=Math.floor(Math.max(p.x,g.x,x.x,k.x)),K=L-1;K<=J+1;K++)0!==K&&h.push(new d.UnwrappedTileID(K,u));return h},Wn.prototype.coveringTiles=function(u){var h=this.coveringZoomLevel(u),p=h;if(void 0!==u.minzoom&&h<u.minzoom)return[];void 0!==u.maxzoom&&h>u.maxzoom&&(h=u.maxzoom);var g=d.MercatorCoordinate.fromLngLat(this.center),x=Math.pow(2,h),k=[x*g.x,x*g.y,0],L=Ga.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h),J=u.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(J=h);var K=function(Rt){return{aabb:new Va([Rt*x,0,0],[(Rt+1)*x,x,0]),zoom:0,x:0,y:0,wrap:Rt,fullyVisible:!1}},ne=[],_e=[],ve=h,be=u.reparseOverscaled?p:h;if(this._renderWorldCopies)for(var Ee=1;Ee<=3;Ee++)ne.push(K(-Ee)),ne.push(K(Ee));for(ne.push(K(0));ne.length>0;){var Oe=ne.pop(),Re=Oe.x,Se=Oe.y,De=Oe.fullyVisible;if(!De){var Be=Oe.aabb.intersects(L);if(0===Be)continue;De=2===Be}var Xe=Oe.aabb.distanceX(k),_t=Oe.aabb.distanceY(k),ct=Math.max(Math.abs(Xe),Math.abs(_t));if(Oe.zoom===ve||ct>3+(1<<ve-Oe.zoom)-2&&Oe.zoom>=J)_e.push({tileID:new d.OverscaledTileID(Oe.zoom===ve?be:Oe.zoom,Oe.wrap,Oe.zoom,Re,Se),distanceSq:d.sqrLen([k[0]-.5-Re,k[1]-.5-Se])});else for(var yt=0;yt<4;yt++){var St=(Re<<1)+yt%2,Ut=(Se<<1)+(yt>>1);ne.push({aabb:Oe.aabb.quadrant(yt),zoom:Oe.zoom+1,x:St,y:Ut,wrap:Oe.wrap,fullyVisible:De})}}return _e.sort(function(Rt,Kt){return Rt.distanceSq-Kt.distanceSq}).map(function(Rt){return Rt.tileID})},Wn.prototype.resize=function(u,h){this.width=u,this.height=h,this.pixelsToGLUnits=[2/u,-2/h],this._constrain(),this._calcMatrices()},Ti.unmodified.get=function(){return this._unmodified},Wn.prototype.zoomScale=function(u){return Math.pow(2,u)},Wn.prototype.scaleZoom=function(u){return Math.log(u)/Math.LN2},Wn.prototype.project=function(u){var h=d.clamp(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new d.Point(d.mercatorXfromLng(u.lng)*this.worldSize,d.mercatorYfromLat(h)*this.worldSize)},Wn.prototype.unproject=function(u){return new d.MercatorCoordinate(u.x/this.worldSize,u.y/this.worldSize).toLngLat()},Ti.point.get=function(){return this.project(this.center)},Wn.prototype.setLocationAtPoint=function(u,h){var p=this.pointCoordinate(h),g=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(u),k=new d.MercatorCoordinate(x.x-(p.x-g.x),x.y-(p.y-g.y));this.center=this.coordinateLocation(k),this._renderWorldCopies&&(this.center=this.center.wrap())},Wn.prototype.locationPoint=function(u){return this.coordinatePoint(this.locationCoordinate(u))},Wn.prototype.pointLocation=function(u){return this.coordinateLocation(this.pointCoordinate(u))},Wn.prototype.locationCoordinate=function(u){return d.MercatorCoordinate.fromLngLat(u)},Wn.prototype.coordinateLocation=function(u){return u.toLngLat()},Wn.prototype.pointCoordinate=function(u){var h=[u.x,u.y,0,1],p=[u.x,u.y,1,1];d.transformMat4(h,h,this.pixelMatrixInverse),d.transformMat4(p,p,this.pixelMatrixInverse);var g=h[3],x=p[3],k=h[1]/g,L=p[1]/x,J=h[2]/g,K=p[2]/x,ne=J===K?0:(0-J)/(K-J);return new d.MercatorCoordinate(d.number(h[0]/g,p[0]/x,ne)/this.worldSize,d.number(k,L,ne)/this.worldSize)},Wn.prototype.coordinatePoint=function(u){var h=[u.x*this.worldSize,u.y*this.worldSize,0,1];return d.transformMat4(h,h,this.pixelMatrix),new d.Point(h[0]/h[3],h[1]/h[3])},Wn.prototype.getBounds=function(){return(new d.LngLatBounds).extend(this.pointLocation(new d.Point(0,0))).extend(this.pointLocation(new d.Point(this.width,0))).extend(this.pointLocation(new d.Point(this.width,this.height))).extend(this.pointLocation(new d.Point(0,this.height)))},Wn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new d.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Wn.prototype.setMaxBounds=function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Wn.prototype.calculatePosMatrix=function(u,h){void 0===h&&(h=!1);var p=u.key,g=h?this._alignedPosMatrixCache:this._posMatrixCache;if(g[p])return g[p];var x=u.canonical,k=this.worldSize/this.zoomScale(x.z),L=x.x+Math.pow(2,x.z)*u.wrap,J=d.identity(new Float64Array(16));return d.translate(J,J,[L*k,x.y*k,0]),d.scale(J,J,[k/d.EXTENT,k/d.EXTENT,1]),d.multiply(J,h?this.alignedProjMatrix:this.projMatrix,J),g[p]=new Float32Array(J),g[p]},Wn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Wn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var u,h,p,g,x=-90,k=90,L=-180,J=180,K=this.size,ne=this._unmodified;if(this.latRange){var _e=this.latRange;x=d.mercatorYfromLat(_e[1])*this.worldSize,u=(k=d.mercatorYfromLat(_e[0])*this.worldSize)-x<K.y?K.y/(k-x):0}if(this.lngRange){var ve=this.lngRange;L=d.mercatorXfromLng(ve[0])*this.worldSize,h=(J=d.mercatorXfromLng(ve[1])*this.worldSize)-L<K.x?K.x/(J-L):0}var be=this.point,Ee=Math.max(h||0,u||0);if(Ee)return this.center=this.unproject(new d.Point(h?(J+L)/2:be.x,u?(k+x)/2:be.y)),this.zoom+=this.scaleZoom(Ee),this._unmodified=ne,void(this._constraining=!1);if(this.latRange){var Oe=be.y,Re=K.y/2;Oe-Re<x&&(g=x+Re),Oe+Re>k&&(g=k-Re)}if(this.lngRange){var Se=be.x,De=K.x/2;Se-De<L&&(p=L+De),Se+De>J&&(p=J-De)}void 0===p&&void 0===g||(this.center=this.unproject(new d.Point(void 0!==p?p:be.x,void 0!==g?g:be.y))),this._unmodified=ne,this._constraining=!1}},Wn.prototype._calcMatrices=function(){if(this.height){var u=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var h=Math.PI/2+this._pitch,p=this._fov*(.5+u.y/this.height),g=Math.sin(p)*this.cameraToCenterDistance/Math.sin(d.clamp(Math.PI-h-p,.01,Math.PI-.01)),x=this.point,k=x.x,L=x.y,J=1.01*(Math.cos(Math.PI/2-this._pitch)*g+this.cameraToCenterDistance),K=this.height/50,ne=new Float64Array(16);d.perspective(ne,this._fov,this.width/this.height,K,J),ne[8]=2*-u.x/this.width,ne[9]=2*u.y/this.height,d.scale(ne,ne,[1,-1,1]),d.translate(ne,ne,[0,0,-this.cameraToCenterDistance]),d.rotateX(ne,ne,this._pitch),d.rotateZ(ne,ne,this.angle),d.translate(ne,ne,[-k,-L,0]),this.mercatorMatrix=d.scale([],ne,[this.worldSize,this.worldSize,this.worldSize]),d.scale(ne,ne,[1,1,d.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ne,this.invProjMatrix=d.invert([],this.projMatrix);var _e=this.width%2/2,ve=this.height%2/2,be=Math.cos(this.angle),Ee=Math.sin(this.angle),Oe=k-Math.round(k)+be*_e+Ee*ve,Re=L-Math.round(L)+be*ve+Ee*_e,Se=new Float64Array(ne);if(d.translate(Se,Se,[Oe>.5?Oe-1:Oe,Re>.5?Re-1:Re,0]),this.alignedProjMatrix=Se,ne=d.create(),d.scale(ne,ne,[this.width/2,-this.height/2,1]),d.translate(ne,ne,[1,-1,0]),this.labelPlaneMatrix=ne,ne=d.create(),d.scale(ne,ne,[1,-1,1]),d.translate(ne,ne,[-1,-1,0]),d.scale(ne,ne,[2/this.width,2/this.height,1]),this.glCoordMatrix=ne,this.pixelMatrix=d.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ne=d.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ne,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Wn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new d.Point(0,0)),h=[u.x*this.worldSize,u.y*this.worldSize,0,1];return d.transformMat4(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance},Wn.prototype.getCameraPoint=function(){var u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.Point(0,u))},Wn.prototype.getCameraQueryGeometry=function(u){var h=this.getCameraPoint();if(1===u.length)return[u[0],h];for(var p=h.x,g=h.y,x=h.x,k=h.y,L=0,J=u;L<J.length;L+=1){var K=J[L];p=Math.min(p,K.x),g=Math.min(g,K.y),x=Math.max(x,K.x),k=Math.max(k,K.y)}return[new d.Point(p,g),new d.Point(x,g),new d.Point(x,k),new d.Point(p,k),new d.Point(p,g)]},Object.defineProperties(Wn.prototype,Ti);var Wo=function(u){var h,p,g,x;this._hashName=u&&encodeURIComponent(u),d.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(h=this._updateHashUnthrottled.bind(this),p=!1,g=null,x=function(){g=null,p&&(h(),g=setTimeout(x,300),p=!1)},function(){return p=!0,g||x(),g})};Wo.prototype.addTo=function(u){return this._map=u,d.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Wo.prototype.remove=function(){return d.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Wo.prototype.getHashString=function(u){var h=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,g=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,g),k=Math.round(h.lng*x)/x,L=Math.round(h.lat*x)/x,J=this._map.getBearing(),K=this._map.getPitch(),ne="";if(ne+=u?"/"+k+"/"+L+"/"+p:p+"/"+L+"/"+k,(J||K)&&(ne+="/"+Math.round(10*J)/10),K&&(ne+="/"+Math.round(K)),this._hashName){var _e=this._hashName,ve=!1,be=d.window.location.hash.slice(1).split("&").map(function(Ee){var Oe=Ee.split("=")[0];return Oe===_e?(ve=!0,Oe+"="+ne):Ee}).filter(function(Ee){return Ee});return ve||be.push(_e+"="+ne),"#"+be.join("&")}return"#"+ne},Wo.prototype._getCurrentHash=function(){var u,h=this,p=d.window.location.hash.replace("#","");return this._hashName?(p.split("&").map(function(g){return g.split("=")}).forEach(function(g){g[0]===h._hashName&&(u=g)}),(u&&u[1]||"").split("/")):p.split("/")},Wo.prototype._onHashChange=function(){var u=this._getCurrentHash();if(u.length>=3&&!u.some(function(p){return isNaN(p)})){var h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:h,pitch:+(u[4]||0)}),!0}return!1},Wo.prototype._updateHashUnthrottled=function(){var u=d.window.location.href.replace(/(#.+)?$/,this.getHashString());try{d.window.history.replaceState(d.window.history.state,null,u)}catch{}};var zo={linearity:.3,easing:d.bezier(0,0,.3,1)},ua=d.extend({deceleration:2500,maxSpeed:1400},zo),hr=d.extend({deceleration:20,maxSpeed:1400},zo),Lc=d.extend({deceleration:1e3,maxSpeed:360},zo),Nl=d.extend({deceleration:1e3,maxSpeed:90},zo),Ya=function(u){this._map=u,this.clear()};function Vs(u,h){(!u.duration||u.duration<h.duration)&&(u.duration=h.duration,u.easing=h.easing)}function Qr(u,h,p){var g=p.maxSpeed,x=p.linearity,k=p.deceleration,L=d.clamp(u*x/(h/1e3),-g,g),J=Math.abs(L)/(k*x);return{easing:p.easing,duration:1e3*J,amount:L*(J/2)}}Ya.prototype.clear=function(){this._inertiaBuffer=[]},Ya.prototype.record=function(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:d.browser.now(),settings:u})},Ya.prototype._drainInertiaBuffer=function(){for(var u=this._inertiaBuffer,h=d.browser.now();u.length>0&&h-u[0].time>160;)u.shift()},Ya.prototype._onMoveEnd=function(u){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var h={zoom:0,bearing:0,pitch:0,pan:new d.Point(0,0),pinchAround:void 0,around:void 0},p=0,g=this._inertiaBuffer;p<g.length;p+=1){var x=g[p].settings;h.zoom+=x.zoomDelta||0,h.bearing+=x.bearingDelta||0,h.pitch+=x.pitchDelta||0,x.panDelta&&h.pan._add(x.panDelta),x.around&&(h.around=x.around),x.pinchAround&&(h.pinchAround=x.pinchAround)}var k=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(h.pan.mag()){var J=Qr(h.pan.mag(),k,d.extend({},ua,u||{}));L.offset=h.pan.mult(J.amount/h.pan.mag()),L.center=this._map.transform.center,Vs(L,J)}if(h.zoom){var K=Qr(h.zoom,k,hr);L.zoom=this._map.transform.zoom+K.amount,Vs(L,K)}if(h.bearing){var ne=Qr(h.bearing,k,Lc);L.bearing=this._map.transform.bearing+d.clamp(ne.amount,-179,179),Vs(L,ne)}if(h.pitch){var _e=Qr(h.pitch,k,Nl);L.pitch=this._map.transform.pitch+_e.amount,Vs(L,_e)}if(L.zoom||L.bearing){var ve=void 0===h.pinchAround?h.around:h.pinchAround;L.around=ve?this._map.unproject(ve):this._map.getCenter()}return this.clear(),d.extend(L,{noMoveStart:!0})}};var Co=function(u){function h(g,x,k,L){void 0===L&&(L={});var J=w.mousePos(x.getCanvasContainer(),k),K=x.unproject(J);u.call(this,g,d.extend({point:J,lngLat:K,originalEvent:k},L)),this._defaultPrevented=!1,this.target=x}u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h;var p={defaultPrevented:{configurable:!0}};return h.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(h.prototype,p),h}(d.Event),Ha=function(u){function h(g,x,k){var L="touchend"===g?k.changedTouches:k.touches,J=w.touchPos(x.getCanvasContainer(),L),K=J.map(function(ve){return x.unproject(ve)}),ne=J.reduce(function(ve,be,Ee,Oe){return ve.add(be.div(Oe.length))},new d.Point(0,0)),_e=x.unproject(ne);u.call(this,g,{points:J,point:ne,lngLats:K,lngLat:_e,originalEvent:k}),this._defaultPrevented=!1}u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h;var p={defaultPrevented:{configurable:!0}};return h.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(h.prototype,p),h}(d.Event),Ys=function(u){function h(g,x,k){u.call(this,g,{originalEvent:k}),this._defaultPrevented=!1}u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h;var p={defaultPrevented:{configurable:!0}};return h.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(h.prototype,p),h}(d.Event),ro=function(u,h){this._map=u,this._clickTolerance=h.clickTolerance};ro.prototype.reset=function(){delete this._mousedownPos},ro.prototype.wheel=function(u){return this._firePreventable(new Ys(u.type,this._map,u))},ro.prototype.mousedown=function(u,h){return this._mousedownPos=h,this._firePreventable(new Co(u.type,this._map,u))},ro.prototype.mouseup=function(u){this._map.fire(new Co(u.type,this._map,u))},ro.prototype.click=function(u,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new Co(u.type,this._map,u))},ro.prototype.dblclick=function(u){return this._firePreventable(new Co(u.type,this._map,u))},ro.prototype.mouseover=function(u){this._map.fire(new Co(u.type,this._map,u))},ro.prototype.mouseout=function(u){this._map.fire(new Co(u.type,this._map,u))},ro.prototype.touchstart=function(u){return this._firePreventable(new Ha(u.type,this._map,u))},ro.prototype.touchmove=function(u){this._map.fire(new Ha(u.type,this._map,u))},ro.prototype.touchend=function(u){this._map.fire(new Ha(u.type,this._map,u))},ro.prototype.touchcancel=function(u){this._map.fire(new Ha(u.type,this._map,u))},ro.prototype._firePreventable=function(u){if(this._map.fire(u),u.defaultPrevented)return{}},ro.prototype.isEnabled=function(){return!0},ro.prototype.isActive=function(){return!1},ro.prototype.enable=function(){},ro.prototype.disable=function(){};var cn=function(u){this._map=u};cn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},cn.prototype.mousemove=function(u){this._map.fire(new Co(u.type,this._map,u))},cn.prototype.mousedown=function(){this._delayContextMenu=!0},cn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Co("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},cn.prototype.contextmenu=function(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new Co(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()},cn.prototype.isEnabled=function(){return!0},cn.prototype.isActive=function(){return!1},cn.prototype.enable=function(){},cn.prototype.disable=function(){};var Zr=function(u,h){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=h.clickTolerance||1};function zc(u,h){for(var p={},g=0;g<u.length;g++)p[u[g].identifier]=h[g];return p}Zr.prototype.isEnabled=function(){return!!this._enabled},Zr.prototype.isActive=function(){return!!this._active},Zr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Zr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zr.prototype.mousedown=function(u,h){this.isEnabled()&&u.shiftKey&&0===u.button&&(w.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)},Zr.prototype.mousemoveWindow=function(u,h){if(this._active){var p=h;if(!(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)){var g=this._startPos;this._lastPos=p,this._box||(this._box=w.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));var x=Math.min(g.x,p.x),k=Math.max(g.x,p.x),L=Math.min(g.y,p.y),J=Math.max(g.y,p.y);w.setTransform(this._box,"translate("+x+"px,"+L+"px)"),this._box.style.width=k-x+"px",this._box.style.height=J-L+"px"}}},Zr.prototype.mouseupWindow=function(u,h){var p=this;if(this._active&&0===u.button){var g=this._startPos,x=h;if(this.reset(),w.suppressClick(),g.x!==x.x||g.y!==x.y)return this._map.fire(new d.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:function(k){return k.fitScreenCoordinates(g,x,p._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",u)}},Zr.prototype.keydown=function(u){this._active&&27===u.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",u))},Zr.prototype.blur=function(){this.reset()},Zr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(w.remove(this._box),this._box=null),w.enableDrag(),delete this._startPos,delete this._lastPos},Zr.prototype._fireEvent=function(u,h){return this._map.fire(new d.Event(u,{originalEvent:h}))};var cc=function(u){this.reset(),this.numTouches=u.numTouches};cc.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},cc.prototype.touchstart=function(u,h,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=u.timeStamp),p.length===this.numTouches&&(this.centroid=function(g){for(var x=new d.Point(0,0),k=0,L=g;k<L.length;k+=1)x._add(L[k]);return x.div(g.length)}(h),this.touches=zc(p,h)))},cc.prototype.touchmove=function(u,h,p){if(!this.aborted&&this.centroid){var g=zc(p,h);for(var x in this.touches){var k=g[x];(!k||k.dist(this.touches[x])>30)&&(this.aborted=!0)}}},cc.prototype.touchend=function(u,h,p){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){var g=!this.aborted&&this.centroid;if(this.reset(),g)return g}};var pa=function(u){this.singleTap=new cc(u),this.numTaps=u.numTaps,this.reset()};pa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},pa.prototype.touchstart=function(u,h,p){this.singleTap.touchstart(u,h,p)},pa.prototype.touchmove=function(u,h,p){this.singleTap.touchmove(u,h,p)},pa.prototype.touchend=function(u,h,p){var g=this.singleTap.touchend(u,h,p);if(g){var x=u.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(g)<30;if(x&&k||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}};var Kr=function(){this._zoomIn=new pa({numTouches:1,numTaps:2}),this._zoomOut=new pa({numTouches:2,numTaps:1}),this.reset()};Kr.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Kr.prototype.touchstart=function(u,h,p){this._zoomIn.touchstart(u,h,p),this._zoomOut.touchstart(u,h,p)},Kr.prototype.touchmove=function(u,h,p){this._zoomIn.touchmove(u,h,p),this._zoomOut.touchmove(u,h,p)},Kr.prototype.touchend=function(u,h,p){var g=this,x=this._zoomIn.touchend(u,h,p),k=this._zoomOut.touchend(u,h,p);return x?(this._active=!0,u.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(x)},{originalEvent:u})}}):k?(this._active=!0,u.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(L){return L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(k)},{originalEvent:u})}}):void 0},Kr.prototype.touchcancel=function(){this.reset()},Kr.prototype.enable=function(){this._enabled=!0},Kr.prototype.disable=function(){this._enabled=!1,this.reset()},Kr.prototype.isEnabled=function(){return this._enabled},Kr.prototype.isActive=function(){return this._active};var op={0:1,2:2},Ht=function(u){this.reset(),this._clickTolerance=u.clickTolerance||1};Ht.prototype.blur=function(){this.reset()},Ht.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ht.prototype._correctButton=function(u,h){return!1},Ht.prototype._move=function(u,h){return{}},Ht.prototype.mousedown=function(u,h){if(!this._lastPoint){var p=w.mouseButton(u);this._correctButton(u,p)&&(this._lastPoint=h,this._eventButton=p)}},Ht.prototype.mousemoveWindow=function(u,h){var g,k,p=this._lastPoint;if(p)if(u.preventDefault(),k=op[this._eventButton],void 0===(g=u).buttons||(g.buttons&k)!==k)this.reset();else if(this._moved||!(h.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(p,h)},Ht.prototype.mouseupWindow=function(u){this._lastPoint&&w.mouseButton(u)===this._eventButton&&(this._moved&&w.suppressClick(),this.reset())},Ht.prototype.enable=function(){this._enabled=!0},Ht.prototype.disable=function(){this._enabled=!1,this.reset()},Ht.prototype.isEnabled=function(){return this._enabled},Ht.prototype.isActive=function(){return this._active};var rp=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.mousedown=function(p,g){u.prototype.mousedown.call(this,p,g),this._lastPoint&&(this._active=!0)},h.prototype._correctButton=function(p,g){return 0===g&&!p.ctrlKey},h.prototype._move=function(p,g){return{around:g,panDelta:g.sub(p)}},h}(Ht),vu=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype._correctButton=function(p,g){return 0===g&&p.ctrlKey||2===g},h.prototype._move=function(p,g){var x=.8*(g.x-p.x);if(x)return this._active=!0,{bearingDelta:x}},h.prototype.contextmenu=function(p){p.preventDefault()},h}(Ht),bu=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype._correctButton=function(p,g){return 0===g&&p.ctrlKey||2===g},h.prototype._move=function(p,g){var x=-.5*(g.y-p.y);if(x)return this._active=!0,{pitchDelta:x}},h.prototype.contextmenu=function(p){p.preventDefault()},h}(Ht),Ea=function(u){this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset()};Ea.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new d.Point(0,0)},Ea.prototype.touchstart=function(u,h,p){return this._calculateTransform(u,h,p)},Ea.prototype.touchmove=function(u,h,p){if(this._active&&!(p.length<this._minTouches))return u.preventDefault(),this._calculateTransform(u,h,p)},Ea.prototype.touchend=function(u,h,p){this._calculateTransform(u,h,p),this._active&&p.length<this._minTouches&&this.reset()},Ea.prototype.touchcancel=function(){this.reset()},Ea.prototype._calculateTransform=function(u,h,p){p.length>0&&(this._active=!0);var g=zc(p,h),x=new d.Point(0,0),k=new d.Point(0,0),L=0;for(var J in g){var K=g[J],ne=this._touches[J];ne&&(x._add(K),k._add(K.sub(ne)),L++,g[J]=K)}if(this._touches=g,!(L<this._minTouches)&&k.mag()){var _e=k.div(L);if(this._sum._add(_e),!(this._sum.mag()<this._clickTolerance))return{around:x.div(L),panDelta:_e}}},Ea.prototype.enable=function(){this._enabled=!0},Ea.prototype.disable=function(){this._enabled=!1,this.reset()},Ea.prototype.isEnabled=function(){return this._enabled},Ea.prototype.isActive=function(){return this._active};var Aa=function(){this.reset()};function ap(u,h,p){for(var g=0;g<u.length;g++)if(u[g].identifier===p)return h[g]}function Dc(u,h){return Math.log(u/h)/Math.LN2}Aa.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Aa.prototype._start=function(u){},Aa.prototype._move=function(u,h,p){return{}},Aa.prototype.touchstart=function(u,h,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([h[0],h[1]]))},Aa.prototype.touchmove=function(u,h,p){if(this._firstTwoTouches){u.preventDefault();var g=this._firstTwoTouches,x=g[1],k=ap(p,h,g[0]),L=ap(p,h,x);if(k&&L){var J=this._aroundCenter?null:k.add(L).div(2);return this._move([k,L],J,u)}}},Aa.prototype.touchend=function(u,h,p){if(this._firstTwoTouches){var g=this._firstTwoTouches,x=g[1],k=ap(p,h,g[0]),L=ap(p,h,x);k&&L||(this._active&&w.suppressClick(),this.reset())}},Aa.prototype.touchcancel=function(){this.reset()},Aa.prototype.enable=function(u){this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around},Aa.prototype.disable=function(){this._enabled=!1,this.reset()},Aa.prototype.isEnabled=function(){return this._enabled},Aa.prototype.isActive=function(){return this._active};var da=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.reset=function(){u.prototype.reset.call(this),delete this._distance,delete this._startDistance},h.prototype._start=function(p){this._startDistance=this._distance=p[0].dist(p[1])},h.prototype._move=function(p,g){var x=this._distance;if(this._distance=p[0].dist(p[1]),this._active||!(Math.abs(Dc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dc(this._distance,x),pinchAround:g}},h}(Aa);function Os(u,h){return 180*u.angleWith(h)/Math.PI}var Rc=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.reset=function(){u.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},h.prototype._start=function(p){this._startVector=this._vector=p[0].sub(p[1]),this._minDiameter=p[0].dist(p[1])},h.prototype._move=function(p,g){var x=this._vector;if(this._vector=p[0].sub(p[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Os(this._vector,x),pinchAround:g}},h.prototype._isBelowThreshold=function(p){this._minDiameter=Math.min(this._minDiameter,p.mag());var g=25/(Math.PI*this._minDiameter)*360,x=Os(p,this._startVector);return Math.abs(x)<g},h}(Aa);function Fc(u){return Math.abs(u.y)>Math.abs(u.x)}var sp=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.reset=function(){u.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},h.prototype._start=function(p){this._lastPoints=p,Fc(p[0].sub(p[1]))&&(this._valid=!1)},h.prototype._move=function(p,g,x){var k=p[0].sub(this._lastPoints[0]),L=p[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(k,L,x.timeStamp),this._valid)return this._lastPoints=p,this._active=!0,{pitchDelta:(k.y+L.y)/2*-.5}},h.prototype.gestureBeginsVertically=function(p,g,x){if(void 0!==this._valid)return this._valid;var k=p.mag()>=2,L=g.mag()>=2;if(k||L){if(!k||!L)return void 0===this._firstMove&&(this._firstMove=x),x-this._firstMove<100&&void 0;var J=p.y>0==g.y>0;return Fc(p)&&Fc(g)&&J}},h}(Aa),xu={panStep:100,bearingStep:15,pitchStep:10},ka=function(){var u=xu;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1};function fr(u){return u*(2-u)}ka.prototype.blur=function(){this.reset()},ka.prototype.reset=function(){this._active=!1},ka.prototype.keydown=function(u){var h=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var p=0,g=0,x=0,k=0,L=0;switch(u.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:u.shiftKey?g=-1:(u.preventDefault(),k=-1);break;case 39:u.shiftKey?g=1:(u.preventDefault(),k=1);break;case 38:u.shiftKey?x=1:(u.preventDefault(),L=-1);break;case 40:u.shiftKey?x=-1:(u.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:function(J){var K=J.getZoom();J.easeTo({duration:300,easeId:"keyboardHandler",easing:fr,zoom:p?Math.round(K)+p*(u.shiftKey?2:1):K,bearing:J.getBearing()+g*h._bearingStep,pitch:J.getPitch()+x*h._pitchStep,offset:[-k*h._panStep,-L*h._panStep],center:J.getCenter()},{originalEvent:u})}}}},ka.prototype.enable=function(){this._enabled=!0},ka.prototype.disable=function(){this._enabled=!1,this.reset()},ka.prototype.isEnabled=function(){return this._enabled},ka.prototype.isActive=function(){return this._active},ka.prototype.disableRotation=function(){this._rotationDisabled=!0},ka.prototype.enableRotation=function(){this._rotationDisabled=!1};var oi=function(u,h){this._map=u,this._el=u.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,d.bindAll(["_onTimeout"],this)};oi.prototype.setZoomRate=function(u){this._defaultZoomRate=u},oi.prototype.setWheelZoomRate=function(u){this._wheelZoomRate=u},oi.prototype.isEnabled=function(){return!!this._enabled},oi.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},oi.prototype.isZooming=function(){return!!this._zooming},oi.prototype.enable=function(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=u&&"center"===u.around)},oi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},oi.prototype.wheel=function(u){if(this.isEnabled()){var h=u.deltaMode===d.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY,p=d.browser.now(),g=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==h&&h%4.000244140625==0?this._type="wheel":0!==h&&Math.abs(h)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(g*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),u.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=u,this._delta-=h,this._active||this._start(u)),u.preventDefault()}},oi.prototype._onTimeout=function(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},oi.prototype._start=function(u){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var h=w.mousePos(this._el,u);this._around=d.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(h)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},oi.prototype.renderFrame=function(){var u=this;if(this._frameId&&(this._frameId=null,this.isActive())){var h=this._map.transform;if(0!==this._delta){var p="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,g=2/(1+Math.exp(-Math.abs(this._delta*p)));this._delta<0&&0!==g&&(g=1/g);var x="number"==typeof this._targetZoom?h.zoomScale(this._targetZoom):h.scale;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(x*g))),"wheel"===this._type&&(this._startZoom=h.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var k,L="number"==typeof this._targetZoom?this._targetZoom:h.zoom,J=this._startZoom,K=this._easing,ne=!1;if("wheel"===this._type&&J&&K){var _e=Math.min((d.browser.now()-this._lastWheelEventTime)/200,1),ve=K(_e);k=d.number(J,L,ve),_e<1?this._frameId||(this._frameId=!0):ne=!0}else k=L,ne=!0;return this._active=!0,ne&&(this._active=!1,this._finishTimeout=setTimeout(function(){u._zooming=!1,u._handler._triggerRenderFrame(),delete u._targetZoom,delete u._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ne,zoomDelta:k-h.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},oi.prototype._smoothOutEasing=function(u){var h=d.ease;if(this._prevEase){var p=this._prevEase,g=(d.browser.now()-p.start)/p.duration,x=p.easing(g+.01)-p.easing(g),k=.27/Math.sqrt(x*x+1e-4)*.01,L=Math.sqrt(.0729-k*k);h=d.bezier(k,L,.25,1)}return this._prevEase={start:d.browser.now(),duration:u,easing:h},h},oi.prototype.blur=function(){this.reset()},oi.prototype.reset=function(){this._active=!1};var ha=function(u,h){this._clickZoom=u,this._tapZoom=h};ha.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ha.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ha.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ha.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ia=function(){this.reset()};Ia.prototype.reset=function(){this._active=!1},Ia.prototype.blur=function(){this.reset()},Ia.prototype.dblclick=function(u,h){return u.preventDefault(),{cameraAnimation:function(p){p.easeTo({duration:300,zoom:p.getZoom()+(u.shiftKey?-1:1),around:p.unproject(h)},{originalEvent:u})}}},Ia.prototype.enable=function(){this._enabled=!0},Ia.prototype.disable=function(){this._enabled=!1,this.reset()},Ia.prototype.isEnabled=function(){return this._enabled},Ia.prototype.isActive=function(){return this._active};var Vo=function(){this._tap=new pa({numTouches:1,numTaps:1}),this.reset()};Vo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Vo.prototype.touchstart=function(u,h,p){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=h[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(u,h,p))},Vo.prototype.touchmove=function(u,h,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;var g=h[0],x=g.y-this._swipePoint.y;return this._swipePoint=g,u.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(u,h,p)},Vo.prototype.touchend=function(u,h,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(u,h,p)&&(this._tapTime=u.timeStamp)},Vo.prototype.touchcancel=function(){this.reset()},Vo.prototype.enable=function(){this._enabled=!0},Vo.prototype.disable=function(){this._enabled=!1,this.reset()},Vo.prototype.isEnabled=function(){return this._enabled},Vo.prototype.isActive=function(){return this._active};var us=function(u,h,p){this._el=u,this._mousePan=h,this._touchPan=p};us.prototype.enable=function(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},us.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},us.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},us.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ps=function(u,h,p){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=h,this._mousePitch=p};ps.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ps.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ps.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ps.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Tr=function(u,h,p,g){this._el=u,this._touchZoom=h,this._touchRotate=p,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};Tr.prototype.enable=function(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Tr.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Tr.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Tr.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Tr.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Tr.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var ir=function(u){return u.zoom||u.drag||u.pitch||u.rotate},Hs=function(u){function h(){u.apply(this,arguments)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h}(d.Event);function Cn(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}var un=function(u,h){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ya(u),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h),d.bindAll(["handleEvent","handleWindowEvent"],this);var p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[d.window.document,"mousemove",{capture:!0}],[d.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[d.window,"blur",void 0]];for(var g=0,x=this._listeners;g<x.length;g+=1){var k=x[g],L=k[0];w.addEventListener(L,k[1],L===d.window.document?this.handleWindowEvent:this.handleEvent,k[2])}};un.prototype.destroy=function(){for(var u=0,h=this._listeners;u<h.length;u+=1){var p=h[u],g=p[0];w.removeEventListener(g,p[1],g===d.window.document?this.handleWindowEvent:this.handleEvent,p[2])}},un.prototype._addDefaultHandlers=function(u){var h=this._map,p=h.getCanvasContainer();this._add("mapEvent",new ro(h,u));var g=h.boxZoom=new Zr(h,u);this._add("boxZoom",g);var x=new Kr,k=new Ia;h.doubleClickZoom=new ha(k,x),this._add("tapZoom",x),this._add("clickZoom",k);var L=new Vo;this._add("tapDragZoom",L);var J=h.touchPitch=new sp;this._add("touchPitch",J);var K=new vu(u),ne=new bu(u);h.dragRotate=new ps(u,K,ne),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",ne,["mouseRotate"]);var _e=new rp(u),ve=new Ea(u);h.dragPan=new us(p,_e,ve),this._add("mousePan",_e),this._add("touchPan",ve,["touchZoom","touchRotate"]);var be=new Rc,Ee=new da;h.touchZoomRotate=new Tr(p,Ee,be,L),this._add("touchRotate",be,["touchPan","touchZoom"]),this._add("touchZoom",Ee,["touchPan","touchRotate"]);var Oe=h.scrollZoom=new oi(h,this);this._add("scrollZoom",Oe,["mousePan"]);var Re=h.keyboard=new ka;this._add("keyboard",Re),this._add("blockableMapEvent",new cn(h));for(var Se=0,De=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Se<De.length;Se+=1){var Be=De[Se];u.interactive&&u[Be]&&h[Be].enable(u[Be])}},un.prototype._add=function(u,h,p){this._handlers.push({handlerName:u,handler:h,allowed:p}),this._handlersById[u]=h},un.prototype.stop=function(u){if(!this._updatingCamera){for(var h=0,p=this._handlers;h<p.length;h+=1)p[h].handler.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}},un.prototype.isActive=function(){for(var u=0,h=this._handlers;u<h.length;u+=1)if(h[u].handler.isActive())return!0;return!1},un.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},un.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},un.prototype.isMoving=function(){return Boolean(ir(this._eventsInProgress))||this.isZooming()},un.prototype._blockedByActive=function(u,h,p){for(var g in u)if(g!==p&&(!h||h.indexOf(g)<0))return!0;return!1},un.prototype.handleWindowEvent=function(u){this.handleEvent(u,u.type+"Window")},un.prototype._getMapTouches=function(u){for(var h=[],p=0,g=u;p<g.length;p+=1){var x=g[p];this._el.contains(x.target)&&h.push(x)}return h},un.prototype.handleEvent=function(u,h){this._updatingCamera=!0;for(var p="renderFrame"===u.type?void 0:u,g={needsRenderFrame:!1},x={},k={},L=u.touches?this._getMapTouches(u.touches):void 0,J=L?w.touchPos(this._el,L):w.mousePos(this._el,u),K=0,ne=this._handlers;K<ne.length;K+=1){var _e=ne[K],ve=_e.handlerName,be=_e.handler,Ee=_e.allowed;if(be.isEnabled()){var Oe=void 0;this._blockedByActive(k,Ee,ve)?be.reset():be[h||u.type]&&(Oe=be[h||u.type](u,J,L),this.mergeHandlerResult(g,x,Oe,ve,p),Oe&&Oe.needsRenderFrame&&this._triggerRenderFrame()),(Oe||be.isActive())&&(k[ve]=be)}}var Re={};for(var Se in this._previousActiveHandlers)k[Se]||(Re[Se]=p);this._previousActiveHandlers=k,(Object.keys(Re).length||Cn(g))&&(this._changes.push([g,x,Re]),this._triggerRenderFrame()),(Object.keys(k).length||Cn(g))&&this._map._stop(!0),this._updatingCamera=!1;var De=g.cameraAnimation;De&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],De(this._map))},un.prototype.mergeHandlerResult=function(u,h,p,g,x){if(p){d.extend(u,p);var k={handlerName:g,originalEvent:p.originalEvent||x};void 0!==p.zoomDelta&&(h.zoom=k),void 0!==p.panDelta&&(h.drag=k),void 0!==p.pitchDelta&&(h.pitch=k),void 0!==p.bearingDelta&&(h.rotate=k)}},un.prototype._applyChanges=function(){for(var u={},h={},p={},g=0,x=this._changes;g<x.length;g+=1){var k=x[g],L=k[0],J=k[1],K=k[2];L.panDelta&&(u.panDelta=(u.panDelta||new d.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+L.pitchDelta),void 0!==L.around&&(u.around=L.around),void 0!==L.pinchAround&&(u.pinchAround=L.pinchAround),L.noInertia&&(u.noInertia=L.noInertia),d.extend(h,J),d.extend(p,K)}this._updateMapTransform(u,h,p),this._changes=[]},un.prototype._updateMapTransform=function(u,h,p){var g=this._map,x=g.transform;if(!Cn(u))return this._fireEvents(h,p,!0);var k=u.panDelta,L=u.zoomDelta,J=u.bearingDelta,K=u.pitchDelta,ne=u.around,_e=u.pinchAround;void 0!==_e&&(ne=_e),g._stop(!0),ne=ne||g.transform.centerPoint;var ve=x.pointLocation(k?ne.sub(k):ne);J&&(x.bearing+=J),K&&(x.pitch+=K),L&&(x.zoom+=L),x.setLocationAtPoint(ve,ne),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(h,p,!0)},un.prototype._fireEvents=function(u,h,p){var g=this,x=ir(this._eventsInProgress),k=ir(u),L={};for(var J in u)this._eventsInProgress[J]||(L[J+"start"]=u[J].originalEvent),this._eventsInProgress[J]=u[J];for(var K in!x&&k&&this._fireEvent("movestart",k.originalEvent),L)this._fireEvent(K,L[K]);for(var ne in k&&this._fireEvent("move",k.originalEvent),u)this._fireEvent(ne,u[ne].originalEvent);var _e,ve={};for(var be in this._eventsInProgress){var Ee=this._eventsInProgress[be],Oe=Ee.handlerName,Re=Ee.originalEvent;this._handlersById[Oe].isActive()||(delete this._eventsInProgress[be],ve[be+"end"]=_e=h[Oe]||Re)}for(var Se in ve)this._fireEvent(Se,ve[Se]);var De=ir(this._eventsInProgress);if(p&&(x||k)&&!De){this._updatingCamera=!0;var Be=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Xe=function(_t){return 0!==_t&&-g._bearingSnap<_t&&_t<g._bearingSnap};Be?(Xe(Be.bearing||this._map.getBearing())&&(Be.bearing=0),this._map.easeTo(Be,{originalEvent:_e})):(this._map.fire(new d.Event("moveend",{originalEvent:_e})),Xe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},un.prototype._fireEvent=function(u,h){this._map.fire(new d.Event(u,h?{originalEvent:h}:{}))},un.prototype._requestFrame=function(){var u=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(h){delete u._frameId,u.handleEvent(new Hs("renderFrame",{timeStamp:h})),u._applyChanges()})},un.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Cu=function(u){function h(p,g){u.call(this),this._moving=!1,this._zooming=!1,this.transform=p,this._bearingSnap=g.bearingSnap,d.bindAll(["_renderFrameCallback"],this)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.getCenter=function(){return new d.LngLat(this.transform.center.lng,this.transform.center.lat)},h.prototype.setCenter=function(p,g){return this.jumpTo({center:p},g)},h.prototype.panBy=function(p,g,x){return p=d.Point.convert(p).mult(-1),this.panTo(this.transform.center,d.extend({offset:p},g),x)},h.prototype.panTo=function(p,g,x){return this.easeTo(d.extend({center:p},g),x)},h.prototype.getZoom=function(){return this.transform.zoom},h.prototype.setZoom=function(p,g){return this.jumpTo({zoom:p},g),this},h.prototype.zoomTo=function(p,g,x){return this.easeTo(d.extend({zoom:p},g),x)},h.prototype.zoomIn=function(p,g){return this.zoomTo(this.getZoom()+1,p,g),this},h.prototype.zoomOut=function(p,g){return this.zoomTo(this.getZoom()-1,p,g),this},h.prototype.getBearing=function(){return this.transform.bearing},h.prototype.setBearing=function(p,g){return this.jumpTo({bearing:p},g),this},h.prototype.getPadding=function(){return this.transform.padding},h.prototype.setPadding=function(p,g){return this.jumpTo({padding:p},g),this},h.prototype.rotateTo=function(p,g,x){return this.easeTo(d.extend({bearing:p},g),x)},h.prototype.resetNorth=function(p,g){return this.rotateTo(0,d.extend({duration:1e3},p),g),this},h.prototype.resetNorthPitch=function(p,g){return this.easeTo(d.extend({bearing:0,pitch:0,duration:1e3},p),g),this},h.prototype.snapToNorth=function(p,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(p,g):this},h.prototype.getPitch=function(){return this.transform.pitch},h.prototype.setPitch=function(p,g){return this.jumpTo({pitch:p},g),this},h.prototype.cameraForBounds=function(p,g){p=d.LngLatBounds.convert(p);var x=g&&g.bearing||0;return this._cameraForBoxAndBearing(p.getNorthWest(),p.getSouthEast(),x,g)},h.prototype._cameraForBoxAndBearing=function(p,g,x,k){var L={top:0,bottom:0,right:0,left:0};if("number"==typeof(k=d.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},k)).padding){var J=k.padding;k.padding={top:J,bottom:J,right:J,left:J}}k.padding=d.extend(L,k.padding);var K=this.transform,ne=K.padding,_e=K.project(d.LngLat.convert(p)),ve=K.project(d.LngLat.convert(g)),be=_e.rotate(-x*Math.PI/180),Ee=ve.rotate(-x*Math.PI/180),Oe=new d.Point(Math.max(be.x,Ee.x),Math.max(be.y,Ee.y)),Re=new d.Point(Math.min(be.x,Ee.x),Math.min(be.y,Ee.y)),Se=Oe.sub(Re),De=(K.width-(ne.left+ne.right+k.padding.left+k.padding.right))/Se.x,Be=(K.height-(ne.top+ne.bottom+k.padding.top+k.padding.bottom))/Se.y;if(!(Be<0||De<0)){var Xe=Math.min(K.scaleZoom(K.scale*Math.min(De,Be)),k.maxZoom),_t="number"==typeof k.offset.x?new d.Point(k.offset.x,k.offset.y):d.Point.convert(k.offset),ct=new d.Point((k.padding.left-k.padding.right)/2,(k.padding.top-k.padding.bottom)/2).rotate(x*Math.PI/180),yt=_t.add(ct).mult(K.scale/K.zoomScale(Xe));return{center:K.unproject(_e.add(ve).div(2).sub(yt)),zoom:Xe,bearing:x}}d.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},h.prototype.fitBounds=function(p,g,x){return this._fitInternal(this.cameraForBounds(p,g),g,x)},h.prototype.fitScreenCoordinates=function(p,g,x,k,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.Point.convert(p)),this.transform.pointLocation(d.Point.convert(g)),x,k),k,L)},h.prototype._fitInternal=function(p,g,x){return p?(delete(g=d.extend(p,g)).padding,g.linear?this.easeTo(g,x):this.flyTo(g,x)):this},h.prototype.jumpTo=function(p,g){this.stop();var x=this.transform,k=!1,L=!1,J=!1;return"zoom"in p&&x.zoom!==+p.zoom&&(k=!0,x.zoom=+p.zoom),void 0!==p.center&&(x.center=d.LngLat.convert(p.center)),"bearing"in p&&x.bearing!==+p.bearing&&(L=!0,x.bearing=+p.bearing),"pitch"in p&&x.pitch!==+p.pitch&&(J=!0,x.pitch=+p.pitch),null==p.padding||x.isPaddingEqual(p.padding)||(x.padding=p.padding),this.fire(new d.Event("movestart",g)).fire(new d.Event("move",g)),k&&this.fire(new d.Event("zoomstart",g)).fire(new d.Event("zoom",g)).fire(new d.Event("zoomend",g)),L&&this.fire(new d.Event("rotatestart",g)).fire(new d.Event("rotate",g)).fire(new d.Event("rotateend",g)),J&&this.fire(new d.Event("pitchstart",g)).fire(new d.Event("pitch",g)).fire(new d.Event("pitchend",g)),this.fire(new d.Event("moveend",g))},h.prototype.easeTo=function(p,g){var x=this;this._stop(!1,p.easeId),(!1===(p=d.extend({offset:[0,0],duration:500,easing:d.ease},p)).animate||!p.essential&&d.browser.prefersReducedMotion)&&(p.duration=0);var k=this.transform,L=this.getZoom(),J=this.getBearing(),K=this.getPitch(),ne=this.getPadding(),_e="zoom"in p?+p.zoom:L,ve="bearing"in p?this._normalizeBearing(p.bearing,J):J,be="pitch"in p?+p.pitch:K,Ee="padding"in p?p.padding:k.padding,Oe=d.Point.convert(p.offset),Re=k.centerPoint.add(Oe),Se=k.pointLocation(Re),De=d.LngLat.convert(p.center||Se);this._normalizeCenter(De);var Be,Xe,_t=k.project(Se),ct=k.project(De).sub(_t),yt=k.zoomScale(_e-L);p.around&&(Be=d.LngLat.convert(p.around),Xe=k.locationPoint(Be));var St={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||_e!==L,this._rotating=this._rotating||J!==ve,this._pitching=this._pitching||be!==K,this._padding=!k.isPaddingEqual(Ee),this._easeId=p.easeId,this._prepareEase(g,p.noMoveStart,St),this._ease(function(Ut){if(x._zooming&&(k.zoom=d.number(L,_e,Ut)),x._rotating&&(k.bearing=d.number(J,ve,Ut)),x._pitching&&(k.pitch=d.number(K,be,Ut)),x._padding&&(k.interpolatePadding(ne,Ee,Ut),Re=k.centerPoint.add(Oe)),Be)k.setLocationAtPoint(Be,Xe);else{var Rt=k.zoomScale(k.zoom-L),Kt=_e>L?Math.min(2,yt):Math.max(.5,yt),wn=Math.pow(Kt,1-Ut),Mn=k.unproject(_t.add(ct.mult(Ut*wn)).mult(Rt));k.setLocationAtPoint(k.renderWorldCopies?Mn.wrap():Mn,Re)}x._fireMoveEvents(g)},function(Ut){x._afterEase(g,Ut)},p),this},h.prototype._prepareEase=function(p,g,x){void 0===x&&(x={}),this._moving=!0,g||x.moving||this.fire(new d.Event("movestart",p)),this._zooming&&!x.zooming&&this.fire(new d.Event("zoomstart",p)),this._rotating&&!x.rotating&&this.fire(new d.Event("rotatestart",p)),this._pitching&&!x.pitching&&this.fire(new d.Event("pitchstart",p))},h.prototype._fireMoveEvents=function(p){this.fire(new d.Event("move",p)),this._zooming&&this.fire(new d.Event("zoom",p)),this._rotating&&this.fire(new d.Event("rotate",p)),this._pitching&&this.fire(new d.Event("pitch",p))},h.prototype._afterEase=function(p,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;var x=this._zooming,k=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new d.Event("zoomend",p)),k&&this.fire(new d.Event("rotateend",p)),L&&this.fire(new d.Event("pitchend",p)),this.fire(new d.Event("moveend",p))}},h.prototype.flyTo=function(p,g){var x=this;if(!p.essential&&d.browser.prefersReducedMotion){var k=d.pick(p,["center","zoom","bearing","pitch","around"]);return this.jumpTo(k,g)}this.stop(),p=d.extend({offset:[0,0],speed:1.2,curve:1.42,easing:d.ease},p);var L=this.transform,J=this.getZoom(),K=this.getBearing(),ne=this.getPitch(),_e=this.getPadding(),ve="zoom"in p?d.clamp(+p.zoom,L.minZoom,L.maxZoom):J,be="bearing"in p?this._normalizeBearing(p.bearing,K):K,Ee="pitch"in p?+p.pitch:ne,Oe="padding"in p?p.padding:L.padding,Re=L.zoomScale(ve-J),Se=d.Point.convert(p.offset),De=L.centerPoint.add(Se),Be=L.pointLocation(De),Xe=d.LngLat.convert(p.center||Be);this._normalizeCenter(Xe);var _t=L.project(Be),ct=L.project(Xe).sub(_t),yt=p.curve,St=Math.max(L.width,L.height),Ut=St/Re,Rt=ct.mag();if("minZoom"in p){var Kt=d.clamp(Math.min(p.minZoom,J,ve),L.minZoom,L.maxZoom),wn=St/L.zoomScale(Kt-J);yt=Math.sqrt(wn/Rt*2)}var Mn=yt*yt;function En(qn){var bn=(Ut*Ut-St*St+(qn?-1:1)*Mn*Mn*Rt*Rt)/(2*(qn?Ut:St)*Mn*Rt);return Math.log(Math.sqrt(bn*bn+1)-bn)}function _i(qn){return(Math.exp(qn)-Math.exp(-qn))/2}function Gt(qn){return(Math.exp(qn)+Math.exp(-qn))/2}var jn=En(0),ti=function(qn){return Gt(jn)/Gt(jn+yt*qn)},Fn=function(qn){return St*((Gt(jn)*(_i(bn=jn+yt*qn)/Gt(bn))-_i(jn))/Mn)/Rt;var bn},Un=(En(1)-jn)/yt;if(Math.abs(Rt)<1e-6||!isFinite(Un)){if(Math.abs(St-Ut)<1e-6)return this.easeTo(p,g);var Xn=Ut<St?-1:1;Un=Math.abs(Math.log(Ut/St))/yt,Fn=function(){return 0},ti=function(qn){return Math.exp(Xn*yt*qn)}}return p.duration="duration"in p?+p.duration:1e3*Un/("screenSpeed"in p?+p.screenSpeed/yt:+p.speed),p.maxDuration&&p.duration>p.maxDuration&&(p.duration=0),this._zooming=!0,this._rotating=K!==be,this._pitching=Ee!==ne,this._padding=!L.isPaddingEqual(Oe),this._prepareEase(g,!1),this._ease(function(qn){var bn=qn*Un,Do=1/ti(bn);L.zoom=1===qn?ve:J+L.scaleZoom(Do),x._rotating&&(L.bearing=d.number(K,be,qn)),x._pitching&&(L.pitch=d.number(ne,Ee,qn)),x._padding&&(L.interpolatePadding(_e,Oe,qn),De=L.centerPoint.add(Se));var yo=1===qn?Xe:L.unproject(_t.add(ct.mult(Fn(bn))).mult(Do));L.setLocationAtPoint(L.renderWorldCopies?yo.wrap():yo,De),x._fireMoveEvents(g)},function(){return x._afterEase(g)},p),this},h.prototype.isEasing=function(){return!!this._easeFrameId},h.prototype.stop=function(){return this._stop()},h.prototype._stop=function(p,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,g)}if(!p){var k=this.handlers;k&&k.stop(!1)}return this},h.prototype._ease=function(p,g,x){!1===x.animate||0===x.duration?(p(1),g()):(this._easeStart=d.browser.now(),this._easeOptions=x,this._onEaseFrame=p,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},h.prototype._renderFrameCallback=function(){var p=Math.min((d.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},h.prototype._normalizeBearing=function(p,g){p=d.wrap(p,-180,180);var x=Math.abs(p-g);return Math.abs(p-360-g)<x&&(p-=360),Math.abs(p+360-g)<x&&(p+=360),p},h.prototype._normalizeCenter=function(p){var g=this.transform;if(g.renderWorldCopies&&!g.lngRange){var x=p.lng-g.center.lng;p.lng+=x>180?-360:x<-180?360:0}},h}(d.Evented),Xo=function(u){void 0===u&&(u={}),this.options=u,d.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Xo.prototype.getDefaultPosition=function(){return"bottom-right"},Xo.prototype.onAdd=function(u){var h=this.options&&this.options.compact;return this._map=u,this._container=w.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=w.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===h&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Xo.prototype.onRemove=function(){w.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Xo.prototype._setElementTitle=function(u,h){var p=this._map._getUIString("AttributionControl."+h);u.title=p,u.setAttribute("aria-label",p)},Xo.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Xo.prototype._updateEditLink=function(){var u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));var h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||d.config.ACCESS_TOKEN}];if(u){var p=h.reduce(function(g,x,k){return x.value&&(g+=x.key+"="+x.value+(k<h.length-1?"&":"")),g},"?");u.href=d.config.FEEDBACK_URL+"/"+p+(this._map._hash?this._map._hash.getHashString(!0):""),u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}},Xo.prototype._updateData=function(u){!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType||(this._updateAttributions(),this._updateEditLink())},Xo.prototype._updateAttributions=function(){if(this._map.style){var u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map(function(J){return"string"!=typeof J?"":J})):"string"==typeof this.options.customAttribution&&u.push(this.options.customAttribution)),this._map.style.stylesheet){var h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}var p=this._map.style.sourceCaches;for(var g in p){var x=p[g];if(x.used){var k=x.getSource();k.attribution&&u.indexOf(k.attribution)<0&&u.push(k.attribution)}}u.sort(function(J,K){return J.length-K.length});var L=(u=u.filter(function(J,K){for(var ne=K+1;ne<u.length;ne++)if(u[ne].indexOf(J)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,u.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Xo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var fa=function(){d.bindAll(["_updateLogo"],this),d.bindAll(["_updateCompact"],this)};fa.prototype.onAdd=function(u){this._map=u,this._container=w.create("div","mapboxgl-ctrl");var h=w.create("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},fa.prototype.onRemove=function(){w.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},fa.prototype.getDefaultPosition=function(){return"bottom-left"},fa.prototype._updateLogo=function(u){u&&"metadata"!==u.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},fa.prototype._logoRequired=function(){if(this._map.style){var u=this._map.style.sourceCaches;for(var h in u)if(u[h].getSource().mapbox_logo)return!0;return!1}},fa.prototype._updateCompact=function(){var u=this._container.children;if(u.length){var h=u[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}};var or=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};or.prototype.add=function(u){var h=++this._id;return this._queue.push({callback:u,id:h,cancelled:!1}),h},or.prototype.remove=function(u){for(var h=this._currentlyRunning,p=0,g=h?this._queue.concat(h):this._queue;p<g.length;p+=1){var x=g[p];if(x.id===u)return void(x.cancelled=!0)}},or.prototype.run=function(u){void 0===u&&(u=0);var h=this._currentlyRunning=this._queue;this._queue=[];for(var p=0,g=h;p<g.length;p+=1){var x=g[p];if(!x.cancelled&&(x.callback(u),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},or.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ds={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},lp=d.window.HTMLImageElement,wu=d.window.HTMLElement,ki=d.window.ImageBitmap,Yo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Jp=function(u){function h(g){var x=this;if(null!=(g=d.extend({},Yo,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var k=new Wn(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies);if(u.call(this,k,g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new or,this._controls=[],this._mapId=d.uniqueId(),this._locale=d.extend({},ds,g.locale),this._clickTolerance=g.clickTolerance,this._requestManager=new d.RequestManager(g.transformRequest,g.accessToken),"string"==typeof g.container){if(this._container=d.window.document.getElementById(g.container),!this._container)throw new Error("Container '"+g.container+"' not found.")}else{if(!(g.container instanceof wu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),d.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return x._update(!1)}),this.on("moveend",function(){return x._update(!1)}),this.on("zoom",function(){return x._update(!0)}),void 0!==d.window&&(d.window.addEventListener("online",this._onWindowOnline,!1),d.window.addEventListener("resize",this._onWindowResize,!1),d.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new un(this,g),this._hash=g.hash&&new Wo("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,d.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new Xo({customAttribution:g.customAttribution})),this.addControl(new fa,g.logoPosition),this.on("style.load",function(){x.transform.unmodified&&x.jumpTo(x.style.stylesheet)}),this.on("data",function(L){x._update("style"===L.dataType),x.fire(new d.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){x.fire(new d.Event(L.dataType+"dataloading",L))})}u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h;var p={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return h.prototype._getMapId=function(){return this._mapId},h.prototype.addControl=function(g,x){if(void 0===x&&(x=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new d.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var k=g.onAdd(this);this._controls.push(g);var L=this._controlPositions[x];return-1!==x.indexOf("bottom")?L.insertBefore(k,L.firstChild):L.appendChild(k),this},h.prototype.removeControl=function(g){if(!g||!g.onRemove)return this.fire(new d.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var x=this._controls.indexOf(g);return x>-1&&this._controls.splice(x,1),g.onRemove(this),this},h.prototype.hasControl=function(g){return this._controls.indexOf(g)>-1},h.prototype.resize=function(g){var x=this._containerDimensions(),k=x[0],L=x[1];if(k===this.transform.width&&L===this.transform.height)return this;this._resizeCanvas(k,L),this.transform.resize(k,L),this.painter.resize(k,L);var J=!this._moving;return J&&this.fire(new d.Event("movestart",g)).fire(new d.Event("move",g)),this.fire(new d.Event("resize",g)),J&&this.fire(new d.Event("moveend",g)),this},h.prototype.getBounds=function(){return this.transform.getBounds()},h.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},h.prototype.setMaxBounds=function(g){return this.transform.setMaxBounds(d.LngLatBounds.convert(g)),this._update()},h.prototype.setMinZoom=function(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},h.prototype.getMinZoom=function(){return this.transform.minZoom},h.prototype.setMaxZoom=function(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")},h.prototype.getMaxZoom=function(){return this.transform.maxZoom},h.prototype.setMinPitch=function(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},h.prototype.getMinPitch=function(){return this.transform.minPitch},h.prototype.setMaxPitch=function(g){if((g=g??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")},h.prototype.getMaxPitch=function(){return this.transform.maxPitch},h.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},h.prototype.setRenderWorldCopies=function(g){return this.transform.renderWorldCopies=g,this._update()},h.prototype.project=function(g){return this.transform.locationPoint(d.LngLat.convert(g))},h.prototype.unproject=function(g){return this.transform.pointLocation(d.Point.convert(g))},h.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},h.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},h.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},h.prototype._createDelegatedListener=function(g,x,k){var L,J=this;if("mouseenter"===g||"mouseover"===g){var K=!1;return{layer:x,listener:k,delegates:{mousemove:function(_e){var ve=J.getLayer(x)?J.queryRenderedFeatures(_e.point,{layers:[x]}):[];ve.length?K||(K=!0,k.call(J,new Co(g,J,_e.originalEvent,{features:ve}))):K=!1},mouseout:function(){K=!1}}}}if("mouseleave"===g||"mouseout"===g){var ne=!1;return{layer:x,listener:k,delegates:{mousemove:function(_e){(J.getLayer(x)?J.queryRenderedFeatures(_e.point,{layers:[x]}):[]).length?ne=!0:ne&&(ne=!1,k.call(J,new Co(g,J,_e.originalEvent)))},mouseout:function(_e){ne&&(ne=!1,k.call(J,new Co(g,J,_e.originalEvent)))}}}}return{layer:x,listener:k,delegates:(L={},L[g]=function(_e){var ve=J.getLayer(x)?J.queryRenderedFeatures(_e.point,{layers:[x]}):[];ve.length&&(_e.features=ve,k.call(J,_e),delete _e.features)},L)}},h.prototype.on=function(g,x,k){if(void 0===k)return u.prototype.on.call(this,g,x);var L=this._createDelegatedListener(g,x,k);for(var J in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(L),L.delegates)this.on(J,L.delegates[J]);return this},h.prototype.once=function(g,x,k){if(void 0===k)return u.prototype.once.call(this,g,x);var L=this._createDelegatedListener(g,x,k);for(var J in L.delegates)this.once(J,L.delegates[J]);return this},h.prototype.off=function(g,x,k){var L=this;return void 0===k?u.prototype.off.call(this,g,x):(this._delegatedListeners&&this._delegatedListeners[g]&&function(J){for(var K=J[g],ne=0;ne<K.length;ne++){var _e=K[ne];if(_e.layer===x&&_e.listener===k){for(var ve in _e.delegates)L.off(ve,_e.delegates[ve]);return K.splice(ne,1),L}}}(this._delegatedListeners),this)},h.prototype.queryRenderedFeatures=function(g,x){if(!this.style)return[];var k;if(void 0!==x||void 0===g||g instanceof d.Point||Array.isArray(g)||(x=g,g=void 0),x=x||{},(g=g||[[0,0],[this.transform.width,this.transform.height]])instanceof d.Point||"number"==typeof g[0])k=[d.Point.convert(g)];else{var L=d.Point.convert(g[0]),J=d.Point.convert(g[1]);k=[L,new d.Point(J.x,L.y),J,new d.Point(L.x,J.y),L]}return this.style.queryRenderedFeatures(k,x,this.transform)},h.prototype.querySourceFeatures=function(g,x){return this.style.querySourceFeatures(g,x)},h.prototype.setStyle=function(g,x){return!1!==(x=d.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},x)).diff&&x.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,x),this):(this._localIdeographFontFamily=x.localIdeographFontFamily,this._updateStyle(g,x))},h.prototype._getUIString=function(g){var x=this._locale[g];if(null==x)throw new Error("Missing UI string '"+g+"'");return x},h.prototype._updateStyle=function(g,x){return this.style&&(this.style.setEventedParent(null),this.style._remove()),g?(this.style=new Hi(this,x||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g),this):(delete this.style,this)},h.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Hi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},h.prototype._diffStyle=function(g,x){var k=this;if("string"==typeof g){var L=this._requestManager.normalizeStyleURL(g),J=this._requestManager.transformRequest(L,d.ResourceType.Style);d.getJSON(J,function(K,ne){K?k.fire(new d.ErrorEvent(K)):ne&&k._updateDiff(ne,x)})}else"object"==typeof g&&this._updateDiff(g,x)},h.prototype._updateDiff=function(g,x){try{this.style.setState(g)&&this._update(!0)}catch(k){d.warnOnce("Unable to perform style diff: "+(k.message||k.error||k)+".  Rebuilding the style from scratch."),this._updateStyle(g,x)}},h.prototype.getStyle=function(){if(this.style)return this.style.serialize()},h.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():d.warnOnce("There is no style added to the map.")},h.prototype.addSource=function(g,x){return this._lazyInitEmptyStyle(),this.style.addSource(g,x),this._update(!0)},h.prototype.isSourceLoaded=function(g){var x=this.style&&this.style.sourceCaches[g];if(void 0!==x)return x.loaded();this.fire(new d.ErrorEvent(new Error("There is no source with ID '"+g+"'")))},h.prototype.areTilesLoaded=function(){var g=this.style&&this.style.sourceCaches;for(var x in g){var k=g[x]._tiles;for(var L in k){var J=k[L];if("loaded"!==J.state&&"errored"!==J.state)return!1}}return!0},h.prototype.addSourceType=function(g,x,k){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,x,k)},h.prototype.removeSource=function(g){return this.style.removeSource(g),this._update(!0)},h.prototype.getSource=function(g){return this.style.getSource(g)},h.prototype.addImage=function(g,x,k){void 0===k&&(k={});var L=k.pixelRatio;void 0===L&&(L=1);var J=k.sdf;void 0===J&&(J=!1);var K=k.stretchX,ne=k.stretchY,_e=k.content;if(this._lazyInitEmptyStyle(),x instanceof lp||ki&&x instanceof ki){var ve=d.browser.getImageData(x);this.style.addImage(g,{data:new d.RGBAImage({width:ve.width,height:ve.height},ve.data),pixelRatio:L,stretchX:K,stretchY:ne,content:_e,sdf:J,version:0})}else{if(void 0===x.width||void 0===x.height)return this.fire(new d.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var be=x;this.style.addImage(g,{data:new d.RGBAImage({width:x.width,height:x.height},new Uint8Array(x.data)),pixelRatio:L,stretchX:K,stretchY:ne,content:_e,sdf:J,version:0,userImage:be}),be.onAdd&&be.onAdd(this,g)}},h.prototype.updateImage=function(g,x){var k=this.style.getImage(g);if(!k)return this.fire(new d.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=x instanceof lp||ki&&x instanceof ki?d.browser.getImageData(x):x,J=L.width,K=L.height,ne=L.data;return void 0===J||void 0===K?this.fire(new d.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):J!==k.data.width||K!==k.data.height?this.fire(new d.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(k.data.replace(ne,!(x instanceof lp||ki&&x instanceof ki)),void this.style.updateImage(g,k))},h.prototype.hasImage=function(g){return g?!!this.style.getImage(g):(this.fire(new d.ErrorEvent(new Error("Missing required image id"))),!1)},h.prototype.removeImage=function(g){this.style.removeImage(g)},h.prototype.loadImage=function(g,x){d.getImage(this._requestManager.transformRequest(g,d.ResourceType.Image),x)},h.prototype.listImages=function(){return this.style.listImages()},h.prototype.addLayer=function(g,x){return this._lazyInitEmptyStyle(),this.style.addLayer(g,x),this._update(!0)},h.prototype.moveLayer=function(g,x){return this.style.moveLayer(g,x),this._update(!0)},h.prototype.removeLayer=function(g){return this.style.removeLayer(g),this._update(!0)},h.prototype.getLayer=function(g){return this.style.getLayer(g)},h.prototype.setLayerZoomRange=function(g,x,k){return this.style.setLayerZoomRange(g,x,k),this._update(!0)},h.prototype.setFilter=function(g,x,k){return void 0===k&&(k={}),this.style.setFilter(g,x,k),this._update(!0)},h.prototype.getFilter=function(g){return this.style.getFilter(g)},h.prototype.setPaintProperty=function(g,x,k,L){return void 0===L&&(L={}),this.style.setPaintProperty(g,x,k,L),this._update(!0)},h.prototype.getPaintProperty=function(g,x){return this.style.getPaintProperty(g,x)},h.prototype.setLayoutProperty=function(g,x,k,L){return void 0===L&&(L={}),this.style.setLayoutProperty(g,x,k,L),this._update(!0)},h.prototype.getLayoutProperty=function(g,x){return this.style.getLayoutProperty(g,x)},h.prototype.setLight=function(g,x){return void 0===x&&(x={}),this._lazyInitEmptyStyle(),this.style.setLight(g,x),this._update(!0)},h.prototype.getLight=function(){return this.style.getLight()},h.prototype.setFeatureState=function(g,x){return this.style.setFeatureState(g,x),this._update()},h.prototype.removeFeatureState=function(g,x){return this.style.removeFeatureState(g,x),this._update()},h.prototype.getFeatureState=function(g){return this.style.getFeatureState(g)},h.prototype.getContainer=function(){return this._container},h.prototype.getCanvasContainer=function(){return this._canvasContainer},h.prototype.getCanvas=function(){return this._canvas},h.prototype._containerDimensions=function(){var g=0,x=0;return this._container&&(g=this._container.clientWidth||400,x=this._container.clientHeight||300),[g,x]},h.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==d.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&d.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},h.prototype._setupContainer=function(){var g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=w.create("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();var x=this._canvasContainer=w.create("div","mapboxgl-canvas-container",g);this._interactive&&x.classList.add("mapboxgl-interactive"),this._canvas=w.create("canvas","mapboxgl-canvas",x),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var k=this._containerDimensions();this._resizeCanvas(k[0],k[1]);var L=this._controlContainer=w.create("div","mapboxgl-control-container",g),J=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(K){J[K]=w.create("div","mapboxgl-ctrl-"+K,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},h.prototype._resizeCanvas=function(g,x){var k=d.browser.devicePixelRatio||1;this._canvas.width=k*g,this._canvas.height=k*x,this._canvas.style.width=g+"px",this._canvas.style.height=x+"px"},h.prototype._setupPainter=function(){var g=d.extend({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),x=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);x?(this.painter=new ji(x,this.transform),d.webpSupported.testSupport(x)):this.fire(new d.ErrorEvent(new Error("Failed to initialize WebGL")))},h.prototype._contextLost=function(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new d.Event("webglcontextlost",{originalEvent:g}))},h.prototype._contextRestored=function(g){this._setupPainter(),this.resize(),this._update(),this.fire(new d.Event("webglcontextrestored",{originalEvent:g}))},h.prototype._onMapScroll=function(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},h.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},h.prototype._update=function(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this},h.prototype._requestRenderFrame=function(g){return this._update(),this._renderTaskQueue.add(g)},h.prototype._cancelRenderFrame=function(g){this._renderTaskQueue.remove(g)},h.prototype._render=function(g){var x,k=this,L=0,J=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(x=J.createQueryEXT(),J.beginQueryEXT(J.TIME_ELAPSED_EXT,x),L=d.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),!this._removed){var K=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ne=this.transform.zoom,_e=d.browser.now();this.style.zoomHistory.update(ne,_e);var ve=new d.EvaluationParameters(ne,{now:_e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),be=ve.crossFadingFactor();1===be&&be===this._crossFadingFactor||(K=!0,this._crossFadingFactor=be),this.style.update(ve)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new d.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new d.Event("load"))),this.style&&(this.style.hasTransitions()||K)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ee=d.browser.now()-L;J.endQueryEXT(J.TIME_ELAPSED_EXT,x),setTimeout(function(){var Se=J.getQueryObjectEXT(x,J.QUERY_RESULT_EXT)/1e6;J.deleteQueryEXT(x),k.fire(new d.Event("gpu-timing-frame",{cpuTime:Ee,gpuTime:Se}))},50)}if(this.listens("gpu-timing-layer")){var Oe=this.painter.collectGpuTimers();setTimeout(function(){var Se=k.painter.queryGpuTimers(Oe);k.fire(new d.Event("gpu-timing-layer",{layerTimes:Se}))},50)}var Re=this._sourcesDirty||this._styleDirty||this._placementDirty;return Re||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.Event("idle")),!this._loaded||this._fullyLoaded||Re||(this._fullyLoaded=!0),this}},h.prototype.remove=function(){this._hash&&this._hash.remove();for(var g=0,x=this._controls;g<x.length;g+=1)x[g].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==d.window&&(d.window.removeEventListener("resize",this._onWindowResize,!1),d.window.removeEventListener("orientationchange",this._onWindowResize,!1),d.window.removeEventListener("online",this._onWindowOnline,!1));var k=this.painter.context.gl.getExtension("WEBGL_lose_context");k&&k.loseContext(),Ll(this._canvasContainer),Ll(this._controlContainer),Ll(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new d.Event("remove"))},h.prototype.triggerRepaint=function(){var g=this;this.style&&!this._frame&&(this._frame=d.browser.frame(function(x){g._frame=null,g._render(x)}))},h.prototype._onWindowOnline=function(){this._update()},h.prototype._onWindowResize=function(g){this._trackResize&&this.resize({originalEvent:g})._update()},p.showTileBoundaries.get=function(){return!!this._showTileBoundaries},p.showTileBoundaries.set=function(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())},p.showPadding.get=function(){return!!this._showPadding},p.showPadding.set=function(g){this._showPadding!==g&&(this._showPadding=g,this._update())},p.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},p.showCollisionBoxes.set=function(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())},p.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},p.showOverdrawInspector.set=function(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())},p.repaint.get=function(){return!!this._repaint},p.repaint.set=function(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())},p.vertices.get=function(){return!!this._vertices},p.vertices.set=function(g){this._vertices=g,this._update()},h.prototype._setCacheLimits=function(g,x){d.setCacheLimits(g,x)},p.version.get=function(){return d.version},Object.defineProperties(h.prototype,p),h}(Cu);function Ll(u){u.parentNode&&u.parentNode.removeChild(u)}var Tu={showCompass:!0,showZoom:!0,visualizePitch:!1},Ss=function(u){var h=this;this.options=d.extend({},Tu,u),this._container=w.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(p){return p.preventDefault()}),this.options.showZoom&&(d.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(p){return h._map.zoomIn({},{originalEvent:p})}),w.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(p){return h._map.zoomOut({},{originalEvent:p})}),w.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(d.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(p){h.options.visualizePitch?h._map.resetNorthPitch({},{originalEvent:p}):h._map.resetNorth({},{originalEvent:p})}),this._compassIcon=w.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ss.prototype._updateZoomButtons=function(){var u=this._map.getZoom(),h=u===this._map.getMaxZoom(),p=u===this._map.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},Ss.prototype._rotateCompassArrow=function(){var u=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=u},Ss.prototype.onAdd=function(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nr(this._map,this._compass,this.options.visualizePitch)),this._container},Ss.prototype.onRemove=function(){w.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ss.prototype._createButton=function(u,h){var p=w.create("button",u,this._container);return p.type="button",p.addEventListener("click",h),p},Ss.prototype._setButtonTitle=function(u,h){var p=this._map._getUIString("NavigationControl."+h);u.title=p,u.setAttribute("aria-label",p)};var Nr=function(u,h,p){void 0===p&&(p=!1),this._clickTolerance=10,this.element=h,this.mouseRotate=new vu({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,p&&(this.mousePitch=new bu({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),d.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),w.addEventListener(h,"mousedown",this.mousedown),w.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),w.addEventListener(h,"touchmove",this.touchmove),w.addEventListener(h,"touchend",this.touchend),w.addEventListener(h,"touchcancel",this.reset)};function Qs(u,h,p){if(u=new d.LngLat(u.lng,u.lat),h){var g=new d.LngLat(u.lng-360,u.lat),x=new d.LngLat(u.lng+360,u.lat),k=p.locationPoint(u).distSqr(h);p.locationPoint(g).distSqr(h)<k?u=g:p.locationPoint(x).distSqr(h)<k&&(u=x)}for(;Math.abs(u.lng-p.center.lng)>180;){var L=p.locationPoint(u);if(L.x>=0&&L.y>=0&&L.x<=p.width&&L.y<=p.height)break;u.lng>p.center.lng?u.lng-=360:u.lng+=360}return u}Nr.prototype.down=function(u,h){this.mouseRotate.mousedown(u,h),this.mousePitch&&this.mousePitch.mousedown(u,h),w.disableDrag()},Nr.prototype.move=function(u,h){var p=this.map,g=this.mouseRotate.mousemoveWindow(u,h);if(g&&g.bearingDelta&&p.setBearing(p.getBearing()+g.bearingDelta),this.mousePitch){var x=this.mousePitch.mousemoveWindow(u,h);x&&x.pitchDelta&&p.setPitch(p.getPitch()+x.pitchDelta)}},Nr.prototype.off=function(){var u=this.element;w.removeEventListener(u,"mousedown",this.mousedown),w.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),w.removeEventListener(u,"touchmove",this.touchmove),w.removeEventListener(u,"touchend",this.touchend),w.removeEventListener(u,"touchcancel",this.reset),this.offTemp()},Nr.prototype.offTemp=function(){w.enableDrag(),w.removeEventListener(d.window,"mousemove",this.mousemove),w.removeEventListener(d.window,"mouseup",this.mouseup)},Nr.prototype.mousedown=function(u){this.down(d.extend({},u,{ctrlKey:!0,preventDefault:function(){return u.preventDefault()}}),w.mousePos(this.element,u)),w.addEventListener(d.window,"mousemove",this.mousemove),w.addEventListener(d.window,"mouseup",this.mouseup)},Nr.prototype.mousemove=function(u){this.move(u,w.mousePos(this.element,u))},Nr.prototype.mouseup=function(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()},Nr.prototype.touchstart=function(u){1!==u.targetTouches.length?this.reset():(this._startPos=this._lastPos=w.touchPos(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return u.preventDefault()}},this._startPos))},Nr.prototype.touchmove=function(u){1!==u.targetTouches.length?this.reset():(this._lastPos=w.touchPos(this.element,u.targetTouches)[0],this.move({preventDefault:function(){return u.preventDefault()}},this._lastPos))},Nr.prototype.touchend=function(u){0===u.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Nr.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var hs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function uc(u,h,p){var g=u.classList;for(var x in hs)g.remove("mapboxgl-"+p+"-anchor-"+x);g.add("mapboxgl-"+p+"-anchor-"+h)}var Ks,hl=function(u){function h(p,g){if(u.call(this),(p instanceof d.window.HTMLElement||g)&&(p=d.extend({element:p},g)),d.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=p&&p.anchor||"center",this._color=p&&p.color||"#3FB1CE",this._scale=p&&p.scale||1,this._draggable=p&&p.draggable||!1,this._clickTolerance=p&&p.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=p&&p.rotation||0,this._rotationAlignment=p&&p.rotationAlignment||"auto",this._pitchAlignment=p&&p.pitchAlignment&&"auto"!==p.pitchAlignment?p.pitchAlignment:this._rotationAlignment,p&&p.element)this._element=p.element,this._offset=d.Point.convert(p&&p.offset||[0,0]);else{this._defaultMarker=!0,this._element=w.create("div"),this._element.setAttribute("aria-label","Map marker");var x=w.createNS("http://www.w3.org/2000/svg","svg");x.setAttributeNS(null,"display","block"),x.setAttributeNS(null,"height","41px"),x.setAttributeNS(null,"width","27px"),x.setAttributeNS(null,"viewBox","0 0 27 41");var k=w.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"stroke","none"),k.setAttributeNS(null,"stroke-width","1"),k.setAttributeNS(null,"fill","none"),k.setAttributeNS(null,"fill-rule","evenodd");var L=w.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var J=w.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(3.0, 29.0)"),J.setAttributeNS(null,"fill","#000000");for(var K=0,ne=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];K<ne.length;K+=1){var _e=ne[K],ve=w.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",_e.rx),ve.setAttributeNS(null,"ry",_e.ry),J.appendChild(ve)}var be=w.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"fill",this._color);var Ee=w.createNS("http://www.w3.org/2000/svg","path");Ee.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),be.appendChild(Ee);var Oe=w.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"opacity","0.25"),Oe.setAttributeNS(null,"fill","#000000");var Re=w.createNS("http://www.w3.org/2000/svg","path");Re.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Oe.appendChild(Re);var Se=w.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Se.setAttributeNS(null,"fill","#FFFFFF");var De=w.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Be=w.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#000000"),Be.setAttributeNS(null,"opacity","0.25"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962");var Xe=w.createNS("http://www.w3.org/2000/svg","circle");Xe.setAttributeNS(null,"fill","#FFFFFF"),Xe.setAttributeNS(null,"cx","5.5"),Xe.setAttributeNS(null,"cy","5.5"),Xe.setAttributeNS(null,"r","5.4999962"),De.appendChild(Be),De.appendChild(Xe),L.appendChild(J),L.appendChild(be),L.appendChild(Oe),L.appendChild(Se),L.appendChild(De),x.appendChild(L),x.setAttributeNS(null,"height",41*this._scale+"px"),x.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(x),this._offset=d.Point.convert(p&&p.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(_t){_t.preventDefault()}),this._element.addEventListener("mousedown",function(_t){_t.preventDefault()}),uc(this._element,this._anchor,"marker"),this._popup=null}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.addTo=function(p){return this.remove(),this._map=p,p.getCanvasContainer().appendChild(this._element),p.on("move",this._update),p.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},h.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),w.remove(this._element),this._popup&&this._popup.remove(),this},h.prototype.getLngLat=function(){return this._lngLat},h.prototype.setLngLat=function(p){return this._lngLat=d.LngLat.convert(p),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},h.prototype.getElement=function(){return this._element},h.prototype.setPopup=function(p){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),p){if(!("offset"in p.options)){var g=Math.sqrt(Math.pow(13.5,2)/2);p.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=p,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},h.prototype._onKeyPress=function(p){var g=p.code,x=p.charCode||p.keyCode;"Space"!==g&&"Enter"!==g&&32!==x&&13!==x||this.togglePopup()},h.prototype._onMapClick=function(p){var g=p.originalEvent.target,x=this._element;this._popup&&(g===x||x.contains(g))&&this.togglePopup()},h.prototype.getPopup=function(){return this._popup},h.prototype.togglePopup=function(){var p=this._popup;return p?(p.isOpen()?p.remove():p.addTo(this._map),this):this},h.prototype._update=function(p){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Qs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var g="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?g="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(g="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var x="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?x="rotateX(0deg)":"map"===this._pitchAlignment&&(x="rotateX("+this._map.getPitch()+"deg)"),p&&"moveend"!==p.type||(this._pos=this._pos.round()),w.setTransform(this._element,hs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+x+" "+g)}},h.prototype.getOffset=function(){return this._offset},h.prototype.setOffset=function(p){return this._offset=d.Point.convert(p),this._update(),this},h.prototype._onMove=function(p){if(!this._isDragging){var g=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new d.Event("dragstart"))),this.fire(new d.Event("drag")))},h.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new d.Event("dragend")),this._state="inactive"},h.prototype._addDragHandler=function(p){this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},h.prototype.setDraggable=function(p){return this._draggable=!!p,this._map&&(p?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},h.prototype.isDraggable=function(){return this._draggable},h.prototype.setRotation=function(p){return this._rotation=p||0,this._update(),this},h.prototype.getRotation=function(){return this._rotation},h.prototype.setRotationAlignment=function(p){return this._rotationAlignment=p||"auto",this._update(),this},h.prototype.getRotationAlignment=function(){return this._rotationAlignment},h.prototype.setPitchAlignment=function(p){return this._pitchAlignment=p&&"auto"!==p?p:this._rotationAlignment,this._update(),this},h.prototype.getPitchAlignment=function(){return this._pitchAlignment},h}(d.Evented),Uc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},$r=0,Mr=!1,cp=function(u){function h(p){u.call(this),this.options=d.extend({},Uc,p),d.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.onAdd=function(p){var g;return this._map=p,this._container=w.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),g=this._setupUI,void 0!==Ks?g(Ks):void 0!==d.window.navigator.permissions?d.window.navigator.permissions.query({name:"geolocation"}).then(function(x){g(Ks="denied"!==x.state)}):g(Ks=!!d.window.navigator.geolocation),this._container},h.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(d.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),w.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,$r=0,Mr=!1},h.prototype._isOutOfMapMaxBounds=function(p){var g=this._map.getMaxBounds(),x=p.coords;return g&&(x.longitude<g.getWest()||x.longitude>g.getEast()||x.latitude<g.getSouth()||x.latitude>g.getNorth())},h.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},h.prototype._onSuccess=function(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new d.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(p),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new d.Event("geolocate",p)),this._finish()}},h.prototype._updateCamera=function(p){var g=new d.LngLat(p.coords.longitude,p.coords.latitude),x=p.coords.accuracy,k=this._map.getBearing(),L=d.extend({bearing:k},this.options.fitBoundsOptions);this._map.fitBounds(g.toBounds(x),L,{geolocateSource:!0})},h.prototype._updateMarker=function(p){if(p){var g=new d.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},h.prototype._updateCircleRadius=function(){var p=this._map._container.clientHeight/2,g=this._map.unproject([0,p]),x=this._map.unproject([1,p]),k=g.distanceTo(x),L=Math.ceil(2*this._accuracy/k);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},h.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},h.prototype._onError=function(p){if(this._map){if(this.options.trackUserLocation)if(1===p.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===p.code&&Mr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new d.Event("error",p)),this._finish()}},h.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},h.prototype._setupUI=function(p){var g=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=w.create("button","mapboxgl-ctrl-geolocate",this._container),w.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===p){d.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var x=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x)}else{var k=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new hl(this._dotElement),this._circleElement=w.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||"ACTIVE_LOCK"!==g._watchState||L.originalEvent&&"resize"===L.originalEvent.type||(g._watchState="BACKGROUND",g._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),g._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),g.fire(new d.Event("trackuserlocationend")))})},h.prototype.trigger=function(){if(!this._setup)return d.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$r--,Mr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new d.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++$r>1?(p={maximumAge:6e5,timeout:0},Mr=!0):(p=this.options.positionOptions,Mr=!1),this._geolocationWatchID=d.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else d.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},h.prototype._clearWatch=function(){d.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},h}(d.Evented),fl={maxWidth:100,unit:"metric"},gl=function(u){this.options=d.extend({},fl,u),d.bindAll(["_onMove","setUnit"],this)};function Qa(u,h,p){var g=p&&p.maxWidth||100,x=u._container.clientHeight/2,k=u.unproject([0,x]),L=u.unproject([g,x]),J=k.distanceTo(L);if(p&&"imperial"===p.unit){var K=3.2808*J;K>5280?$s(h,g,K/5280,u._getUIString("ScaleControl.Miles")):$s(h,g,K,u._getUIString("ScaleControl.Feet"))}else p&&"nautical"===p.unit?$s(h,g,J/1852,u._getUIString("ScaleControl.NauticalMiles")):J>=1e3?$s(h,g,J/1e3,u._getUIString("ScaleControl.Kilometers")):$s(h,g,J,u._getUIString("ScaleControl.Meters"))}function $s(u,h,p,g){var x,k,L,K,ne,J=(x=p,(k=Math.pow(10,(""+Math.floor(x)).length-1))*(L=(L=x/k)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:(K=L,ne=Math.pow(10,Math.ceil(-Math.log(K)/Math.LN10)),Math.round(K*ne)/ne)));u.style.width=h*(J/p)+"px",u.innerHTML=J+"&nbsp;"+g}gl.prototype.getDefaultPosition=function(){return"bottom-left"},gl.prototype._onMove=function(){Qa(this._map,this._container,this.options)},gl.prototype.onAdd=function(u){return this._map=u,this._container=w.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},gl.prototype.onRemove=function(){w.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},gl.prototype.setUnit=function(u){this.options.unit=u,Qa(this._map,this._container,this.options)};var ga=function(u){this._fullscreen=!1,u&&u.container&&(u.container instanceof d.window.HTMLElement?this._container=u.container:d.warnOnce("Full screen control 'container' must be a DOM element.")),d.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in d.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in d.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in d.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in d.window.document&&(this._fullscreenchange="MSFullscreenChange")};ga.prototype.onAdd=function(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=w.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",d.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},ga.prototype.onRemove=function(){w.remove(this._controlContainer),this._map=null,d.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},ga.prototype._checkFullscreenSupport=function(){return!!(d.window.document.fullscreenEnabled||d.window.document.mozFullScreenEnabled||d.window.document.msFullscreenEnabled||d.window.document.webkitFullscreenEnabled)},ga.prototype._setupUI=function(){var u=this._fullscreenButton=w.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);w.create("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden",!0),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),d.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},ga.prototype._updateTitle=function(){var u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.title=u},ga.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},ga.prototype._isFullscreen=function(){return this._fullscreen},ga.prototype._changeIcon=function(){(d.window.document.fullscreenElement||d.window.document.mozFullScreenElement||d.window.document.webkitFullscreenElement||d.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},ga.prototype._onClickFullscreen=function(){this._isFullscreen()?d.window.document.exitFullscreen?d.window.document.exitFullscreen():d.window.document.mozCancelFullScreen?d.window.document.mozCancelFullScreen():d.window.document.msExitFullscreen?d.window.document.msExitFullscreen():d.window.document.webkitCancelFullScreen&&d.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Mu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},_l=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),up=function(u){function h(p){u.call(this),this.options=d.extend(Object.create(Mu),p),d.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return u&&(h.__proto__=u),(h.prototype=Object.create(u&&u.prototype)).constructor=h,h.prototype.addTo=function(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new d.Event("open")),this},h.prototype.isOpen=function(){return!!this._map},h.prototype.remove=function(){return this._content&&w.remove(this._content),this._container&&(w.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new d.Event("close")),this},h.prototype.getLngLat=function(){return this._lngLat},h.prototype.setLngLat=function(p){return this._lngLat=d.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},h.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},h.prototype.getElement=function(){return this._container},h.prototype.setText=function(p){return this.setDOMContent(d.window.document.createTextNode(p))},h.prototype.setHTML=function(p){var g,x=d.window.document.createDocumentFragment(),k=d.window.document.createElement("body");for(k.innerHTML=p;g=k.firstChild;)x.appendChild(g);return this.setDOMContent(x)},h.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},h.prototype.setMaxWidth=function(p){return this.options.maxWidth=p,this._update(),this},h.prototype.setDOMContent=function(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=w.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this},h.prototype.addClassName=function(p){this._container&&this._container.classList.add(p)},h.prototype.removeClassName=function(p){this._container&&this._container.classList.remove(p)},h.prototype.setOffset=function(p){return this.options.offset=p,this._update(),this},h.prototype.toggleClassName=function(p){if(this._container)return this._container.classList.toggle(p)},h.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=w.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},h.prototype._onMouseUp=function(p){this._update(p.point)},h.prototype._onMouseMove=function(p){this._update(p.point)},h.prototype._onDrag=function(p){this._update(p.point)},h.prototype._update=function(p){var g=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=w.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=w.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ve){return g._container.classList.add(ve)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||p)){var x=this._pos=this._trackPointer&&p?p:this._map.project(this._lngLat),k=this.options.anchor,L=function ve(be){if(be){if("number"==typeof be){var Ee=Math.round(Math.sqrt(.5*Math.pow(be,2)));return{center:new d.Point(0,0),top:new d.Point(0,be),"top-left":new d.Point(Ee,Ee),"top-right":new d.Point(-Ee,Ee),bottom:new d.Point(0,-be),"bottom-left":new d.Point(Ee,-Ee),"bottom-right":new d.Point(-Ee,-Ee),left:new d.Point(be,0),right:new d.Point(-be,0)}}if(be instanceof d.Point||Array.isArray(be)){var Oe=d.Point.convert(be);return{center:Oe,top:Oe,"top-left":Oe,"top-right":Oe,bottom:Oe,"bottom-left":Oe,"bottom-right":Oe,left:Oe,right:Oe}}return{center:d.Point.convert(be.center||[0,0]),top:d.Point.convert(be.top||[0,0]),"top-left":d.Point.convert(be["top-left"]||[0,0]),"top-right":d.Point.convert(be["top-right"]||[0,0]),bottom:d.Point.convert(be.bottom||[0,0]),"bottom-left":d.Point.convert(be["bottom-left"]||[0,0]),"bottom-right":d.Point.convert(be["bottom-right"]||[0,0]),left:d.Point.convert(be.left||[0,0]),right:d.Point.convert(be.right||[0,0])}}return ve(new d.Point(0,0))}(this.options.offset);if(!k){var J,K=this._container.offsetWidth,ne=this._container.offsetHeight;J=x.y+L.bottom.y<ne?["top"]:x.y>this._map.transform.height-ne?["bottom"]:[],x.x<K/2?J.push("left"):x.x>this._map.transform.width-K/2&&J.push("right"),k=0===J.length?"bottom":J.join("-")}var _e=x.add(L[k]).round();w.setTransform(this._container,hs[k]+" translate("+_e.x+"px,"+_e.y+"px)"),uc(this._container,k,"popup")}},h.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var p=this._container.querySelector(_l);p&&p.focus()}},h.prototype._onClose=function(){this.remove()},h}(d.Evented),Ou={version:d.version,supported:T,setRTLTextPlugin:d.setRTLTextPlugin,getRTLTextPluginStatus:d.getRTLTextPluginStatus,Map:Jp,NavigationControl:Ss,GeolocateControl:cp,AttributionControl:Xo,ScaleControl:gl,FullscreenControl:ga,Popup:up,Marker:hl,Style:Hi,LngLat:d.LngLat,LngLatBounds:d.LngLatBounds,Point:d.Point,MercatorCoordinate:d.MercatorCoordinate,Evented:d.Evented,config:d.config,prewarm:function(){ft().acquire(ht)},clearPrewarmedResources:function(){var u=sn;u&&(u.isPreloaded()&&1===u.numActive()?(u.release(ht),sn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return d.config.ACCESS_TOKEN},set accessToken(u){d.config.ACCESS_TOKEN=u},get baseApiUrl(){return d.config.API_URL},set baseApiUrl(u){d.config.API_URL=u},get workerCount(){return At.workerCount},set workerCount(u){At.workerCount=u},get maxParallelImageRequests(){return d.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){d.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage:function(u){d.clearTileCache(u)},workerUrl:""};return Ou}),M}()},71175:q=>{"use strict";var H=function(v){return v!=v};q.exports=function(M,D){return 0===M&&0===D?1/M==1/D:!!(M===D||H(M)&&H(D))}},12e3:(q,H,v)=>{"use strict";var M=v(32358),D=v(55685),d=v(71175),T=v(76305),w=v(53859),y=D(T(),Object);M(y,{getPolyfill:T,implementation:d,shim:w}),q.exports=y},76305:(q,H,v)=>{"use strict";var M=v(71175);q.exports=function(){return"function"==typeof Object.is?Object.is:M}},53859:(q,H,v)=>{"use strict";var M=v(76305),D=v(32358);q.exports=function(){var T=M();return D(Object,{is:T},{is:function(){return Object.is!==T}}),T}},62450:(q,H,v)=>{"use strict";var M;if(!Object.keys){var D=Object.prototype.hasOwnProperty,d=Object.prototype.toString,T=v(49978),w=Object.prototype.propertyIsEnumerable,y=!w.call({toString:null},"toString"),S=w.call(function(){},"prototype"),P=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],E=function(U){var Q=U.constructor;return Q&&Q.prototype===U},Z={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},A=function(){if(typeof window>"u")return!1;for(var U in window)try{if(!Z["$"+U]&&D.call(window,U)&&null!==window[U]&&"object"==typeof window[U])try{E(window[U])}catch{return!0}}catch{return!0}return!1}();M=function(Q){var W=null!==Q&&"object"==typeof Q,le="[object Function]"===d.call(Q),e=T(Q),de=W&&"[object String]"===d.call(Q),he=[];if(!W&&!le&&!e)throw new TypeError("Object.keys called on a non-object");var ke=S&&le;if(de&&Q.length>0&&!D.call(Q,0))for(var Le=0;Le<Q.length;++Le)he.push(String(Le));if(e&&Q.length>0)for(var Ue=0;Ue<Q.length;++Ue)he.push(String(Ue));else for(var Ie in Q)(!ke||"prototype"!==Ie)&&D.call(Q,Ie)&&he.push(String(Ie));if(y)for(var je=function(U){if(typeof window>"u"||!A)return E(U);try{return E(U)}catch{return!1}}(Q),X=0;X<P.length;++X)(!je||"constructor"!==P[X])&&D.call(Q,P[X])&&he.push(P[X]);return he}}q.exports=M},71356:(q,H,v)=>{"use strict";var M=Array.prototype.slice,D=v(49978),d=Object.keys,T=d?function(S){return d(S)}:v(62450),w=Object.keys;T.shim=function(){if(Object.keys){var S=function(){var P=Object.keys(arguments);return P&&P.length===arguments.length}(1,2);S||(Object.keys=function(E){return D(E)?w(M.call(E)):w(E)})}else Object.keys=T;return Object.keys||T},q.exports=T},49978:q=>{"use strict";var H=Object.prototype.toString;q.exports=function(M){var D=H.call(M),d="[object Arguments]"===D;return d||(d="[object Array]"!==D&&null!==M&&"object"==typeof M&&"number"==typeof M.length&&M.length>=0&&"[object Function]"===H.call(M.callee)),d}},54468:(q,H,v)=>{"use strict";var M=v(9582).functionsHaveConfigurableNames(),D=Object,d=TypeError;q.exports=function(){if(null!=this&&this!==D(this))throw new d("RegExp.prototype.flags getter called on non-object");var w="";return this.hasIndices&&(w+="d"),this.global&&(w+="g"),this.ignoreCase&&(w+="i"),this.multiline&&(w+="m"),this.dotAll&&(w+="s"),this.unicode&&(w+="u"),this.sticky&&(w+="y"),w},M&&Object.defineProperty&&Object.defineProperty(q.exports,"name",{value:"get flags"})},69235:(q,H,v)=>{"use strict";var M=v(32358),D=v(55685),d=v(54468),T=v(76343),w=v(71956),y=D(T());M(y,{getPolyfill:T,implementation:d,shim:w}),q.exports=y},76343:(q,H,v)=>{"use strict";var M=v(54468),D=v(32358).supportsDescriptors,d=Object.getOwnPropertyDescriptor;q.exports=function(){if(D&&"gim"===/a/gim.flags){var w=d(RegExp.prototype,"flags");if(w&&"function"==typeof w.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var y="",S={};if(Object.defineProperty(S,"hasIndices",{get:function(){y+="d"}}),Object.defineProperty(S,"sticky",{get:function(){y+="y"}}),"dy"===y)return w.get}}return M}},71956:(q,H,v)=>{"use strict";var M=v(32358).supportsDescriptors,D=v(76343),d=Object.getOwnPropertyDescriptor,T=Object.defineProperty,w=TypeError,y=Object.getPrototypeOf,S=/a/;q.exports=function(){if(!M||!y)throw new w("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var E=D(),Z=y(S),A=d(Z,"flags");return(!A||A.get!==E)&&T(Z,"flags",{configurable:!0,enumerable:!1,get:E}),E}},67824:(q,H,v)=>{"use strict";function M(D){for(var d in D)H.hasOwnProperty(d)||(H[d]=D[d])}Object.defineProperty(H,"__esModule",{value:!0}),M(v(95085)),M(v(26243)),M(v(91786)),M(v(30225)),M(v(76767)),M(v(30345)),M(v(15675)),M(v(86461)),M(v(58802)),M(v(33900)),M(v(88866)),M(v(94655)),M(v(4068)),M(v(33858)),M(v(98237)),M(v(83292))},95085:function(q,H,v){"use strict";var w,M=this&&this.__extends||(w=function(y,S){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,E){P.__proto__=E}||function(P,E){for(var Z in E)E.hasOwnProperty(Z)&&(P[Z]=E[Z])})(y,S)},function(y,S){function P(){this.constructor=y}w(y,S),y.prototype=null===S?Object.create(S):(P.prototype=S.prototype,new P)});Object.defineProperty(H,"__esModule",{value:!0});var D=v(15675),d=function(w){function y(S){var P=w.call(this)||this,Z=S;return Z.trigger&&(P.trigger=Z.trigger),Z.kick&&(P.kick=Z.kick),Z.drag&&(P.drag=Z.drag),Z.on&&(P.on=Z.on),P.dragstart=P.dragStart=D.Layout.dragStart,P.dragend=P.dragEnd=D.Layout.dragEnd,P}return M(y,w),y.prototype.trigger=function(S){},y.prototype.kick=function(){},y.prototype.drag=function(){},y.prototype.on=function(S,P){return this},y}(D.Layout);H.LayoutAdaptor=d,H.adaptor=function T(w){return new d(w)}},83292:(q,H,v)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var M=v(15675),D=v(76767);H.gridify=function d(y,S,P,E){y.cola.start(0,0,0,10,!1);var Z=function T(y,S,P,E){y.forEach(function(A){A.routerNode={name:A.name,bounds:A.bounds.inflate(-P)}}),S.forEach(function(A){A.routerNode={bounds:A.bounds.inflate(-E),children:(typeof A.groups<"u"?A.groups.map(function(I){return y.length+I.id}):[]).concat(typeof A.leaves<"u"?A.leaves.map(function(I){return I.index}):[])}});var Z=y.concat(S).map(function(A,I){return A.routerNode.id=I,A.routerNode});return new D.GridRouter(Z,{getChildren:function(A){return A.children},getBounds:function(A){return A.bounds}},P-E)}(y.cola.nodes(),y.cola.groups(),P,E);return Z.routeEdges(y.powerGraph.powerEdges,S,function(A){return A.source.routerNode.id},function(A){return A.target.routerNode.id})},H.powerGraphGridLayout=function w(y,S,P){var E;y.nodes.forEach(function(U,Q){return U.index=Q}),(new M.Layout).avoidOverlaps(!1).nodes(y.nodes).links(y.links).powerGraphGroups(function(U){(E=U).groups.forEach(function(Q){return Q.padding=P})});var Z=y.nodes.length,A=[],I=y.nodes.slice(0);return I.forEach(function(U,Q){return U.index=Q}),E.groups.forEach(function(U){var Q=U.index=U.id+Z;I.push(U),typeof U.leaves<"u"&&U.leaves.forEach(function(W){return A.push({source:Q,target:W.index})}),typeof U.groups<"u"&&U.groups.forEach(function(W){return A.push({source:Q,target:W.id+Z})})}),E.powerEdges.forEach(function(U){A.push({source:U.source.index,target:U.target.index})}),(new M.Layout).size(S).nodes(I).links(A).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new M.Layout).convergenceThreshold(.001).size(S).avoidOverlaps(!0).nodes(y.nodes).links(y.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups(function(U){(E=U).groups.forEach(function(Q){Q.padding=P})}).start(50,0,100,0,!1),powerGraph:E}}},26243:(q,H,v)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var M=v(49346),D=v(22487);H.d3adaptor=function d(w){return!w||function T(w){return w.version&&null!==w.version.match(/^3\./)}(w)?new M.D3StyleLayoutAdaptor:new D.D3StyleLayoutAdaptor(w)}},49346:function(q,H,v){"use strict";var w,M=this&&this.__extends||(w=function(y,S){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,E){P.__proto__=E}||function(P,E){for(var Z in E)E.hasOwnProperty(Z)&&(P[Z]=E[Z])})(y,S)},function(y,S){function P(){this.constructor=y}w(y,S),y.prototype=null===S?Object.create(S):(P.prototype=S.prototype,new P)});Object.defineProperty(H,"__esModule",{value:!0});var D=v(15675),d=function(w){function y(){var S=w.call(this)||this;S.event=d3.dispatch(D.EventType[D.EventType.start],D.EventType[D.EventType.tick],D.EventType[D.EventType.end]);var P=S;return S.drag=function(){if(!Z)var Z=d3.behavior.drag().origin(D.Layout.dragOrigin).on("dragstart.d3adaptor",D.Layout.dragStart).on("drag.d3adaptor",function(A){D.Layout.drag(A,d3.event),P.resume()}).on("dragend.d3adaptor",D.Layout.dragEnd);if(!arguments.length)return Z;this.call(Z)},S}return M(y,w),y.prototype.trigger=function(S){var P={type:D.EventType[S.type],alpha:S.alpha,stress:S.stress};this.event[P.type](P)},y.prototype.kick=function(){var S=this;d3.timer(function(){return w.prototype.tick.call(S)})},y.prototype.on=function(S,P){return this.event.on("string"==typeof S?S:D.EventType[S],P),this},y}(D.Layout);H.D3StyleLayoutAdaptor=d,H.d3adaptor=function T(){return new d}},22487:function(q,H,v){"use strict";var T,M=this&&this.__extends||(T=function(w,y){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,P){S.__proto__=P}||function(S,P){for(var E in P)P.hasOwnProperty(E)&&(S[E]=P[E])})(w,y)},function(w,y){function S(){this.constructor=w}T(w,y),w.prototype=null===y?Object.create(y):(S.prototype=y.prototype,new S)});Object.defineProperty(H,"__esModule",{value:!0});var D=v(15675),d=function(T){function w(y){var S=T.call(this)||this;S.d3Context=y,S.event=y.dispatch(D.EventType[D.EventType.start],D.EventType[D.EventType.tick],D.EventType[D.EventType.end]);var P=S;return S.drag=function(){if(!Z)var Z=y.drag().subject(D.Layout.dragOrigin).on("start.d3adaptor",D.Layout.dragStart).on("drag.d3adaptor",function(A){D.Layout.drag(A,y.event),P.resume()}).on("end.d3adaptor",D.Layout.dragEnd);if(!arguments.length)return Z;arguments[0].call(Z)},S}return M(w,T),w.prototype.trigger=function(y){var S={type:D.EventType[y.type],alpha:y.alpha,stress:y.stress};this.event.call(S.type,S)},w.prototype.kick=function(){var y=this,S=this.d3Context.timer(function(){return T.prototype.tick.call(y)&&S.stop()})},w.prototype.on=function(y,S){return this.event.on("string"==typeof y?y:D.EventType[y],S),this},w}(D.Layout);H.D3StyleLayoutAdaptor=d},91786:(q,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var v=function(){function d(){this.locks={}}return d.prototype.add=function(T,w){this.locks[T]=w},d.prototype.clear=function(){this.locks={}},d.prototype.isEmpty=function(){for(var T in this.locks)return!1;return!0},d.prototype.apply=function(T){for(var w in this.locks)T(Number(w),this.locks[w])},d}();H.Locks=v;var M=function(){function d(T,w,y){void 0===y&&(y=null),this.D=w,this.G=y,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new D,this.project=null,this.x=T,this.k=T.length;var S=this.n=T[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new v,this.minD=Number.MAX_VALUE;for(var E,P=S;P--;)for(E=S;--E>P;){var Z=w[P][E];Z>0&&Z<this.minD&&(this.minD=Z)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),P=this.k;P--;){for(this.g[P]=new Array(S),this.H[P]=new Array(S),E=S;E--;)this.H[P][E]=new Array(S);this.Hd[P]=new Array(S),this.a[P]=new Array(S),this.b[P]=new Array(S),this.c[P]=new Array(S),this.d[P]=new Array(S),this.e[P]=new Array(S),this.ia[P]=new Array(S),this.ib[P]=new Array(S),this.xtmp[P]=new Array(S)}}return d.createSquareMatrix=function(T,w){for(var y=new Array(T),S=0;S<T;++S){y[S]=new Array(T);for(var P=0;P<T;++P)y[S][P]=w(S,P)}return y},d.prototype.offsetDir=function(){for(var T=this,w=new Array(this.k),y=0,S=0;S<this.k;++S){var P=w[S]=this.random.getNextBetween(.01,1)-.5;y+=P*P}return y=Math.sqrt(y),w.map(function(E){return E*(T.minD/y)})},d.prototype.computeDerivatives=function(T){var w=this,y=this.n;if(!(y<1)){for(var S,P=new Array(this.k),E=new Array(this.k),Z=new Array(this.k),A=0,I=0;I<y;++I){for(S=0;S<this.k;++S)Z[S]=this.g[S][I]=0;for(var U=0;U<y;++U)if(I!==U){for(var Q=y;Q--;){var W=0;for(S=0;S<this.k;++S){var le=P[S]=T[S][I]-T[S][U];W+=E[S]=le*le}if(W>1e-9)break;var e=this.offsetDir();for(S=0;S<this.k;++S)T[S][U]+=e[S]}var de=Math.sqrt(W),he=this.D[I][U],ke=null!=this.G?this.G[I][U]:1;if(ke>1&&de>he||!isFinite(he)){for(S=0;S<this.k;++S)this.H[S][I][U]=0;continue}ke>1&&(ke=1);var Le=he*he,Ue=2*ke*(de-he)/(Le*de),Ie=de*de*de,je=2*-ke/(Le*Ie);for(isFinite(Ue)||console.log(Ue),S=0;S<this.k;++S)this.g[S][I]+=P[S]*Ue,Z[S]-=this.H[S][I][U]=je*(Ie+he*(E[S]-W)+de*W)}for(S=0;S<this.k;++S)A=Math.max(A,this.H[S][I][I]=Z[S])}var X=this.snapGridSize/2,ie=this.snapGridSize,ae=this.snapStrength/(X*X),pe=this.numGridSnapNodes;for(I=0;I<pe;++I)for(S=0;S<this.k;++S){var xe=this.x[S][I],Ne=xe/ie,we=Ne%1,me=Ne-we;-X<(le=Math.abs(we)<=.5?xe-me*ie:xe>0?xe-(me+1)*ie:xe-(me-1)*ie)&&le<=X&&(this.scaleSnapByMaxH?(this.g[S][I]+=A*ae*le,this.H[S][I][I]+=A*ae):(this.g[S][I]+=ae*le,this.H[S][I][I]+=ae))}this.locks.isEmpty()||this.locks.apply(function(mt,Et){for(S=0;S<w.k;++S)w.H[S][mt][mt]+=A,w.g[S][mt]-=A*(Et[S]-T[S][mt])})}},d.dotProd=function(T,w){for(var y=0,S=T.length;S--;)y+=T[S]*w[S];return y},d.rightMultiply=function(T,w,y){for(var S=T.length;S--;)y[S]=d.dotProd(T[S],w)},d.prototype.computeStepSize=function(T){for(var w=0,y=0,S=0;S<this.k;++S)w+=d.dotProd(this.g[S],T[S]),d.rightMultiply(this.H[S],T[S],this.Hd[S]),y+=d.dotProd(T[S],this.Hd[S]);return 0!==y&&isFinite(y)?1*w/y:0},d.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var T=this.computeStepSize(this.g),w=0;w<this.k;++w)this.takeDescentStep(this.x[w],this.g[w],T);return this.computeStress()},d.copy=function(T,w){for(var y=T.length,S=w[0].length,P=0;P<y;++P)for(var E=0;E<S;++E)w[P][E]=T[P][E]},d.prototype.stepAndProject=function(T,w,y,S){d.copy(T,w),this.takeDescentStep(w[0],y[0],S),this.project&&this.project[0](T[0],T[1],w[0]),this.takeDescentStep(w[1],y[1],S),this.project&&this.project[1](w[0],T[1],w[1]);for(var P=2;P<this.k;P++)this.takeDescentStep(w[P],y[P],S)},d.mApply=function(T,w,y){for(var S=T;S-- >0;)for(var P=w;P-- >0;)y(S,P)},d.prototype.matrixApply=function(T){d.mApply(this.k,this.n,T)},d.prototype.computeNextPosition=function(T,w){var y=this;this.computeDerivatives(T);var S=this.computeStepSize(this.g);if(this.stepAndProject(T,w,this.g,S),this.project){this.matrixApply(function(E,Z){return y.e[E][Z]=T[E][Z]-w[E][Z]});var P=this.computeStepSize(this.e);P=Math.max(.2,Math.min(P,1)),this.stepAndProject(T,w,this.e,P)}},d.prototype.run=function(T){for(var w=Number.MAX_VALUE,y=!1;!y&&T-- >0;){var S=this.rungeKutta();y=Math.abs(w/S-1)<this.threshold,w=S}return w},d.prototype.rungeKutta=function(){var T=this;this.computeNextPosition(this.x,this.a),d.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),d.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var w=0;return this.matrixApply(function(y,S){var P=(T.a[y][S]+2*T.b[y][S]+2*T.c[y][S]+T.d[y][S])/6,E=T.x[y][S]-P;w+=E*E,T.x[y][S]=P}),w},d.mid=function(T,w,y){d.mApply(T.length,T[0].length,function(S,P){return y[S][P]=T[S][P]+(w[S][P]-T[S][P])/2})},d.prototype.takeDescentStep=function(T,w,y){for(var S=0;S<this.n;++S)T[S]=T[S]-y*w[S]},d.prototype.computeStress=function(){for(var T=0,w=0,y=this.n-1;w<y;++w)for(var S=w+1,P=this.n;S<P;++S){for(var E=0,Z=0;Z<this.k;++Z){var A=this.x[Z][w]-this.x[Z][S];E+=A*A}E=Math.sqrt(E);var I=this.D[w][S];if(isFinite(I)){var U=I-E;T+=U*U/(I*I)}}return T},d.zeroDistance=1e-10,d}();H.Descent=M;var D=function(){function d(T){void 0===T&&(T=1),this.seed=T,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return d.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},d.prototype.getNextBetween=function(T,w){return T+this.getNext()*(w-T)},d}();H.PseudoRandom=D},30225:function(q,H,v){"use strict";var we,M=this&&this.__extends||(we=function(me,Ye){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(mt,Et){mt.__proto__=Et}||function(mt,Et){for(var Tt in Et)Et.hasOwnProperty(Tt)&&(mt[Tt]=Et[Tt])})(me,Ye)},function(me,Ye){function mt(){this.constructor=me}we(me,Ye),me.prototype=null===Ye?Object.create(Ye):(mt.prototype=Ye.prototype,new mt)});Object.defineProperty(H,"__esModule",{value:!0});var D=v(4068),d=function we(){};H.Point=d;var T=function we(me,Ye,mt,Et){this.x1=me,this.y1=Ye,this.x2=mt,this.y2=Et};H.LineSegment=T;var w=function(we){function me(){return null!==we&&we.apply(this,arguments)||this}return M(me,we),me}(d);function y(we,me,Ye){return(me.x-we.x)*(Ye.y-we.y)-(Ye.x-we.x)*(me.y-we.y)}function S(we,me,Ye){return y(we,me,Ye)>0}function P(we,me,Ye){return y(we,me,Ye)<0}function U(we,me){var Ye=me.slice(0);return Ye.push(me[0]),{rtan:Q(we,Ye),ltan:W(we,Ye)}}function Q(we,me){var mt,Et,Tt,Xt,Ye=me.length-1;if(P(we,me[1],me[0])&&!S(we,me[Ye-1],me[0]))return 0;for(mt=0,Et=Ye;;){if(Et-mt==1)return S(we,me[mt],me[Et])?mt:Et;if((Xt=P(we,me[(Tt=Math.floor((mt+Et)/2))+1],me[Tt]))&&!S(we,me[Tt-1],me[Tt]))return Tt;S(we,me[mt+1],me[mt])?Xt||S(we,me[mt],me[Tt])?Et=Tt:mt=Tt:Xt&&P(we,me[mt],me[Tt])?Et=Tt:mt=Tt}}function W(we,me){var mt,Et,Tt,Xt,Ye=me.length-1;if(S(we,me[Ye-1],me[0])&&!P(we,me[1],me[0]))return 0;for(mt=0,Et=Ye;;){if(Et-mt==1)return P(we,me[mt],me[Et])?mt:Et;if(Xt=P(we,me[(Tt=Math.floor((mt+Et)/2))+1],me[Tt]),S(we,me[Tt-1],me[Tt])&&!Xt)return Tt;P(we,me[mt+1],me[mt])?Xt?P(we,me[mt],me[Tt])?Et=Tt:mt=Tt:Et=Tt:Xt?mt=Tt:S(we,me[mt],me[Tt])?Et=Tt:mt=Tt}}function le(we,me,Ye,mt,Et,Tt){var Nt,Xt;Xt=mt(we[Nt=Ye(me[0],we)],me);for(var Pn=!1;!Pn;){for(Pn=!0;Nt===we.length-1&&(Nt=0),!Et(me[Xt],we[Nt],we[Nt+1]);)++Nt;for(;0===Xt&&(Xt=me.length-1),!Tt(we[Nt],me[Xt],me[Xt-1]);)--Xt,Pn=!1}return{t1:Nt,t2:Xt}}function de(we,me){return le(we,me,Q,W,S,P)}H.PolyPoint=w,H.isLeft=y,H.ConvexHull=function E(we){var mt,me=we.slice(0).sort(function($t,_n){return $t.x!==_n.x?_n.x-$t.x:_n.y-$t.y}),Ye=we.length,Tt=me[0].x;for(mt=1;mt<Ye&&me[mt].x===Tt;++mt);var Nt=mt-1,Xt=[];if(Xt.push(me[0]),Nt===Ye-1)me[Nt].y!==me[0].y&&Xt.push(me[Nt]);else{var Pn,st=Ye-1,at=me[Ye-1].x;for(mt=Ye-2;mt>=0&&me[mt].x===at;mt--);for(Pn=mt+1,mt=Nt;++mt<=Pn;)if(!(y(me[0],me[Pn],me[mt])>=0&&mt<Pn)){for(;Xt.length>1&&!(y(Xt[Xt.length-2],Xt[Xt.length-1],me[mt])>0);)Xt.length-=1;0!=mt&&Xt.push(me[mt])}st!=Pn&&Xt.push(me[st]);var kt=Xt.length;for(mt=Pn;--mt>=Nt;)if(!(y(me[st],me[Nt],me[mt])>=0&&mt>Nt)){for(;Xt.length>kt&&!(y(Xt[Xt.length-2],Xt[Xt.length-1],me[mt])>0);)Xt.length-=1;0!=mt&&Xt.push(me[mt])}}return Xt},H.clockwiseRadialSweep=function Z(we,me,Ye){me.slice(0).sort(function(mt,Et){return Math.atan2(mt.y-we.y,mt.x-we.x)-Math.atan2(Et.y-we.y,Et.x-we.x)}).forEach(Ye)},H.tangent_PolyPolyC=le,H.LRtangent_PolyPolyC=function e(we,me){var Ye=de(me,we);return{t1:Ye.t2,t2:Ye.t1}},H.RLtangent_PolyPolyC=de,H.LLtangent_PolyPolyC=function he(we,me){return le(we,me,W,W,P,P)},H.RRtangent_PolyPolyC=function ke(we,me){return le(we,me,Q,Q,S,S)};var Le=function we(me,Ye){this.t1=me,this.t2=Ye};H.BiTangent=Le;var Ue=function we(){};H.BiTangents=Ue;var Ie=function(we){function me(){return null!==we&&we.apply(this,arguments)||this}return M(me,we),me}(d);H.TVGPoint=Ie;var je=function we(me,Ye,mt,Et){this.id=me,this.polyid=Ye,this.polyvertid=mt,this.p=Et,Et.vv=this};H.VisibilityVertex=je;var X=function(){function we(me,Ye){this.source=me,this.target=Ye}return we.prototype.length=function(){var me=this.source.p.x-this.target.p.x,Ye=this.source.p.y-this.target.p.y;return Math.sqrt(me*me+Ye*Ye)},we}();H.VisibilityEdge=X;var ie=function(){function we(me,Ye){if(this.P=me,this.V=[],this.E=[],Ye)this.V=Ye.V.slice(0),this.E=Ye.E.slice(0);else{for(var mt=me.length,Et=0;Et<mt;Et++){for(var Tt=me[Et],Nt=0;Nt<Tt.length;++Nt){var Pn=new je(this.V.length,Et,Nt,Tt[Nt]);this.V.push(Pn),Nt>0&&this.E.push(new X(Tt[Nt-1].vv,Pn))}Tt.length>1&&this.E.push(new X(Tt[0].vv,Tt[Tt.length-1].vv))}for(Et=0;Et<mt-1;Et++){var st=me[Et];for(Nt=Et+1;Nt<mt;Nt++){var at=me[Nt],kt=ae(st,at);for(var $t in kt){var _n=kt[$t];this.addEdgeIfVisible(st[_n.t1],at[_n.t2],Et,Nt)}}}}}return we.prototype.addEdgeIfVisible=function(me,Ye,mt,Et){this.intersectsPolys(new T(me.x,me.y,Ye.x,Ye.y),mt,Et)||this.E.push(new X(me.vv,Ye.vv))},we.prototype.addPoint=function(me,Ye){var mt=this.P.length;this.V.push(new je(this.V.length,mt,0,me));for(var Et=0;Et<mt;++Et)if(Et!==Ye){var Tt=this.P[Et],Nt=U(me,Tt);this.addEdgeIfVisible(me,Tt[Nt.ltan],Ye,Et),this.addEdgeIfVisible(me,Tt[Nt.rtan],Ye,Et)}return me.vv},we.prototype.intersectsPolys=function(me,Ye,mt){for(var Et=0,Tt=this.P.length;Et<Tt;++Et)if(Et!=Ye&&Et!=mt&&oe(me,this.P[Et]).length>0)return!0;return!1},we}();function oe(we,me){for(var Ye=[],mt=1,Et=me.length;mt<Et;++mt){var Tt=D.Rectangle.lineIntersection(we.x1,we.y1,we.x2,we.y2,me[mt-1].x,me[mt-1].y,me[mt].x,me[mt].y);Tt&&Ye.push(Tt)}return Ye}function ae(we,me){for(var Ye=we.length-1,mt=me.length-1,Et=new Ue,Tt=0;Tt<Ye;++Tt)for(var Nt=0;Nt<mt;++Nt){var Xt=we[0==Tt?Ye-1:Tt-1],Pn=we[Tt],st=we[Tt+1],at=me[0==Nt?mt-1:Nt-1],kt=me[Nt],$t=me[Nt+1],_n=y(Xt,Pn,kt),Lt=y(Pn,at,kt),gn=y(Pn,kt,$t),$n=y(at,kt,Pn),pn=y(kt,Xt,Pn),Ui=y(kt,Pn,st);_n>=0&&Lt>=0&&gn<0&&$n>=0&&pn>=0&&Ui<0?Et.ll=new Le(Tt,Nt):_n<=0&&Lt<=0&&gn>0&&$n<=0&&pn<=0&&Ui>0?Et.rr=new Le(Tt,Nt):_n<=0&&Lt>0&&gn<=0&&$n>=0&&pn<0&&Ui>=0?Et.rl=new Le(Tt,Nt):_n>=0&&Lt<0&&gn>=0&&$n<=0&&pn>0&&Ui<=0&&(Et.lr=new Le(Tt,Nt))}return Et}function xe(we,me){return!we.every(function(Ye){return!function pe(we,me){for(var Ye=1,mt=me.length;Ye<mt;++Ye)if(P(me[Ye-1],me[Ye],we))return!1;return!0}(Ye,me)})}H.TangentVisibilityGraph=ie,H.tangents=ae,H.polysOverlap=function Ne(we,me){if(xe(we,me)||xe(me,we))return!0;for(var Ye=1,mt=we.length;Ye<mt;++Ye){var Et=we[Ye],Tt=we[Ye-1];if(oe(new T(Tt.x,Tt.y,Et.x,Et.y),me).length>0)return!0}return!1}},76767:(q,H,v)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var M=v(4068),D=v(98237),d=v(33858),T=function P(E,Z,A){this.id=E,this.rect=Z,this.children=A,this.leaf=typeof A>"u"||0===A.length};H.NodeWrapper=T;var w=function P(E,Z,A,I,U){void 0===I&&(I=null),void 0===U&&(U=null),this.id=E,this.x=Z,this.y=A,this.node=I,this.line=U};H.Vert=w;var y=function(){function P(E,Z){this.s=E,this.t=Z;var A=P.findMatch(E,Z),I=Z.slice(0).reverse(),U=P.findMatch(E,I);A.length>=U.length?(this.length=A.length,this.si=A.si,this.ti=A.ti,this.reversed=!1):(this.length=U.length,this.si=U.si,this.ti=Z.length-U.ti-U.length,this.reversed=!0)}return P.findMatch=function(E,Z){for(var A=E.length,I=Z.length,U={length:0,si:-1,ti:-1},Q=new Array(A),W=0;W<A;W++){Q[W]=new Array(I);for(var le=0;le<I;le++)if(E[W]===Z[le]){var e=Q[W][le]=0===W||0===le?1:Q[W-1][le-1]+1;e>U.length&&(U.length=e,U.si=W-e+1,U.ti=le-e+1)}else Q[W][le]=0}return U},P.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},P}();H.LongestCommonSubsequence=y;var S=function(){function P(E,Z,A){var I=this;void 0===A&&(A=12),this.originalnodes=E,this.groupPadding=A,this.leaves=null,this.nodes=E.map(function(Ie,je){return new T(je,Z.getBounds(Ie),Z.getChildren(Ie))}),this.leaves=this.nodes.filter(function(Ie){return Ie.leaf}),this.groups=this.nodes.filter(function(Ie){return!Ie.leaf}),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach(function(Ie){return Ie.children.forEach(function(je){return I.nodes[je].parent=Ie})}),this.root={children:[]},this.nodes.forEach(function(Ie){typeof Ie.parent>"u"&&(Ie.parent=I.root,I.root.children.push(Ie.id)),Ie.ports=[]}),this.backToFront=this.nodes.slice(0),this.backToFront.sort(function(Ie,je){return I.getDepth(Ie)-I.getDepth(je)}),this.backToFront.slice(0).reverse().filter(function(Ie){return!Ie.leaf}).forEach(function(Ie){var je=M.Rectangle.empty();Ie.children.forEach(function(X){return je=je.union(I.nodes[X].rect)}),Ie.rect=je.inflate(I.groupPadding)});var Q=this.midPoints(this.cols.map(function(Ie){return Ie.pos})),W=this.midPoints(this.rows.map(function(Ie){return Ie.pos})),le=Q[0],e=Q[Q.length-1],de=W[0],he=W[W.length-1],ke=this.rows.map(function(Ie){return{x1:le,x2:e,y1:Ie.pos,y2:Ie.pos}}).concat(W.map(function(Ie){return{x1:le,x2:e,y1:Ie,y2:Ie}})),Le=this.cols.map(function(Ie){return{x1:Ie.pos,x2:Ie.pos,y1:de,y2:he}}).concat(Q.map(function(Ie){return{x1:Ie,x2:Ie,y1:de,y2:he}})),Ue=ke.concat(Le);Ue.forEach(function(Ie){return Ie.verts=[]}),this.verts=[],this.edges=[],ke.forEach(function(Ie){return Le.forEach(function(je){var X=new w(I.verts.length,je.x1,Ie.y1);Ie.verts.push(X),je.verts.push(X),I.verts.push(X);for(var ie=I.backToFront.length;ie-- >0;){var oe=I.backToFront[ie],ae=oe.rect,pe=Math.abs(X.x-ae.cx()),xe=Math.abs(X.y-ae.cy());if(pe<ae.width()/2&&xe<ae.height()/2){X.node=oe;break}}})}),Ue.forEach(function(Ie,je){I.nodes.forEach(function(xe,Ne){xe.rect.lineIntersections(Ie.x1,Ie.y1,Ie.x2,Ie.y2).forEach(function(we,me){var Ye=new w(I.verts.length,we.x,we.y,xe,Ie);I.verts.push(Ye),Ie.verts.push(Ye),xe.ports.push(Ye)})});var X=Math.abs(Ie.y1-Ie.y2)<.1,ie=function(xe,Ne){return X?Ne.x-xe.x:Ne.y-xe.y};Ie.verts.sort(ie);for(var oe=1;oe<Ie.verts.length;oe++){var ae=Ie.verts[oe-1],pe=Ie.verts[oe];ae.node&&ae.node===pe.node&&ae.node.leaf||I.edges.push({source:ae.id,target:pe.id,length:Math.abs(ie(ae,pe))})}})}return P.prototype.avg=function(E){return E.reduce(function(Z,A){return Z+A})/E.length},P.prototype.getGridLines=function(E){for(var Z=[],A=this.leaves.slice(0,this.leaves.length);A.length>0;){var I=A.filter(function(Q){return Q.rect["overlap"+E.toUpperCase()](A[0].rect)}),U={nodes:I,pos:this.avg(I.map(function(Q){return Q.rect["c"+E]()}))};Z.push(U),U.nodes.forEach(function(Q){return A.splice(A.indexOf(Q),1)})}return Z.sort(function(Q,W){return Q.pos-W.pos}),Z},P.prototype.getDepth=function(E){for(var Z=0;E.parent!==this.root;)Z++,E=E.parent;return Z},P.prototype.midPoints=function(E){for(var Z=E[1]-E[0],A=[E[0]-Z/2],I=1;I<E.length;I++)A.push((E[I]+E[I-1])/2);return A.push(E[E.length-1]+Z/2),A},P.prototype.findLineage=function(E){var Z=[E];do{Z.push(E=E.parent)}while(E!==this.root);return Z.reverse()},P.prototype.findAncestorPathBetween=function(E,Z){for(var A=this.findLineage(E),I=this.findLineage(Z),U=0;A[U]===I[U];)U++;return{commonAncestor:A[U-1],lineages:A.slice(U).concat(I.slice(U))}},P.prototype.siblingObstacles=function(E,Z){var A=this,I=this.findAncestorPathBetween(E,Z),U={};I.lineages.forEach(function(W){return U[W.id]={}});var Q=I.commonAncestor.children.filter(function(W){return!(W in U)});return I.lineages.filter(function(W){return W.parent!==I.commonAncestor}).forEach(function(W){return Q=Q.concat(W.parent.children.filter(function(le){return le!==W.id}))}),Q.map(function(W){return A.nodes[W]})},P.getSegmentSets=function(E,Z,A){for(var I=[],U=0;U<E.length;U++)for(var Q=E[U],W=0;W<Q.length;W++)(le=Q[W]).edgeid=U,le.i=W,Math.abs(le[1][Z]-le[0][Z])<.1&&I.push(le);I.sort(function(Le,Ue){return Le[0][Z]-Ue[0][Z]});for(var de=[],he=null,ke=0;ke<I.length;ke++){var le=I[ke];(!he||Math.abs(le[0][Z]-he.pos)>.1)&&de.push(he={pos:le[0][Z],segments:[]}),he.segments.push(le)}return de},P.nudgeSegs=function(E,Z,A,I,U,Q){var W=I.length;if(!(W<=1)){for(var le=I.map(function(oe){return new D.Variable(oe[0][E])}),e=[],de=0;de<W;de++)for(var he=0;he<W;he++)if(de!==he){var ke=I[de],Ue=ke.edgeid,Ie=I[he].edgeid,je=-1,X=-1;"x"==E?U(Ue,Ie)&&(ke[0][Z]<ke[1][Z]?(je=he,X=de):(je=de,X=he)):U(Ue,Ie)&&(ke[0][Z]<ke[1][Z]?(je=de,X=he):(je=he,X=de)),je>=0&&e.push(new D.Constraint(le[je],le[X],Q))}new D.Solver(le,e).solve(),le.forEach(function(oe,ae){var pe=I[ae],xe=oe.position();pe[0][E]=pe[1][E]=xe;var Ne=A[pe.edgeid];pe.i>0&&(Ne[pe.i-1][1][E]=xe),pe.i<Ne.length-1&&(Ne[pe.i+1][0][E]=xe)})}},P.nudgeSegments=function(E,Z,A,I,U){for(var Q=P.getSegmentSets(E,Z,A),W=0;W<Q.length;W++){for(var le=Q[W],e=[],de=0;de<le.segments.length;de++){var he=le.segments[de];e.push({type:0,s:he,pos:Math.min(he[0][A],he[1][A])}),e.push({type:1,s:he,pos:Math.max(he[0][A],he[1][A])})}e.sort(function(Ue,Ie){return Ue.pos-Ie.pos+Ue.type-Ie.type});var ke=[],Le=0;e.forEach(function(Ue){0===Ue.type?(ke.push(Ue.s),Le++):Le--,0==Le&&(P.nudgeSegs(Z,A,E,ke,I,U),ke=[])})}},P.prototype.routeEdges=function(E,Z,A,I){var U=this,Q=E.map(function(e){return U.route(A(e),I(e))}),W=P.orderEdges(Q),le=Q.map(function(e){return P.makeSegments(e)});return P.nudgeSegments(le,"x","y",W,Z),P.nudgeSegments(le,"y","x",W,Z),P.unreverseEdges(le,Q),le},P.unreverseEdges=function(E,Z){E.forEach(function(A,I){Z[I].reversed&&(A.reverse(),A.forEach(function(Q){Q.reverse()}))})},P.angleBetween2Lines=function(E,Z){var A=Math.atan2(E[0].y-E[1].y,E[0].x-E[1].x),I=Math.atan2(Z[0].y-Z[1].y,Z[0].x-Z[1].x),U=A-I;return(U>Math.PI||U<-Math.PI)&&(U=I-A),U},P.isLeft=function(E,Z,A){return(Z.x-E.x)*(A.y-E.y)-(Z.y-E.y)*(A.x-E.x)<=0},P.getOrder=function(E){for(var Z={},A=0;A<E.length;A++){var I=E[A];typeof Z[I.l]>"u"&&(Z[I.l]={}),Z[I.l][I.r]=!0}return function(U,Q){return typeof Z[U]<"u"&&Z[U][Q]}},P.orderEdges=function(E){for(var Z=[],A=0;A<E.length-1;A++)for(var I=A+1;I<E.length;I++){var le,e,de,U=E[A],Q=E[I],W=new y(U,Q);if(0!==W.length){if(W.reversed&&(Q.reverse(),Q.reversed=!0,W=new y(U,Q)),(W.si<=0||W.ti<=0)&&(W.si+W.length>=U.length||W.ti+W.length>=Q.length)){Z.push({l:A,r:I});continue}W.si+W.length>=U.length||W.ti+W.length>=Q.length?(le=U[W.si+1],de=U[W.si-1],e=Q[W.ti-1]):(le=U[W.si+W.length-2],e=U[W.si+W.length],de=Q[W.ti+W.length]),P.isLeft(le,e,de)?Z.push({l:I,r:A}):Z.push({l:A,r:I})}}return P.getOrder(Z)},P.makeSegments=function(E){function Z(e){return{x:e.x,y:e.y}}for(var I=[],U=Z(E[0]),Q=1;Q<E.length;Q++){var W=Z(E[Q]),le=Q<E.length-1?E[Q+1]:null;(!le||(e=U,de=W,he=le,!(Math.abs((de.x-e.x)*(he.y-e.y)-(de.y-e.y)*(he.x-e.x))<.001)))&&(I.push([U,W]),U=W)}var e,de,he;return I},P.prototype.route=function(E,Z){var A=this,I=this.nodes[E],U=this.nodes[Z];this.obstacles=this.siblingObstacles(I,U);var Q={};this.obstacles.forEach(function(X){return Q[X.id]=X}),this.passableEdges=this.edges.filter(function(X){var ie=A.verts[X.source],oe=A.verts[X.target];return!(ie.node&&ie.node.id in Q||oe.node&&oe.node.id in Q)});for(var W=1;W<I.ports.length;W++)this.passableEdges.push({source:I.ports[0].id,target:I.ports[W].id,length:0});for(W=1;W<U.ports.length;W++)this.passableEdges.push({source:U.ports[0].id,target:U.ports[W].id,length:0});var je=new d.Calculator(this.verts.length,this.passableEdges,function(X){return X.source},function(X){return X.target},function(X){return X.length}).PathFromNodeToNodeWithPrevCost(I.ports[0].id,U.ports[0].id,function(X,ie,oe){var ae=A.verts[X],pe=A.verts[ie],xe=A.verts[oe],Ne=Math.abs(xe.x-ae.x),we=Math.abs(xe.y-ae.y);return ae.node===I&&ae.node===pe.node||pe.node===U&&pe.node===xe.node?0:Ne>1&&we>1?1e3:0}).reverse().map(function(X){return A.verts[X]});return je.push(this.nodes[U.id].ports[0]),je.filter(function(X,ie){return!(ie<je.length-1&&je[ie+1].node===I&&X.node===I||ie>0&&X.node===U&&je[ie-1].node===U)})},P.getRoutePath=function(E,Z,A,I){var W,le,e,Ne,we,U={routepath:"M "+E[0][0].x+" "+E[0][0].y+" ",arrowpath:""};if(E.length>1)for(var Q=0;Q<E.length;Q++){var de=(le=(W=E[Q])[1].x)-W[0].x,he=(e=W[1].y)-W[0].y;if(Q<E.length-1){Math.abs(de)>0?le-=de/Math.abs(de)*Z:e-=he/Math.abs(he)*Z,U.routepath+="L "+le+" "+e+" ";var ke=E[Q+1],Le=ke[0].x,Ue=ke[0].y;de=ke[1].x-Le,he=ke[1].y-Ue;var ie,oe,X=P.angleBetween2Lines(W,ke)<0?1:0;Math.abs(de)>0?(ie=Le+de/Math.abs(de)*Z,oe=Ue):(ie=Le,oe=Ue+he/Math.abs(he)*Z);var ae=Math.abs(ie-le),pe=Math.abs(oe-e);U.routepath+="A "+ae+" "+pe+" 0 0 "+X+" "+ie+" "+oe+" "}else{var xe=[le,e];Math.abs(de)>0?(Ne=[le-=de/Math.abs(de)*I,e+A],we=[le,e-A]):(Ne=[le+A,e-=he/Math.abs(he)*I],we=[le-A,e]),U.routepath+="L "+le+" "+e+" ",I>0&&(U.arrowpath="M "+xe[0]+" "+xe[1]+" L "+Ne[0]+" "+Ne[1]+" L "+we[0]+" "+we[1])}}else de=(le=(W=E[0])[1].x)-W[0].x,he=(e=W[1].y)-W[0].y,xe=[le,e],Math.abs(de)>0?(Ne=[le-=de/Math.abs(de)*I,e+A],we=[le,e-A]):(Ne=[le+A,e-=he/Math.abs(he)*I],we=[le-A,e]),U.routepath+="L "+le+" "+e+" ",I>0&&(U.arrowpath="M "+xe[0]+" "+xe[1]+" L "+Ne[0]+" "+Ne[1]+" L "+we[0]+" "+we[1]);return U},P}();H.GridRouter=S},30345:(q,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var v_GOLDEN_SECTION=(1+Math.sqrt(5))/2;H.applyPacking=function M(d,T,w,Q,U,P){void 0===U&&(U=1),void 0===P&&(P=!0);var A=T,I=w,W=(U=typeof U<"u"?U:1,Q=typeof Q<"u"?Q:0,0),le=0,e=0,de=0,he=[];function Ie(oe,ae){he=[],W=0,le=0,de=0;for(var pe=0;pe<oe.length;pe++)je(oe[pe],ae);return Math.abs(function ie(){return W/le}()-U)}function je(oe,ae){for(var pe=void 0,xe=0;xe<he.length;xe++)if(he[xe].space_left>=oe.height&&he[xe].x+he[xe].width+oe.width+10-ae<=1e-4){pe=he[xe];break}he.push(oe),void 0!==pe?(oe.x=pe.x+pe.width+10,oe.y=pe.bottom,oe.space_left=oe.height,oe.bottom=oe.y,pe.space_left-=oe.height+10,pe.bottom+=oe.height+10):(oe.y=de,de+=oe.height+10,oe.x=0,oe.bottom=oe.y,oe.space_left=oe.height),oe.y+oe.height-le>-1e-4&&(le=oe.y+oe.height-0),oe.x+oe.width-W>-1e-4&&(W=oe.x+oe.width-0)}0!=d.length&&(function ke(oe){oe.forEach(function(pe){!function ae(pe){var xe=Number.MAX_VALUE,Ne=Number.MAX_VALUE,we=0,me=0;pe.array.forEach(function(Ye){var mt=typeof Ye.width<"u"?Ye.width:Q,Et=typeof Ye.height<"u"?Ye.height:Q;mt/=2,Et/=2,we=Math.max(Ye.x+mt,we),xe=Math.min(Ye.x-mt,xe),me=Math.max(Ye.y+Et,me),Ne=Math.min(Ye.y-Et,Ne)}),pe.width=we-xe,pe.height=me-Ne}(pe)})}(d),function Ue(oe,ae){var pe=Number.POSITIVE_INFINITY,xe=0;oe.sort(function(st,at){return at.height-st.height});for(var Ne=Xt=e=oe.reduce(function(st,at){return st.width<at.width?st.width:at.width}),we=Pn=function X(oe){var ae=0;return oe.forEach(function(pe){return ae+=pe.width+10}),ae}(oe),me=0,Ye=Number.MAX_VALUE,mt=Number.MAX_VALUE,Et=-1,Tt=Number.MAX_VALUE,Nt=Number.MAX_VALUE;Tt>e||Nt>1e-4;){if(1!=Et){var Xt=we-(we-Ne)/v_GOLDEN_SECTION;Ye=Ie(oe,Xt)}if(0!=Et){var Pn=Ne+(we-Ne)/v_GOLDEN_SECTION;mt=Ie(oe,Pn)}if(Tt=Math.abs(Xt-Pn),Nt=Math.abs(Ye-mt),Ye<pe&&(pe=Ye,xe=Xt),mt<pe&&(pe=mt,xe=Pn),Ye>mt?(Ne=Xt,Xt=Pn,Ye=mt,Et=1):(we=Pn,Pn=Xt,mt=Ye,Et=0),me++>100)break}Ie(oe,xe)}(d),P&&function Le(oe){oe.forEach(function(ae){var pe={x:0,y:0};ae.array.forEach(function(we){pe.x+=we.x,pe.y+=we.y}),pe.x/=ae.array.length,pe.y/=ae.array.length;var Ne_x=ae.x-(pe.x-ae.width/2)+A/2-W/2,Ne_y=ae.y-(pe.y-ae.height/2)+I/2-le/2;ae.array.forEach(function(we){we.x+=Ne_x,we.y+=Ne_y})})}(d))},H.separateGraphs=function D(d,T){for(var w={},y={},S=[],P=0,E=0;E<T.length;E++){var Z=T[E],A=Z.source,I=Z.target;y[A.index]?y[A.index].push(I):y[A.index]=[I],y[I.index]?y[I.index].push(A):y[I.index]=[A]}for(E=0;E<d.length;E++){var U=d[E];w[U.index]||Q(U,!0)}function Q(W,le){if(void 0===w[W.index]){le&&(P++,S.push({array:[]})),w[W.index]=P,S[P-1].array.push(W);var e=y[W.index];if(e)for(var de=0;de<e.length;de++)Q(e[de],!1)}}return S}},15675:(q,H,v)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var P,A,M=v(33900),D=v(58802),d=v(91786),T=v(4068),w=v(33858),y=v(30225),S=v(30345);function E(A){return typeof A.leaves<"u"||typeof A.groups<"u"}(A=P=H.EventType||(H.EventType={}))[A.start=0]="start",A[A.tick=1]="tick",A[A.end=2]="end";var Z=function(){function A(){var I=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:A.getSourceIndex,getTargetIndex:A.getTargetIndex,setLength:A.setLinkLength,getType:function(U){return"function"==typeof I._linkType?I._linkType(U):0}}}return A.prototype.on=function(I,U){return this.event||(this.event={}),"string"==typeof I?this.event[P[I]]=U:this.event[I]=U,this},A.prototype.trigger=function(I){this.event&&typeof this.event[I.type]<"u"&&this.event[I.type](I)},A.prototype.kick=function(){for(;!this.tick(););},A.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:P.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var Q,W,I=this._nodes.length;for(this._descent.locks.clear(),W=0;W<I;++W)(Q=this._nodes[W]).fixed&&((typeof Q.px>"u"||typeof Q.py>"u")&&(Q.px=Q.x,Q.py=Q.y),this._descent.locks.add(W,[Q.px,Q.py]));var e=this._descent.rungeKutta();return 0===e?this._alpha=0:typeof this._lastStress<"u"&&(this._alpha=e),this._lastStress=e,this.updateNodePositions(),this.trigger({type:P.tick,alpha:this._alpha,stress:this._lastStress}),!1},A.prototype.updateNodePositions=function(){for(var Q,I=this._descent.x[0],U=this._descent.x[1],W=this._nodes.length;W--;)(Q=this._nodes[W]).x=I[W],Q.y=U[W]},A.prototype.nodes=function(I){if(!I){if(0===this._nodes.length&&this._links.length>0){var U=0;this._links.forEach(function(W){U=Math.max(U,W.source,W.target)}),this._nodes=new Array(++U);for(var Q=0;Q<U;++Q)this._nodes[Q]={}}return this._nodes}return this._nodes=I,this},A.prototype.groups=function(I){var U=this;return I?(this._groups=I,this._rootGroup={},this._groups.forEach(function(Q){typeof Q.padding>"u"&&(Q.padding=1),typeof Q.leaves<"u"&&Q.leaves.forEach(function(W,le){"number"==typeof W&&((Q.leaves[le]=U._nodes[W]).parent=Q)}),typeof Q.groups<"u"&&Q.groups.forEach(function(W,le){"number"==typeof W&&((Q.groups[le]=U._groups[W]).parent=Q)})}),this._rootGroup.leaves=this._nodes.filter(function(Q){return typeof Q.parent>"u"}),this._rootGroup.groups=this._groups.filter(function(Q){return typeof Q.parent>"u"}),this):this._groups},A.prototype.powerGraphGroups=function(I){var U=M.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(U.groups),I(U),this},A.prototype.avoidOverlaps=function(I){return arguments.length?(this._avoidOverlaps=I,this):this._avoidOverlaps},A.prototype.handleDisconnected=function(I){return arguments.length?(this._handleDisconnected=I,this):this._handleDisconnected},A.prototype.flowLayout=function(I,U){return arguments.length||(I="y"),this._directedLinkConstraints={axis:I,getMinSeparation:"number"==typeof U?function(){return U}:U},this},A.prototype.links=function(I){return arguments.length?(this._links=I,this):this._links},A.prototype.constraints=function(I){return arguments.length?(this._constraints=I,this):this._constraints},A.prototype.distanceMatrix=function(I){return arguments.length?(this._distanceMatrix=I,this):this._distanceMatrix},A.prototype.size=function(I){return I?(this._canvasSize=I,this):this._canvasSize},A.prototype.defaultNodeSize=function(I){return I?(this._defaultNodeSize=I,this):this._defaultNodeSize},A.prototype.groupCompactness=function(I){return I?(this._groupCompactness=I,this):this._groupCompactness},A.prototype.linkDistance=function(I){return I?(this._linkDistance="function"==typeof I?I:+I,this._linkLengthCalculator=null,this):this._linkDistance},A.prototype.linkType=function(I){return this._linkType=I,this},A.prototype.convergenceThreshold=function(I){return I?(this._threshold="function"==typeof I?I:+I,this):this._threshold},A.prototype.alpha=function(I){return arguments.length?(I=+I,this._alpha?this._alpha=I>0?I:0:I>0&&(this._running||(this._running=!0,this.trigger({type:P.start,alpha:this._alpha=I}),this.kick())),this):this._alpha},A.prototype.getLinkLength=function(I){return"function"==typeof this._linkDistance?+this._linkDistance(I):this._linkDistance},A.setLinkLength=function(I,U){I.length=U},A.prototype.getLinkType=function(I){return"function"==typeof this._linkType?this._linkType(I):0},A.prototype.symmetricDiffLinkLengths=function(I,U){var Q=this;return void 0===U&&(U=1),this.linkDistance(function(W){return I*W.length}),this._linkLengthCalculator=function(){return D.symmetricDiffLinkLengths(Q._links,Q.linkAccessor,U)},this},A.prototype.jaccardLinkLengths=function(I,U){var Q=this;return void 0===U&&(U=1),this.linkDistance(function(W){return I*W.length}),this._linkLengthCalculator=function(){return D.jaccardLinkLengths(Q._links,Q.linkAccessor,U)},this},A.prototype.start=function(I,U,Q,W,le,e){var de=this;void 0===I&&(I=0),void 0===U&&(U=0),void 0===Q&&(Q=0),void 0===W&&(W=0),void 0===le&&(le=!0),void 0===e&&(e=!0);var xe,Le=this.nodes().length,Ue=Le+2*this._groups.length,je=this._canvasSize[0],X=this._canvasSize[1],ie=new Array(Ue),oe=new Array(Ue),ae=null,pe=this._avoidOverlaps;this._nodes.forEach(function(Tt,Nt){Tt.index=Nt,typeof Tt.x>"u"&&(Tt.x=je/2,Tt.y=X/2),ie[Nt]=Tt.x,oe[Nt]=Tt.y}),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?xe=this._distanceMatrix:(xe=new w.Calculator(Ue,this._links,A.getSourceIndex,A.getTargetIndex,function(Tt){return de.getLinkLength(Tt)}).DistanceMatrix(),ae=d.Descent.createSquareMatrix(Ue,function(){return 2}),this._links.forEach(function(Tt){"number"==typeof Tt.source&&(Tt.source=de._nodes[Tt.source]),"number"==typeof Tt.target&&(Tt.target=de._nodes[Tt.target])}),this._links.forEach(function(Tt){var Nt=A.getSourceIndex(Tt),Xt=A.getTargetIndex(Tt);ae[Nt][Xt]=ae[Xt][Nt]=Tt.weight||1}));var Ne=d.Descent.createSquareMatrix(Ue,function(Tt,Nt){return xe[Tt][Nt]});if(this._rootGroup&&typeof this._rootGroup.groups<"u"){var he=Le;this._groups.forEach(function(Nt){(function(Nt,Xt,Pn,st){ae[Nt][Xt]=ae[Xt][Nt]=Pn,Ne[Nt][Xt]=Ne[Xt][Nt]=.1})(he,he+1,de._groupCompactness),ie[he]=0,oe[he++]=0,ie[he]=0,oe[he++]=0})}else this._rootGroup={leaves:this._nodes,groups:[]};var me=this._constraints||[];for(this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,me=me.concat(D.generateDirectedEdgeConstraints(Le,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new d.Descent([ie,oe],Ne),this._descent.locks.clear(),he=0;he<Le;++he){var Ye=this._nodes[he];Ye.fixed&&(Ye.px=Ye.x,Ye.py=Ye.y,this._descent.locks.add(he,[Ye.x,Ye.y]))}if(this._descent.threshold=this._threshold,this.initialLayout(I,ie,oe),me.length>0&&(this._descent.project=new T.Projection(this._nodes,this._groups,this._rootGroup,me).projectFunctions()),this._descent.run(U),this.separateOverlappingComponents(je,X,e),this.avoidOverlaps(pe),pe&&(this._nodes.forEach(function(Tt,Nt){Tt.x=ie[Nt],Tt.y=oe[Nt]}),this._descent.project=new T.Projection(this._nodes,this._groups,this._rootGroup,me,!0).projectFunctions(),this._nodes.forEach(function(Tt,Nt){ie[Nt]=Tt.x,oe[Nt]=Tt.y})),this._descent.G=ae,this._descent.run(Q),W){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=Le,this._descent.scaleSnapByMaxH=Le!=Ue;var Et=d.Descent.createSquareMatrix(Ue,function(Tt,Nt){return Tt>=Le||Nt>=Le?ae[Tt][Nt]:0});this._descent.G=Et,this._descent.run(W)}return this.updateNodePositions(),this.separateOverlappingComponents(je,X,e),le?this.resume():this},A.prototype.initialLayout=function(I,U,Q){if(this._groups.length>0&&I>0){var W=this._nodes.length,le=this._links.map(function(de){return{source:de.source.index,target:de.target.index}}),e=this._nodes.map(function(de){return{index:de.index}});this._groups.forEach(function(de,he){e.push({index:de.index=W+he})}),this._groups.forEach(function(de,he){typeof de.leaves<"u"&&de.leaves.forEach(function(ke){return le.push({source:de.index,target:ke.index})}),typeof de.groups<"u"&&de.groups.forEach(function(ke){return le.push({source:de.index,target:ke.index})})}),(new A).size(this.size()).nodes(e).links(le).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(I,0,0,0,!1),this._nodes.forEach(function(de){U[de.index]=e[de.index].x,Q[de.index]=e[de.index].y})}else this._descent.run(I)},A.prototype.separateOverlappingComponents=function(I,U,Q){var W=this;if(void 0===Q&&(Q=!0),!this._distanceMatrix&&this._handleDisconnected){var le=this._descent.x[0],e=this._descent.x[1];this._nodes.forEach(function(he,ke){he.x=le[ke],he.y=e[ke]});var de=S.separateGraphs(this._nodes,this._links);S.applyPacking(de,I,U,this._defaultNodeSize,1,Q),this._nodes.forEach(function(he,ke){W._descent.x[0][ke]=he.x,W._descent.x[1][ke]=he.y,he.bounds&&(he.bounds.setXCentre(he.x),he.bounds.setYCentre(he.y))})}},A.prototype.resume=function(){return this.alpha(.1)},A.prototype.stop=function(){return this.alpha(0)},A.prototype.prepareEdgeRouting=function(I){void 0===I&&(I=0),this._visibilityGraph=new y.TangentVisibilityGraph(this._nodes.map(function(U){return U.bounds.inflate(-I).vertices()}))},A.prototype.routeEdge=function(I,U,Q){void 0===U&&(U=5);var W=[],le=new y.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),e={x:I.source.x,y:I.source.y},de={x:I.target.x,y:I.target.y},he=le.addPoint(e,I.source.index),ke=le.addPoint(de,I.target.index);le.addEdgeIfVisible(e,de,I.source.index,I.target.index),typeof Q<"u"&&Q(le);var X=new w.Calculator(le.V.length,le.E,function(Ne){return Ne.source.id},function(Ne){return Ne.target.id},function(Ne){return Ne.length()}).PathFromNodeToNode(he.id,ke.id);if(1===X.length||X.length===le.V.length){var ie=T.makeEdgeBetween(I.source.innerBounds,I.target.innerBounds,U);W=[ie.sourceIntersection,ie.arrowStart]}else{for(var oe=X.length-2,ae=le.V[X[oe]].p,pe=le.V[X[0]].p,xe=(W=[I.source.innerBounds.rayIntersection(ae.x,ae.y)],oe);xe>=0;--xe)W.push(le.V[X[xe]].p);W.push(T.makeEdgeTo(pe,I.target.innerBounds,U))}return W},A.getSourceIndex=function(I){return"number"==typeof I.source?I.source:I.source.index},A.getTargetIndex=function(I){return"number"==typeof I.target?I.target:I.target.index},A.linkId=function(I){return A.getSourceIndex(I)+"-"+A.getTargetIndex(I)},A.dragStart=function(I){E(I)?A.storeOffset(I,A.dragOrigin(I)):(A.stopNode(I),I.fixed|=2)},A.stopNode=function(I){I.px=I.x,I.py=I.y},A.storeOffset=function(I,U){typeof I.leaves<"u"&&I.leaves.forEach(function(Q){Q.fixed|=2,A.stopNode(Q),Q._dragGroupOffsetX=Q.x-U.x,Q._dragGroupOffsetY=Q.y-U.y}),typeof I.groups<"u"&&I.groups.forEach(function(Q){return A.storeOffset(Q,U)})},A.dragOrigin=function(I){return E(I)?{x:I.bounds.cx(),y:I.bounds.cy()}:I},A.drag=function(I,U){E(I)?(typeof I.leaves<"u"&&I.leaves.forEach(function(Q){I.bounds.setXCentre(U.x),I.bounds.setYCentre(U.y),Q.px=Q._dragGroupOffsetX+U.x,Q.py=Q._dragGroupOffsetY+U.y}),typeof I.groups<"u"&&I.groups.forEach(function(Q){return A.drag(Q,U)})):(I.px=U.x,I.py=U.y)},A.dragEnd=function(I){E(I)?(typeof I.leaves<"u"&&I.leaves.forEach(function(U){A.dragEnd(U),delete U._dragGroupOffsetX,delete U._dragGroupOffsetY}),typeof I.groups<"u"&&I.groups.forEach(A.dragEnd)):I.fixed&=-7},A.mouseOver=function(I){I.fixed|=4,I.px=I.x,I.py=I.y},A.mouseOut=function(I){I.fixed&=-5},A}();H.Layout=Z},86461:(q,H,v)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var M=v(33858),D=v(91786),d=v(4068),T=v(58802),w=function(){function E(Z,A){this.source=Z,this.target=A}return E.prototype.actualLength=function(Z){var A=this;return Math.sqrt(Z.reduce(function(I,U){var Q=U[A.target]-U[A.source];return I+Q*Q},0))},E}();H.Link3D=w,H.Node3D=function E(Z,A,I){void 0===Z&&(Z=0),void 0===A&&(A=0),void 0===I&&(I=0),this.x=Z,this.y=A,this.z=I};var S=function(){function E(Z,A,I){var U=this;void 0===I&&(I=1),this.nodes=Z,this.links=A,this.idealLinkLength=I,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(E.k);for(var Q=0;Q<E.k;++Q)this.result[Q]=new Array(Z.length);Z.forEach(function(W,le){for(var e=0,de=E.dims;e<de.length;e++){var he=de[e];typeof W[he]>"u"&&(W[he]=Math.random())}U.result[0][le]=W.x,U.result[1][le]=W.y,U.result[2][le]=W.z})}return E.prototype.linkLength=function(Z){return Z.actualLength(this.result)},E.prototype.start=function(Z){var A=this;void 0===Z&&(Z=100);var I=this.nodes.length,U=new P;this.useJaccardLinkLengths&&T.jaccardLinkLengths(this.links,U,1.5),this.links.forEach(function(he){return he.length*=A.idealLinkLength});var Q=new M.Calculator(I,this.links,function(he){return he.source},function(he){return he.target},function(he){return he.length}).DistanceMatrix(),W=D.Descent.createSquareMatrix(I,function(he,ke){return Q[he][ke]}),le=D.Descent.createSquareMatrix(I,function(){return 2});this.links.forEach(function(he){var ke=he.source,Le=he.target;return le[ke][Le]=le[Le][ke]=1}),this.descent=new D.Descent(this.result,W),this.descent.threshold=.001,this.descent.G=le,this.constraints&&(this.descent.project=new d.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var e=0;e<this.nodes.length;e++){var de=this.nodes[e];de.fixed&&this.descent.locks.add(e,[de.x,de.y,de.z])}return this.descent.run(Z),this},E.prototype.tick=function(){this.descent.locks.clear();for(var Z=0;Z<this.nodes.length;Z++){var A=this.nodes[Z];A.fixed&&this.descent.locks.add(Z,[A.x,A.y,A.z])}return this.descent.rungeKutta()},E.k=(E.dims=["x","y","z"]).length,E}();H.Layout3D=S;var P=function(){function E(){}return E.prototype.getSourceIndex=function(Z){return Z.source},E.prototype.getTargetIndex=function(Z){return Z.target},E.prototype.getLength=function(Z){return Z.length},E.prototype.setLength=function(Z,A){Z.length=A},E}()},58802:(q,H)=>{"use strict";function v(P,E){var Z={};for(var A in P)Z[A]={};for(var A in E)Z[A]={};return Object.keys(Z).length}function M(P,E){var Z=0;for(var A in P)typeof E[A]<"u"&&++Z;return Z}function d(P,E,Z,A){var I=function D(P,E){var Z={},A=function(I,U){typeof Z[I]>"u"&&(Z[I]={}),Z[I][U]={}};return P.forEach(function(I){var U=E.getSourceIndex(I),Q=E.getTargetIndex(I);A(U,Q),A(Q,U)}),Z}(P,A);P.forEach(function(U){var Q=I[A.getSourceIndex(U)],W=I[A.getTargetIndex(U)];A.setLength(U,1+E*Z(Q,W))})}function S(P,E,Z){var A=[],I=0,U=[],Q=[];function W(X){X.index=X.lowlink=I++,U.push(X),X.onStack=!0;for(var ie=0,oe=X.out;ie<oe.length;ie++){var ae=oe[ie];typeof ae.index>"u"?(W(ae),X.lowlink=Math.min(X.lowlink,ae.lowlink)):ae.onStack&&(X.lowlink=Math.min(X.lowlink,ae.index))}if(X.lowlink===X.index){for(var pe=[];U.length&&((ae=U.pop()).onStack=!1,pe.push(ae),ae!==X););Q.push(pe.map(function(xe){return xe.id}))}}for(var le=0;le<P;le++)A.push({id:le,out:[]});for(var e=0,de=E;e<de.length;e++){var he=de[e],ke=A[Z.getSourceIndex(he)],Le=A[Z.getTargetIndex(he)];ke.out.push(Le)}for(var Ue=0,Ie=A;Ue<Ie.length;Ue++){var je=Ie[Ue];typeof je.index>"u"&&W(je)}return Q}Object.defineProperty(H,"__esModule",{value:!0}),H.symmetricDiffLinkLengths=function T(P,E,Z){void 0===Z&&(Z=1),d(P,Z,function(A,I){return Math.sqrt(v(A,I)-M(A,I))},E)},H.jaccardLinkLengths=function w(P,E,Z){void 0===Z&&(Z=1),d(P,Z,function(A,I){return Math.min(Object.keys(A).length,Object.keys(I).length)<1.1?0:M(A,I)/v(A,I)},E)},H.generateDirectedEdgeConstraints=function y(P,E,Z,A){var I=S(P,E,A),U={};I.forEach(function(W,le){return W.forEach(function(e){return U[e]=le})});var Q=[];return E.forEach(function(W){var le=A.getSourceIndex(W),e=A.getTargetIndex(W);U[le]!==U[e]&&Q.push({axis:Z,left:le,right:e,gap:A.getMinSeparation(W)})}),Q},H.stronglyConnectedComponents=S},33900:(q,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var v=function E(Z,A,I){this.source=Z,this.target=A,this.type=I};H.PowerEdge=v;var M=function(){function E(Z,A,I,U){var Q=this;if(this.linkAccessor=I,this.modules=new Array(Z),this.roots=[],U)this.initModulesFromGroup(U);else{this.roots.push(new w);for(var W=0;W<Z;++W)this.roots[0].add(this.modules[W]=new d(W))}this.R=A.length,A.forEach(function(le){var e=Q.modules[I.getSourceIndex(le)],de=Q.modules[I.getTargetIndex(le)],he=I.getType(le);e.outgoing.add(he,de),de.incoming.add(he,e)})}return E.prototype.initModulesFromGroup=function(Z){var A=new w;this.roots.push(A);for(var I=0;I<Z.leaves.length;++I){var U=Z.leaves[I],Q=new d(U.id);this.modules[U.id]=Q,A.add(Q)}if(Z.groups)for(var W=0;W<Z.groups.length;++W){var le=Z.groups[W],e={};for(var de in le)"leaves"!==de&&"groups"!==de&&le.hasOwnProperty(de)&&(e[de]=le[de]);A.add(new d(-1-W,new y,new y,this.initModulesFromGroup(le),e))}return A},E.prototype.merge=function(Z,A,I){void 0===I&&(I=0);var U=Z.incoming.intersection(A.incoming),Q=Z.outgoing.intersection(A.outgoing),W=new w;W.add(Z),W.add(A);var le=new d(this.modules.length,Q,U,W);this.modules.push(le);var e=function(de,he,ke){de.forAll(function(Le,Ue){Le.forAll(function(Ie){var je=Ie[he];je.add(Ue,le),je.remove(Ue,Z),je.remove(Ue,A),Z[ke].remove(Ue,Ie),A[ke].remove(Ue,Ie)})})};return e(Q,"incoming","outgoing"),e(U,"outgoing","incoming"),this.R-=U.count()+Q.count(),this.roots[I].remove(Z),this.roots[I].remove(A),this.roots[I].add(le),le},E.prototype.rootMerges=function(Z){void 0===Z&&(Z=0);for(var A=this.roots[Z].modules(),I=A.length,U=new Array(I*(I-1)),Q=0,W=0,le=I-1;W<le;++W)for(var e=W+1;e<I;++e){var de=A[W],he=A[e];U[Q]={id:Q,nEdges:this.nEdges(de,he),a:de,b:he},Q++}return U},E.prototype.greedyMerge=function(){for(var Z=0;Z<this.roots.length;++Z)if(!(this.roots[Z].modules().length<2)){var I=this.rootMerges(Z).sort(function(U,Q){return U.nEdges==Q.nEdges?U.id-Q.id:U.nEdges-Q.nEdges})[0];if(!(I.nEdges>=this.R))return this.merge(I.a,I.b,Z),!0}},E.prototype.nEdges=function(Z,A){var I=Z.incoming.intersection(A.incoming),U=Z.outgoing.intersection(A.outgoing);return this.R-I.count()-U.count()},E.prototype.getGroupHierarchy=function(Z){var A=this,I=[];return D(this.roots[0],{},I),this.allEdges().forEach(function(W){var le=A.modules[W.source],e=A.modules[W.target];Z.push(new v(typeof le.gid>"u"?W.source:I[le.gid],typeof e.gid>"u"?W.target:I[e.gid],W.type))}),I},E.prototype.allEdges=function(){var Z=[];return E.getEdges(this.roots[0],Z),Z},E.getEdges=function(Z,A){Z.forAll(function(I){I.getEdges(A),E.getEdges(I.children,A)})},E}();function D(E,Z,A){E.forAll(function(I){if(I.isLeaf())Z.leaves||(Z.leaves=[]),Z.leaves.push(I.id);else{var U=Z;if(I.gid=A.length,!I.isIsland()||I.isPredefined()){if(U={id:I.gid},I.isPredefined())for(var Q in I.definition)U[Q]=I.definition[Q];Z.groups||(Z.groups=[]),Z.groups.push(I.gid),A.push(U)}D(I.children,U,A)}})}H.Configuration=M;var d=function(){function E(Z,A,I,U,Q){void 0===A&&(A=new y),void 0===I&&(I=new y),void 0===U&&(U=new w),this.id=Z,this.outgoing=A,this.incoming=I,this.children=U,this.definition=Q}return E.prototype.getEdges=function(Z){var A=this;this.outgoing.forAll(function(I,U){I.forAll(function(Q){Z.push(new v(A.id,Q.id,U))})})},E.prototype.isLeaf=function(){return 0===this.children.count()},E.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},E.prototype.isPredefined=function(){return typeof this.definition<"u"},E}();H.Module=d;var w=function(){function E(){this.table={}}return E.prototype.count=function(){return Object.keys(this.table).length},E.prototype.intersection=function(Z){var A=new E;return A.table=function T(E,Z){var A={};for(var I in E)I in Z&&(A[I]=E[I]);return A}(this.table,Z.table),A},E.prototype.intersectionCount=function(Z){return this.intersection(Z).count()},E.prototype.contains=function(Z){return Z in this.table},E.prototype.add=function(Z){this.table[Z.id]=Z},E.prototype.remove=function(Z){delete this.table[Z.id]},E.prototype.forAll=function(Z){for(var A in this.table)Z(this.table[A])},E.prototype.modules=function(){var Z=[];return this.forAll(function(A){A.isPredefined()||Z.push(A)}),Z},E}();H.ModuleSet=w;var y=function(){function E(){this.sets={},this.n=0}return E.prototype.count=function(){return this.n},E.prototype.contains=function(Z){var A=!1;return this.forAllModules(function(I){!A&&I.id==Z&&(A=!0)}),A},E.prototype.add=function(Z,A){(Z in this.sets?this.sets[Z]:this.sets[Z]=new w).add(A),++this.n},E.prototype.remove=function(Z,A){var I=this.sets[Z];I.remove(A),0===I.count()&&delete this.sets[Z],--this.n},E.prototype.forAll=function(Z){for(var A in this.sets)Z(this.sets[A],Number(A))},E.prototype.forAllModules=function(Z){this.forAll(function(A,I){return A.forAll(Z)})},E.prototype.intersection=function(Z){var A=new E;return this.forAll(function(I,U){if(U in Z.sets){var Q=I.intersection(Z.sets[U]),W=Q.count();W>0&&(A.sets[U]=Q,A.n+=W)}}),A},E}();H.LinkSets=y,H.getGroups=function P(E,Z,A,I){for(var Q=new M(E.length,Z,A,I);Q.greedyMerge(););var W=[],le=Q.getGroupHierarchy(W);return W.forEach(function(e){var de=function(he){var ke=e[he];"number"==typeof ke&&(e[he]=E[ke])};de("source"),de("target")}),{groups:le,powerEdges:W}}},88866:(q,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var v=function(){function D(d){this.elem=d,this.subheaps=[]}return D.prototype.toString=function(d){for(var T="",w=!1,y=0;y<this.subheaps.length;++y){var S=this.subheaps[y];S.elem?(w&&(T+=","),T+=S.toString(d),w=!0):w=!1}return""!==T&&(T="("+T+")"),(this.elem?d(this.elem):"")+T},D.prototype.forEach=function(d){this.empty()||(d(this.elem,this),this.subheaps.forEach(function(T){return T.forEach(d)}))},D.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce(function(d,T){return d+T.count()},0)},D.prototype.min=function(){return this.elem},D.prototype.empty=function(){return null==this.elem},D.prototype.contains=function(d){if(this===d)return!0;for(var T=0;T<this.subheaps.length;T++)if(this.subheaps[T].contains(d))return!0;return!1},D.prototype.isHeap=function(d){var T=this;return this.subheaps.every(function(w){return d(T.elem,w.elem)&&w.isHeap(d)})},D.prototype.insert=function(d,T){return this.merge(new D(d),T)},D.prototype.merge=function(d,T){return this.empty()?d:d.empty()?this:T(this.elem,d.elem)?(this.subheaps.push(d),this):(d.subheaps.push(this),d)},D.prototype.removeMin=function(d){return this.empty()?null:this.mergePairs(d)},D.prototype.mergePairs=function(d){if(0==this.subheaps.length)return new D(null);if(1==this.subheaps.length)return this.subheaps[0];var T=this.subheaps.pop().merge(this.subheaps.pop(),d),w=this.mergePairs(d);return T.merge(w,d)},D.prototype.decreaseKey=function(d,T,w,y){var S=d.removeMin(y);d.elem=S.elem,d.subheaps=S.subheaps,null!==w&&null!==S.elem&&w(d.elem,d);var P=new D(T);return null!==w&&w(T,P),this.merge(P,y)},D}();H.PairingHeap=v;var M=function(){function D(d){this.lessThan=d}return D.prototype.top=function(){return this.empty()?null:this.root.elem},D.prototype.push=function(){for(var d=[],T=0;T<arguments.length;T++)d[T]=arguments[T];for(var w,S,y=0;S=d[y];++y)w=new v(S),this.root=this.empty()?w:this.root.merge(w,this.lessThan);return w},D.prototype.empty=function(){return!this.root||!this.root.elem},D.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},D.prototype.forEach=function(d){this.root.forEach(d)},D.prototype.pop=function(){if(this.empty())return null;var d=this.root.min();return this.root=this.root.removeMin(this.lessThan),d},D.prototype.reduceKey=function(d,T,w){void 0===w&&(w=null),this.root=this.root.decreaseKey(d,T,w,this.lessThan)},D.prototype.toString=function(d){return this.root.toString(d)},D.prototype.count=function(){return this.root.count()},D}();H.PriorityQueue=M},94655:function(q,H){"use strict";var w,v=this&&this.__extends||(w=function(y,S){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,E){P.__proto__=E}||function(P,E){for(var Z in E)E.hasOwnProperty(Z)&&(P[Z]=E[Z])})(y,S)},function(y,S){function P(){this.constructor=y}w(y,S),y.prototype=null===S?Object.create(S):(P.prototype=S.prototype,new P)});Object.defineProperty(H,"__esModule",{value:!0});var M=function(){function w(){this.findIter=function(y){for(var S=this._root,P=this.iterator();null!==S;){var E=this._comparator(y,S.data);if(0===E)return P._cursor=S,P;P._ancestors.push(S),S=S.get_child(E>0)}return null}}return w.prototype.clear=function(){this._root=null,this.size=0},w.prototype.find=function(y){for(var S=this._root;null!==S;){var P=this._comparator(y,S.data);if(0===P)return S.data;S=S.get_child(P>0)}return null},w.prototype.lowerBound=function(y){return this._bound(y,this._comparator)},w.prototype.upperBound=function(y){var S=this._comparator;return this._bound(y,function P(E,Z){return S(Z,E)})},w.prototype.min=function(){var y=this._root;if(null===y)return null;for(;null!==y.left;)y=y.left;return y.data},w.prototype.max=function(){var y=this._root;if(null===y)return null;for(;null!==y.right;)y=y.right;return y.data},w.prototype.iterator=function(){return new D(this)},w.prototype.each=function(y){for(var P,S=this.iterator();null!==(P=S.next());)y(P)},w.prototype.reach=function(y){for(var P,S=this.iterator();null!==(P=S.prev());)y(P)},w.prototype._bound=function(y,S){for(var P=this._root,E=this.iterator();null!==P;){var Z=this._comparator(y,P.data);if(0===Z)return E._cursor=P,E;E._ancestors.push(P),P=P.get_child(Z>0)}for(var A=E._ancestors.length-1;A>=0;--A)if(S(y,(P=E._ancestors[A]).data)>0)return E._cursor=P,E._ancestors.length=A,E;return E._ancestors.length=0,E},w}();H.TreeBase=M;var D=function(){function w(y){this._tree=y,this._ancestors=[],this._cursor=null}return w.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},w.prototype.next=function(){if(null===this._cursor){var y=this._tree._root;null!==y&&this._minNode(y)}else if(null===this._cursor.right){var S;do{if(S=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===S)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return null!==this._cursor?this._cursor.data:null},w.prototype.prev=function(){if(null===this._cursor){var y=this._tree._root;null!==y&&this._maxNode(y)}else if(null===this._cursor.left){var S;do{if(S=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===S)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);return null!==this._cursor?this._cursor.data:null},w.prototype._minNode=function(y){for(;null!==y.left;)this._ancestors.push(y),y=y.left;this._cursor=y},w.prototype._maxNode=function(y){for(;null!==y.right;)this._ancestors.push(y),y=y.right;this._cursor=y},w}();H.Iterator=D;var d=function(){function w(y){this.data=y,this.left=null,this.right=null,this.red=!0}return w.prototype.get_child=function(y){return y?this.right:this.left},w.prototype.set_child=function(y,S){y?this.right=S:this.left=S},w}(),T=function(w){function y(S){var P=w.call(this)||this;return P._root=null,P._comparator=S,P.size=0,P}return v(y,w),y.prototype.insert=function(S){var P=!1;if(null===this._root)this._root=new d(S),P=!0,this.size++;else{var E=new d(void 0),Z=!1,A=!1,I=null,U=E,Q=null,W=this._root;for(U.right=this._root;;){if(null===W?(W=new d(S),Q.set_child(Z,W),P=!0,this.size++):y.is_red(W.left)&&y.is_red(W.right)&&(W.red=!0,W.left.red=!1,W.right.red=!1),y.is_red(W)&&y.is_red(Q)){var le=U.right===I;W===Q.get_child(A)?U.set_child(le,y.single_rotate(I,!A)):U.set_child(le,y.double_rotate(I,!A))}var e=this._comparator(W.data,S);if(0===e)break;A=Z,null!==I&&(U=I),I=Q,Q=W,W=W.get_child(Z=e<0)}this._root=E.right}return this._root.red=!1,P},y.prototype.remove=function(S){if(null===this._root)return!1;var P=new d(void 0),E=P;E.right=this._root;for(var Z=null,A=null,I=null,U=!0;null!==E.get_child(U);){var Q=U;A=Z,Z=E,E=E.get_child(U);var W=this._comparator(S,E.data);if(U=W>0,0===W&&(I=E),!y.is_red(E)&&!y.is_red(E.get_child(U)))if(y.is_red(E.get_child(!U))){var le=y.single_rotate(E,U);Z.set_child(Q,le),Z=le}else if(!y.is_red(E.get_child(!U))){var e=Z.get_child(!Q);if(null!==e)if(y.is_red(e.get_child(!Q))||y.is_red(e.get_child(Q))){var de=A.right===Z;y.is_red(e.get_child(Q))?A.set_child(de,y.double_rotate(Z,Q)):y.is_red(e.get_child(!Q))&&A.set_child(de,y.single_rotate(Z,Q));var he=A.get_child(de);he.red=!0,E.red=!0,he.left.red=!1,he.right.red=!1}else Z.red=!1,e.red=!0,E.red=!0}}return null!==I&&(I.data=E.data,Z.set_child(Z.right===E,E.get_child(null===E.left)),this.size--),this._root=P.right,null!==this._root&&(this._root.red=!1),null!==I},y.is_red=function(S){return null!==S&&S.red},y.single_rotate=function(S,P){var E=S.get_child(!P);return S.set_child(!P,E.get_child(P)),E.set_child(P,S),S.red=!0,E.red=!1,E},y.double_rotate=function(S,P){return S.set_child(!P,y.single_rotate(S.get_child(!P),!P)),y.single_rotate(S,P)},y}(M);H.RBTree=T},4068:function(q,H,v){"use strict";var X,M=this&&this.__extends||(X=function(ie,oe){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ae,pe){ae.__proto__=pe}||function(ae,pe){for(var xe in pe)pe.hasOwnProperty(xe)&&(ae[xe]=pe[xe])})(ie,oe)},function(ie,oe){function ae(){this.constructor=ie}X(ie,oe),ie.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae)});Object.defineProperty(H,"__esModule",{value:!0});var D=v(98237),d=v(94655);function T(X){return X.bounds=typeof X.leaves<"u"?X.leaves.reduce(function(ie,oe){return oe.bounds.union(ie)},w.empty()):w.empty(),typeof X.groups<"u"&&(X.bounds=X.groups.reduce(function(ie,oe){return T(oe).union(ie)},X.bounds)),X.bounds=X.bounds.inflate(X.padding),X.bounds}H.computeGroupBounds=T;var w=function(){function X(ie,oe,ae,pe){this.x=ie,this.X=oe,this.y=ae,this.Y=pe}return X.empty=function(){return new X(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},X.prototype.cx=function(){return(this.x+this.X)/2},X.prototype.cy=function(){return(this.y+this.Y)/2},X.prototype.overlapX=function(ie){var oe=this.cx(),ae=ie.cx();return oe<=ae&&ie.x<this.X?this.X-ie.x:ae<=oe&&this.x<ie.X?ie.X-this.x:0},X.prototype.overlapY=function(ie){var oe=this.cy(),ae=ie.cy();return oe<=ae&&ie.y<this.Y?this.Y-ie.y:ae<=oe&&this.y<ie.Y?ie.Y-this.y:0},X.prototype.setXCentre=function(ie){var oe=ie-this.cx();this.x+=oe,this.X+=oe},X.prototype.setYCentre=function(ie){var oe=ie-this.cy();this.y+=oe,this.Y+=oe},X.prototype.width=function(){return this.X-this.x},X.prototype.height=function(){return this.Y-this.y},X.prototype.union=function(ie){return new X(Math.min(this.x,ie.x),Math.max(this.X,ie.X),Math.min(this.y,ie.y),Math.max(this.Y,ie.Y))},X.prototype.lineIntersections=function(ie,oe,ae,pe){for(var xe=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],Ne=[],we=0;we<4;++we){var me=X.lineIntersection(ie,oe,ae,pe,xe[we][0],xe[we][1],xe[we][2],xe[we][3]);null!==me&&Ne.push({x:me.x,y:me.y})}return Ne},X.prototype.rayIntersection=function(ie,oe){var ae=this.lineIntersections(this.cx(),this.cy(),ie,oe);return ae.length>0?ae[0]:null},X.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},X.lineIntersection=function(ie,oe,ae,pe,xe,Ne,we,me){var Ye=ae-ie,mt=we-xe,Et=pe-oe,Tt=me-Ne,Nt=Tt*Ye-mt*Et;if(0==Nt)return null;var Xt=ie-xe,Pn=oe-Ne,at=(mt*Pn-Tt*Xt)/Nt,$t=(Ye*Pn-Et*Xt)/Nt;return at>=0&&at<=1&&$t>=0&&$t<=1?{x:ie+at*Ye,y:oe+at*Et}:null},X.prototype.inflate=function(ie){return new X(this.x-ie,this.X+ie,this.y-ie,this.Y+ie)},X}();H.Rectangle=w,H.makeEdgeBetween=function y(X,ie,oe){var ae=X.rayIntersection(ie.cx(),ie.cy())||{x:X.cx(),y:X.cy()},pe=ie.rayIntersection(X.cx(),X.cy())||{x:ie.cx(),y:ie.cy()},xe=pe.x-ae.x,Ne=pe.y-ae.y,we=Math.sqrt(xe*xe+Ne*Ne),me=we-oe;return{sourceIntersection:ae,targetIntersection:pe,arrowStart:{x:ae.x+me*xe/we,y:ae.y+me*Ne/we}}},H.makeEdgeTo=function S(X,ie,oe){var ae=ie.rayIntersection(X.x,X.y);ae||(ae={x:ie.cx(),y:ie.cy()});var pe=ae.x-X.x,xe=ae.y-X.y,Ne=Math.sqrt(pe*pe+xe*xe);return{x:ae.x-oe*pe/Ne,y:ae.y-oe*xe/Ne}};var P=function X(ie,oe,ae){this.v=ie,this.r=oe,this.pos=ae,this.prev=A(),this.next=A()},E=function X(ie,oe,ae){this.isOpen=ie,this.v=oe,this.pos=ae};function Z(X,ie){return X.pos>ie.pos?1:X.pos<ie.pos||X.isOpen?-1:ie.isOpen?1:0}function A(){return new d.RBTree(function(X,ie){return X.pos-ie.pos})}var I={getCentre:function(X){return X.cx()},getOpen:function(X){return X.y},getClose:function(X){return X.Y},getSize:function(X){return X.width()},makeRect:function(X,ie,oe,ae){return new w(oe-ae/2,oe+ae/2,X,ie)},findNeighbours:function le(X,ie){var oe=function(ae,pe){for(var Ne,xe=ie.findIter(X);null!==(Ne=xe[ae]());){var we=Ne.r.overlapX(X.r);if((we<=0||we<=Ne.r.overlapY(X.r))&&(X[ae].insert(Ne),Ne[pe].insert(X)),we<=0)break}};oe("next","prev"),oe("prev","next")}},U={getCentre:function(X){return X.cy()},getOpen:function(X){return X.x},getClose:function(X){return X.X},getSize:function(X){return X.height()},makeRect:function(X,ie,oe,ae){return new w(X,ie,oe-ae/2,oe+ae/2)},findNeighbours:function e(X,ie){var oe=function(ae,pe){var xe=ie.findIter(X)[ae]();null!==xe&&xe.r.overlapX(X.r)>0&&(X[ae].insert(xe),xe[pe].insert(X))};oe("next","prev"),oe("prev","next")}};function Q(X,ie,oe,ae){void 0===ae&&(ae=!1);var pe=X.padding,xe=typeof X.groups<"u"?X.groups.length:0,Ne=typeof X.leaves<"u"?X.leaves.length:0,we=xe?X.groups.reduce(function(Lt,gn){return Lt.concat(Q(gn,ie,oe,!0))},[]):[],me=(ae?2:0)+Ne+xe,Ye=new Array(me),mt=new Array(me),Et=0,Tt=function(Lt,gn){mt[Et]=Lt,Ye[Et++]=gn};if(ae){var Nt=X.bounds,Xt=ie.getCentre(Nt),Pn=ie.getSize(Nt)/2,st=ie.getOpen(Nt),at=ie.getClose(Nt),kt=Xt-Pn+pe/2,$t=Xt+Pn-pe/2;X.minVar.desiredPosition=kt,Tt(ie.makeRect(st,at,kt,pe),X.minVar),X.maxVar.desiredPosition=$t,Tt(ie.makeRect(st,at,$t,pe),X.maxVar)}Ne&&X.leaves.forEach(function(Lt){return Tt(Lt.bounds,Lt.variable)}),xe&&X.groups.forEach(function(Lt){var gn=Lt.bounds;Tt(ie.makeRect(ie.getOpen(gn),ie.getClose(gn),ie.getCentre(gn),ie.getSize(gn)),Lt.minVar)});var _n=W(mt,Ye,ie,oe);return xe&&(Ye.forEach(function(Lt){Lt.cOut=[],Lt.cIn=[]}),_n.forEach(function(Lt){Lt.left.cOut.push(Lt),Lt.right.cIn.push(Lt)}),X.groups.forEach(function(Lt){var gn=(Lt.padding-ie.getSize(Lt.bounds))/2;Lt.minVar.cIn.forEach(function($n){return $n.gap+=gn}),Lt.minVar.cOut.forEach(function($n){$n.left=Lt.maxVar,$n.gap+=gn})})),we.concat(_n)}function W(X,ie,oe,ae){var pe,xe=X.length,Ne=2*xe;console.assert(ie.length>=xe);var we=new Array(Ne);for(pe=0;pe<xe;++pe){var me=X[pe],Ye=new P(ie[pe],me,oe.getCentre(me));we[pe]=new E(!0,Ye,oe.getOpen(me)),we[pe+xe]=new E(!1,Ye,oe.getClose(me))}we.sort(Z);var mt=new Array,Et=A();for(pe=0;pe<Ne;++pe){var Tt=we[pe];if(Ye=Tt.v,Tt.isOpen)Et.insert(Ye),oe.findNeighbours(Ye,Et);else{Et.remove(Ye);var Nt=function(st,at){var kt=(oe.getSize(st.r)+oe.getSize(at.r))/2+ae;mt.push(new D.Constraint(st.v,at.v,kt))},Xt=function(st,at,kt){for(var $t,_n=Ye[st].iterator();null!==($t=_n[st]());)kt($t,Ye),$t[at].remove(Ye)};Xt("prev","next",function(st,at){return Nt(st,at)}),Xt("next","prev",function(st,at){return Nt(at,st)})}}return console.assert(0===Et.size),mt}function de(X,ie){return W(X,ie,I,1e-6)}function he(X,ie){return W(X,ie,U,1e-6)}function ke(X){return Q(X,I,1e-6)}function Le(X){return Q(X,U,1e-6)}H.generateXConstraints=de,H.generateYConstraints=he,H.generateXGroupConstraints=ke,H.generateYGroupConstraints=Le,H.removeOverlaps=function Ue(X){var ie=X.map(function(pe){return new D.Variable(pe.cx())}),oe=de(X,ie),ae=new D.Solver(ie,oe);ae.solve(),ie.forEach(function(pe,xe){return X[xe].setXCentre(pe.position())}),ie=X.map(function(pe){return new D.Variable(pe.cy())}),oe=he(X,ie),(ae=new D.Solver(ie,oe)).solve(),ie.forEach(function(pe,xe){return X[xe].setYCentre(pe.position())})};var Ie=function(X){function ie(oe,ae){var pe=X.call(this,0,ae)||this;return pe.index=oe,pe}return M(ie,X),ie}(D.Variable);H.IndexedVariable=Ie;var je=function(){function X(ie,oe,ae,pe,xe){var Ne=this;if(void 0===ae&&(ae=null),void 0===pe&&(pe=null),void 0===xe&&(xe=!1),this.nodes=ie,this.groups=oe,this.rootGroup=ae,this.avoidOverlaps=xe,this.variables=ie.map(function(me,Ye){return me.variable=new Ie(Ye,1)}),pe&&this.createConstraints(pe),xe&&ae&&typeof ae.groups<"u"){ie.forEach(function(me){if(me.width&&me.height){var Ye=me.width/2,mt=me.height/2;me.bounds=new w(me.x-Ye,me.x+Ye,me.y-mt,me.y+mt)}else me.bounds=new w(me.x,me.x,me.y,me.y)}),T(ae);var we=ie.length;oe.forEach(function(me){Ne.variables[we]=me.minVar=new Ie(we++,typeof me.stiffness<"u"?me.stiffness:.01),Ne.variables[we]=me.maxVar=new Ie(we++,typeof me.stiffness<"u"?me.stiffness:.01)})}}return X.prototype.createSeparation=function(ie){return new D.Constraint(this.nodes[ie.left].variable,this.nodes[ie.right].variable,ie.gap,typeof ie.equality<"u"&&ie.equality)},X.prototype.makeFeasible=function(ie){var oe=this;if(this.avoidOverlaps){var ae="x",pe="width";"x"===ie.axis&&(ae="y",pe="height");var xe=ie.offsets.map(function(we){return oe.nodes[we.node]}).sort(function(we,me){return we[ae]-me[ae]}),Ne=null;xe.forEach(function(we){if(Ne){var me=Ne[ae]+Ne[pe];me>we[ae]&&(we[ae]=me)}Ne=we})}},X.prototype.createAlignment=function(ie){var oe=this,ae=this.nodes[ie.offsets[0].node].variable;this.makeFeasible(ie);var pe="x"===ie.axis?this.xConstraints:this.yConstraints;ie.offsets.slice(1).forEach(function(xe){pe.push(new D.Constraint(ae,oe.nodes[xe.node].variable,xe.offset,!0))})},X.prototype.createConstraints=function(ie){var oe=this,ae=function(pe){return typeof pe.type>"u"||"separation"===pe.type};this.xConstraints=ie.filter(function(pe){return"x"===pe.axis&&ae(pe)}).map(function(pe){return oe.createSeparation(pe)}),this.yConstraints=ie.filter(function(pe){return"y"===pe.axis&&ae(pe)}).map(function(pe){return oe.createSeparation(pe)}),ie.filter(function(pe){return"alignment"===pe.type}).forEach(function(pe){return oe.createAlignment(pe)})},X.prototype.setupVariablesAndBounds=function(ie,oe,ae,pe){this.nodes.forEach(function(xe,Ne){xe.fixed?(xe.variable.weight=xe.fixedWeight?xe.fixedWeight:1e3,ae[Ne]=pe(xe)):xe.variable.weight=1;var we=(xe.width||0)/2,me=(xe.height||0)/2,Ye=ie[Ne],mt=oe[Ne];xe.bounds=new w(Ye-we,Ye+we,mt-me,mt+me)})},X.prototype.xProject=function(ie,oe,ae){!this.rootGroup&&!this.avoidOverlaps&&!this.xConstraints||this.project(ie,oe,ie,ae,function(pe){return pe.px},this.xConstraints,ke,function(pe){return pe.bounds.setXCentre(ae[pe.variable.index]=pe.variable.position())},function(pe){var xe=ae[pe.minVar.index]=pe.minVar.position(),Ne=ae[pe.maxVar.index]=pe.maxVar.position(),we=pe.padding/2;pe.bounds.x=xe-we,pe.bounds.X=Ne+we})},X.prototype.yProject=function(ie,oe,ae){!this.rootGroup&&!this.yConstraints||this.project(ie,oe,oe,ae,function(pe){return pe.py},this.yConstraints,Le,function(pe){return pe.bounds.setYCentre(ae[pe.variable.index]=pe.variable.position())},function(pe){var xe=ae[pe.minVar.index]=pe.minVar.position(),Ne=ae[pe.maxVar.index]=pe.maxVar.position(),we=pe.padding/2;pe.bounds.y=xe-we,pe.bounds.Y=Ne+we})},X.prototype.projectFunctions=function(){var ie=this;return[function(oe,ae,pe){return ie.xProject(oe,ae,pe)},function(oe,ae,pe){return ie.yProject(oe,ae,pe)}]},X.prototype.project=function(ie,oe,ae,pe,xe,Ne,we,me,Ye){this.setupVariablesAndBounds(ie,oe,pe,xe),this.rootGroup&&this.avoidOverlaps&&(T(this.rootGroup),Ne=Ne.concat(we(this.rootGroup))),this.solve(this.variables,Ne,ae,pe),this.nodes.forEach(me),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(Ye),T(this.rootGroup))},X.prototype.solve=function(ie,oe,ae,pe){var xe=new D.Solver(ie,oe);xe.setStartingPositions(ae),xe.setDesiredPositions(pe),xe.solve()},X}();H.Projection=je},33858:(q,H,v)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var M=v(88866),D=function y(S,P){this.id=S,this.distance=P},d=function y(S){this.id=S,this.neighbours=[]},T=function y(S,P,E){this.node=S,this.prev=P,this.d=E},w=function(){function y(S,P,E,Z,A){this.n=S,this.es=P,this.neighbours=new Array(this.n);for(var I=this.n;I--;)this.neighbours[I]=new d(I);for(I=this.es.length;I--;){var U=this.es[I],Q=E(U),W=Z(U),le=A(U);this.neighbours[Q].neighbours.push(new D(W,le)),this.neighbours[W].neighbours.push(new D(Q,le))}}return y.prototype.DistanceMatrix=function(){for(var S=new Array(this.n),P=0;P<this.n;++P)S[P]=this.dijkstraNeighbours(P);return S},y.prototype.DistancesFromNode=function(S){return this.dijkstraNeighbours(S)},y.prototype.PathFromNodeToNode=function(S,P){return this.dijkstraNeighbours(S,P)},y.prototype.PathFromNodeToNodeWithPrevCost=function(S,P,E){var Z=new M.PriorityQueue(function(Le,Ue){return Le.d<=Ue.d}),A=this.neighbours[S],I=new T(A,null,0),U={};for(Z.push(I);!Z.empty()&&(A=(I=Z.pop()).node).id!==P;)for(var Q=A.neighbours.length;Q--;){var W=A.neighbours[Q],le=this.neighbours[W.id];if(!I.prev||le.id!==I.prev.node.id){var e=le.id+","+A.id;if(!(e in U&&U[e]<=I.d)){var de=I.prev?E(I.prev.node.id,A.id,le.id):0,he=I.d+W.distance+de;U[e]=he,Z.push(new T(le,I,he))}}}for(var ke=[];I.prev;)ke.push((I=I.prev).node.id);return ke},y.prototype.dijkstraNeighbours=function(S,P){void 0===P&&(P=-1);for(var E=new M.PriorityQueue(function(de,he){return de.d<=he.d}),Z=this.neighbours.length,A=new Array(Z);Z--;){var I=this.neighbours[Z];I.d=Z===S?0:Number.POSITIVE_INFINITY,I.q=E.push(I)}for(;!E.empty();){var U=E.pop();if(A[U.id]=U.d,U.id===P){for(var Q=[],W=U;typeof W.prev<"u";)Q.push(W.prev.id),W=W.prev;return Q}for(Z=U.neighbours.length;Z--;){var le=U.neighbours[Z],e=(W=this.neighbours[le.id],U.d+le.distance);U.d!==Number.MAX_VALUE&&W.d>e&&(W.d=e,W.prev=U,E.reduceKey(W.q,W,function(he,ke){return he.q=ke}))}}return A},y}();H.Calculator=w},98237:(q,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var v=function(){function S(P){this.scale=P,this.AB=0,this.AD=0,this.A2=0}return S.prototype.addVariable=function(P){var E=this.scale/P.scale,A=P.weight;this.AB+=A*E*(P.offset/P.scale),this.AD+=A*E*P.desiredPosition,this.A2+=A*E*E},S.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},S}();H.PositionStats=v;var M=function(){function S(P,E,Z,A){void 0===A&&(A=!1),this.left=P,this.right=E,this.gap=Z,this.equality=A,this.active=!1,this.unsatisfiable=!1,this.left=P,this.right=E,this.gap=Z,this.equality=A}return S.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},S}();H.Constraint=M;var D=function(){function S(P,E,Z){void 0===E&&(E=1),void 0===Z&&(Z=1),this.desiredPosition=P,this.weight=E,this.scale=Z,this.offset=0}return S.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},S.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},S.prototype.visitNeighbours=function(P,E){var Z=function(A,I){return A.active&&P!==I&&E(A,I)};this.cOut.forEach(function(A){return Z(A,A.right)}),this.cIn.forEach(function(A){return Z(A,A.left)})},S}();H.Variable=D;var d=function(){function S(P){this.vars=[],P.offset=0,this.ps=new v(P.scale),this.addVariable(P)}return S.prototype.addVariable=function(P){P.block=this,this.vars.push(P),this.ps.addVariable(P),this.posn=this.ps.getPosn()},S.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var P=0,E=this.vars.length;P<E;++P)this.ps.addVariable(this.vars[P]);this.posn=this.ps.getPosn()},S.prototype.compute_lm=function(P,E,Z){var A=this,I=P.dfdv();return P.visitNeighbours(E,function(U,Q){var W=A.compute_lm(Q,P,Z);Q===U.right?(I+=W*U.left.scale,U.lm=W):(I+=W*U.right.scale,U.lm=-W),Z(U)}),I/P.scale},S.prototype.populateSplitBlock=function(P,E){var Z=this;P.visitNeighbours(E,function(A,I){I.offset=P.offset+(I===A.right?A.gap:-A.gap),Z.addVariable(I),Z.populateSplitBlock(I,P)})},S.prototype.traverse=function(P,E,Z,A){var I=this;void 0===Z&&(Z=this.vars[0]),void 0===A&&(A=null),Z.visitNeighbours(A,function(U,Q){E.push(P(U)),I.traverse(P,E,Q,Z)})},S.prototype.findMinLM=function(){var P=null;return this.compute_lm(this.vars[0],null,function(E){!E.equality&&(null===P||E.lm<P.lm)&&(P=E)}),P},S.prototype.findMinLMBetween=function(P,E){this.compute_lm(P,null,function(){});var Z=null;return this.findPath(P,null,E,function(A,I){!A.equality&&A.right===I&&(null===Z||A.lm<Z.lm)&&(Z=A)}),Z},S.prototype.findPath=function(P,E,Z,A){var I=this,U=!1;return P.visitNeighbours(E,function(Q,W){!U&&(W===Z||I.findPath(W,P,Z,A))&&(U=!0,A(Q,W))}),U},S.prototype.isActiveDirectedPathBetween=function(P,E){if(P===E)return!0;for(var Z=P.cOut.length;Z--;){var A=P.cOut[Z];if(A.active&&this.isActiveDirectedPathBetween(A.right,E))return!0}return!1},S.split=function(P){return P.active=!1,[S.createSplitBlock(P.left),S.createSplitBlock(P.right)]},S.createSplitBlock=function(P){var E=new S(P);return E.populateSplitBlock(P,null),E},S.prototype.splitBetween=function(P,E){var Z=this.findMinLMBetween(P,E);if(null!==Z){var A=S.split(Z);return{constraint:Z,lb:A[0],rb:A[1]}}return null},S.prototype.mergeAcross=function(P,E,Z){E.active=!0;for(var A=0,I=P.vars.length;A<I;++A){var U=P.vars[A];U.offset+=Z,this.addVariable(U)}this.posn=this.ps.getPosn()},S.prototype.cost=function(){for(var P=0,E=this.vars.length;E--;){var Z=this.vars[E],A=Z.position()-Z.desiredPosition;P+=A*A*Z.weight}return P},S}();H.Block=d;var T=function(){function S(P){this.vs=P;var E=P.length;for(this.list=new Array(E);E--;){var Z=new d(P[E]);this.list[E]=Z,Z.blockInd=E}}return S.prototype.cost=function(){for(var P=0,E=this.list.length;E--;)P+=this.list[E].cost();return P},S.prototype.insert=function(P){P.blockInd=this.list.length,this.list.push(P)},S.prototype.remove=function(P){var E=this.list.length-1,Z=this.list[E];this.list.length=E,P!==Z&&(this.list[P.blockInd]=Z,Z.blockInd=P.blockInd)},S.prototype.merge=function(P){var E=P.left.block,Z=P.right.block,A=P.right.offset-P.left.offset-P.gap;E.vars.length<Z.vars.length?(Z.mergeAcross(E,P,A),this.remove(E)):(E.mergeAcross(Z,P,-A),this.remove(Z))},S.prototype.forEach=function(P){this.list.forEach(P)},S.prototype.updateBlockPositions=function(){this.list.forEach(function(P){return P.updateWeightedPosition()})},S.prototype.split=function(P){var E=this;this.updateBlockPositions(),this.list.forEach(function(Z){var A=Z.findMinLM();null!==A&&A.lm<w.LAGRANGIAN_TOLERANCE&&(Z=A.left.block,d.split(A).forEach(function(I){return E.insert(I)}),E.remove(Z),P.push(A))})},S}();H.Blocks=T;var w=function(){function S(P,E){this.vs=P,this.cs=E,this.vs=P,P.forEach(function(Z){Z.cIn=[],Z.cOut=[]}),this.cs=E,E.forEach(function(Z){Z.left.cOut.push(Z),Z.right.cIn.push(Z)}),this.inactive=E.map(function(Z){return Z.active=!1,Z}),this.bs=null}return S.prototype.cost=function(){return this.bs.cost()},S.prototype.setStartingPositions=function(P){this.inactive=this.cs.map(function(E){return E.active=!1,E}),this.bs=new T(this.vs),this.bs.forEach(function(E,Z){return E.posn=P[Z]})},S.prototype.setDesiredPositions=function(P){this.vs.forEach(function(E,Z){return E.desiredPosition=P[Z]})},S.prototype.mostViolated=function(){for(var P=Number.MAX_VALUE,E=null,Z=this.inactive,A=Z.length,I=A,U=0;U<A;++U){var Q=Z[U];if(!Q.unsatisfiable){var W=Q.slack();if((Q.equality||W<P)&&(P=W,E=Q,I=U,Q.equality))break}}return I!==A&&(P<S.ZERO_UPPERBOUND&&!E.active||E.equality)&&(Z[I]=Z[A-1],Z.length=A-1),E},S.prototype.satisfy=function(){null==this.bs&&(this.bs=new T(this.vs)),this.bs.split(this.inactive);for(var P=null;(P=this.mostViolated())&&(P.equality||P.slack()<S.ZERO_UPPERBOUND&&!P.active);){var E=P.left.block;if(E!==P.right.block)this.bs.merge(P);else{if(E.isActiveDirectedPathBetween(P.right,P.left)){P.unsatisfiable=!0;continue}var A=E.splitBetween(P.left,P.right);if(null===A){P.unsatisfiable=!0;continue}this.bs.insert(A.lb),this.bs.insert(A.rb),this.bs.remove(E),this.inactive.push(A.constraint),P.slack()>=0?this.inactive.push(P):this.bs.merge(P)}}},S.prototype.solve=function(){this.satisfy();for(var P=Number.MAX_VALUE,E=this.bs.cost();Math.abs(P-E)>1e-4;)this.satisfy(),P=E,E=this.bs.cost();return E},S.LAGRANGIAN_TOLERANCE=-1e-4,S.ZERO_UPPERBOUND=-1e-10,S}();H.Solver=w,H.removeOverlapInOneDimension=function y(S,P,E){for(var Z=S.map(function(Ie){return new D(Ie.desiredCenter)}),A=[],I=S.length,U=0;U<I-1;U++)A.push(new M(Z[U],Z[U+1],(S[U].size+S[U+1].size)/2));var le=Z[0],e=Z[I-1],de=S[0].size/2,he=S[I-1].size/2,ke=null,Le=null;return P&&(ke=new D(P,1e3*le.weight),Z.push(ke),A.push(new M(ke,le,de))),E&&(Le=new D(E,1e3*e.weight),Z.push(Le),A.push(new M(e,Le,he))),new w(Z,A).solve(),{newCenters:Z.slice(0,S.length).map(function(Ie){return Ie.position()}),lowerBound:ke?ke.position():le.position()-de,upperBound:Le?Le.position():e.position()+he}}}}]);